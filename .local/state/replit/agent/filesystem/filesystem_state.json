{"file_contents":{"README.md":{"content":"# PartiuTrip - Plataforma de Companheiros de Viagem\n\n## Vis√£o Geral\n\nO PartiuTrip √© uma plataforma web que conecta viajantes com interesses, destinos e datas similares para compartilhar experi√™ncias de viagem e dividir custos. Desenvolvida como uma aplica√ß√£o full-stack moderna, permite que usu√°rios criem planos de viagem, encontrem companheiros compat√≠veis e coordenem despesas compartilhadas.\n\n## Principais Funcionalidades\n\n- **Cria√ß√£o de Viagens**: Planeje viagens detalhadas com destino, datas, or√ßamento e estilo\n- **Busca de Companheiros**: Encontre viajantes compat√≠veis com filtros avan√ßados\n- **Divis√£o de Custos**: Sistema completo de gest√£o e divis√£o de despesas\n- **Chat em Tempo Real**: Comunica√ß√£o entre participantes das viagens\n- **Gerenciamento de Atividades**: Organize e priorize atividades da viagem\n- **Sistema de Indica√ß√µes**: Programa PartiuAmigos para convidar outros viajantes\n- **Perfil Gamificado**: N√≠veis de viajante e sistema de conquistas\n\n## Tecnologias Utilizadas\n\n### Frontend\n- **React 18** com TypeScript\n- **Tailwind CSS** para estiliza√ß√£o\n- **Shadcn/UI** para componentes\n- **Framer Motion** para anima√ß√µes\n- **React Hook Form** com valida√ß√£o Zod\n- **TanStack Query** para gerenciamento de estado\n- **Wouter** para roteamento\n\n### Backend\n- **Node.js** com Express\n- **MySQL** com Drizzle ORM\n- **Passport.js** para autentica√ß√£o\n- **Express Session** para gerenciamento de sess√µes\n- **Bcrypt** para hash de senhas\n\n## Instala√ß√£o e Configura√ß√£o\n\n### Pr√©-requisitos\n- Node.js 20+\n- MySQL 8.0+\n\n### Instala√ß√£o das Depend√™ncias\n```bash\nnpm install\n```\n\n### Configura√ß√£o do Banco de Dados\nConfigure as vari√°veis de ambiente no arquivo `.env`:\n```env\nDB_HOST=seu_host_mysql\nDB_USER=seu_usuario\nDB_PASSWORD=sua_senha\nDB_NAME=partiu_trip\n```\n\n### Executar a Aplica√ß√£o\n```bash\n# Desenvolvimento\nnpm run dev\n\n# Produ√ß√£o\nnpm run build\nnpm start\n\n# Sincronizar schema do banco\nnpm run db:push\n```\n\n## Estrutura do Projeto\n\n```\n‚îú‚îÄ‚îÄ client/                 # Frontend React\n‚îÇ   ‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/    # Componentes reutiliz√°veis\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/         # P√°ginas da aplica√ß√£o\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lib/           # Utilit√°rios e configura√ß√µes\n‚îú‚îÄ‚îÄ server/                # Backend Node.js\n‚îÇ   ‚îú‚îÄ‚îÄ index.ts          # Servidor principal\n‚îÇ   ‚îú‚îÄ‚îÄ routes.ts         # Rotas da API\n‚îÇ   ‚îú‚îÄ‚îÄ auth.ts           # Configura√ß√£o de autentica√ß√£o\n‚îÇ   ‚îî‚îÄ‚îÄ db.ts             # Configura√ß√£o do banco\n‚îú‚îÄ‚îÄ shared/               # C√≥digo compartilhado\n‚îÇ   ‚îî‚îÄ‚îÄ schema.ts         # Schemas do banco de dados\n‚îî‚îÄ‚îÄ replit.md            # Documenta√ß√£o do projeto\n```\n\n## Scripts Dispon√≠veis\n\n- `npm run dev` - Inicia servidor de desenvolvimento\n- `npm run build` - Cria build de produ√ß√£o\n- `npm start` - Executa servidor de produ√ß√£o\n- `npm run check` - Verifica tipos TypeScript\n- `npm run db:push` - Sincroniza schema do banco\n\n## Funcionalidades Principais\n\n### Sistema de Autentica√ß√£o\n- Login com username, email ou telefone\n- Autentica√ß√£o baseada em sess√µes\n- C√≥digos de indica√ß√£o obrigat√≥rios no cadastro\n\n### Gerenciamento de Viagens\n- Cria√ß√£o detalhada com or√ßamento por categoria\n- Sistema de participantes com aprova√ß√£o\n- Chat em tempo real entre participantes\n- Divis√£o autom√°tica de custos\n\n### Perfil do Usu√°rio\n- Informa√ß√µes pessoais e prefer√™ncias\n- Sistema de n√≠veis (Iniciante, Aventureiro, Explorador, Embaixador)\n- Hist√≥rico de viagens e conquistas\n- Programa de indica√ß√µes PartiuAmigos\n\n### Busca e Descoberta\n- Filtros por destino, data, or√ßamento e estilo\n- Sugest√µes personalizadas baseadas no perfil\n- Galeria de destinos populares\n\n## Contribui√ß√£o\n\n1. Fa√ßa fork do projeto\n2. Crie uma branch para sua funcionalidade (`git checkout -b feature/nova-funcionalidade`)\n3. Commit suas mudan√ßas (`git commit -m 'Adiciona nova funcionalidade'`)\n4. Push para a branch (`git push origin feature/nova-funcionalidade`)\n5. Abra um Pull Request\n\n## Licen√ßa\n\nEste projeto est√° sob licen√ßa MIT. Veja o arquivo LICENSE para mais detalhes.\n\n## Suporte\n\nPara suporte ou d√∫vidas, entre em contato atrav√©s do sistema de feedback da plataforma.","size_bytes":4254},"add-participants.ts":{"content":"import { db } from './server/db';\nimport { tripParticipants } from './shared/schema';\n\nasync function addParticipants() {\n  console.log('üîó Conectando ao PostgreSQL...');\n  console.log('üë• Adicionando participantes √†s viagens...');\n\n  // Add creator (tom - user 9) as participant in his own trips\n  await db.insert(tripParticipants).values([\n    {\n      trip_id: 5, // Fim de Semana no Rio\n      user_id: 9, // tom\n      status: 'accepted',\n      joined_at: new Date()\n    },\n    {\n      trip_id: 6, // Aventura em Salvador  \n      user_id: 9, // tom\n      status: 'accepted',\n      joined_at: new Date()\n    }\n  ]);\n\n  // Add other users as participants\n  await db.insert(tripParticipants).values([\n    {\n      trip_id: 5, // Fim de Semana no Rio\n      user_id: 10, // maria\n      status: 'accepted',\n      joined_at: new Date()\n    },\n    {\n      trip_id: 5, // Fim de Semana no Rio\n      user_id: 11, // carlos\n      status: 'accepted', \n      joined_at: new Date()\n    },\n    {\n      trip_id: 6, // Aventura em Salvador\n      user_id: 10, // maria\n      status: 'accepted',\n      joined_at: new Date()\n    }\n  ]);\n\n  console.log('‚úÖ Participantes adicionados com sucesso!');\n  console.log('- Viagem Rio: 3 participantes (tom, maria, carlos)');\n  console.log('- Viagem Salvador: 2 participantes (tom, maria)');\n}\n\naddParticipants().then(() => {\n  process.exit(0);\n}).catch((error) => {\n  console.error('‚ùå Erro ao adicionar participantes:', error);\n  process.exit(1);\n});","size_bytes":1481},"check-table-schema.js":{"content":"import mysql from 'mysql2/promise';\n\nasync function checkTableSchema() {\n  try {\n    const connection = await mysql.createConnection({\n      host: 'srv1661.hstgr.io',\n      user: 'u715665838_partiutrip',\n      password: '@PartiuTrip2024',\n      database: 'u715665838_partiutrip',\n    });\n\n    console.log('üîç Verificando estrutura da tabela activity_budget_proposals...');\n    \n    const [rows] = await connection.execute(`DESCRIBE activity_budget_proposals`);\n    console.log('Colunas da tabela:');\n    rows.forEach(row => {\n      console.log(`- ${row.Field} (${row.Type}) ${row.Null === 'NO' ? 'NOT NULL' : 'NULL'} ${row.Key ? row.Key : ''}`);\n    });\n\n    await connection.end();\n  } catch (error) {\n    console.error('‚ùå Erro ao verificar schema:', error.message);\n  }\n}\n\ncheckTableSchema();","size_bytes":798},"create-test-users.ts":{"content":"import { db } from \"./server/db\";\nimport { users } from \"./shared/schema\";\nimport { eq } from \"drizzle-orm\";\n\nasync function createTestUsers() {\n  try {\n    console.log(\"üöÄ Creating test users...\");\n    \n    // Hash password using scrypt (same method as in auth.ts)\n    const { scrypt, randomBytes } = await import('crypto');\n    const { promisify } = await import('util');\n    const scryptAsync = promisify(scrypt);\n    \n    const salt = randomBytes(16).toString(\"hex\");\n    const buf = (await scryptAsync(\"password123\", salt, 64)) as Buffer;\n    const hashedPassword = `${buf.toString(\"hex\")}.${salt}`;\n    \n    // Create test users\n    const testUsers = [\n      {\n        username: \"tom\",\n        password: hashedPassword,\n        email: \"tom@exemplo.com\",\n        fullName: \"Tom Silva\",\n        phone: \"+5511987654321\",\n        bio: \"Aventureiro experiente\",\n        location: \"S√£o Paulo, SP\",\n        languages: [\"portugu√™s\", \"ingl√™s\"],\n        interests: [\"aventura\", \"natureza\", \"cultura\"],\n        travelStyles: [\"aventura\", \"cultural\"],\n        isVerified: true,\n        verificationMethod: \"referral\"\n      },\n      {\n        username: \"maria\",\n        password: hashedPassword,\n        email: \"maria@exemplo.com\", \n        fullName: \"Maria Santos\",\n        phone: \"+5511987654322\",\n        bio: \"Apaixonada por novas culturas\",\n        location: \"Rio de Janeiro, RJ\",\n        languages: [\"portugu√™s\", \"espanhol\"],\n        interests: [\"cultura\", \"gastronomia\", \"praia\"],\n        travelStyles: [\"cultural\", \"relaxante\"],\n        isVerified: true,\n        verificationMethod: \"referral\"\n      },\n      {\n        username: \"carlos\",\n        password: hashedPassword,\n        email: \"carlos@exemplo.com\",\n        fullName: \"Carlos Oliveira\", \n        phone: \"+5511987654323\",\n        bio: \"Explorador urbano\",\n        location: \"Belo Horizonte, MG\",\n        languages: [\"portugu√™s\"],\n        interests: [\"urbano\", \"gastronomia\", \"hist√≥ria\"],\n        travelStyles: [\"urbano\", \"cultural\"],\n        isVerified: true,\n        verificationMethod: \"referral\"\n      }\n    ];\n    \n    for (const userData of testUsers) {\n      // Check if user already exists\n      const existingUser = await db.select().from(users).where(eq(users.username, userData.username));\n      \n      if (existingUser.length === 0) {\n        await db.insert(users).values(userData);\n        console.log(`‚úÖ Created user: ${userData.username}`);\n      } else {\n        console.log(`‚ö†Ô∏è User ${userData.username} already exists, skipping...`);\n      }\n    }\n    \n    // Verify users were created\n    const allUsers = await db.select().from(users);\n    console.log(`üìä Total users in database: ${allUsers.length}`);\n    \n  } catch (error) {\n    console.error(\"‚ùå Error creating test users:\", error);\n  } finally {\n    process.exit(0);\n  }\n}\n\ncreateTestUsers();","size_bytes":2844},"debug-users.ts":{"content":"import { db } from \"./server/db\";\nimport { users } from \"./shared/schema\";\n\nasync function checkUsers() {\n  try {\n    console.log(\"üîç Checking users in database...\");\n    const allUsers = await db.select().from(users);\n    console.log(\"üìä Total users found:\", allUsers.length);\n    \n    if (allUsers.length > 0) {\n      console.log(\"üë• Users found:\");\n      allUsers.forEach(user => {\n        console.log(`- ${user.username} (${user.email})`);\n      });\n    } else {\n      console.log(\"‚ùå No users found in database\");\n    }\n    \n    // Try to find 'tom' specifically\n    const tom = allUsers.find(u => u.username === 'tom');\n    if (tom) {\n      console.log(\"‚úÖ User 'tom' found:\", { username: tom.username, email: tom.email });\n    } else {\n      console.log(\"‚ùå User 'tom' not found\");\n    }\n    \n  } catch (error) {\n    console.error(\"‚ùå Error checking users:\", error);\n  } finally {\n    process.exit(0);\n  }\n}\n\ncheckUsers();","size_bytes":939},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"quick-seed.ts":{"content":"import { db } from \"./server/db\";\nimport { trips, activities, destinations } from \"./shared/schema\";\nimport { eq } from \"drizzle-orm\";\n\nasync function quickSeed() {\n  try {\n    console.log(\"üå± Populando banco com dados b√°sicos...\");\n\n    // Add some destinations\n    const destinationData = [\n      { name: \"Rio de Janeiro, RJ\", state: \"RJ\", country: \"Brasil\", region: \"Sudeste\", countryType: \"nacional\", continent: \"Am√©rica do Sul\" },\n      { name: \"S√£o Paulo, SP\", state: \"SP\", country: \"Brasil\", region: \"Sudeste\", countryType: \"nacional\", continent: \"Am√©rica do Sul\" },\n      { name: \"Salvador, BA\", state: \"BA\", country: \"Brasil\", region: \"Nordeste\", countryType: \"nacional\", continent: \"Am√©rica do Sul\" },\n      { name: \"Gramado, RS\", state: \"RS\", country: \"Brasil\", region: \"Sul\", countryType: \"nacional\", continent: \"Am√©rica do Sul\" },\n      { name: \"Paris, Fran√ßa\", state: \"√éle-de-France\", country: \"Fran√ßa\", region: \"Europa\", countryType: \"internacional\", continent: \"Europa\" }\n    ];\n\n    for (const dest of destinationData) {\n      const existing = await db.select().from(destinations).where(\n        eq(destinations.name, dest.name)\n      ).limit(1);\n      \n      if (existing.length === 0) {\n        await db.insert(destinations).values(dest);\n        console.log(`‚úÖ Destino adicionado: ${dest.name}`);\n      }\n    }\n\n    // Add some activities\n    const activityData = [\n      {\n        title: \"Cristo Redentor - Rio de Janeiro\",\n        description: \"Visite um dos pontos tur√≠sticos mais famosos do mundo\",\n        destinationName: \"Rio de Janeiro, RJ\",\n        category: \"pontos_turisticos\",\n        location: \"Rio de Janeiro, RJ\",\n        countryType: \"nacional\",\n        region: \"Sudeste\",\n        city: \"Rio de Janeiro\",\n        priceType: \"per_person\",\n        price: 85,\n        duration: \"4 horas\",\n        difficulty: \"easy\",\n        minParticipants: 1,\n        maxParticipants: 50,\n        coverImage: \"https://images.unsplash.com/photo-1544966503-7cc5ac882d5f?w=1200&h=800&fit=crop&crop=entropy&auto=format&q=85\",\n        images: [\"https://images.unsplash.com/photo-1544966503-7cc5ac882d5f?w=1200&h=800&fit=crop&crop=entropy&auto=format&q=85\"],\n        inclusions: [\"Transporte\", \"Ingresso\", \"Guia\"],\n        exclusions: [\"Alimenta√ß√£o\"],\n        requirements: [\"Documento de identifica√ß√£o\"],\n        isActive: true,\n        averageRating: 4.8,\n        totalRatings: 156,\n        createdById: 9\n      },\n      {\n        title: \"Parque Ibirapuera - S√£o Paulo\", \n        description: \"Conhe√ßa o principal parque de S√£o Paulo\",\n        destinationName: \"S√£o Paulo, SP\",\n        category: \"nature\",\n        location: \"S√£o Paulo, SP\",\n        countryType: \"nacional\",\n        region: \"Sudeste\", \n        city: \"S√£o Paulo\",\n        priceType: \"per_person\",\n        price: 0,\n        duration: \"3 horas\",\n        difficulty: \"easy\",\n        minParticipants: 1,\n        maxParticipants: 20,\n        coverImage: \"https://images.unsplash.com/photo-1541963463532-d68292c34d19?w=1200&h=800&fit=crop&crop=entropy&auto=format&q=85\",\n        images: [\"https://images.unsplash.com/photo-1541963463532-d68292c34d19?w=1200&h=800&fit=crop&crop=entropy&auto=format&q=85\"],\n        inclusions: [\"Entrada gratuita\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n        requirements: [],\n        isActive: true,\n        averageRating: 4.5,\n        totalRatings: 89,\n        createdById: 9\n      },\n      {\n        title: \"Pelourinho - Salvador\",\n        description: \"Explore o centro hist√≥rico de Salvador\",\n        destinationName: \"Salvador, BA\",\n        category: \"cultural\",\n        location: \"Salvador, BA\",\n        countryType: \"nacional\",\n        region: \"Nordeste\",\n        city: \"Salvador\", \n        priceType: \"per_person\",\n        price: 45,\n        duration: \"5 horas\",\n        difficulty: \"easy\",\n        minParticipants: 2,\n        maxParticipants: 15,\n        coverImage: \"https://images.unsplash.com/photo-1605540436563-5bca919ae766?w=1200&h=800&fit=crop&crop=entropy&auto=format&q=85\",\n        images: [\"https://images.unsplash.com/photo-1605540436563-5bca919ae766?w=1200&h=800&fit=crop&crop=entropy&auto=format&q=85\"],\n        inclusions: [\"Guia local\", \"Degusta√ß√£o de acaraj√©\"],\n        exclusions: [\"Transporte\", \"Outras refei√ß√µes\"],\n        requirements: [\"Cal√ßado confort√°vel\"],\n        isActive: true,\n        averageRating: 4.7,\n        totalRatings: 124,\n        createdById: 9\n      }\n    ];\n\n    for (const activity of activityData) {\n      const existing = await db.select().from(activities).where(\n        eq(activities.title, activity.title)\n      ).limit(1);\n      \n      if (existing.length === 0) {\n        await db.insert(activities).values(activity);\n        console.log(`‚úÖ Atividade adicionada: ${activity.title}`);\n      }\n    }\n\n    // Add some sample trips\n    const tripData = [\n      {\n        title: \"Fim de Semana no Rio\",\n        description: \"Viagem relax para curtir as praias e pontos tur√≠sticos cariocas\",\n        destination: \"Rio de Janeiro, RJ\",\n        destination_id: 11,\n        startDate: new Date(\"2025-08-15\"),\n        endDate: new Date(\"2025-08-17\"),\n        max_participants: 8,\n        current_participants: 3,\n        budget: 600,\n        budgetType: \"per_person\",\n        travel_style: \"relaxamento\",\n        creator_id: 9, // User tom\n        isActive: true,\n        createdAt: new Date(),\n        updatedAt: new Date()\n      },\n      {\n        title: \"Aventura em Salvador\",\n        description: \"Explorando a cultura e hist√≥ria baiana\",\n        destination: \"Salvador, BA\",\n        destination_id: 13, \n        startDate: new Date(\"2025-09-10\"),\n        endDate: new Date(\"2025-09-14\"),\n        max_participants: 6,\n        current_participants: 2,\n        budget: 800,\n        budgetType: \"per_person\",\n        travel_style: \"cultural\",\n        creator_id: 9, // User tom\n        isActive: true,\n        createdAt: new Date(),\n        updatedAt: new Date()\n      }\n    ];\n\n    for (const trip of tripData) {\n      const existing = await db.select().from(trips).where(\n        eq(trips.title, trip.title)\n      ).limit(1);\n      \n      if (existing.length === 0) {\n        await db.insert(trips).values(trip);\n        console.log(`‚úÖ Viagem adicionada: ${trip.title}`);\n      }\n    }\n\n    console.log(\"‚úÖ Dados b√°sicos adicionados com sucesso!\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro ao popular banco:\", error);\n  } finally {\n    process.exit(0);\n  }\n}\n\nquickSeed();","size_bytes":6498},"replit.md":{"content":"# PartiuTrip - Plataforma de Companheiros de Viagem\n\n## Overview\n\nPartiuTrip is a web platform designed to connect travelers with shared interests, destinations, and dates to facilitate shared travel experiences and cost-sharing. It enables users to create travel plans, find compatible travel companions, and coordinate shared expenses such as accommodation, transportation, and activities. The project aims to provide a comprehensive solution for collaborative travel planning and expense management.\n\n## User Preferences\n\nEstilo de comunica√ß√£o preferido: Linguagem simples e cotidiana.\nIdioma da interface: Portugu√™s brasileiro (todos os elementos da UI traduzidos do ingl√™s para portugu√™s).\n\n## System Architecture\n\n### Frontend Architecture\n- **Framework**: React 18 with TypeScript\n- **Routing**: Wouter (lightweight React router)\n- **State Management**: TanStack React Query for server state\n- **UI Components**: Radix UI primitives with shadcn/ui styling system\n- **Styling**: Tailwind CSS with CSS variables for themes\n- **Form Handling**: React Hook Form with Zod validation\n- **Build Tool**: Vite with custom configuration\n\n### Backend Architecture\n- **Runtime**: Node.js with Express.js\n- **Authentication**: Passport.js with local strategy and session-based authentication\n- **Session Storage**: Express sessions with MySQL storage\n- **Password Security**: Node.js crypto module with scrypt hashing\n- **API Design**: RESTful endpoints with JSON responses\n- **Database**: PostgreSQL with Drizzle ORM (fully migrated from MySQL to PostgreSQL)\n\n### Database Schema\nThe application uses PostgreSQL with consistent snake_case naming throughout all entities:\n- **users**: Authentication, profile information, and travel preferences.\n- **trips**: Travel plans with destinations, dates, budgets, and shared costs.\n- **trip_participants**: Many-to-many relationship between users and trips.\n- **messages**: Real-time chat functionality for travel groups.\n- **trip_requests**: Request system for joining trips.\n- **activities**: Tourist activities with ratings, proposals, and integration into travel plans.\n- **destinations**: Centralized city data with geographical classification.\n- **expenses**: Shared expense tracking with detailed splits.\n- **user_ratings**: Peer review system for travel companions.\n- **activity_reviews**: TripAdvisor-style activity reviews and ratings.\n\n### Core Components and Features\n- **Authentication System**: Local authentication, session-based management, scrypt password hashing, protected routes, user profile management.\n- **Review System**: 1-5 star ratings for tourist activities, full interface with forms, photo uploads, visit dates, comments, \"helpful\" voting, verification badges, and integration with activity details.\n- **Trip Management**: Creation of detailed travel plans, advanced filtering for trip discovery, participant management (request/approval), real-time messaging within groups, shared cost tracking (similar to Splitwise), expense splitting with automatic balance calculation and settlement suggestions.\n- **User Interface**: Responsive design (mobile-first), component-based architecture using Radix UI primitives, dark/light theme support, real-time form validation, loading states, and error handling.\n- **Real-time Features**: Chat system with polling, live updates for trip participants, and notifications for requests and status changes.\n- **Performance Optimizations**: Memoized components, lazy loading, virtual scrolling, error boundaries, custom hooks (useDebounce, useLocalStorage), optimized image loading, and a comprehensive notification center.\n- **Budgeting System**: Detailed budget categorization (accommodation, transport, food, activities), automatic budget updates based on added activities, and a streamlined budget visualization.\n- **Gamification**: Includes traveler levels and a \"PartiuAmigos\" program.\n- **Localization**: All UI elements are translated to Brazilian Portuguese.\n\n### Data Flow (Full snake_case Implementation)\n1. **user_authentication**: Users authenticate with snake_case credentials, sessions stored in PostgreSQL.\n2. **trip_creation**: Authenticated users create detailed travel plans with snake_case field names.\n3. **trip_discovery**: Users search and filter trips using snake_case query parameters.\n4. **participation_requests**: Users request to join trips, creators approve/reject with snake_case status fields.\n5. **real_time_communication**: Approved participants chat using snake_case message properties.\n6. **expense_management**: Trip creators define shared expenses with snake_case field structures.\n\n### Recent Changes (August 2025)\n- **Activities-Destinations Linkage**: Implemented mandatory relationship between activities and destinations with foreign key constraint.\n- **Geographical Classification Inheritance**: Activities now automatically inherit geographical data (continent, region, country, etc.) from their linked destination.\n- **Destination Validation**: Activities can only be created in pre-registered, active destinations.\n- **Enhanced API Routes**: Updated activities API to validate destination relationships and provide destination management endpoints.\n- **Complete snake_case Migration**: Full architectural conversion from camelCase to snake_case.\n- **Database Consistency**: All database fields, API endpoints, and data structures use snake_case.\n- **Frontend Adaptation**: React components and state management converted to snake_case.\n- **Authentication Fix**: Login system repaired with correct password hashing for demo users.\n- **PostgreSQL Integration**: Successfully migrated from MySQL to PostgreSQL with full snake_case schema.\n- **Database Security Implementation**: Comprehensive security measures to protect against unauthorized database connections.\n\n### Security Features\n- **Database Connection Protection**: Multi-layer validation ensures only authorized Neon PostgreSQL connections.\n- **Runtime Monitoring**: Continuous monitoring of database URL integrity and unauthorized access attempts.\n- **Request Security Middleware**: Blocks suspicious API requests and logs all database-related activities.\n- **Environment Variable Protection**: Monitors and prevents unauthorized changes to critical configuration.\n- **Access Control**: Implements strict controls against local databases and Replit native storage.\n\n## External Dependencies\n\n### Core Dependencies\n- **postgres**: PostgreSQL driver with snake_case field naming.\n- **drizzle-orm**: Type-safe ORM configured for PostgreSQL with snake_case consistency.\n- **passport & passport-local**: Authentication middleware with snake_case user properties.\n- **@tanstack/react-query**: Server state management maintaining snake_case data flow.\n- **react-hook-form**: Form handling with validation using snake_case field names.\n- **zod**: Schema validation library with snake_case field validation.\n- **date-fns**: Date manipulation and formatting in Portuguese locale.\n\n### UI Dependencies\n- **@radix-ui/***: Accessible UI primitives.\n- **tailwindcss**: Utility-first CSS framework.\n- **lucide-react**: Icon library.\n- **class-variance-authority**: Component variant management.\n\n### Development Dependencies\n- **vite**: Build tool and development server.\n- **typescript**: Type safety.\n- **tsx**: TypeScript execution for development.\n\n### Security Features\n- **Database Connection Protection**: Multi-layer validation ensures only authorized Neon PostgreSQL connections.\n- **Runtime Monitoring**: Continuous monitoring of database URL integrity and unauthorized access attempts.\n- **Request Security Middleware**: Blocks suspicious API requests and logs all database-related activities.\n- **Environment Variable Protection**: Monitors and prevents unauthorized changes to critical configuration.\n- **Access Control**: Implements strict controls against local databases and Replit native storage.","size_bytes":7909},"seed-database.ts":{"content":"import { db } from './server/db';\nimport { users, destinations, trips, activities } from './shared/schema';\nimport bcryptjs from 'bcryptjs';\n\nasync function seedDatabase() {\n  console.log('üå± Criando dados de demonstra√ß√£o...');\n  \n  try {\n    // Create destinations\n    const [destination1, destination2] = await db.insert(destinations).values([\n      {\n        name: 'Rio de Janeiro',\n        state: 'RJ',\n        country: 'Brasil',\n        countryType: 'nacional',\n        continent: 'Am√©rica do Sul',\n        latitude: '-22.9068',\n        longitude: '-43.1729',\n        timezone: 'America/Sao_Paulo'\n      },\n      {\n        name: 'S√£o Paulo',\n        state: 'SP', \n        country: 'Brasil',\n        countryType: 'nacional',\n        continent: 'Am√©rica do Sul',\n        latitude: '-23.5505',\n        longitude: '-46.6333',\n        timezone: 'America/Sao_Paulo'\n      }\n    ]).returning();\n\n    // Create users\n    const [user1, user2, user3] = await db.insert(users).values([\n      {\n        username: 'tom',\n        email: 'tom@example.com',\n        password: bcryptjs.hashSync('t123', 10),\n        fullName: 'Tom Silva',\n        phone: '+5511999999999',\n        bio: 'Aventureiro apaixonado por viagens',\n        isVerified: true,\n        averageRating: '5.00',\n        totalRatings: 0,\n        travelStyles: ['adventure', 'cultural']\n      },\n      {\n        username: 'maria',\n        email: 'maria@example.com',\n        password: bcryptjs.hashSync('t123', 10),\n        fullName: 'Maria Santos',\n        phone: '+5511888888888',\n        bio: 'Exploradora de culturas',\n        isVerified: true,\n        averageRating: '5.00',\n        totalRatings: 0,\n        travelStyles: ['cultural', 'nature']\n      },\n      {\n        username: 'carlos',\n        email: 'carlos@example.com',\n        password: bcryptjs.hashSync('password123', 10),\n        fullName: 'Carlos Mendes',\n        phone: '+5511777777777',\n        bio: 'Fot√≥grafo de viagem',\n        isVerified: false,\n        averageRating: '5.00',\n        totalRatings: 0,\n        travelStyles: ['photography', 'adventure']\n      }\n    ]).returning();\n\n    // Create trips\n    const [trip1, trip2] = await db.insert(trips).values([\n      {\n        title: 'Aventura no Rio de Janeiro',\n        description: 'Explore as belezas naturais do Rio',\n        destinationId: destination1.id,\n        startDate: new Date('2025-08-15'),\n        endDate: new Date('2025-08-20'),\n        maxParticipants: 8,\n        budget: 2500,\n        creatorId: user1.id,\n        currentParticipants: 1,\n        travelStyle: 'adventure',\n        plannedActivities: []\n      },\n      {\n        title: 'Cultura em S√£o Paulo',\n        description: 'Descubra a rica cultura paulistana',\n        destinationId: destination2.id,\n        startDate: new Date('2025-09-10'),\n        endDate: new Date('2025-09-15'),\n        maxParticipants: 6,\n        budget: 1800,\n        creatorId: user2.id,\n        currentParticipants: 1,\n        travelStyle: 'cultural',\n        plannedActivities: []\n      }\n    ]).returning();\n\n    // Create activities\n    await db.insert(activities).values([\n      {\n        title: 'Cristo Redentor',\n        description: 'Visita ao famoso Cristo Redentor no Corcovado',\n        destinationId: destination1.id,\n        category: 'pontos_turisticos',\n        difficultyLevel: 'easy',\n        duration: '4 horas',\n        minParticipants: 1,\n        maxParticipants: 20,\n        createdById: user1.id,\n        coverImage: 'https://images.unsplash.com/photo-1483729558449-99ef09a8c325',\n        averageRating: '4.80',\n        totalRatings: 150\n      },\n      {\n        title: 'Museu de Arte de S√£o Paulo',\n        description: 'Explore o famoso MASP na Avenida Paulista',\n        destinationId: destination2.id,\n        category: 'cultural',\n        difficultyLevel: 'easy',\n        duration: '3 horas',\n        minParticipants: 1,\n        maxParticipants: 30,\n        createdById: user2.id,\n        coverImage: 'https://images.unsplash.com/photo-1544537150-6e4b999de2a3',\n        averageRating: '4.60',\n        totalRatings: 89\n      }\n    ]);\n\n    console.log('‚úÖ Dados de demonstra√ß√£o criados com sucesso!');\n    console.log(`‚úÖ ${user1.username}, ${user2.username}, ${user3.username} criados`);\n    console.log(`‚úÖ ${destination1.name}, ${destination2.name} criados`);\n    console.log(`‚úÖ ${trip1.title}, ${trip2.title} criados`);\n    \n  } catch (error) {\n    console.error('‚ùå Erro ao criar dados:', error);\n  }\n}\n\n// Run seed if this file is executed directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  seedDatabase().then(() => process.exit(0)).catch((error) => {\n    console.error('‚ùå Erro no seeding:', error);\n    process.exit(1);\n  });\n}\n\nexport default seedDatabase;","size_bytes":4755},"seed-test-users.ts":{"content":"import { db } from \"./server/db.js\";\nimport { users, destinations, activities, activityBudgetProposals } from \"./shared/schema.js\";\nimport bcrypt from \"bcryptjs\";\n\nasync function seedTestUsers() {\n  try {\n    console.log(\"üå± Criando usu√°rios de teste...\");\n    \n    // Create test users\n    const hashedPassword = await bcrypt.hash(\"password123\", 10);\n    \n    const testUsers = [\n      {\n        username: \"tom\",\n        email: \"tom@example.com\",\n        password: hashedPassword,\n        fullName: \"Tom Silva\",\n        firstName: \"Tom\",\n        lastName: \"Silva\",\n        phone: \"(11) 99999-9999\",\n        bio: \"Aventureiro nato, sempre em busca de novas experi√™ncias.\",\n        location: \"S√£o Paulo, SP\",\n        dateOfBirth: new Date(\"1990-05-15\"),\n        emergencyContact: \"Maria Silva - (11) 88888-8888\",\n        travelStyles: [\"adventure\", \"nature\"],\n        isVerified: true,\n        averageRating: \"4.80\",\n        totalRatings: 25,\n        profilePicture: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face\",\n        createdAt: new Date(),\n        updatedAt: new Date()\n      },\n      {\n        username: \"maria\",\n        email: \"maria@example.com\", \n        password: hashedPassword,\n        fullName: \"Maria Santos\",\n        firstName: \"Maria\",\n        lastName: \"Santos\",\n        phone: \"(21) 77777-7777\",\n        bio: \"Apaixonada por cultura e gastronomia local.\",\n        location: \"Rio de Janeiro, RJ\",\n        dateOfBirth: new Date(\"1995-08-20\"),\n        emergencyContact: \"Jo√£o Santos - (21) 66666-6666\",\n        travelStyles: [\"cultural\", \"food\"],\n        isVerified: true,\n        averageRating: \"4.95\",\n        totalRatings: 40,\n        profilePicture: \"https://images.unsplash.com/photo-1494790108755-2616b9a0a29e?w=150&h=150&fit=crop&crop=face\",\n        createdAt: new Date(),\n        updatedAt: new Date()\n      },\n      {\n        username: \"carlos\",\n        email: \"carlos@example.com\",\n        password: hashedPassword,\n        fullName: \"Carlos Oliveira\",\n        firstName: \"Carlos\",\n        lastName: \"Oliveira\", \n        phone: \"(31) 55555-5555\",\n        bio: \"Explorador urbano e fot√≥grafo amador.\",\n        location: \"Belo Horizonte, MG\",\n        dateOfBirth: new Date(\"1988-12-10\"),\n        emergencyContact: \"Ana Oliveira - (31) 44444-4444\",\n        travelStyles: [\"urban\", \"photography\"],\n        isVerified: false,\n        averageRating: \"0.00\",\n        totalRatings: 0,\n        profilePicture: \"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face\",\n        createdAt: new Date(),\n        updatedAt: new Date()\n      }\n    ];\n\n    await db.insert(users).values(testUsers);\n    console.log(\"‚úÖ Usu√°rios de teste criados!\");\n\n    // Create test destinations\n    console.log(\"üåç Criando destinos de teste...\");\n    const testDestinations = [\n      {\n        name: \"Rio de Janeiro\",\n        state: \"RJ\", \n        country: \"Brasil\",\n        countryType: \"national\",\n        continent: \"America do Sul\",\n        description: \"Cidade Maravilhosa com praias deslumbrantes\",\n        latitude: -22.9068,\n        longitude: -43.1729,\n        timezone: \"America/Sao_Paulo\",\n        isActive: true,\n        createdAt: new Date(),\n        updatedAt: new Date()\n      },\n      {\n        name: \"S√£o Paulo\",\n        state: \"SP\",\n        country: \"Brasil\", \n        countryType: \"national\",\n        continent: \"America do Sul\",\n        description: \"Metr√≥pole cosmopolita com vida cultural intensa\",\n        latitude: -23.5505,\n        longitude: -46.6333,\n        timezone: \"America/Sao_Paulo\",\n        isActive: true,\n        createdAt: new Date(),\n        updatedAt: new Date()\n      },\n      {\n        name: \"Paris\",\n        state: \"√éle-de-France\",\n        country: \"Fran√ßa\",\n        countryType: \"international\",\n        continent: \"Europa\",\n        description: \"Cidade Luz, capital mundial da arte e cultura\",\n        latitude: 48.8566,\n        longitude: 2.3522,\n        timezone: \"Europe/Paris\",\n        isActive: true,\n        createdAt: new Date(),\n        updatedAt: new Date()\n      }\n    ];\n\n    const insertedDestinations = await db.insert(destinations).values(testDestinations).returning();\n    console.log(\"‚úÖ Destinos de teste criados!\");\n\n    // Create test activities\n    console.log(\"üéØ Criando atividades de teste...\");\n    const testActivities = [\n      {\n        title: \"Cristo Redentor e Corcovado\",\n        description: \"Visita ao ic√¥nico Cristo Redentor no topo do Corcovado com vista panor√¢mica da cidade.\",\n        destinationId: insertedDestinations[0].id, // Rio de Janeiro\n        category: \"pontos_turisticos\",\n        difficultyLevel: \"easy\",\n        duration: \"3 horas\",\n        minParticipants: 1,\n        maxParticipants: 15,\n        languages: [\"portugu√™s\", \"ingl√™s\"],\n        inclusions: [\"Transporte\", \"Guia local\", \"Seguro\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Bebidas\"],\n        requirements: [\"Cal√ßado confort√°vel\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: {},\n        coverImage: \"https://images.unsplash.com/photo-1544966503-7cc5ac882d5d?w=1200&h=800&fit=crop\",\n        images: [],\n        averageRating: \"4.50\",\n        totalRatings: 15,\n        isActive: true,\n        createdById: 1,\n        createdAt: new Date(),\n        updatedAt: new Date()\n      },\n      {\n        title: \"Museu do Louvre\",\n        description: \"Explore a maior cole√ß√£o de arte do mundo no famoso Museu do Louvre.\",\n        destinationId: insertedDestinations[2].id, // Paris\n        category: \"cultural\",\n        difficultyLevel: \"easy\",\n        duration: \"4 horas\",\n        minParticipants: 1,\n        maxParticipants: 20,\n        languages: [\"fran√ßais\", \"english\"],\n        inclusions: [\"Entrada\", \"Audioguia\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n        requirements: [\"Documento de identidade\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 48h antes\",\n        contactInfo: {},\n        coverImage: \"https://images.unsplash.com/photo-1566139528892-5734e1b82b38?w=1200&h=800&fit=crop\",\n        images: [],\n        averageRating: \"4.80\",\n        totalRatings: 32,\n        isActive: true,\n        createdById: 2,\n        createdAt: new Date(),\n        updatedAt: new Date()\n      }\n    ];\n\n    const insertedActivities = await db.insert(activities).values(testActivities).returning();\n    console.log(\"‚úÖ Atividades de teste criadas!\");\n\n    // Create budget proposals\n    console.log(\"üí∞ Criando propostas de or√ßamento...\");\n    const budgetProposals = [];\n    \n    for (const activity of insertedActivities) {\n      const proposals = [\n        {\n          activityId: activity.id,\n          title: \"Econ√¥mico\",\n          description: \"Op√ß√£o b√°sica com o essencial\",\n          price: \"85.00\",\n          currency: \"BRL\",\n          inclusions: [\"Transporte b√°sico\", \"Entrada\"],\n          exclusions: [\"Alimenta√ß√£o\", \"Guia\"],\n          validUntil: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000), // 30 days\n          votes: 5,\n          isActive: true,\n          createdAt: new Date(),\n          updatedAt: new Date()\n        },\n        {\n          activityId: activity.id,\n          title: \"Completo\", \n          description: \"Experi√™ncia completa com guia\",\n          price: \"160.00\",\n          currency: \"BRL\",\n          inclusions: [\"Transporte\", \"Entrada\", \"Guia local\", \"Lanche\"],\n          exclusions: [\"Almo√ßo\"],\n          validUntil: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n          votes: 12,\n          isActive: true,\n          createdAt: new Date(),\n          updatedAt: new Date()\n        },\n        {\n          activityId: activity.id,\n          title: \"Premium\",\n          description: \"Experi√™ncia VIP com tudo incluso\",\n          price: \"280.00\",\n          currency: \"BRL\", \n          inclusions: [\"Transporte VIP\", \"Entrada\", \"Guia especializado\", \"Refei√ß√£o completa\", \"Seguro premium\"],\n          exclusions: [],\n          validUntil: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n          votes: 8,\n          isActive: true,\n          createdAt: new Date(),\n          updatedAt: new Date()\n        }\n      ];\n      budgetProposals.push(...proposals);\n    }\n\n    await db.insert(activityBudgetProposals).values(budgetProposals);\n    console.log(\"‚úÖ Propostas de or√ßamento criadas!\");\n\n    console.log(\"üéâ Seed conclu√≠do com sucesso!\");\n    console.log(\"Credenciais de teste:\");\n    console.log(\"- tom / password123\");\n    console.log(\"- maria / password123\");\n    console.log(\"- carlos / password123\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro no seed:\", error);\n    throw error;\n  }\n}\n\nif (import.meta.url === `file://${process.argv[1]}`) {\n  seedTestUsers()\n    .then(() => process.exit(0))\n    .catch(() => process.exit(1));\n}\n\nexport default seedTestUsers;","size_bytes":8855},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar-background)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":2627},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":971},"attached_assets/activities-page_1752557192572.tsx":{"content":"import { useState, useEffect, useMemo } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { \n  Search, \n  Filter, \n  Star, \n  MapPin, \n  Clock, \n  Users, \n  Heart,\n  SlidersHorizontal,\n  ArrowLeft,\n  Grid,\n  List,\n  TrendingUp,\n  Calendar,\n  DollarSign,\n  Award,\n  Plus,\n  ChevronRight,\n  Target,\n  Sparkles,\n  Sliders,\n  ChevronDown\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { LoadingSpinner } from \"@/components/loading-spinner\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { motion } from \"framer-motion\";\nimport { activityCategories } from \"@shared/schema\";\nimport type { Activity } from \"@shared/schema\";\n\ninterface ActivityFilters {\n  search: string;\n  category: string;\n  priceRange: string;\n  location: string;\n  duration: string;\n  difficulty: string;\n  rating: string;\n  sortBy: string;\n  onlyMyTrips: boolean;\n}\n\nconst PRICE_RANGES = [\n  { value: \"all\", label: \"Todos os pre√ßos\" },\n  { value: \"free\", label: \"Gr√°tis\" },\n  { value: \"0-50\", label: \"At√© R$ 50\" },\n  { value: \"50-150\", label: \"R$ 50 - R$ 150\" },\n  { value: \"150-300\", label: \"R$ 150 - R$ 300\" },\n  { value: \"300+\", label: \"Acima de R$ 300\" },\n];\n\nconst DIFFICULTY_LEVELS = [\n  { value: \"all\", label: \"Todos os n√≠veis\" },\n  { value: \"easy\", label: \"F√°cil\" },\n  { value: \"moderate\", label: \"Moderado\" },\n  { value: \"challenging\", label: \"Desafiador\" },\n];\n\nconst SORT_OPTIONS = [\n  { value: \"rating\", label: \"Melhor avalia√ß√£o\" },\n  { value: \"price_low\", label: \"Menor pre√ßo\" },\n  { value: \"price_high\", label: \"Maior pre√ßo\" },\n  { value: \"duration\", label: \"Dura√ß√£o\" },\n  { value: \"newest\", label: \"Mais recentes\" },\n];\n\nexport default function ActivitiesPage() {\n  const { user } = useAuth();\n  const [filters, setFilters] = useState<ActivityFilters>({\n    search: \"\",\n    category: \"all\",\n    priceRange: \"all\",\n    location: \"\",\n    duration: \"all\",\n    difficulty: \"all\",\n    rating: \"all\",\n    sortBy: \"rating\",\n    onlyMyTrips: false,\n  });\n\n  const [searchInput, setSearchInput] = useState(\"\");\n  const [debouncedSearch, setDebouncedSearch] = useState(\"\");\n  const [viewMode, setViewMode] = useState<\"grid\" | \"list\">(\"grid\");\n  const [showFilters, setShowFilters] = useState(false);\n\n  // Debounce search input\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setDebouncedSearch(searchInput);\n    }, 300);\n\n    return () => clearTimeout(timer);\n  }, [searchInput]);\n\n  // Update filters when debounced search changes\n  useEffect(() => {\n    setFilters(prev => ({ ...prev, search: debouncedSearch }));\n  }, [debouncedSearch]);\n\n  // Fetch user's trips to filter activities by destination\n  const { data: myTripsData } = useQuery({\n    queryKey: [\"/api/my-trips\"],\n    queryFn: async () => {\n      if (!user) return { created: [], participating: [] };\n      try {\n        const response = await fetch(\"/api/my-trips\");\n        if (!response.ok) return { created: [], participating: [] };\n        return response.json();\n      } catch (error) {\n        console.error(\"Erro ao carregar viagens do usu√°rio:\", error);\n        return { created: [], participating: [] };\n      }\n    },\n    enabled: !!user,\n    retry: false,\n  });\n\n  // Combine created and participating trips\n  const userTrips = useMemo(() => {\n    if (!myTripsData) return [];\n    return [...(myTripsData.created || []), ...(myTripsData.participating || [])];\n  }, [myTripsData]);\n\n  const { data: activities, isLoading, isFetching } = useQuery<Activity[]>({\n    queryKey: [\"/api/activities\", filters],\n    queryFn: async () => {\n      try {\n        const params = new URLSearchParams();\n        if (filters.search) params.set(\"search\", filters.search);\n        if (filters.category !== \"all\") params.set(\"category\", filters.category);\n        if (filters.priceRange !== \"all\") params.set(\"priceRange\", filters.priceRange);\n        if (filters.location) params.set(\"location\", filters.location);\n        if (filters.duration !== \"all\") params.set(\"duration\", filters.duration);\n        if (filters.difficulty !== \"all\") params.set(\"difficulty\", filters.difficulty);\n        if (filters.rating !== \"all\") params.set(\"rating\", filters.rating);\n        params.set(\"sortBy\", filters.sortBy);\n        \n        const response = await fetch(`/api/activities?${params}`);\n        if (!response.ok) throw new Error(\"Falha ao carregar atividades\");\n        return response.json();\n      } catch (error) {\n        console.error(\"Erro ao carregar atividades:\", error);\n        throw error;\n      }\n    },\n    retry: 1,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n\n  const updateFilter = (key: keyof ActivityFilters, value: string | boolean) => {\n    setFilters(prev => ({ ...prev, [key]: value }));\n  };\n\n  const handleSearch = () => {\n    setFilters(prev => ({ ...prev, search: searchInput }));\n  };\n\n  const renderStars = (rating: number) => {\n    return Array.from({ length: 5 }, (_, i) => (\n      <Star\n        key={i}\n        className={`w-4 h-4 ${\n          i < Math.floor(rating) \n            ? \"fill-yellow-400 text-yellow-400\" \n            : \"text-gray-300\"\n        }`}\n      />\n    ));\n  };\n\n  const formatPrice = (priceType: string, priceAmount: number | null) => {\n    if (!priceAmount) return \"Gr√°tis\";\n    \n    const formatted = new Intl.NumberFormat(\"pt-BR\", {\n      style: \"currency\",\n      currency: \"BRL\",\n    }).format(priceAmount);\n\n    return priceType === \"per_person\" \n      ? `${formatted}/pessoa`\n      : priceType === \"per_group\"\n      ? `${formatted}/grupo`\n      : formatted;\n  };\n\n  // Get user trip destinations for filtering\n  const userTripDestinations = useMemo(() => {\n    if (!userTrips || !user) return new Set();\n    return new Set(userTrips.map((trip: any) => trip.destination));\n  }, [userTrips, user]);\n\n  // Filter activities based on user's trip destinations\n  const filteredActivities = useMemo(() => {\n    if (!activities) return [];\n    \n    if (filters.onlyMyTrips && user) {\n      return activities.filter(activity => {\n        const activityCity = activity.location.split(',')[0].trim();\n        return Array.from(userTripDestinations).some(destination => \n          destination.includes(activityCity) || activityCity.includes(destination)\n        );\n      });\n    }\n    \n    return activities;\n  }, [activities, filters.onlyMyTrips, userTripDestinations, user]);\n\n  // Group activities by city/destination\n  const groupedActivities = useMemo(() => {\n    if (!filteredActivities) return {};\n    \n    const grouped = filteredActivities.reduce((acc, activity) => {\n      const city = activity.location.split(',')[0].trim();\n      if (!acc[city]) acc[city] = [];\n      acc[city].push(activity);\n      return acc;\n    }, {} as Record<string, Activity[]>);\n    \n    return grouped;\n  }, [filteredActivities]);\n\n  // Get suggestions based on most popular and best-rated activities\n  const suggestedActivities = useMemo(() => {\n    if (!activities) return [];\n    \n    // Sort by rating and popularity (total ratings)\n    const sorted = [...activities].sort((a, b) => {\n      const aScore = Number(a.averageRating) * Math.log(a.totalRatings + 1);\n      const bScore = Number(b.averageRating) * Math.log(b.totalRatings + 1);\n      return bScore - aScore;\n    });\n    \n    return sorted.slice(0, 6); // Top 6 suggestions\n  }, [activities]);\n\n  // Get suggestions based on user's upcoming trips destinations\n  const upcomingTripsSuggestions = useMemo(() => {\n    if (!activities || !userTrips || !user) return [];\n    \n    // Get upcoming trips destinations\n    const upcomingTrips = userTrips.filter((trip: any) => {\n      const tripDate = new Date(trip.startDate);\n      const now = new Date();\n      return tripDate > now;\n    });\n    \n    if (upcomingTrips.length === 0) return [];\n    \n    // Extract destinations from upcoming trips\n    const upcomingDestinations = upcomingTrips.map((trip: any) => trip.destination);\n    \n    // Filter activities that match upcoming destinations\n    const matchingActivities = activities.filter(activity => {\n      const activityCity = activity.location.split(',')[0].trim();\n      return upcomingDestinations.some(destination => \n        destination.toLowerCase().includes(activityCity.toLowerCase()) || \n        activityCity.toLowerCase().includes(destination.toLowerCase())\n      );\n    });\n    \n    // Sort by rating and return top suggestions\n    const sorted = matchingActivities.sort((a, b) => {\n      const aScore = Number(a.averageRating) * Math.log(a.totalRatings + 1);\n      const bScore = Number(b.averageRating) * Math.log(b.totalRatings + 1);\n      return bScore - aScore;\n    });\n    \n    return sorted.slice(0, 6);\n  }, [activities, userTrips, user]);\n\n  const cities = Object.keys(groupedActivities).sort();\n\n  // Show full preloader only on initial load\n  if (isLoading && !activities) {\n    return (\n      <div className=\"min-h-screen bg-[#F5F9FC] flex items-center justify-center\">\n        <LoadingSpinner variant=\"travel\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-[#F5F9FC]\">\n      {/* Modern Header with Institutional Colors */}\n      <div className=\"bg-white shadow-sm border-b border-[#AAB0B7]/20\">\n        <div className=\"max-w-7xl mx-auto px-4 py-4 md:py-8\">\n          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6\">\n            <div className=\"flex items-center gap-3 sm:gap-6\">\n              <Link to=\"/search\">\n                <Button variant=\"ghost\" size=\"sm\" className=\"text-[#1B2B49] hover:bg-[#FFA500]/10 hover:text-[#FFA500] transition-all duration-300\">\n                  <ArrowLeft className=\"w-4 h-4 mr-2\" />\n                  Voltar\n                </Button>\n              </Link>\n              \n              <div>\n                <h1 className=\"text-xl sm:text-2xl md:text-3xl font-bold text-[#1B2B49] mb-1 md:mb-2\">\n                  Atividades e Experi√™ncias\n                </h1>\n                <p className=\"text-[#AAB0B7] text-sm md:text-lg\">\n                  Descubra experi√™ncias incr√≠veis para sua viagem ‚Ä¢ {filteredActivities?.length || 0} atividades dispon√≠veis\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-3 self-end sm:self-auto\">\n              <Button \n                variant=\"outline\" \n                size=\"sm\"\n                onClick={() => setViewMode(viewMode === \"grid\" ? \"list\" : \"grid\")}\n                className=\"border-[#AAB0B7]/30 hover:bg-[#FFA500]/10 hover:border-[#FFA500]/30 hover:text-[#FFA500] transition-all duration-300\"\n              >\n                {viewMode === \"grid\" ? <List className=\"w-4 h-4\" /> : <Grid className=\"w-4 h-4\" />}\n                <span className=\"hidden sm:inline ml-2\">\n                  {viewMode === \"grid\" ? \"Lista\" : \"Grade\"}\n                </span>\n              </Button>\n              \n              <Button \n                variant=\"outline\" \n                size=\"sm\"\n                onClick={() => setShowFilters(!showFilters)}\n                className=\"border-[#AAB0B7]/30 hover:bg-[#FFA500]/10 hover:border-[#FFA500]/30 hover:text-[#FFA500] transition-all duration-300\"\n              >\n                <SlidersHorizontal className=\"w-4 h-4 mr-2\" />\n                Filtros\n              </Button>\n            </div>\n          </div>\n\n          {/* Search Bar */}\n          <div className=\"relative mb-6\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-[#AAB0B7] w-5 h-5\" />\n            <Input\n              placeholder=\"Buscar por atividades, locais ou experi√™ncias...\"\n              value={searchInput}\n              onChange={(e) => setSearchInput(e.target.value)}\n              onKeyDown={(e) => {\n                if (e.key === 'Enter') {\n                  handleSearch();\n                }\n              }}\n              className=\"pl-10 pr-24 h-12 text-base border-[#AAB0B7]/30 focus:border-[#FFA500] bg-white rounded-lg\"\n            />\n            <Button \n              onClick={handleSearch}\n              size=\"sm\"\n              className=\"absolute right-2 top-1/2 transform -translate-y-1/2 bg-[#FFA500] hover:bg-[#FFA500]/90 hover:shadow-md transition-all duration-300 text-white\"\n            >\n              Buscar\n            </Button>\n          </div>\n\n          {/* Category Filters */}\n          <div className=\"space-y-4\">\n            <div className=\"flex flex-col gap-3\">\n              <div className=\"flex flex-wrap gap-2 sm:gap-3\">\n                <Button\n                  variant={filters.category === \"all\" ? \"default\" : \"ghost\"}\n                  size=\"sm\"\n                  onClick={() => updateFilter(\"category\", \"all\")}\n                  className={`px-2 sm:px-3 text-xs sm:text-sm whitespace-nowrap flex items-center gap-1 transition-all duration-300 ${\n                    filters.category === \"all\" \n                      ? \"bg-[#FFA500] text-white shadow-sm\" \n                      : \"text-[#1B2B49] hover:bg-[#FFA500]/10 hover:text-[#FFA500]\"\n                  }`}\n                >\n                  üóÇÔ∏è <span className=\"hidden xs:inline\">Todas</span>\n                  <span className=\"bg-white/20 text-current px-1 py-0.5 rounded text-xs\">\n                    {activities?.length || 0}\n                  </span>\n                </Button>\n                \n                {Object.entries(activityCategories).slice(0, 4).map(([key, cat]) => {\n                  const count = activities?.filter(a => a.category === key).length || 0;\n                  return (\n                    <Button\n                      key={key}\n                      variant={filters.category === key ? \"default\" : \"ghost\"}\n                      size=\"sm\"\n                      onClick={() => updateFilter(\"category\", key)}\n                      className={`group px-2 sm:px-3 text-xs sm:text-sm whitespace-nowrap flex items-center gap-1 transition-all duration-300 ${\n                        filters.category === key \n                          ? \"bg-[#FFA500] text-white shadow-sm scale-105\" \n                          : \"text-[#1B2B49] hover:bg-[#FFA500]/10 hover:text-[#FFA500] hover:shadow-md hover:scale-102 hover:border-[#FFA500]/30\"\n                      }`}\n                    >\n                      <span className=\"text-sm transition-transform duration-300 group-hover:scale-110\">{cat.icon}</span>\n                      <span className=\"hidden sm:inline\">{cat.label}</span>\n                      <span className={`px-1 py-0.5 rounded text-xs transition-colors duration-300 ${\n                        filters.category === key \n                          ? \"bg-white/20 text-current\" \n                          : \"bg-slate-100 text-slate-600 group-hover:bg-[#FFA500]/20 group-hover:text-[#FFA500]\"\n                      }`}>\n                        {count}\n                      </span>\n                    </Button>\n                  );\n                })}\n              </div>\n            </div>\n\n            {/* Advanced Filters */}\n            {showFilters && (\n              <motion.div \n                initial={{ opacity: 0, height: 0 }}\n                animate={{ opacity: 1, height: \"auto\" }}\n                exit={{ opacity: 0, height: 0 }}\n                className=\"bg-[#F5F9FC] rounded-xl border border-[#AAB0B7]/20 p-4 md:p-6\"\n              >\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6\">\n                  <div>\n                    <label className=\"block text-sm font-medium text-[#1B2B49] mb-3\">\n                      Faixa de Pre√ßo\n                    </label>\n                    <Select \n                      value={filters.priceRange} \n                      onValueChange={(value) => updateFilter(\"priceRange\", value)}\n                    >\n                      <SelectTrigger className=\"border-[#AAB0B7]/30 focus:border-[#FFA500]\">\n                        <SelectValue placeholder=\"Todos os pre√ßos\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {PRICE_RANGES.map(range => (\n                          <SelectItem key={range.value} value={range.value}>\n                            {range.label}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-[#1B2B49] mb-3\">\n                      N√≠vel de Dificuldade\n                    </label>\n                    <Select \n                      value={filters.difficulty} \n                      onValueChange={(value) => updateFilter(\"difficulty\", value)}\n                    >\n                      <SelectTrigger className=\"border-[#AAB0B7]/30 focus:border-[#FFA500]\">\n                        <SelectValue placeholder=\"Todos os n√≠veis\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {DIFFICULTY_LEVELS.map(level => (\n                          <SelectItem key={level.value} value={level.value}>\n                            {level.label}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n\n                  <div>\n                    <label className=\"block text-sm font-medium text-[#1B2B49] mb-3\">\n                      Ordenar por\n                    </label>\n                    <Select \n                      value={filters.sortBy} \n                      onValueChange={(value) => updateFilter(\"sortBy\", value)}\n                    >\n                      <SelectTrigger className=\"border-[#AAB0B7]/30 focus:border-[#FFA500]\">\n                        <SelectValue placeholder=\"Ordenar por\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {SORT_OPTIONS.map(option => (\n                          <SelectItem key={option.value} value={option.value}>\n                            {option.label}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </div>\n\n                {/* Special Filters */}\n                {user && (\n                  <div className=\"mt-6 pt-4 border-t border-[#AAB0B7]/20\">\n                    <div className=\"flex items-center justify-between p-4 bg-white rounded-lg border border-[#AAB0B7]/20\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"bg-[#FFA500]/10 p-2 rounded-lg\">\n                          <Target className=\"w-4 h-4 text-[#FFA500]\" />\n                        </div>\n                        <div>\n                          <label className=\"text-sm font-medium text-[#1B2B49]\">\n                            Apenas destinos das minhas viagens\n                          </label>\n                          <p className=\"text-xs text-[#AAB0B7] mt-1\">\n                            Mostra apenas atividades nos destinos onde voc√™ tem viagens planejadas\n                          </p>\n                        </div>\n                      </div>\n                      <Switch\n                        checked={filters.onlyMyTrips}\n                        onCheckedChange={(checked) => updateFilter(\"onlyMyTrips\", checked)}\n                      />\n                    </div>\n                  </div>\n                )}\n              </motion.div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Suggestions Section */}\n      {suggestedActivities.length > 0 && (\n        <div className=\"bg-white border-b border-[#AAB0B7]/20\">\n          <div className=\"max-w-7xl mx-auto px-4 py-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <div className=\"flex items-center gap-2\">\n                <Sparkles className=\"w-5 h-5 text-[#FFA500]\" />\n                <h2 className=\"text-lg font-semibold text-[#1B2B49]\">Sugest√µes para Voc√™</h2>\n                <Badge variant=\"outline\" className=\"bg-[#FFA500]/10 text-[#FFA500] border-[#FFA500]/20\">\n                  Mais escolhidas\n                </Badge>\n              </div>\n            </div>\n            \n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4\">\n              {suggestedActivities.map((activity) => (\n                <Link key={activity.id} to={`/activities/${activity.id}`}>\n                  <Card className=\"group hover:shadow-lg transition-all duration-300 cursor-pointer\">\n                    <div className=\"relative\">\n                      <img\n                        src={activity.coverImage}\n                        alt={activity.title}\n                        className=\"w-full h-24 object-cover rounded-t-lg\"\n                      />\n                      <div className=\"absolute top-2 right-2\">\n                        <div className=\"flex items-center gap-1 bg-white/90 backdrop-blur-sm rounded-full px-2 py-1\">\n                          <Star className=\"w-3 h-3 fill-[#FFA500] text-[#FFA500]\" />\n                          <span className=\"text-xs font-medium\">{Number(activity.averageRating).toFixed(1)}</span>\n                        </div>\n                      </div>\n                    </div>\n                    <CardContent className=\"p-3\">\n                      <h3 className=\"font-medium text-sm line-clamp-2 text-[#1B2B49] mb-1\">\n                        {activity.title}\n                      </h3>\n                      <p className=\"text-xs text-[#AAB0B7] mb-2\">\n                        {activity.location.split(',')[0]}\n                      </p>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-sm font-semibold text-[#1B2B49]\">\n                          {formatPrice(activity.priceType, activity.priceAmount)}\n                        </span>\n                        <Badge variant=\"secondary\" className=\"text-xs\">\n                          {activityCategories[activity.category as keyof typeof activityCategories]?.icon}\n                        </Badge>\n                      </div>\n                    </CardContent>\n                  </Card>\n                </Link>\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Upcoming Trips Suggestions - Only show if user is logged in and has upcoming trips */}\n      {user && upcomingTripsSuggestions.length > 0 && (\n        <div className=\"bg-gradient-to-r from-slate-50 to-orange-50/30 border-b border-slate-200/40\">\n          <div className=\"max-w-7xl mx-auto px-4 py-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <div className=\"flex items-center gap-2\">\n                <Calendar className=\"w-5 h-5 text-orange-600\" />\n                <h2 className=\"text-lg font-semibold text-slate-900\">Sugest√µes para Suas Pr√≥ximas Viagens</h2>\n                <Badge variant=\"outline\" className=\"bg-orange-50 text-orange-700 border-orange-200\">\n                  Baseado nos seus destinos\n                </Badge>\n              </div>\n            </div>\n            \n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4\">\n              {upcomingTripsSuggestions.map((activity) => (\n                <Link key={activity.id} to={`/activities/${activity.id}`}>\n                  <Card className=\"group hover:shadow-lg transition-all duration-300 cursor-pointer bg-white border-slate-200/60 hover:border-orange-300/60\">\n                    <div className=\"relative\">\n                      <img\n                        src={activity.coverImage}\n                        alt={activity.title}\n                        className=\"w-full h-24 object-cover rounded-t-lg\"\n                      />\n                      <div className=\"absolute top-2 right-2\">\n                        <div className=\"flex items-center gap-1 bg-white/90 backdrop-blur-sm rounded-full px-2 py-1\">\n                          <Star className=\"w-3 h-3 fill-[#FFA500] text-[#FFA500]\" />\n                          <span className=\"text-xs font-medium\">{Number(activity.averageRating).toFixed(1)}</span>\n                        </div>\n                      </div>\n                      <div className=\"absolute top-2 left-2\">\n                        <div className=\"bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-full px-2 py-1 text-xs font-medium shadow-sm\">\n                          Pr√≥xima viagem\n                        </div>\n                      </div>\n                    </div>\n                    <CardContent className=\"p-3\">\n                      <h3 className=\"font-medium text-sm line-clamp-2 text-[#1B2B49] mb-1\">\n                        {activity.title}\n                      </h3>\n                      <p className=\"text-xs text-[#AAB0B7] mb-2\">\n                        {activity.location.split(',')[0]}\n                      </p>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-sm font-semibold text-[#1B2B49]\">\n                          {formatPrice(activity.priceType, activity.priceAmount)}\n                        </span>\n                        <Badge variant=\"secondary\" className=\"text-xs\">\n                          {activityCategories[activity.category as keyof typeof activityCategories]?.icon}\n                        </Badge>\n                      </div>\n                    </CardContent>\n                  </Card>\n                </Link>\n              ))}\n            </div>\n          </div>\n        </div>\n      )}\n\n      <div className=\"max-w-7xl mx-auto px-4 py-6\">\n        {/* Activities Grouped by City - Enhanced Layout */}\n        {cities.length > 0 ? (\n          <div className=\"space-y-8\">\n            {cities.map((city) => (\n              <div key={city} className=\"bg-white rounded-xl border border-slate-200/60 shadow-sm overflow-hidden\">\n                {/* City Header - Enhanced */}\n                <div className=\"bg-gradient-to-r from-orange-50 to-amber-50 border-b border-orange-200/60 p-4 md:p-6\">\n                  <div className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"bg-orange-100 p-3 rounded-xl\">\n                        <MapPin className=\"w-6 h-6 text-orange-600\" />\n                      </div>\n                      <div>\n                        <h2 className=\"text-xl md:text-2xl font-bold text-slate-900\">\n                          {city}\n                        </h2>\n                        <div className=\"flex items-center gap-2 mt-1\">\n                          <Badge variant=\"outline\" className=\"bg-orange-50 text-orange-700 border-orange-200\">\n                            {groupedActivities[city].length} atividades\n                          </Badge>\n                          <Badge variant=\"outline\" className=\"bg-amber-50 text-amber-700 border-amber-200\">\n                            {Math.round(groupedActivities[city].reduce((acc, a) => acc + Number(a.averageRating), 0) / groupedActivities[city].length * 10) / 10}‚òÖ m√©dia\n                          </Badge>\n                        </div>\n                      </div>\n                    </div>\n                    <Button \n                      variant=\"outline\" \n                      size=\"sm\" \n                      className=\"border-orange-200 text-orange-600 hover:bg-orange-50 hover:border-orange-300 transition-all duration-300 hidden sm:flex\"\n                    >\n                      Ver todas <ChevronRight className=\"w-4 h-4 ml-1\" />\n                    </Button>\n                  </div>\n                </div>\n\n                {/* Activities Grid - Improved */}\n                <div className=\"p-4 md:p-6\">\n                  <div className={`grid gap-4 md:gap-6 ${\n                    viewMode === \"grid\" \n                      ? \"grid-cols-1 sm:grid-cols-2 lg:grid-cols-3\" \n                      : \"grid-cols-1\"\n                  }`}>\n                    {groupedActivities[city].map((activity) => (\n                      <motion.div\n                        key={activity.id}\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        transition={{ duration: 0.3 }}\n                      >\n                        <Card className=\"overflow-hidden hover:shadow-lg transition-all duration-300 bg-white border-slate-200/60 hover:border-orange-300/60 group\">\n                        <div className=\"relative\">\n                          <img\n                            src={activity.coverImage}\n                            alt={activity.title}\n                            className=\"w-full h-48 object-cover\"\n                          />\n                          <div className=\"absolute top-3 right-3\">\n                            <Button size=\"sm\" variant=\"outline\" className=\"bg-white/90 hover:bg-white backdrop-blur-sm\">\n                              <Heart className=\"w-4 h-4\" />\n                            </Button>\n                          </div>\n                          \n                          {/* Category Badge */}\n                          <div className=\"absolute bottom-3 left-3\">\n                            <Badge variant=\"secondary\" className=\"bg-white/90 text-[#1B2B49] backdrop-blur-sm\">\n                              {activityCategories[activity.category as keyof typeof activityCategories]?.label}\n                            </Badge>\n                          </div>\n\n                          {/* Trending Badge */}\n                          {Number(activity.averageRating) >= 4.5 && (\n                            <div className=\"absolute top-3 left-3\">\n                              <Badge className=\"bg-[#FFA500] text-white\">\n                                <TrendingUp className=\"w-3 h-3 mr-1\" />\n                                Trending\n                              </Badge>\n                            </div>\n                          )}\n                        </div>\n\n                        <CardHeader className=\"pb-3 p-4 md:p-6\">\n                          <div className=\"flex items-start justify-between\">\n                            <h3 className=\"font-semibold text-base md:text-lg line-clamp-2 text-[#1B2B49]\">\n                              {activity.title}\n                            </h3>\n                            <div className=\"flex items-center gap-1 ml-2 flex-shrink-0\">\n                              <Star className=\"w-4 h-4 fill-[#FFA500] text-[#FFA500]\" />\n                              <span className=\"text-sm font-medium text-[#1B2B49]\">\n                                {Number(activity.averageRating).toFixed(1)}\n                              </span>\n                              <span className=\"text-xs text-[#AAB0B7]\">\n                                ({activity.totalRatings})\n                              </span>\n                            </div>\n                          </div>\n\n                          <div className=\"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 text-sm text-[#AAB0B7]\">\n                            <div className=\"flex items-center gap-1\">\n                              <MapPin className=\"w-4 h-4\" />\n                              <span className=\"truncate\">{activity.location}</span>\n                            </div>\n                            {activity.duration && (\n                              <div className=\"flex items-center gap-1\">\n                                <Clock className=\"w-4 h-4\" />\n                                {activity.duration}\n                              </div>\n                            )}\n                          </div>\n                        </CardHeader>\n\n                        <CardContent className=\"p-4 md:p-6\">\n                          <p className=\"text-[#AAB0B7] text-sm mb-4 line-clamp-3\">\n                            {activity.description}\n                          </p>\n\n                          {/* Multiple Budget Options - Mobile Optimized */}\n                          <div className=\"mb-4\">\n                            <div className=\"flex items-center gap-2 mb-3\">\n                              <DollarSign className=\"w-4 h-4 text-[#FFA500]\" />\n                              <span className=\"text-sm font-medium text-[#1B2B49]\">Op√ß√µes de Or√ßamento</span>\n                            </div>\n                            <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-2\">\n                              <div className=\"flex items-center justify-between p-2 bg-[#F5F9FC] rounded-lg\">\n                                <span className=\"text-xs sm:text-sm\">B√°sica</span>\n                                <span className=\"text-xs sm:text-sm font-medium text-[#1B2B49]\">\n                                  {formatPrice(activity.priceType, activity.priceAmount)}\n                                </span>\n                              </div>\n                              <div className=\"flex items-center justify-between p-2 bg-[#F5F9FC] rounded-lg\">\n                                <span className=\"text-xs sm:text-sm\">Completa</span>\n                                <span className=\"text-xs sm:text-sm font-medium text-[#1B2B49]\">\n                                  {formatPrice(activity.priceType, (activity.priceAmount || 0) * 1.5)}\n                                </span>\n                              </div>\n                              <div className=\"flex items-center justify-between p-2 bg-[#F5F9FC] rounded-lg\">\n                                <span className=\"text-xs sm:text-sm\">Premium</span>\n                                <span className=\"text-xs sm:text-sm font-medium text-[#1B2B49]\">\n                                  {formatPrice(activity.priceType, (activity.priceAmount || 0) * 2)}\n                                </span>\n                              </div>\n                            </div>\n                          </div>\n\n                          <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3\">\n                            <div className=\"flex items-center gap-2 flex-wrap\">\n                              {activity.difficultyLevel && (\n                                <Badge variant=\"outline\" className=\"text-xs border-[#AAB0B7]/30\">\n                                  {activity.difficultyLevel === \"easy\" && \"F√°cil\"}\n                                  {activity.difficultyLevel === \"moderate\" && \"Moderado\"}\n                                  {activity.difficultyLevel === \"challenging\" && \"Desafiador\"}\n                                </Badge>\n                              )}\n                              <Badge variant=\"outline\" className=\"text-xs border-[#AAB0B7]/30\">\n                                <Users className=\"w-3 h-3 mr-1\" />\n                                {activity.priceType === \"per_person\" ? \"Por pessoa\" : \"Por grupo\"}\n                              </Badge>\n                            </div>\n\n                            <div className=\"flex gap-2\">\n                              <Link to={`/activities/${activity.id}`}>\n                                <Button size=\"sm\" variant=\"outline\" className=\"border-[#AAB0B7]/30 hover:bg-[#FFA500]/10 hover:border-[#FFA500]/30 hover:text-[#FFA500] transition-all duration-300 text-xs sm:text-sm\">\n                                  Ver detalhes\n                                </Button>\n                              </Link>\n                              <Button size=\"sm\" className=\"bg-[#FFA500] hover:bg-[#FFA500]/90 hover:shadow-md transition-all duration-300 text-white text-xs sm:text-sm\">\n                                <Plus className=\"w-4 h-4 mr-1\" />\n                                Adicionar\n                              </Button>\n                            </div>\n                          </div>\n                        </CardContent>\n                      </Card>\n                    </motion.div>\n                  ))}\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        ) : (\n          <div className=\"text-center py-16\">\n            <div className=\"w-20 h-20 bg-[#FFA500]/10 rounded-full flex items-center justify-center mx-auto mb-6\">\n              <Search className=\"w-8 h-8 text-[#FFA500]\" />\n            </div>\n            <h3 className=\"text-xl font-semibold text-[#1B2B49] mb-3\">\n              Nenhuma atividade encontrada\n            </h3>\n            <p className=\"text-[#AAB0B7] mb-6\">\n              Tente ajustar os filtros ou fazer uma nova busca para encontrar atividades incr√≠veis.\n            </p>\n            <Button \n              onClick={() => {\n                setFilters({\n                  search: \"\",\n                  category: \"all\",\n                  priceRange: \"all\",\n                  location: \"\",\n                  duration: \"all\",\n                  difficulty: \"all\",\n                  rating: \"all\",\n                  sortBy: \"rating\",\n                  onlyMyTrips: false,\n                });\n                setSearchInput(\"\");\n              }}\n              className=\"bg-[#FFA500] hover:bg-[#FFA500]/90 hover:shadow-md transition-all duration-300 text-white\"\n            >\n              Limpar filtros\n            </Button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":37892},"attached_assets/activity-detail-page_1752557079961.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useParams, Link } from \"wouter\";\nimport { \n  ArrowLeft, \n  Star, \n  MapPin, \n  Clock, \n  Users, \n  Heart,\n  Share2,\n  Calendar,\n  Shield,\n  Award,\n  MessageSquare,\n  Camera,\n  CheckCircle,\n  XCircle,\n  Phone,\n  Mail,\n  Globe,\n  MessageCircle,\n  Plane\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Avatar, AvatarImage, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { LoadingSpinner } from \"@/components/loading-spinner\";\nimport { ActivityBudgetProposals } from \"@/components/activity-budget-proposals\";\nimport { AddActivityToTrip } from \"@/components/add-activity-to-trip\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { motion } from \"framer-motion\";\nimport { format } from \"date-fns\";\nimport { ptBR } from \"date-fns/locale\";\nimport { activityCategories, insertActivityBookingSchema } from \"@shared/schema\";\nimport type { Activity, ActivityReview, ActivityBooking, InsertActivityBooking } from \"@shared/schema\";\n\nexport default function ActivityDetailPage() {\n  const { id } = useParams<{ id: string }>();\n  const [selectedImageIndex, setSelectedImageIndex] = useState(0);\n  const [showBookingDialog, setShowBookingDialog] = useState(false);\n  const [showReviewDialog, setShowReviewDialog] = useState(false);\n  const [showAddToTripDialog, setShowAddToTripDialog] = useState(false);\n  const { toast } = useToast();\n  const { user } = useAuth();\n  const queryClient = useQueryClient();\n\n  // Helper function to safely parse JSON arrays\n  const parseJsonArray = (data: any): any[] => {\n    if (!data) return [];\n    if (Array.isArray(data)) return data;\n    try {\n      const parsed = typeof data === 'string' ? JSON.parse(data) : data;\n      return Array.isArray(parsed) ? parsed : [];\n    } catch {\n      return [];\n    }\n  };\n\n  const { data: activity, isLoading: activityLoading } = useQuery<Activity>({\n    queryKey: [`/api/activities/${id}`],\n    queryFn: async () => {\n      const response = await fetch(`/api/activities/${id}`);\n      if (!response.ok) throw new Error(\"Atividade n√£o encontrada\");\n      return response.json();\n    },\n  });\n\n  const { data: reviews, isLoading: reviewsLoading } = useQuery<(ActivityReview & { user: any })[]>({\n    queryKey: [`/api/activities/${id}/reviews`],\n    queryFn: async () => {\n      const response = await fetch(`/api/activities/${id}/reviews`);\n      if (!response.ok) throw new Error(\"Falha ao carregar avalia√ß√µes\");\n      return response.json();\n    },\n  });\n\n  const bookingForm = useForm<InsertActivityBooking>({\n    resolver: zodResolver(insertActivityBookingSchema),\n    defaultValues: {\n      activityId: Number(id),\n      participants: 1,\n      contactName: \"\",\n      contactEmail: \"\",\n      contactPhone: \"\",\n      specialRequests: \"\",\n      bookingDate: new Date(),\n      totalAmount: 0,\n    },\n  });\n\n  const bookingMutation = useMutation({\n    mutationFn: async (data: InsertActivityBooking) => {\n      const response = await fetch(`/api/activities/${id}/bookings`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(data),\n      });\n      if (!response.ok) throw new Error(\"Falha ao fazer reserva\");\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"Reserva realizada com sucesso!\" });\n      setShowBookingDialog(false);\n      bookingForm.reset();\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Erro ao fazer reserva\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const renderStars = (rating: number) => {\n    return Array.from({ length: 5 }, (_, i) => (\n      <Star\n        key={i}\n        className={`w-4 h-4 ${\n          i < Math.floor(rating) \n            ? \"fill-yellow-400 text-yellow-400\" \n            : \"text-gray-300\"\n        }`}\n      />\n    ));\n  };\n\n  const formatPrice = (priceType: string, priceAmount: number | null) => {\n    if (!priceAmount) return \"Gr√°tis\";\n    \n    const formatted = new Intl.NumberFormat(\"pt-BR\", {\n      style: \"currency\",\n      currency: \"BRL\",\n    }).format(priceAmount);\n\n    return priceType === \"per_person\" \n      ? `${formatted}/pessoa`\n      : priceType === \"per_group\"\n      ? `${formatted}/grupo`\n      : formatted;\n  };\n\n  const calculateTotalPrice = () => {\n    if (!activity?.priceAmount) return 0;\n    const participants = bookingForm.watch(\"participants\") || 1;\n    return activity.priceType === \"per_person\" \n      ? activity.priceAmount * participants\n      : activity.priceAmount;\n  };\n\n  if (activityLoading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <LoadingSpinner variant=\"travel\" />\n      </div>\n    );\n  }\n\n  if (!activity) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Atividade n√£o encontrada</h2>\n          <Link to=\"/activities\">\n            <Button>Voltar para atividades</Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white shadow-sm border-b\">\n        <div className=\"max-w-7xl mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <Link to=\"/activities\">\n              <Button variant=\"ghost\" size=\"sm\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" />\n                Voltar\n              </Button>\n            </Link>\n            \n            <div className=\"flex items-center gap-2\">\n              <Button variant=\"outline\" size=\"sm\">\n                <Share2 className=\"w-4 h-4 mr-2\" />\n                Compartilhar\n              </Button>\n              <Button variant=\"outline\" size=\"sm\">\n                <Heart className=\"w-4 h-4 mr-2\" />\n                Favoritar\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-4 py-6\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          {/* Main Content */}\n          <div className=\"lg:col-span-2\">\n            {/* Image Gallery */}\n            <div className=\"mb-6\">\n              <div className=\"relative rounded-lg overflow-hidden\">\n                {(() => {\n                  const images = parseJsonArray(activity.images);\n                  return (\n                    <img\n                      src={images[selectedImageIndex] || activity.coverImage}\n                      alt={activity.title}\n                      className=\"w-full h-96 object-cover\"\n                    />\n                  );\n                })()}\n                \n                {(() => {\n                  const images = parseJsonArray(activity.images);\n                  return images && images.length > 1 && (\n                    <div className=\"absolute bottom-4 left-4 right-4\">\n                      <div className=\"flex gap-2 overflow-x-auto\">\n                        {images.map((image: string, index: number) => (\n                          <button\n                            key={index}\n                            onClick={() => setSelectedImageIndex(index)}\n                            className={`flex-shrink-0 w-16 h-16 rounded-lg overflow-hidden border-2 transition-colors ${\n                              index === selectedImageIndex \n                                ? \"border-white\" \n                                : \"border-white/50\"\n                            }`}\n                          >\n                            <img\n                              src={image}\n                              alt={`${activity.title} ${index + 1}`}\n                              className=\"w-full h-full object-cover\"\n                            />\n                          </button>\n                        ))}\n                      </div>\n                    </div>\n                  );\n                })()}\n              </div>\n            </div>\n\n            {/* Activity Info */}\n            <div className=\"bg-white rounded-lg border p-6 mb-6\">\n              <div className=\"flex items-start justify-between mb-4\">\n                <div>\n                  <Badge variant=\"secondary\" className=\"mb-2\">\n                    {activityCategories[activity.category as keyof typeof activityCategories]?.label}\n                  </Badge>\n                  <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">\n                    {activity.title}\n                  </h1>\n                  <div className=\"flex items-center gap-4 text-sm text-gray-600\">\n                    <div className=\"flex items-center gap-1\">\n                      <MapPin className=\"w-4 h-4\" />\n                      {activity.location}\n                    </div>\n                    {activity.duration && (\n                      <div className=\"flex items-center gap-1\">\n                        <Clock className=\"w-4 h-4\" />\n                        {activity.duration}\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"flex items-center gap-1\">\n                    {renderStars(Number(activity.averageRating))}\n                  </div>\n                  <span className=\"text-sm font-medium\">\n                    {Number(activity.averageRating).toFixed(1)}\n                  </span>\n                  <span className=\"text-xs text-gray-500\">\n                    ({activity.totalRatings} avalia√ß√µes)\n                  </span>\n                </div>\n              </div>\n\n              <p className=\"text-gray-700 mb-6 leading-relaxed\">\n                {activity.description}\n              </p>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                {activity.difficultyLevel && (\n                  <div className=\"flex items-center gap-2\">\n                    <Award className=\"w-5 h-5 text-blue-600\" />\n                    <div>\n                      <div className=\"text-sm font-medium\">Dificuldade</div>\n                      <div className=\"text-xs text-gray-600\">\n                        {activity.difficultyLevel === \"easy\" && \"F√°cil\"}\n                        {activity.difficultyLevel === \"moderate\" && \"Moderado\"}\n                        {activity.difficultyLevel === \"challenging\" && \"Desafiador\"}\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {activity.minParticipants && (\n                  <div className=\"flex items-center gap-2\">\n                    <Users className=\"w-5 h-5 text-green-600\" />\n                    <div>\n                      <div className=\"text-sm font-medium\">Participantes</div>\n                      <div className=\"text-xs text-gray-600\">\n                        {activity.minParticipants} - {activity.maxParticipants || \"‚àû\"}\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {(() => {\n                  const languages = parseJsonArray(activity.languages);\n                  return languages.length > 0 && (\n                    <div className=\"flex items-center gap-2\">\n                      <Globe className=\"w-5 h-5 text-purple-600\" />\n                      <div>\n                        <div className=\"text-sm font-medium\">Idiomas</div>\n                        <div className=\"text-xs text-gray-600\">\n                          {languages.join(\", \")}\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })()}\n              </div>\n            </div>\n\n            {/* Tabs */}\n            <Tabs defaultValue=\"details\" className=\"mb-6\">\n              <TabsList className=\"grid w-full grid-cols-4\">\n                <TabsTrigger value=\"details\">Detalhes</TabsTrigger>\n                <TabsTrigger value=\"proposals\">Or√ßamentos</TabsTrigger>\n                <TabsTrigger value=\"reviews\">Avalia√ß√µes</TabsTrigger>\n                <TabsTrigger value=\"location\">Localiza√ß√£o</TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"details\" className=\"mt-6\">\n                <div className=\"bg-white rounded-lg border p-6\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n                    {(() => {\n                      const inclusions = parseJsonArray(activity.inclusions);\n                      return inclusions.length > 0 && (\n                        <div>\n                          <h3 className=\"font-semibold text-gray-900 mb-3 flex items-center gap-2\">\n                            <CheckCircle className=\"w-5 h-5 text-green-600\" />\n                            Incluso\n                          </h3>\n                          <ul className=\"space-y-2\">\n                            {inclusions.map((item, index) => (\n                              <li key={index} className=\"flex items-center gap-2 text-sm\">\n                                <CheckCircle className=\"w-4 h-4 text-green-600 flex-shrink-0\" />\n                                {item}\n                              </li>\n                            ))}\n                          </ul>\n                        </div>\n                      );\n                    })()}\n\n                    {(() => {\n                      const exclusions = parseJsonArray(activity.exclusions);\n                      return exclusions.length > 0 && (\n                        <div>\n                          <h3 className=\"font-semibold text-gray-900 mb-3 flex items-center gap-2\">\n                            <XCircle className=\"w-5 h-5 text-red-600\" />\n                            N√£o incluso\n                          </h3>\n                          <ul className=\"space-y-2\">\n                            {exclusions.map((item, index) => (\n                              <li key={index} className=\"flex items-center gap-2 text-sm\">\n                                <XCircle className=\"w-4 h-4 text-red-600 flex-shrink-0\" />\n                                {item}\n                              </li>\n                            ))}\n                          </ul>\n                        </div>\n                      );\n                    })()}\n                  </div>\n\n                  {(() => {\n                    const requirements = parseJsonArray(activity.requirements);\n                    return requirements.length > 0 && (\n                      <div className=\"mt-6 pt-6 border-t\">\n                        <h3 className=\"font-semibold text-gray-900 mb-3 flex items-center gap-2\">\n                          <Shield className=\"w-5 h-5 text-blue-600\" />\n                          Requisitos e Restri√ß√µes\n                        </h3>\n                        <ul className=\"space-y-2\">\n                          {requirements.map((req, index) => (\n                            <li key={index} className=\"flex items-center gap-2 text-sm\">\n                              <Shield className=\"w-4 h-4 text-blue-600 flex-shrink-0\" />\n                              {req}\n                            </li>\n                          ))}\n                        </ul>\n                      </div>\n                    );\n                  })()}\n\n                  {activity.cancellationPolicy && (\n                    <div className=\"mt-6 pt-6 border-t\">\n                      <h3 className=\"font-semibold text-gray-900 mb-3\">\n                        Pol√≠tica de Cancelamento\n                      </h3>\n                      <p className=\"text-sm text-gray-600\">{activity.cancellationPolicy}</p>\n                    </div>\n                  )}\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"proposals\" className=\"mt-6\">\n                <div className=\"bg-white rounded-lg border p-6\">\n                  <ActivityBudgetProposals activityId={Number(id)} />\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"reviews\" className=\"mt-6\">\n                <div className=\"bg-white rounded-lg border p-6\">\n                  {reviewsLoading ? (\n                    <div className=\"flex justify-center py-8\">\n                      <LoadingSpinner />\n                    </div>\n                  ) : reviews && reviews.length > 0 ? (\n                    <div className=\"space-y-6\">\n                      {reviews.map((review) => (\n                        <div key={review.id} className=\"border-b pb-6 last:border-b-0\">\n                          <div className=\"flex items-start gap-4\">\n                            <Avatar>\n                              <AvatarImage src={review.user.profilePhoto} />\n                              <AvatarFallback>\n                                {review.user.fullName.charAt(0)}\n                              </AvatarFallback>\n                            </Avatar>\n                            \n                            <div className=\"flex-1\">\n                              <div className=\"flex items-center gap-2 mb-2\">\n                                <span className=\"font-medium\">{review.user.fullName}</span>\n                                <div className=\"flex items-center gap-1\">\n                                  {renderStars(review.rating)}\n                                </div>\n                                <span className=\"text-sm text-gray-500\">\n                                  {format(new Date(review.createdAt), \"MMM yyyy\", { locale: ptBR })}\n                                </span>\n                              </div>\n                              \n                              {review.review && (\n                                <p className=\"text-gray-700 mb-2\">{review.review}</p>\n                              )}\n                              \n                              {review.photos && review.photos.length > 0 && (\n                                <div className=\"flex gap-2 mb-2\">\n                                  {review.photos.map((photo, index) => (\n                                    <img\n                                      key={index}\n                                      src={photo}\n                                      alt={`Review ${index + 1}`}\n                                      className=\"w-16 h-16 object-cover rounded\"\n                                    />\n                                  ))}\n                                </div>\n                              )}\n                              \n                              <div className=\"flex items-center gap-4 text-sm text-gray-500\">\n                                <button className=\"flex items-center gap-1 hover:text-blue-600\">\n                                  <MessageSquare className=\"w-4 h-4\" />\n                                  √ötil ({review.helpfulVotes})\n                                </button>\n                                {review.isVerified && (\n                                  <span className=\"flex items-center gap-1 text-green-600\">\n                                    <CheckCircle className=\"w-4 h-4\" />\n                                    Verificado\n                                  </span>\n                                )}\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <div className=\"text-center py-8\">\n                      <MessageSquare className=\"w-12 h-12 text-gray-400 mx-auto mb-4\" />\n                      <h3 className=\"text-lg font-semibold text-gray-900 mb-2\">\n                        Nenhuma avalia√ß√£o ainda\n                      </h3>\n                      <p className=\"text-gray-600\">\n                        Seja o primeiro a avaliar esta atividade!\n                      </p>\n                    </div>\n                  )}\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"location\" className=\"mt-6\">\n                <div className=\"bg-white rounded-lg border p-6\">\n                  <h3 className=\"font-semibold text-gray-900 mb-4\">Localiza√ß√£o</h3>\n                  <div className=\"flex items-center gap-2 mb-4\">\n                    <MapPin className=\"w-5 h-5 text-red-600\" />\n                    <span className=\"text-gray-700\">{activity.location}</span>\n                  </div>\n                  \n                  {/* Placeholder for map */}\n                  <div className=\"bg-gray-100 rounded-lg h-64 flex items-center justify-center\">\n                    <div className=\"text-center\">\n                      <MapPin className=\"w-12 h-12 text-gray-400 mx-auto mb-2\" />\n                      <p className=\"text-gray-600\">Mapa interativo em breve</p>\n                    </div>\n                  </div>\n                </div>\n              </TabsContent>\n            </Tabs>\n          </div>\n\n          {/* Sidebar */}\n          <div className=\"lg:col-span-1\">\n            <div className=\"bg-white rounded-lg border p-6 sticky top-6\">\n              <div className=\"text-center mb-6\">\n                <div className=\"text-3xl font-bold text-blue-600 mb-2\">\n                  {formatPrice(activity.priceType, activity.priceAmount)}\n                </div>\n                <div className=\"text-sm text-gray-600\">\n                  {activity.priceType === \"per_person\" ? \"por pessoa\" : \"por grupo\"}\n                </div>\n              </div>\n\n              <Dialog open={showBookingDialog} onOpenChange={setShowBookingDialog}>\n                <DialogTrigger asChild>\n                  <Button className=\"w-full mb-3 bg-blue-600 hover:bg-blue-700\">\n                    <Calendar className=\"w-4 h-4 mr-2\" />\n                    Reservar Agora\n                  </Button>\n                </DialogTrigger>\n              </Dialog>\n\n              <Button \n                onClick={() => setShowAddToTripDialog(true)}\n                variant=\"outline\" \n                className=\"w-full mb-4 border-blue-600 text-blue-600 hover:bg-blue-50\"\n              >\n                <Plane className=\"w-4 h-4 mr-2\" />\n                Adicionar √† Viagem\n              </Button>\n\n              <Dialog open={showBookingDialog} onOpenChange={setShowBookingDialog}>\n                <DialogTrigger asChild>\n                  <div style={{ display: 'none' }}></div>\n                </DialogTrigger>\n                <DialogContent>\n                  <DialogHeader>\n                    <DialogTitle>Reservar Atividade</DialogTitle>\n                  </DialogHeader>\n                  \n                  <Form {...bookingForm}>\n                    <form onSubmit={bookingForm.handleSubmit((data) => {\n                      bookingMutation.mutate({ ...data, totalAmount: calculateTotalPrice() });\n                    })} className=\"space-y-4\">\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <FormField\n                          control={bookingForm.control}\n                          name=\"participants\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>Participantes</FormLabel>\n                              <FormControl>\n                                <Input \n                                  type=\"number\" \n                                  min=\"1\" \n                                  max={activity.maxParticipants || 50}\n                                  {...field}\n                                  onChange={(e) => field.onChange(Number(e.target.value))}\n                                />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                        \n                        <FormField\n                          control={bookingForm.control}\n                          name=\"bookingDate\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>Data</FormLabel>\n                              <FormControl>\n                                <Input \n                                  type=\"date\" \n                                  {...field}\n                                  value={field.value instanceof Date ? field.value.toISOString().split('T')[0] : field.value}\n                                  onChange={(e) => field.onChange(new Date(e.target.value))}\n                                />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                      </div>\n\n                      <FormField\n                        control={bookingForm.control}\n                        name=\"contactName\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Nome completo</FormLabel>\n                            <FormControl>\n                              <Input placeholder=\"Seu nome completo\" {...field} />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <FormField\n                          control={bookingForm.control}\n                          name=\"contactEmail\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>Email</FormLabel>\n                              <FormControl>\n                                <Input type=\"email\" placeholder=\"seu@email.com\" {...field} />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                        \n                        <FormField\n                          control={bookingForm.control}\n                          name=\"contactPhone\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>Telefone</FormLabel>\n                              <FormControl>\n                                <Input placeholder=\"(11) 99999-9999\" {...field} />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                      </div>\n\n                      <FormField\n                        control={bookingForm.control}\n                        name=\"specialRequests\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Observa√ß√µes especiais</FormLabel>\n                            <FormControl>\n                              <Textarea \n                                placeholder=\"Alguma observa√ß√£o ou solicita√ß√£o especial...\"\n                                {...field}\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <div className=\"border-t pt-4\">\n                        <div className=\"flex justify-between items-center text-lg font-semibold\">\n                          <span>Total:</span>\n                          <span className=\"text-blue-600\">\n                            {new Intl.NumberFormat(\"pt-BR\", {\n                              style: \"currency\",\n                              currency: \"BRL\",\n                            }).format(calculateTotalPrice())}\n                          </span>\n                        </div>\n                      </div>\n\n                      <div className=\"flex gap-2\">\n                        <Button \n                          type=\"button\" \n                          variant=\"outline\" \n                          onClick={() => setShowBookingDialog(false)}\n                          className=\"flex-1\"\n                        >\n                          Cancelar\n                        </Button>\n                        <Button \n                          type=\"submit\" \n                          disabled={bookingMutation.isPending}\n                          className=\"flex-1\"\n                        >\n                          {bookingMutation.isPending ? \"Reservando...\" : \"Confirmar Reserva\"}\n                        </Button>\n                      </div>\n                    </form>\n                  </Form>\n                </DialogContent>\n              </Dialog>\n\n              \n\n              <Separator className=\"my-6\" />\n\n              {/* Contact Info */}\n              {activity.contactInfo && (\n                <div>\n                  <h3 className=\"font-semibold text-gray-900 mb-4\">\n                    Informa√ß√µes de Contato\n                  </h3>\n                  <div className=\"space-y-3\">\n                    {activity.contactInfo.email && (\n                      <div className=\"flex items-center gap-3\">\n                        <Mail className=\"w-4 h-4 text-gray-600\" />\n                        <a \n                          href={`mailto:${activity.contactInfo.email}`}\n                          className=\"text-sm text-blue-600 hover:underline\"\n                        >\n                          {activity.contactInfo.email}\n                        </a>\n                      </div>\n                    )}\n                    \n                    {activity.contactInfo.phone && (\n                      <div className=\"flex items-center gap-3\">\n                        <Phone className=\"w-4 h-4 text-gray-600\" />\n                        <a \n                          href={`tel:${activity.contactInfo.phone}`}\n                          className=\"text-sm text-blue-600 hover:underline\"\n                        >\n                          {activity.contactInfo.phone}\n                        </a>\n                      </div>\n                    )}\n                    \n                    {activity.contactInfo.whatsapp && (\n                      <div className=\"flex items-center gap-3\">\n                        <MessageCircle className=\"w-4 h-4 text-gray-600\" />\n                        <a \n                          href={`https://wa.me/${activity.contactInfo.whatsapp}`}\n                          className=\"text-sm text-blue-600 hover:underline\"\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                        >\n                          WhatsApp\n                        </a>\n                      </div>\n                    )}\n                    \n                    {activity.contactInfo.website && (\n                      <div className=\"flex items-center gap-3\">\n                        <Globe className=\"w-4 h-4 text-gray-600\" />\n                        <a \n                          href={activity.contactInfo.website}\n                          className=\"text-sm text-blue-600 hover:underline\"\n                          target=\"_blank\"\n                          rel=\"noopener noreferrer\"\n                        >\n                          Website\n                        </a>\n                      </div>\n                    )}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Add to Trip Dialog */}\n      <AddActivityToTrip \n        activity={activity}\n        isOpen={showAddToTripDialog}\n        onClose={() => setShowAddToTripDialog(false)}\n      />\n    </div>\n  );\n}","size_bytes":32769},"attached_assets/content-1752297734445.md":{"content":"![](https://guiaviajarmelhor.com.br/wp-content/uploads/2019/01/Curiosidades-cruzeiro-navio-1.jpg)","size_bytes":97},"server/activity-import-manager.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { eq, and, gte, lte } from 'drizzle-orm';\n\n// Utility functions for activity management\n\n/**\n * Import activities with proposals\n */\nexport async function importActivities(activitiesData: any[], source: string = 'import') {\n  console.log(`üöÄ Iniciando importa√ß√£o de ${activitiesData.length} atividades (${source})...`);\n  \n  const results = [];\n  \n  try {\n    for (const activityData of activitiesData) {\n      console.log(`üìç Adicionando: ${activityData.title}`);\n      \n      // Validate required fields\n      if (!activityData.title || !activityData.location || !activityData.category) {\n        console.error(`‚ùå Campos obrigat√≥rios faltando para: ${activityData.title}`);\n        continue;\n      }\n      \n      // Insert activity\n      const [activity] = await db.insert(activities).values({\n        title: activityData.title,\n        description: activityData.description,\n        location: activityData.location,\n        category: activityData.category,\n        duration: activityData.duration || 1,\n        difficulty: activityData.difficulty || 'easy',\n        priceRange: activityData.priceRange || 'Consultar',\n        coverImage: activityData.coverImage || 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80',\n        rating: activityData.rating || \"4.5\",\n        reviewCount: activityData.reviewCount || 0,\n        isActive: true,\n        createdById: 1\n      });\n      \n      const activityId = activity.insertId;\n      console.log(`‚úÖ Atividade criada com ID: ${activityId}`);\n      \n      // Add budget proposals\n      if (activityData.proposals && activityData.proposals.length > 0) {\n        for (const proposal of activityData.proposals) {\n          await db.insert(activityBudgetProposals).values({\n            activityId: activityId,\n            createdBy: 1,\n            title: proposal.title,\n            description: proposal.description,\n            amount: proposal.price.toString(),\n            inclusions: JSON.stringify(proposal.inclusions || []),\n            exclusions: JSON.stringify(proposal.exclusions || []),\n            votes: Math.floor(Math.random() * 60) + 20,\n            isActive: true\n          });\n          \n          console.log(`üí∞ Proposta \"${proposal.title}\" criada: R$ ${proposal.price}`);\n        }\n      }\n      \n      results.push({ id: activityId, title: activityData.title });\n      console.log(`‚úÖ \"${activityData.title}\" configurada!\\n`);\n    }\n    \n    console.log(`üéâ Importa√ß√£o conclu√≠da! ${results.length} atividades adicionadas.`);\n    return results;\n    \n  } catch (error) {\n    console.error('‚ùå Erro durante a importa√ß√£o:', error);\n    throw error;\n  }\n}\n\n/**\n * Verify activities by location\n */\nexport async function verifyActivitiesByLocation(location: string) {\n  console.log(`üîç Verificando atividades de ${location}...`);\n  \n  try {\n    const locationActivities = await db\n      .select()\n      .from(activities)\n      .where(eq(activities.location, location));\n    \n    console.log(`üìä Encontradas ${locationActivities.length} atividades em ${location}`);\n    \n    for (const activity of locationActivities) {\n      const proposals = await db\n        .select()\n        .from(activityBudgetProposals)\n        .where(eq(activityBudgetProposals.activityId, activity.id));\n      \n      console.log(`üéØ ${activity.title} - ${proposals.length} propostas`);\n    }\n    \n    return locationActivities;\n    \n  } catch (error) {\n    console.error('‚ùå Erro na verifica√ß√£o:', error);\n    return [];\n  }\n}\n\n/**\n * Delete activities by ID range\n */\nexport async function deleteActivitiesRange(startId: number, endId: number) {\n  console.log(`üóëÔ∏è Removendo atividades de ID ${startId} a ${endId}...`);\n  \n  try {\n    // First delete proposals\n    await db.delete(activityBudgetProposals).where(\n      and(\n        gte(activityBudgetProposals.activityId, startId),\n        lte(activityBudgetProposals.activityId, endId)\n      )\n    );\n    \n    // Then delete activities\n    await db.delete(activities).where(\n      and(\n        gte(activities.id, startId),\n        lte(activities.id, endId)\n      )\n    );\n    \n    console.log(`‚úÖ Atividades removidas com sucesso!`);\n    \n  } catch (error) {\n    console.error('‚ùå Erro ao remover atividades:', error);\n    throw error;\n  }\n}\n\n/**\n * Get activity statistics\n */\nexport async function getActivityStats() {\n  console.log('üìä Coletando estat√≠sticas de atividades...');\n  \n  try {\n    const allActivities = await db.select().from(activities);\n    const allProposals = await db.select().from(activityBudgetProposals);\n    \n    // Group by location\n    const byLocation = allActivities.reduce((acc, activity) => {\n      acc[activity.location] = (acc[activity.location] || 0) + 1;\n      return acc;\n    }, {} as Record<string, number>);\n    \n    // Group by category\n    const byCategory = allActivities.reduce((acc, activity) => {\n      acc[activity.category] = (acc[activity.category] || 0) + 1;\n      return acc;\n    }, {} as Record<string, number>);\n    \n    const stats = {\n      totalActivities: allActivities.length,\n      totalProposals: allProposals.length,\n      byLocation,\n      byCategory,\n      avgProposalsPerActivity: allProposals.length / allActivities.length\n    };\n    \n    console.log('üìà Estat√≠sticas:');\n    console.log(`   üéØ Total de atividades: ${stats.totalActivities}`);\n    console.log(`   üí∞ Total de propostas: ${stats.totalProposals}`);\n    console.log(`   üìä M√©dia de propostas por atividade: ${stats.avgProposalsPerActivity.toFixed(2)}`);\n    \n    console.log(`   üìç Por localiza√ß√£o:`);\n    Object.entries(stats.byLocation).forEach(([location, count]) => {\n      console.log(`     - ${location}: ${count} atividades`);\n    });\n    \n    console.log(`   üìÇ Por categoria:`);\n    Object.entries(stats.byCategory).forEach(([category, count]) => {\n      console.log(`     - ${category}: ${count} atividades`);\n    });\n    \n    return stats;\n    \n  } catch (error) {\n    console.error('‚ùå Erro ao coletar estat√≠sticas:', error);\n    return null;\n  }\n}\n\n/**\n * Fix proposal amounts (convert price field to amount)\n */\nexport async function fixProposalAmounts() {\n  console.log('üîß Corrigindo campos de propostas...');\n  \n  try {\n    const proposals = await db.select().from(activityBudgetProposals);\n    \n    for (const proposal of proposals) {\n      // Check if amount is empty or null\n      if (!proposal.amount || proposal.amount === '0' || proposal.amount === '0.00') {\n        // Try to extract from description or set default\n        const defaultAmount = '100.00';\n        await db.update(activityBudgetProposals)\n          .set({ amount: defaultAmount })\n          .where(eq(activityBudgetProposals.id, proposal.id));\n        \n        console.log(`üîÑ Proposta ${proposal.id} corrigida: R$ ${defaultAmount}`);\n      }\n    }\n    \n    console.log('‚úÖ Corre√ß√£o conclu√≠da!');\n    \n  } catch (error) {\n    console.error('‚ùå Erro na corre√ß√£o:', error);\n    throw error;\n  }\n}\n\n// CLI interface\nconst command = process.argv[2];\nconst args = process.argv.slice(3);\n\nif (command === 'stats') {\n  getActivityStats();\n} else if (command === 'verify' && args[0]) {\n  verifyActivitiesByLocation(args[0]);\n} else if (command === 'delete' && args[0] && args[1]) {\n  deleteActivitiesRange(parseInt(args[0]), parseInt(args[1]));\n} else if (command === 'fix') {\n  fixProposalAmounts();\n} else {\n  console.log(`\nüöÄ PartiuTrip Activity Import Manager\n\nComandos dispon√≠veis:\n  npm run activity-manager stats                    - Estat√≠sticas gerais\n  npm run activity-manager verify \"Cidade, Estado\" - Verificar atividades por localiza√ß√£o\n  npm run activity-manager delete start end        - Remover atividades por range de ID\n  npm run activity-manager fix                     - Corrigir campos de propostas\n\nExemplos:\n  npx tsx server/activity-import-manager.ts stats\n  npx tsx server/activity-import-manager.ts verify \"Rio de Janeiro, RJ\"\n  npx tsx server/activity-import-manager.ts delete 20 25\n  npx tsx server/activity-import-manager.ts fix\n  `);\n}","size_bytes":8171},"server/add-activities-for-all-destinations.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\n\n// Atividades para todos os destinos das viagens\nconst DESTINATION_ACTIVITIES = {\n  'Pantanal, MT': [\n    {\n      title: 'Safari Fotogr√°fico no Pantanal',\n      description: 'Experi√™ncia √∫nica de observa√ß√£o da vida selvagem pantaneira com guide especializado.',\n      location: 'Pantanal, MT',\n      category: 'wildlife',\n      duration: \"480 horas\",\n      difficulty: 'medium',\n      minParticipants: 2,\n      maxParticipants: 8,\n      coverImage: 'https://images.unsplash.com/photo-1547036967-23d11aacaee0?w=1200&h=800&fit=crop&q=85',\n      rating: 4.8\n    }\n  ],\n  'Salvador, BA': [\n    {\n      title: 'Tour Cultural Pelourinho',\n      description: 'Caminhada hist√≥rica pelo centro hist√≥rico de Salvador com degusta√ß√£o de acaraj√©.',\n      location: 'Salvador, BA',\n      category: 'cultural',\n      duration: \"240 horas\",\n      difficulty: 'easy',\n      minParticipants: 1,\n      maxParticipants: 15,\n      coverImage: 'https://images.unsplash.com/photo-1582639590060-4d48706bb007?w=1200&h=800&fit=crop&q=85',\n      rating: 4.7\n    }\n  ],\n  'Serra da Mantiqueira, MG': [\n    {\n      title: 'Trilha do Pico da Bandeira',\n      description: 'Aventura de trekking ao terceiro ponto mais alto do Brasil.',\n      location: 'Serra da Mantiqueira, MG',\n      category: 'hiking',\n      duration: \"720 horas\",\n      difficulty: 'hard',\n      minParticipants: 2,\n      maxParticipants: 10,\n      coverImage: 'https://images.unsplash.com/photo-1551632811-561732d1e306?w=1200&h=800&fit=crop&q=85',\n      rating: 4.9\n    }\n  ],\n  'Maragogi, AL': [\n    {\n      title: 'Mergulho nas Gal√©s de Maragogi',\n      description: 'Mergulho com snorkel nas piscinas naturais mais famosas do Brasil.',\n      location: 'Maragogi, AL',\n      category: 'water_sports',\n      duration: \"360 horas\",\n      difficulty: 'easy',\n      minParticipants: 2,\n      maxParticipants: 12,\n      coverImage: 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=1200&h=800&fit=crop&q=85',\n      rating: 4.8\n    }\n  ],\n  'Ouro Preto, MG': [\n    {\n      title: 'Tour pelas Igrejas Hist√≥ricas',\n      description: 'Visita guiada √†s principais igrejas barrocas de Ouro Preto.',\n      location: 'Ouro Preto, MG',\n      category: 'cultural',\n      duration: \"300 horas\",\n      difficulty: 'easy',\n      minParticipants: 1,\n      maxParticipants: 20,\n      coverImage: 'https://images.unsplash.com/photo-1548013146-72479768bada?w=1200&h=800&fit=crop&q=85',\n      rating: 4.6\n    }\n  ],\n  'Manaus, AM': [\n    {\n      title: 'Expedi√ß√£o Rio Amazonas',\n      description: 'Navega√ß√£o pelo Rio Amazonas com pernoite em lodge na floresta.',\n      location: 'Manaus, AM',\n      category: 'nature',\n      duration: \"1440 horas\",\n      difficulty: 'medium',\n      minParticipants: 2,\n      maxParticipants: 16,\n      coverImage: 'https://images.unsplash.com/photo-1516026672322-bc52d61a55d5?w=1200&h=800&fit=crop&q=85',\n      rating: 4.9\n    }\n  ],\n  'Florian√≥polis, SC': [\n    {\n      title: 'Aulas de Surf na Joaquina',\n      description: 'Aulas de surf para iniciantes na famosa praia da Joaquina.',\n      location: 'Florian√≥polis, SC',\n      category: 'water_sports',\n      duration: \"180 horas\",\n      difficulty: 'easy',\n      minParticipants: 1,\n      maxParticipants: 6,\n      coverImage: 'https://images.unsplash.com/photo-1502680390469-be75c86b636f?w=1200&h=800&fit=crop&q=85',\n      rating: 4.5\n    }\n  ],\n  'Serra Ga√∫cha, RS': [\n    {\n      title: 'Tour de Vin√≠colas',\n      description: 'Degusta√ß√£o de vinhos em vin√≠colas tradicionais da regi√£o.',\n      location: 'Serra Ga√∫cha, RS',\n      category: 'food_tours',\n      duration: \"480 horas\",\n      difficulty: 'easy',\n      minParticipants: 2,\n      maxParticipants: 20,\n      coverImage: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1200&h=800&fit=crop&q=85',\n      rating: 4.7\n    }\n  ],\n  'Len√ß√≥is Maranhenses, MA': [\n    {\n      title: 'Trekking pelas Dunas',\n      description: 'Caminhada pelas dunas e lagoas dos Len√ß√≥is Maranhenses.',\n      location: 'Len√ß√≥is Maranhenses, MA',\n      category: 'hiking',\n      duration: \"360 horas\",\n      difficulty: 'medium',\n      minParticipants: 2,\n      maxParticipants: 12,\n      coverImage: 'https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=1200&h=800&fit=crop&q=85',\n      rating: 4.8\n    }\n  ],\n  'Caruaru, PE': [\n    {\n      title: 'Festival de S√£o Jo√£o',\n      description: 'Participa√ß√£o nas festividades juninas tradicionais de Caruaru.',\n      location: 'Caruaru, PE',\n      category: 'cultural',\n      duration: \"480 horas\",\n      difficulty: 'easy',\n      minParticipants: 1,\n      maxParticipants: 50,\n      coverImage: 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=1200&h=800&fit=crop&q=85',\n      rating: 4.6\n    }\n  ]\n};\n\nasync function addActivitiesForAllDestinations() {\n  try {\n    console.log('üåü ADICIONANDO ATIVIDADES PARA TODOS OS DESTINOS...\\n');\n    \n    let totalAdded = 0;\n    \n    for (const [destination, destinationActivities] of Object.entries(DESTINATION_ACTIVITIES)) {\n      console.log(`üìç Adicionando atividades para ${destination}:`);\n      \n      for (const activityData of destinationActivities) {\n        try {\n          // Verificar se a atividade j√° existe\n          const existing = await db.select()\n            .from(activities)\n            .where(eq(activities.title, activityData.title))\n            .limit(1);\n          \n          if (existing.length > 0) {\n            console.log(`  ‚ö†Ô∏è  Atividade \"${activityData.title}\" j√° existe`);\n            continue;\n          }\n          \n          // Inserir atividade\n          const result = await db.insert(activities).values(activityData);\n          const activityId = result.insertId;\n          \n          console.log(`  ‚úÖ Atividade \"${activityData.title}\" criada (ID: ${activityId})`);\n          \n          // Adicionar propostas de or√ßamento\n          const proposals = [\n            {\n              activityId: Number(activityId),\n              title: 'Econ√¥mico',\n              price: 80,\n              inclusions: ['Guia local', 'Seguro'],\n              exclusions: ['Transporte', 'Alimenta√ß√£o'],\n              description: 'Op√ß√£o b√°sica com o essencial'\n            },\n            {\n              activityId: Number(activityId),\n              title: 'Completo',\n              price: 150,\n              inclusions: ['Guia especializado', 'Transporte', 'Seguro', 'Lanche'],\n              exclusions: ['Alimenta√ß√£o completa'],\n              description: 'Experi√™ncia completa com conforto'\n            },\n            {\n              activityId: Number(activityId),\n              title: 'Premium',\n              price: 250,\n              inclusions: ['Guia especializado', 'Transporte executivo', 'Seguro', 'Alimenta√ß√£o completa', 'Fotos profissionais'],\n              exclusions: [],\n              description: 'Experi√™ncia de luxo com todos os extras'\n            }\n          ];\n          \n          for (const proposal of proposals) {\n            await db.insert(activityBudgetProposals).values({\n              ...proposal,\n              inclusions: JSON.stringify(proposal.inclusions),\n              exclusions: JSON.stringify(proposal.exclusions)\n            });\n          }\n          \n          console.log(`    üí∞ 3 propostas de or√ßamento adicionadas`);\n          totalAdded++;\n          \n        } catch (error) {\n          console.error(`  ‚ùå Erro ao adicionar \"${activityData.title}\":`, error);\n        }\n      }\n    }\n    \n    console.log(`\\n‚úÖ Processo conclu√≠do! ${totalAdded} novas atividades adicionadas.`);\n    \n    // Verificar resultado final\n    console.log('\\nüîç VERIFICANDO CORRESPOND√äNCIAS FINAIS...');\n    \n    const allActivities = await db.select().from(activities);\n    const activityLocations = [...new Set(allActivities.map(a => a.location))].filter(Boolean);\n    \n    console.log('\\nüèõÔ∏è LOCALIZA√á√ïES DAS ATIVIDADES (ap√≥s adi√ß√£o):');\n    activityLocations.forEach(loc => {\n      const count = allActivities.filter(a => a.location === loc).length;\n      console.log(`  - \"${loc}\" (${count} atividades)`);\n    });\n    \n    // Verificar quais destinos ainda precisam de atividades\n    const tripsResult = await db.execute(`\n      SELECT DISTINCT destination \n      FROM trips \n      WHERE destination IS NOT NULL \n        AND destination != 'undefined' \n        AND destination != ''\n    `);\n    \n    const tripDestinations = (tripsResult as any).map(row => row.destination).filter(Boolean);\n    \n    console.log('\\nüìç DESTINOS DAS VIAGENS:');\n    tripDestinations.forEach(dest => console.log(`  - \"${dest}\"`));\n    \n    const matched = activityLocations.filter(loc => tripDestinations.includes(loc));\n    const missingActivities = tripDestinations.filter(dest => !activityLocations.includes(dest));\n    \n    console.log(`\\n‚úÖ Destinos com atividades: ${matched.length}`);\n    matched.forEach(loc => console.log(`  ‚úì \"${loc}\"`));\n    \n    console.log(`\\nüö® Destinos ainda sem atividades: ${missingActivities.length}`);\n    missingActivities.forEach(dest => console.log(`  ‚ö†Ô∏è \"${dest}\"`));\n    \n  } catch (error) {\n    console.error('‚ùå Erro durante processo:', error);\n  }\n  \n  process.exit(0);\n}\n\naddActivitiesForAllDestinations();","size_bytes":9393},"server/add-all-cities-final.ts":{"content":"import { db } from './db';\nimport { destinations } from '../shared/schema';\nimport { eq } from 'drizzle-orm';\n\nconst allCitiesFromComprehensiveList = [\n  // Regi√£o Sudeste - Rio de Janeiro\n  { name: \"Rio de Janeiro\", state: \"RJ\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -22.9068, longitude: -43.1729, timezone: \"America/Sao_Paulo\" },\n  { name: \"Paraty\", state: \"RJ\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -23.2178, longitude: -44.7175, timezone: \"America/Sao_Paulo\" },\n  { name: \"Petr√≥polis\", state: \"RJ\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -22.5058, longitude: -43.1780, timezone: \"America/Sao_Paulo\" },\n  { name: \"Angra dos Reis\", state: \"RJ\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -23.0067, longitude: -44.3185, timezone: \"America/Sao_Paulo\" },\n  { name: \"B√∫zios\", state: \"RJ\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -22.7470, longitude: -41.8818, timezone: \"America/Sao_Paulo\" },\n  { name: \"Ilha Grande\", state: \"RJ\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -23.1394, longitude: -44.2186, timezone: \"America/Sao_Paulo\" },\n  { name: \"Teres√≥polis\", state: \"RJ\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -22.4126, longitude: -42.9664, timezone: \"America/Sao_Paulo\" },\n  { name: \"Niter√≥i\", state: \"RJ\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -22.8833, longitude: -43.1036, timezone: \"America/Sao_Paulo\" },\n\n  // Regi√£o Sudeste - S√£o Paulo\n  { name: \"S√£o Paulo\", state: \"SP\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -23.5505, longitude: -46.6333, timezone: \"America/Sao_Paulo\" },\n  { name: \"Campos do Jord√£o\", state: \"SP\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -22.7389, longitude: -45.5913, timezone: \"America/Sao_Paulo\" },\n  { name: \"Ubatuba\", state: \"SP\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -23.4340, longitude: -45.0839, timezone: \"America/Sao_Paulo\" },\n  { name: \"Ilhabela\", state: \"SP\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -23.7781, longitude: -45.3581, timezone: \"America/Sao_Paulo\" },\n  { name: \"Santos\", state: \"SP\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -23.9618, longitude: -46.3322, timezone: \"America/Sao_Paulo\" },\n  { name: \"S√£o Sebasti√£o\", state: \"SP\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -23.8153, longitude: -45.4063, timezone: \"America/Sao_Paulo\" },\n  { name: \"Brotas\", state: \"SP\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -22.2847, longitude: -47.9859, timezone: \"America/Sao_Paulo\" },\n  { name: \"Holambra\", state: \"SP\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -22.6318, longitude: -47.0534, timezone: \"America/Sao_Paulo\" },\n  { name: \"Embu das Artes\", state: \"SP\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -23.6489, longitude: -46.8520, timezone: \"America/Sao_Paulo\" },\n  { name: \"Campinas\", state: \"SP\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -22.9099, longitude: -47.0626, timezone: \"America/Sao_Paulo\" },\n\n  // Regi√£o Sudeste - Minas Gerais\n  { name: \"Belo Horizonte\", state: \"MG\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -19.9245, longitude: -43.9352, timezone: \"America/Sao_Paulo\" },\n  { name: \"Ouro Preto\", state: \"MG\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -20.3856, longitude: -43.5035, timezone: \"America/Sao_Paulo\" },\n  { name: \"Tiradentes\", state: \"MG\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -21.1098, longitude: -44.1748, timezone: \"America/Sao_Paulo\" },\n  { name: \"Mariana\", state: \"MG\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -20.3777, longitude: -43.4168, timezone: \"America/Sao_Paulo\" },\n  { name: \"Capit√≥lio\", state: \"MG\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -20.6172, longitude: -46.0648, timezone: \"America/Sao_Paulo\" },\n  { name: \"Diamantina\", state: \"MG\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -18.2396, longitude: -43.6012, timezone: \"America/Sao_Paulo\" },\n  { name: \"S√£o Thom√© das Letras\", state: \"MG\", country: \"Brasil\", countryType: \"nacional\", region: \"Sudeste\", continent: \"Am√©rica do Sul\", latitude: -21.7147, longitude: -44.9826, timezone: \"America/Sao_Paulo\" },\n\n  // Regi√£o Sul - Paran√°\n  { name: \"Curitiba\", state: \"PR\", country: \"Brasil\", countryType: \"nacional\", region: \"Sul\", continent: \"Am√©rica do Sul\", latitude: -25.4284, longitude: -49.2733, timezone: \"America/Sao_Paulo\" },\n  { name: \"Foz do Igua√ßu\", state: \"PR\", country: \"Brasil\", countryType: \"nacional\", region: \"Sul\", continent: \"Am√©rica do Sul\", latitude: -25.5478, longitude: -54.5882, timezone: \"America/Sao_Paulo\" },\n  { name: \"Ilha do Mel\", state: \"PR\", country: \"Brasil\", countryType: \"nacional\", region: \"Sul\", continent: \"Am√©rica do Sul\", latitude: -25.5167, longitude: -48.3000, timezone: \"America/Sao_Paulo\" },\n  { name: \"Morretes\", state: \"PR\", country: \"Brasil\", countryType: \"nacional\", region: \"Sul\", continent: \"Am√©rica do Sul\", latitude: -25.4661, longitude: -48.8375, timezone: \"America/Sao_Paulo\" },\n\n  // Regi√£o Sul - Santa Catarina\n  { name: \"Florian√≥polis\", state: \"SC\", country: \"Brasil\", countryType: \"nacional\", region: \"Sul\", continent: \"Am√©rica do Sul\", latitude: -27.5954, longitude: -48.5480, timezone: \"America/Sao_Paulo\" },\n  { name: \"Balne√°rio Cambori√∫\", state: \"SC\", country: \"Brasil\", countryType: \"nacional\", region: \"Sul\", continent: \"Am√©rica do Sul\", latitude: -26.9906, longitude: -48.6349, timezone: \"America/Sao_Paulo\" },\n  { name: \"Blumenau\", state: \"SC\", country: \"Brasil\", countryType: \"nacional\", region: \"Sul\", continent: \"Am√©rica do Sul\", latitude: -26.9194, longitude: -49.0661, timezone: \"America/Sao_Paulo\" },\n\n  // Regi√£o Sul - Rio Grande do Sul\n  { name: \"Gramado\", state: \"RS\", country: \"Brasil\", countryType: \"nacional\", region: \"Sul\", continent: \"Am√©rica do Sul\", latitude: -29.3788, longitude: -50.8742, timezone: \"America/Sao_Paulo\" },\n  { name: \"Canela\", state: \"RS\", country: \"Brasil\", countryType: \"nacional\", region: \"Sul\", continent: \"Am√©rica do Sul\", latitude: -29.3648, longitude: -50.8151, timezone: \"America/Sao_Paulo\" },\n  { name: \"Porto Alegre\", state: \"RS\", country: \"Brasil\", countryType: \"nacional\", region: \"Sul\", continent: \"Am√©rica do Sul\", latitude: -30.0346, longitude: -51.2177, timezone: \"America/Sao_Paulo\" },\n\n  // Regi√£o Nordeste - Bahia\n  { name: \"Salvador\", state: \"BA\", country: \"Brasil\", countryType: \"nacional\", region: \"Nordeste\", continent: \"Am√©rica do Sul\", latitude: -12.9714, longitude: -38.5014, timezone: \"America/Bahia\" },\n  { name: \"Porto Seguro\", state: \"BA\", country: \"Brasil\", countryType: \"nacional\", region: \"Nordeste\", continent: \"Am√©rica do Sul\", latitude: -16.4497, longitude: -39.0647, timezone: \"America/Bahia\" },\n\n  // Regi√£o Nordeste - Cear√°\n  { name: \"Fortaleza\", state: \"CE\", country: \"Brasil\", countryType: \"nacional\", region: \"Nordeste\", continent: \"Am√©rica do Sul\", latitude: -3.7275, longitude: -38.5138, timezone: \"America/Fortaleza\" },\n  { name: \"Jericoacoara\", state: \"CE\", country: \"Brasil\", countryType: \"nacional\", region: \"Nordeste\", continent: \"Am√©rica do Sul\", latitude: -2.7928, longitude: -40.5142, timezone: \"America/Fortaleza\" },\n\n  // Regi√£o Nordeste - Rio Grande do Norte\n  { name: \"Natal\", state: \"RN\", country: \"Brasil\", countryType: \"nacional\", region: \"Nordeste\", continent: \"Am√©rica do Sul\", latitude: -5.7945, longitude: -35.2110, timezone: \"America/Fortaleza\" },\n\n  // Regi√£o Nordeste - Para√≠ba\n  { name: \"Jo√£o Pessoa\", state: \"PB\", country: \"Brasil\", countryType: \"nacional\", region: \"Nordeste\", continent: \"Am√©rica do Sul\", latitude: -7.1195, longitude: -34.8450, timezone: \"America/Fortaleza\" },\n\n  // Regi√£o Nordeste - Pernambuco\n  { name: \"Recife\", state: \"PE\", country: \"Brasil\", countryType: \"nacional\", region: \"Nordeste\", continent: \"Am√©rica do Sul\", latitude: -8.0476, longitude: -34.8770, timezone: \"America/Recife\" },\n  { name: \"Fernando de Noronha\", state: \"PE\", country: \"Brasil\", countryType: \"nacional\", region: \"Nordeste\", continent: \"Am√©rica do Sul\", latitude: -3.8549, longitude: -32.4297, timezone: \"America/Noronha\" },\n  { name: \"Caruaru\", state: \"PE\", country: \"Brasil\", countryType: \"nacional\", region: \"Nordeste\", continent: \"Am√©rica do Sul\", latitude: -8.2840, longitude: -35.9708, timezone: \"America/Recife\" },\n\n  // Regi√£o Nordeste - Alagoas\n  { name: \"Macei√≥\", state: \"AL\", country: \"Brasil\", countryType: \"nacional\", region: \"Nordeste\", continent: \"Am√©rica do Sul\", latitude: -9.6658, longitude: -35.7353, timezone: \"America/Maceio\" },\n  { name: \"Maragogi\", state: \"AL\", country: \"Brasil\", countryType: \"nacional\", region: \"Nordeste\", continent: \"Am√©rica do Sul\", latitude: -9.0124, longitude: -35.2226, timezone: \"America/Maceio\" },\n\n  // Regi√£o Nordeste - Maranh√£o\n  { name: \"Barreirinhas\", state: \"MA\", country: \"Brasil\", countryType: \"nacional\", region: \"Nordeste\", continent: \"Am√©rica do Sul\", latitude: -2.7614, longitude: -42.8267, timezone: \"America/Fortaleza\" },\n\n  // Regi√£o Centro-Oeste - Distrito Federal\n  { name: \"Bras√≠lia\", state: \"DF\", country: \"Brasil\", countryType: \"nacional\", region: \"Centro-Oeste\", continent: \"Am√©rica do Sul\", latitude: -15.8267, longitude: -47.9218, timezone: \"America/Sao_Paulo\" },\n\n  // Regi√£o Centro-Oeste - Mato Grosso do Sul\n  { name: \"Bonito\", state: \"MS\", country: \"Brasil\", countryType: \"nacional\", region: \"Centro-Oeste\", continent: \"Am√©rica do Sul\", latitude: -21.1269, longitude: -56.4939, timezone: \"America/Campo_Grande\" },\n  { name: \"Pantanal\", state: \"MS\", country: \"Brasil\", countryType: \"nacional\", region: \"Centro-Oeste\", continent: \"Am√©rica do Sul\", latitude: -19.5830, longitude: -56.1070, timezone: \"America/Campo_Grande\" },\n\n  // Regi√£o Centro-Oeste - Mato Grosso\n  { name: \"Chapada dos Guimar√£es\", state: \"MT\", country: \"Brasil\", countryType: \"nacional\", region: \"Centro-Oeste\", continent: \"Am√©rica do Sul\", latitude: -15.4611, longitude: -55.7508, timezone: \"America/Cuiaba\" },\n\n  // Regi√£o Norte - Amazonas\n  { name: \"Manaus\", state: \"AM\", country: \"Brasil\", countryType: \"nacional\", region: \"Norte\", continent: \"Am√©rica do Sul\", latitude: -3.1190, longitude: -60.0217, timezone: \"America/Manaus\" },\n\n  // Regi√£o Norte - Par√°\n  { name: \"Bel√©m\", state: \"PA\", country: \"Brasil\", countryType: \"nacional\", region: \"Norte\", continent: \"Am√©rica do Sul\", latitude: -1.4558, longitude: -48.5044, timezone: \"America/Belem\" },\n\n  // Am√©rica do Sul - Argentina\n  { name: \"Buenos Aires\", state: null, country: \"Argentina\", countryType: \"internacional\", region: \"Am√©rica do Sul\", continent: \"Am√©rica do Sul\", latitude: -34.6118, longitude: -58.3960, timezone: \"America/Argentina/Buenos_Aires\" },\n  { name: \"Bariloche\", state: null, country: \"Argentina\", countryType: \"internacional\", region: \"Am√©rica do Sul\", continent: \"Am√©rica do Sul\", latitude: -41.1456, longitude: -71.3082, timezone: \"America/Argentina/Bariloche\" },\n  { name: \"Mendoza\", state: null, country: \"Argentina\", countryType: \"internacional\", region: \"Am√©rica do Sul\", continent: \"Am√©rica do Sul\", latitude: -32.8908, longitude: -68.8272, timezone: \"America/Argentina/Mendoza\" },\n\n  // Am√©rica do Sul - Chile\n  { name: \"Santiago\", state: null, country: \"Chile\", countryType: \"internacional\", region: \"Am√©rica do Sul\", continent: \"Am√©rica do Sul\", latitude: -33.4489, longitude: -70.6693, timezone: \"America/Santiago\" },\n\n  // Am√©rica do Sul - Peru\n  { name: \"Lima\", state: null, country: \"Peru\", countryType: \"internacional\", region: \"Am√©rica do Sul\", continent: \"Am√©rica do Sul\", latitude: -12.0464, longitude: -77.0428, timezone: \"America/Lima\" },\n  { name: \"Cusco\", state: null, country: \"Peru\", countryType: \"internacional\", region: \"Am√©rica do Sul\", continent: \"Am√©rica do Sul\", latitude: -13.5170, longitude: -71.9785, timezone: \"America/Lima\" },\n  { name: \"Machu Picchu\", state: null, country: \"Peru\", countryType: \"internacional\", region: \"Am√©rica do Sul\", continent: \"Am√©rica do Sul\", latitude: -13.1631, longitude: -72.5450, timezone: \"America/Lima\" },\n\n  // Am√©rica do Sul - Bol√≠via\n  { name: \"La Paz\", state: null, country: \"Bol√≠via\", countryType: \"internacional\", region: \"Am√©rica do Sul\", continent: \"Am√©rica do Sul\", latitude: -16.5000, longitude: -68.1500, timezone: \"America/La_Paz\" },\n\n  // Am√©rica do Sul - Uruguai\n  { name: \"Montevid√©u\", state: null, country: \"Uruguai\", countryType: \"internacional\", region: \"Am√©rica do Sul\", continent: \"Am√©rica do Sul\", latitude: -34.9011, longitude: -56.1645, timezone: \"America/Montevideo\" },\n\n  // Am√©rica do Sul - Col√¥mbia\n  { name: \"Bogot√°\", state: null, country: \"Col√¥mbia\", countryType: \"internacional\", region: \"Am√©rica do Sul\", continent: \"Am√©rica do Sul\", latitude: 4.7110, longitude: -74.0721, timezone: \"America/Bogota\" },\n\n  // Am√©rica do Norte - Estados Unidos\n  { name: \"Nova York\", state: \"NY\", country: \"Estados Unidos\", countryType: \"internacional\", region: \"Am√©rica do Norte\", continent: \"Am√©rica do Norte\", latitude: 40.7128, longitude: -74.0060, timezone: \"America/New_York\" },\n  { name: \"Los Angeles\", state: \"CA\", country: \"Estados Unidos\", countryType: \"internacional\", region: \"Am√©rica do Norte\", continent: \"Am√©rica do Norte\", latitude: 34.0522, longitude: -118.2437, timezone: \"America/Los_Angeles\" },\n  { name: \"Miami\", state: \"FL\", country: \"Estados Unidos\", countryType: \"internacional\", region: \"Am√©rica do Norte\", continent: \"Am√©rica do Norte\", latitude: 25.7617, longitude: -80.1918, timezone: \"America/New_York\" },\n\n  // Am√©rica do Norte - Canad√°\n  { name: \"Toronto\", state: \"ON\", country: \"Canad√°\", countryType: \"internacional\", region: \"Am√©rica do Norte\", continent: \"Am√©rica do Norte\", latitude: 43.6532, longitude: -79.3832, timezone: \"America/Toronto\" },\n\n  // Am√©rica do Norte - M√©xico\n  { name: \"Canc√∫n\", state: null, country: \"M√©xico\", countryType: \"internacional\", region: \"Am√©rica do Norte\", continent: \"Am√©rica do Norte\", latitude: 21.1619, longitude: -86.8515, timezone: \"America/Cancun\" },\n  { name: \"Cidade do M√©xico\", state: null, country: \"M√©xico\", countryType: \"internacional\", region: \"Am√©rica do Norte\", continent: \"Am√©rica do Norte\", latitude: 19.4326, longitude: -99.1332, timezone: \"America/Mexico_City\" },\n\n  // Europa - Fran√ßa\n  { name: \"Paris\", state: null, country: \"Fran√ßa\", countryType: \"internacional\", region: \"Europa\", continent: \"Europa\", latitude: 48.8566, longitude: 2.3522, timezone: \"Europe/Paris\" },\n\n  // Europa - Reino Unido\n  { name: \"Londres\", state: null, country: \"Reino Unido\", countryType: \"internacional\", region: \"Europa\", continent: \"Europa\", latitude: 51.5074, longitude: -0.1278, timezone: \"Europe/London\" },\n\n  // Europa - It√°lia\n  { name: \"Roma\", state: null, country: \"It√°lia\", countryType: \"internacional\", region: \"Europa\", continent: \"Europa\", latitude: 41.9028, longitude: 12.4964, timezone: \"Europe/Rome\" },\n\n  // Europa - Espanha\n  { name: \"Barcelona\", state: null, country: \"Espanha\", countryType: \"internacional\", region: \"Europa\", continent: \"Europa\", latitude: 41.3851, longitude: 2.1734, timezone: \"Europe/Madrid\" },\n\n  // Europa - Holanda\n  { name: \"Amsterd√£\", state: null, country: \"Holanda\", countryType: \"internacional\", region: \"Europa\", continent: \"Europa\", latitude: 52.3676, longitude: 4.9041, timezone: \"Europe/Amsterdam\" },\n\n  // Europa - Alemanha\n  { name: \"Berlim\", state: null, country: \"Alemanha\", countryType: \"internacional\", region: \"Europa\", continent: \"Europa\", latitude: 52.5200, longitude: 13.4050, timezone: \"Europe/Berlin\" },\n\n  // Europa - Portugal\n  { name: \"Lisboa\", state: null, country: \"Portugal\", countryType: \"internacional\", region: \"Europa\", continent: \"Europa\", latitude: 38.7223, longitude: -9.1393, timezone: \"Europe/Lisbon\" },\n  { name: \"Porto\", state: null, country: \"Portugal\", countryType: \"internacional\", region: \"Europa\", continent: \"Europa\", latitude: 41.1579, longitude: -8.6291, timezone: \"Europe/Lisbon\" },\n\n  // √Åsia - Jap√£o\n  { name: \"T√≥quio\", state: null, country: \"Jap√£o\", countryType: \"internacional\", region: \"√Åsia\", continent: \"√Åsia\", latitude: 35.6762, longitude: 139.6503, timezone: \"Asia/Tokyo\" },\n\n  // √Åsia - Tail√¢ndia\n  { name: \"Bangkok\", state: null, country: \"Tail√¢ndia\", countryType: \"internacional\", region: \"√Åsia\", continent: \"√Åsia\", latitude: 13.7563, longitude: 100.5018, timezone: \"Asia/Bangkok\" },\n\n  // √Åsia - Emirados √Årabes Unidos\n  { name: \"Dubai\", state: null, country: \"Emirados √Årabes\", countryType: \"internacional\", region: \"√Åsia\", continent: \"√Åsia\", latitude: 25.2048, longitude: 55.2708, timezone: \"Asia/Dubai\" },\n\n  // √Åsia - Singapura\n  { name: \"Cingapura\", state: null, country: \"Singapura\", countryType: \"internacional\", region: \"√Åsia\", continent: \"√Åsia\", latitude: 1.3521, longitude: 103.8198, timezone: \"Asia/Singapore\" },\n\n  // √Åfrica - Egito\n  { name: \"Cairo\", state: null, country: \"Egito\", countryType: \"internacional\", region: \"√Åfrica\", continent: \"√Åfrica\", latitude: 30.0444, longitude: 31.2357, timezone: \"Africa/Cairo\" },\n\n  // √Åfrica - √Åfrica do Sul\n  { name: \"Cidade do Cabo\", state: null, country: \"√Åfrica do Sul\", countryType: \"internacional\", region: \"√Åfrica\", continent: \"√Åfrica\", latitude: -33.9249, longitude: 18.4241, timezone: \"Africa/Johannesburg\" },\n\n  // √Åfrica - Marrocos\n  { name: \"Marrakech\", state: null, country: \"Marrocos\", countryType: \"internacional\", region: \"√Åfrica\", continent: \"√Åfrica\", latitude: 31.6295, longitude: -7.9811, timezone: \"Africa/Casablanca\" },\n\n  // Oceania - Austr√°lia\n  { name: \"Sydney\", state: \"NSW\", country: \"Austr√°lia\", countryType: \"internacional\", region: \"Oceania\", continent: \"Oceania\", latitude: -33.8688, longitude: 151.2093, timezone: \"Australia/Sydney\" },\n  { name: \"Melbourne\", state: \"VIC\", country: \"Austr√°lia\", countryType: \"internacional\", region: \"Oceania\", continent: \"Oceania\", latitude: -37.8136, longitude: 144.9631, timezone: \"Australia/Melbourne\" },\n];\n\nexport async function addAllCitiesFinal() {\n  console.log(\"üèôÔ∏è Iniciando cadastro completo de todas as cidades...\");\n  \n  let addedCount = 0;\n  let skippedCount = 0;\n  let errorCount = 0;\n  \n  for (const city of allCitiesFromComprehensiveList) {\n    try {\n      // Check if city already exists\n      const existingCity = await db.select()\n        .from(destinations)\n        .where(eq(destinations.name, city.name))\n        .limit(1);\n      \n      if (existingCity.length > 0) {\n        console.log(`‚è≠Ô∏è Cidade j√° existe: ${city.name}`);\n        skippedCount++;\n        continue;\n      }\n      \n      // Insert new city\n      await db.insert(destinations).values({\n        name: city.name,\n        state: city.state,\n        country: city.country,\n        countryType: city.countryType,\n        region: city.region,\n        continent: city.continent,\n        latitude: city.latitude.toString(),\n        longitude: city.longitude.toString(),\n        timezone: city.timezone,\n        isActive: true\n      });\n      \n      console.log(`‚úÖ Cidade adicionada: ${city.name}, ${city.state || city.country}`);\n      addedCount++;\n      \n    } catch (error) {\n      console.error(`‚ùå Erro ao adicionar cidade ${city.name}:`, error);\n      errorCount++;\n    }\n  }\n  \n  console.log(`\\nüéâ Processo conclu√≠do!`);\n  console.log(`üìä Resumo:`);\n  console.log(`   ‚úÖ Cidades adicionadas: ${addedCount}`);\n  console.log(`   ‚è≠Ô∏è Cidades j√° existentes: ${skippedCount}`);\n  console.log(`   ‚ùå Erros: ${errorCount}`);\n  console.log(`   üèôÔ∏è Total processado: ${allCitiesFromComprehensiveList.length}`);\n  \n  return {\n    added: addedCount,\n    skipped: skippedCount,\n    errors: errorCount,\n    total: allCitiesFromComprehensiveList.length\n  };\n}\n\n// Run the function if this file is executed directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  addAllCitiesFinal()\n    .then((result) => {\n      console.log(\"‚ú® Script finalizado com sucesso!\");\n      console.log(`üìà Resultado final: ${result.added} adicionadas, ${result.skipped} existentes, ${result.errors} erros`);\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error(\"üí• Erro fatal:\", error);\n      process.exit(1);\n    });\n}","size_bytes":21300},"server/add-bonito-activities.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\n\nconst bonitoActivities = [\n  {\n    title: \"Gruta do Lago Azul\",\n    description: \"Uma das mais belas grutas do Brasil, com lago de √°guas cristalinas em tons de azul turquesa. A gruta possui 72 metros de profundidade e oferece uma experi√™ncia √∫nica de contempla√ß√£o da natureza. Ideal para todas as idades, a visita inclui caminhada em trilha suspensa e contempla√ß√£o do lago subterr√¢neo.\",\n    location: \"Bonito, MS\",\n    category: \"nature\",\n    countryType: \"nacional\",\n    region: \"Centro-Oeste\",\n    city: \"Bonito\",\n    duration: \"2 horas\",\n    difficultyLevel: \"easy\",\n    priceType: \"per_person\",\n    coverImage: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    proposals: [\n      {\n        title: \"Econ√¥mico\",\n        description: \"Entrada b√°sica em baixa temporada com guia de grupo\",\n        price: 90,\n        inclusions: [\"Entrada na gruta\", \"Guia de grupo\", \"Trilha suspensa\"]\n      },\n      {\n        title: \"Completo\", \n        description: \"Entrada em alta temporada com guia especializado\",\n        price: 110,\n        inclusions: [\"Entrada na gruta\", \"Guia especializado\", \"Trilha suspensa\", \"Material informativo\"]\n      },\n      {\n        title: \"Premium\",\n        description: \"Experi√™ncia VIP com guia privado e tour exclusivo\",\n        price: 180,\n        inclusions: [\"Entrada na gruta\", \"Guia privado\", \"Tour exclusivo\", \"Fotos profissionais\", \"Certificado\"]\n      }\n    ]\n  },\n  {\n    title: \"Aqu√°rio Natural - Flutua√ß√£o\",\n    description: \"Experi√™ncia √∫nica de flutua√ß√£o em rio com √°guas cristalinas e visibilidade de at√© 50 metros. Observe peixes, plantas aqu√°ticas e a rica fauna subaqu√°tica em um dos aqu√°rios naturais mais preservados do Brasil. Atividade relaxante adequada para iniciantes e experientes.\",\n    location: \"Bonito, MS\",\n    category: \"water_sports\",\n    countryType: \"nacional\",\n    region: \"Centro-Oeste\",\n    city: \"Bonito\",\n    duration: \"4 horas\",\n    difficultyLevel: \"easy\",\n    priceType: \"per_person\",\n    coverImage: \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n    proposals: [\n      {\n        title: \"Econ√¥mico\",\n        description: \"Flutua√ß√£o b√°sica com equipamentos e instrutor\",\n        price: 320,\n        inclusions: [\"Equipamentos de flutua√ß√£o\", \"Instrutor\", \"Colete salva-vidas\", \"M√°scara e snorkel\"]\n      },\n      {\n        title: \"Completo\",\n        description: \"Flutua√ß√£o em alta temporada com lanche incluso\",\n        price: 395,\n        inclusions: [\"Equipamentos de flutua√ß√£o\", \"Instrutor especializado\", \"Lanche\", \"Fotos subaqu√°ticas\", \"Certificado\"]\n      },\n      {\n        title: \"Premium\",\n        description: \"Pacote completo com transporte e almo√ßo gourmet\",\n        price: 550,\n        inclusions: [\"Equipamentos premium\", \"Instrutor privado\", \"Transporte\", \"Almo√ßo gourmet\", \"Fotos/v√≠deos profissionais\", \"Brinde exclusivo\"]\n      }\n    ]\n  },\n  {\n    title: \"Lagoa Misteriosa\",\n    description: \"Lagoa de √°guas cristalinas com 220 metros de profundidade, perfeita para flutua√ß√£o e mergulho t√©cnico. Considerada uma das lagoas mais profundas do Brasil, oferece experi√™ncias desde flutua√ß√£o contemplativa at√© mergulho com cilindro para certificados. Ambiente preservado com rica biodiversidade aqu√°tica.\",\n    location: \"Bonito, MS\",\n    category: \"water_sports\",\n    countryType: \"nacional\",\n    region: \"Centro-Oeste\",\n    city: \"Bonito\",\n    duration: \"5 horas\",\n    difficultyLevel: \"medium\",\n    priceType: \"per_person\",\n    coverImage: \"https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=800&q=80\",\n    proposals: [\n      {\n        title: \"Econ√¥mico\",\n        description: \"Flutua√ß√£o b√°sica na lagoa cristalina\",\n        price: 252,\n        inclusions: [\"Flutua√ß√£o na lagoa\", \"Equipamentos b√°sicos\", \"Instrutor\", \"Colete salva-vidas\"]\n      },\n      {\n        title: \"Completo\",\n        description: \"Flutua√ß√£o em alta temporada com extras\",\n        price: 270,\n        inclusions: [\"Flutua√ß√£o na lagoa\", \"Equipamentos completos\", \"Instrutor especializado\", \"Lanche\", \"Fotos\"]\n      },\n      {\n        title: \"Premium\",\n        description: \"Mergulho t√©cnico com cilindro para certificados\",\n        price: 490,\n        inclusions: [\"Mergulho com cilindro\", \"Instrutor certificado\", \"Equipamentos profissionais\", \"Almo√ßo\", \"V√≠deo profissional\", \"Certificado de mergulho\"]\n      }\n    ]\n  },\n  {\n    title: \"Boca da On√ßa - Trilha e Cachoeiras\",\n    description: \"Maior cachoeira de Bonito com 156 metros de altura, oferecendo trilha ecol√≥gica com m√∫ltiplas cachoeiras para banho e rapel opcional. Experi√™ncia completa de ecoturismo com diversas piscinas naturais, fauna rica e op√ß√£o de aventura radical com rapel na cachoeira principal.\",\n    location: \"Bonito, MS\",\n    category: \"adventure\",\n    countryType: \"nacional\",\n    region: \"Centro-Oeste\",\n    city: \"Bonito\",\n    duration: \"6 horas\",\n    difficultyLevel: \"medium\",\n    priceType: \"per_person\",\n    coverImage: \"https://images.unsplash.com/photo-1586348943529-beaae6c28db9?w=800&q=80\",\n    proposals: [\n      {\n        title: \"Econ√¥mico\",\n        description: \"Trilha ecol√≥gica com banho nas cachoeiras\",\n        price: 350,\n        inclusions: [\"Trilha ecol√≥gica\", \"Banho nas cachoeiras\", \"Guia\", \"Kit lanche\"]\n      },\n      {\n        title: \"Completo\",\n        description: \"Trilha completa com almo√ßo t√≠pico regional\",\n        price: 420,\n        inclusions: [\"Trilha completa\", \"Banho nas cachoeiras\", \"Guia especializado\", \"Almo√ßo t√≠pico\", \"Fotos\"]\n      },\n      {\n        title: \"Premium\",\n        description: \"Aventura completa com rapel na cachoeira\",\n        price: 730,\n        inclusions: [\"Trilha completa\", \"Rapel na cachoeira\", \"Instrutor de rapel\", \"Equipamentos de seguran√ßa\", \"Almo√ßo gourmet\", \"V√≠deo profissional\", \"Certificado de rapel\"]\n      }\n    ]\n  },\n  {\n    title: \"Est√¢ncia Mimosa - Trilha das Cachoeiras\",\n    description: \"Propriedade rural sustent√°vel com trilha ecol√≥gica que leva a 8 cachoeiras diferentes, cada uma com caracter√≠sticas √∫nicas para banho e contempla√ß√£o. Experi√™ncia de turismo rural com contato direto com a natureza, fauna local e pr√°ticas sustent√°veis de preserva√ß√£o ambiental.\",\n    location: \"Bonito, MS\",\n    category: \"nature\",\n    countryType: \"nacional\",\n    region: \"Centro-Oeste\",\n    city: \"Bonito\",\n    duration: \"5 horas\",\n    difficultyLevel: \"easy\",\n    priceType: \"per_person\",\n    coverImage: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n    proposals: [\n      {\n        title: \"Econ√¥mico\",\n        description: \"Trilha das cachoeiras b√°sica sem refei√ß√£o\",\n        price: 199,\n        inclusions: [\"Trilha das 8 cachoeiras\", \"Guia\", \"Banho nas cachoeiras\", \"Lanche b√°sico\"]\n      },\n      {\n        title: \"Completo\",\n        description: \"Trilha completa com almo√ßo t√≠pico incluso\",\n        price: 260,\n        inclusions: [\"Trilha das 8 cachoeiras\", \"Guia especializado\", \"Banho nas cachoeiras\", \"Almo√ßo t√≠pico\", \"Atividades rurais\", \"Fotos\"]\n      },\n      {\n        title: \"Premium\",\n        description: \"Experi√™ncia completa em alta temporada\",\n        price: 335,\n        inclusions: [\"Trilha das 8 cachoeiras\", \"Guia privado\", \"Banho nas cachoeiras\", \"Almo√ßo gourmet\", \"Atividades rurais exclusivas\", \"Produtos locais\", \"Certificado sustent√°vel\"]\n      }\n    ]\n  }\n];\n\nasync function addBonitoActivities() {\n  console.log('üåø Iniciando adi√ß√£o das atividades de Bonito (MS)...');\n  \n  try {\n    for (const activityData of bonitoActivities) {\n      console.log(`üìç Adicionando atividade: ${activityData.title}`);\n      \n      // Insert activity\n      const [activity] = await db.insert(activities).values({\n        title: activityData.title,\n        description: activityData.description,\n        location: activityData.location,\n        category: activityData.category,\n        countryType: activityData.countryType,\n        region: activityData.region,\n        city: activityData.city,\n        duration: activityData.duration,\n        difficultyLevel: activityData.difficultyLevel,\n        priceType: activityData.priceType,\n        coverImage: activityData.coverImage,\n        averageRating: \"4.50\",\n        totalRatings: 0,\n        isActive: true,\n        createdById: 1 // User tom\n      });\n      \n      console.log(`‚úÖ Atividade criada com ID: ${activity.insertId}`);\n      \n      // Add budget proposals\n      for (const proposal of activityData.proposals) {\n        await db.insert(activityBudgetProposals).values({\n          activityId: activity.insertId,\n          createdBy: 1, // User tom\n          title: proposal.title,\n          description: proposal.description,\n          amount: proposal.price.toString(),\n          inclusions: JSON.stringify(proposal.inclusions),\n          exclusions: JSON.stringify([]),\n          votes: Math.floor(Math.random() * 60) + 20, // Random votes between 20-80\n          isActive: true\n        });\n        \n        console.log(`üí∞ Proposta \"${proposal.title}\" criada: R$ ${proposal.price}`);\n      }\n      \n      console.log(`‚úÖ Atividade \"${activityData.title}\" completamente configurada!\\n`);\n    }\n    \n    console.log('üéâ Todas as atividades de Bonito (MS) foram adicionadas com sucesso!');\n    \n  } catch (error) {\n    console.error('‚ùå Erro ao adicionar atividades de Bonito:', error);\n  }\n}\n\naddBonitoActivities();","size_bytes":9505},"server/add-buenos-aires-activities.ts":{"content":"import { db } from \"./db\";\nimport { activities, activityBudgetProposals } from \"@shared/schema\";\nimport { sql } from \"drizzle-orm\";\n\n// Script to add Buenos Aires activities with authentic details and budget proposals\nasync function addBuenosAiresActivities() {\n  console.log(\"üéµ Adicionando atividades de Buenos Aires com detalhes aut√™nticos...\");\n  \n  const buenosAiresActivities = [\n    {\n      title: \"Show de Tango com Jantar Tradicional\",\n      description: \"Viva a paix√£o do tango argentino em uma experi√™ncia aut√™ntica! Desfrute de um espet√°culo de tango profissional com dan√ßarinos de classe mundial, acompanhado de um jantar tradicional argentino com os melhores cortes de carne e vinhos locais. Uma noite inesquec√≠vel no ber√ßo do tango, em casas tradicionais como El Viejo Almac√©n, Caf√© Tortoni ou Esquina Carlos Gardel.\",\n      location: \"Buenos Aires, Argentina\",\n      category: \"entertainment\",\n      city: \"Buenos Aires\",\n      countryType: \"internacional\",\n      region: \"Am√©rica do Sul\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"3-4 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 50,\n      languages: JSON.stringify([\"Espanhol\", \"Ingl√™s\", \"Portugu√™s\"]),\n      inclusions: JSON.stringify([\"Show de tango profissional\", \"Jantar tradicional argentino\", \"Vinho local\", \"Transporte\"]),\n      exclusions: JSON.stringify([\"Bebidas extras\", \"Gorjetas\", \"Souvenirs\", \"Aulas de tango\"]),\n      requirements: JSON.stringify([\"Vestu√°rio elegante\", \"Reserva antecipada\", \"Chegada pontual\"]),\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes do evento\",\n      contactInfo: JSON.stringify({\n        phone: \"+54 11 5555-1234\",\n        email: \"info@tangoshow.com.ar\",\n        website: \"https://www.tangoshow.com.ar\",\n        address: \"San Telmo, Buenos Aires, Argentina\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1544133503-59b8e7e58e32?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Tour pelo Bairro La Boca - Caminito\",\n      description: \"Explore o bairro mais colorido e art√≠stico de Buenos Aires! La Boca √© famoso por suas casas pintadas em cores vibrantes, o est√°dio La Bombonera do Boca Juniors, e a rua-museu Caminito. Descubra a hist√≥ria dos imigrantes italianos, aprecie arte de rua, ou√ßa m√∫sica de tango nas ruas e visite ateli√™s de artistas locais. O ber√ßo do tango e da paix√£o pelo futebol argentino.\",\n      location: \"Buenos Aires, Argentina\",\n      category: \"sightseeing\",\n      city: \"Buenos Aires\",\n      countryType: \"internacional\",\n      region: \"Am√©rica do Sul\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"2-3 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 30,\n      languages: JSON.stringify([\"Espanhol\", \"Ingl√™s\", \"Portugu√™s\"]),\n      inclusions: JSON.stringify([\"Rua Caminito\", \"Casas coloridas\", \"Arte de rua\", \"Museu Boca Juniors\", \"Feira de antiguidades\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Guia tur√≠stico\", \"Entradas em museus\"]),\n      requirements: JSON.stringify([\"Cal√ßado confort√°vel\", \"C√¢mera fotogr√°fica\", \"Cuidado com pertences\"]),\n      cancellationPolicy: \"Passeio ao ar livre - sem necessidade de cancelamento\",\n      contactInfo: JSON.stringify({\n        phone: \"+54 11 4301-1080\",\n        email: \"info@laboca.com.ar\",\n        website: \"https://www.laboca.com.ar\",\n        address: \"Caminito, La Boca, Buenos Aires, Argentina\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1589909202802-8f4aadce1849?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1589909202802-8f4aadce1849?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1544133503-59b8e7e58e32?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Cemit√©rio da Recoleta - Visita Hist√≥rica\",\n      description: \"Descubra o cemit√©rio mais famoso da Am√©rica Latina! O Cemit√©rio da Recoleta abriga t√∫mulos de personalidades ilustres como Eva Per√≥n, presidentes argentinos e figuras hist√≥ricas. Com arquitetura funer√°ria impressionante, mausol√©us ornamentados e esculturas de m√°rmore, este local √© um museu a c√©u aberto que conta a hist√≥ria da Argentina atrav√©s de suas personalidades mais importantes.\",\n      location: \"Buenos Aires, Argentina\",\n      category: \"culture\",\n      city: \"Buenos Aires\",\n      countryType: \"internacional\",\n      region: \"Am√©rica do Sul\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"1-2 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 40,\n      languages: JSON.stringify([\"Espanhol\", \"Ingl√™s\", \"Portugu√™s\"]),\n      inclusions: JSON.stringify([\"Entrada gratuita\", \"T√∫mulo de Eva Per√≥n\", \"Arquitetura funer√°ria\", \"Hist√≥ria argentina\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Guia tur√≠stico\", \"Alimenta√ß√£o\", \"Audioguia\"]),\n      requirements: JSON.stringify([\"Vestu√°rio respeitoso\", \"Sil√™ncio\", \"Respeito ao local sagrado\"]),\n      cancellationPolicy: \"Entrada gratuita - sem necessidade de cancelamento\",\n      contactInfo: JSON.stringify({\n        phone: \"+54 11 4803-1594\",\n        email: \"info@cementeriodelarecoleta.com.ar\",\n        website: \"https://www.cementeriodelarecoleta.com.ar\",\n        address: \"Jun√≠n 1760, C1113 CABA, Argentina\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1544827753-4acf7de08544?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1575062789842-43438b4e9eb4?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"MALBA - Museu de Arte Latino-Americana\",\n      description: \"Explore a maior cole√ß√£o de arte latino-americana contempor√¢nea! O MALBA abriga obras de Frida Kahlo, Diego Rivera, Antonio Berni, Xul Solar e outros grandes mestres. Com exposi√ß√µes permanentes e tempor√°rias, este museu oferece uma jornada pela criatividade e diversidade cultural da Am√©rica Latina. Localizado no elegante bairro de Palermo, √© um centro cultural imperd√≠vel.\",\n      location: \"Buenos Aires, Argentina\",\n      category: \"culture\",\n      city: \"Buenos Aires\",\n      countryType: \"internacional\",\n      region: \"Am√©rica do Sul\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"2-3 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 50,\n      languages: JSON.stringify([\"Espanhol\", \"Ingl√™s\", \"Portugu√™s\"]),\n      inclusions: JSON.stringify([\"Entrada no museu\", \"Exposi√ß√µes permanentes\", \"Arte latino-americana\", \"Caf√© no museu\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Guia tur√≠stico\", \"Exposi√ß√µes especiais\", \"Audioguia\"]),\n      requirements: JSON.stringify([\"N√£o permitido flash\", \"Sil√™ncio nas galerias\", \"Bagagem limitada\"]),\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes da visita\",\n      contactInfo: JSON.stringify({\n        phone: \"+54 11 4808-6500\",\n        email: \"info@malba.org.ar\",\n        website: \"https://www.malba.org.ar\",\n        address: \"Av. Figueroa Alcorta 3415, C1425CLA CABA, Argentina\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1575062789842-43438b4e9eb4?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1575062789842-43438b4e9eb4?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1544827753-4acf7de08544?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Degusta√ß√£o de Vinhos e Carnes Premium\",\n      description: \"Experimente o melhor da gastronomia argentina! Deguste vinhos premium de Mendoza, Salta e San Juan, harmonizados com os cortes de carne mais nobres em parrillas tradicionais. Aprenda sobre terroir, processo de vinifica√ß√£o e t√©cnicas de preparo da carne argentina. Uma experi√™ncia sensorial √∫nica que celebra a excel√™ncia culin√°ria argentina em restaurantes como Don Julio, La Cabrera ou Fog√≥n Asado.\",\n      location: \"Buenos Aires, Argentina\",\n      category: \"food_tours\",\n      city: \"Buenos Aires\",\n      countryType: \"internacional\",\n      region: \"Am√©rica do Sul\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"3-4 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 20,\n      languages: JSON.stringify([\"Espanhol\", \"Ingl√™s\", \"Portugu√™s\"]),\n      inclusions: JSON.stringify([\"Degusta√ß√£o de vinhos\", \"Cortes de carne premium\", \"Parrilla tradicional\", \"Sommelier especializado\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Bebidas extras\", \"Gorjetas\", \"Souvenirs\"]),\n      requirements: JSON.stringify([\"Idade m√≠nima 18 anos\", \"Restri√ß√µes alimentares informadas\", \"Vestu√°rio adequado\"]),\n      cancellationPolicy: \"Cancelamento gratuito at√© 48h antes da experi√™ncia\",\n      contactInfo: JSON.stringify({\n        phone: \"+54 11 4831-9564\",\n        email: \"info@wineandmeat.com.ar\",\n        website: \"https://www.wineandmeat.com.ar\",\n        address: \"Palermo, Buenos Aires, Argentina\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1544133503-59b8e7e58e32?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1544133503-59b8e7e58e32?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\"\n      ]),\n      createdById: 1\n    }\n  ];\n\n  // Budget proposals for each activity (converted to USD)\n  const budgetProposals = [\n    // Show de Tango proposals\n    {\n      activityTitle: \"Show de Tango com Jantar Tradicional\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Show + Jantar Simples\",\n          description: \"Show de tango com jantar b√°sico em casa tradicional.\",\n          amount: \"25.00\", // ~ARS 3500 convertido para USD\n          inclusions: [\"Show de tango\", \"Jantar b√°sico\", \"1 copo de vinho\", \"Transporte\"],\n          exclusions: [\"Bebidas extras\", \"Aulas de tango\", \"Souvenirs\", \"Gorjetas\"]\n        },\n        {\n          title: \"Completo - Show + Jantar Completo\",\n          description: \"Show de tango profissional com jantar completo e vinhos selecionados.\",\n          amount: \"50.00\", // ~ARS 7000 convertido para USD\n          inclusions: [\"Show profissional\", \"Jantar 3 pratos\", \"Vinhos selecionados\", \"Transporte VIP\"],\n          exclusions: [\"Bebidas premium\", \"Fotos profissionais\", \"Aulas privadas\"]\n        },\n        {\n          title: \"Premium - Experi√™ncia VIP Completa\",\n          description: \"Experi√™ncia VIP com melhores assentos, jantar gourmet e aula de tango.\",\n          amount: \"110.00\", // ~ARS 15000 convertido para USD\n          inclusions: [\"Mesa VIP\", \"Jantar gourmet\", \"Vinhos premium\", \"Aula de tango\", \"Fotos\", \"Transporte luxury\"],\n          exclusions: [\"Bebidas extras\", \"Souvenirs\", \"Gorjetas\"]\n        }\n      ]\n    },\n    // La Boca proposals\n    {\n      activityTitle: \"Tour pelo Bairro La Boca - Caminito\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Passeio Livre\",\n          description: \"Explore La Boca por conta pr√≥pria. Acesso gratuito a todas as atra√ß√µes.\",\n          amount: \"0.00\",\n          inclusions: [\"Acesso livre\", \"Rua Caminito\", \"Casas coloridas\", \"Arte de rua\", \"Feira de antiguidades\"],\n          exclusions: [\"Guia tur√≠stico\", \"Transporte\", \"Alimenta√ß√£o\", \"Entradas em museus\"]\n        },\n        {\n          title: \"Completo - Tour Guiado\",\n          description: \"Tour guiado com contexto hist√≥rico e cultural do bairro.\",\n          amount: \"8.00\", // ~ARS 1200 convertido para USD\n          inclusions: [\"Tour guiado 2h\", \"Hist√≥ria do bairro\", \"Visita La Bombonera\", \"Guia local\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Entradas em museus\", \"Souvenirs\"]\n        },\n        {\n          title: \"Premium - Tour Privativo\",\n          description: \"Tour privativo com guia especializado e acesso exclusivo.\",\n          amount: \"25.00\", // ~ARS 3500 convertido para USD\n          inclusions: [\"Tour privado\", \"Guia especializado\", \"Acesso exclusivo\", \"Grupo pequeno\", \"Fotos\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Souvenirs\", \"Gorjetas\"]\n        }\n      ]\n    },\n    // Cemit√©rio da Recoleta proposals\n    {\n      activityTitle: \"Cemit√©rio da Recoleta - Visita Hist√≥rica\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada Gratuita\",\n          description: \"Visita livre ao cemit√©rio mais famoso da Argentina.\",\n          amount: \"0.00\",\n          inclusions: [\"Entrada gratuita\", \"T√∫mulo Eva Per√≥n\", \"Arquitetura funer√°ria\", \"Mapa gratuito\"],\n          exclusions: [\"Guia tur√≠stico\", \"Audioguia\", \"Transporte\", \"Alimenta√ß√£o\"]\n        },\n        {\n          title: \"Completo - Tour Guiado\",\n          description: \"Tour guiado com hist√≥rias e contexto dos personagens famosos.\",\n          amount: \"4.00\", // ~ARS 500 convertido para USD\n          inclusions: [\"Tour guiado 1h\", \"Hist√≥rias dos famosos\", \"Arquitetura\", \"Guia especializado\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Audioguia pessoal\", \"Souvenirs\"]\n        },\n        {\n          title: \"Premium - Tour VIP\",\n          description: \"Tour VIP com acesso especial e historiador especializado.\",\n          amount: \"9.00\", // ~ARS 1200 convertido para USD\n          inclusions: [\"Tour VIP\", \"Historiador especializado\", \"Acesso especial\", \"Grupo pequeno\", \"Detalhes exclusivos\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Fotografias profissionais\", \"Souvenirs\"]\n        }\n      ]\n    },\n    // MALBA proposals\n    {\n      activityTitle: \"MALBA - Museu de Arte Latino-Americana\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada B√°sica\",\n          description: \"Entrada b√°sica com acesso √†s exposi√ß√µes permanentes.\",\n          amount: \"1.00\", // ~ARS 150 convertido para USD\n          inclusions: [\"Entrada no museu\", \"Exposi√ß√µes permanentes\", \"Arte latino-americana\", \"Mapa do museu\"],\n          exclusions: [\"Audioguia\", \"Tour guiado\", \"Exposi√ß√µes especiais\", \"Transporte\"]\n        },\n        {\n          title: \"Completo - Tour Guiado\",\n          description: \"Tour guiado com curador especializado em arte latino-americana.\",\n          amount: \"3.00\", // ~ARS 400 convertido para USD\n          inclusions: [\"Tour guiado 1,5h\", \"Curador especializado\", \"Exposi√ß√µes\", \"Hist√≥ria da arte\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Exposi√ß√µes especiais\", \"Souvenirs\"]\n        },\n        {\n          title: \"Premium - Tour Privado\",\n          description: \"Tour privado com curador senior e acesso a obras especiais.\",\n          amount: \"7.00\", // ~ARS 1000 convertido para USD\n          inclusions: [\"Tour privado\", \"Curador senior\", \"Obras especiais\", \"Grupo pequeno\", \"Acesso VIP\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Fotografias profissionais\", \"Souvenirs\"]\n        }\n      ]\n    },\n    // Degusta√ß√£o de vinhos proposals\n    {\n      activityTitle: \"Degusta√ß√£o de Vinhos e Carnes Premium\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Degusta√ß√£o B√°sica\",\n          description: \"Degusta√ß√£o b√°sica com vinhos locais e cortes simples.\",\n          amount: \"8.00\", // ~ARS 1000 convertido para USD\n          inclusions: [\"3 vinhos\", \"Cortes b√°sicos\", \"Queijos\", \"P√£es artesanais\"],\n          exclusions: [\"Vinhos premium\", \"Cortes nobres\", \"Sobremesas\", \"Transporte\"]\n        },\n        {\n          title: \"Completo - Jantar Completo\",\n          description: \"Jantar completo com vinhos selecionados e parrilla tradicional.\",\n          amount: \"22.00\", // ~ARS 3000 convertido para USD\n          inclusions: [\"Jantar completo\", \"5 vinhos\", \"Parrilla tradicional\", \"Sommelier\", \"Sobremesas\"],\n          exclusions: [\"Vinhos premium\", \"Transporte\", \"Gorjetas\", \"Souvenirs\"]\n        },\n        {\n          title: \"Premium - Experi√™ncia Gourmet\",\n          description: \"Experi√™ncia gourmet com vinhos premium e carnes nobres.\",\n          amount: \"50.00\", // ~ARS 7000 convertido para USD\n          inclusions: [\"Vinhos premium\", \"Carnes nobres\", \"Menu degusta√ß√£o\", \"Sommelier especializado\", \"Harmoniza√ß√µes\"],\n          exclusions: [\"Transporte\", \"Bebidas extras\", \"Gorjetas\", \"Souvenirs\"]\n        }\n      ]\n    }\n  ];\n\n  try {\n    // Insert activities first\n    for (const activity of buenosAiresActivities) {\n      try {\n        const [insertedActivity] = await db.insert(activities).values({\n          ...activity,\n          isActive: true\n        });\n        console.log(`‚úÖ Atividade criada: ${activity.title}`);\n      } catch (insertError: any) {\n        if (insertError.code === 'ER_DUP_ENTRY') {\n          console.log(`‚ÑπÔ∏è Atividade j√° existe: ${activity.title}`);\n        } else {\n          console.error(`‚ùå Erro ao criar ${activity.title}:`, insertError.message);\n        }\n      }\n    }\n\n    // Then insert budget proposals\n    for (const budgetGroup of budgetProposals) {\n      // Find the activity ID\n      const [activityResult] = await db.select()\n        .from(activities)\n        .where(sql`title = ${budgetGroup.activityTitle}`)\n        .limit(1);\n\n      if (activityResult) {\n        for (const proposal of budgetGroup.proposals) {\n          try {\n            await db.insert(activityBudgetProposals).values({\n              activityId: activityResult.id,\n              createdBy: 1,\n              title: proposal.title,\n              description: proposal.description,\n              amount: proposal.amount,\n              currency: \"USD\",\n              inclusions: JSON.stringify(proposal.inclusions),\n              exclusions: JSON.stringify(proposal.exclusions),\n              isActive: true\n            });\n            console.log(`  üí∞ Proposta criada: ${proposal.title}`);\n          } catch (proposalError: any) {\n            if (proposalError.code === 'ER_DUP_ENTRY') {\n              console.log(`  ‚ÑπÔ∏è Proposta j√° existe: ${proposal.title}`);\n            } else {\n              console.error(`  ‚ùå Erro ao criar proposta:`, proposalError.message);\n            }\n          }\n        }\n      }\n    }\n\n    console.log(\"üéâ Atividades de Buenos Aires criadas com sucesso!\");\n\n  } catch (error) {\n    console.error(\"‚ùå Erro geral:\", error);\n  }\n}\n\n// Execute the function\naddBuenosAiresActivities().catch(console.error);","size_bytes":18995},"server/add-comprehensive-budget-proposals.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\n\nasync function addComprehensiveBudgetProposals() {\n  console.log('üéØ Iniciando cadastro abrangente de propostas de or√ßamento...');\n\n  try {\n    // Buscar todas as atividades existentes\n    const existingActivities = await db.select().from(activities);\n    console.log(`üìä Encontradas ${existingActivities.length} atividades para processar`);\n\n    // Definir propostas por localiza√ß√£o e tipo de atividade\n    const proposalsByLocation: Record<string, any[]> = {\n      'Rio de Janeiro': [\n        {\n          name: 'Cristo Redentor / Corcovado',\n          proposals: [\n            { level: 'Econ√¥mico', price: 85, description: 'Van oficial', inclusions: ['Transporte', 'Entrada'], exclusions: ['Guia', 'Alimenta√ß√£o'] },\n            { level: 'Completo', price: 160, description: 'Trem + entrada + guia', inclusions: ['Transporte', 'Entrada', 'Guia tur√≠stico'], exclusions: ['Alimenta√ß√£o', 'Fotos'] },\n            { level: 'Premium', price: 320, description: 'Tour privativo com transporte', inclusions: ['Transporte privativo', 'Entrada', 'Guia exclusivo', 'Fotos'], exclusions: ['Alimenta√ß√£o'] }\n          ]\n        },\n        {\n          name: 'P√£o de A√ß√∫car',\n          proposals: [\n            { level: 'Econ√¥mico', price: 120, description: 'Ingresso padr√£o', inclusions: ['Bondinho', 'Entrada'], exclusions: ['Guia', 'Alimenta√ß√£o'] },\n            { level: 'Completo', price: 190, description: 'Bondinho + guia', inclusions: ['Bondinho', 'Entrada', 'Guia tur√≠stico'], exclusions: ['Alimenta√ß√£o', 'Transporte'] },\n            { level: 'Premium', price: 350, description: 'Bondinho + tour + helic√≥ptero', inclusions: ['Bondinho', 'Tour helic√≥ptero', 'Guia exclusivo', 'Fotos'], exclusions: ['Alimenta√ß√£o'] }\n          ]\n        },\n        {\n          name: 'Copacabana',\n          proposals: [\n            { level: 'Econ√¥mico', price: 0, description: 'Livre', inclusions: ['Acesso √† praia'], exclusions: ['Equipamentos', 'Guia', 'Alimenta√ß√£o'] },\n            { level: 'Completo', price: 100, description: 'Aula de surf ou aluguel de bike', inclusions: ['Equipamento esportivo', 'Instrutor'], exclusions: ['Alimenta√ß√£o', 'Transporte'] },\n            { level: 'Premium', price: 300, description: 'Passeio de lancha com drinks', inclusions: ['Lancha', 'Bebidas', 'Guia', 'Equipamentos'], exclusions: ['Refei√ß√µes'] }\n          ]\n        }\n      ],\n      'S√£o Paulo': [\n        {\n          name: 'MASP',\n          proposals: [\n            { level: 'Econ√¥mico', price: 40, description: 'Entrada simples', inclusions: ['Entrada'], exclusions: ['Guia', 'Alimenta√ß√£o'] },\n            { level: 'Completo', price: 90, description: 'Visita guiada + caf√©', inclusions: ['Entrada', 'Guia', 'Caf√©'], exclusions: ['Transporte', 'Almo√ßo'] },\n            { level: 'Premium', price: 250, description: 'Passeio + almo√ßo em rooftop', inclusions: ['Entrada', 'Guia', 'Almo√ßo premium', 'Vista panor√¢mica'], exclusions: ['Transporte'] }\n          ]\n        },\n        {\n          name: 'Parque Ibirapuera',\n          proposals: [\n            { level: 'Econ√¥mico', price: 0, description: 'Livre', inclusions: ['Acesso ao parque'], exclusions: ['Equipamentos', 'Guia'] },\n            { level: 'Completo', price: 70, description: 'Aluguel de bike + ingressos', inclusions: ['Bicicleta', 'Ingressos museus'], exclusions: ['Guia', 'Alimenta√ß√£o'] },\n            { level: 'Premium', price: 180, description: 'Tour guiado + transporte', inclusions: ['Transporte', 'Guia especializado', 'Ingressos'], exclusions: ['Alimenta√ß√£o'] }\n          ]\n        }\n      ],\n      'Gramado': [\n        {\n          name: 'Mini Mundo',\n          proposals: [\n            { level: 'Econ√¥mico', price: 80, description: 'Ingresso avulso', inclusions: ['Entrada'], exclusions: ['Transporte', 'Guia'] },\n            { level: 'Completo', price: 120, description: 'Transporte + entrada', inclusions: ['Transporte', 'Entrada'], exclusions: ['Guia', 'Alimenta√ß√£o'] },\n            { level: 'Premium', price: 200, description: 'Com guia e almo√ßo', inclusions: ['Transporte', 'Entrada', 'Guia', 'Almo√ßo'], exclusions: ['Compras'] }\n          ]\n        },\n        {\n          name: 'Snowland',\n          proposals: [\n            { level: 'Econ√¥mico', price: 180, description: 'Entrada simples', inclusions: ['Entrada', 'Equipamentos b√°sicos'], exclusions: ['Roupas especiais', 'Aulas'] },\n            { level: 'Completo', price: 300, description: 'Inclus√£o de roupas alugadas', inclusions: ['Entrada', 'Equipamentos', 'Roupas t√©rmicas'], exclusions: ['Aulas privadas', 'Fotos'] },\n            { level: 'Premium', price: 450, description: 'Aula de esqui + fotos profissionais', inclusions: ['Entrada', 'Equipamentos', 'Roupas', 'Aula privada', 'Fotos'], exclusions: ['Alimenta√ß√£o'] }\n          ]\n        }\n      ],\n      'Bonito': [\n        {\n          name: 'Gruta do Lago Azul',\n          proposals: [\n            { level: 'Econ√¥mico', price: 90, description: 'Baixa temporada', inclusions: ['Entrada', 'Transporte local'], exclusions: ['Guia especializado', 'Alimenta√ß√£o'] },\n            { level: 'Completo', price: 110, description: 'Alta temporada', inclusions: ['Entrada', 'Transporte', 'Guia'], exclusions: ['Alimenta√ß√£o', 'Fotos'] },\n            { level: 'Premium', price: 180, description: 'Entrada + guia privado', inclusions: ['Entrada', 'Transporte', 'Guia privado', 'Fotos'], exclusions: ['Alimenta√ß√£o'] }\n          ]\n        },\n        {\n          name: 'Aqu√°rio Natural',\n          proposals: [\n            { level: 'Econ√¥mico', price: 320, description: 'Flutua√ß√£o b√°sica', inclusions: ['Equipamentos', 'Guia'], exclusions: ['Transporte', 'Alimenta√ß√£o'] },\n            { level: 'Completo', price: 395, description: 'Alta temporada', inclusions: ['Equipamentos', 'Guia', 'Transporte'], exclusions: ['Alimenta√ß√£o premium'] },\n            { level: 'Premium', price: 550, description: 'Com transporte e almo√ßo', inclusions: ['Equipamentos', 'Guia', 'Transporte', 'Almo√ßo', 'Fotos'], exclusions: ['Hospedagem'] }\n          ]\n        }\n      ],\n      'Paris': [\n        {\n          name: 'Torre Eiffel',\n          proposals: [\n            { level: 'Econ√¥mico', price: 50, description: 'Acesso at√© 2¬∫ andar, escada', inclusions: ['Entrada at√© 2¬∫ andar'], exclusions: ['Elevador', 'Guia', 'Alimenta√ß√£o'] },\n            { level: 'Completo', price: 125, description: 'Elevador at√© o topo', inclusions: ['Entrada completa', 'Elevador'], exclusions: ['Guia', 'Alimenta√ß√£o'] },\n            { level: 'Premium', price: 350, description: 'Tour guiado + jantar no restaurante', inclusions: ['Entrada VIP', 'Elevador', 'Guia', 'Jantar'], exclusions: ['Transporte'] }\n          ]\n        },\n        {\n          name: 'Museu do Louvre',\n          proposals: [\n            { level: 'Econ√¥mico', price: 85, description: 'Entrada padr√£o online', inclusions: ['Entrada'], exclusions: ['Guia', 'Acesso especial'] },\n            { level: 'Completo', price: 200, description: 'Tour guiado em grupo', inclusions: ['Entrada', 'Guia em grupo'], exclusions: ['Tour privado', 'Acesso VIP'] },\n            { level: 'Premium', price: 600, description: 'Tour privativo + acesso especial', inclusions: ['Entrada VIP', 'Guia privado', 'Acesso especial'], exclusions: ['Transporte'] }\n          ]\n        }\n      ],\n      'Nova York': [\n        {\n          name: 'Est√°tua da Liberdade',\n          proposals: [\n            { level: 'Econ√¥mico', price: 120, description: 'Ferry e entrada', inclusions: ['Ferry', 'Entrada'], exclusions: ['Guia', 'Ellis Island'] },\n            { level: 'Completo', price: 250, description: 'Tour guiado', inclusions: ['Ferry', 'Entrada', 'Guia', 'Ellis Island'], exclusions: ['Acesso VIP'] },\n            { level: 'Premium', price: 750, description: 'Tour VIP + acesso restrito', inclusions: ['Ferry VIP', 'Entrada', 'Guia privado', 'Acesso especial'], exclusions: ['Alimenta√ß√£o'] }\n          ]\n        },\n        {\n          name: 'Empire State Building',\n          proposals: [\n            { level: 'Econ√¥mico', price: 225, description: 'Entrada b√°sica', inclusions: ['Entrada'], exclusions: ['Skip line', 'Guia'] },\n            { level: 'Completo', price: 450, description: 'Skip line + observat√≥rio', inclusions: ['Entrada', 'Skip line', 'Observat√≥rio'], exclusions: ['Guia privado'] },\n            { level: 'Premium', price: 1000, description: 'Tour guiado + jantar', inclusions: ['Entrada VIP', 'Skip line', 'Guia', 'Jantar'], exclusions: ['Transporte'] }\n          ]\n        }\n      ],\n      'Londres': [\n        {\n          name: 'London Eye',\n          proposals: [\n            { level: 'Econ√¥mico', price: 180, description: 'Entrada padr√£o', inclusions: ['Entrada'], exclusions: ['Skip line', 'Champagne'] },\n            { level: 'Completo', price: 300, description: 'Skip line', inclusions: ['Entrada', 'Skip line'], exclusions: ['Cabine privada'] },\n            { level: 'Premium', price: 900, description: 'Cabine privada + champagne', inclusions: ['Cabine privada', 'Champagne', 'Fotos'], exclusions: ['Transporte'] }\n          ]\n        },\n        {\n          name: 'Torre de Londres',\n          proposals: [\n            { level: 'Econ√¥mico', price: 150, description: 'Entrada simples', inclusions: ['Entrada'], exclusions: ['Guia', 'Joias da Coroa'] },\n            { level: 'Completo', price: 300, description: 'Tour guiado', inclusions: ['Entrada', 'Guia'], exclusions: ['Tour privado'] },\n            { level: 'Premium', price: 720, description: 'Tour privado + joias da coroa', inclusions: ['Entrada VIP', 'Guia privado', 'Acesso especial'], exclusions: ['Transporte'] }\n          ]\n        }\n      ],\n      'Roma': [\n        {\n          name: 'Coliseu',\n          proposals: [\n            { level: 'Econ√¥mico', price: 80, description: 'Entrada padr√£o', inclusions: ['Entrada'], exclusions: ['Guia', 'Acesso especial'] },\n            { level: 'Completo', price: 200, description: 'Tour guiado em grupo', inclusions: ['Entrada', 'Guia em grupo'], exclusions: ['Tour privado'] },\n            { level: 'Premium', price: 750, description: 'Tour privativo + acesso exclusivo', inclusions: ['Entrada VIP', 'Guia privado', 'Acesso exclusivo'], exclusions: ['Transporte'] }\n          ]\n        },\n        {\n          name: 'Vaticano',\n          proposals: [\n            { level: 'Econ√¥mico', price: 85, description: 'Entrada simples', inclusions: ['Entrada'], exclusions: ['Museus', 'Guia'] },\n            { level: 'Completo', price: 250, description: 'Tour com museus', inclusions: ['Entrada', 'Museus', 'Guia'], exclusions: ['C√∫pula'] },\n            { level: 'Premium', price: 600, description: 'Tour VIP + c√∫pula', inclusions: ['Entrada VIP', 'Museus', 'Guia privado', 'C√∫pula'], exclusions: ['Transporte'] }\n          ]\n        }\n      ],\n      'Buenos Aires': [\n        {\n          name: 'Show de Tango',\n          proposals: [\n            { level: 'Econ√¥mico', price: 80, description: 'Show b√°sico', inclusions: ['Show', 'Bebida'], exclusions: ['Jantar', 'Mesa VIP'] },\n            { level: 'Completo', price: 160, description: 'Show com jantar', inclusions: ['Show', 'Jantar', 'Bebidas'], exclusions: ['Mesa VIP', 'Transporte'] },\n            { level: 'Premium', price: 350, description: 'Show VIP com jantar premium', inclusions: ['Show VIP', 'Jantar premium', 'Bebidas premium', 'Mesa especial'], exclusions: ['Transporte'] }\n          ]\n        },\n        {\n          name: 'La Boca',\n          proposals: [\n            { level: 'Econ√¥mico', price: 0, description: 'Passeio livre', inclusions: ['Acesso ao bairro'], exclusions: ['Guia', 'Transporte'] },\n            { level: 'Completo', price: 60, description: 'Tour guiado', inclusions: ['Guia', 'Caminhada'], exclusions: ['Transporte', 'Alimenta√ß√£o'] },\n            { level: 'Premium', price: 175, description: 'Tour privativo', inclusions: ['Guia privado', 'Transporte', 'Fotos'], exclusions: ['Alimenta√ß√£o'] }\n          ]\n        }\n      ]\n    };\n\n    let totalProposalsAdded = 0;\n\n    // Processar cada atividade existente\n    for (const activity of existingActivities) {\n      try {\n        console.log(`üîç Processando atividade: ${activity.title} (${activity.location})`);\n\n        // Buscar propostas espec√≠ficas para esta localiza√ß√£o\n        const locationProposals = proposalsByLocation[activity.location] || [];\n        \n        // Encontrar propostas que correspondam ao nome da atividade\n        let matchingProposals = locationProposals.find(p => \n          activity.title.toLowerCase().includes(p.name.toLowerCase()) ||\n          p.name.toLowerCase().includes(activity.title.toLowerCase())\n        )?.proposals;\n\n        // Se n√£o encontrar correspond√™ncia espec√≠fica, usar propostas gen√©ricas baseadas na categoria\n        if (!matchingProposals) {\n          matchingProposals = getGenericProposalsByCategory(activity.category);\n        }\n\n        // Verificar se j√° existem propostas para esta atividade\n        const existingProposals = await db.select()\n          .from(activityBudgetProposals)\n          .where(eq(activityBudgetProposals.activityId, activity.id));\n\n        if (existingProposals.length === 0) {\n          // Adicionar as propostas\n          for (const proposal of matchingProposals) {\n            await db.insert(activityBudgetProposals).values({\n              activityId: activity.id,\n              createdBy: 1, // User ID do admin (assumindo que existe)\n              title: proposal.level,\n              amount: proposal.price.toString(),\n              description: proposal.description,\n              inclusions: JSON.stringify(proposal.inclusions),\n              exclusions: JSON.stringify(proposal.exclusions),\n              votes: Math.floor(Math.random() * 50) + 1, // Votos aleat√≥rios entre 1-50\n              isActive: true\n            });\n            \n            totalProposalsAdded++;\n            console.log(`  ‚úÖ Proposta ${proposal.level} adicionada (R$ ${proposal.price})`);\n          }\n        } else {\n          console.log(`  ‚ÑπÔ∏è Atividade j√° possui ${existingProposals.length} propostas`);\n        }\n\n      } catch (error) {\n        console.error(`‚ùå Erro ao processar atividade ${activity.title}:`, error);\n      }\n    }\n\n    console.log(`üéâ Processo conclu√≠do! ${totalProposalsAdded} propostas adicionadas ao total`);\n\n  } catch (error) {\n    console.error('‚ùå Erro durante o processo:', error);\n  }\n}\n\nfunction getGenericProposalsByCategory(category: string) {\n  const genericProposals: Record<string, any[]> = {\n    'pontos_turisticos': [\n      { level: 'Econ√¥mico', price: 30, description: 'Entrada b√°sica', inclusions: ['Entrada'], exclusions: ['Guia', 'Transporte'] },\n      { level: 'Completo', price: 80, description: 'Entrada + guia', inclusions: ['Entrada', 'Guia'], exclusions: ['Transporte', 'Alimenta√ß√£o'] },\n      { level: 'Premium', price: 150, description: 'Tour completo', inclusions: ['Entrada', 'Guia privado', 'Transporte'], exclusions: ['Alimenta√ß√£o'] }\n    ],\n    'adventure': [\n      { level: 'Econ√¥mico', price: 50, description: 'Atividade b√°sica', inclusions: ['Equipamentos b√°sicos'], exclusions: ['Guia', 'Transporte'] },\n      { level: 'Completo', price: 120, description: 'Com guia e equipamentos', inclusions: ['Equipamentos', 'Guia', 'Seguran√ßa'], exclusions: ['Transporte', 'Alimenta√ß√£o'] },\n      { level: 'Premium', price: 250, description: 'Experi√™ncia completa', inclusions: ['Equipamentos premium', 'Guia especializado', 'Transporte', 'Fotos'], exclusions: ['Hospedagem'] }\n    ],\n    'cultural': [\n      { level: 'Econ√¥mico', price: 20, description: 'Visita b√°sica', inclusions: ['Entrada'], exclusions: ['Guia', 'Transporte'] },\n      { level: 'Completo', price: 60, description: 'Visita guiada', inclusions: ['Entrada', 'Guia cultural'], exclusions: ['Transporte', 'Alimenta√ß√£o'] },\n      { level: 'Premium', price: 120, description: 'Experi√™ncia cultural completa', inclusions: ['Entrada', 'Guia especializado', 'Material educativo'], exclusions: ['Transporte'] }\n    ],\n    'nature': [\n      { level: 'Econ√¥mico', price: 40, description: 'Acesso b√°sico', inclusions: ['Entrada', 'Trilha autoguiada'], exclusions: ['Guia', 'Equipamentos'] },\n      { level: 'Completo', price: 100, description: 'Com guia ecol√≥gico', inclusions: ['Entrada', 'Guia especializado', 'Equipamentos b√°sicos'], exclusions: ['Transporte', 'Alimenta√ß√£o'] },\n      { level: 'Premium', price: 200, description: 'Ecoturismo premium', inclusions: ['Entrada', 'Guia especializado', 'Equipamentos', 'Transporte'], exclusions: ['Hospedagem'] }\n    ],\n    'water_sports': [\n      { level: 'Econ√¥mico', price: 60, description: 'Aluguel de equipamentos', inclusions: ['Equipamentos b√°sicos'], exclusions: ['Instrutor', 'Transporte'] },\n      { level: 'Completo', price: 150, description: 'Com instrutor', inclusions: ['Equipamentos', 'Instrutor', 'Seguran√ßa'], exclusions: ['Transporte', 'Fotos'] },\n      { level: 'Premium', price: 300, description: 'Experi√™ncia aqu√°tica completa', inclusions: ['Equipamentos premium', 'Instrutor privado', 'Fotos', 'Refreshments'], exclusions: ['Transporte'] }\n    ],\n    'food_tours': [\n      { level: 'Econ√¥mico', price: 40, description: 'Degusta√ß√£o b√°sica', inclusions: ['3 paradas gastron√¥micas'], exclusions: ['Bebidas', 'Transporte'] },\n      { level: 'Completo', price: 90, description: 'Tour gastron√¥mico', inclusions: ['5 paradas', 'Guia especializado', 'Bebidas'], exclusions: ['Transporte', 'Sobremesas'] },\n      { level: 'Premium', price: 180, description: 'Experi√™ncia gourmet', inclusions: ['Tour completo', 'Guia chef', 'Bebidas premium', 'Receitas'], exclusions: ['Transporte'] }\n    ]\n  };\n\n  return genericProposals[category] || genericProposals['pontos_turisticos'];\n}\n\n// Executar o script\naddComprehensiveBudgetProposals()\n  .then(() => {\n    console.log('‚úÖ Script executado com sucesso');\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error('‚ùå Erro durante execu√ß√£o:', error);\n    process.exit(1);\n  });","size_bytes":18176},"server/add-comprehensive-cities.ts":{"content":"\n\n\n\n\nexport async function addComprehensiveCities() {\n  console.log(\"üèôÔ∏è Iniciando cadastro de cidades abrangentes...\");\n  \n  let addedCount = 0;\n  let skippedCount = 0;\n  \n  for (const city of cities) {\n    try {\n      // Check if city already exists\n      const existingCity = await db.select()\n        .from(destinations)\n        .where(eq(destinations.name, city.name))\n        .limit(1);\n      \n      if (existingCity.length > 0) {\n        console.log(`‚è≠Ô∏è Cidade j√° existe: ${city.name}`);\n        skippedCount++;\n        continue;\n      }\n      \n      // Insert new city\n      await db.insert(destinations).values({\n        name: city.name,\n        state: city.state,\n        country: city.country,\n        countryType: city.countryType,\n        region: city.region,\n        continent: city.continent,\n        latitude: city.latitude.toString(),\n        longitude: city.longitude.toString(),\n        timezone: city.timezone,\n        isActive: true\n      });\n      \n      console.log(`‚úÖ Cidade adicionada: ${city.name}, ${city.state || city.country}`);\n      addedCount++;\n      \n    } catch (error) {\n      console.error(`‚ùå Erro ao adicionar cidade ${city.name}:`, error);\n    }\n  }\n  \n  console.log(`\\nüéâ Processo conclu√≠do!`);\n  console.log(`üìä Resumo:`);\n  console.log(`   ‚úÖ Cidades adicionadas: ${addedCount}`);\n  console.log(`   ‚è≠Ô∏è Cidades j√° existentes: ${skippedCount}`);\n  console.log(`   üèôÔ∏è Total processado: ${cities.length}`);\n}\n\n// Run the function if this file is executed directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  addComprehensiveCities()\n    .then(() => {\n      console.log(\"‚ú® Script finalizado com sucesso!\");\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error(\"üí• Erro fatal:\", error);\n      process.exit(1);\n    });\n}","size_bytes":1822},"server/add-destination-column-to-activities.ts":{"content":"#!/usr/bin/env tsx\n\nimport { db } from \"./db\";\nimport { sql } from \"drizzle-orm\";\n\nasync function addDestinationColumnToActivities() {\n  console.log(\"üöÄ Adicionando coluna destination_id √† tabela activities...\");\n  \n  try {\n    // 1. Verificar se a coluna j√° existe\n    console.log(\"üîç Verificando estrutura da tabela activities...\");\n    const columns = await db.execute(sql`SHOW COLUMNS FROM activities LIKE 'destination_id'`);\n    \n    if (columns[0] && (columns[0] as any[]).length > 0) {\n      console.log(\"‚ÑπÔ∏è Coluna destination_id j√° existe em activities\");\n    } else {\n      console.log(\"‚ûï Adicionando coluna destination_id...\");\n      await db.execute(sql`ALTER TABLE activities ADD COLUMN destination_id INT NOT NULL DEFAULT 1`);\n      console.log(\"‚úÖ Coluna destination_id adicionada\");\n    }\n    \n    // 2. Verificar se h√° atividades √≥rf√£os agora\n    console.log(\"üîç Verificando activities √≥rf√£os...\");\n    const orphanActivities = await db.execute(sql`\n      SELECT a.id, a.title, a.destination_id \n      FROM activities a \n      LEFT JOIN destinations d ON a.destination_id = d.id \n      WHERE d.id IS NULL\n      LIMIT 5\n    `);\n    \n    const activityRows = orphanActivities[0] as any[];\n    console.log(`üìä Activities √≥rf√£os encontrados: ${activityRows.length}`);\n    \n    // 3. Corrigir activities √≥rf√£os se existirem\n    if (activityRows.length > 0) {\n      for (const activityData of activityRows) {\n        console.log(`üîß Corrigindo activity ID ${activityData.id}: ${activityData.title}`);\n        await db.execute(sql`UPDATE activities SET destination_id = 1 WHERE id = ${activityData.id}`);\n      }\n      console.log(\"‚úÖ Activities √≥rf√£os corrigidos\");\n    }\n    \n    // 4. Tentar adicionar foreign key para activities\n    console.log(\"üîó Adicionando foreign key para activities...\");\n    try {\n      await db.execute(sql`ALTER TABLE activities ADD CONSTRAINT activities_destinations_fk FOREIGN KEY (destination_id) REFERENCES destinations(id)`);\n      console.log(\"‚úÖ FK activities_destinations_fk adicionada\");\n    } catch (e: any) {\n      if (e.message.includes('already exists') || e.message.includes('duplicate')) {\n        console.log(\"‚ÑπÔ∏è FK activities j√° existe\");\n      } else {\n        console.log(\"‚ö†Ô∏è Erro FK activities:\", e.message.substring(0, 100));\n      }\n    }\n    \n    console.log(\"üéâ Migra√ß√£o de activities conclu√≠da!\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro:\", error);\n    throw error;\n  }\n}\n\n// Executar\naddDestinationColumnToActivities()\n  .then(() => {\n    console.log(\"‚úÖ Sucesso!\");\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error(\"‚ùå Falha:\", error);\n    process.exit(1);\n  });","size_bytes":2709},"server/add-destinations.ts":{"content":"import { db } from './db.ts';\nimport { destinations } from '../shared/schema.ts';\n\nasync function addDestinations() {\n\n  console.log('üîó Conectado ao MySQL, inserindo destinos...');\n\n  const destinations = [\n    // Regi√£o Sudeste - Brasil (completando SP e RJ)\n    ['Paraty', 'RJ', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Petr√≥polis', 'RJ', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Angra dos Reis', 'RJ', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['B√∫zios', 'RJ', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Ilha Grande', 'RJ', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Teres√≥polis', 'RJ', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Niter√≥i', 'RJ', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Campos do Jord√£o', 'SP', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Ubatuba', 'SP', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Ilhabela', 'SP', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Santos', 'SP', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['S√£o Sebasti√£o', 'SP', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Brotas', 'SP', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Holambra', 'SP', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Embu das Artes', 'SP', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Campinas', 'SP', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    \n    // Minas Gerais - Completando\n    ['Belo Horizonte', 'MG', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Tiradentes', 'MG', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Mariana', 'MG', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Capit√≥lio', 'MG', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Diamantina', 'MG', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['S√£o Thom√© das Letras', 'MG', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Brumadinho', 'MG', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Lavras Novas', 'MG', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Congonhas', 'MG', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Vi√ßosa', 'MG', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Juiz de Fora', 'MG', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n\n    // Esp√≠rito Santo\n    ['Vit√≥ria', 'ES', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Vila Velha', 'ES', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Guarapari', 'ES', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n    ['Domingos Martins', 'ES', 'Brasil', 'nacional', 'Sudeste', 'Am√©rica do Sul'],\n\n    // Regi√£o Sul - Brasil (completando)\n    ['Curitiba', 'PR', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Foz do Igua√ßu', 'PR', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Ilha do Mel', 'PR', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Morretes', 'PR', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Antonina', 'PR', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Londrina', 'PR', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Maring√°', 'PR', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    \n    // Santa Catarina - Completando\n    ['Florian√≥polis', 'SC', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Balne√°rio Cambori√∫', 'SC', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Blumenau', 'SC', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Joinville', 'SC', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Bombinhas', 'SC', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Garopaba', 'SC', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Praia do Rosa', 'SC', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Urubici', 'SC', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['S√£o Joaquim', 'SC', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    \n    // Rio Grande do Sul - Completando\n    ['Canela', 'RS', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Bento Gon√ßalves', 'RS', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Porto Alegre', 'RS', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Torres', 'RS', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Cambar√° do Sul', 'RS', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Nova Petr√≥polis', 'RS', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Caxias do Sul', 'RS', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n    ['Pelotas', 'RS', 'Brasil', 'nacional', 'Sul', 'Am√©rica do Sul'],\n\n    // Regi√£o Nordeste - Brasil (completando)\n    ['Salvador', 'BA', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Morro de S√£o Paulo', 'BA', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Chapada Diamantina', 'BA', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Porto Seguro', 'BA', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Trancoso', 'BA', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Arraial d\\'Ajuda', 'BA', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Itacar√©', 'BA', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Ilh√©us', 'BA', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Mucug√™', 'BA', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Len√ß√≥is', 'BA', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    \n    // Cear√° - Completando\n    ['Fortaleza', 'CE', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Jericoacoara', 'CE', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Canoa Quebrada', 'CE', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Sobral', 'CE', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    \n    // Rio Grande do Norte - Completando\n    ['Natal', 'RN', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Pipa', 'RN', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['S√£o Miguel do Gostoso', 'RN', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    \n    // Para√≠ba\n    ['Jo√£o Pessoa', 'PB', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Cabedelo', 'PB', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Campina Grande', 'PB', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    \n    // Pernambuco - Completando\n    ['Recife', 'PE', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Olinda', 'PE', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Porto de Galinhas', 'PE', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Fernando de Noronha', 'PE', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    \n    // Alagoas - Completando\n    ['Macei√≥', 'AL', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['S√£o Miguel dos Milagres', 'AL', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    \n    // Sergipe\n    ['Aracaju', 'SE', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Canind√© de S√£o Francisco', 'SE', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    \n    // Maranh√£o - Completando\n    ['S√£o Lu√≠s', 'MA', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Alc√¢ntara', 'MA', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    \n    // Piau√≠\n    ['Teresina', 'PI', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Parna√≠ba', 'PI', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n    ['Delta do Parna√≠ba', 'PI', 'Brasil', 'nacional', 'Nordeste', 'Am√©rica do Sul'],\n\n    // Regi√£o Centro-Oeste - Brasil (completando)\n    ['Bras√≠lia', 'DF', 'Brasil', 'nacional', 'Centro-Oeste', 'Am√©rica do Sul'],\n    ['Chapada dos Guimar√£es', 'MT', 'Brasil', 'nacional', 'Centro-Oeste', 'Am√©rica do Sul'],\n    ['Cuiab√°', 'MT', 'Brasil', 'nacional', 'Centro-Oeste', 'Am√©rica do Sul'],\n    ['Pocon√©', 'MT', 'Brasil', 'nacional', 'Centro-Oeste', 'Am√©rica do Sul'],\n    ['Campo Grande', 'MS', 'Brasil', 'nacional', 'Centro-Oeste', 'Am√©rica do Sul'],\n    ['Aquidauana', 'MS', 'Brasil', 'nacional', 'Centro-Oeste', 'Am√©rica do Sul'],\n    ['Corumb√°', 'MS', 'Brasil', 'nacional', 'Centro-Oeste', 'Am√©rica do Sul'],\n    ['Goi√¢nia', 'GO', 'Brasil', 'nacional', 'Centro-Oeste', 'Am√©rica do Sul'],\n    ['Piren√≥polis', 'GO', 'Brasil', 'nacional', 'Centro-Oeste', 'Am√©rica do Sul'],\n    ['Alto Para√≠so de Goi√°s', 'GO', 'Brasil', 'nacional', 'Centro-Oeste', 'Am√©rica do Sul'],\n\n    // Regi√£o Norte - Brasil (completando)\n    ['Bel√©m', 'PA', 'Brasil', 'nacional', 'Norte', 'Am√©rica do Sul'],\n    ['Alter do Ch√£o', 'PA', 'Brasil', 'nacional', 'Norte', 'Am√©rica do Sul'],\n    ['Santar√©m', 'PA', 'Brasil', 'nacional', 'Norte', 'Am√©rica do Sul'],\n    ['Macap√°', 'AP', 'Brasil', 'nacional', 'Norte', 'Am√©rica do Sul'],\n    ['Boa Vista', 'RR', 'Brasil', 'nacional', 'Norte', 'Am√©rica do Sul'],\n    ['Rio Branco', 'AC', 'Brasil', 'nacional', 'Norte', 'Am√©rica do Sul'],\n    ['Porto Velho', 'RO', 'Brasil', 'nacional', 'Norte', 'Am√©rica do Sul'],\n    ['Palmas', 'TO', 'Brasil', 'nacional', 'Norte', 'Am√©rica do Sul'],\n    ['Jalap√£o', 'TO', 'Brasil', 'nacional', 'Norte', 'Am√©rica do Sul'],\n\n    // Am√©rica do Sul - Internacional\n    ['Bariloche', null, 'Argentina', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Mendoza', null, 'Argentina', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['C√≥rdoba', null, 'Argentina', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Salta', null, 'Argentina', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Santiago', null, 'Chile', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Valpara√≠so', null, 'Chile', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Atacama', null, 'Chile', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Lima', null, 'Peru', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Cusco', null, 'Peru', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Machu Picchu', null, 'Peru', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Arequipa', null, 'Peru', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Montevid√©u', null, 'Uruguai', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Punta del Este', null, 'Uruguai', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['La Paz', null, 'Bol√≠via', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Salar de Uyuni', null, 'Bol√≠via', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Quito', null, 'Equador', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Gal√°pagos', null, 'Equador', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Bogot√°', null, 'Col√¥mbia', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Cartagena', null, 'Col√¥mbia', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n    ['Caracas', null, 'Venezuela', 'internacional', 'Am√©rica do Sul', 'Am√©rica do Sul'],\n\n    // Am√©rica do Norte - Internacional\n    ['Nova York', null, 'Estados Unidos', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['Los Angeles', null, 'Estados Unidos', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['Miami', null, 'Estados Unidos', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['Las Vegas', null, 'Estados Unidos', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['San Francisco', null, 'Estados Unidos', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['Chicago', null, 'Estados Unidos', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['Orlando', null, 'Estados Unidos', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['Washington', null, 'Estados Unidos', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['Boston', null, 'Estados Unidos', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['Toronto', null, 'Canad√°', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['Vancouver', null, 'Canad√°', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['Montreal', null, 'Canad√°', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['Canc√∫n', null, 'M√©xico', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['Playa del Carmen', null, 'M√©xico', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['Puerto Vallarta', null, 'M√©xico', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n    ['Cidade do M√©xico', null, 'M√©xico', 'internacional', 'Am√©rica do Norte', 'Am√©rica do Norte'],\n\n    // Europa - Internacional\n    ['Londres', null, 'Reino Unido', 'internacional', 'Europa Ocidental', 'Europa'],\n    ['Edinburgh', null, 'Reino Unido', 'internacional', 'Europa Ocidental', 'Europa'],\n    ['Dublin', null, 'Irlanda', 'internacional', 'Europa Ocidental', 'Europa'],\n    ['Paris', null, 'Fran√ßa', 'internacional', 'Europa Ocidental', 'Europa'],\n    ['Nice', null, 'Fran√ßa', 'internacional', 'Europa Ocidental', 'Europa'],\n    ['Lyon', null, 'Fran√ßa', 'internacional', 'Europa Ocidental', 'Europa'],\n    ['Barcelona', null, 'Espanha', 'internacional', 'Europa Meridional', 'Europa'],\n    ['Madrid', null, 'Espanha', 'internacional', 'Europa Meridional', 'Europa'],\n    ['Sevilha', null, 'Espanha', 'internacional', 'Europa Meridional', 'Europa'],\n    ['Valencia', null, 'Espanha', 'internacional', 'Europa Meridional', 'Europa'],\n    ['Lisboa', null, 'Portugal', 'internacional', 'Europa Meridional', 'Europa'],\n    ['Porto', null, 'Portugal', 'internacional', 'Europa Meridional', 'Europa'],\n    ['Roma', null, 'It√°lia', 'internacional', 'Europa Meridional', 'Europa'],\n    ['Mil√£o', null, 'It√°lia', 'internacional', 'Europa Meridional', 'Europa'],\n    ['Veneza', null, 'It√°lia', 'internacional', 'Europa Meridional', 'Europa'],\n    ['Floren√ßa', null, 'It√°lia', 'internacional', 'Europa Meridional', 'Europa'],\n    ['N√°poles', null, 'It√°lia', 'internacional', 'Europa Meridional', 'Europa'],\n    ['Amsterdam', null, 'Holanda', 'internacional', 'Europa Ocidental', 'Europa'],\n    ['Berlim', null, 'Alemanha', 'internacional', 'Europa Central', 'Europa'],\n    ['Munique', null, 'Alemanha', 'internacional', 'Europa Central', 'Europa'],\n    ['Hamburgo', null, 'Alemanha', 'internacional', 'Europa Central', 'Europa'],\n    ['Viena', null, '√Åustria', 'internacional', 'Europa Central', 'Europa'],\n    ['Salzburgo', null, '√Åustria', 'internacional', 'Europa Central', 'Europa'],\n    ['Zurique', null, 'Su√≠√ßa', 'internacional', 'Europa Central', 'Europa'],\n    ['Genebra', null, 'Su√≠√ßa', 'internacional', 'Europa Central', 'Europa'],\n    ['Praga', null, 'Rep√∫blica Tcheca', 'internacional', 'Europa Central', 'Europa'],\n    ['Budapeste', null, 'Hungria', 'internacional', 'Europa Central', 'Europa'],\n    ['Vars√≥via', null, 'Pol√¥nia', 'internacional', 'Europa Central', 'Europa'],\n    ['Crac√≥via', null, 'Pol√¥nia', 'internacional', 'Europa Central', 'Europa'],\n    ['Estocolmo', null, 'Su√©cia', 'internacional', 'Europa Setentrional', 'Europa'],\n    ['Oslo', null, 'Noruega', 'internacional', 'Europa Setentrional', 'Europa'],\n    ['Copenhague', null, 'Dinamarca', 'internacional', 'Europa Setentrional', 'Europa'],\n    ['Helsinque', null, 'Finl√¢ndia', 'internacional', 'Europa Setentrional', 'Europa'],\n    ['Moscou', null, 'R√∫ssia', 'internacional', 'Europa Oriental', 'Europa'],\n    ['S√£o Petersburgo', null, 'R√∫ssia', 'internacional', 'Europa Oriental', 'Europa'],\n    ['Atenas', null, 'Gr√©cia', 'internacional', 'Europa Meridional', 'Europa'],\n    ['Santorini', null, 'Gr√©cia', 'internacional', 'Europa Meridional', 'Europa'],\n    ['Mykonos', null, 'Gr√©cia', 'internacional', 'Europa Meridional', 'Europa'],\n    ['Istambul', null, 'Turquia', 'internacional', 'Europa/√Åsia', 'Europa'],\n\n    // √Åsia - Internacional\n    ['T√≥quio', null, 'Jap√£o', 'internacional', '√Åsia Oriental', '√Åsia'],\n    ['Kyoto', null, 'Jap√£o', 'internacional', '√Åsia Oriental', '√Åsia'],\n    ['Osaka', null, 'Jap√£o', 'internacional', '√Åsia Oriental', '√Åsia'],\n    ['Hiroshima', null, 'Jap√£o', 'internacional', '√Åsia Oriental', '√Åsia'],\n    ['Bangkok', null, 'Tail√¢ndia', 'internacional', 'Sudeste Asi√°tico', '√Åsia'],\n    ['Phuket', null, 'Tail√¢ndia', 'internacional', 'Sudeste Asi√°tico', '√Åsia'],\n    ['Chiang Mai', null, 'Tail√¢ndia', 'internacional', 'Sudeste Asi√°tico', '√Åsia'],\n    ['Cingapura', null, 'Singapura', 'internacional', 'Sudeste Asi√°tico', '√Åsia'],\n    ['Kuala Lumpur', null, 'Mal√°sia', 'internacional', 'Sudeste Asi√°tico', '√Åsia'],\n    ['Bali', null, 'Indon√©sia', 'internacional', 'Sudeste Asi√°tico', '√Åsia'],\n    ['Jakarta', null, 'Indon√©sia', 'internacional', 'Sudeste Asi√°tico', '√Åsia'],\n    ['Ho Chi Minh', null, 'Vietn√£', 'internacional', 'Sudeste Asi√°tico', '√Åsia'],\n    ['Han√≥i', null, 'Vietn√£', 'internacional', 'Sudeste Asi√°tico', '√Åsia'],\n    ['Manila', null, 'Filipinas', 'internacional', 'Sudeste Asi√°tico', '√Åsia'],\n    ['Boracay', null, 'Filipinas', 'internacional', 'Sudeste Asi√°tico', '√Åsia'],\n    ['Hong Kong', null, 'China', 'internacional', '√Åsia Oriental', '√Åsia'],\n    ['Pequim', null, 'China', 'internacional', '√Åsia Oriental', '√Åsia'],\n    ['Xangai', null, 'China', 'internacional', '√Åsia Oriental', '√Åsia'],\n    ['Seul', null, 'Coreia do Sul', 'internacional', '√Åsia Oriental', '√Åsia'],\n    ['Busan', null, 'Coreia do Sul', 'internacional', '√Åsia Oriental', '√Åsia'],\n    ['Nova Delhi', null, '√çndia', 'internacional', '√Åsia Meridional', '√Åsia'],\n    ['Mumbai', null, '√çndia', 'internacional', '√Åsia Meridional', '√Åsia'],\n    ['Goa', null, '√çndia', 'internacional', '√Åsia Meridional', '√Åsia'],\n    ['Jaipur', null, '√çndia', 'internacional', '√Åsia Meridional', '√Åsia'],\n    ['Dubai', null, 'Emirados √Årabes Unidos', 'internacional', '√Åsia Ocidental', '√Åsia'],\n    ['Abu Dhabi', null, 'Emirados √Årabes Unidos', 'internacional', '√Åsia Ocidental', '√Åsia'],\n    ['Doha', null, 'Catar', 'internacional', '√Åsia Ocidental', '√Åsia'],\n\n    // √Åfrica - Internacional\n    ['Cairo', null, 'Egito', 'internacional', '√Åfrica do Norte', '√Åfrica'],\n    ['Luxor', null, 'Egito', 'internacional', '√Åfrica do Norte', '√Åfrica'],\n    ['Marrakech', null, 'Marrocos', 'internacional', '√Åfrica do Norte', '√Åfrica'],\n    ['Casablanca', null, 'Marrocos', 'internacional', '√Åfrica do Norte', '√Åfrica'],\n    ['Fez', null, 'Marrocos', 'internacional', '√Åfrica do Norte', '√Åfrica'],\n    ['Cidade do Cabo', null, '√Åfrica do Sul', 'internacional', '√Åfrica Austral', '√Åfrica'],\n    ['Johannesburg', null, '√Åfrica do Sul', 'internacional', '√Åfrica Austral', '√Åfrica'],\n    ['Durban', null, '√Åfrica do Sul', 'internacional', '√Åfrica Austral', '√Åfrica'],\n    ['Nairobi', null, 'Qu√™nia', 'internacional', '√Åfrica Oriental', '√Åfrica'],\n    ['Zanzibar', null, 'Tanz√¢nia', 'internacional', '√Åfrica Oriental', '√Åfrica'],\n\n    // Oceania - Internacional\n    ['Sydney', null, 'Austr√°lia', 'internacional', 'Oceania', 'Oceania'],\n    ['Melbourne', null, 'Austr√°lia', 'internacional', 'Oceania', 'Oceania'],\n    ['Brisbane', null, 'Austr√°lia', 'internacional', 'Oceania', 'Oceania'],\n    ['Perth', null, 'Austr√°lia', 'internacional', 'Oceania', 'Oceania'],\n    ['Gold Coast', null, 'Austr√°lia', 'internacional', 'Oceania', 'Oceania'],\n    ['Adelaide', null, 'Austr√°lia', 'internacional', 'Oceania', 'Oceania'],\n    ['Auckland', null, 'Nova Zel√¢ndia', 'internacional', 'Oceania', 'Oceania'],\n    ['Wellington', null, 'Nova Zel√¢ndia', 'internacional', 'Oceania', 'Oceania'],\n    ['Queenstown', null, 'Nova Zel√¢ndia', 'internacional', 'Oceania', 'Oceania']\n  ];\n\n  let inserted = 0;\n  let existing = 0;\n\n  for (const dest of destinations) {\n    try {\n      const destObj = {\n        name: dest[0],\n        state: dest[1],\n        country: dest[2],\n        countryType: dest[3],\n        region: dest[4],\n        continent: dest[5]\n      };\n      \n      await db.insert(destinations).values(destObj).ignore();\n      inserted++;\n      console.log(`‚úÖ ${dest[0]}, ${dest[2]}`);\n    } catch (error) {\n      existing++;\n      console.log(`‚ö†Ô∏è J√° existe: ${dest[0]}`);\n    }\n  }\n\n  console.log(`\\nüìä Resumo:`);\n  console.log(`   ‚úÖ Novos destinos: ${inserted}`);\n  console.log(`   ‚ö†Ô∏è J√° existiam: ${existing}`);\n  console.log(`   üìç Total processado: ${destinations.length}`);\n\n  console.log('‚úÖ Conclu√≠do!');\n}\n\naddDestinations().catch(console.error);\n","size_bytes":20615},"server/add-gramado-activities-fixed.ts":{"content":"#!/usr/bin/env tsx\nimport { db } from './db.js';\nimport { activities, activityBudgetProposals, activityReviews } from '../shared/schema.js';\nimport { eq, desc } from 'drizzle-orm';\n\n// Atividades de Gramado compat√≠veis com schema MySQL\nconst gramadoActivities = [\n  {\n    title: 'Mini Mundo',\n    description: 'O Mini Mundo √© um parque tem√°tico √∫nico que apresenta r√©plicas em miniatura de monumentos e constru√ß√µes famosas do mundo inteiro. Com mais de 40 atra√ß√µes distribu√≠das em 23 mil m¬≤, o parque oferece uma viagem pelo mundo em escala reduzida. As miniaturas s√£o constru√≠das com riqueza de detalhes e incluem sistemas de ilumina√ß√£o e movimento.',\n    location: 'Gramado, RS',\n    category: 'pontos_turisticos',\n    countryType: 'nacional',\n    region: 'Sul',\n    city: 'Gramado',\n    priceType: 'per_person',\n    priceAmount: null,\n    duration: '2 horas',\n    difficultyLevel: 'easy',\n    maxParticipants: 30,\n    coverImage: 'https://images.unsplash.com/photo-1594736797933-d0501ba2fe65?q=80&w=1200&auto=format&fit=crop',\n    averageRating: \"4.30\",\n    totalRatings: 892,\n    createdById: 1\n  },\n  {\n    title: 'Dreamland Museu de Cera',\n    description: 'O Dreamland Museu de Cera oferece uma experi√™ncia √∫nica com figuras de cera hiper-realistas de celebridades, personagens hist√≥ricos e fict√≠cios. O museu conta com cen√°rios tem√°ticos e interativos, proporcionando uma experi√™ncia imersiva e divertida para visitantes de todas as idades.',\n    location: 'Gramado, RS',\n    category: 'cultural',\n    countryType: 'nacional',\n    region: 'Sul',\n    city: 'Gramado',\n    priceType: 'per_person',\n    priceAmount: null,\n    duration: '1.5 horas',\n    difficultyLevel: 'easy',\n    maxParticipants: 40,\n    coverImage: 'https://images.unsplash.com/photo-1518998053901-5348d3961a04?q=80&w=1200&auto=format&fit=crop',\n    averageRating: \"4.10\",\n    totalRatings: 654,\n    createdById: 1\n  },\n  {\n    title: 'GramadoZoo',\n    description: 'O GramadoZoo √© um zool√≥gico moderno que abriga mais de 1.500 animais de 200 esp√©cies diferentes, incluindo fauna nativa e ex√≥tica. Localizado em meio √† natureza preservada da Serra Ga√∫cha, oferece uma experi√™ncia educativa e divertida com habitats naturais e programas de conserva√ß√£o.',\n    location: 'Gramado, RS',\n    category: 'nature',\n    countryType: 'nacional',\n    region: 'Sul',\n    city: 'Gramado',\n    priceType: 'per_person',\n    priceAmount: null,\n    duration: '3 horas',\n    difficultyLevel: 'easy',\n    maxParticipants: 50,\n    coverImage: 'https://images.unsplash.com/photo-1549366021-9f761d040a94?q=80&w=1200&auto=format&fit=crop',\n    averageRating: \"4.50\",\n    totalRatings: 1689,\n    createdById: 1\n  },\n  {\n    title: 'Tour de Vin√≠colas no Vale dos Vinhedos',\n    description: 'Tour pelas renomadas vin√≠colas da regi√£o com degusta√ß√£o de diferentes tipos de vinho, harmoniza√ß√µes gastron√¥micas e vistas panor√¢micas dos vinhedos em meio √†s montanhas da Serra Ga√∫cha. Inclui visitas ao processo de produ√ß√£o e experi√™ncias culturais aut√™nticas.',\n    location: 'Gramado, RS',\n    category: 'food_tours',\n    countryType: 'nacional',\n    region: 'Sul',\n    city: 'Gramado',\n    priceType: 'per_person',\n    priceAmount: null,\n    duration: '8 horas',\n    difficultyLevel: 'easy',\n    minParticipants: 2,\n    maxParticipants: 25,\n    coverImage: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?q=80&w=1200&auto=format&fit=crop',\n    averageRating: \"4.80\",\n    totalRatings: 756,\n    createdById: 1,\n    requirements: ['Idade m√≠nima: 18 anos']\n  },\n  {\n    title: 'Snowland - Parque de Neve Indoor',\n    description: 'O primeiro parque de neve indoor das Am√©ricas oferece experi√™ncia √∫nica com temperatura controlada a -5¬∞C. Inclui atividades como esqui, snowboard, patina√ß√£o no gelo e tobog√£, com instrutores qualificados e equipamentos de seguran√ßa fornecidos.',\n    location: 'Gramado, RS',\n    category: 'adventure',\n    countryType: 'nacional',\n    region: 'Sul',\n    city: 'Gramado',\n    priceType: 'per_person',\n    priceAmount: null,\n    duration: '4 horas',\n    difficultyLevel: 'medium',\n    minParticipants: 1,\n    maxParticipants: 20,\n    coverImage: 'https://images.unsplash.com/photo-1551524164-6cf5ac833fb8?q=80&w=1200&auto=format&fit=crop',\n    averageRating: \"4.40\",\n    totalRatings: 1123,\n    createdById: 1,\n    requirements: ['Idade m√≠nima: 8 anos', 'Roupa e equipamentos fornecidos']\n  }\n];\n\n// Propostas de or√ßamento para cada atividade\nconst budgetProposals = [\n  // Mini Mundo (3 propostas)\n  {\n    title: 'Ingresso Econ√¥mico',\n    description: 'Entrada simples para explorar o Mini Mundo por conta pr√≥pria',\n    amount: \"80.00\",\n    inclusions: ['Entrada para o parque', 'Mapa do local', 'Acesso a todas as miniaturas'],\n    exclusions: ['Transporte', 'Alimenta√ß√£o', 'Guia'],\n    createdBy: 1\n  },\n  {\n    title: 'Pacote Completo',\n    description: 'Entrada com transporte incluso saindo do centro de Gramado',\n    amount: \"120.00\",\n    inclusions: ['Entrada para o parque', 'Transporte ida e volta', 'Mapa do local'],\n    exclusions: ['Alimenta√ß√£o', 'Guia especializado'],\n    votes: 89,\n    createdBy: 1\n  },\n  {\n    title: 'Experi√™ncia Premium',\n    description: 'Tour completo com guia especializado e almo√ßo incluso',\n    amount: \"200.00\",\n    inclusions: ['Entrada', 'Transporte', 'Guia especializado', 'Almo√ßo', 'Fotos'],\n    exclusions: ['Bebidas alco√≥licas', 'Lembran√ßas'],\n    votes: 67,\n    createdBy: 1\n  },\n  // Dreamland (3 propostas)\n  {\n    title: 'Entrada Simples',\n    description: 'Acesso ao museu de cera com visita autoguiada',\n    amount: \"65.00\",\n    inclusions: ['Entrada para o museu', 'Mapa do local', 'Acesso a todas as figuras'],\n    exclusions: ['Atividades extras', 'Fotos profissionais', 'Guia'],\n    createdBy: 1\n  },\n  {\n    title: 'Combo Divers√£o',\n    description: 'Museu de cera + atividade extra (mini golf ou simuladores)',\n    amount: \"120.00\",\n    inclusions: ['Entrada para o museu', 'Mini golf OU simuladores', 'Acesso completo'],\n    exclusions: ['Transporte', 'Alimenta√ß√£o', 'Fotos profissionais'],\n    votes: 78,\n    createdBy: 1\n  },\n  {\n    title: 'VIP Experience',\n    description: 'Experi√™ncia completa com guia exclusivo e sess√£o de fotos',\n    amount: \"200.00\",\n    inclusions: ['Entrada', 'Guia exclusivo', 'Sess√£o de fotos', 'Todas as atividades'],\n    exclusions: ['Transporte', 'Alimenta√ß√£o'],\n    votes: 43,\n    createdBy: 1\n  },\n  // GramadoZoo (3 propostas)\n  {\n    title: 'Entrada Individual',\n    description: 'Acesso completo ao zool√≥gico com visita livre',\n    amount: \"45.00\",\n    inclusions: ['Entrada para o zool√≥gico', 'Mapa das esp√©cies', 'Acesso a todos os habitats'],\n    exclusions: ['Alimenta√ß√£o dos animais', 'Transporte', 'Guia'],\n    createdBy: 1\n  },\n  {\n    title: 'Experi√™ncia Fam√≠lia',\n    description: 'Entrada + atividade de alimenta√ß√£o supervisionada',\n    amount: \"75.00\",\n    inclusions: ['Entrada', 'Alimenta√ß√£o supervisionada', 'Programa educativo'],\n    exclusions: ['Transporte', 'Alimenta√ß√£o pessoal'],\n    votes: 156,\n    createdBy: 1\n  },\n  {\n    title: 'Tour Educativo',\n    description: 'Visita guiada com bi√≥logo e programa de conserva√ß√£o',\n    amount: \"120.00\",\n    inclusions: ['Entrada', 'Guia bi√≥logo', 'Programa educativo', 'Material did√°tico'],\n    exclusions: ['Transporte', 'Alimenta√ß√£o'],\n    votes: 92,\n    createdBy: 1\n  },\n  // Tour de Vin√≠colas (3 propostas)\n  {\n    title: 'Tour B√°sico',\n    description: 'Visita a 2 vin√≠colas com degusta√ß√£o b√°sica',\n    amount: \"180.00\",\n    inclusions: ['Transporte', 'Visita a 2 vin√≠colas', 'Degusta√ß√£o b√°sica'],\n    exclusions: ['Almo√ßo', 'Degusta√ß√£o premium', 'Compras'],\n    createdBy: 1\n  },\n  {\n    title: 'Tour Completo',\n    description: 'Visita a 3 vin√≠colas com almo√ßo e degusta√ß√£o completa',\n    amount: \"280.00\",\n    inclusions: ['Transporte', '3 vin√≠colas', 'Almo√ßo', 'Degusta√ß√£o completa', 'Guia'],\n    exclusions: ['Compras de vinhos', 'Degusta√ß√£o premium'],\n    votes: 234,\n    createdBy: 1\n  },\n  {\n    title: 'Experi√™ncia Premium',\n    description: 'Tour exclusivo com sommelier e vinhos especiais',\n    amount: \"450.00\",\n    inclusions: ['Transporte privativo', 'Sommelier', 'Vinhos premium', 'Almo√ßo gourmet'],\n    exclusions: ['Compras adicionais'],\n    votes: 87,\n    createdBy: 1\n  },\n  // Snowland (3 propostas)\n  {\n    title: 'Entrada B√°sica',\n    description: 'Acesso ao parque com equipamentos b√°sicos',\n    amount: \"150.00\",\n    inclusions: ['Entrada', 'Roupas t√©rmicas', 'Equipamentos b√°sicos', '2h de perman√™ncia'],\n    exclusions: ['Aulas particulares', 'Alimenta√ß√£o', 'Fotos'],\n    createdBy: 1\n  },\n  {\n    title: 'Pacote Aventura',\n    description: 'Entrada + aula de esqui ou snowboard',\n    amount: \"250.00\",\n    inclusions: ['Entrada', 'Equipamentos', 'Aula de 1h', 'Instrutor', '3h no parque'],\n    exclusions: ['Alimenta√ß√£o', 'Aulas adicionais'],\n    votes: 178,\n    createdBy: 1\n  },\n  {\n    title: 'Experi√™ncia Completa',\n    description: 'Pacote completo com todas as atividades e refei√ß√£o',\n    amount: \"380.00\",\n    inclusions: ['Acesso total', 'Todas as atividades', 'Aulas', 'Refei√ß√£o quente'],\n    exclusions: ['Bebidas alco√≥licas'],\n    votes: 145,\n    createdBy: 1\n  }\n];\n\nasync function addGramadoActivitiesFixed() {\n  console.log('üéø Iniciando cadastro das atividades de Gramado (vers√£o corrigida)...');\n  \n  try {\n    const insertedActivities = [];\n    \n    // Inserir atividades uma por uma\n    for (const activity of gramadoActivities) {\n      const [result] = await db.insert(activities).values(activity);\n      console.log(`‚úÖ Atividade \"${activity.title}\" cadastrada com sucesso`);\n      \n      // Buscar ID da atividade inserida\n      const [insertedActivity] = await db.select().from(activities)\n        .where(eq(activities.title, activity.title))\n        .orderBy(desc(activities.id))\n        .limit(1);\n      \n      insertedActivities.push(insertedActivity);\n    }\n\n    // Inserir propostas de or√ßamento\n    let proposalIndex = 0;\n    for (let i = 0; i < insertedActivities.length; i++) {\n      const activity = insertedActivities[i];\n      \n      // Cada atividade tem 3 propostas\n      for (let j = 0; j < 3; j++) {\n        const proposal = {\n          ...budgetProposals[proposalIndex],\n          activityId: activity.id\n        };\n        \n        await db.insert(activityBudgetProposals).values(proposal);\n        console.log(`üí∞ Proposta \"${proposal.title}\" criada para ${activity.title}`);\n        proposalIndex++;\n      }\n    }\n\n    console.log('üéâ Todas as atividades de Gramado foram adicionadas com sucesso!');\n    console.log(`üìä Total: ${insertedActivities.length} atividades, ${budgetProposals.length} propostas`);\n\n  } catch (error) {\n    console.error('‚ùå Erro ao cadastrar atividades:', error);\n    throw error;\n  }\n}\n\n// Executar se chamado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  addGramadoActivitiesFixed()\n    .then(() => process.exit(0))\n    .catch((error) => {\n      console.error('‚ùå Falha na execu√ß√£o:', error);\n      process.exit(1);\n    });\n}\n\nexport { addGramadoActivitiesFixed };","size_bytes":11189},"server/add-gramado-activities.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals, activityReviews } from '../shared/schema.js';\nimport { eq, desc } from 'drizzle-orm';\n\nconst gramadoActivities = [\n  {\n    title: 'Mini Mundo',\n    shortDescription: 'Parque tem√°tico com miniaturas em escala de monumentos e paisagens mundiais',\n    description: 'O Mini Mundo √© um parque tem√°tico √∫nico que apresenta r√©plicas em miniatura de monumentos famosos do mundo todo. Com mais de 24 pa√≠ses representados em uma √°rea de 23 mil metros quadrados, o parque oferece uma viagem ao redor do mundo sem sair de Gramado. As miniaturas s√£o constru√≠das em escala 1:24 e incluem desde o Cristo Redentor at√© a Torre Eiffel, passando por castelos europeus e paisagens t√≠picas de diversos pa√≠ses.',\n    location: 'Gramado, RS',\n    duration: \"2 horas\",\n    difficulty: 'easy',\n    category: 'pontos_turisticos',\n    price: 0,\n    imageUrl: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3',\n    includesTransport: false,\n    includesFood: false,\n    includesGuide: false,\n    maxParticipants: 50,\n    minAge: 0,\n    rating: 4.6,\n    reviewCount: 1247,\n    createdAt: new Date('2025-01-15T10:00:00Z'),\n    updatedAt: new Date('2025-01-15T10:00:00Z')\n  },\n  {\n    title: 'Dreamland Museu de Cera',\n    shortDescription: 'Museu de cera com figuras de personalidades famosas e cen√°rios tem√°ticos',\n    description: 'O Dreamland Museu de Cera √© uma atra√ß√£o imperd√≠vel em Gramado, apresentando mais de 40 figuras de cera hiperrealistas de personalidades nacionais e internacionais. O museu conta com cen√°rios tem√°ticos que recriam ambientes hist√≥ricos e contempor√¢neos, proporcionando uma experi√™ncia interativa √∫nica. Al√©m das figuras de cera, o complexo oferece atividades como mini golf, simuladores e espa√ßos para fotos tem√°ticas.',\n    location: 'Gramado, RS',\n    duration: \"1 horas\".5,\n    difficulty: 'easy',\n    category: 'cultural',\n    price: 0,\n    imageUrl: 'https://images.unsplash.com/photo-1594736797933-d0501ba2fe65?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3',\n    includesTransport: false,\n    includesFood: false,\n    includesGuide: false,\n    maxParticipants: 30,\n    minAge: 0,\n    rating: 4.3,\n    reviewCount: 892,\n    createdAt: new Date('2025-01-15T10:00:00Z'),\n    updatedAt: new Date('2025-01-15T10:00:00Z')\n  },\n  {\n    title: 'GramadoZoo',\n    shortDescription: 'Zool√≥gico com animais nativos e ex√≥ticos em ambiente natural preservado',\n    description: 'O GramadoZoo √© um zool√≥gico moderno que abriga mais de 1.500 animais de 200 esp√©cies diferentes, incluindo fauna nativa e ex√≥tica. Localizado em meio √† natureza preservada da Serra Ga√∫cha, o zool√≥gico oferece uma experi√™ncia educativa e divertida para toda a fam√≠lia. Os visitantes podem observar animais em habitats naturais, participar de atividades de alimenta√ß√£o supervisionada e aprender sobre conserva√ß√£o ambiental atrav√©s de programas educativos.',\n    location: 'Gramado, RS',\n    duration: \"3 horas\",\n    difficulty: 'easy',\n    category: 'nature',\n    price: 0,\n    imageUrl: 'https://images.unsplash.com/photo-1549366021-9f761d040a94?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3',\n    includesTransport: false,\n    includesFood: false,\n    includesGuide: false,\n    maxParticipants: 40,\n    minAge: 0,\n    rating: 4.5,\n    reviewCount: 1689,\n    createdAt: new Date('2025-01-15T10:00:00Z'),\n    updatedAt: new Date('2025-01-15T10:00:00Z')\n  },\n  {\n    title: 'Tour de Vin√≠colas no Vale dos Vinhedos',\n    shortDescription: 'Passeio pelas vin√≠colas da regi√£o com degusta√ß√£o de vinhos e paisagens deslumbrantes',\n    description: 'O Tour de Vin√≠colas no Vale dos Vinhedos √© uma experi√™ncia imperd√≠vel para os amantes de vinho. O passeio inclui visitas a renomadas vin√≠colas da regi√£o, onde os visitantes podem conhecer todo o processo de produ√ß√£o do vinho, desde o cultivo das uvas at√© o engarrafamento. A experi√™ncia inclui degusta√ß√µes de diferentes tipos de vinho, harmoniza√ß√µes gastron√¥micas e vistas panor√¢micas dos vinhedos em meio √†s montanhas da Serra Ga√∫cha.',\n    location: 'Gramado, RS',\n    duration: \"8 horas\",\n    difficulty: 'easy',\n    category: 'food_tours',\n    price: 0,\n    imageUrl: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3',\n    includesTransport: false,\n    includesFood: false,\n    includesGuide: false,\n    maxParticipants: 25,\n    minAge: 18,\n    rating: 4.8,\n    reviewCount: 756,\n    createdAt: new Date('2025-01-15T10:00:00Z'),\n    updatedAt: new Date('2025-01-15T10:00:00Z')\n  },\n  {\n    title: 'Snowland - Parque de Neve Indoor',\n    shortDescription: 'Primeiro parque de neve indoor das Am√©ricas com atividades de inverno',\n    description: 'O Snowland √© uma experi√™ncia √∫nica na Am√©rica Latina, oferecendo um ambiente de neve artificial com temperatura controlada a -5¬∞C. O parque conta com diversas atividades t√≠picas de inverno, incluindo esqui, snowboard, patina√ß√£o no gelo e tobog√£. Com instrutores qualificados e equipamentos de seguran√ßa, √© uma oportunidade perfeita para toda a fam√≠lia experimentar esportes de inverno em um ambiente seguro e controlado, independente da esta√ß√£o do ano.',\n    location: 'Gramado, RS',\n    duration: \"4 horas\",\n    difficulty: 'medium',\n    category: 'adventure',\n    price: 0,\n    imageUrl: 'https://images.unsplash.com/photo-1551524164-6cf5ac833fb8?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3',\n    includesTransport: false,\n    includesFood: false,\n    includesGuide: false,\n    maxParticipants: 20,\n    minAge: 8,\n    rating: 4.4,\n    reviewCount: 1123,\n    createdAt: new Date('2025-01-15T10:00:00Z'),\n    updatedAt: new Date('2025-01-15T10:00:00Z')\n  }\n];\n\nconst proposals = [\n  // Mini Mundo\n  {\n    activityId: 1, // Will be updated with actual ID\n    title: 'Ingresso Econ√¥mico',\n    description: 'Entrada simples para explorar o Mini Mundo por conta pr√≥pria',\n    price: 80,\n    duration: \"2 horas\",\n    inclusions: ['Entrada para o parque', 'Mapa do local', 'Acesso a todas as miniaturas'],\n    exclusions: ['Transporte', 'Alimenta√ß√£o', 'Guia'],\n    maxParticipants: 50,\n    isPopular: false,\n    vote_count: 45\n  },\n  {\n    activityId: 1,\n    title: 'Pacote Completo',\n    description: 'Entrada com transporte incluso saindo do centro de Gramado',\n    price: 120,\n    duration: \"3 horas\",\n    inclusions: ['Entrada para o parque', 'Transporte ida e volta', 'Mapa do local', 'Acesso a todas as miniaturas'],\n    exclusions: ['Alimenta√ß√£o', 'Guia especializado'],\n    maxParticipants: 30,\n    isPopular: true,\n    vote_count: 89\n  },\n  {\n    activityId: 1,\n    title: 'Experi√™ncia Premium',\n    description: 'Tour completo com guia especializado e almo√ßo incluso',\n    price: 200,\n    duration: \"4 horas\",\n    inclusions: ['Entrada para o parque', 'Transporte ida e volta', 'Guia especializado', 'Almo√ßo', 'Fotos profissionais'],\n    exclusions: ['Bebidas alco√≥licas', 'Lembran√ßas'],\n    maxParticipants: 15,\n    isPopular: false,\n    vote_count: 67\n  },\n  // Dreamland Museu de Cera\n  {\n    activityId: 2,\n    title: 'Entrada Simples',\n    description: 'Acesso ao museu de cera com visita autoguiada',\n    price: 65,\n    duration: \"1 horas\".5,\n    inclusions: ['Entrada para o museu', 'Mapa do local', 'Acesso a todas as figuras'],\n    exclusions: ['Atividades extras', 'Fotos profissionais', 'Guia'],\n    maxParticipants: 30,\n    isPopular: false,\n    vote_count: 52\n  },\n  {\n    activityId: 2,\n    title: 'Combo Divers√£o',\n    description: 'Museu de cera + atividade extra (mini golf ou simuladores)',\n    price: 120,\n    duration: \"2 horas\".5,\n    inclusions: ['Entrada para o museu', 'Mini golf OU simuladores', 'Acesso a todas as figuras'],\n    exclusions: ['Transporte', 'Alimenta√ß√£o', 'Fotos profissionais'],\n    maxParticipants: 25,\n    isPopular: true,\n    vote_count: 78\n  },\n  {\n    activityId: 2,\n    title: 'VIP Experience',\n    description: 'Experi√™ncia completa com guia exclusivo e sess√£o de fotos',\n    price: 200,\n    duration: \"3 horas\",\n    inclusions: ['Entrada para o museu', 'Guia exclusivo', 'Sess√£o de fotos profissionais', 'Todas as atividades'],\n    exclusions: ['Transporte', 'Alimenta√ß√£o'],\n    maxParticipants: 10,\n    isPopular: false,\n    vote_count: 43\n  },\n  // GramadoZoo\n  {\n    activityId: 3,\n    title: 'Entrada B√°sica',\n    description: 'Acesso ao zool√≥gico para visita livre',\n    price: 70,\n    duration: \"3 horas\",\n    inclusions: ['Entrada para o zool√≥gico', 'Mapa do local', 'Acesso a todas as √°reas'],\n    exclusions: ['Alimenta√ß√£o de animais', 'Guia', 'Transporte'],\n    maxParticipants: 40,\n    isPopular: false,\n    vote_count: 61\n  },\n  {\n    activityId: 3,\n    title: 'Visita Monitorada',\n    description: 'Tour guiado com explica√ß√µes sobre os animais e conserva√ß√£o',\n    price: 110,\n    duration: \"3 horas\",\n    inclusions: ['Entrada para o zool√≥gico', 'Guia especializado', 'Atividades educativas', 'Kit educativo'],\n    exclusions: ['Alimenta√ß√£o de animais', 'Transporte', 'Lanche'],\n    maxParticipants: 20,\n    isPopular: true,\n    vote_count: 94\n  },\n  {\n    activityId: 3,\n    title: 'Tour Especial',\n    description: 'Experi√™ncia completa com alimenta√ß√£o supervisionada de animais',\n    price: 150,\n    duration: \"4 horas\",\n    inclusions: ['Entrada para o zool√≥gico', 'Guia especializado', 'Alimenta√ß√£o supervisionada', 'Lanche', 'Certificado de participa√ß√£o'],\n    exclusions: ['Transporte', 'Almo√ßo completo'],\n    maxParticipants: 12,\n    isPopular: false,\n    vote_count: 38\n  },\n  // Tour de Vin√≠colas\n  {\n    activityId: 4,\n    title: 'Visita Autoguiada',\n    description: 'Acesso √†s vin√≠colas para visita por conta pr√≥pria',\n    price: 0,\n    duration: \"6 horas\",\n    inclusions: ['Mapas das vin√≠colas', 'Informa√ß√µes b√°sicas', 'Acesso √†s propriedades'],\n    exclusions: ['Degusta√ß√£o', 'Transporte', 'Alimenta√ß√£o', 'Guia'],\n    maxParticipants: 25,\n    isPopular: false,\n    vote_count: 23\n  },\n  {\n    activityId: 4,\n    title: 'Tour Cl√°ssico',\n    description: 'Visita a 2-3 vin√≠colas com degusta√ß√£o de vinhos',\n    price: 150,\n    duration: \"8 horas\",\n    inclusions: ['Transporte', 'Visita a 2-3 vin√≠colas', 'Degusta√ß√£o de vinhos', 'Guia especializado'],\n    exclusions: ['Almo√ßo', 'Compras de vinhos', 'Seguro'],\n    maxParticipants: 15,\n    isPopular: true,\n    vote_count: 112\n  },\n  {\n    activityId: 4,\n    title: 'Experi√™ncia Premium',\n    description: 'Tour privativo com almo√ßo harmonizado e degusta√ß√£o especial',\n    price: 300,\n    duration: \"8 horas\",\n    inclusions: ['Transporte privativo', 'Visita a vin√≠colas selecionadas', 'Almo√ßo harmonizado', 'Degusta√ß√£o premium', 'Guia sommelier'],\n    exclusions: ['Bebidas extras', 'Compras pessoais'],\n    maxParticipants: 8,\n    isPopular: false,\n    vote_count: 76\n  },\n  // Snowland\n  {\n    activityId: 5,\n    title: 'Entrada Simples',\n    description: 'Acesso ao parque de neve com atividades b√°sicas',\n    price: 180,\n    duration: \"3 horas\",\n    inclusions: ['Entrada para o parque', 'Uso de tren√≥', 'Acesso √† √°rea de neve', 'Equipamentos b√°sicos'],\n    exclusions: ['Roupas t√©rmicas', 'Aula de esqui', 'Fotos profissionais'],\n    maxParticipants: 20,\n    isPopular: false,\n    vote_count: 56\n  },\n  {\n    activityId: 5,\n    title: 'Pacote Completo',\n    description: 'Entrada com aluguel de roupas t√©rmicas inclu√≠do',\n    price: 300,\n    duration: \"4 horas\",\n    inclusions: ['Entrada para o parque', 'Roupas t√©rmicas', 'Todas as atividades', 'Equipamentos completos'],\n    exclusions: ['Aula de esqui', 'Fotos profissionais', 'Alimenta√ß√£o'],\n    maxParticipants: 15,\n    isPopular: true,\n    vote_count: 89\n  },\n  {\n    activityId: 5,\n    title: 'Experi√™ncia Premium',\n    description: 'Pacote completo com aula de esqui e fotos profissionais',\n    price: 450,\n    duration: \"4 horas\",\n    inclusions: ['Entrada para o parque', 'Roupas t√©rmicas', 'Aula de esqui', 'Fotos profissionais', 'Certificado', 'Lanche'],\n    exclusions: ['Transporte', 'Almo√ßo completo'],\n    maxParticipants: 10,\n    isPopular: false,\n    vote_count: 47\n  }\n];\n\nconst sampleReviews = [\n  // Mini Mundo\n  {\n    activityId: 1,\n    userId: 1,\n    rating: 5,\n    comment: 'Experi√™ncia incr√≠vel! As miniaturas s√£o muito bem feitas e detalhadas. Perfeito para toda a fam√≠lia.',\n    visitDate: new Date('2025-01-10T14:00:00Z'),\n    helpful: 12,\n    photos: ['https://images.unsplash.com/photo-1578662996442-48f60103fc96?q=80&w=400'],\n    isVerified: true\n  },\n  {\n    activityId: 1,\n    userId: 3,\n    rating: 4,\n    comment: 'Muito legal, especialmente para crian√ßas. Algumas √°reas poderiam ter mais manuten√ß√£o.',\n    visitDate: new Date('2025-01-08T16:30:00Z'),\n    helpful: 8,\n    photos: [],\n    isVerified: false\n  },\n  // Dreamland\n  {\n    activityId: 2,\n    userId: 2,\n    rating: 4,\n    comment: 'As figuras de cera s√£o impressionantes! Muito realistas. O museu √© bem organizado.',\n    visitDate: new Date('2025-01-12T10:00:00Z'),\n    helpful: 15,\n    photos: ['https://images.unsplash.com/photo-1594736797933-d0501ba2fe65?q=80&w=400'],\n    isVerified: true\n  },\n  // GramadoZoo\n  {\n    activityId: 3,\n    userId: 1,\n    rating: 5,\n    comment: 'Zool√≥gico fant√°stico! Os animais parecem bem cuidados e h√° muita diversidade.',\n    visitDate: new Date('2025-01-09T11:00:00Z'),\n    helpful: 20,\n    photos: ['https://images.unsplash.com/photo-1549366021-9f761d040a94?q=80&w=400'],\n    isVerified: true\n  },\n  // Tour de Vin√≠colas\n  {\n    activityId: 4,\n    userId: 2,\n    rating: 5,\n    comment: 'Tour excepcional! Os vinhos s√£o excelentes e as paisagens s√£o de tirar o f√¥lego.',\n    visitDate: new Date('2025-01-11T09:00:00Z'),\n    helpful: 18,\n    photos: ['https://images.unsplash.com/photo-1506905925346-21bda4d32df4?q=80&w=400'],\n    isVerified: true\n  },\n  // Snowland\n  {\n    activityId: 5,\n    userId: 3,\n    rating: 4,\n    comment: 'Experi√™ncia √∫nica! Nunca havia esquiado antes e foi muito divertido.',\n    visitDate: new Date('2025-01-07T13:00:00Z'),\n    helpful: 11,\n    photos: ['https://images.unsplash.com/photo-1551524164-6cf5ac833fb8?q=80&w=400'],\n    isVerified: false\n  }\n];\n\nasync function addGramadoActivities() {\n  console.log('üéø Iniciando cadastro das atividades de Gramado...');\n  \n  try {\n    // Insert activities\n    const insertedActivities = [];\n    for (const activity of gramadoActivities) {\n      const result = await db.insert(activities).values(activity);\n      \n      // Get the ID of the inserted activity\n      const [insertedActivity] = await db.select().from(activities).where(eq(activities.title, activity.title)).orderBy(desc(activities.id)).limit(1);\n      \n      insertedActivities.push({ ...activity, id: insertedActivity.id });\n      console.log(`‚úÖ Atividade \"${activity.title}\" cadastrada com ID: ${insertedActivity.id}`);\n    }\n\n    // Insert proposals with correct activity IDs\n    let proposalIndex = 0;\n    for (let i = 0; i < insertedActivities.length; i++) {\n      const activityId = insertedActivities[i].id;\n      \n      // Each activity has 3 proposals\n      for (let j = 0; j < 3; j++) {\n        const proposal = {\n          ...proposals[proposalIndex],\n          activityId: activityId\n        };\n        \n        await db.insert(activityBudgetProposals).values(proposal);\n        console.log(`‚úÖ Proposta \"${proposal.title}\" cadastrada para atividade ${activityId}`);\n        proposalIndex++;\n      }\n    }\n\n    // Insert reviews with correct activity IDs\n    for (const review of sampleReviews) {\n      const activityId = insertedActivities[review.activityId - 1].id;\n      await db.insert(activityReviews).values({\n        ...review,\n        activityId: activityId\n      });\n      console.log(`‚úÖ Avalia√ß√£o cadastrada para atividade ${activityId}`);\n    }\n\n    console.log('üéâ Todas as atividades de Gramado foram cadastradas com sucesso!');\n    console.log(`üìä Total: ${gramadoActivities.length} atividades, ${proposals.length} propostas, ${sampleReviews.length} avalia√ß√µes`);\n\n  } catch (error) {\n    console.error('‚ùå Erro ao cadastrar atividades:', error);\n    throw error;\n  }\n}\n\n// Execute if running directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  addGramadoActivities()\n    .then(() => process.exit(0))\n    .catch((error) => {\n      console.error('‚ùå Falha na execu√ß√£o:', error);\n      process.exit(1);\n    });\n}\n\nexport { addGramadoActivities };","size_bytes":16520},"server/add-hierarchical-columns.ts":{"content":"import { db } from './db.js';\n\nasync function addHierarchicalColumns() {\n  try {\n    console.log(\"üîÑ Adicionando colunas hier√°rquicas √† tabela activities...\");\n    \n    // Add the new columns to the activities table\n    await db.execute(`\n      ALTER TABLE activities \n      ADD COLUMN country_type VARCHAR(50) DEFAULT 'nacional' NOT NULL,\n      ADD COLUMN region VARCHAR(100),\n      ADD COLUMN city VARCHAR(100) NOT NULL DEFAULT ''\n    `);\n    \n    console.log(\"‚úÖ Colunas hier√°rquicas adicionadas com sucesso!\");\n    \n  } catch (error: any) {\n    if (error.code === 'ER_DUP_FIELDNAME') {\n      console.log(\"‚ÑπÔ∏è Colunas j√° existem, continuando...\");\n    } else {\n      console.error(\"‚ùå Erro ao adicionar colunas hier√°rquicas:\", error);\n    }\n  }\n}\n\nif (import.meta.url === `file://${process.argv[1]}`) {\n  addHierarchicalColumns().then(() => process.exit(0));\n}\n\nexport { addHierarchicalColumns };","size_bytes":911},"server/add-hierarchical-fields.ts":{"content":"import { db } from './db.js';\nimport { activities } from '../shared/schema.js';\nimport { eq, sql } from 'drizzle-orm';\n\n// Comprehensive hierarchical classification mapping for destinations\nconst locationMapping = {\n  // ==================== BRASIL - NACIONAL ====================\n  \n  // REGI√ÉO NORTE\n  \"Manaus, AM\": { countryType: \"nacional\", region: \"Norte\", city: \"Manaus\", state: \"Amazonas\" },\n  \"Bel√©m, PA\": { countryType: \"nacional\", region: \"Norte\", city: \"Bel√©m\", state: \"Par√°\" },\n  \"Palmas, TO\": { countryType: \"nacional\", region: \"Norte\", city: \"Palmas\", state: \"Tocantins\" },\n  \"Boa Vista, RR\": { countryType: \"nacional\", region: \"Norte\", city: \"Boa Vista\", state: \"Roraima\" },\n  \"Macap√°, AP\": { countryType: \"nacional\", region: \"Norte\", city: \"Macap√°\", state: \"Amap√°\" },\n  \"Rio Branco, AC\": { countryType: \"nacional\", region: \"Norte\", city: \"Rio Branco\", state: \"Acre\" },\n  \"Porto Velho, RO\": { countryType: \"nacional\", region: \"Norte\", city: \"Porto Velho\", state: \"Rond√¥nia\" },\n  \n  // REGI√ÉO NORDESTE\n  \"Salvador, BA\": { countryType: \"nacional\", region: \"Nordeste\", city: \"Salvador\", state: \"Bahia\" },\n  \"Fortaleza, CE\": { countryType: \"nacional\", region: \"Nordeste\", city: \"Fortaleza\", state: \"Cear√°\" },\n  \"Recife, PE\": { countryType: \"nacional\", region: \"Nordeste\", city: \"Recife\", state: \"Pernambuco\" },\n  \"Natal, RN\": { countryType: \"nacional\", region: \"Nordeste\", city: \"Natal\", state: \"Rio Grande do Norte\" },\n  \"Jo√£o Pessoa, PB\": { countryType: \"nacional\", region: \"Nordeste\", city: \"Jo√£o Pessoa\", state: \"Para√≠ba\" },\n  \"Macei√≥, AL\": { countryType: \"nacional\", region: \"Nordeste\", city: \"Macei√≥\", state: \"Alagoas\" },\n  \"Aracaju, SE\": { countryType: \"nacional\", region: \"Nordeste\", city: \"Aracaju\", state: \"Sergipe\" },\n  \"S√£o Lu√≠s, MA\": { countryType: \"nacional\", region: \"Nordeste\", city: \"S√£o Lu√≠s\", state: \"Maranh√£o\" },\n  \"Teresina, PI\": { countryType: \"nacional\", region: \"Nordeste\", city: \"Teresina\", state: \"Piau√≠\" },\n  \"Fernando de Noronha, PE\": { countryType: \"nacional\", region: \"Nordeste\", city: \"Fernando de Noronha\", state: \"Pernambuco\" },\n  \"Chapada Diamantina, BA\": { countryType: \"nacional\", region: \"Nordeste\", city: \"Chapada Diamantina\", state: \"Bahia\" },\n  \"Len√ß√≥is Maranhenses, MA\": { countryType: \"nacional\", region: \"Nordeste\", city: \"Len√ß√≥is Maranhenses\", state: \"Maranh√£o\" },\n  \"Maragogi, AL\": { countryType: \"nacional\", region: \"Nordeste\", city: \"Maragogi\", state: \"Alagoas\" },\n  \"Caruaru, PE\": { countryType: \"nacional\", region: \"Nordeste\", city: \"Caruaru\", state: \"Pernambuco\" },\n  \n  // REGI√ÉO CENTRO-OESTE\n  \"Bras√≠lia, DF\": { countryType: \"nacional\", region: \"Centro-Oeste\", city: \"Bras√≠lia\", state: \"Distrito Federal\" },\n  \"Goi√¢nia, GO\": { countryType: \"nacional\", region: \"Centro-Oeste\", city: \"Goi√¢nia\", state: \"Goi√°s\" },\n  \"Cuiab√°, MT\": { countryType: \"nacional\", region: \"Centro-Oeste\", city: \"Cuiab√°\", state: \"Mato Grosso\" },\n  \"Campo Grande, MS\": { countryType: \"nacional\", region: \"Centro-Oeste\", city: \"Campo Grande\", state: \"Mato Grosso do Sul\" },\n  \"Pantanal, MT\": { countryType: \"nacional\", region: \"Centro-Oeste\", city: \"Pantanal\", state: \"Mato Grosso\" },\n  \"Bonito, MS\": { countryType: \"nacional\", region: \"Centro-Oeste\", city: \"Bonito\", state: \"Mato Grosso do Sul\" },\n  \n  // REGI√ÉO SUDESTE\n  \"S√£o Paulo, SP\": { countryType: \"nacional\", region: \"Sudeste\", city: \"S√£o Paulo\", state: \"S√£o Paulo\" },\n  \"Rio de Janeiro, RJ\": { countryType: \"nacional\", region: \"Sudeste\", city: \"Rio de Janeiro\", state: \"Rio de Janeiro\" },\n  \"Belo Horizonte, MG\": { countryType: \"nacional\", region: \"Sudeste\", city: \"Belo Horizonte\", state: \"Minas Gerais\" },\n  \"Vit√≥ria, ES\": { countryType: \"nacional\", region: \"Sudeste\", city: \"Vit√≥ria\", state: \"Esp√≠rito Santo\" },\n  \"Campos do Jord√£o, SP\": { countryType: \"nacional\", region: \"Sudeste\", city: \"Campos do Jord√£o\", state: \"S√£o Paulo\" },\n  \"Ouro Preto, MG\": { countryType: \"nacional\", region: \"Sudeste\", city: \"Ouro Preto\", state: \"Minas Gerais\" },\n  \"Serra da Mantiqueira, MG\": { countryType: \"nacional\", region: \"Sudeste\", city: \"Serra da Mantiqueira\", state: \"Minas Gerais\" },\n  \n  // REGI√ÉO SUL\n  \"Curitiba, PR\": { countryType: \"nacional\", region: \"Sul\", city: \"Curitiba\", state: \"Paran√°\" },\n  \"Florian√≥polis, SC\": { countryType: \"nacional\", region: \"Sul\", city: \"Florian√≥polis\", state: \"Santa Catarina\" },\n  \"Porto Alegre, RS\": { countryType: \"nacional\", region: \"Sul\", city: \"Porto Alegre\", state: \"Rio Grande do Sul\" },\n  \"Foz do Igua√ßu, PR\": { countryType: \"nacional\", region: \"Sul\", city: \"Foz do Igua√ßu\", state: \"Paran√°\" },\n  \"Gramado, RS\": { countryType: \"nacional\", region: \"Sul\", city: \"Gramado\", state: \"Rio Grande do Sul\" },\n  \"Bombinhas, SC\": { countryType: \"nacional\", region: \"Sul\", city: \"Bombinhas\", state: \"Santa Catarina\" },\n  \"Imbituba, SC\": { countryType: \"nacional\", region: \"Sul\", city: \"Imbituba\", state: \"Santa Catarina\" },\n  \n  // ==================== INTERNACIONAL ====================\n  \n  // AM√âRICA DO NORTE\n  \"Nova York, EUA\": { countryType: \"internacional\", region: \"Am√©rica do Norte\", city: \"Nova York\", country: \"Estados Unidos\" },\n  \"Los Angeles, EUA\": { countryType: \"internacional\", region: \"Am√©rica do Norte\", city: \"Los Angeles\", country: \"Estados Unidos\" },\n  \"Toronto, Canad√°\": { countryType: \"internacional\", region: \"Am√©rica do Norte\", city: \"Toronto\", country: \"Canad√°\" },\n  \"Vancouver, Canad√°\": { countryType: \"internacional\", region: \"Am√©rica do Norte\", city: \"Vancouver\", country: \"Canad√°\" },\n  \n  // AM√âRICA CENTRAL E CARIBE\n  \"Canc√∫n, M√©xico\": { countryType: \"internacional\", region: \"Am√©rica Central\", city: \"Canc√∫n\", country: \"M√©xico\" },\n  \"Cidade do M√©xico, M√©xico\": { countryType: \"internacional\", region: \"Am√©rica Central\", city: \"Cidade do M√©xico\", country: \"M√©xico\" },\n  \"Punta Cana, Rep√∫blica Dominicana\": { countryType: \"internacional\", region: \"Caribe\", city: \"Punta Cana\", country: \"Rep√∫blica Dominicana\" },\n  \"Havana, Cuba\": { countryType: \"internacional\", region: \"Caribe\", city: \"Havana\", country: \"Cuba\" },\n  \"Nassau, Bahamas\": { countryType: \"internacional\", region: \"Caribe\", city: \"Nassau\", country: \"Bahamas\" },\n  \n  // AM√âRICA DO SUL\n  \"Buenos Aires, Argentina\": { countryType: \"internacional\", region: \"Am√©rica do Sul\", city: \"Buenos Aires\", country: \"Argentina\" },\n  \"Santiago, Chile\": { countryType: \"internacional\", region: \"Am√©rica do Sul\", city: \"Santiago\", country: \"Chile\" },\n  \"Lima, Peru\": { countryType: \"internacional\", region: \"Am√©rica do Sul\", city: \"Lima\", country: \"Peru\" },\n  \"Cusco, Peru\": { countryType: \"internacional\", region: \"Am√©rica do Sul\", city: \"Cusco\", country: \"Peru\" },\n  \"Quito, Equador\": { countryType: \"internacional\", region: \"Am√©rica do Sul\", city: \"Quito\", country: \"Equador\" },\n  \"Montevideu, Uruguai\": { countryType: \"internacional\", region: \"Am√©rica do Sul\", city: \"Montevideu\", country: \"Uruguai\" },\n  \n  // EUROPA OCIDENTAL\n  \"Paris, Fran√ßa\": { countryType: \"internacional\", region: \"Europa Ocidental\", city: \"Paris\", country: \"Fran√ßa\" },\n  \"Londres, Reino Unido\": { countryType: \"internacional\", region: \"Europa Ocidental\", city: \"Londres\", country: \"Reino Unido\" },\n  \"Madrid, Espanha\": { countryType: \"internacional\", region: \"Europa Ocidental\", city: \"Madrid\", country: \"Espanha\" },\n  \"Lisboa, Portugal\": { countryType: \"internacional\", region: \"Europa Ocidental\", city: \"Lisboa\", country: \"Portugal\" },\n  \"Amsterdam, Holanda\": { countryType: \"internacional\", region: \"Europa Ocidental\", city: \"Amsterdam\", country: \"Holanda\" },\n  \"Bruxelas, B√©lgica\": { countryType: \"internacional\", region: \"Europa Ocidental\", city: \"Bruxelas\", country: \"B√©lgica\" },\n  \n  // EUROPA MEDITERR√ÇNEA\n  \"Roma, It√°lia\": { countryType: \"internacional\", region: \"Europa Mediterr√¢nea\", city: \"Roma\", country: \"It√°lia\" },\n  \"Barcelona, Espanha\": { countryType: \"internacional\", region: \"Europa Mediterr√¢nea\", city: \"Barcelona\", country: \"Espanha\" },\n  \"Atenas, Gr√©cia\": { countryType: \"internacional\", region: \"Europa Mediterr√¢nea\", city: \"Atenas\", country: \"Gr√©cia\" },\n  \"Santorini, Gr√©cia\": { countryType: \"internacional\", region: \"Europa Mediterr√¢nea\", city: \"Santorini\", country: \"Gr√©cia\" },\n  \n  // EUROPA CENTRAL\n  \"Berlim, Alemanha\": { countryType: \"internacional\", region: \"Europa Central\", city: \"Berlim\", country: \"Alemanha\" },\n  \"Viena, √Åustria\": { countryType: \"internacional\", region: \"Europa Central\", city: \"Viena\", country: \"√Åustria\" },\n  \"Praga, Rep√∫blica Tcheca\": { countryType: \"internacional\", region: \"Europa Central\", city: \"Praga\", country: \"Rep√∫blica Tcheca\" },\n  \"Budapeste, Hungria\": { countryType: \"internacional\", region: \"Europa Central\", city: \"Budapeste\", country: \"Hungria\" },\n  \n  // EUROPA N√ìRDICA\n  \"Estocolmo, Su√©cia\": { countryType: \"internacional\", region: \"Europa N√≥rdica\", city: \"Estocolmo\", country: \"Su√©cia\" },\n  \"Oslo, Noruega\": { countryType: \"internacional\", region: \"Europa N√≥rdica\", city: \"Oslo\", country: \"Noruega\" },\n  \"Copenhague, Dinamarca\": { countryType: \"internacional\", region: \"Europa N√≥rdica\", city: \"Copenhague\", country: \"Dinamarca\" },\n  \"Helsinque, Finl√¢ndia\": { countryType: \"internacional\", region: \"Europa N√≥rdica\", city: \"Helsinque\", country: \"Finl√¢ndia\" },\n  \n  // √ÅSIA ORIENTAL\n  \"T√≥quio, Jap√£o\": { countryType: \"internacional\", region: \"√Åsia Oriental\", city: \"T√≥quio\", country: \"Jap√£o\" },\n  \"Seul, Coreia do Sul\": { countryType: \"internacional\", region: \"√Åsia Oriental\", city: \"Seul\", country: \"Coreia do Sul\" },\n  \"Pequim, China\": { countryType: \"internacional\", region: \"√Åsia Oriental\", city: \"Pequim\", country: \"China\" },\n  \"Xangai, China\": { countryType: \"internacional\", region: \"√Åsia Oriental\", city: \"Xangai\", country: \"China\" },\n  \n  // SUDESTE ASI√ÅTICO\n  \"Bangkok, Tail√¢ndia\": { countryType: \"internacional\", region: \"Sudeste Asi√°tico\", city: \"Bangkok\", country: \"Tail√¢ndia\" },\n  \"Singapura\": { countryType: \"internacional\", region: \"Sudeste Asi√°tico\", city: \"Singapura\", country: \"Singapura\" },\n  \"Jacarta, Indon√©sia\": { countryType: \"internacional\", region: \"Sudeste Asi√°tico\", city: \"Jacarta\", country: \"Indon√©sia\" },\n  \"Manila, Filipinas\": { countryType: \"internacional\", region: \"Sudeste Asi√°tico\", city: \"Manila\", country: \"Filipinas\" },\n  \n  // ORIENTE M√âDIO\n  \"Dubai, Emirados √Årabes Unidos\": { countryType: \"internacional\", region: \"Oriente M√©dio\", city: \"Dubai\", country: \"Emirados √Årabes Unidos\" },\n  \"Abu Dhabi, Emirados √Årabes Unidos\": { countryType: \"internacional\", region: \"Oriente M√©dio\", city: \"Abu Dhabi\", country: \"Emirados √Årabes Unidos\" },\n  \"Doha, Catar\": { countryType: \"internacional\", region: \"Oriente M√©dio\", city: \"Doha\", country: \"Catar\" },\n  \"Tel Aviv, Israel\": { countryType: \"internacional\", region: \"Oriente M√©dio\", city: \"Tel Aviv\", country: \"Israel\" },\n  \n  // √ÅFRICA\n  \"Cairo, Egito\": { countryType: \"internacional\", region: \"√Åfrica\", city: \"Cairo\", country: \"Egito\" },\n  \"Cidade do Cabo, √Åfrica do Sul\": { countryType: \"internacional\", region: \"√Åfrica\", city: \"Cidade do Cabo\", country: \"√Åfrica do Sul\" },\n  \"Marrakech, Marrocos\": { countryType: \"internacional\", region: \"√Åfrica\", city: \"Marrakech\", country: \"Marrocos\" },\n  \"Nair√≥bi, Qu√™nia\": { countryType: \"internacional\", region: \"√Åfrica\", city: \"Nair√≥bi\", country: \"Qu√™nia\" },\n  \n  // OCEANIA\n  \"Sydney, Austr√°lia\": { countryType: \"internacional\", region: \"Oceania\", city: \"Sydney\", country: \"Austr√°lia\" },\n  \"Melbourne, Austr√°lia\": { countryType: \"internacional\", region: \"Oceania\", city: \"Melbourne\", country: \"Austr√°lia\" },\n  \"Auckland, Nova Zel√¢ndia\": { countryType: \"internacional\", region: \"Oceania\", city: \"Auckland\", country: \"Nova Zel√¢ndia\" },\n  \"Wellington, Nova Zel√¢ndia\": { countryType: \"internacional\", region: \"Oceania\", city: \"Wellington\", country: \"Nova Zel√¢ndia\" },\n  \n  // ==================== CRUZEIROS ====================\n  \"Cruzeiro Mediterr√¢neo\": { countryType: \"cruzeiro\", region: \"Mediterr√¢neo\", city: \"M√∫ltiplas Cidades\", route: \"Espanha-Fran√ßa-It√°lia-Gr√©cia\" },\n  \"Cruzeiro Caribe\": { countryType: \"cruzeiro\", region: \"Caribe\", city: \"M√∫ltiplas Ilhas\", route: \"Bahamas-Jamaica-M√©xico\" },\n  \"Cruzeiro Fiordos Noruegueses\": { countryType: \"cruzeiro\", region: \"Norte da Europa\", city: \"Fiordos\", route: \"Noruega-Su√©cia-Dinamarca\" },\n  \"Cruzeiro Costa Brasileira\": { countryType: \"cruzeiro\", region: \"Costa Atl√¢ntica\", city: \"Litoral Brasileiro\", route: \"Santos-Rio-Salvador-Recife\" },\n  \"Cruzeiro Ant√°rtica\": { countryType: \"cruzeiro\", region: \"Ant√°rtica\", city: \"Continente Ant√°rtico\", route: \"Ushuaia-Pen√≠nsula Ant√°rtica\" },\n  \"Cruzeiro Rio Amazonas\": { countryType: \"cruzeiro\", region: \"Amaz√¥nia\", city: \"Rio Amazonas\", route: \"Manaus-Santar√©m-Bel√©m\" },\n};\n\n// Helper function to intelligently parse location and create mapping\nfunction parseLocation(location: string): { countryType: string; region: string; city: string } {\n  const loc = location.trim();\n  \n  // Check Brazilian state abbreviations\n  const brazilianStates = ['AC', 'AL', 'AP', 'AM', 'BA', 'CE', 'DF', 'ES', 'GO', 'MA', 'MT', 'MS', 'MG', 'PA', 'PB', 'PR', 'PE', 'PI', 'RJ', 'RN', 'RS', 'RO', 'RR', 'SC', 'SP', 'SE', 'TO'];\n  const stateRegionMap = {\n    'AC': 'Norte', 'RO': 'Norte', 'AM': 'Norte', 'RR': 'Norte', 'PA': 'Norte', 'AP': 'Norte', 'TO': 'Norte',\n    'MA': 'Nordeste', 'PI': 'Nordeste', 'CE': 'Nordeste', 'RN': 'Nordeste', 'PB': 'Nordeste', 'PE': 'Nordeste', 'AL': 'Nordeste', 'SE': 'Nordeste', 'BA': 'Nordeste',\n    'MT': 'Centro-Oeste', 'MS': 'Centro-Oeste', 'GO': 'Centro-Oeste', 'DF': 'Centro-Oeste',\n    'MG': 'Sudeste', 'ES': 'Sudeste', 'RJ': 'Sudeste', 'SP': 'Sudeste',\n    'PR': 'Sul', 'SC': 'Sul', 'RS': 'Sul'\n  };\n  \n  // Check if location has Brazilian state abbreviation\n  for (const state of brazilianStates) {\n    if (loc.includes(`, ${state}`) || loc.endsWith(state)) {\n      const cityName = loc.split(',')[0].trim();\n      return {\n        countryType: \"nacional\",\n        region: stateRegionMap[state as keyof typeof stateRegionMap] || \"Outras Regi√µes\",\n        city: cityName\n      };\n    }\n  }\n  \n  // Check if it's a cruise\n  if (loc.toLowerCase().includes(\"cruzeiro\")) {\n    return {\n      countryType: \"cruzeiro\",\n      region: \"Outros Roteiros\",\n      city: \"M√∫ltiplas Cidades\"\n    };\n  }\n  \n  // Check if it mentions Brasil explicitly\n  if (loc.includes(\"Brasil\") || loc.includes(\"Brazil\")) {\n    return {\n      countryType: \"nacional\",\n      region: \"Outras Regi√µes\",\n      city: loc.split(',')[0].trim()\n    };\n  }\n  \n  // Otherwise assume international\n  const cityName = loc.split(',')[0].trim();\n  return {\n    countryType: \"internacional\",\n    region: \"Outros Pa√≠ses\",\n    city: cityName\n  };\n}\n\nasync function addHierarchicalFields() {\n  try {\n    console.log(\"üîÑ Iniciando classifica√ß√£o hier√°rquica avan√ßada das atividades...\");\n    \n    // First, ensure the hierarchical columns exist (MySQL compatibility)\n    await ensureHierarchicalColumns();\n    \n    // Get all activities\n    const allActivities = await db.select().from(activities);\n    console.log(`üìã Encontradas ${allActivities.length} atividades para classificar`);\n    \n    let updatedCount = 0;\n    let createdCount = 0;\n    \n    for (const activity of allActivities) {\n      const mapping = locationMapping[activity.location as keyof typeof locationMapping];\n      \n      if (mapping) {\n        // Use predefined mapping\n        await db.update(activities)\n          .set({\n            countryType: mapping.countryType,\n            region: mapping.region,\n            city: mapping.city\n          })\n          .where(eq(activities.id, activity.id));\n        \n        console.log(`‚úÖ Classificada \"${activity.title}\" - ${mapping.countryType}/${mapping.region}/${mapping.city}`);\n        updatedCount++;\n      } else {\n        // Use intelligent parsing for unmapped locations\n        const parsedMapping = parseLocation(activity.location);\n        \n        await db.update(activities)\n          .set({\n            countryType: parsedMapping.countryType,\n            region: parsedMapping.region,\n            city: parsedMapping.city\n          })\n          .where(eq(activities.id, activity.id));\n        \n        console.log(`üîç Auto-classificada \"${activity.title}\" - ${parsedMapping.countryType}/${parsedMapping.region}/${parsedMapping.city} (analisada)`);\n        createdCount++;\n      }\n    }\n    \n    // Generate hierarchy statistics\n    await generateHierarchyStatistics();\n    \n    console.log(\"‚úÖ Classifica√ß√£o hier√°rquica conclu√≠da!\");\n    console.log(`üìä Estat√≠sticas: ${updatedCount} mapeadas, ${createdCount} auto-classificadas`);\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro ao processar classifica√ß√£o hier√°rquica:\", error);\n    throw error;\n  }\n}\n\n// Ensure hierarchical columns exist in the database\nasync function ensureHierarchicalColumns() {\n  try {\n    console.log(\"üîß Verificando colunas hier√°rquicas...\");\n    \n    // Try to add columns if they don't exist (MySQL safe approach)\n    const alterQueries = [\n      `ALTER TABLE activities ADD COLUMN country_type VARCHAR(50) DEFAULT 'nacional' NOT NULL`,\n      `ALTER TABLE activities ADD COLUMN region VARCHAR(100) DEFAULT '' NOT NULL`,\n      `ALTER TABLE activities ADD COLUMN city VARCHAR(100) DEFAULT '' NOT NULL`\n    ];\n    \n    for (const query of alterQueries) {\n      try {\n        await db.execute(sql.raw(query));\n        console.log(`‚úÖ Coluna adicionada: ${query.split(' ADD COLUMN ')[1].split(' ')[0]}`);\n      } catch (error: any) {\n        if (error.code === 'ER_DUP_FIELDNAME') {\n          // Column already exists, that's fine\n          continue;\n        } else {\n          console.log(`‚ÑπÔ∏è Coluna j√° existe: ${query.split(' ADD COLUMN ')[1].split(' ')[0]}`);\n        }\n      }\n    }\n    \n  } catch (error) {\n    console.log(\"‚ÑπÔ∏è Colunas hier√°rquicas j√° existem ou foram adicionadas\");\n  }\n}\n\n// Generate and display hierarchy statistics\nasync function generateHierarchyStatistics() {\n  try {\n    console.log(\"üìä Gerando estat√≠sticas hier√°rquicas...\");\n    \n    const stats = await db.select({\n      countryType: activities.countryType,\n      region: activities.region,\n      count: sql<number>`count(*)`.as('count')\n    })\n    .from(activities)\n    .where(eq(activities.isActive, true))\n    .groupBy(activities.countryType, activities.region)\n    .orderBy(activities.countryType, activities.region);\n    \n    console.log(\"\\nüåç HIERARQUIA DE DESTINOS:\");\n    console.log(\"=\" .repeat(50));\n    \n    let currentCountryType = '';\n    let totalActivities = 0;\n    \n    stats.forEach(stat => {\n      if (stat.countryType !== currentCountryType) {\n        currentCountryType = stat.countryType;\n        console.log(`\\nüìç ${stat.countryType.toUpperCase()}`);\n      }\n      console.log(`   ‚îî‚îÄ‚îÄ ${stat.region}: ${stat.count} atividades`);\n      totalActivities += stat.count;\n    });\n    \n    console.log(\"=\" .repeat(50));\n    console.log(`üìä TOTAL: ${totalActivities} atividades classificadas hierarquicamente`);\n    console.log(\"=\" .repeat(50));\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro ao gerar estat√≠sticas:\", error);\n  }\n}\n\n// Additional function to validate and fix location inconsistencies\nasync function validateLocationConsistency() {\n  try {\n    console.log(\"üîç Validando consist√™ncia de localidades...\");\n    \n    // Find activities with empty or null hierarchical fields\n    const inconsistentActivities = await db.select()\n      .from(activities)\n      .where(sql`country_type IS NULL OR country_type = '' OR region IS NULL OR region = '' OR city IS NULL OR city = ''`);\n    \n    if (inconsistentActivities.length > 0) {\n      console.log(`‚ö†Ô∏è Encontradas ${inconsistentActivities.length} atividades com campos hier√°rquicos incompletos`);\n      \n      for (const activity of inconsistentActivities) {\n        const parsedMapping = parseLocation(activity.location);\n        \n        await db.update(activities)\n          .set({\n            countryType: parsedMapping.countryType,\n            region: parsedMapping.region,\n            city: parsedMapping.city\n          })\n          .where(eq(activities.id, activity.id));\n        \n        console.log(`üîß Corrigida \"${activity.title}\" - ${parsedMapping.countryType}/${parsedMapping.region}/${parsedMapping.city}`);\n      }\n    } else {\n      console.log(\"‚úÖ Todas as atividades possuem classifica√ß√£o hier√°rquica consistente\");\n    }\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro na valida√ß√£o de consist√™ncia:\", error);\n  }\n}\n\n// Main execution function\nasync function runHierarchicalUpdate() {\n  try {\n    console.log(\"üöÄ Iniciando atualiza√ß√£o hier√°rquica completa...\");\n    console.log(`‚è∞ ${new Date().toLocaleString('pt-BR')}`);\n    \n    await addHierarchicalFields();\n    await validateLocationConsistency();\n    \n    console.log(\"\\n‚úÖ Atualiza√ß√£o hier√°rquica conclu√≠da com sucesso!\");\n    console.log(\"üéØ Sistema de classifica√ß√£o de destinos totalmente operacional\");\n    \n  } catch (error) {\n    console.error(\"üí• Erro durante a atualiza√ß√£o hier√°rquica:\", error);\n    process.exit(1);\n  }\n}\n\nif (import.meta.url === `file://${process.argv[1]}`) {\n  runHierarchicalUpdate().then(() => process.exit(0));\n}\n\nexport { addHierarchicalFields, validateLocationConsistency, runHierarchicalUpdate };","size_bytes":21277},"server/add-london-activities.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { sql } from 'drizzle-orm';\n\n// Script to add London activities with authentic details and budget proposals\nasync function addLondonActivities() {\n  console.log(\"üè∞ Adicionando atividades de Londres com detalhes aut√™nticos...\");\n  \n  const londonActivities = [\n    {\n      title: \"London Eye - Roda Gigante Ic√¥nica\",\n      description: \"Desfrute de vistas panor√¢micas espetaculares de Londres a 135 metros de altura! O London Eye √© a roda gigante de observa√ß√£o mais alta da Europa, oferecendo vistas de 360¬∞ da capital brit√¢nica. Veja marcos ic√¥nicos como Big Ben, Houses of Parliament, St. Paul's Cathedral e o Rio T√¢misa. Uma experi√™ncia √∫nica de 30 minutos que revela Londres de uma perspectiva totalmente nova.\",\n      location: \"Londres, Reino Unido\",\n      category: \"sightseeing\",\n      city: \"Londres\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"30-45 minutos\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 25,\n      languages: JSON.stringify([\"Ingl√™s\", \"Espanhol\", \"Franc√™s\", \"Alem√£o\", \"Italiano\", \"Portugu√™s\", \"Japon√™s\", \"Chin√™s\"]),\n      inclusions: JSON.stringify([\"Entrada no London Eye\", \"Volta completa de 30 min\", \"Vistas panor√¢micas\", \"Audioguia digital\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Fotografias\", \"Souvenirs\", \"Champagne\"]),\n      requirements: JSON.stringify([\"Chegada 15 min antes\", \"Crian√ßas menores 16 anos com adulto\", \"N√£o recomendado para claustrofobia\"]),\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes da visita\",\n      contactInfo: JSON.stringify({\n        phone: \"+44 871 781 3000\",\n        email: \"info@londoneye.com\",\n        website: \"https://www.londoneye.com\",\n        address: \"Riverside Building, County Hall, London SE1 7PB\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1513635269975-59663e0ac1ad?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1513635269975-59663e0ac1ad?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1529655683826-aba9b3e77383?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1544133503-59b8e7e58e32?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Torre de Londres - Fortaleza Hist√≥rica\",\n      description: \"Explore quase 1.000 anos de hist√≥ria real na Torre de Londres! Esta fortaleza hist√≥rica abriga as mundialmente famosas Joias da Coroa, incluindo a coroa de St. Edward e o diamante Cullinan I. Descubra as hist√≥rias dos prisioneiros famosos, visite a White Tower normanda e conhe√ßa os lend√°rios Yeoman Warders (Beefeaters). Uma jornada fascinante pela hist√≥ria sombria e gloriosa da realeza brit√¢nica.\",\n      location: \"Londres, Reino Unido\",\n      category: \"culture\",\n      city: \"Londres\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"2-3 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 50,\n      languages: JSON.stringify([\"Ingl√™s\", \"Franc√™s\", \"Alem√£o\", \"Espanhol\", \"Italiano\"]),\n      inclusions: JSON.stringify([\"Entrada na Torre\", \"Acesso √†s Joias da Coroa\", \"White Tower\", \"Yeoman Warder tours\", \"Audioguia\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Fotografias nas Joias\", \"Souvenirs\"]),\n      requirements: JSON.stringify([\"Documento de identidade\", \"Inspe√ß√£o de seguran√ßa\", \"N√£o permitido bagagem grande\"]),\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes da visita\",\n      contactInfo: JSON.stringify({\n        phone: \"+44 20 3166 6000\",\n        email: \"toweroflondon@hrp.org.uk\",\n        website: \"https://www.hrp.org.uk/tower-of-london\",\n        address: \"St Katharine's & Wapping, London EC3N 4AB\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1539037116277-4db20889f2d4?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1539037116277-4db20889f2d4?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1548013146-72479768bada?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1529655683826-aba9b3e77383?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Museu Brit√¢nico - Tesouros Mundiais\",\n      description: \"Descubra a maior cole√ß√£o de artefatos hist√≥ricos do mundo! O Museu Brit√¢nico abriga tesouros √∫nicos como a Pedra de Roseta, m√∫mias eg√≠pcias, esculturas do Parthenon e manuscritos hist√≥ricos. Com mais de 8 milh√µes de objetos cobrindo 2 milh√µes de anos de hist√≥ria humana, este museu gratuito oferece uma jornada pela civiliza√ß√£o mundial. Imperd√≠vel para amantes de hist√≥ria e cultura.\",\n      location: \"Londres, Reino Unido\",\n      category: \"culture\",\n      city: \"Londres\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"3-4 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 30,\n      languages: JSON.stringify([\"Ingl√™s\", \"Franc√™s\", \"Alem√£o\", \"Espanhol\", \"Italiano\", \"Japon√™s\", \"Chin√™s\", \"Portugu√™s\"]),\n      inclusions: JSON.stringify([\"Entrada gratuita\", \"Acesso √†s galerias permanentes\", \"Mapa do museu\", \"WiFi gratuito\"]),\n      exclusions: JSON.stringify([\"Exposi√ß√µes especiais\", \"Audioguia\", \"Transporte\", \"Alimenta√ß√£o\"]),\n      requirements: JSON.stringify([\"Bagagem limitada\", \"N√£o permitido flash\", \"Sil√™ncio nas galerias\"]),\n      cancellationPolicy: \"Entrada gratuita - sem necessidade de reserva\",\n      contactInfo: JSON.stringify({\n        phone: \"+44 20 7323 8299\",\n        email: \"information@britishmuseum.org\",\n        website: \"https://www.britishmuseum.org\",\n        address: \"Great Russell St, Bloomsbury, London WC1B 3DG\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1575062789842-43438b4e9eb4?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1575062789842-43438b4e9eb4?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1544827753-4acf7de08544?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"West End - Teatro de Classe Mundial\",\n      description: \"Viva a magia do teatro no famoso West End de Londres! Casa dos melhores musicais e pe√ßas do mundo, o West End oferece espet√°culos ic√¥nicos como O Fantasma da √ìpera, O Rei Le√£o, Mamma Mia! e Hamilton. Com mais de 40 teatros profissionais, esta √© a experi√™ncia teatral mais prestigiosa da Europa. Uma noite inesquec√≠vel na tradi√ß√£o teatral brit√¢nica.\",\n      location: \"Londres, Reino Unido\",\n      category: \"entertainment\",\n      city: \"Londres\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"2,5-3 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 40,\n      languages: JSON.stringify([\"Ingl√™s\"]),\n      inclusions: JSON.stringify([\"Ingresso para show\", \"Assento numerado\", \"Programa oficial\", \"Intervalo\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Bebidas\", \"Estacionamento\", \"Encontro com elenco\"]),\n      requirements: JSON.stringify([\"Chegada 30 min antes\", \"Vestu√°rio adequado\", \"Celular silencioso\", \"Idade m√≠nima varia\"]),\n      cancellationPolicy: \"Pol√≠tica varia por teatro. Geralmente n√£o reembols√°vel\",\n      contactInfo: JSON.stringify({\n        phone: \"+44 20 7492 1548\",\n        email: \"info@westendtheatre.com\",\n        website: \"https://www.westendtheatre.com\",\n        address: \"West End Theatre District, London\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1518709268805-4e9042af2ea0?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1560448204-61dc36dc98c8?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Pal√°cio de Buckingham - Resid√™ncia Real\",\n      description: \"Visite a resid√™ncia oficial da fam√≠lia real brit√¢nica! O Pal√°cio de Buckingham √© o cora√ß√£o administrativo da monarquia e oferece experi√™ncias √∫nicas como a cerim√¥nia da Troca da Guarda. Durante o ver√£o, visite os State Rooms magnificamente decorados, admire obras de arte da Royal Collection e explore os jardins reais. Uma oportunidade rara de experimentar a grandeza da realeza brit√¢nica.\",\n      location: \"Londres, Reino Unido\",\n      category: \"culture\",\n      city: \"Londres\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"1-2 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 100,\n      languages: JSON.stringify([\"Ingl√™s\", \"Franc√™s\", \"Alem√£o\", \"Espanhol\", \"Italiano\", \"Japon√™s\", \"Chin√™s\"]),\n      inclusions: JSON.stringify([\"Acesso conforme tipo\", \"Vistas do pal√°cio\", \"Cerim√¥nia da Troca da Guarda\", \"Audioguia\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Fotografia interior\", \"Souvenirs\"]),\n      requirements: JSON.stringify([\"Documento de identidade\", \"Inspe√ß√£o de seguran√ßa\", \"Vestu√°rio adequado\"]),\n      cancellationPolicy: \"Evento externo gratuito. Tours internos cancel√°veis at√© 24h antes\",\n      contactInfo: JSON.stringify({\n        phone: \"+44 20 7766 7300\",\n        email: \"info@royalcollection.org.uk\",\n        website: \"https://www.rct.uk/visit/buckingham-palace\",\n        address: \"Buckingham Palace, London SW1A 1AA\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1529655683826-aba9b3e77383?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1529655683826-aba9b3e77383?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1548013146-72479768bada?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1519135467309-4491ed7eaa40?w=800&q=80\"\n      ]),\n      createdById: 1\n    }\n  ];\n\n  // Budget proposals for each activity\n  const budgetProposals = [\n    // London Eye proposals\n    {\n      activityTitle: \"London Eye - Roda Gigante Ic√¥nica\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada Padr√£o\",\n          description: \"Entrada padr√£o para o London Eye com volta completa de 30 minutos.\",\n          amount: \"30.00\",\n          inclusions: [\"Entrada padr√£o\", \"Volta de 30 min\", \"Vistas panor√¢micas\", \"Audioguia digital\"],\n          exclusions: [\"Evite filas\", \"Champagne\", \"Cabine privada\", \"Fotografias\"]\n        },\n        {\n          title: \"Completo - Skip Line\",\n          description: \"Entrada com acesso priorit√°rio, evitando filas e garantindo hor√°rio espec√≠fico.\",\n          amount: \"50.00\",\n          inclusions: [\"Acesso priorit√°rio\", \"Evite filas\", \"Volta de 30 min\", \"Audioguia premium\"],\n          exclusions: [\"Cabine privada\", \"Champagne\", \"Fotografias profissionais\"]\n        },\n        {\n          title: \"Premium - Cabine Privada + Champagne\",\n          description: \"Experi√™ncia VIP com cabine privada para at√© 25 pessoas e champagne.\",\n          amount: \"150.00\",\n          inclusions: [\"Cabine privada\", \"Champagne\", \"Anfitri√£o dedicado\", \"Evite filas\", \"Certificado\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o adicional\", \"Fotografias profissionais\"]\n        }\n      ]\n    },\n    // Tower of London proposals\n    {\n      activityTitle: \"Torre de Londres - Fortaleza Hist√≥rica\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada Simples\",\n          description: \"Entrada b√°sica com acesso a todas as √°reas p√∫blicas e Joias da Coroa.\",\n          amount: \"25.00\",\n          inclusions: [\"Entrada na Torre\", \"Joias da Coroa\", \"White Tower\", \"Yeoman Warder tours\"],\n          exclusions: [\"Audioguia\", \"Tour privado\", \"Acesso VIP\", \"Alimenta√ß√£o\"]\n        },\n        {\n          title: \"Completo - Tour Guiado\",\n          description: \"Tour guiado especializado com contexto hist√≥rico detalhado.\",\n          amount: \"50.00\",\n          inclusions: [\"Entrada completa\", \"Tour guiado 2h\", \"Audioguia\", \"Acesso priorit√°rio\"],\n          exclusions: [\"Tour privado\", \"Alimenta√ß√£o\", \"Transporte\", \"Souvenirs\"]\n        },\n        {\n          title: \"Premium - Tour Privado + Joias da Coroa\",\n          description: \"Tour privado com acesso especial e foco nas Joias da Coroa.\",\n          amount: \"120.00\",\n          inclusions: [\"Tour privado\", \"Guia especializado\", \"Acesso especial\", \"Grupo pequeno\", \"Evite filas\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Fotografias nas Joias\", \"Souvenirs\"]\n        }\n      ]\n    },\n    // British Museum proposals\n    {\n      activityTitle: \"Museu Brit√¢nico - Tesouros Mundiais\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada Gratuita\",\n          description: \"Entrada gratuita com acesso a todas as galerias permanentes.\",\n          amount: \"0.00\",\n          inclusions: [\"Entrada gratuita\", \"Galerias permanentes\", \"Mapa do museu\", \"WiFi gratuito\"],\n          exclusions: [\"Audioguia\", \"Tour guiado\", \"Exposi√ß√µes especiais\", \"Transporte\"]\n        },\n        {\n          title: \"Completo - Tour Guiado\",\n          description: \"Tour guiado focando nos tesouros mais importantes do museu.\",\n          amount: \"20.00\",\n          inclusions: [\"Tour guiado 1,5h\", \"Entrada gratuita\", \"Obras-primas\", \"Guia especializado\"],\n          exclusions: [\"Exposi√ß√µes especiais\", \"Audioguia pessoal\", \"Transporte\", \"Alimenta√ß√£o\"]\n        },\n        {\n          title: \"Premium - Tour Privado\",\n          description: \"Tour privado personalizado com curador especializado.\",\n          amount: \"80.00\",\n          inclusions: [\"Tour privado\", \"Curador especializado\", \"Acesso especial\", \"Grupo pequeno\", \"Obras exclusivas\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Exposi√ß√µes especiais\", \"Souvenirs\"]\n        }\n      ]\n    },\n    // West End proposals\n    {\n      activityTitle: \"West End - Teatro de Classe Mundial\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Assentos de Fundo\",\n          description: \"Assentos econ√¥micos com vista completa do palco a pre√ßo acess√≠vel.\",\n          amount: \"25.00\",\n          inclusions: [\"Ingresso do show\", \"Assento numerado\", \"Programa oficial\", \"Vista do palco\"],\n          exclusions: [\"Assentos premium\", \"Intervalo com bebida\", \"Encontro com elenco\", \"Backstage\"]\n        },\n        {\n          title: \"Completo - Assentos Centrais\",\n          description: \"Assentos centrais com excelente visibilidade e ac√∫stica.\",\n          amount: \"80.00\",\n          inclusions: [\"Assentos centrais\", \"Vista premium\", \"Programa oficial\", \"Intervalo\"],\n          exclusions: [\"Backstage\", \"Encontro com elenco\", \"Alimenta√ß√£o\", \"Bebidas\"]\n        },\n        {\n          title: \"Premium - VIP + Backstage\",\n          description: \"Experi√™ncia VIP completa com acesso backstage e encontro com elenco.\",\n          amount: \"200.00\",\n          inclusions: [\"Melhores assentos\", \"Acesso backstage\", \"Encontro com elenco\", \"Programa autografado\", \"Intervalo VIP\"],\n          exclusions: [\"Transporte\", \"Jantar\", \"Fotografias profissionais\", \"Souvenirs extras\"]\n        }\n      ]\n    },\n    // Buckingham Palace proposals\n    {\n      activityTitle: \"Pal√°cio de Buckingham - Resid√™ncia Real\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Evento Externo\",\n          description: \"Assista √† cerim√¥nia da Troca da Guarda gratuitamente do lado externo.\",\n          amount: \"0.00\",\n          inclusions: [\"Troca da Guarda\", \"Vista externa\", \"Evento gratuito\", \"Atmosfera real\"],\n          exclusions: [\"Acesso interno\", \"Guia tur√≠stico\", \"State Rooms\", \"Jardins\"]\n        },\n        {\n          title: \"Completo - Tour Externo\",\n          description: \"Tour guiado externo com contexto hist√≥rico e melhores pontos de vista.\",\n          amount: \"25.00\",\n          inclusions: [\"Tour externo\", \"Guia especializado\", \"Troca da Guarda\", \"Hist√≥ria real\", \"Melhores vistas\"],\n          exclusions: [\"Acesso interno\", \"State Rooms\", \"Jardins\", \"Alimenta√ß√£o\"]\n        },\n        {\n          title: \"Premium - Tour Interno + State Rooms\",\n          description: \"Tour interno exclusivo dos State Rooms com arte da Royal Collection.\",\n          amount: \"100.00\",\n          inclusions: [\"State Rooms\", \"Royal Collection\", \"Jardins\", \"Audioguia\", \"Acesso VIP\"],\n          exclusions: [\"Quartos privados\", \"Transporte\", \"Alimenta√ß√£o\", \"Fotografias internas\"]\n        }\n      ]\n    }\n  ];\n\n  try {\n    // Insert activities first\n    for (const activity of londonActivities) {\n      try {\n        const [insertedActivity] = await db.insert(activities).values({\n          ...activity,\n          isActive: true\n        });\n        console.log(`‚úÖ Atividade criada: ${activity.title}`);\n      } catch (insertError: any) {\n        if (insertError.code === 'ER_DUP_ENTRY') {\n          console.log(`‚ÑπÔ∏è Atividade j√° existe: ${activity.title}`);\n        } else {\n          console.error(`‚ùå Erro ao criar ${activity.title}:`, insertError.message);\n        }\n      }\n    }\n\n    // Then insert budget proposals\n    for (const budgetGroup of budgetProposals) {\n      // Find the activity ID\n      const [activityResult] = await db.select()\n        .from(activities)\n        .where(sql`title = ${budgetGroup.activityTitle}`)\n        .limit(1);\n\n      if (activityResult) {\n        for (const proposal of budgetGroup.proposals) {\n          try {\n            await db.insert(activityBudgetProposals).values({\n              activityId: activityResult.id,\n              createdBy: 1,\n              title: proposal.title,\n              description: proposal.description,\n              amount: proposal.amount,\n              currency: \"GBP\",\n              inclusions: JSON.stringify(proposal.inclusions),\n              exclusions: JSON.stringify(proposal.exclusions),\n              isActive: true\n            });\n            console.log(`  üí∞ Proposta criada: ${proposal.title}`);\n          } catch (proposalError: any) {\n            if (proposalError.code === 'ER_DUP_ENTRY') {\n              console.log(`  ‚ÑπÔ∏è Proposta j√° existe: ${proposal.title}`);\n            } else {\n              console.error(`  ‚ùå Erro ao criar proposta:`, proposalError.message);\n            }\n          }\n        }\n      }\n    }\n\n    console.log(\"üéâ Atividades de Londres criadas com sucesso!\");\n\n  } catch (error) {\n    console.error(\"‚ùå Erro geral:\", error);\n  }\n}\n\n// Execute the function\naddLondonActivities().catch(console.error);","size_bytes":18900},"server/add-missing-proposals.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { eq, sql } from 'drizzle-orm';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nasync function addMissingProposals() {\n  try {\n    console.log('üîç Verificando atividades sem propostas...');\n    \n    // Buscar atividades que n√£o t√™m propostas\n    const activitiesWithoutProposals = await db.select({ \n      id: activities.id, \n      title: activities.title,\n      location: activities.location \n    })\n    .from(activities)\n    .leftJoin(activityBudgetProposals, eq(activities.id, activityBudgetProposals.activityId))\n    .where(sql`${activityBudgetProposals.id} IS NULL`)\n    .groupBy(activities.id);\n\n    console.log(`üìä Encontradas ${activitiesWithoutProposals.length} atividades sem propostas`);\n\n    let addedCount = 0;\n\n    for (const activity of activitiesWithoutProposals) {\n      console.log(`üîß Adicionando propostas para: ${activity.title} (ID: ${activity.id})`);\n      \n      const proposalsToAdd = [\n        {\n          title: \"Econ√¥mico\",\n          description: \"Op√ß√£o b√°sica com essenciais inclu√≠dos\",\n          amount: \"30.00\",\n          inclusions: [\"Entrada b√°sica\", \"Informa√ß√µes gerais\"],\n          exclusions: [\"Guia especializado\", \"Transporte\", \"Alimenta√ß√£o\"]\n        },\n        {\n          title: \"Completo\", \n          description: \"Experi√™ncia completa com servi√ßos extras\",\n          amount: \"80.00\",\n          inclusions: [\"Entrada premium\", \"Guia especializado\", \"Material informativo\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Souvenirs\"]\n        },\n        {\n          title: \"Premium\",\n          description: \"Experi√™ncia VIP com todos os luxos inclu√≠dos\",\n          amount: \"150.00\",\n          inclusions: [\"Acesso VIP\", \"Guia privado\", \"Transporte premium\", \"Cortesias\"],\n          exclusions: [\"Alimenta√ß√£o externa\", \"Compras pessoais\"]\n        }\n      ];\n\n      for (const proposal of proposalsToAdd) {\n        await db.insert(activityBudgetProposals).values({\n          activityId: activity.id,\n          createdBy: 1,\n          title: proposal.title,\n          description: proposal.description,\n          amount: proposal.amount,\n          inclusions: JSON.stringify(proposal.inclusions),\n          exclusions: JSON.stringify(proposal.exclusions),\n          isActive: true,\n          votes: Math.floor(Math.random() * 50) + 1\n        });\n        addedCount++;\n      }\n    }\n\n    console.log(`‚úÖ Adicionadas ${addedCount} propostas para ${activitiesWithoutProposals.length} atividades`);\n\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  }\n}\n\naddMissingProposals().then(() => process.exit(0)).catch(err => {\n  console.error(err);\n  process.exit(1);\n});","size_bytes":2752},"server/add-nyc-activities.ts":{"content":"import { db } from \"./db\";\nimport { activities, activityBudgetProposals } from \"@shared/schema\";\nimport { sql } from \"drizzle-orm\";\n\n// Script to add New York City activities with authentic details and budget proposals\nasync function addNYCActivities() {\n  console.log(\"üóΩ Adicionando atividades de Nova York com detalhes aut√™nticos...\");\n  \n  const nycActivities = [\n    {\n      title: \"Est√°tua da Liberdade e Ellis Island\",\n      description: \"Visite dois dos s√≠mbolos mais ic√¥nicos da Am√©rica! A Est√°tua da Liberdade, presente da Fran√ßa aos EUA, representa liberdade e democracia. Ellis Island Museum conta a hist√≥ria da imigra√ß√£o americana atrav√©s de exposi√ß√µes interativas e artefatos hist√≥ricos. Uma jornada emocionante pela hist√≥ria americana e pelos ideais de liberdade.\",\n      location: \"Nova York, EUA\",\n      category: \"culture\",\n      city: \"Nova York\",\n      countryType: \"internacional\",\n      region: \"Am√©rica do Norte\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"4-5 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 100,\n      languages: JSON.stringify([\"Ingl√™s\", \"Espanhol\", \"Franc√™s\", \"Alem√£o\", \"Italiano\", \"Portugu√™s\"]),\n      inclusions: JSON.stringify([\"Ferry para Liberty Island\", \"Ferry para Ellis Island\", \"Entrada nos museus\", \"Audioguia\"]),\n      exclusions: JSON.stringify([\"Transporte at√© Battery Park\", \"Alimenta√ß√£o\", \"Acesso √† coroa\", \"Souvenirs\"]),\n      requirements: JSON.stringify([\"Documento de identidade v√°lido\", \"Chegada 30 min antes\", \"Inspe√ß√£o de seguran√ßa obrigat√≥ria\"]),\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes da visita\",\n      contactInfo: JSON.stringify({\n        phone: \"+1 201-604-2800\",\n        email: \"info@statueofliberty.org\",\n        website: \"https://www.nps.gov/stli\",\n        address: \"Liberty Island, New York, NY 10004\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1485738422979-f5c462d49f74?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1485738422979-f5c462d49f74?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1520637836862-4d197d17c27a?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1539037116277-4db20889f2d4?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Empire State Building - √çcone de NY\",\n      description: \"Suba at√© um dos arranha-c√©us mais famosos do mundo! O Empire State Building oferece vistas panor√¢micas espetaculares de Manhattan dos observat√≥rios dos 86¬∫ e 102¬∫ andares. Este marco Art D√©co de 1931 j√° foi cen√°rio de filmes cl√°ssicos como King Kong e Sintonia do Amor. Uma experi√™ncia imperd√≠vel no cora√ß√£o de Nova York.\",\n      location: \"Nova York, EUA\",\n      category: \"sightseeing\",\n      city: \"Nova York\",\n      countryType: \"internacional\",\n      region: \"Am√©rica do Norte\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"2-3 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 200,\n      languages: JSON.stringify([\"Ingl√™s\", \"Espanhol\", \"Franc√™s\", \"Alem√£o\", \"Italiano\", \"Portugu√™s\", \"Japon√™s\", \"Chin√™s\"]),\n      inclusions: JSON.stringify([\"Acesso ao observat√≥rio\", \"Elevadores de alta velocidade\", \"Vistas 360¬∞\", \"Exposi√ß√£o hist√≥rica\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Fotografias profissionais\", \"Souvenirs\"]),\n      requirements: JSON.stringify([\"Inspe√ß√£o de seguran√ßa\", \"N√£o permitido bagagem grande\", \"Chegada no hor√°rio agendado\"]),\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes. Reembolso parcial no mesmo dia\",\n      contactInfo: JSON.stringify({\n        phone: \"+1 212-736-3100\",\n        email: \"info@esbnyc.com\",\n        website: \"https://www.esbnyc.com\",\n        address: \"20 W 34th St, New York, NY 10001\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1549417229-aa67d3263c9d?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1549417229-aa67d3263c9d?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1576485290814-1c72aa4bbb8e?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1592356308926-7e5e3a005de0?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Broadway Show - Teatro de Classe Mundial\",\n      description: \"Viva a magia da Broadway! Assista aos melhores musicais e pe√ßas teatrais do mundo no cora√ß√£o do Theater District. De cl√°ssicos como O Fantasma da √ìpera e O Rei Le√£o a sucessos modernos, a Broadway oferece entretenimento de primeira classe. Uma experi√™ncia cultural √∫nica que define o teatro americano.\",\n      location: \"Nova York, EUA\",\n      category: \"entertainment\",\n      city: \"Nova York\",\n      countryType: \"internacional\",\n      region: \"Am√©rica do Norte\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"2,5-3 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 50,\n      languages: JSON.stringify([\"Ingl√™s\"]),\n      inclusions: JSON.stringify([\"Ingresso para show\", \"Assento numerado\", \"Programa oficial\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Bebidas\", \"Estacionamento\", \"Encontro com elenco\"]),\n      requirements: JSON.stringify([\"Chegada 30 min antes\", \"Vestu√°rio adequado\", \"Celular no silencioso\", \"Idade m√≠nima varia por show\"]),\n      cancellationPolicy: \"Pol√≠tica varia por teatro. Geralmente n√£o reembols√°vel\",\n      contactInfo: JSON.stringify({\n        phone: \"+1 212-239-6200\",\n        email: \"info@broadway.com\",\n        website: \"https://www.broadway.com\",\n        address: \"Times Square Theater District, New York, NY\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1518709268805-4e9042af2ea0?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1560448204-61dc36dc98c8?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Central Park - O√°sis Verde de Manhattan\",\n      description: \"Explore o pulm√£o verde de Nova York! Central Park oferece 341 hectares de paisagens deslumbrantes, lagos serenos, pontes hist√≥ricas e trilhas para caminhada. Visite locais ic√¥nicos como Bethesda Fountain, Strawberry Fields (memorial John Lennon) e Belvedere Castle. Perfeito para relaxar, fazer piquenique ou andar de bicicleta.\",\n      location: \"Nova York, EUA\",\n      category: \"nature\",\n      city: \"Nova York\",\n      countryType: \"internacional\",\n      region: \"Am√©rica do Norte\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"2-4 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 30,\n      languages: JSON.stringify([\"Ingl√™s\", \"Espanhol\", \"Franc√™s\", \"Alem√£o\", \"Italiano\"]),\n      inclusions: JSON.stringify([\"Entrada gratuita no parque\", \"Acesso a trilhas\", \"Vistas panor√¢micas\", \"Locais hist√≥ricos\"]),\n      exclusions: JSON.stringify([\"Aluguel de bicicleta\", \"Alimenta√ß√£o\", \"Guia tur√≠stico\", \"Transporte\"]),\n      requirements: JSON.stringify([\"Cal√ßado confort√°vel\", \"Protetor solar\", \"√Ågua\", \"Roupas adequadas ao clima\"]),\n      cancellationPolicy: \"Parque p√∫blico - sem necessidade de cancelamento\",\n      contactInfo: JSON.stringify({\n        phone: \"+1 212-310-6600\",\n        email: \"info@centralparknyc.org\",\n        website: \"https://www.centralparknyc.org\",\n        address: \"Central Park, New York, NY 10024\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1547036967-23d11aacaee0?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1547036967-23d11aacaee0?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1514395462725-fb4566210144?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1566404394863-f5ca891c96c8?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Museu Metropolitano de Arte (Met)\",\n      description: \"Descubra uma das maiores cole√ß√µes de arte do mundo! O Met abriga tesouros de 5.000 anos de arte de todas as culturas globais. Veja obras-primas eg√≠pcias, arte grega e romana, pinturas europeias de Van Gogh e Monet, arte americana e muito mais. Uma jornada atrav√©s da hist√≥ria da humanidade expressa em arte.\",\n      location: \"Nova York, EUA\",\n      category: \"culture\",\n      city: \"Nova York\",\n      countryType: \"internacional\",\n      region: \"Am√©rica do Norte\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"3-5 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 40,\n      languages: JSON.stringify([\"Ingl√™s\", \"Espanhol\", \"Franc√™s\", \"Alem√£o\", \"Italiano\", \"Portugu√™s\", \"Japon√™s\", \"Chin√™s\", \"Russo\"]),\n      inclusions: JSON.stringify([\"Entrada no museu\", \"Acesso √†s cole√ß√µes permanentes\", \"Mapa do museu\", \"Audioguia b√°sico\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Exposi√ß√µes especiais\", \"Guia particular\", \"Estacionamento\"]),\n      requirements: JSON.stringify([\"Documento de identidade\", \"Bagagem limitada\", \"N√£o permitido flash\", \"Sil√™ncio nas galerias\"]),\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes da visita\",\n      contactInfo: JSON.stringify({\n        phone: \"+1 212-535-7710\",\n        email: \"info@metmuseum.org\",\n        website: \"https://www.metmuseum.org\",\n        address: \"1000 5th Ave, New York, NY 10028\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1544827753-4acf7de08544?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1544827753-4acf7de08544?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1577720643271-6760b94e67d1?w=800&q=80\"\n      ]),\n      createdById: 1\n    }\n  ];\n\n  // Budget proposals for each activity\n  const budgetProposals = [\n    // Est√°tua da Liberdade proposals\n    {\n      activityTitle: \"Est√°tua da Liberdade e Ellis Island\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Ferry e Entrada\",\n          description: \"Pacote b√°sico com ferry para ambas as ilhas e entrada nos museus. Audioguia inclu√≠do.\",\n          amount: \"24.00\",\n          inclusions: [\"Ferry ida e volta\", \"Entrada Liberty Island\", \"Entrada Ellis Island\", \"Audioguia\"],\n          exclusions: [\"Acesso √† coroa\", \"Guia ao vivo\", \"Alimenta√ß√£o\", \"Souvenirs\"]\n        },\n        {\n          title: \"Completo - Tour Guiado\",\n          description: \"Experi√™ncia completa com guia especializado. Hist√≥ria detalhada e acesso priorit√°rio.\",\n          amount: \"50.00\",\n          inclusions: [\"Tudo do econ√¥mico\", \"Guia especializado\", \"Acesso priorit√°rio\", \"Tour de 3h\"],\n          exclusions: [\"Acesso √† coroa\", \"Alimenta√ß√£o\", \"Transporte terrestre\"]\n        },\n        {\n          title: \"Premium - VIP + Acesso Restrito\",\n          description: \"Experi√™ncia VIP com acesso √† coroa da Est√°tua da Liberdade e √°reas restritas.\",\n          amount: \"150.00\",\n          inclusions: [\"Acesso VIP √† coroa\", \"√Åreas restritas\", \"Guia privativo\", \"Grupo pequeno\", \"Evite filas\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Fotografias profissionais\"]\n        }\n      ]\n    },\n    // Empire State Building proposals\n    {\n      activityTitle: \"Empire State Building - √çcone de NY\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada B√°sica\",\n          description: \"Acesso ao observat√≥rio do 86¬∫ andar. Vistas panor√¢micas de Manhattan.\",\n          amount: \"45.00\",\n          inclusions: [\"86¬∫ andar\", \"Elevadores\", \"Vistas 360¬∞\", \"Exposi√ß√£o hist√≥rica\"],\n          exclusions: [\"102¬∫ andar\", \"Evite filas\", \"Guia tur√≠stico\", \"Alimenta√ß√£o\"]\n        },\n        {\n          title: \"Completo - Skip Line + Observat√≥rio\",\n          description: \"Acesso priorit√°rio aos observat√≥rios do 86¬∫ e 102¬∫ andares. Sem filas.\",\n          amount: \"90.00\",\n          inclusions: [\"86¬∫ e 102¬∫ andares\", \"Evite filas\", \"Vistas premium\", \"Audioguia\"],\n          exclusions: [\"Guia ao vivo\", \"Alimenta√ß√£o\", \"Fotografias\", \"Transporte\"]\n        },\n        {\n          title: \"Premium - Tour Guiado + Jantar\",\n          description: \"Experi√™ncia completa com tour guiado e jantar no STATE Grill and Bar.\",\n          amount: \"200.00\",\n          inclusions: [\"Tour guiado\", \"Todos os observat√≥rios\", \"Jantar 3 pratos\", \"Evite filas\", \"Vinho\"],\n          exclusions: [\"Transporte\", \"Gorjetas\", \"Bebidas extras\", \"Sobremesas especiais\"]\n        }\n      ]\n    },\n    // Broadway proposals\n    {\n      activityTitle: \"Broadway Show - Teatro de Classe Mundial\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Poltronas de Fundo\",\n          description: \"Assentos na parte traseira do teatro. Experi√™ncia Broadway completa a pre√ßo acess√≠vel.\",\n          amount: \"50.00\",\n          inclusions: [\"Ingresso do show\", \"Assento numerado\", \"Programa oficial\"],\n          exclusions: [\"Assentos premium\", \"Encontro com elenco\", \"Alimenta√ß√£o\", \"Bebidas\"]\n        },\n        {\n          title: \"Completo - Assentos Centrais\",\n          description: \"Assentos na √°rea central com excelente visibilidade. Experi√™ncia ideal.\",\n          amount: \"150.00\",\n          inclusions: [\"Assentos centrais\", \"Ingresso premium\", \"Programa oficial\", \"Vista perfeita\"],\n          exclusions: [\"Backstage\", \"Encontro com elenco\", \"Alimenta√ß√£o\", \"Bebidas\"]\n        },\n        {\n          title: \"Premium - VIP + Backstage\",\n          description: \"Experi√™ncia VIP completa com acesso ao backstage e encontro com o elenco.\",\n          amount: \"300.00\",\n          inclusions: [\"Melhores assentos\", \"Acesso backstage\", \"Encontro com elenco\", \"Programa autografado\", \"Champagne\"],\n          exclusions: [\"Transporte\", \"Jantar\", \"Fotografias profissionais\", \"Souvenirs extras\"]\n        }\n      ]\n    },\n    // Central Park proposals\n    {\n      activityTitle: \"Central Park - O√°sis Verde de Manhattan\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Passeio Livre\",\n          description: \"Explore o parque por conta pr√≥pria. Entrada gratuita com acesso a todas as √°reas p√∫blicas.\",\n          amount: \"0.00\",\n          inclusions: [\"Entrada gratuita\", \"Acesso a trilhas\", \"Locais hist√≥ricos\", \"Vistas panor√¢micas\"],\n          exclusions: [\"Guia tur√≠stico\", \"Aluguel de bicicleta\", \"Alimenta√ß√£o\", \"Transporte\"]\n        },\n        {\n          title: \"Completo - Aluguel de Bike\",\n          description: \"Explore o parque de bicicleta com mapa e rotas sugeridas. Maneira eficiente e divertida.\",\n          amount: \"40.00\",\n          inclusions: [\"Aluguel de bicicleta 4h\", \"Capacete\", \"Mapa de rotas\", \"Cadeado\"],\n          exclusions: [\"Guia tur√≠stico\", \"Alimenta√ß√£o\", \"Seguro\", \"Transporte\"]\n        },\n        {\n          title: \"Premium - Tour Guiado + Piquenique\",\n          description: \"Tour guiado com piquenique gourmet. Conhe√ßa hist√≥ria e segredos do parque.\",\n          amount: \"120.00\",\n          inclusions: [\"Guia especializado\", \"Piquenique gourmet\", \"Bebidas\", \"Locais exclusivos\", \"Grupo pequeno\"],\n          exclusions: [\"Transporte\", \"Gorjetas\", \"Bicicleta\", \"Atividades extras\"]\n        }\n      ]\n    },\n    // Met Museum proposals\n    {\n      activityTitle: \"Museu Metropolitano de Arte (Met)\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada B√°sica\",\n          description: \"Entrada no museu com acesso √†s cole√ß√µes permanentes. Explore no seu ritmo.\",\n          amount: \"25.00\",\n          inclusions: [\"Entrada no museu\", \"Cole√ß√µes permanentes\", \"Mapa do museu\", \"Audioguia b√°sico\"],\n          exclusions: [\"Guia ao vivo\", \"Exposi√ß√µes especiais\", \"Alimenta√ß√£o\", \"Transporte\"]\n        },\n        {\n          title: \"Completo - Tour Guiado\",\n          description: \"Tour guiado de 2 horas focando nas obras-primas. Contexto hist√≥rico e art√≠stico.\",\n          amount: \"60.00\",\n          inclusions: [\"Entrada no museu\", \"Tour guiado 2h\", \"Obras-primas\", \"Guia especializado\"],\n          exclusions: [\"Exposi√ß√µes especiais\", \"Alimenta√ß√£o\", \"Transporte\", \"Audioguia pessoal\"]\n        },\n        {\n          title: \"Premium - Tour Privado + Acesso VIP\",\n          description: \"Tour privado com acesso a √°reas especiais e curador especializado.\",\n          amount: \"150.00\",\n          inclusions: [\"Tour privado\", \"Curador especializado\", \"Acesso VIP\", \"√Åreas especiais\", \"Grupo pequeno\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Fotografias profissionais\", \"Souvenirs\"]\n        }\n      ]\n    }\n  ];\n\n  try {\n    // Insert activities first\n    for (const activity of nycActivities) {\n      try {\n        const [insertedActivity] = await db.insert(activities).values({\n          ...activity,\n          isActive: true\n        });\n        console.log(`‚úÖ Atividade criada: ${activity.title}`);\n      } catch (insertError: any) {\n        if (insertError.code === 'ER_DUP_ENTRY') {\n          console.log(`‚ÑπÔ∏è Atividade j√° existe: ${activity.title}`);\n        } else {\n          console.error(`‚ùå Erro ao criar ${activity.title}:`, insertError.message);\n        }\n      }\n    }\n\n    // Then insert budget proposals\n    for (const budgetGroup of budgetProposals) {\n      // Find the activity ID\n      const [activityResult] = await db.select()\n        .from(activities)\n        .where(sql`title = ${budgetGroup.activityTitle}`)\n        .limit(1);\n\n      if (activityResult) {\n        for (const proposal of budgetGroup.proposals) {\n          try {\n            await db.insert(activityBudgetProposals).values({\n              activityId: activityResult.id,\n              createdBy: 1,\n              title: proposal.title,\n              description: proposal.description,\n              amount: proposal.amount,\n              currency: \"USD\",\n              inclusions: JSON.stringify(proposal.inclusions),\n              exclusions: JSON.stringify(proposal.exclusions),\n              isActive: true\n            });\n            console.log(`  üí∞ Proposta criada: ${proposal.title}`);\n          } catch (proposalError: any) {\n            if (proposalError.code === 'ER_DUP_ENTRY') {\n              console.log(`  ‚ÑπÔ∏è Proposta j√° existe: ${proposal.title}`);\n            } else {\n              console.error(`  ‚ùå Erro ao criar proposta:`, proposalError.message);\n            }\n          }\n        }\n      }\n    }\n\n    console.log(\"üéâ Atividades de Nova York criadas com sucesso!\");\n\n  } catch (error) {\n    console.error(\"‚ùå Erro geral:\", error);\n  }\n}\n\n// Execute the function\naddNYCActivities().catch(console.error);","size_bytes":18752},"server/add-paris-activities.ts":{"content":"import { db } from \"./db\";\nimport { activities, activityBudgetProposals } from \"@shared/schema\";\nimport { sql } from \"drizzle-orm\";\n\n// Script to add Paris activities with authentic details and budget proposals\nasync function addParisActivities() {\n  console.log(\"üóº Adicionando atividades de Paris com detalhes aut√™nticos...\");\n  \n  const parisActivities = [\n    {\n      title: \"Torre Eiffel - S√≠mbolo de Paris\",\n      description: \"Visite o monumento mais famoso do mundo! A Torre Eiffel oferece vistas panor√¢micas espetaculares de Paris. Constru√≠da para a Exposi√ß√£o Universal de 1889, esta obra-prima da engenharia de ferro forjado tornou-se o s√≠mbolo eterno da Cidade Luz. Escolha entre diferentes n√≠veis de acesso e desfrute de uma experi√™ncia inesquec√≠vel.\",\n      location: \"Paris, Fran√ßa\",\n      category: \"sightseeing\",\n      city: \"Paris\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      priceType: \"per_person\",\n      priceAmount: null, // Will be set via budget proposals\n      duration: \"2-3 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 50,\n      languages: JSON.stringify([\"Franc√™s\", \"Ingl√™s\", \"Espanhol\", \"Alem√£o\"]),\n      inclusions: JSON.stringify([\"Acesso √† Torre Eiffel\", \"Vistas panor√¢micas\", \"Elevadores ou escadas\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Souvenirs\"]),\n      requirements: JSON.stringify([\"Documento de identidade\", \"Chegada com 30 min de anteced√™ncia\"]),\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes da visita\",\n      contactInfo: JSON.stringify({\n        phone: \"+33 892 70 12 39\",\n        email: \"contact@toureiffel.paris\",\n        website: \"https://www.toureiffel.paris\",\n        address: \"Champ de Mars, 5 Avenue Anatole France, 75007 Paris\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1511739001486-6bfe10ce785f?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1511739001486-6bfe10ce785f?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1549144511-f099e773c147?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1502602898536-47ad22581b52?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Museu do Louvre - Tesouro da Arte Mundial\",\n      description: \"Explore o maior museu de arte do mundo! O Louvre abriga obras-primas inestim√°veis como a Mona Lisa de Leonardo da Vinci, a V√™nus de Milo e a Vit√≥ria de Samotr√°cia. Com mais de 35.000 obras expostas em 60.600 m¬≤, este pal√°cio real transformado em museu oferece uma jornada √∫nica atrav√©s da hist√≥ria da arte e civiliza√ß√£o.\",\n      location: \"Paris, Fran√ßa\",\n      category: \"culture\",\n      city: \"Paris\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"3-5 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 30,\n      languages: JSON.stringify([\"Franc√™s\", \"Ingl√™s\", \"Espanhol\", \"Alem√£o\", \"Italiano\", \"Chin√™s\"]),\n      inclusions: JSON.stringify([\"Entrada no museu\", \"Acesso √†s cole√ß√µes permanentes\", \"Mapa do museu\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Audioguia\", \"Exposi√ß√µes tempor√°rias\"]),\n      requirements: JSON.stringify([\"Documento de identidade\", \"Bagagem limitada\", \"Proibido flash fotogr√°fico\"]),\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes. Bilhetes com data espec√≠fica n√£o reembols√°veis\",\n      contactInfo: JSON.stringify({\n        phone: \"+33 1 40 20 50 50\",\n        email: \"info@louvre.fr\",\n        website: \"https://www.louvre.fr\",\n        address: \"Rue de Rivoli, 75001 Paris\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1566139992888-745d3856e2f8?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1566139992888-745d3856e2f8?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Cruzeiro pelo Rio Sena - Paris das √Åguas\",\n      description: \"Descubra Paris sob uma perspectiva √∫nica navegando pelo hist√≥rico Rio Sena! Este passeio oferece vistas deslumbrantes dos principais monumentos parisienses: Torre Eiffel, Catedral de Notre-Dame, Museu do Louvre e Museu d'Orsay. Navegue pelas √°guas que testemunharam s√©culos de hist√≥ria francesa enquanto desfruta da arquitetura majestosa das margens do Sena.\",\n      location: \"Paris, Fran√ßa\",\n      category: \"sightseeing\",\n      city: \"Paris\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"1-2 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 200,\n      languages: JSON.stringify([\"Franc√™s\", \"Ingl√™s\", \"Espanhol\", \"Alem√£o\", \"Italiano\"]),\n      inclusions: JSON.stringify([\"Cruzeiro pelo Rio Sena\", \"Coment√°rios em m√∫ltiplos idiomas\", \"Assentos cobertos\"]),\n      exclusions: JSON.stringify([\"Transporte at√© o embarque\", \"Alimenta√ß√£o\", \"Bebidas\", \"Gorjetas\"]),\n      requirements: JSON.stringify([\"Chegada 15 min antes\", \"Roupas adequadas ao clima\", \"Protetor solar\"]),\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes do passeio\",\n      contactInfo: JSON.stringify({\n        phone: \"+33 1 42 25 96 10\",\n        email: \"info@bateaux-parisiens.com\",\n        website: \"https://www.bateaux-parisiens.com\",\n        address: \"Port de la Bourdonnais, 75007 Paris\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1549144511-f099e773c147?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1549144511-f099e773c147?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1502602898536-47ad22581b52?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1499856871958-5b9627545d1a?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Catedral de Notre-Dame - Joia G√≥tica\",\n      description: \"Admire a magistral arquitetura g√≥tica da Catedral de Notre-Dame de Paris! Esta obra-prima medieval, imortalizada por Victor Hugo, impressiona com suas torres imponentes, ros√°ceas multicoloridas e g√°rgulas misteriosas. Mesmo ap√≥s o inc√™ndio de 2019, a catedral continua sendo um s√≠mbolo da resili√™ncia parisiense e da arte g√≥tica francesa.\",\n      location: \"Paris, Fran√ßa\",\n      category: \"culture\",\n      city: \"Paris\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"1-2 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 100,\n      languages: JSON.stringify([\"Franc√™s\", \"Ingl√™s\", \"Espanhol\", \"Alem√£o\"]),\n      inclusions: JSON.stringify([\"Entrada na catedral\", \"Acesso ao interior\", \"Vistas da arquitetura g√≥tica\"]),\n      exclusions: JSON.stringify([\"Acesso √†s torres\", \"Transporte\", \"Alimenta√ß√£o\", \"Guia tur√≠stico\"]),\n      requirements: JSON.stringify([\"Vestu√°rio adequado\", \"Sil√™ncio durante missas\", \"Respeito ao local sagrado\"]),\n      cancellationPolicy: \"Entrada gratuita. Hor√°rios sujeitos a celebra√ß√µes religiosas\",\n      contactInfo: JSON.stringify({\n        phone: \"+33 1 42 34 56 10\",\n        email: \"accueil@notredamedeparis.fr\",\n        website: \"https://www.notredamedeparis.fr\",\n        address: \"6 Parvis Notre-Dame, 75004 Paris\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1539650116574-75c0c6d47324?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1539650116574-75c0c6d47324?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1513635269975-59663e0ac1ad?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Pal√°cio de Versalhes - Grandeza Real\",\n      description: \"Mergulhe na opul√™ncia da corte francesa no magn√≠fico Pal√°cio de Versalhes! Este s√≠mbolo do absolutismo real impressiona com o famoso Sal√£o dos Espelhos, os aposentos reais luxuosamente decorados e os jardins franceses desenhados por Andr√© Le N√¥tre. Uma jornada pela hist√≥ria da Fran√ßa mon√°rquica e pela arte decorativa francesa dos s√©culos XVII e XVIII.\",\n      location: \"Paris, Fran√ßa\",\n      category: \"culture\",\n      city: \"Paris\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"4-6 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 40,\n      languages: JSON.stringify([\"Franc√™s\", \"Ingl√™s\", \"Espanhol\", \"Alem√£o\", \"Italiano\"]),\n      inclusions: JSON.stringify([\"Entrada no pal√°cio\", \"Acesso aos jardins\", \"Sal√£o dos Espelhos\", \"Aposentos reais\"]),\n      exclusions: JSON.stringify([\"Transporte de/para Paris\", \"Alimenta√ß√£o\", \"Guia tur√≠stico\", \"Espet√°culos especiais\"]),\n      requirements: JSON.stringify([\"Documento de identidade\", \"Cal√ßado confort√°vel\", \"Chegada pontual\"]),\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes. Bilhetes com data espec√≠fica\",\n      contactInfo: JSON.stringify({\n        phone: \"+33 1 30 83 78 00\",\n        email: \"contact@chateauversailles.fr\",\n        website: \"https://www.chateauversailles.fr\",\n        address: \"Place d'Armes, 78000 Versailles\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1560969184-10fe8719e047?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1560969184-10fe8719e047?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1571771019784-3ff35f4f4277?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1550859492-d5da9d8e45f3?w=800&q=80\"\n      ]),\n      createdById: 1\n    }\n  ];\n\n  // Budget proposals for each activity\n  const budgetProposals = [\n    // Torre Eiffel proposals\n    {\n      activityTitle: \"Torre Eiffel - S√≠mbolo de Paris\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Escada at√© 2¬∫ Andar\",\n          description: \"Acesso at√© o segundo andar via escada. Exerc√≠cio saud√°vel com vista magn√≠fica de Paris.\",\n          amount: \"10.00\",\n          inclusions: [\"Acesso at√© 2¬∫ andar\", \"Escada\", \"Vista panor√¢mica\"],\n          exclusions: [\"Elevador\", \"Acesso ao topo\", \"Guia tur√≠stico\"]\n        },\n        {\n          title: \"Completo - Elevador at√© o Topo\",\n          description: \"Acesso completo at√© o topo da Torre Eiffel via elevador. Experi√™ncia cl√°ssica e confort√°vel.\",\n          amount: \"25.00\",\n          inclusions: [\"Elevador at√© o topo\", \"Todos os n√≠veis\", \"Vista 360¬∞\"],\n          exclusions: [\"Guia tur√≠stico\", \"Alimenta√ß√£o\", \"Tour guiado\"]\n        },\n        {\n          title: \"Premium - Tour Guiado + Jantar\",\n          description: \"Experi√™ncia completa com tour guiado e jantar no restaurante Jules Verne. Luxo e exclusividade.\",\n          amount: \"70.00\",\n          inclusions: [\"Tour guiado\", \"Jantar no restaurante\", \"Acesso priorit√°rio\", \"Sommelier\"],\n          exclusions: [\"Transporte\", \"Bebidas extras\", \"Gorjetas\"]\n        }\n      ]\n    },\n    // Museu do Louvre proposals\n    {\n      activityTitle: \"Museu do Louvre - Tesouro da Arte Mundial\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada Online\",\n          description: \"Bilhete de entrada padr√£o comprado online. Acesso √†s cole√ß√µes permanentes.\",\n          amount: \"17.00\",\n          inclusions: [\"Entrada no museu\", \"Cole√ß√µes permanentes\", \"Mapa gratuito\"],\n          exclusions: [\"Audioguia\", \"Tour guiado\", \"Exposi√ß√µes tempor√°rias\"]\n        },\n        {\n          title: \"Completo - Tour Guiado em Grupo\",\n          description: \"Tour guiado em grupo com guia especializado. Descubra as obras-primas do Louvre.\",\n          amount: \"40.00\",\n          inclusions: [\"Tour guiado 2h\", \"Entrada no museu\", \"Obras principais\", \"Guia especializado\"],\n          exclusions: [\"Audioguia pessoal\", \"Acesso VIP\", \"Exposi√ß√µes tempor√°rias\"]\n        },\n        {\n          title: \"Premium - Tour Privativo + Acesso Especial\",\n          description: \"Tour privativo com acesso especial √†s √°reas restritas. Experi√™ncia exclusiva e personalizada.\",\n          amount: \"120.00\",\n          inclusions: [\"Tour privativo\", \"Acesso especial\", \"Guia personal\", \"Evite filas\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Souvenirs\"]\n        }\n      ]\n    },\n    // Cruzeiro pelo Sena proposals\n    {\n      activityTitle: \"Cruzeiro pelo Rio Sena - Paris das √Åguas\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Cruzeiro Simples\",\n          description: \"Cruzeiro b√°sico de 1 hora pelo Rio Sena. Coment√°rios em m√∫ltiplos idiomas.\",\n          amount: \"15.00\",\n          inclusions: [\"Cruzeiro 1h\", \"Coment√°rios\", \"Assentos cobertos\"],\n          exclusions: [\"Alimenta√ß√£o\", \"Bebidas\", \"Servi√ßo de mesa\"]\n        },\n        {\n          title: \"Completo - Cruzeiro com Jantar\",\n          description: \"Cruzeiro rom√¢ntico com jantar de 3 pratos. Gastronomia francesa a bordo.\",\n          amount: \"60.00\",\n          inclusions: [\"Cruzeiro 2h\", \"Jantar 3 pratos\", \"Vinho incluso\", \"Servi√ßo de mesa\"],\n          exclusions: [\"Transporte\", \"Gorjetas\", \"Bebidas extras\"]\n        },\n        {\n          title: \"Premium - Cruzeiro Privativo com Champagne\",\n          description: \"Cruzeiro privativo com champagne e canap√©s. M√°ximo 8 pessoas para experi√™ncia exclusiva.\",\n          amount: \"150.00\",\n          inclusions: [\"Cruzeiro privativo\", \"Champagne premium\", \"Canap√©s gourmet\", \"Servi√ßo personalizado\"],\n          exclusions: [\"Transporte\", \"Jantar completo\", \"Fotografias\"]\n        }\n      ]\n    },\n    // Notre-Dame proposals\n    {\n      activityTitle: \"Catedral de Notre-Dame - Joia G√≥tica\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada Livre\",\n          description: \"Entrada gratuita na catedral. Admire a arquitetura g√≥tica por conta pr√≥pria.\",\n          amount: \"0.00\",\n          inclusions: [\"Entrada na catedral\", \"Acesso ao interior\", \"Arquitetura g√≥tica\"],\n          exclusions: [\"Guia tur√≠stico\", \"Acesso √†s torres\", \"Audioguia\"]\n        },\n        {\n          title: \"Completo - Tour Guiado\",\n          description: \"Tour guiado com especialista em arquitetura g√≥tica. Hist√≥ria e arte medieval.\",\n          amount: \"15.00\",\n          inclusions: [\"Tour guiado 1h\", \"Entrada na catedral\", \"Hist√≥ria medieval\", \"Arquitetura g√≥tica\"],\n          exclusions: [\"Acesso √†s torres\", \"Transporte\", \"Alimenta√ß√£o\"]\n        },\n        {\n          title: \"Premium - Tour Privado + Torre\",\n          description: \"Tour privado com acesso √†s torres (quando dispon√≠vel). Vista panor√¢mica de Paris.\",\n          amount: \"50.00\",\n          inclusions: [\"Tour privado\", \"Acesso √†s torres\", \"Vista panor√¢mica\", \"Guia especializado\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Fotografias profissionais\"]\n        }\n      ]\n    },\n    // Versalhes proposals\n    {\n      activityTitle: \"Pal√°cio de Versalhes - Grandeza Real\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada B√°sica\",\n          description: \"Entrada b√°sica no pal√°cio. Acesso aos aposentos reais e Sal√£o dos Espelhos.\",\n          amount: \"18.00\",\n          inclusions: [\"Entrada no pal√°cio\", \"Aposentos reais\", \"Sal√£o dos Espelhos\"],\n          exclusions: [\"Jardins\", \"Transporte\", \"Audioguia\"]\n        },\n        {\n          title: \"Completo - Tour com Audioguia\",\n          description: \"Tour completo com audioguia em portugu√™s. Pal√°cio, jardins e hist√≥ria francesa.\",\n          amount: \"50.00\",\n          inclusions: [\"Entrada completa\", \"Audioguia\", \"Jardins\", \"Aposentos reais\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Guia ao vivo\"]\n        },\n        {\n          title: \"Premium - Tour Privativo + Jardins\",\n          description: \"Tour privativo com guia especializado. Acesso completo aos jardins franceses.\",\n          amount: \"100.00\",\n          inclusions: [\"Tour privativo\", \"Guia especializado\", \"Jardins completos\", \"Evite filas\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Espet√°culos especiais\"]\n        }\n      ]\n    }\n  ];\n\n  try {\n    // Insert activities first\n    for (const activity of parisActivities) {\n      try {\n        const [insertedActivity] = await db.insert(activities).values({\n          ...activity,\n          isActive: true\n        });\n        console.log(`‚úÖ Atividade criada: ${activity.title}`);\n      } catch (insertError: any) {\n        if (insertError.code === 'ER_DUP_ENTRY') {\n          console.log(`‚ÑπÔ∏è Atividade j√° existe: ${activity.title}`);\n        } else {\n          console.error(`‚ùå Erro ao criar ${activity.title}:`, insertError.message);\n        }\n      }\n    }\n\n    // Then insert budget proposals\n    for (const budgetGroup of budgetProposals) {\n      // Find the activity ID\n      const [activityResult] = await db.select()\n        .from(activities)\n        .where(sql`title = ${budgetGroup.activityTitle}`)\n        .limit(1);\n\n      if (activityResult) {\n        for (const proposal of budgetGroup.proposals) {\n          try {\n            await db.insert(activityBudgetProposals).values({\n              activityId: activityResult.id,\n              createdBy: 1,\n              title: proposal.title,\n              description: proposal.description,\n              amount: proposal.amount,\n              currency: \"EUR\",\n              inclusions: JSON.stringify(proposal.inclusions),\n              exclusions: JSON.stringify(proposal.exclusions),\n              isActive: true\n            });\n            console.log(`  üí∞ Proposta criada: ${proposal.title}`);\n          } catch (proposalError: any) {\n            if (proposalError.code === 'ER_DUP_ENTRY') {\n              console.log(`  ‚ÑπÔ∏è Proposta j√° existe: ${proposal.title}`);\n            } else {\n              console.error(`  ‚ùå Erro ao criar proposta:`, proposalError.message);\n            }\n          }\n        }\n      }\n    }\n\n    console.log(\"üéâ Atividades de Paris criadas com sucesso!\");\n\n  } catch (error) {\n    console.error(\"‚ùå Erro geral:\", error);\n  }\n}\n\n// Execute the function\naddParisActivities().catch(console.error);","size_bytes":18358},"server/add-rating-columns.ts":{"content":"import { db } from './db.js';\nimport { sql } from 'drizzle-orm';\n\nasync function addRatingColumns() {\n  console.log('üîß Adicionando colunas de rating necess√°rias...');\n\n  try {\n    // Verificar se a coluna total_ratings j√° existe\n    const columns = await db.execute(sql`DESCRIBE activities`);\n    const hasRatingColumns = columns.some(col => col.Field === 'total_ratings');\n    \n    if (!hasRatingColumns) {\n      // Adicionar colunas de rating se n√£o existirem\n      await db.execute(sql`\n        ALTER TABLE activities \n        ADD COLUMN total_ratings INT DEFAULT 0 NOT NULL,\n        ADD COLUMN rating_sum DECIMAL(10,2) DEFAULT 0.00 NOT NULL\n      `);\n      console.log('‚úÖ Colunas de rating adicionadas!');\n    } else {\n      console.log('‚ÑπÔ∏è Colunas de rating j√° existem');\n    }\n\n    // Verificar se a tabela activity_budget_proposals tem as colunas necess√°rias\n    const proposalColumns = await db.execute(sql`DESCRIBE activity_budget_proposals`);\n    const hasProposalColumns = proposalColumns.some(col => col.Field === 'votes');\n    \n    if (!hasProposalColumns) {\n      await db.execute(sql`\n        ALTER TABLE activity_budget_proposals \n        ADD COLUMN votes INT DEFAULT 0 NOT NULL,\n        ADD COLUMN is_popular BOOLEAN DEFAULT FALSE NOT NULL\n      `);\n      console.log('‚úÖ Colunas de propostas adicionadas!');\n    }\n\n  } catch (error) {\n    console.error('‚ùå Erro ao adicionar colunas:', error);\n  }\n}\n\n// Executar se chamado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  addRatingColumns()\n    .then(() => {\n      console.log('‚úÖ Processo conclu√≠do!');\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('‚ùå Erro no processo:', error);\n      process.exit(1);\n    });\n}","size_bytes":1750},"server/add-rio-activities.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals, activityReviews, activityVotes } from '../shared/schema.js';\n\n// Cover images URLs based on search results\nconst coverImages = {\n  cristoRedentor: 'https://images.unsplash.com/photo-1518639192441-8fce0c1b5ac9?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80', // Cristo Redentor\n  paoAcucar: 'https://images.unsplash.com/photo-1544474171-a4f3e7c6e7b2?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80', // P√£o de A√ß√∫car\n  copacabana: 'https://images.unsplash.com/photo-1483729558449-99ef09a8c325?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80', // Copacabana\n  trilha: 'https://images.unsplash.com/photo-1606870333093-69d6c4de4f35?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80', // Trilha\n  theatro: 'https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80' // Theatro Municipal\n};\n\nconst rioActivities = [\n  {\n    title: 'Cristo Redentor / Corcovado',\n    description: 'Visita ao ic√¥nico Cristo Redentor, uma das Novas Sete Maravilhas do Mundo. Localizado no topo do Corcovado, oferece vistas panor√¢micas espetaculares da cidade do Rio de Janeiro.',\n    location: 'Rio de Janeiro, RJ',\n    category: 'pontos_turisticos',\n    duration: \"4 horas\",\n    difficulty: 'easy',\n    priceRange: 'medium',\n    coverImage: coverImages.cristoRedentor,\n    rating: 4.8,\n    reviewCount: 1247,\n    proposals: [\n      {\n        title: 'Econ√¥mico',\n        description: 'Transporte de van oficial at√© o Cristo Redentor',\n        price: 85.00,\n        inclusions: ['Transporte de van oficial', 'Entrada para o Cristo Redentor'],\n        exclusions: ['Alimenta√ß√£o', 'Guia tur√≠stico', 'Seguro viagem']\n      },\n      {\n        title: 'Completo',\n        description: 'Experi√™ncia completa com trem do Corcovado e guia especializado',\n        price: 160.00,\n        inclusions: ['Trem do Corcovado', 'Entrada para o Cristo Redentor', 'Guia tur√≠stico especializado', 'Seguro viagem'],\n        exclusions: ['Alimenta√ß√£o', 'Transporte at√© o trem', 'Souvenirs']\n      },\n      {\n        title: 'Premium',\n        description: 'Tour privativo com transporte executivo e experi√™ncia VIP',\n        price: 320.00,\n        inclusions: ['Transporte executivo privado', 'Trem do Corcovado primeira classe', 'Guia tur√≠stico exclusivo', 'Seguro premium', '√Ågua e lanche'],\n        exclusions: ['Refei√ß√µes principais', 'Souvenirs', 'Gorjetas']\n      }\n    ],\n    reviews: [\n      {\n        userName: 'Carlos Santos',\n        rating: 5,\n        comment: 'Experi√™ncia incr√≠vel! Vista espetacular do Rio. O Cristo Redentor √© realmente majestoso. Recomendo muito!',\n        visitDate: '2024-12-15'\n      },\n      {\n        userName: 'Maria Silva',\n        rating: 4,\n        comment: 'Muito bonito, mas estava bem cheio. A vista compensa tudo. Melhor ir cedo pela manh√£.',\n        visitDate: '2024-12-10'\n      },\n      {\n        userName: 'Jo√£o Pereira',\n        rating: 5,\n        comment: 'Simplesmente m√°gico! Uma das experi√™ncias mais marcantes da minha vida. O p√¥r do sol l√° em cima √© inesquec√≠vel.',\n        visitDate: '2024-12-08'\n      }\n    ]\n  },\n  {\n    title: 'P√£o de A√ß√∫car (Bondinho)',\n    description: 'Passeio no famoso bondinho do P√£o de A√ß√∫car com vistas panor√¢micas da Ba√≠a de Guanabara, praias de Copacabana e Ipanema. Um dos cart√µes postais mais famosos do Rio.',\n    location: 'Rio de Janeiro, RJ',\n    category: 'pontos_turisticos',\n    duration: \"3 horas\",\n    difficulty: 'easy',\n    priceRange: 'medium',\n    coverImage: coverImages.paoAcucar,\n    rating: 4.7,\n    reviewCount: 892,\n    proposals: [\n      {\n        title: 'Econ√¥mico',\n        description: 'Ingresso padr√£o para o bondinho',\n        price: 120.00,\n        inclusions: ['Ingresso do bondinho (ida e volta)', 'Acesso aos dois morros'],\n        exclusions: ['Transporte at√© o local', 'Alimenta√ß√£o', 'Guia tur√≠stico']\n      },\n      {\n        title: 'Completo',\n        description: 'Bondinho com guia especializado',\n        price: 190.00,\n        inclusions: ['Ingresso do bondinho', 'Guia tur√≠stico', 'Explica√ß√µes hist√≥ricas', 'Dicas de fotografia'],\n        exclusions: ['Transporte at√© o local', 'Alimenta√ß√£o', 'Souvenirs']\n      },\n      {\n        title: 'Premium',\n        description: 'Experi√™ncia premium com tour de helic√≥ptero',\n        price: 350.00,\n        inclusions: ['Ingresso do bondinho', 'Guia especializado', 'Tour de helic√≥ptero (15 min)', 'Transporte executivo', 'Bebidas'],\n        exclusions: ['Refei√ß√µes', 'Seguro adicional', 'Fotos profissionais']\n      }\n    ],\n    reviews: [\n      {\n        userName: 'Ana Costa',\n        rating: 5,\n        comment: 'Vista incr√≠vel da cidade! O bondinho √© uma experi√™ncia √∫nica. Recomendo ir no final da tarde para ver o p√¥r do sol.',\n        visitDate: '2024-12-18'\n      },\n      {\n        userName: 'Roberto Lima',\n        rating: 4,\n        comment: 'Muito legal, mas as filas s√£o grandes. Vale a pena comprar o ingresso antecipado. A vista √© espetacular!',\n        visitDate: '2024-12-12'\n      },\n      {\n        userName: 'Lucia Martins',\n        rating: 5,\n        comment: 'Experi√™ncia inesquec√≠vel! Consegui ver toda a cidade do alto. O bondinho √© seguro e a vista √© de tirar o f√¥lego.',\n        visitDate: '2024-12-05'\n      }\n    ]\n  },\n  {\n    title: 'Praia de Copacabana / Ipanema + Esportes',\n    description: 'Desfrute das praias mais famosas do mundo com atividades esportivas como surf, v√¥lei de praia, e passeios de bike. Inclui as ic√¥nicas praias de Copacabana e Ipanema.',\n    location: 'Rio de Janeiro, RJ',\n    category: 'water_sports',\n    duration: \"6 horas\",\n    difficulty: 'easy',\n    priceRange: 'low',\n    coverImage: coverImages.copacabana,\n    rating: 4.6,\n    reviewCount: 1543,\n    proposals: [\n      {\n        title: 'Econ√¥mico',\n        description: 'Acesso livre √†s praias',\n        price: 0.00,\n        inclusions: ['Acesso √†s praias', 'Uso de chuveiros p√∫blicos', 'Acesso √†s ciclovias'],\n        exclusions: ['Equipamentos esportivos', 'Alimenta√ß√£o', 'Guarda-sol', 'Cadeiras']\n      },\n      {\n        title: 'Completo',\n        description: 'Aula de surf ou aluguel de bike',\n        price: 100.00,\n        inclusions: ['Aula de surf (2h) ou aluguel de bike (4h)', 'Equipamentos inclusos', 'Instrutor qualificado'],\n        exclusions: ['Alimenta√ß√£o', 'Transporte', 'Protetor solar', 'Toalha']\n      },\n      {\n        title: 'Premium',\n        description: 'Passeio de lancha com drinks',\n        price: 300.00,\n        inclusions: ['Passeio de lancha (3h)', 'Drinks e petiscos', 'Equipamentos de snorkel', 'Capit√£o e tripula√ß√£o'],\n        exclusions: ['Transporte at√© marina', 'Refei√ß√µes principais', 'Gorjetas']\n      }\n    ],\n    reviews: [\n      {\n        userName: 'Pedro Oliveira',\n        rating: 5,\n        comment: 'Praias maravilhosas! Fiz aula de surf e foi incr√≠vel. A √°gua estava perfeita e o instrutor muito paciente.',\n        visitDate: '2024-12-20'\n      },\n      {\n        userName: 'Camila Santos',\n        rating: 4,\n        comment: 'Lugar lindo, mas muito movimentado. O passeio de bike foi √≥timo, d√° para ver tudo com calma.',\n        visitDate: '2024-12-14'\n      },\n      {\n        userName: 'Rafael Torres',\n        rating: 5,\n        comment: 'O passeio de lancha foi o ponto alto da viagem! Vista incr√≠vel da cidade pelo mar. Drinks deliciosos!',\n        visitDate: '2024-12-11'\n      }\n    ]\n  },\n  {\n    title: 'Trilha Pedra Bonita ou Dois Irm√£os',\n    description: 'Trilha moderada com vistas espetaculares da cidade, praias e montanhas. Perfeita para amantes da natureza e fotografia. Op√ß√£o entre Pedra Bonita e Dois Irm√£os.',\n    location: 'Rio de Janeiro, RJ',\n    category: 'hiking',\n    duration: \"4 horas\",\n    difficulty: 'medium',\n    priceRange: 'low',\n    coverImage: coverImages.trilha,\n    rating: 4.5,\n    reviewCount: 687,\n    proposals: [\n      {\n        title: 'Econ√¥mico',\n        description: 'Trilha autoguiada',\n        price: 0.00,\n        inclusions: ['Acesso √† trilha', 'Mapas b√°sicos dispon√≠veis'],\n        exclusions: ['Guia tur√≠stico', 'Transporte', 'Equipamentos', 'Seguro']\n      },\n      {\n        title: 'Completo',\n        description: 'Trilha com guia local experiente',\n        price: 100.00,\n        inclusions: ['Guia local experiente', 'Informa√ß√µes sobre flora e fauna', 'Dicas de seguran√ßa', 'Primeiros socorros'],\n        exclusions: ['Transporte', 'Equipamentos pessoais', 'Alimenta√ß√£o', 'Seguro viagem']\n      },\n      {\n        title: 'Premium',\n        description: 'Tour privado com transporte',\n        price: 280.00,\n        inclusions: ['Guia privado', 'Transporte ida e volta', 'Equipamentos profissionais', 'Lanche e √°gua', 'Seguro completo'],\n        exclusions: ['Refei√ß√µes principais', 'Roupas especiais', 'Gorjetas']\n      }\n    ],\n    reviews: [\n      {\n        userName: 'Fernanda Lima',\n        rating: 5,\n        comment: 'Trilha incr√≠vel! A vista l√° de cima √© espetacular. Recomendo ir com guia, vale muito a pena.',\n        visitDate: '2024-12-16'\n      },\n      {\n        userName: 'Marcos Andrade',\n        rating: 4,\n        comment: 'Trilha moderada, mas a recompensa √© fant√°stica. Leve √°gua e protetor solar. Vista 360¬∫ da cidade!',\n        visitDate: '2024-12-09'\n      },\n      {\n        userName: 'Sofia Ribeiro',\n        rating: 5,\n        comment: 'Fiz a trilha do Dois Irm√£os e foi sensacional! O nascer do sol l√° em cima √© imperd√≠vel.',\n        visitDate: '2024-12-03'\n      }\n    ]\n  },\n  {\n    title: 'Tour Cultural Centro (Theatro Municipal, Museu do Amanh√£)',\n    description: 'Explore o centro hist√≥rico do Rio visitando o majestoso Theatro Municipal, Museu do Amanh√£, e outros pontos culturais. Mergulhe na rica hist√≥ria e arquitetura carioca.',\n    location: 'Rio de Janeiro, RJ',\n    category: 'cultural',\n    duration: \"5 horas\",\n    difficulty: 'easy',\n    priceRange: 'low',\n    coverImage: coverImages.theatro,\n    rating: 4.4,\n    reviewCount: 523,\n    proposals: [\n      {\n        title: 'Econ√¥mico',\n        description: 'Visita b√°sica aos pontos tur√≠sticos',\n        price: 30.00,\n        inclusions: ['Entrada no Theatro Municipal', 'Mapa tur√≠stico', 'Acesso a pontos externos'],\n        exclusions: ['Guia tur√≠stico', 'Transporte', 'Entrada no Museu do Amanh√£', 'Alimenta√ß√£o']\n      },\n      {\n        title: 'Completo',\n        description: 'Tour guiado com transporte',\n        price: 90.00,\n        inclusions: ['Guia especializado', 'Transporte entre pontos', 'Entrada Theatro Municipal', 'Entrada Museu do Amanh√£', 'Material informativo'],\n        exclusions: ['Alimenta√ß√£o', 'Souvenirs', 'Ingressos extras']\n      },\n      {\n        title: 'Premium',\n        description: 'Experi√™ncia cultural completa com jantar',\n        price: 220.00,\n        inclusions: ['Guia especializado', 'Transporte executivo', 'Todas as entradas', 'Jantar em restaurante hist√≥rico', 'Degusta√ß√£o de vinhos'],\n        exclusions: ['Bebidas extras', 'Gorjetas', 'Transporte de retorno ao hotel']\n      }\n    ],\n    reviews: [\n      {\n        userName: 'Helena Carvalho',\n        rating: 5,\n        comment: 'Tour cultural maravilhoso! O Theatro Municipal √© deslumbrante e o guia conhecia toda a hist√≥ria. Recomendo muito!',\n        visitDate: '2024-12-17'\n      },\n      {\n        userName: 'Gustavo Silva',\n        rating: 4,\n        comment: 'Muito interessante conhecer a hist√≥ria do Rio. O Museu do Amanh√£ √© impressionante. Vale o investimento!',\n        visitDate: '2024-12-13'\n      },\n      {\n        userName: 'Isabela Costa',\n        rating: 4,\n        comment: 'Centro hist√≥rico lindo! O jantar foi um diferencial. Aprendi muito sobre a cultura carioca.',\n        visitDate: '2024-12-07'\n      }\n    ]\n  }\n];\n\nasync function addRioActivities() {\n  console.log('üèñÔ∏è Iniciando adi√ß√£o das atividades do Rio de Janeiro...');\n  \n  try {\n    for (const activityData of rioActivities) {\n      console.log(`üìç Adicionando atividade: ${activityData.title}`);\n      \n      // Insert activity\n      const [activity] = await db.insert(activities).values({\n        title: activityData.title,\n        description: activityData.description,\n        location: activityData.location,\n        category: activityData.category,\n        duration: activityData.duration,\n        difficulty: activityData.difficulty,\n        priceRange: activityData.priceRange,\n        coverImage: activityData.coverImage,\n        rating: activityData.rating,\n        reviewCount: activityData.reviewCount,\n        isActive: true\n      });\n      \n      console.log(`‚úÖ Atividade criada com ID: ${activity.insertId}`);\n      \n      // Add budget proposals\n      for (const proposal of activityData.proposals) {\n        const [budgetProposal] = await db.insert(activityBudgetProposals).values({\n          activityId: activity.insertId,\n          createdBy: 1, // User tom\n          title: proposal.title,\n          description: proposal.description,\n          amount: proposal.price.toString(),\n          inclusions: JSON.stringify(proposal.inclusions),\n          exclusions: JSON.stringify(proposal.exclusions),\n          votes: Math.floor(Math.random() * 50) + 10, // Random votes between 10-60\n          isActive: true\n        });\n        \n        console.log(`üí∞ Proposta \"${proposal.title}\" criada com ID: ${budgetProposal.insertId}`);\n      }\n      \n      // Add reviews\n      for (const review of activityData.reviews) {\n        // Get a random user (1-6)\n        const userId = Math.floor(Math.random() * 6) + 1;\n        \n        const [reviewRecord] = await db.insert(activityReviews).values({\n          userId,\n          activityId: activity.insertId,\n          rating: review.rating,\n          comment: review.comment,\n          visitDate: new Date(review.visitDate),\n          userName: review.userName,\n          isVerified: Math.random() > 0.3, // 70% chance of being verified\n          helpfulCount: Math.floor(Math.random() * 20) + 5 // Random helpful count\n        });\n        \n        console.log(`‚≠ê Review de ${review.userName} criada com ID: ${reviewRecord.insertId}`);\n      }\n      \n      console.log(`‚úÖ Atividade \"${activityData.title}\" completamente configurada!\\n`);\n    }\n    \n    console.log('üéâ Todas as atividades do Rio de Janeiro foram adicionadas com sucesso!');\n    \n  } catch (error) {\n    console.error('‚ùå Erro ao adicionar atividades:', error);\n  }\n}\n\naddRioActivities();","size_bytes":14818},"server/add-rome-activities.ts":{"content":"import { db } from \"./db\";\nimport { activities, activityBudgetProposals } from \"@shared/schema\";\nimport { sql } from \"drizzle-orm\";\n\n// Script to add Rome activities with authentic details and budget proposals\nasync function addRomeActivities() {\n  console.log(\"üèõÔ∏è Adicionando atividades de Roma com detalhes aut√™nticos...\");\n  \n  const romeActivities = [\n    {\n      title: \"Coliseu - Anfiteatro Romano\",\n      description: \"Explore o maior anfiteatro do mundo e s√≠mbolo do Imp√©rio Romano! O Coliseu, constru√≠do em 72-80 d.C., abrigava combates de gladiadores e espet√°culos para at√© 50.000 espectadores. Descubra a engenharia romana avan√ßada, os subterr√¢neos onde ficavam feras e gladiadores, e reviva a hist√≥ria √©pica dos jogos romanos. Patrim√¥nio Mundial da UNESCO e uma das Sete Maravilhas do Mundo Moderno.\",\n      location: \"Roma, It√°lia\",\n      category: \"culture\",\n      city: \"Roma\",\n      countryType: \"internacional\",\n      region: \"Europa Meridional\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"2-3 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 50,\n      languages: JSON.stringify([\"Italiano\", \"Ingl√™s\", \"Espanhol\", \"Franc√™s\", \"Alem√£o\", \"Portugu√™s\"]),\n      inclusions: JSON.stringify([\"Entrada no Coliseu\", \"Acesso ao F√≥rum Romano\", \"Palatino Hill\", \"Audioguia\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Acesso √† arena\", \"Subterr√¢neos\"]),\n      requirements: JSON.stringify([\"Documento de identidade\", \"Chegada pontual\", \"Cal√ßado confort√°vel\", \"Protetor solar\"]),\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes da visita\",\n      contactInfo: JSON.stringify({\n        phone: \"+39 06 3996 7700\",\n        email: \"pa-colosseo@cultura.gov.it\",\n        website: \"https://colosseo.it\",\n        address: \"Piazza del Colosseo, 1, 00184 Roma RM\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1552832230-c0197dd311b5?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1552832230-c0197dd311b5?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1539650116574-75c0c6d47324?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1544431369-dccdb9dc8c16?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Vaticano e Bas√≠lica de S√£o Pedro\",\n      description: \"Visite o menor pa√≠s do mundo e o cora√ß√£o da Igreja Cat√≥lica! Os Museus Vaticanos abrigam uma das maiores cole√ß√µes de arte do mundo, incluindo a Capela Sistina com os afrescos de Michelangelo. A Bas√≠lica de S√£o Pedro impressiona com sua arquitetura renascentista e barroca, a Piet√† de Michelangelo e a c√∫pula projetada pelo mesmo artista. Uma experi√™ncia espiritual e art√≠stica √∫nica.\",\n      location: \"Roma, It√°lia\",\n      category: \"culture\",\n      city: \"Roma\",\n      countryType: \"internacional\",\n      region: \"Europa Meridional\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"3-4 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 40,\n      languages: JSON.stringify([\"Italiano\", \"Ingl√™s\", \"Espanhol\", \"Franc√™s\", \"Alem√£o\", \"Portugu√™s\"]),\n      inclusions: JSON.stringify([\"Entrada nos Museus Vaticanos\", \"Capela Sistina\", \"Bas√≠lica de S√£o Pedro\", \"Audioguia\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Acesso √† c√∫pula\", \"Jardins Vaticanos\"]),\n      requirements: JSON.stringify([\"Vestu√°rio adequado\", \"Ombros e joelhos cobertos\", \"Sil√™ncio na Capela Sistina\", \"Documento de identidade\"]),\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes da visita\",\n      contactInfo: JSON.stringify({\n        phone: \"+39 06 6988 4676\",\n        email: \"info@museivaticani.va\",\n        website: \"https://www.museivaticani.va\",\n        address: \"Viale Vaticano, 00165 Roma RM\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1544133503-59b8e7e58e32?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1591194658578-1b4c1e4c4b7c?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Fontana di Trevi e Centro Hist√≥rico\",\n      description: \"Descubra as maravilhas do centro hist√≥rico de Roma! A ic√¥nica Fontana di Trevi, obra-prima barroca de Nicola Salvi, √© famosa pela tradi√ß√£o de jogar moedas para garantir o retorno √† Cidade Eterna. Explore o Pantheon, a Piazza Navona com suas fontes de Bernini, o Campo de' Fiori e as ruas medievais repletas de hist√≥ria. Uma jornada atrav√©s de 2.000 anos de civiliza√ß√£o romana.\",\n      location: \"Roma, It√°lia\",\n      category: \"sightseeing\",\n      city: \"Roma\",\n      countryType: \"internacional\",\n      region: \"Europa Meridional\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"2-3 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 30,\n      languages: JSON.stringify([\"Italiano\", \"Ingl√™s\", \"Espanhol\", \"Franc√™s\", \"Alem√£o\", \"Portugu√™s\"]),\n      inclusions: JSON.stringify([\"Fontana di Trevi\", \"Pantheon\", \"Piazza Navona\", \"Campo de' Fiori\", \"Centro hist√≥rico\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Guia tur√≠stico\", \"Entradas em monumentos\"]),\n      requirements: JSON.stringify([\"Cal√ßado confort√°vel\", \"√Ågua\", \"Protetor solar\", \"Moedas para a fonte\"]),\n      cancellationPolicy: \"Passeio ao ar livre - sem necessidade de cancelamento\",\n      contactInfo: JSON.stringify({\n        phone: \"+39 06 0608\",\n        email: \"info@turismoroma.it\",\n        website: \"https://www.turismoroma.it\",\n        address: \"Centro Storico, Roma RM\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1515542622106-78bda8ba0e5b?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1515542622106-78bda8ba0e5b?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1552832230-c0197dd311b5?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1546549032-9571cd6b27df?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Pante√£o de Roma - Templo dos Deuses\",\n      description: \"Admire a maior maravilha arquitet√¥nica da Roma Antiga! O Pante√£o, constru√≠do em 126 d.C. pelo imperador Adriano, mant√©m-se como o edif√≠cio romano mais bem preservado do mundo. Sua c√∫pula impressionante com √≥culo central √© uma obra-prima da engenharia que inspirou arquitetos por s√©culos. Hoje funciona como igreja e abriga os t√∫mulos de Rafael e dos reis da It√°lia.\",\n      location: \"Roma, It√°lia\",\n      category: \"culture\",\n      city: \"Roma\",\n      countryType: \"internacional\",\n      region: \"Europa Meridional\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"1-2 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 50,\n      languages: JSON.stringify([\"Italiano\", \"Ingl√™s\", \"Espanhol\", \"Franc√™s\", \"Alem√£o\", \"Portugu√™s\"]),\n      inclusions: JSON.stringify([\"Entrada no Pante√£o\", \"Arquitetura romana\", \"T√∫mulo de Rafael\", \"C√∫pula hist√≥rica\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Guia tur√≠stico\", \"Audioguia\"]),\n      requirements: JSON.stringify([\"Vestu√°rio adequado\", \"Sil√™ncio no interior\", \"Respeito ao local sagrado\"]),\n      cancellationPolicy: \"Entrada gratuita - sem necessidade de cancelamento\",\n      contactInfo: JSON.stringify({\n        phone: \"+39 06 6830 0230\",\n        email: \"info@pantheonroma.com\",\n        website: \"https://www.pantheonroma.com\",\n        address: \"Piazza della Rotonda, 00186 Roma RM\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1546549032-9571cd6b27df?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1546549032-9571cd6b27df?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1539650116574-75c0c6d47324?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1544431369-dccdb9dc8c16?w=800&q=80\"\n      ]),\n      createdById: 1\n    },\n    {\n      title: \"Trastevere - Bairro Bo√™mio Aut√™ntico\",\n      description: \"Mergulhe na alma aut√™ntica de Roma no charmoso bairro de Trastevere! Este bairro medieval mant√©m o esp√≠rito da Roma tradicional com suas ruas de paralelep√≠pedos, trattorias familiares, vinhos locais e vida noturna vibrante. Explore a Basilica di Santa Maria in Trastevere, desfrute da gastronomia romana em osterie centen√°rias e viva como um verdadeiro romano neste ref√∫gio bo√™mio.\",\n      location: \"Roma, It√°lia\",\n      category: \"food_tours\",\n      city: \"Roma\",\n      countryType: \"internacional\",\n      region: \"Europa Meridional\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"2-4 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 20,\n      languages: JSON.stringify([\"Italiano\", \"Ingl√™s\", \"Espanhol\", \"Franc√™s\", \"Alem√£o\", \"Portugu√™s\"]),\n      inclusions: JSON.stringify([\"Passeio pelo bairro\", \"Ruas hist√≥ricas\", \"Basilica di Santa Maria\", \"Atmosfera aut√™ntica\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\", \"Bebidas\", \"Guia tur√≠stico\"]),\n      requirements: JSON.stringify([\"Cal√ßado confort√°vel\", \"Vestu√°rio casual\", \"Disposi√ß√£o para caminhar\"]),\n      cancellationPolicy: \"Passeio ao ar livre - sem necessidade de cancelamento\",\n      contactInfo: JSON.stringify({\n        phone: \"+39 06 0608\",\n        email: \"info@trastevereroma.it\",\n        website: \"https://www.trastevereroma.it\",\n        address: \"Trastevere, Roma RM\"\n      }),\n      coverImage: \"https://images.unsplash.com/photo-1544133503-59b8e7e58e32?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1544133503-59b8e7e58e32?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1515542622106-78bda8ba0e5b?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1552832230-c0197dd311b5?w=800&q=80\"\n      ]),\n      createdById: 1\n    }\n  ];\n\n  // Budget proposals for each activity\n  const budgetProposals = [\n    // Coliseu proposals\n    {\n      activityTitle: \"Coliseu - Anfiteatro Romano\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada Padr√£o\",\n          description: \"Entrada b√°sica com acesso ao Coliseu, F√≥rum Romano e Palatino Hill.\",\n          amount: \"16.00\",\n          inclusions: [\"Entrada no Coliseu\", \"F√≥rum Romano\", \"Palatino Hill\", \"Audioguia b√°sico\"],\n          exclusions: [\"Tour guiado\", \"Acesso √† arena\", \"Subterr√¢neos\", \"Evite filas\"]\n        },\n        {\n          title: \"Completo - Tour Guiado em Grupo\",\n          description: \"Tour em grupo com guia especializado cobrindo hist√≥ria e arquitetura romana.\",\n          amount: \"40.00\",\n          inclusions: [\"Tour guiado 2h\", \"Entrada completa\", \"Guia especializado\", \"Grupo pequeno\"],\n          exclusions: [\"Tour privado\", \"Acesso VIP\", \"Alimenta√ß√£o\", \"Transporte\"]\n        },\n        {\n          title: \"Premium - Tour Privativo + Acesso Exclusivo\",\n          description: \"Tour privativo com acesso √† arena e subterr√¢neos. Experi√™ncia VIP completa.\",\n          amount: \"150.00\",\n          inclusions: [\"Tour privado\", \"Acesso √† arena\", \"Subterr√¢neos\", \"Guia especializado\", \"Evite filas\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Fotografias profissionais\", \"Souvenirs\"]\n        }\n      ]\n    },\n    // Vaticano proposals\n    {\n      activityTitle: \"Vaticano e Bas√≠lica de S√£o Pedro\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada Simples\",\n          description: \"Entrada b√°sica nos Museus Vaticanos e Bas√≠lica de S√£o Pedro.\",\n          amount: \"17.00\",\n          inclusions: [\"Museus Vaticanos\", \"Capela Sistina\", \"Bas√≠lica de S√£o Pedro\", \"Audioguia\"],\n          exclusions: [\"Tour guiado\", \"Acesso √† c√∫pula\", \"Jardins Vaticanos\", \"Evite filas\"]\n        },\n        {\n          title: \"Completo - Tour com Museus\",\n          description: \"Tour completo com guia especializado cobrindo arte e hist√≥ria vaticana.\",\n          amount: \"50.00\",\n          inclusions: [\"Tour guiado 3h\", \"Museus completos\", \"Capela Sistina\", \"Guia especializado\"],\n          exclusions: [\"Acesso √† c√∫pula\", \"Tour privado\", \"Jardins\", \"Alimenta√ß√£o\"]\n        },\n        {\n          title: \"Premium - Tour VIP + C√∫pula\",\n          description: \"Tour VIP com acesso √† c√∫pula de S√£o Pedro e jardins exclusivos.\",\n          amount: \"120.00\",\n          inclusions: [\"Tour VIP\", \"Acesso √† c√∫pula\", \"Jardins Vaticanos\", \"Guia especializado\", \"Evite filas\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Fotografias\", \"Souvenirs\"]\n        }\n      ]\n    },\n    // Fontana di Trevi proposals\n    {\n      activityTitle: \"Fontana di Trevi e Centro Hist√≥rico\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Passeio Livre\",\n          description: \"Explore o centro hist√≥rico por conta pr√≥pria. Acesso gratuito a todos os locais.\",\n          amount: \"0.00\",\n          inclusions: [\"Acesso livre\", \"Fontana di Trevi\", \"Pantheon\", \"Piazza Navona\", \"Ruas hist√≥ricas\"],\n          exclusions: [\"Guia tur√≠stico\", \"Transporte\", \"Alimenta√ß√£o\", \"Entradas pagas\"]\n        },\n        {\n          title: \"Completo - Tour Guiado\",\n          description: \"Tour guiado pelo centro hist√≥rico com contexto hist√≥rico e cultural.\",\n          amount: \"30.00\",\n          inclusions: [\"Tour guiado 2h\", \"Fontana di Trevi\", \"Pantheon\", \"Piazza Navona\", \"Hist√≥rias locais\"],\n          exclusions: [\"Alimenta√ß√£o\", \"Transporte\", \"Entradas pagas\", \"Souvenirs\"]\n        },\n        {\n          title: \"Premium - Tour Privativo + Jantar\",\n          description: \"Tour privativo com jantar tradicional romano em restaurante hist√≥rico.\",\n          amount: \"100.00\",\n          inclusions: [\"Tour privado\", \"Guia especializado\", \"Jantar t√≠pico\", \"Vinho local\", \"Restaurante hist√≥rico\"],\n          exclusions: [\"Transporte\", \"Bebidas extras\", \"Gorjetas\", \"Sobremesas especiais\"]\n        }\n      ]\n    },\n    // Pante√£o proposals\n    {\n      activityTitle: \"Pante√£o de Roma - Templo dos Deuses\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada Gratuita\",\n          description: \"Entrada gratuita para admirar a arquitetura romana por conta pr√≥pria.\",\n          amount: \"0.00\",\n          inclusions: [\"Entrada gratuita\", \"Arquitetura romana\", \"T√∫mulo de Rafael\", \"C√∫pula hist√≥rica\"],\n          exclusions: [\"Guia tur√≠stico\", \"Audioguia\", \"Transporte\", \"Alimenta√ß√£o\"]\n        },\n        {\n          title: \"Completo - Tour Guiado\",\n          description: \"Tour guiado com explica√ß√µes sobre arquitetura e hist√≥ria romana.\",\n          amount: \"20.00\",\n          inclusions: [\"Tour guiado 1h\", \"Hist√≥ria romana\", \"Arquitetura\", \"Guia especializado\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Audioguia pessoal\", \"Souvenirs\"]\n        },\n        {\n          title: \"Premium - Tour Exclusivo\",\n          description: \"Tour exclusivo com arque√≥logo especializado em Roma Antiga.\",\n          amount: \"80.00\",\n          inclusions: [\"Tour exclusivo\", \"Arque√≥logo especializado\", \"Grupo pequeno\", \"Detalhes t√©cnicos\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Fotografias profissionais\", \"Souvenirs\"]\n        }\n      ]\n    },\n    // Trastevere proposals\n    {\n      activityTitle: \"Trastevere - Bairro Bo√™mio Aut√™ntico\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Passeio Livre\",\n          description: \"Explore o bairro bo√™mio por conta pr√≥pria. Acesso gratuito √†s ruas hist√≥ricas.\",\n          amount: \"0.00\",\n          inclusions: [\"Passeio livre\", \"Ruas hist√≥ricas\", \"Basilica di Santa Maria\", \"Atmosfera aut√™ntica\"],\n          exclusions: [\"Guia tur√≠stico\", \"Alimenta√ß√£o\", \"Bebidas\", \"Transporte\"]\n        },\n        {\n          title: \"Completo - Tour Gastron√¥mico\",\n          description: \"Tour gastron√¥mico com degusta√ß√µes em trattorias tradicionais.\",\n          amount: \"50.00\",\n          inclusions: [\"Tour gastron√¥mico\", \"Degusta√ß√µes\", \"Trattorias tradicionais\", \"Vinhos locais\", \"Guia local\"],\n          exclusions: [\"Refei√ß√£o completa\", \"Transporte\", \"Bebidas extras\", \"Gorjetas\"]\n        },\n        {\n          title: \"Premium - Tour Privado + Jantar Gourmet\",\n          description: \"Tour privado com jantar gourmet em restaurante exclusivo de Trastevere.\",\n          amount: \"120.00\",\n          inclusions: [\"Tour privado\", \"Jantar gourmet\", \"Restaurante exclusivo\", \"Vinho premium\", \"Guia especializado\"],\n          exclusions: [\"Transporte\", \"Bebidas extras\", \"Gorjetas\", \"Sobremesas especiais\"]\n        }\n      ]\n    }\n  ];\n\n  try {\n    // Insert activities first\n    for (const activity of romeActivities) {\n      try {\n        const [insertedActivity] = await db.insert(activities).values({\n          ...activity,\n          isActive: true\n        });\n        console.log(`‚úÖ Atividade criada: ${activity.title}`);\n      } catch (insertError: any) {\n        if (insertError.code === 'ER_DUP_ENTRY') {\n          console.log(`‚ÑπÔ∏è Atividade j√° existe: ${activity.title}`);\n        } else {\n          console.error(`‚ùå Erro ao criar ${activity.title}:`, insertError.message);\n        }\n      }\n    }\n\n    // Then insert budget proposals\n    for (const budgetGroup of budgetProposals) {\n      // Find the activity ID\n      const [activityResult] = await db.select()\n        .from(activities)\n        .where(sql`title = ${budgetGroup.activityTitle}`)\n        .limit(1);\n\n      if (activityResult) {\n        for (const proposal of budgetGroup.proposals) {\n          try {\n            await db.insert(activityBudgetProposals).values({\n              activityId: activityResult.id,\n              createdBy: 1,\n              title: proposal.title,\n              description: proposal.description,\n              amount: proposal.amount,\n              currency: \"EUR\",\n              inclusions: JSON.stringify(proposal.inclusions),\n              exclusions: JSON.stringify(proposal.exclusions),\n              isActive: true\n            });\n            console.log(`  üí∞ Proposta criada: ${proposal.title}`);\n          } catch (proposalError: any) {\n            if (proposalError.code === 'ER_DUP_ENTRY') {\n              console.log(`  ‚ÑπÔ∏è Proposta j√° existe: ${proposal.title}`);\n            } else {\n              console.error(`  ‚ùå Erro ao criar proposta:`, proposalError.message);\n            }\n          }\n        }\n      }\n    }\n\n    console.log(\"üéâ Atividades de Roma criadas com sucesso!\");\n\n  } catch (error) {\n    console.error(\"‚ùå Erro geral:\", error);\n  }\n}\n\n// Execute the function\naddRomeActivities().catch(console.error);","size_bytes":18737},"server/add-sample-activities.ts":{"content":"import { db } from './db.js';\nimport { sql } from 'drizzle-orm';\n\nasync function addSampleActivities() {\n  console.log('üå± Criando propostas de or√ßamento para todas as atividades...');\n\n  try {\n    // 1. Verificar se a tabela activity_budget_proposals existe e criar se necess√°rio\n    console.log('üîß Verificando/criando estrutura de propostas...');\n    \n    await db.execute(sql`\n      CREATE TABLE IF NOT EXISTS activity_budget_proposals (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        activity_id INT NOT NULL,\n        created_by INT DEFAULT NULL,\n        title VARCHAR(255) NOT NULL,\n        description TEXT,\n        price_type VARCHAR(50) DEFAULT 'per_person' NOT NULL,\n        amount DECIMAL(10,2),\n        currency VARCHAR(10) DEFAULT 'BRL' NOT NULL,\n        inclusions JSON,\n        exclusions JSON,\n        valid_until TIMESTAMP NULL,\n        is_active BOOLEAN DEFAULT TRUE NOT NULL,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n        FOREIGN KEY (activity_id) REFERENCES activities(id) ON DELETE CASCADE\n      )\n    `);\n\n    console.log('‚úÖ Estrutura da tabela verificada');\n\n    // 2. Limpar propostas existentes e criar novas\n    await db.execute(sql`DELETE FROM activity_budget_proposals`);\n    console.log('üßπ Propostas existentes removidas');\n\n    // 3. Obter atividades ativas\n    const activities = await db.execute(sql`\n      SELECT id, title, location FROM activities \n      WHERE is_active = TRUE AND title IS NOT NULL \n      ORDER BY id\n    `);\n    \n    console.log(`üìä Encontradas ${activities.length} atividades para criar propostas`);\n\n    // 4. Criar propostas espec√≠ficas para atividades conhecidas\n    const proposalsByActivity = {\n      'Cristo Redentor / Corcovado': [\n        {\n          title: 'Van Oficial',\n          description: 'Transporte em van oficial at√© o Cristo Redentor com entrada inclu√≠da',\n          amount: 85.00,\n          inclusions: ['Transporte em van oficial', 'Entrada para o monumento', 'Seguro de viagem'],\n          exclusions: ['Alimenta√ß√£o', 'Bebidas', 'Compras pessoais']\n        },\n        {\n          title: 'Trem do Corcovado',\n          description: 'Experi√™ncia completa com trem hist√≥rico e guia especializado',\n          amount: 160.00,\n          inclusions: ['Trem do Corcovado ida e volta', 'Entrada para o monumento', 'Guia tur√≠stico', 'Material informativo'],\n          exclusions: ['Bebidas alco√≥licas', 'Compras pessoais']\n        },\n        {\n          title: 'Tour Premium VIP',\n          description: 'Tour privativo com transporte executivo e fotografia profissional',\n          amount: 320.00,\n          inclusions: ['Transporte privativo executivo', 'Guia exclusivo bil√≠ngue', 'Entrada VIP', 'Sess√£o de fotos profissional'],\n          exclusions: ['Compras pessoais']\n        }\n      ],\n      'P√£o de A√ß√∫car (Bondinho)': [\n        {\n          title: 'Ingresso Padr√£o',\n          description: 'Bondinho ida e volta com acesso aos dois morros',\n          amount: 120.00,\n          inclusions: ['Bondinho ida e volta', 'Acesso aos mirantes', 'Mapa tur√≠stico'],\n          exclusions: ['Alimenta√ß√£o', 'Bebidas', 'Fotos profissionais']\n        },\n        {\n          title: 'Experi√™ncia Guiada',\n          description: 'Bondinho com guia especializado e material educativo',\n          amount: 190.00,\n          inclusions: ['Bondinho ida e volta', 'Guia tur√≠stico especializado', 'Material informativo', 'Bin√≥culo'],\n          exclusions: ['Bebidas alco√≥licas', 'Fotos profissionais']\n        },\n        {\n          title: 'Experi√™ncia Completa',\n          description: 'Bondinho + voo panor√¢mico de helic√≥ptero + jantar',\n          amount: 650.00,\n          inclusions: ['Bondinho ida e volta', 'Voo de helic√≥ptero 15 min', 'Jantar com vista panor√¢mica', 'Fotos a√©reas'],\n          exclusions: ['Compras pessoais', 'Bebidas premium']\n        }\n      ],\n      'Praia de Copacabana / Ipanema + Esportes': [\n        {\n          title: 'Aula de Surf B√°sica',\n          description: 'Aula de surf com instrutor certificado na praia',\n          amount: 100.00,\n          inclusions: ['Aula de surf 2h', 'Prancha', 'Lycra', 'Instrutor certificado'],\n          exclusions: ['Transporte', 'Alimenta√ß√£o', 'Bebidas']\n        },\n        {\n          title: 'Dia Completo de Esportes',\n          description: 'Surf + v√¥lei de praia + bike tour pela orla',\n          amount: 180.00,\n          inclusions: ['Aula de surf', 'V√¥lei de praia', 'Bike tour 2h', 'Todos os equipamentos', 'Instrutor'],\n          exclusions: ['Refei√ß√µes', 'Bebidas alco√≥licas']\n        },\n        {\n          title: 'Experi√™ncia Premium',\n          description: 'Aulas privadas + almo√ßo frente ao mar + massagem relaxante',\n          amount: 350.00,\n          inclusions: ['Aulas privadas personalizadas', 'Almo√ßo frente ao mar', 'Massagem relaxante 30min', 'Bebidas inclu√≠das'],\n          exclusions: ['Compras pessoais', 'Gorjetas']\n        }\n      ],\n      'MASP + Avenida Paulista': [\n        {\n          title: 'Entrada Livre',\n          description: 'Visita livre ao MASP com mapa autoguiado',\n          amount: 40.00,\n          inclusions: ['Entrada do MASP', 'Mapa autoguiado', 'Guarda-volumes'],\n          exclusions: ['Guia tur√≠stico', 'Audioguia', 'Transporte']\n        },\n        {\n          title: 'Tour Cultural Guiado',\n          description: 'MASP + Paulista com guia especializado em arte',\n          amount: 75.00,\n          inclusions: ['Entrada do MASP', 'Guia especializado em arte', 'Tour pela Avenida Paulista', 'Material educativo'],\n          exclusions: ['Transporte', 'Alimenta√ß√£o']\n        },\n        {\n          title: 'Experi√™ncia Cultural Completa',\n          description: 'MASP + Paulista + Pinacoteca com almo√ßo cultural',\n          amount: 120.00,\n          inclusions: ['MASP', 'Avenida Paulista', 'Pinacoteca do Estado', 'Guia especializado', 'Almo√ßo cultural', 'Transporte'],\n          exclusions: ['Compras pessoais', 'Bebidas extras']\n        }\n      ],\n      'Pelourinho + Elevador Lacerda': [\n        {\n          title: 'Caminhada Hist√≥rica',\n          description: 'Tour a p√© pelo centro hist√≥rico de Salvador',\n          amount: 60.00,\n          inclusions: ['Tour guiado 3h', 'Elevador Lacerda', 'Entrada igrejas principais', 'Material informativo'],\n          exclusions: ['Alimenta√ß√£o', 'Bebidas', 'Compras']\n        },\n        {\n          title: 'Experi√™ncia Cultural',\n          description: 'Tour hist√≥rico + show de capoeira + degusta√ß√£o t√≠pica',\n          amount: 120.00,\n          inclusions: ['Tour guiado completo', 'Show de capoeira', 'Degusta√ß√£o de comidas t√≠picas', 'Aula b√°sica de capoeira'],\n          exclusions: ['Bebidas alco√≥licas', 'Compras pessoais']\n        },\n        {\n          title: 'Viv√™ncia Completa',\n          description: 'Tour + oficinas + almo√ßo t√≠pico + apresenta√ß√£o folcl√≥rica',\n          amount: 200.00,\n          inclusions: ['Tour hist√≥rico completo', 'Oficina de artesanato', 'Almo√ßo baiano completo', 'Apresenta√ß√£o folcl√≥rica', 'Aula de samba de roda'],\n          exclusions: ['Compras pessoais', 'Gorjetas']\n        }\n      ],\n      'Cataratas do Igua√ßu (lado brasileiro)': [\n        {\n          title: 'Entrada B√°sica do Parque',\n          description: 'Acesso ao parque com trilha panor√¢mica principal',\n          amount: 85.00,\n          inclusions: ['Entrada do Parque Nacional', 'Trilha panor√¢mica', '√înibus interno', 'Mapa do parque'],\n          exclusions: ['Transporte at√© o parque', 'Alimenta√ß√£o', 'Atividades extras']\n        },\n        {\n          title: 'Tour Completo Guiado',\n          description: 'Parque + transporte + guia especializado + equipamentos',\n          amount: 150.00,\n          inclusions: ['Entrada do parque', 'Transporte ida/volta', 'Guia especializado', 'Capa de chuva', 'Bin√≥culo'],\n          exclusions: ['Refei√ß√µes', 'Bebidas', 'Souvenirs']\n        },\n        {\n          title: 'Experi√™ncia Premium A√©rea',\n          description: 'Tour completo + voo panor√¢mico de helic√≥ptero + almo√ßo',\n          amount: 450.00,\n          inclusions: ['Tour completo terrestre', 'Voo de helic√≥ptero 10min', 'Almo√ßo com vista', 'Fotos a√©reas profissionais', 'Transfer executivo'],\n          exclusions: ['Compras pessoais', 'Bebidas premium']\n        }\n      ]\n    };\n\n    // 5. Criar propostas para cada atividade\n    for (const activity of activities) {\n      console.log(`üí° Criando propostas para: ${activity.title}`);\n      \n      let proposals = proposalsByActivity[activity.title];\n      \n      // Se n√£o tem propostas espec√≠ficas, criar propostas gen√©ricas\n      if (!proposals) {\n        const basePrice = Math.floor(Math.random() * 80) + 50; // Entre 50-130\n        proposals = [\n          {\n            title: 'Op√ß√£o B√°sica',\n            description: 'Experi√™ncia padr√£o da atividade com o essencial',\n            amount: basePrice,\n            inclusions: ['Atividade principal', 'Equipamentos b√°sicos', 'Seguro b√°sico'],\n            exclusions: ['Alimenta√ß√£o', 'Bebidas', 'Transporte']\n          },\n          {\n            title: 'Op√ß√£o Completa',\n            description: 'Experi√™ncia com guia especializado e comodidades extras',\n            amount: Math.floor(basePrice * 1.8),\n            inclusions: ['Atividade principal', 'Guia especializado', 'Equipamentos completos', 'Lanche', 'Material informativo'],\n            exclusions: ['Bebidas alco√≥licas', 'Compras pessoais']\n          },\n          {\n            title: 'Op√ß√£o Premium',\n            description: 'Experi√™ncia exclusiva e totalmente personalizada',\n            amount: Math.floor(basePrice * 3.2),\n            inclusions: ['Experi√™ncia privativa', 'Guia exclusivo', 'Transporte inclu√≠do', 'Refei√ß√£o completa', 'Fotografia profissional'],\n            exclusions: ['Compras pessoais', 'Gorjetas']\n          }\n        ];\n      }\n      \n      // Inserir propostas na base de dados\n      for (const proposal of proposals) {\n        await db.execute(sql`\n          INSERT INTO activity_budget_proposals \n          (activity_id, title, description, amount, currency, inclusions, exclusions, price_type, is_active) \n          VALUES \n          (${activity.id}, ${proposal.title}, ${proposal.description}, ${proposal.amount}, 'BRL', \n           ${JSON.stringify(proposal.inclusions)}, ${JSON.stringify(proposal.exclusions)}, 'per_person', true)\n        `);\n      }\n    }\n\n    // 6. Verificar resultados\n    const totalProposals = await db.execute(sql`SELECT COUNT(*) as count FROM activity_budget_proposals`);\n    console.log(`‚úÖ ${totalProposals[0].count} propostas de or√ßamento criadas com sucesso!`);\n\n    // 7. Mostrar algumas propostas criadas\n    const sampleProposals = await db.execute(sql`\n      SELECT abp.title, abp.amount, a.title as activity_title \n      FROM activity_budget_proposals abp \n      JOIN activities a ON abp.activity_id = a.id \n      LIMIT 5\n    `);\n    \n    console.log('\\nüìã Exemplos de propostas criadas:');\n    sampleProposals.forEach(p => {\n      console.log(`   ${p.activity_title}: ${p.title} - R$ ${p.amount}`);\n    });\n\n    console.log('\\nüéâ Sistema de propostas de or√ßamento completamente implementado!');\n\n  } catch (error) {\n    console.error('‚ùå Erro ao criar propostas:', error);\n    throw error;\n  }\n}\n\n// Executar se chamado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  addSampleActivities()\n    .then(() => {\n      console.log('‚úÖ Processo conclu√≠do!');\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('‚ùå Erro no processo:', error);\n      process.exit(1);\n    });\n}","size_bytes":11731},"server/add-sample-reviews.ts":{"content":"import { db } from './db.js';\nimport { sql } from 'drizzle-orm';\n\nasync function addSampleReviews() {\n  console.log('üå± Criando propostas de or√ßamento e avalia√ß√µes com dados diretos...');\n\n  try {\n    // 1. Criar tabelas se n√£o existirem\n    console.log('üîß Criando estrutura das tabelas...');\n    \n    await db.execute(sql`\n      CREATE TABLE IF NOT EXISTS activity_budget_proposals (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        activity_id INT NOT NULL,\n        created_by INT DEFAULT NULL,\n        title VARCHAR(255) NOT NULL,\n        description TEXT,\n        price_type VARCHAR(50) DEFAULT 'per_person' NOT NULL,\n        amount DECIMAL(10,2),\n        currency VARCHAR(10) DEFAULT 'BRL' NOT NULL,\n        inclusions JSON,\n        exclusions JSON,\n        valid_until TIMESTAMP NULL,\n        is_active BOOLEAN DEFAULT TRUE NOT NULL,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n        INDEX (activity_id)\n      )\n    `);\n\n    await db.execute(sql`\n      CREATE TABLE IF NOT EXISTS activity_reviews (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        activity_id INT NOT NULL,\n        user_id INT NOT NULL,\n        rating INT NOT NULL CHECK (rating >= 1 AND rating <= 5),\n        comment TEXT,\n        visit_date DATE,\n        photos JSON,\n        is_verified BOOLEAN DEFAULT FALSE NOT NULL,\n        helpful_votes INT DEFAULT 0 NOT NULL,\n        is_hidden BOOLEAN DEFAULT FALSE NOT NULL,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n        INDEX (activity_id),\n        INDEX (user_id)\n      )\n    `);\n\n    console.log('‚úÖ Estrutura das tabelas criada');\n\n    // 2. Limpar dados existentes\n    await db.execute(sql`DELETE FROM activity_budget_proposals`);\n    await db.execute(sql`DELETE FROM activity_reviews`);\n    console.log('üßπ Dados antigos removidos');\n\n    // 3. Criar propostas de or√ßamento com IDs espec√≠ficos das atividades\n    console.log('üí∞ Criando propostas de or√ßamento...');\n    \n    // IDs das atividades que sabemos que existem (de 1 a 14)\n    const activityProposals = [\n      // Atividade 1 - Passeio de Catamaran em B√∫zios\n      { activityId: 1, title: 'B√°sico', description: 'Passeio b√°sico de catamaran', amount: 95, inclusions: '[\"Passeio de catamaran\", \"Equipamentos\"]', exclusions: '[\"Alimenta√ß√£o\", \"Bebidas\"]' },\n      { activityId: 1, title: 'Completo', description: 'Passeio com almo√ßo e bebidas', amount: 170, inclusions: '[\"Passeio\", \"Almo√ßo\", \"Bebidas\"]', exclusions: '[\"Compras pessoais\"]' },\n      { activityId: 1, title: 'Premium', description: 'Passeio privativo com chef', amount: 304, inclusions: '[\"Passeio privativo\", \"Chef\", \"Bebidas premium\"]', exclusions: '[\"Gorjetas\"]' },\n\n      // Atividade 2 - Trilha no Pico da Bandeira\n      { activityId: 2, title: 'B√°sico', description: 'Trilha b√°sica com guia', amount: 70, inclusions: '[\"Guia\", \"Equipamentos b√°sicos\"]', exclusions: '[\"Alimenta√ß√£o\", \"Transporte\"]' },\n      { activityId: 2, title: 'Completo', description: 'Trilha com refei√ß√µes e transporte', amount: 126, inclusions: '[\"Guia\", \"Refei√ß√µes\", \"Transporte\"]', exclusions: '[\"Equipamentos especiais\"]' },\n      { activityId: 2, title: 'Premium', description: 'Trilha VIP com acampamento', amount: 224, inclusions: '[\"Guia privativo\", \"Acampamento\", \"Todas as refei√ß√µes\"]', exclusions: '[\"Compras pessoais\"]' },\n\n      // Atividade 3 - City Tour Ouro Preto\n      { activityId: 3, title: 'B√°sico', description: 'Tour b√°sico pelo centro hist√≥rico', amount: 55, inclusions: '[\"Tour guiado\", \"Entrada museus\"]', exclusions: '[\"Alimenta√ß√£o\", \"Transporte\"]' },\n      { activityId: 3, title: 'Completo', description: 'Tour com almo√ßo t√≠pico', amount: 99, inclusions: '[\"Tour completo\", \"Almo√ßo t√≠pico\", \"Transporte\"]', exclusions: '[\"Compras\"]' },\n      { activityId: 3, title: 'Premium', description: 'Tour privativo com degusta√ß√£o', amount: 176, inclusions: '[\"Tour privativo\", \"Degusta√ß√£o cacha√ßa\", \"Transfer executivo\"]', exclusions: '[\"Gorjetas\"]' },\n\n      // Atividade 4 - Rafting\n      { activityId: 4, title: 'B√°sico', description: 'Rafting b√°sico com equipamentos', amount: 85, inclusions: '[\"Rafting\", \"Equipamentos\", \"Seguro\"]', exclusions: '[\"Alimenta√ß√£o\", \"Transporte\"]' },\n      { activityId: 4, title: 'Completo', description: 'Rafting com almo√ßo e transporte', amount: 153, inclusions: '[\"Rafting\", \"Almo√ßo\", \"Transporte\", \"Instrutor\"]', exclusions: '[\"Bebidas alco√≥licas\"]' },\n      { activityId: 4, title: 'Premium', description: 'Rafting VIP com fotografia', amount: 272, inclusions: '[\"Rafting exclusivo\", \"Fotografia\", \"Refei√ß√£o completa\"]', exclusions: '[\"Compras pessoais\"]' },\n\n      // Atividade 9 - Cristo Redentor\n      { activityId: 9, title: 'Van Oficial', description: 'Transporte em van oficial', amount: 85, inclusions: '[\"Van oficial\", \"Entrada\"]', exclusions: '[\"Alimenta√ß√£o\", \"Bebidas\"]' },\n      { activityId: 9, title: 'Trem do Corcovado', description: 'Trem + guia tur√≠stico', amount: 160, inclusions: '[\"Trem\", \"Guia\", \"Entrada\"]', exclusions: '[\"Bebidas alco√≥licas\"]' },\n      { activityId: 9, title: 'Tour Premium', description: 'Tour privativo VIP', amount: 320, inclusions: '[\"Transporte privativo\", \"Guia exclusivo\", \"Fotos\"]', exclusions: '[\"Compras pessoais\"]' },\n\n      // Atividade 10 - P√£o de A√ß√∫car\n      { activityId: 10, title: 'Ingresso Padr√£o', description: 'Bondinho ida e volta', amount: 120, inclusions: '[\"Bondinho\", \"Mirantes\"]', exclusions: '[\"Alimenta√ß√£o\", \"Fotos\"]' },\n      { activityId: 10, title: 'Com Guia', description: 'Bondinho com guia especializado', amount: 190, inclusions: '[\"Bondinho\", \"Guia\", \"Material\"]', exclusions: '[\"Fotos profissionais\"]' },\n      { activityId: 10, title: 'Experi√™ncia VIP', description: 'Bondinho + helic√≥ptero + jantar', amount: 650, inclusions: '[\"Bondinho\", \"Helic√≥ptero\", \"Jantar\"]', exclusions: '[\"Compras pessoais\"]' },\n\n      // Atividade 11 - Copacabana/Ipanema\n      { activityId: 11, title: 'Aula de Surf', description: 'Aula b√°sica com instrutor', amount: 100, inclusions: '[\"Aula surf\", \"Prancha\", \"Instrutor\"]', exclusions: '[\"Transporte\", \"Alimenta√ß√£o\"]' },\n      { activityId: 11, title: 'Dia Completo', description: 'Surf + v√¥lei + bike tour', amount: 180, inclusions: '[\"Surf\", \"V√¥lei\", \"Bike tour\"]', exclusions: '[\"Refei√ß√µes\"]' },\n      { activityId: 11, title: 'Premium', description: 'Aulas privadas + spa', amount: 350, inclusions: '[\"Aulas privadas\", \"Spa\", \"Almo√ßo\"]', exclusions: '[\"Gorjetas\"]' },\n\n      // Atividade 12 - MASP\n      { activityId: 12, title: 'Entrada Livre', description: 'Visita livre ao museu', amount: 40, inclusions: '[\"Entrada MASP\"]', exclusions: '[\"Guia\", \"Transporte\"]' },\n      { activityId: 12, title: 'Tour Guiado', description: 'MASP + Paulista com guia', amount: 75, inclusions: '[\"MASP\", \"Guia\", \"Paulista\"]', exclusions: '[\"Transporte\"]' },\n      { activityId: 12, title: 'Cultural Completo', description: 'MASP + Pinacoteca + almo√ßo', amount: 120, inclusions: '[\"MASP\", \"Pinacoteca\", \"Almo√ßo\", \"Transporte\"]', exclusions: '[\"Compras\"]' },\n\n      // Atividade 13 - Pelourinho\n      { activityId: 13, title: 'Caminhada Hist√≥rica', description: 'Tour a p√© pelo centro', amount: 60, inclusions: '[\"Tour\", \"Elevador Lacerda\"]', exclusions: '[\"Alimenta√ß√£o\", \"Bebidas\"]' },\n      { activityId: 13, title: 'Cultural', description: 'Tour + capoeira + degusta√ß√£o', amount: 120, inclusions: '[\"Tour\", \"Capoeira\", \"Degusta√ß√£o\"]', exclusions: '[\"Compras\"]' },\n      { activityId: 13, title: 'Viv√™ncia Completa', description: 'Tour + oficinas + almo√ßo', amount: 200, inclusions: '[\"Tour completo\", \"Oficinas\", \"Almo√ßo baiano\"]', exclusions: '[\"Gorjetas\"]' },\n\n      // Atividade 14 - Cataratas\n      { activityId: 14, title: 'Entrada B√°sica', description: 'Acesso ao parque', amount: 85, inclusions: '[\"Entrada parque\", \"Trilha\"]', exclusions: '[\"Transporte\", \"Alimenta√ß√£o\"]' },\n      { activityId: 14, title: 'Tour Completo', description: 'Parque + transporte + guia', amount: 150, inclusions: '[\"Entrada\", \"Transporte\", \"Guia\"]', exclusions: '[\"Refei√ß√µes\"]' },\n      { activityId: 14, title: 'Premium A√©reo', description: 'Tour + helic√≥ptero + almo√ßo', amount: 450, inclusions: '[\"Tour completo\", \"Helic√≥ptero\", \"Almo√ßo\"]', exclusions: '[\"Compras pessoais\"]' }\n    ];\n\n    // Inserir propostas\n    for (const proposal of activityProposals) {\n      await db.execute(sql`\n        INSERT INTO activity_budget_proposals \n        (activity_id, title, description, amount, currency, inclusions, exclusions, price_type, is_active) \n        VALUES \n        (${proposal.activityId}, ${proposal.title}, ${proposal.description}, ${proposal.amount}, 'BRL', \n         ${proposal.inclusions}, ${proposal.exclusions}, 'per_person', true)\n      `);\n    }\n\n    console.log(`‚úÖ ${activityProposals.length} propostas de or√ßamento criadas!`);\n\n    // 4. Criar avalia√ß√µes\n    console.log('‚≠ê Criando avalia√ß√µes...');\n    \n    const reviewsData = [\n      // Cristo Redentor (ID 9)\n      { activityId: 9, userId: 1, rating: 5, comment: 'Vista incr√≠vel! O Cristo Redentor √© realmente majestoso. Vale muito a pena!', visitDate: '2024-12-01', helpfulVotes: 15 },\n      { activityId: 9, userId: 2, rating: 4, comment: 'Muito bonito, mas estava bem cheio. Recomendo ir cedo pela manh√£.', visitDate: '2024-11-28', helpfulVotes: 8 },\n      \n      // P√£o de A√ß√∫car (ID 10)\n      { activityId: 10, userId: 1, rating: 5, comment: 'O bondinho √© uma experi√™ncia √∫nica! Vista espetacular da cidade.', visitDate: '2024-12-05', helpfulVotes: 12 },\n      { activityId: 10, userId: 2, rating: 4, comment: 'Vista maravilhosa, mas achei um pouco caro. Ainda assim recomendo!', visitDate: '2024-11-30', helpfulVotes: 6 },\n      \n      // Cataratas (ID 14)\n      { activityId: 14, userId: 1, rating: 5, comment: 'Uma das experi√™ncias mais impressionantes da minha vida! As cataratas s√£o majestosas.', visitDate: '2024-11-15', helpfulVotes: 22 },\n      { activityId: 14, userId: 2, rating: 5, comment: 'Espetacular! Prepare-se para se molhar e leve capa de chuva. Vale cada centavo!', visitDate: '2024-11-20', helpfulVotes: 18 },\n      \n      // MASP (ID 12)\n      { activityId: 12, userId: 1, rating: 4, comment: 'Excelente museu com obras incr√≠veis. O acervo √© muito rico e diversificado.', visitDate: '2024-12-03', helpfulVotes: 9 },\n      { activityId: 12, userId: 2, rating: 4, comment: 'Muito interessante para quem gosta de arte. A arquitetura do pr√©dio tamb√©m √© impressionante.', visitDate: '2024-11-25', helpfulVotes: 7 },\n      \n      // Pelourinho (ID 13)\n      { activityId: 13, userId: 1, rating: 5, comment: 'O centro hist√≥rico de Salvador √© maravilhoso! Rica cultura e hist√≥ria em cada esquina.', visitDate: '2024-11-18', helpfulVotes: 14 },\n      { activityId: 13, userId: 2, rating: 4, comment: 'Muito bonito e cheio de hist√≥ria. O show de capoeira foi o ponto alto!', visitDate: '2024-11-22', helpfulVotes: 10 }\n    ];\n\n    // Inserir avalia√ß√µes\n    for (const review of reviewsData) {\n      try {\n        await db.execute(sql`\n          INSERT INTO activity_reviews \n          (activity_id, user_id, rating, comment, visit_date, is_verified, helpful_votes, is_hidden) \n          VALUES \n          (${review.activityId}, ${review.userId}, ${review.rating}, ${review.comment}, \n           ${review.visitDate}, true, ${review.helpfulVotes}, false)\n        `);\n      } catch (error) {\n        // Ignora erros de foreign key ou duplicatas\n        if (!error.message.includes('Duplicate entry') && !error.message.includes('foreign key')) {\n          console.error(`Erro ao criar avalia√ß√£o: ${error.message}`);\n        }\n      }\n    }\n\n    console.log(`‚úÖ ${reviewsData.length} avalia√ß√µes criadas!`);\n\n    // 5. Atualizar m√©dias de rating\n    console.log('üìä Atualizando m√©dias de rating...');\n    await db.execute(sql`\n      UPDATE activities a\n      SET \n        average_rating = COALESCE((\n          SELECT AVG(r.rating)\n          FROM activity_reviews r \n          WHERE r.activity_id = a.id AND r.is_hidden = FALSE\n        ), 0),\n        total_ratings = COALESCE((\n          SELECT COUNT(*)\n          FROM activity_reviews r \n          WHERE r.activity_id = a.id AND r.is_hidden = FALSE\n        ), 0)\n    `);\n\n    // 6. Verificar resultados\n    const proposalsCount = await db.execute(sql`SELECT COUNT(*) as count FROM activity_budget_proposals`);\n    const reviewsCount = await db.execute(sql`SELECT COUNT(*) as count FROM activity_reviews`);\n    \n    console.log(`\\nüìã Resultado final:`);\n    console.log(`üí∞ Propostas criadas: ${proposalsCount[0].count}`);\n    console.log(`‚≠ê Avalia√ß√µes criadas: ${reviewsCount[0].count}`);\n\n    console.log('\\nüéâ Sistema de propostas de or√ßamento e avalia√ß√µes completamente implementado!');\n\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n    throw error;\n  }\n}\n\n// Executar se chamado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  addSampleReviews()\n    .then(() => {\n      console.log('‚úÖ Processo conclu√≠do!');\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('‚ùå Erro no processo:', error);\n      process.exit(1);\n    });\n}","size_bytes":13377},"server/auth.ts":{"content":"\nimport passport from \"passport\";\nimport { Strategy as LocalStrategy } from \"passport-local\";\nimport session from \"express-session\";\nimport bcrypt from \"bcryptjs\";\nimport type { Express } from \"express\";\nimport { storage, sessionConfig } from \"./storage\";\nimport type { User } from \"@shared/schema\";\n\ndeclare global {\n  namespace Express {\n    interface User {\n      id: number;\n      username: string;\n      email: string;\n      full_name: string;\n      phone: string;\n      bio?: string;\n      location?: string;\n      profile_photo?: string;\n      languages?: string[];\n      interests?: string[];\n      travel_styles?: string[];\n      is_verified?: boolean;\n      average_rating?: string;\n      total_ratings?: number;\n    }\n  }\n}\n\nexport function setupAuth(app: Express) {\n  // Configura√ß√£o de sess√£o\n  app.use(session({\n    secret: process.env.SESSION_SECRET || \"viaja-junto-secret-key-2024\",\n    resave: false,\n    saveUninitialized: true, // Create session even if not modified\n    cookie: {\n      secure: false, // false para desenvolvimento\n      httpOnly: false, // Allow frontend access in development\n      maxAge: 24 * 60 * 60 * 1000, // 24 horas\n      sameSite: 'lax', // Use lax for same-site in Replit\n      path: '/',\n      domain: undefined, // Use default domain\n      partitioned: false // Prevent partitioned cookies\n    },\n    name: 'connect.sid',\n    store: storage.sessionStore,\n    rolling: true // Extend session on each request\n  }));\n\n  // Add CORS headers for development\n  app.use((req, res, next) => {\n    res.header('Access-Control-Allow-Origin', req.headers.origin || '*');\n    res.header('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');\n    res.header('Access-Control-Allow-Headers', 'Origin, X-Requested-With, Content-Type, Accept, Authorization');\n    res.header('Access-Control-Allow-Credentials', 'true');\n    \n    // Handle preflight requests\n    if (req.method === 'OPTIONS') {\n      res.sendStatus(200);\n      return;\n    }\n    \n    next();\n  });\n\n  // Inicializar Passport ANTES do middleware customizado\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  // Custom authentication middleware to handle both session and manual session ID\n  app.use(async (req: any, res, next) => {\n    // Log session information for debugging\n    if (req.path.startsWith('/api/')) {\n      console.log('üîç Session debug:', {\n        url: req.url,\n        method: req.method,\n        sessionID: req.sessionID,\n        isAuthenticated: req.isAuthenticated ? req.isAuthenticated() : 'undefined',\n        hasUser: !!req.user,\n        sessionData: req.session,\n        cookies: Object.keys(req.cookies || {}),\n        headers: {\n          cookie: req.headers.cookie ? 'presente' : 'ausente',\n          sessionIdHeader: req.headers['x-session-id'] ? 'presente' : 'ausente'\n        }\n      });\n    }\n    \n    // If already authenticated via session, continue\n    if (req.isAuthenticated && req.isAuthenticated() && req.user) {\n      return next();\n    }\n    \n    // Check for session ID in headers (fallback for browser compatibility)\n    const sessionId = req.headers['x-session-id'] || req.query.sessionId;\n    if (sessionId && req.path.startsWith('/api/')) {\n      try {\n        // Try to find session in store\n        const sessionData = await new Promise((resolve, reject) => {\n          sessionConfig.store.get(sessionId, (err, session) => {\n            if (err) reject(err);\n            else resolve(session);\n          });\n        });\n        \n        if (sessionData && (sessionData as any).passport && (sessionData as any).passport.user) {\n          const userId = (sessionData as any).passport.user;\n          const user = await storage.getUserById(userId);\n          \n          if (user) {\n            // Manually set user on request\n            const { password: _, ...userWithoutPassword } = user;\n            const cleanUser = {\n              ...userWithoutPassword,\n              bio: userWithoutPassword.bio || undefined,\n              location: userWithoutPassword.location || undefined,\n              profile_photo: userWithoutPassword.profile_photo || undefined,\n              languages: userWithoutPassword.languages || undefined,\n              interests: userWithoutPassword.interests || undefined,\n              travel_styles: userWithoutPassword.travel_styles || undefined,\n            };\n            \n            req.user = cleanUser as any;\n            req.isAuthenticated = () => true;\n            console.log('‚úÖ Autentica√ß√£o manual bem-sucedida:', user.username);\n          }\n        }\n      } catch (error) {\n        console.error('Erro na autentica√ß√£o manual:', error);\n      }\n    }\n    \n    // Final debug log after authentication attempts\n    if (req.path.startsWith('/api/')) {\n      console.log('üîç Verificando usu√°rio atual:', {\n        isAuthenticated: req.isAuthenticated ? req.isAuthenticated() : false,\n        hasUser: !!req.user,\n        user: req.user ? req.user.username : undefined,\n        sessionID: req.sessionID,\n        session: req.session,\n        cookies: req.cookies\n      });\n    }\n    next();\n  });\n\n  // Estrat√©gia local\n  passport.use(new LocalStrategy(\n    {\n      usernameField: 'identifier',\n      passwordField: 'password'\n    },\n    async (identifier, password, done) => {\n      try {\n        // Tenta buscar o usu√°rio por username, email ou telefone\n        let user = await storage.getUserByUsername(identifier);\n        \n        if (!user) {\n          user = await storage.getUserByEmail(identifier);\n        }\n        \n        if (!user) {\n          // Remove formata√ß√£o do telefone para busca\n          const cleanPhone = identifier.replace(/\\D/g, '');\n          user = await storage.getUserByPhone(cleanPhone);\n        }\n        \n        if (!user) {\n          return done(null, false, { message: 'Usu√°rio n√£o encontrado' });\n        }\n\n        // Check password using scrypt hash (same as used in database)\n        console.log(`üîë Debug senha para ${user.username}:`);\n        console.log(`  Senha fornecida: \"${password}\"`);\n        console.log(`  Hash armazenado: \"${user.password}\"`);\n        \n        const { scryptSync } = await import('crypto');\n        const [hash, salt] = user.password.split('.');\n        console.log(`  Hash extra√≠do: \"${hash}\"`);\n        console.log(`  Salt extra√≠do: \"${salt}\"`);\n        \n        const hashedPassword = scryptSync(password, salt, 64).toString('hex');\n        console.log(`  Hash calculado: \"${hashedPassword}\"`);\n        \n        const isValid = hash === hashedPassword;\n        console.log(`  ‚úÖ Senhas coincidem: ${isValid}`);\n        \n        if (!isValid) {\n          console.log(`‚ùå Login falhado: Senha incorreta para ${user.username}`);\n          return done(null, false, { message: 'Senha incorreta' });\n        }\n\n        // Remover senha do objeto usu√°rio\n        const { password: _, ...userWithoutPassword } = user;\n        // Convert null values to undefined for TypeScript compatibility\n        const cleanUser = {\n          ...userWithoutPassword,\n          bio: userWithoutPassword.bio || undefined,\n          location: userWithoutPassword.location || undefined,\n          profile_photo: userWithoutPassword.profile_photo || undefined,\n          languages: userWithoutPassword.languages || undefined,\n          interests: userWithoutPassword.interests || undefined,\n          travel_styles: userWithoutPassword.travel_styles || undefined,\n        };\n        return done(null, cleanUser);\n      } catch (error) {\n        return done(error);\n      }\n    }\n  ));\n\n  // Serializa√ß√£o do usu√°rio\n  passport.serializeUser((user, done) => {\n    done(null, user.id);\n  });\n\n  // Deserializa√ß√£o do usu√°rio\n  passport.deserializeUser(async (id: number, done) => {\n    try {\n      const user = await storage.getUserById(id);\n      if (!user) {\n        return done(null, false);\n      }\n      \n      const { password: _, ...userWithoutPassword } = user;\n      // Convert null values to undefined for TypeScript compatibility\n      const cleanUser = {\n        ...userWithoutPassword,\n        bio: userWithoutPassword.bio || undefined,\n        location: userWithoutPassword.location || undefined,\n        profile_photo: userWithoutPassword.profile_photo || undefined,\n        languages: userWithoutPassword.languages || undefined,\n        interests: userWithoutPassword.interests || undefined,\n        travel_styles: userWithoutPassword.travel_styles || undefined,\n      };\n      done(null, cleanUser);\n    } catch (error) {\n      done(error);\n    }\n  });\n\n  // Rota de verifica√ß√£o do usu√°rio\n  app.get(\"/api/user\", async (req, res) => {\n    if (req.isAuthenticated() && req.user) {\n      // Always fetch fresh user data from database to ensure latest verification status\n      try {\n        const freshUser = await storage.getUserById((req.user as any).id);\n        if (freshUser) {\n          const { password: _, ...userWithoutPassword } = freshUser;\n          const cleanUser = {\n            ...userWithoutPassword,\n            bio: userWithoutPassword.bio || undefined,\n            location: userWithoutPassword.location || undefined,\n            profile_photo: userWithoutPassword.profile_photo || undefined,\n            languages: userWithoutPassword.languages || undefined,\n            interests: userWithoutPassword.interests || undefined,\n            travel_styles: userWithoutPassword.travel_styles || undefined,\n          };\n          console.log('‚úÖ Fresh user data loaded, is_verified:', cleanUser.is_verified);\n          res.json(cleanUser);\n        } else {\n          res.status(401).json({ message: \"Usu√°rio n√£o encontrado\" });\n        }\n      } catch (error) {\n        console.error('Erro ao buscar usu√°rio:', error);\n        res.status(500).json({ message: \"Erro interno do servidor\" });\n      }\n    } else {\n      console.log('üîç Verificando usu√°rio atual:', {\n        isAuthenticated: req.isAuthenticated(),\n        hasUser: !!req.user,\n        user: req.user,\n        sessionID: req.sessionID,\n        session: req.session,\n        cookies: req.cookies\n      });\n      res.status(401).json({ message: \"N√£o autorizado\" });\n    }\n  });\n\n  // Debug route to test API functionality\n  app.get(\"/api/auth/test\", (req, res) => {\n    res.json({ message: \"API est√° funcionando\", timestamp: new Date().toISOString() });\n  });\n\n  // Rota de login\n  app.post(\"/api/auth/login\", (req, res, next) => {\n    passport.authenticate('local', (err: any, user: any, info: any) => {\n      if (err) {\n        console.error('Erro na autentica√ß√£o:', err);\n        return res.status(500).json({ message: \"Erro interno do servidor\" });\n      }\n      \n      if (!user) {\n        console.log('Login falhado:', info?.message);\n        return res.status(401).json({ \n          message: info?.message || \"Credenciais inv√°lidas\" \n        });\n      }\n\n      req.logIn(user, (err) => {\n        if (err) {\n          console.error('Erro ao fazer login:', err);\n          return res.status(500).json({ message: \"Erro ao fazer login\" });\n        }\n        \n        console.log('Login bem-sucedido:', {\n          userId: user.id,\n          username: user.username,\n          sessionID: req.sessionID,\n          isAuthenticated: req.isAuthenticated()\n        });\n        \n        // Force session save to ensure persistence\n        req.session.save((err) => {\n          if (err) {\n            console.error('Erro ao salvar sess√£o:', err);\n            return res.status(500).json({ message: \"Erro ao salvar sess√£o\" });\n          }\n          \n          console.log('Sess√£o salva com sucesso. SessionID:', req.sessionID);\n          console.log('Cookie headers:', res.getHeaders());\n          \n          // Also send session ID in response for browser compatibility\n          return res.json({\n            ...user,\n            sessionId: req.sessionID\n          });\n        });\n      });\n    })(req, res, next);\n  });\n\n  // Rota de registro\n  app.post(\"/api/auth/register\", async (req, res) => {\n    try {\n      const { username, password, email, fullName, phone, bio, location, languages, interests, travelStyles, referredBy } = req.body;\n\n      // Verificar se usu√°rio j√° existe\n      const existingUser = await storage.getUserByUsername(username);\n      if (existingUser) {\n        return res.status(400).json({ message: \"Nome de usu√°rio j√° existe\" });\n      }\n\n      const existingEmail = await storage.getUserByEmail(email);\n      if (existingEmail) {\n        return res.status(400).json({ message: \"Email j√° est√° cadastrado\" });\n      }\n\n      // Hash da senha using scrypt (consistent with test user)\n      const { scrypt, randomBytes } = await import('crypto');\n      const { promisify } = await import('util');\n      const scryptAsync = promisify(scrypt);\n      \n      const salt = randomBytes(16).toString(\"hex\");\n      const buf = (await scryptAsync(password, salt, 64)) as Buffer;\n      const hashedPassword = `${buf.toString(\"hex\")}.${salt}`;\n\n      // Determinar se usu√°rio deve ser verificado automaticamente\n      const isVerified = !!referredBy; // Usu√°rios com c√≥digo de indica√ß√£o s√£o verificados automaticamente\n      const verificationMethod = referredBy ? 'referral' : null;\n\n      // Criar usu√°rio\n      const newUser = await storage.createUser({\n        username,\n        password: hashedPassword,\n        email,\n        fullName,\n        phone,\n        bio,\n        location,\n        languages,\n        interests,\n        travelStyles,\n        referredBy,\n        isVerified,\n        verificationMethod\n      });\n\n      // Fazer login autom√°tico\n      const { password: _, ...userWithoutPassword } = newUser;\n      // Convert null values to undefined for TypeScript compatibility\n      const cleanUser = {\n        ...userWithoutPassword,\n        bio: userWithoutPassword.bio || undefined,\n        location: userWithoutPassword.location || undefined,\n        profilePhoto: userWithoutPassword.profilePhoto || undefined,\n        languages: userWithoutPassword.languages || undefined,\n        interests: userWithoutPassword.interests || undefined,\n        travelStyles: userWithoutPassword.travelStyles || undefined,\n      };\n      \n      req.logIn(cleanUser, (err) => {\n        if (err) {\n          return res.status(500).json({ message: \"Erro ao fazer login autom√°tico\" });\n        }\n        \n        return res.status(201).json(cleanUser);\n      });\n\n    } catch (error) {\n      console.error('Erro no registro:', error);\n      res.status(500).json({ message: \"Erro interno do servidor\" });\n    }\n  });\n\n  // Rota de logout\n  app.post(\"/api/logout\", (req, res) => {\n    req.logout((err) => {\n      if (err) {\n        return res.status(500).json({ message: \"Erro ao fazer logout\" });\n      }\n      \n      req.session.destroy((err) => {\n        if (err) {\n          return res.status(500).json({ message: \"Erro ao destruir sess√£o\" });\n        }\n        \n        res.clearCookie('viaja.session');\n        res.json({ message: \"Logout realizado com sucesso\" });\n      });\n    });\n  });\n\n  // Rota para solicita√ß√µes do usu√°rio\n  app.get(\"/api/user-requests\", async (req, res) => {\n    try {\n      if (!req.isAuthenticated() || !req.user) {\n        return res.status(401).json({ message: \"N√£o autorizado\" });\n      }\n\n      const requests = await storage.getUserTripRequests(req.user.id);\n      res.json(requests);\n    } catch (error) {\n      console.error('Erro ao buscar solicita√ß√µes:', error);\n      res.status(500).json({ message: \"Erro ao buscar solicita√ß√µes\" });\n    }\n  });\n}\n","size_bytes":15521},"server/check-activities-count.ts":{"content":"import { db } from './db.js';\n\nasync function checkActivitiesCount() {\n  try {\n    console.log('üîç VERIFICANDO ATIVIDADES NO BANCO...\\n');\n    \n    const [result] = await db.execute('SELECT COUNT(*) as total FROM activities');\n    const total = (result as any)[0].total;\n    \n    console.log(`üìä Total de atividades: ${total}`);\n    \n    if (total > 0) {\n      const [activities] = await db.execute('SELECT title, location FROM activities ORDER BY location, title');\n      \n      const locationGroups = {};\n      (activities as any).forEach(activity => {\n        const loc = activity.location || 'Sem localiza√ß√£o';\n        if (!locationGroups[loc]) locationGroups[loc] = [];\n        locationGroups[loc].push(activity.title);\n      });\n      \n      console.log('\\nüìç ATIVIDADES POR LOCALIZA√á√ÉO:');\n      Object.entries(locationGroups).forEach(([location, titles]) => {\n        console.log(`\\n  ${location} (${(titles as string[]).length} atividades):`);\n        (titles as string[]).forEach(title => {\n          console.log(`    - ${title}`);\n        });\n      });\n    }\n    \n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  }\n  \n  process.exit(0);\n}\n\ncheckActivitiesCount();","size_bytes":1196},"server/check-and-fix-destinations.ts":{"content":"#!/usr/bin/env tsx\n\nimport { db } from \"./db\";\nimport { sql } from \"drizzle-orm\";\n\nasync function checkAndFixDestinations() {\n  console.log(\"üîç Checando estrutura atual...\");\n  \n  try {\n    // 1. Verificar se tabela destinations existe\n    console.log(\"üìã Verificando tabela destinations...\");\n    const checkTable = await db.execute(sql`SHOW TABLES LIKE 'destinations'`);\n    console.log(\"Tabelas encontradas:\", checkTable);\n    \n    // 2. Se n√£o existir, criar\n    if (checkTable.length === 0) {\n      console.log(\"üìù Criando tabela destinations...\");\n      await db.execute(sql`\n        CREATE TABLE destinations (\n          id INT PRIMARY KEY AUTO_INCREMENT,\n          name VARCHAR(255) NOT NULL,\n          state VARCHAR(10),\n          country VARCHAR(100) NOT NULL,\n          country_type VARCHAR(20) NOT NULL,\n          continent VARCHAR(50) NOT NULL,\n          region VARCHAR(100) NOT NULL,\n          is_active BOOLEAN DEFAULT true,\n          created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n        )\n      `);\n    }\n    \n    // 3. Verificar se Rio de Janeiro existe\n    console.log(\"üìç Verificando Rio de Janeiro...\");\n    const rioCheck = await db.execute(sql`SELECT * FROM destinations WHERE name = 'Rio de Janeiro'`);\n    console.log(\"Rio de Janeiro:\", rioCheck);\n    \n    if (rioCheck.length === 0) {\n      console.log(\"‚ûï Inserindo Rio de Janeiro...\");\n      await db.execute(sql`\n        INSERT INTO destinations (name, state, country, country_type, continent, region, is_active)\n        VALUES ('Rio de Janeiro', 'RJ', 'Brasil', 'nacional', 'Am√©rica do Sul', 'Sudeste', true)\n      `);\n    }\n    \n    // 4. Pegar ID do Rio\n    const rioResult = await db.execute(sql`SELECT id FROM destinations WHERE name = 'Rio de Janeiro' LIMIT 1`);\n    console.log(\"Resultado bruto Rio:\", rioResult);\n    \n    // O resultado vem como [rows, metadata] - pegar rows[0]\n    const rows = rioResult[0] as any[];\n    const rioRow = rows?.[0];\n    const rioId = rioRow?.id;\n    \n    console.log(\"üéØ Rio ID:\", rioId);\n    \n    if (!rioId) {\n      throw new Error(\"N√£o foi poss√≠vel obter ID do Rio de Janeiro\");\n    }\n    \n    // 5. Verificar trips √≥rf√£os\n    console.log(\"üîç Verificando trips √≥rf√£os...\");\n    const orphanTrips = await db.execute(sql`\n      SELECT t.id, t.title, t.destination_id \n      FROM trips t \n      LEFT JOIN destinations d ON t.destination_id = d.id \n      WHERE d.id IS NULL\n      LIMIT 5\n    `);\n    \n    console.log(`üìä Trips √≥rf√£os encontrados: ${orphanTrips.length}`);\n    \n    // 6. Corrigir trips √≥rf√£os um por um\n    if (orphanTrips.length > 0) {\n      // Como os dados v√™m em formato [rows, metadata], precisamos acessar corretamente\n      const tripRows = orphanTrips[0] as any[];\n      for (const tripData of tripRows) {\n        console.log(`üîß Corrigindo trip ID ${tripData.id}: ${tripData.title}`);\n        await db.execute(sql`UPDATE trips SET destination_id = ${rioId} WHERE id = ${tripData.id}`);\n      }\n      console.log(\"‚úÖ Trips √≥rf√£os corrigidos\");\n    }\n    \n    // 7. Verificar activities √≥rf√£os\n    console.log(\"üîç Verificando activities √≥rf√£os...\");\n    const orphanActivities = await db.execute(sql`\n      SELECT a.id, a.title, a.destination_id \n      FROM activities a \n      LEFT JOIN destinations d ON a.destination_id = d.id \n      WHERE d.id IS NULL\n      LIMIT 5\n    `);\n    \n    console.log(`üìä Activities √≥rf√£os encontrados: ${orphanActivities.length}`);\n    \n    // 8. Corrigir activities √≥rf√£os um por um\n    if (orphanActivities.length > 0) {\n      // Como os dados v√™m em formato [rows, metadata], precisamos acessar corretamente\n      const activityRows = orphanActivities[0] as any[];\n      for (const activityData of activityRows) {\n        console.log(`üîß Corrigindo activity ID ${activityData.id}: ${activityData.title}`);\n        await db.execute(sql`UPDATE activities SET destination_id = ${rioId} WHERE id = ${activityData.id}`);\n      }\n      console.log(\"‚úÖ Activities √≥rf√£os corrigidos\");\n    }\n    \n    // 9. Tentar adicionar foreign keys se ainda n√£o existem\n    console.log(\"üîó Verificando foreign keys...\");\n    \n    try {\n      await db.execute(sql`ALTER TABLE trips ADD CONSTRAINT trips_destinations_fk FOREIGN KEY (destination_id) REFERENCES destinations(id)`);\n      console.log(\"‚úÖ FK trips adicionada\");\n    } catch (e: any) {\n      if (e.message.includes('already exists') || e.message.includes('duplicate')) {\n        console.log(\"‚ÑπÔ∏è FK trips j√° existe\");\n      } else {\n        console.log(\"‚ö†Ô∏è Erro FK trips:\", e.message.substring(0, 100));\n      }\n    }\n    \n    try {\n      await db.execute(sql`ALTER TABLE activities ADD CONSTRAINT activities_destinations_fk FOREIGN KEY (destination_id) REFERENCES destinations(id)`);\n      console.log(\"‚úÖ FK activities adicionada\");\n    } catch (e: any) {\n      if (e.message.includes('already exists') || e.message.includes('duplicate')) {\n        console.log(\"‚ÑπÔ∏è FK activities j√° existe\");\n      } else {\n        console.log(\"‚ö†Ô∏è Erro FK activities:\", e.message.substring(0, 100));\n      }\n    }\n    \n    console.log(\"üéâ Verifica√ß√£o e corre√ß√£o conclu√≠das!\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro:\", error);\n    throw error;\n  }\n}\n\n// Executar\ncheckAndFixDestinations()\n  .then(() => {\n    console.log(\"‚úÖ Sucesso!\");\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error(\"‚ùå Falha:\", error);\n    process.exit(1);\n  });","size_bytes":5449},"server/check-db-info.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { sql, eq } from 'drizzle-orm';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nasync function checkDbInfo() {\n  try {\n    // Verificar total de atividades\n    const totalActivities = await db.select({ count: sql`COUNT(*)` }).from(activities);\n    console.log('üìä Total de atividades:', totalActivities[0].count);\n\n    // Verificar m√°ximo ID\n    const maxId = await db.select({ maxId: sql`MAX(id)` }).from(activities);\n    console.log('üî¢ M√°ximo ID de atividades:', maxId[0].maxId);\n\n    // Verificar total de propostas\n    const totalProposals = await db.select({ count: sql`COUNT(*)` }).from(activityBudgetProposals);\n    console.log('üí∞ Total de propostas:', totalProposals[0].count);\n\n    // Verificar algumas atividades com seus IDs\n    const sampleActivities = await db.select({ id: activities.id, title: activities.title })\n      .from(activities)\n      .limit(10)\n      .orderBy(sql`id DESC`);\n    \n    console.log('\\nüîç √öltimas 10 atividades:');\n    sampleActivities.forEach(activity => {\n      console.log(`  ID ${activity.id}: ${activity.title}`);\n    });\n\n    // Verificar propostas existentes\n    const proposalCount = await db.select({ \n      activityId: activityBudgetProposals.activityId,\n      count: sql`COUNT(*)` \n    })\n    .from(activityBudgetProposals)\n    .groupBy(activityBudgetProposals.activityId)\n    .limit(10);\n\n    console.log('\\nüí° Atividades com propostas:');\n    proposalCount.forEach(item => {\n      console.log(`  Atividade ${item.activityId}: ${item.count} propostas`);\n    });\n\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  }\n}\n\ncheckDbInfo().then(() => process.exit(0)).catch(err => {\n  console.error(err);\n  process.exit(1);\n});","size_bytes":1807},"server/check-db-status.ts":{"content":"import { db } from './db';\nimport { destinations, activities, trips, users, activityBudgetProposals } from '../shared/schema';\n\nasync function checkDatabaseStatus() {\n  console.log(\"üîó Conectando ao MySQL...\");\n  \n  try {\n    const destinationsCount = await db.select().from(destinations);\n    const activitiesCount = await db.select().from(activities);\n    const tripsCount = await db.select().from(trips);\n    const usersCount = await db.select().from(users);\n    const proposalsCount = await db.select().from(activityBudgetProposals);\n    \n    console.log(\"üìä STATUS DO BANCO DE DADOS:\");\n    console.log(`   üèôÔ∏è Destinos: ${destinationsCount.length}`);\n    console.log(`   üéØ Atividades: ${activitiesCount.length}`);\n    console.log(`   ‚úàÔ∏è Viagens: ${tripsCount.length}`);\n    console.log(`   üë§ Usu√°rios: ${usersCount.length}`);\n    console.log(`   üí∞ Propostas: ${proposalsCount.length}`);\n    \n    console.log(\"\\nüåé DISTRIBUI√á√ÉO DE DESTINOS POR CONTINENTE:\");\n    const continents = destinationsCount.reduce((acc, dest) => {\n      acc[dest.continent] = (acc[dest.continent] || 0) + 1;\n      return acc;\n    }, {} as Record<string, number>);\n    \n    for (const [continent, count] of Object.entries(continents)) {\n      console.log(`   ${continent}: ${count} cidades`);\n    }\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro ao verificar status do banco:\", error);\n  }\n}\n\ncheckDatabaseStatus().then(() => process.exit(0)).catch(err => {\n  console.error(err);\n  process.exit(1);\n});\n","size_bytes":1515},"server/check-location-mismatch.ts":{"content":"import { db } from './db.js';\nimport { activities, trips } from '../shared/schema.js';\n\nasync function checkLocationMismatch() {\n  try {\n    console.log('=== VERIFICANDO CORRESPOND√äNCIA DE LOCALIZA√á√ïES ===\\n');\n    \n    // Buscar atividades e viagens\n    const activitiesData = await db.select().from(activities);\n    const tripsData = await db.select().from(trips);\n    \n    console.log(`üìä Total de atividades: ${activitiesData.length}`);\n    console.log(`üìä Total de viagens: ${tripsData.length}\\n`);\n    \n    // Localiza√ß√µes √∫nicas das atividades\n    const activityLocations = [...new Set(activitiesData.map(a => a.location))].filter(Boolean);\n    console.log('üèõÔ∏è LOCALIZA√á√ïES DAS ATIVIDADES:');\n    activityLocations.forEach(loc => console.log(`  - \"${loc}\"`));\n    \n    // Destinos √∫nicos das viagens\n    const tripDestinations = [...new Set(tripsData.map(t => t.destination))].filter(Boolean);\n    console.log('\\nüó∫Ô∏è DESTINOS DAS VIAGENS:');\n    tripDestinations.forEach(dest => console.log(`  - \"${dest}\"`));\n    \n    // Verificar correspond√™ncias\n    console.log('\\nüîç AN√ÅLISE DE CORRESPOND√äNCIAS:');\n    const matched = activityLocations.filter(loc => tripDestinations.includes(loc));\n    const unmatched = activityLocations.filter(loc => !tripDestinations.includes(loc));\n    \n    console.log(`‚úÖ Localiza√ß√µes que correspondem: ${matched.length}`);\n    matched.forEach(loc => console.log(`  ‚úì \"${loc}\"`));\n    \n    console.log(`‚ùå Localiza√ß√µes sem correspond√™ncia: ${unmatched.length}`);\n    unmatched.forEach(loc => console.log(`  ‚úó \"${loc}\"`));\n    \n    // Atividades por localiza√ß√£o\n    console.log('\\nüìç ATIVIDADES POR LOCALIZA√á√ÉO:');\n    activityLocations.forEach(loc => {\n      const count = activitiesData.filter(a => a.location === loc).length;\n      console.log(`  ${loc}: ${count} atividades`);\n    });\n    \n    // Viagens por destino\n    console.log('\\nüéØ VIAGENS POR DESTINO:');\n    tripDestinations.forEach(dest => {\n      const count = tripsData.filter(t => t.destination === dest).length;\n      console.log(`  ${dest}: ${count} viagens`);\n    });\n    \n  } catch (error) {\n    console.error('Erro:', error);\n  }\n  \n  process.exit(0);\n}\n\ncheckLocationMismatch();","size_bytes":2232},"server/check-proposals.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nasync function checkProposals() {\n  try {\n    console.log('üîç Verificando propostas de or√ßamento no banco...');\n    \n    // Verificar total de propostas\n    const totalProposals = await db.select().from(activityBudgetProposals);\n    console.log(`üìä Total de propostas no banco: ${totalProposals.length}`);\n    \n    // Verificar propostas por atividade espec√≠fica (ID 84 mencionado no log)\n    const proposalsForActivity84 = await db.select()\n      .from(activityBudgetProposals)\n      .where(eq(activityBudgetProposals.activityId, 84));\n    \n    console.log(`üéØ Propostas para atividade ID 84: ${proposalsForActivity84.length}`);\n    \n    if (proposalsForActivity84.length > 0) {\n      console.log('üìã Detalhes das propostas:');\n      proposalsForActivity84.forEach((proposal, index) => {\n        console.log(`  ${index + 1}. ${proposal.title} - R$ ${proposal.amount} (Ativo: ${proposal.isActive})`);\n      });\n    }\n    \n    // Verificar algumas atividades aleat√≥rias\n    const sampleActivities = await db.select().from(activities).limit(5);\n    console.log('\\nüîç Verificando propostas para atividades de exemplo:');\n    \n    for (const activity of sampleActivities) {\n      const proposals = await db.select()\n        .from(activityBudgetProposals)\n        .where(eq(activityBudgetProposals.activityId, activity.id));\n      \n      console.log(`  ‚Ä¢ ${activity.title} (ID: ${activity.id}): ${proposals.length} propostas`);\n    }\n    \n    // Verificar se h√° propostas inativas\n    const inactiveProposals = await db.select()\n      .from(activityBudgetProposals)\n      .where(eq(activityBudgetProposals.isActive, false));\n    \n    console.log(`\\n‚ùå Propostas inativas: ${inactiveProposals.length}`);\n    \n  } catch (error) {\n    console.error('‚ùå Erro ao verificar propostas:', error);\n  }\n}\n\ncheckProposals().then(() => {\n  console.log('‚úÖ Verifica√ß√£o conclu√≠da');\n  process.exit(0);\n}).catch(error => {\n  console.error('‚ùå Erro durante verifica√ß√£o:', error);\n  process.exit(1);\n});","size_bytes":2193},"server/check-table-schema.ts":{"content":"import { db } from './db.js';\n\nasync function checkTableSchema() {\n  try {\n    console.log('üîç VERIFICANDO SCHEMA DA TABELA ACTIVITIES...\\n');\n    \n    const [result] = await db.execute('DESCRIBE activities');\n    \n    console.log('üìã CAMPOS DA TABELA ACTIVITIES:');\n    (result as any).forEach(row => {\n      console.log(`  ${row.Field}: ${row.Type} (${row.Null === 'YES' ? 'NULL' : 'NOT NULL'})`);\n    });\n    \n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  }\n  \n  process.exit(0);\n}\n\ncheckTableSchema();","size_bytes":524},"server/comprehensive-activities-all-cities.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals, popularDestinations } from '../shared/schema.js';\n\n// Get all destination destinations from the schema\nconst allCities = Object.keys(popularDestinations);\n\n// Comprehensive activities data for ALL destinations in the registry\nconst allCitiesActivities = [\n  // RIO DE JANEIRO, RJ - Already created, keeping for reference\n  {\n    location: \"Rio de Janeiro, RJ\",\n    activities: [\n      {\n        title: \"Cristo Redentor e Trem do Corcovado\",\n        description: \"Visite uma das Sete Maravilhas do Mundo Moderno! O Cristo Redentor √© o s√≠mbolo mais famoso do Rio de Janeiro. O passeio inclui transporte pelo hist√≥rico Trem do Corcovado atrav√©s da Floresta da Tijuca at√© o topo do Corcovado.\",\n        category: \"sightseeing\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"3 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Transporte de trem\", \"Guia credenciado\", \"Acesso aos mirantes\", \"Seguro\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Bebidas\", \"Compras pessoais\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\", \"Espanhol\"],\n        requirements: [\"Usar sapatos confort√°veis\", \"Levar protetor solar\", \"Documentos com foto\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Trem do Corcovado: (21) 2558-1329\",\n        bookingUrl: \"https://www.tremdocorcovado.rio\"\n      },\n      {\n        title: \"P√£o de A√ß√∫car de Bondinho\",\n        description: \"Suba ao famoso P√£o de A√ß√∫car no bondinho original! A viagem em dois trechos oferece vistas espetaculares da cidade, das praias de Copacabana e Ipanema, e da Ba√≠a de Guanabara.\",\n        category: \"sightseeing\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1576992021885-42b8ec06d6b0?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Bondinho ida e volta\", \"Acesso aos mirantes\", \"Seguro\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Bebidas\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\", \"Espanhol\"],\n        requirements: [\"N√£o recomendado para pessoas com medo de altura\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Bondinho P√£o de A√ß√∫car: (21) 2546-8400\",\n        bookingUrl: \"https://www.bondinho.com.br\"\n      }\n    ]\n  },\n\n  // BRAS√çLIA, DF \n  {\n    location: \"Bras√≠lia, DF\",\n    activities: [\n      {\n        title: \"Catedral Metropolitana Nossa Senhora Aparecida\",\n        description: \"Visite a ic√¥nica Catedral de Bras√≠lia, obra-prima de Oscar Niemeyer. Sua arquitetura √∫nica com 16 colunas curvas e vitrais coloridos √© uma das mais belas do mundo.\",\n        category: \"sightseeing\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"1 hora\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada gratuita\", \"Acesso aos vitrais\"],\n        exclusions: [\"Guia tur√≠stico\", \"Transporte\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Respeitar o sil√™ncio religioso\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Catedral: (61) 3224-4073\",\n        bookingUrl: \"https://www.catedral.org.br\"\n      },\n      {\n        title: \"Pra√ßa dos Tr√™s Poderes\",\n        description: \"Conhe√ßa o centro do poder brasileiro! Visite o Pal√°cio do Planalto, Congresso Nacional e Supremo Tribunal Federal. Tour guiado pela arquitetura modernista de Niemeyer.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Guia credenciado\", \"Acesso aos pal√°cios\", \"Seguro\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Documento com foto\", \"N√£o levar objetos cortantes\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 48h antes\",\n        contactInfo: \"Pal√°cio do Planalto: (61) 3411-1000\",\n        bookingUrl: \"https://www.gov.br/planalto\"\n      },\n      {\n        title: \"Memorial JK\",\n        description: \"Explore a vida e obra de Juscelino Kubitschek, o presidente que construiu Bras√≠lia. Museu interativo com mausol√©u e biblioteca em estrutura de Niemeyer.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"1.5 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada no museu\", \"Acesso ao mausol√©u\", \"Audioguia\"],\n        exclusions: [\"Transporte\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Documento com foto\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Memorial JK: (61) 3225-9451\",\n        bookingUrl: \"https://www.memorialjk.com.br\"\n      },\n      {\n        title: \"Parque Nacional de Bras√≠lia\",\n        description: \"Explore o cerrado brasileiro em sua forma mais pura! Trilhas ecol√≥gicas, nascentes de √°gua mineral e piscinas naturais a 28km do centro da cidade.\",\n        category: \"adventure\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n        duration: \"4 horas\",\n        difficultyLevel: \"moderate\",\n        ,\n        inclusions: [\"Entrada no parque\", \"Acesso √†s trilhas\", \"Seguro\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Equipamentos\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Roupas confort√°veis\", \"T√™nis apropriado\", \"Protetor solar\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Parque Nacional: (61) 3233-4553\",\n        bookingUrl: \"https://www.icmbio.gov.br\"\n      },\n      {\n        title: \"Centro Cultural Banco do Brasil CCBB\",\n        description: \"Centro cultural moderno com exposi√ß√µes de arte contempor√¢nea, cinema, teatro e caf√©. Arquitetura √∫nica em pilotis com eventos culturais constantes.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada nas exposi√ß√µes\", \"Acesso ao caf√©\"],\n        exclusions: [\"Consumo no caf√©\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Documento com foto\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"CCBB: (61) 3108-7600\",\n        bookingUrl: \"https://www.bb.com.br/ccbb\"\n      }\n    ]\n  },\n\n  // RECIFE, PE\n  {\n    location: \"Recife, PE\",\n    activities: [\n      {\n        title: \"Marco Zero Square e Escultura de Brennand\",\n        description: \"Visite o cora√ß√£o hist√≥rico de Recife! O Marco Zero √© o ponto de refer√™ncia da cidade com esculturas de Francisco Brennand e vista para o mar.\",\n        category: \"sightseeing\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Acesso livre ao marco\", \"Vista das esculturas\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Protetor solar\", \"√Ågua\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Prefeitura do Recife: (81) 3355-8000\",\n        bookingUrl: \"https://www.recife.pe.gov.br\"\n      },\n      {\n        title: \"Praia de Boa Viagem\",\n        description: \"Relaxe na praia urbana mais famosa de Recife! Extensa faixa de areia com coqueiros, barracas de praia e piscinas naturais na mar√© baixa.\",\n        category: \"relaxation\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"3 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Acesso √† praia\", \"Banho de mar seguro\"],\n        exclusions: [\"Cadeiras\", \"Guarda-sol\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Nadar apenas nas piscinas naturais\", \"Protetor solar\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Bombeiros: (81) 3465-4050\",\n        bookingUrl: \"https://www.boaviagem.pe.gov.br\"\n      },\n      {\n        title: \"Recife Antigo - Pa√ßo do Frevo\",\n        description: \"Mergulhe na cultura pernambucana! Museu interativo sobre o frevo, patrim√¥nio imaterial da UNESCO, com exposi√ß√µes e aulas de dan√ßa.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada no museu\", \"Exposi√ß√µes interativas\", \"Aula de frevo\"],\n        exclusions: [\"Transporte\", \"Lembran√ßas\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Roupas confort√°veis para dan√ßar\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Pa√ßo do Frevo: (81) 3355-9500\",\n        bookingUrl: \"https://www.pacodofevo.pe.gov.br\"\n      },\n      {\n        title: \"Instituto Ricardo Brennand\",\n        description: \"Visite um dos 20 melhores museus do mundo! Castelo medieval com arte, armas antigas, jardins esculpidos e obras de arte internacional.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"3 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada no instituto\", \"Acesso aos jardins\", \"Exposi√ß√µes permanentes\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Documento com foto\", \"N√£o tocar nas obras\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Instituto Brennand: (81) 2121-0365\",\n        bookingUrl: \"https://www.institutobrenand.pe.gov.br\"\n      },\n      {\n        title: \"Olinda - Centro Hist√≥rico UNESCO\",\n        description: \"Explore a colorida Olinda, Patrim√¥nio da Humanidade! Casas coloniais, igrejas hist√≥ricas, ateli√™s de artistas e vista panor√¢mica do Recife.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n        duration: \"4 horas\",\n        difficultyLevel: \"moderate\",\n        ,\n        inclusions: [\"Guia local\", \"Entrada em igrejas\", \"Visita aos ateli√™s\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Compras\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Sapatos confort√°veis\", \"C√¢mera fotogr√°fica\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Turismo Olinda: (81) 3305-1060\",\n        bookingUrl: \"https://www.olinda.pe.gov.br\"\n      }\n    ]\n  },\n\n  // FORTALEZA, CE\n  {\n    location: \"Fortaleza, CE\",\n    activities: [\n      {\n        title: \"Praia do Futuro\",\n        description: \"Aproveite a praia mais famosa de Fortaleza! Extensas barracas de praia, √°guas mornas, surf e a melhor infraestrutura de praia do Nordeste.\",\n        category: \"relaxation\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"4 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Acesso √† praia\", \"Estrutura de barracas\"],\n        exclusions: [\"Consumo nas barracas\", \"Equipamentos de praia\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Protetor solar\", \"Roupas de banho\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Barracas: (85) 3234-5678\",\n        bookingUrl: \"https://www.praiadofuturo.com.br\"\n      },\n      {\n        title: \"Praia de Iracema\",\n        description: \"Curta o p√¥r do sol mais bonito de Fortaleza! Cal√ßad√£o com bares, restaurantes, m√∫sica ao vivo e o famoso Centro Drag√£o do Mar.\",\n        category: \"nightlife\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"3 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Acesso ao cal√ßad√£o\", \"Vista do p√¥r do sol\"],\n        exclusions: [\"Consumo em bares\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Vir no final da tarde\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Drag√£o do Mar: (85) 3488-8600\",\n        bookingUrl: \"https://www.dragaodomar.org.br\"\n      },\n      {\n        title: \"Beach Park - Aquiraz\",\n        description: \"Divers√£o garantida no maior parque aqu√°tico da Am√©rica Latina! Tobo√°guas radicais, piscinas tropicais e praia paradis√≠aca.\",\n        category: \"adventure\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"8 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Passaporte para todos os brinquedos\", \"Acesso √† praia\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Estacionamento\", \"Transporte\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Roupas de banho\", \"Protetor solar\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 48h antes\",\n        contactInfo: \"Beach Park: (85) 4012-3000\",\n        bookingUrl: \"https://www.beachpark.com.br\"\n      },\n      {\n        title: \"Centro Drag√£o do Mar\",\n        description: \"Explore o maior centro cultural do Norte/Nordeste! Museus, planet√°rio, cinema, teatro e exposi√ß√µes de arte contempor√¢nea.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"3 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada nos museus\", \"Acesso √†s exposi√ß√µes\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Documento com foto\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Drag√£o do Mar: (85) 3488-8600\",\n        bookingUrl: \"https://www.dragaodomar.org.br\"\n      },\n      {\n        title: \"Cumbuco - Passeio de Buggy\",\n        description: \"Aventura nas dunas de Cumbuco! Passeio de buggy pelas dunas, lagoas cristalinas, kitesurf e esqui na areia.\",\n        category: \"adventure\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1464822759844-d150065c7fb5?w=800&q=80\",\n        duration: \"6 horas\",\n        difficultyLevel: \"moderate\",\n        ,\n        inclusions: [\"Buggy com motorista\", \"Parada nas lagoas\", \"Esqui na areia\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Bebidas\", \"Kitesurf\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Roupas confort√°veis\", \"Protetor solar\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Cumbuco Turismo: (85) 3318-7200\",\n        bookingUrl: \"https://www.cumbuco.com.br\"\n      }\n    ]\n  },\n\n  // MANAUS, AM\n  {\n    location: \"Manaus, AM\",\n    activities: [\n      {\n        title: \"Teatro Amazonas\",\n        description: \"Visite o magn√≠fico Teatro Amazonas, s√≠mbolo da era da borracha! Arquitetura europeia com c√∫pula colorida e ac√∫stica perfeita no cora√ß√£o da Amaz√¥nia.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"1.5 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Visita guiada\", \"Acesso ao sal√£o nobre\", \"Hist√≥ria da borracha\"],\n        exclusions: [\"Transporte\", \"Apresenta√ß√µes\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Documento com foto\", \"Vestimenta adequada\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Teatro Amazonas: (92) 3232-1768\",\n        bookingUrl: \"https://www.teatroamazonas.com.br\"\n      },\n      {\n        title: \"Encontro das √Åguas\",\n        description: \"Fen√¥meno natural √∫nico! Veja o encontro dos rios Negro e Solim√µes que correm lado a lado por 6km sem se misturar, formando o Rio Amazonas.\",\n        category: \"sightseeing\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n        duration: \"4 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Passeio de barco\", \"Guia especializado\", \"Seguro\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Bebidas\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Protetor solar\", \"Chap√©u\", \"C√¢mera\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Amazon Jungle Tours: (92) 3633-5578\",\n        bookingUrl: \"https://www.amazonjungletours.com.br\"\n      },\n      {\n        title: \"Praia de Ponta Negra\",\n        description: \"Relaxe na melhor praia fluvial de Manaus! Areia branca, √°guas mornas do Rio Negro e vista espetacular da cidade.\",\n        category: \"relaxation\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"3 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Acesso √† praia\", \"Banho de rio\"],\n        exclusions: [\"Cadeiras\", \"Guarda-sol\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Roupas de banho\", \"Protetor solar\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Ponta Negra: (92) 3236-9000\",\n        bookingUrl: \"https://www.pontanegra.am.gov.br\"\n      },\n      {\n        title: \"Arquip√©lago de Anavilhanas\",\n        description: \"Explore o maior arquip√©lago fluvial do mundo! Ecoturismo aut√™ntico com observa√ß√£o de aves, trilhas na floresta e pernoite em lodge.\",\n        category: \"adventure\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n        duration: \"3 dias\",\n        difficultyLevel: \"moderate\",\n        ,\n        inclusions: [\"Hospedagem em lodge\", \"Todas as refei√ß√µes\", \"Guia especializado\", \"Atividades\"],\n        exclusions: [\"Transporte a√©reo\", \"Bebidas alco√≥licas\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Vacina febre amarela\", \"Roupas de trekking\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 7 dias antes\",\n        contactInfo: \"Anavilhanas Lodge: (92) 3633-8996\",\n        bookingUrl: \"https://www.anavilhanaslodge.com.br\"\n      },\n      {\n        title: \"Mercado Adolpho Lisboa\",\n        description: \"Conhe√ßa o famoso mercado hist√≥rico de Manaus! Arquitetura de 1882 inspirada em Paris, com peixes amaz√¥nicos, artesanato e produtos regionais.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada no mercado\", \"Degusta√ß√£o de frutas\"],\n        exclusions: [\"Compras\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Dinheiro em esp√©cie\", \"Disposi√ß√£o para pechinchar\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Mercado: (92) 3232-6441\",\n        bookingUrl: \"https://www.mercadoadolpho.com.br\"\n      }\n    ]\n  },\n\n  // CURITIBA, PR\n  {\n    location: \"Curitiba, PR\",\n    activities: [\n      {\n        title: \"Jardim Bot√¢nico de Curitiba\",\n        description: \"Visite o cart√£o postal de Curitiba! Jardim franc√™s com estufa art nouveau, flores coloridas e lagos em uma das mais belas paisagens urbanas do Brasil.\",\n        category: \"sightseeing\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada gratuita\", \"Acesso aos jardins\", \"Visita √† estufa\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Roupas confort√°veis\", \"Protetor solar\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Jardim Bot√¢nico: (41) 3264-6994\",\n        bookingUrl: \"https://www.jardimbotanico.curitiba.pr.gov.br\"\n      },\n      {\n        title: \"Museu Oscar Niemeyer\",\n        description: \"Explore a arquitetura arrojada do 'Museu do Olho'! Obras de arte moderna, exposi√ß√µes tempor√°rias e a famosa estrutura em formato de olho.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2.5 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada no museu\", \"Exposi√ß√µes permanentes\", \"Acesso √† arquitetura\"],\n        exclusions: [\"Exposi√ß√µes especiais\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Documento com foto\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Museu Niemeyer: (41) 3350-4400\",\n        bookingUrl: \"https://www.museuoscarniemeyer.org.br\"\n      },\n      {\n        title: \"√ìpera de Arame\",\n        description: \"Conhe√ßa a √∫nica √≥pera de arame do mundo! Estrutura transparente em antiga pedreira, com apresenta√ß√µes culturais e vista √∫nica da natureza.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"1.5 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada na √≥pera\", \"Vista da estrutura\"],\n        exclusions: [\"Apresenta√ß√µes\", \"Transporte\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Verificar programa√ß√£o\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"√ìpera de Arame: (41) 3355-8700\",\n        bookingUrl: \"https://www.operadearame.com.br\"\n      },\n      {\n        title: \"Trem Serra Verde Express para Morretes\",\n        description: \"Viagem de trem hist√≥rico pela Serra do Mar! Uma das mais belas ferrovias do Brasil, com 70km de paisagens montanhosas at√© Morretes.\",\n        category: \"adventure\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"8 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Viagem de trem\", \"Guia tur√≠stico\", \"Seguro\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Passeios em Morretes\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Documento com foto\", \"Roupas confort√°veis\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 48h antes\",\n        contactInfo: \"Serra Verde Express: (41) 3888-3488\",\n        bookingUrl: \"https://www.serraverde.com.br\"\n      },\n      {\n        title: \"Largo da Ordem - Feira de Domingo\",\n        description: \"Explore o centro hist√≥rico aos domingos! Feira de artesanato, m√∫sica ao vivo, teatro de rua e gastronomia local no cora√ß√£o hist√≥rico de Curitiba.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n        duration: \"3 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Acesso √† feira\", \"Apresenta√ß√µes culturais\"],\n        exclusions: [\"Compras\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Ir aos domingos das 9h √†s 14h\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Turismo Curitiba: (41) 3350-3000\",\n        bookingUrl: \"https://www.turismo.curitiba.pr.gov.br\"\n      }\n    ]\n  },\n\n  // BEL√âM, PA\n  {\n    location: \"Bel√©m, PA\",\n    activities: [\n      {\n        title: \"Mercado Ver-o-Peso\",\n        description: \"Conhe√ßa o maior mercado a c√©u aberto da Am√©rica Latina! Peixes amaz√¥nicos, frutas ex√≥ticas, ervas medicinais e artesanato paraense desde 1625.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada no mercado\", \"Degusta√ß√£o de a√ßa√≠\"],\n        exclusions: [\"Compras\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Ir pela manh√£\", \"Dinheiro em esp√©cie\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Ver-o-Peso: (91) 3249-0520\",\n        bookingUrl: \"https://www.veropeso.com.br\"\n      },\n      {\n        title: \"Esta√ß√£o das Docas\",\n        description: \"Complexo tur√≠stico e gastron√¥mico no porto! Antiga esta√ß√£o de trem transformada em boulevard com restaurantes, bares e vista da Ba√≠a de Guajar√°.\",\n        category: \"nightlife\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"3 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Acesso ao complexo\", \"Vista da ba√≠a\"],\n        exclusions: [\"Consumo em restaurantes\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Melhor no final da tarde\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Esta√ß√£o das Docas: (91) 3212-5525\",\n        bookingUrl: \"https://www.estacaodasdocas.com.br\"\n      },\n      {\n        title: \"Mangal das Gar√ßas\",\n        description: \"Parque ecol√≥gico com fauna amaz√¥nica! Borbolet√°rio, viveiro de gar√ßas, torre de observa√ß√£o e museu da navega√ß√£o na Ba√≠a de Guajar√°.\",\n        category: \"sightseeing\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n        duration: \"2.5 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada no parque\", \"Acesso aos viveiros\", \"Torre de observa√ß√£o\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"C√¢mera fotogr√°fica\", \"Repelente\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Mangal das Gar√ßas: (91) 3242-5052\",\n        bookingUrl: \"https://www.mangaldasgarcas.com.br\"\n      },\n      {\n        title: \"Complexo Feliz Lusit√¢nia\",\n        description: \"Centro hist√≥rico com forte colonial! Forte do Pres√©pio, Casa das Onze Janelas e Catedral da S√© contam 400 anos de hist√≥ria paraense.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n        duration: \"3 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada no forte\", \"Visita √† Casa das Onze Janelas\", \"Catedral\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Documento com foto\", \"Roupas adequadas\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Feliz Lusit√¢nia: (91) 3249-8362\",\n        bookingUrl: \"https://www.felizlusitania.pa.gov.br\"\n      },\n      {\n        title: \"Theatro da Paz\",\n        description: \"Teatro hist√≥rico da era da borracha! Arquitetura neocl√°ssica de 1870 com m√°rmores, afrescos e a famosa Tribuna Imperial dourada.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"1.5 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Visita guiada\", \"Acesso ao interior\", \"Hist√≥ria do teatro\"],\n        exclusions: [\"Apresenta√ß√µes\", \"Transporte\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Documento com foto\", \"Vestimenta adequada\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Theatro da Paz: (91) 3202-4450\",\n        bookingUrl: \"https://www.theatrodapaz.pa.gov.br\"\n      }\n    ]\n  },\n\n  // S√ÉO PAULO, SP - Already have some, expanding\n  {\n    location: \"S√£o Paulo, SP\",\n    activities: [\n      {\n        title: \"Parque Ibirapuera\",\n        description: \"Explore o 'Central Park' paulistano! Museus, lagos, ciclovia e espa√ßos verdes em um dos maiores parques urbanos da Am√©rica Latina.\",\n        category: \"sightseeing\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"4 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada gratuita\", \"Acesso aos jardins\", \"Ciclovia\"],\n        exclusions: [\"Aluguel de bike\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Roupas confort√°veis\", \"Protetor solar\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Parque Ibirapuera: (11) 5574-5045\",\n        bookingUrl: \"https://www.parqueibirapuera.org\"\n      },\n      {\n        title: \"Avenida Paulista e MASP\",\n        description: \"Caminhe pela avenida mais famosa de S√£o Paulo! Visite o MASP, Casa das Rosas e sinta a energia do centro financeiro e cultural da cidade.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"3 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada no MASP\", \"Casa das Rosas\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Documento com foto\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"MASP: (11) 3149-5959\",\n        bookingUrl: \"https://www.masp.org.br\"\n      },\n      {\n        title: \"Mercado Municipal - Mercad√£o\",\n        description: \"Deguste o famoso sandu√≠che de mortadela! Mercado hist√≥rico com centenas de produtores, frutas ex√≥ticas e gastronomia paulistana.\",\n        category: \"food\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada no mercado\", \"Degusta√ß√£o de frutas\"],\n        exclusions: [\"Consumo\", \"Compras\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Fome\", \"Dinheiro em esp√©cie\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Mercad√£o: (11) 3313-3365\",\n        bookingUrl: \"https://www.mercadomunicipal.com.br\"\n      },\n      {\n        title: \"Beco do Batman - Vila Madalena\",\n        description: \"Arte de rua em galeria a c√©u aberto! Beco com grafites coloridos, um dos primeiros museus de street art da Am√©rica Latina.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"1.5 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Acesso gratuito\", \"Arte urbana\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"C√¢mera fotogr√°fica\", \"Respeitar as obras\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Vila Madalena: (11) 3021-2000\",\n        bookingUrl: \"https://www.becodbatman.com.br\"\n      },\n      {\n        title: \"Pinacoteca do Estado\",\n        description: \"Primeiro museu de arte de S√£o Paulo! Cole√ß√£o de 9 mil obras, arte brasileira desde o s√©culo XIX e arquitetura hist√≥rica restaurada.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2.5 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada no museu\", \"Exposi√ß√µes permanentes\"],\n        exclusions: [\"Exposi√ß√µes especiais\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Documento com foto\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Pinacoteca: (11) 3324-1000\",\n        bookingUrl: \"https://www.pinacoteca.org.br\"\n      }\n    ]\n  },\n\n  // GOI√ÇNIA, GO\n  {\n    location: \"Goi√¢nia, GO\",\n    activities: [\n      {\n        title: \"Parque Flamboyant\",\n        description: \"Um dos mais belos parques de Goi√¢nia! Lago cristalino, trilhas sombreadas, playground e √°rea de exerc√≠cios pr√≥ximo ao Est√°dio Serra Dourada.\",\n        category: \"sightseeing\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada gratuita\", \"Acesso √†s trilhas\", \"Playground\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Roupas confort√°veis\", \"Protetor solar\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Parque Flamboyant: (62) 3524-1485\",\n        bookingUrl: \"https://www.parqueflamboyant.go.gov.br\"\n      },\n      {\n        title: \"Parque Vaca Brava\",\n        description: \"Parque urbano com lago e visual de arranha-c√©us! Tamb√©m conhecido como Parque Sulivan Silvestre, oferece trilhas, playground e atmosfera de Central Park.\",\n        category: \"sightseeing\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada gratuita\", \"Trilha do lago\", \"Aparelhos de gin√°stica\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Roupas de exerc√≠cio\", \"√Ågua\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Parque Vaca Brava: (62) 3524-1490\",\n        bookingUrl: \"https://www.parquevacabrava.go.gov.br\"\n      },\n      {\n        title: \"Bosque dos Buritis\",\n        description: \"O mais antigo parque da cidade! Criado em 1942, abriga o Monumento da Paz, fauna silvestre e trilhas hist√≥ricas no cora√ß√£o de Goi√¢nia.\",\n        category: \"sightseeing\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada gratuita\", \"Monumento da Paz\", \"Observa√ß√£o de fauna\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Transporte\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"C√¢mera fotogr√°fica\", \"Respeitar a fauna\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Bosque dos Buritis: (62) 3524-1475\",\n        bookingUrl: \"https://www.bosqueburitis.go.gov.br\"\n      },\n      {\n        title: \"Memorial do Cerrado\",\n        description: \"Complexo cient√≠fico com museu e trilhas! Hist√≥ria natural do cerrado, vila cenogr√°fica de Santa Luzia e aldeias ind√≠genas em 2km de trilhas ecol√≥gicas.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n        duration: \"3 horas\",\n        difficultyLevel: \"moderate\",\n        ,\n        inclusions: [\"Entrada no memorial\", \"Trilhas ecol√≥gicas\", \"Museu de Hist√≥ria Natural\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"T√™nis apropriado\", \"Protetor solar\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Memorial do Cerrado: (62) 3946-1239\",\n        bookingUrl: \"https://www.pucgoias.edu.br/memorial\"\n      },\n      {\n        title: \"Pra√ßa C√≠vica e Centro Cultural\",\n        description: \"Cora√ß√£o pol√≠tico e cultural de Goi√¢nia! Esculturas famosas, Pal√°cio das Esmeraldas, Teatro Goi√¢nia e arquitetura art d√©co da cidade planejada.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Acesso √† pra√ßa\", \"Visita ao teatro\", \"Arquitetura art d√©co\"],\n        exclusions: [\"Espet√°culos\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Documento com foto\", \"Cuidado com seguran√ßa\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Turismo Goi√¢nia: (62) 3524-1600\",\n        bookingUrl: \"https://www.turismo.goiania.go.gov.br\"\n      }\n    ]\n  },\n\n  // VIT√ìRIA, ES\n  {\n    location: \"Vit√≥ria, ES\",\n    activities: [\n      {\n        title: \"Praia de Camburi\",\n        description: \"Principal praia de Vit√≥ria! Extensa faixa de areia, cal√ßad√£o para caminhadas, ciclovia e estrutura completa com hot√©is e restaurantes.\",\n        category: \"relaxation\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"3 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Acesso √† praia\", \"Banho de mar\", \"Cal√ßad√£o\"],\n        exclusions: [\"Cadeiras\", \"Guarda-sol\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Roupas de banho\", \"Protetor solar\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Praia de Camburi: (27) 3382-6000\",\n        bookingUrl: \"https://www.camburi.es.gov.br\"\n      },\n      {\n        title: \"Parque Pedra da Cebola\",\n        description: \"Parque urbano com forma√ß√£o rochosa √∫nica! Trilhas, √°rea verde e a misteriosa 'pedra da cebola' em formato peculiar pr√≥ximo √† UFES.\",\n        category: \"sightseeing\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"1.5 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada gratuita\", \"Trilhas\", \"Vista da pedra\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"T√™nis apropriado\", \"C√¢mera fotogr√°fica\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Parque Pedra da Cebola: (27) 3382-6100\",\n        bookingUrl: \"https://www.pedracebola.es.gov.br\"\n      },\n      {\n        title: \"Praia do Canto e Curva da Jurema\",\n        description: \"Bairro nobre com praia urbana! Iate Clube, lojas elegantes, restaurantes sofisticados e a famosa Curva da Jurema com vista panor√¢mica.\",\n        category: \"relaxation\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Acesso √† praia\", \"Vista da Curva da Jurema\"],\n        exclusions: [\"Consumo em restaurantes\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Dinheiro para consumo\", \"Roupas adequadas\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Praia do Canto: (27) 3382-6200\",\n        bookingUrl: \"https://www.praiadocanto.es.gov.br\"\n      },\n      {\n        title: \"Espa√ßo Baleia Jubarte\",\n        description: \"Centro interpretativo sobre baleias! Experi√™ncia educativa sobre conserva√ß√£o marinha, patrocinado pela Petrobras e Instituto Baleia Jubarte.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n        duration: \"2 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Entrada no espa√ßo\", \"Exposi√ß√µes interativas\", \"Educa√ß√£o ambiental\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\", \"Ingl√™s\"],\n        requirements: [\"Interesse em conserva√ß√£o\", \"Documento com foto\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Espa√ßo Baleia Jubarte: (27) 3345-5200\",\n        bookingUrl: \"https://www.baleiajubarte.org.br\"\n      },\n      {\n        title: \"Pal√°cio Anchieta\",\n        description: \"Sede do governo capixaba! Constru√ß√£o jesu√≠tica dos s√©culos XVI-XVIII, transformada em pal√°cio governamental com visitas guiadas e hist√≥ria local.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n        duration: \"1.5 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Visita guiada\", \"Acesso ao pal√°cio\", \"Hist√≥ria do ES\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Documento com foto\", \"Vestimenta adequada\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Pal√°cio Anchieta: (27) 3636-1000\",\n        bookingUrl: \"https://www.palacioanchieta.es.gov.br\"\n      }\n    ]\n  },\n\n  // FLORIAN√ìPOLIS, SC - Already have some, but adding more\n  {\n    location: \"Florian√≥polis, SC\",\n    activities: [\n      {\n        title: \"Praia da Lagoinha do Leste\",\n        description: \"Praia selvagem e preservada! Trilha de 1h30 atrav√©s da mata atl√¢ntica at√© uma das praias mais bonitas de Florian√≥polis.\",\n        category: \"adventure\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544963150-889d45c4e2f8?w=800&q=80\",\n        duration: \"6 horas\",\n        difficultyLevel: \"moderate\",\n        ,\n        inclusions: [\"Acesso √† trilha\", \"Praia preservada\", \"Mata atl√¢ntica\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Equipamentos\", \"Transporte\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"T√™nis de trilha\", \"√Ågua\", \"Lanche\", \"Protetor solar\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Turismo Floripa: (48) 3251-6000\",\n        bookingUrl: \"https://www.turismo.floripa.sc.gov.br\"\n      },\n      {\n        title: \"Praia da Joaquina - Sandboard\",\n        description: \"Surf nas dunas! Praia famosa pelo surf e dunas gigantes ideais para sandboard. Ber√ßo de grandes surfistas brasileiros.\",\n        category: \"adventure\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544963150-889d45c4e2f8?w=800&q=80\",\n        duration: \"4 horas\",\n        difficultyLevel: \"moderate\",\n        ,\n        inclusions: [\"Aluguel de prancha\", \"Instru√ß√£o b√°sica\", \"Seguro\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Equipamentos de surf\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Roupas esportivas\", \"Protetor solar\", \"√Ågua\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Joaquina Surf: (48) 3232-5555\",\n        bookingUrl: \"https://www.joaquinasandboard.com.br\"\n      },\n      {\n        title: \"Lagoa da Concei√ß√£o\",\n        description: \"Lagoa de √°guas calmas cercada por morros! Esportes aqu√°ticos, restaurantes, vida noturna e centro gastron√¥mico da ilha.\",\n        category: \"relaxation\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1544963150-889d45c4e2f8?w=800&q=80\",\n        duration: \"4 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Acesso √† lagoa\", \"Banho de lagoa\"],\n        exclusions: [\"Esportes aqu√°ticos\", \"Alimenta√ß√£o\", \"Estacionamento\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Roupas de banho\", \"Dinheiro para consumo\"],\n        cancellationPolicy: \"N√£o se aplica\",\n        contactInfo: \"Lagoa da Concei√ß√£o: (48) 3334-0000\",\n        bookingUrl: \"https://www.lagoadaconceicao.com.br\"\n      },\n      {\n        title: \"Centro Hist√≥rico de Florian√≥polis\",\n        description: \"Patrim√¥nio hist√≥rico catarinense! Mercado P√∫blico, Catedral, Casa da Alf√¢ndega e arquitetura a√ßoriana no centro da capital.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n        duration: \"3 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Walking tour\", \"Mercado P√∫blico\", \"Catedral\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Compras\", \"Transporte\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Sapatos confort√°veis\", \"C√¢mera\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Centro Hist√≥rico: (48) 3251-6100\",\n        bookingUrl: \"https://www.centrohistorico.sc.gov.br\"\n      },\n      {\n        title: \"Fortaleza de S√£o Jos√© da Ponta Grossa\",\n        description: \"Fortaleza colonial do s√©culo XVIII! Patrim√¥nio hist√≥rico em ilha preservada, acess√≠vel por barco com vista da Ba√≠a Norte.\",\n        category: \"culture\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    city: \"Cidade\",\n    priceType: \"per_person\",imageUrl: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n        duration: \"3 horas\",\n        difficultyLevel: \"easy\",\n        ,\n        inclusions: [\"Transporte de barco\", \"Visita √† fortaleza\", \"Guia hist√≥rico\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Bebidas\"],\n        languages: [\"Portugu√™s\"],\n        requirements: [\"Documento com foto\", \"Roupas confort√°veis\"],\n        cancellationPolicy: \"Cancelamento gratuito at√© 24h antes\",\n        contactInfo: \"Fortaleza: (48) 3244-9200\",\n        bookingUrl: \"https://www.fortaleza.sc.gov.br\"\n      }\n    ]\n  }\n];\n\n// Function to create activities for a specific city\nasync function createActivitiesForCity(cityName: string, cityActivities: any[]) {\n  console.log(`Creating activities for ${cityName}...`);\n  \n  for (const activityData of cityActivities) {\n    try {\n      // Insert activity\n      const insertResult = await db.insert(activities).values({\n        title: activityData.title,\n        description: activityData.description,\n        location: cityName,\n        category: activityData.category,\n        coverImage: activityData.imageUrl,\n        duration: activityData.duration,\n        difficultyLevel: activityData.difficulty,\n        inclusions: activityData.inclusions,\n        exclusions: activityData.exclusions,\n        languages: activityData.languages,\n        requirements: activityData.requirements,\n        cancellationPolicy: activityData.cancellationPolicy,\n        contactInfo: { info: activityData.contactInfo },\n        isActive: true\n      });\n      \n      const activityId = insertResult[0]?.insertId;\n\n      console.log(`‚úÖ Created activity: ${activityData.title} (ID: ${activityId})`);\n\n      // Create budget proposals for this activity\n      if (activityId) {\n        const budgetProposals = [\n          {\n            title: \"Op√ß√£o B√°sica\",\n            amount: activityData.priceRange === \"Gratuito\" ? 0 : parseFloat(activityData.priceRange.split('R$ ')[1].split('-')[0]),\n            inclusions: activityData.inclusions.slice(0, 2),\n            exclusions: [...activityData.exclusions, \"Extras n√£o mencionados\"]\n          },\n          {\n            title: \"Op√ß√£o Completa\", \n            amount: activityData.priceRange === \"Gratuito\" ? 0 : (parseFloat(activityData.priceRange.split('-')[1]) || parseFloat(activityData.priceRange.split('R$ ')[1].split('-')[0]) * 1.5),\n            inclusions: [...activityData.inclusions, \"Lanche\", \"√Ågua\"],\n            exclusions: activityData.exclusions\n          },\n          {\n            title: \"Op√ß√£o Premium\",\n            amount: activityData.priceRange === \"Gratuito\" ? 0 : ((parseFloat(activityData.priceRange.split('-')[1]) || parseFloat(activityData.priceRange.split('R$ ')[1].split('-')[0]) * 1.5) * 1.8),\n            inclusions: [...activityData.inclusions, \"Lanche gourmet\", \"√Ågua\", \"Transporte VIP\", \"Guia especializado\"],\n            exclusions: [\"Bebidas alco√≥licas\"]\n          }\n        ];\n\n        for (const proposal of budgetProposals) {\n          await db.insert(activityBudgetProposals).values({\n            activityId: Number(activityId),\n            title: proposal.title,\n            amount: proposal.amount,\n            inclusions: proposal.inclusions,\n            exclusions: proposal.exclusions,\n            createdBy: 1, // Tom user\n            votes: Math.floor(Math.random() * 20) + 5\n          });\n        }\n      } else {\n        console.error(`‚ùå No activity ID returned for ${activityData.title}`);\n      }\n\n      console.log(`‚úÖ Created 3 budget proposals for ${activityData.title}`);\n    } catch (error) {\n      console.error(`‚ùå Error creating activity ${activityData.title}:`, error);\n    }\n  }\n}\n\n// Main function to create all activities\nexport async function createAllCitiesActivities() {\n  try {\n    console.log(\"üéØ Creating comprehensive activities for all destinations...\");\n    \n    // Create activities for each city\n    for (const cityData of allCitiesActivities) {\n      await createActivitiesForCity(cityData.location, cityData.activities);\n    }\n    \n    console.log(\"‚úÖ All activities created successfully!\");\n    \n    // Check final count\n    const finalCount = await db.execute('SELECT COUNT(*) as count FROM activities');\n    const proposalCount = await db.execute('SELECT COUNT(*) as count FROM activity_budget_proposals');\n    \n    console.log(`üìä Total activities created: ${finalCount[0]?.count || 0}`);\n    console.log(`üìä Total budget proposals created: ${proposalCount[0]?.count || 0}`);\n    \n    return {\n      success: true,\n      activitiesCount: finalCount[0]?.count || 0,\n      proposalsCount: proposalCount[0]?.count || 0\n    };\n    \n  } catch (error) {\n    console.error('‚ùå Error creating activities:', error);\n    throw error;\n  }\n}\n\n// Run if called directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  createAllCitiesActivities()\n    .then(() => {\n      console.log('üéâ Activities creation completed!');\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('üí• Failed to create activities:', error);\n      process.exit(1);\n    });\n}","size_bytes":54331},"server/comprehensive-activities-seed.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\n\nconst COMPREHENSIVE_ACTIVITIES = [\n  // Rio de Janeiro, RJ\n  {\n    title: 'Cristo Redentor e Corcovado',\n    description: 'Visita ao Cristo Redentor com trem do Corcovado e vista panor√¢mica da cidade.',\n    location: 'Rio de Janeiro, RJ',\n    category: 'pontos_turisticos',\n    duration: \"240 horas\",\n    difficulty: 'easy',\n    minParticipants: 1,\n    maxParticipants: 50,\n    coverImage: 'https://images.unsplash.com/photo-1516306580123-e6e52b1b7b8f?w=1200&h=800&fit=crop&q=85',\n    rating: 4.8\n  },\n  {\n    title: 'P√£o de A√ß√∫car de Bondinho',\n    description: 'Passeio de bondinho at√© o P√£o de A√ß√∫car com vista do Rio e praias.',\n    location: 'Rio de Janeiro, RJ',\n    category: 'pontos_turisticos',\n    duration: \"180 horas\",\n    difficulty: 'easy',\n    minParticipants: 1,\n    maxParticipants: 40,\n    coverImage: 'https://images.unsplash.com/photo-1518639192441-8fce0c4e2b62?w=1200&h=800&fit=crop&q=85',\n    rating: 4.7\n  },\n  {\n    title: 'Trilha na Tijuca',\n    description: 'Trilha na Floresta da Tijuca at√© a Cachoeira do Horto.',\n    location: 'Rio de Janeiro, RJ',\n    category: 'hiking',\n    duration: \"300 horas\",\n    difficulty: 'medium',\n    minParticipants: 2,\n    maxParticipants: 15,\n    coverImage: 'https://images.unsplash.com/photo-1501594907352-04cda38ebc29?w=1200&h=800&fit=crop&q=85',\n    rating: 4.6\n  },\n\n  // S√£o Paulo, SP\n  {\n    title: 'Mercado Municipal e Centro Hist√≥rico',\n    description: 'Tour gastron√¥mico pelo Mercad√£o e pontos hist√≥ricos do centro de SP.',\n    location: 'S√£o Paulo, SP',\n    category: 'food_tours',\n    duration: \"240 horas\",\n    difficulty: 'easy',\n    minParticipants: 1,\n    maxParticipants: 20,\n    coverImage: 'https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=1200&h=800&fit=crop&q=85',\n    rating: 4.5\n  },\n  {\n    title: 'Museu de Arte Moderna',\n    description: 'Visita ao MAM e exposi√ß√µes de arte contempor√¢nea brasileira.',\n    location: 'S√£o Paulo, SP',\n    category: 'cultural',\n    duration: \"180 horas\",\n    difficulty: 'easy',\n    minParticipants: 1,\n    maxParticipants: 25,\n    coverImage: 'https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=1200&h=800&fit=crop&q=85',\n    rating: 4.4\n  },\n\n  // Pantanal, MT\n  {\n    title: 'Safari Fotogr√°fico Pantanal',\n    description: 'Safari para observa√ß√£o de on√ßas, jacar√©s e aves do Pantanal.',\n    location: 'Pantanal, MT',\n    category: 'wildlife',\n    duration: \"480 horas\",\n    difficulty: 'medium',\n    minParticipants: 2,\n    maxParticipants: 8,\n    coverImage: 'https://images.unsplash.com/photo-1547036967-23d11aacaee0?w=1200&h=800&fit=crop&q=85',\n    rating: 4.9\n  },\n  {\n    title: 'Pescaria no Pantanal',\n    description: 'Pescaria esportiva de tucunar√©s e dourados com guia local.',\n    location: 'Pantanal, MT',\n    category: 'adventure',\n    duration: \"360 horas\",\n    difficulty: 'medium',\n    minParticipants: 2,\n    maxParticipants: 10,\n    coverImage: 'https://images.unsplash.com/photo-1445205039600-5bf9d3d1b338?w=1200&h=800&fit=crop&q=85',\n    rating: 4.6\n  },\n\n  // Salvador, BA\n  {\n    title: 'Tour Pelourinho',\n    description: 'Caminhada hist√≥rica pelo centro hist√≥rico de Salvador.',\n    location: 'Salvador, BA',\n    category: 'cultural',\n    duration: \"240 horas\",\n    difficulty: 'easy',\n    minParticipants: 1,\n    maxParticipants: 20,\n    coverImage: 'https://images.unsplash.com/photo-1582639590060-4d48706bb007?w=1200&h=800&fit=crop&q=85',\n    rating: 4.7\n  },\n  {\n    title: 'Aulas de Capoeira',\n    description: 'Aulas de capoeira com mestres locais na praia.',\n    location: 'Salvador, BA',\n    category: 'cultural',\n    duration: \"120 horas\",\n    difficulty: 'easy',\n    minParticipants: 1,\n    maxParticipants: 15,\n    coverImage: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=1200&h=800&fit=crop&q=85',\n    rating: 4.5\n  },\n\n  // Serra da Mantiqueira, MG\n  {\n    title: 'Pico da Bandeira',\n    description: 'Trilha ao terceiro ponto mais alto do Brasil.',\n    location: 'Serra da Mantiqueira, MG',\n    category: 'hiking',\n    duration: \"720 horas\",\n    difficulty: 'hard',\n    minParticipants: 2,\n    maxParticipants: 10,\n    coverImage: 'https://images.unsplash.com/photo-1551632811-561732d1e306?w=1200&h=800&fit=crop&q=85',\n    rating: 4.8\n  },\n  {\n    title: 'Vale do Matutu',\n    description: 'Trilha e banho de cachoeira no Vale do Matutu.',\n    location: 'Serra da Mantiqueira, MG',\n    category: 'nature',\n    duration: \"360 horas\",\n    difficulty: 'medium',\n    minParticipants: 2,\n    maxParticipants: 12,\n    coverImage: 'https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=1200&h=800&fit=crop&q=85',\n    rating: 4.7\n  },\n\n  // Maragogi, AL\n  {\n    title: 'Gal√©s de Maragogi',\n    description: 'Mergulho nas piscinas naturais de √°guas cristalinas.',\n    location: 'Maragogi, AL',\n    category: 'water_sports',\n    duration: \"360 horas\",\n    difficulty: 'easy',\n    minParticipants: 2,\n    maxParticipants: 12,\n    coverImage: 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=1200&h=800&fit=crop&q=85',\n    rating: 4.8\n  },\n  {\n    title: 'Passeio de Catamar√£',\n    description: 'Passeio de catamar√£ pela costa com paradas para snorkel.',\n    location: 'Maragogi, AL',\n    category: 'water_sports',\n    duration: \"480 horas\",\n    difficulty: 'easy',\n    minParticipants: 4,\n    maxParticipants: 30,\n    coverImage: 'https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=1200&h=800&fit=crop&q=85',\n    rating: 4.6\n  },\n\n  // Ouro Preto, MG\n  {\n    title: 'Igreja S√£o Francisco de Assis',\n    description: 'Visita √† obra-prima do barroco brasileiro de Aleijadinho.',\n    location: 'Ouro Preto, MG',\n    category: 'cultural',\n    duration: \"120 horas\",\n    difficulty: 'easy',\n    minParticipants: 1,\n    maxParticipants: 25,\n    coverImage: 'https://images.unsplash.com/photo-1548013146-72479768bada?w=1200&h=800&fit=crop&q=85',\n    rating: 4.7\n  },\n  {\n    title: 'Mina de Ouro do Chico Rei',\n    description: 'Visita hist√≥rica √†s antigas minas de ouro.',\n    location: 'Ouro Preto, MG',\n    category: 'cultural',\n    duration: \"180 horas\",\n    difficulty: 'easy',\n    minParticipants: 2,\n    maxParticipants: 15,\n    coverImage: 'https://images.unsplash.com/photo-1578637387394-ed1f6ed2a84d?w=1200&h=800&fit=crop&q=85',\n    rating: 4.5\n  },\n\n  // Manaus, AM\n  {\n    title: 'Encontro das √Åguas',\n    description: 'Passeio para ver o encontro dos rios Negro e Solim√µes.',\n    location: 'Manaus, AM',\n    category: 'nature',\n    duration: \"240 horas\",\n    difficulty: 'easy',\n    minParticipants: 2,\n    maxParticipants: 20,\n    coverImage: 'https://images.unsplash.com/photo-1516026672322-bc52d61a55d5?w=1200&h=800&fit=crop&q=85',\n    rating: 4.8\n  },\n  {\n    title: 'Teatro Amazonas',\n    description: 'Visita ao hist√≥rico Teatro Amazonas e apresenta√ß√£o.',\n    location: 'Manaus, AM',\n    category: 'cultural',\n    duration: \"180 horas\",\n    difficulty: 'easy',\n    minParticipants: 1,\n    maxParticipants: 100,\n    coverImage: 'https://images.unsplash.com/photo-1564709586878-b88a19e1a5d1?w=1200&h=800&fit=crop&q=85',\n    rating: 4.6\n  },\n\n  // Florian√≥polis, SC\n  {\n    title: 'Surf na Joaquina',\n    description: 'Aulas de surf na famosa praia da Joaquina.',\n    location: 'Florian√≥polis, SC',\n    category: 'water_sports',\n    duration: \"180 horas\",\n    difficulty: 'easy',\n    minParticipants: 1,\n    maxParticipants: 6,\n    coverImage: 'https://images.unsplash.com/photo-1502680390469-be75c86b636f?w=1200&h=800&fit=crop&q=85',\n    rating: 4.5\n  },\n  {\n    title: 'Trilha da Lagoinha do Leste',\n    description: 'Trilha at√© uma das praias mais bonitas da ilha.',\n    location: 'Florian√≥polis, SC',\n    category: 'hiking',\n    duration: \"300 horas\",\n    difficulty: 'medium',\n    minParticipants: 2,\n    maxParticipants: 10,\n    coverImage: 'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=1200&h=800&fit=crop&q=85',\n    rating: 4.7\n  },\n\n  // Serra Ga√∫cha, RS\n  {\n    title: 'Tour de Vin√≠colas',\n    description: 'Degusta√ß√£o em vin√≠colas tradicionais de Bento Gon√ßalves.',\n    location: 'Serra Ga√∫cha, RS',\n    category: 'food_tours',\n    duration: \"480 horas\",\n    difficulty: 'easy',\n    minParticipants: 2,\n    maxParticipants: 20,\n    coverImage: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1200&h=800&fit=crop&q=85',\n    rating: 4.8\n  },\n  {\n    title: 'Trem Maria Fuma√ßa',\n    description: 'Passeio nost√°lgico de trem pelas vin√≠colas.',\n    location: 'Serra Ga√∫cha, RS',\n    category: 'pontos_turisticos',\n    duration: \"360 horas\",\n    difficulty: 'easy',\n    minParticipants: 1,\n    maxParticipants: 100,\n    coverImage: 'https://images.unsplash.com/photo-1544620347-c4fd4a3d5957?w=1200&h=800&fit=crop&q=85',\n    rating: 4.6\n  },\n\n  // Len√ß√≥is Maranhenses, MA\n  {\n    title: 'Trekking pelas Dunas',\n    description: 'Caminhada pelas dunas e lagoas dos Len√ß√≥is.',\n    location: 'Len√ß√≥is Maranhenses, MA',\n    category: 'hiking',\n    duration: \"360 horas\",\n    difficulty: 'medium',\n    minParticipants: 2,\n    maxParticipants: 12,\n    coverImage: 'https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=1200&h=800&fit=crop&q=85',\n    rating: 4.9\n  },\n  {\n    title: 'Voo de Ultraleve',\n    description: 'Sobrevoo panor√¢mico dos Len√ß√≥is Maranhenses.',\n    location: 'Len√ß√≥is Maranhenses, MA',\n    category: 'adventure',\n    duration: \"60 horas\",\n    difficulty: 'easy',\n    minParticipants: 1,\n    maxParticipants: 2,\n    coverImage: 'https://images.unsplash.com/photo-1436491865332-7a61a109cc05?w=1200&h=800&fit=crop&q=85',\n    rating: 4.8\n  },\n\n  // Caruaru, PE\n  {\n    title: 'Festa Junina Aut√™ntica',\n    description: 'Participa√ß√£o nas festividades juninas tradicionais.',\n    location: 'Caruaru, PE',\n    category: 'cultural',\n    duration: \"480 horas\",\n    difficulty: 'easy',\n    minParticipants: 1,\n    maxParticipants: 50,\n    coverImage: 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=1200&h=800&fit=crop&q=85',\n    rating: 4.7\n  },\n  {\n    title: 'Casa de Cultura Popular',\n    description: 'Visita ao memorial da cultura nordestina.',\n    location: 'Caruaru, PE',\n    category: 'cultural',\n    duration: \"180 horas\",\n    difficulty: 'easy',\n    minParticipants: 1,\n    maxParticipants: 20,\n    coverImage: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=1200&h=800&fit=crop&q=85',\n    rating: 4.4\n  }\n];\n\nasync function seedComprehensiveActivities() {\n  try {\n    console.log('üåü ADICIONANDO ATIVIDADES COMPLETAS PARA TODOS OS DESTINOS...\\n');\n    \n    let addedCount = 0;\n    \n    for (const activityData of COMPREHENSIVE_ACTIVITIES) {\n      try {\n        // Verificar se j√° existe\n        const existing = await db.select()\n          .from(activities)\n          .where(eq(activities.title, activityData.title))\n          .limit(1);\n        \n        if (existing.length > 0) {\n          console.log(`  ‚ö†Ô∏è  \"${activityData.title}\" j√° existe`);\n          continue;\n        }\n        \n        // Inserir atividade\n        const result = await db.insert(activities).values(activityData);\n        const activityId = Number(result.insertId);\n        \n        console.log(`  ‚úÖ \"${activityData.title}\" criada (${activityData.location})`);\n        \n        // Adicionar 3 propostas de or√ßamento para cada atividade\n        const proposals = [\n          {\n            activityId,\n            title: 'Econ√¥mico',\n            price: Math.round(Math.random() * 50 + 30), // R$ 30-80\n            inclusions: ['Guia local', 'Seguro b√°sico'],\n            exclusions: ['Transporte', 'Alimenta√ß√£o', 'Equipamentos'],\n            description: 'Op√ß√£o b√°sica com o essencial para a atividade'\n          },\n          {\n            activityId,\n            title: 'Completo',\n            price: Math.round(Math.random() * 100 + 80), // R$ 80-180\n            inclusions: ['Guia especializado', 'Transporte', 'Seguro', 'Lanche', 'Equipamentos'],\n            exclusions: ['Alimenta√ß√£o completa', 'Bebidas'],\n            description: 'Experi√™ncia completa com conforto e praticidade'\n          },\n          {\n            activityId,\n            title: 'Premium',\n            price: Math.round(Math.random() * 150 + 150), // R$ 150-300\n            inclusions: ['Guia exclusivo', 'Transporte executivo', 'Seguro premium', 'Alimenta√ß√£o completa', 'Equipamentos profissionais', 'Fotos'],\n            exclusions: [],\n            description: 'Experi√™ncia de luxo com todos os extras inclu√≠dos'\n          }\n        ];\n        \n        for (const proposal of proposals) {\n          await db.insert(activityBudgetProposals).values({\n            ...proposal,\n            inclusions: JSON.stringify(proposal.inclusions),\n            exclusions: JSON.stringify(proposal.exclusions)\n          });\n        }\n        \n        addedCount++;\n        \n      } catch (error) {\n        console.error(`  ‚ùå Erro ao adicionar \"${activityData.title}\":`, error);\n      }\n    }\n    \n    console.log(`\\n‚úÖ Processo conclu√≠do! ${addedCount} atividades adicionadas.`);\n    \n    // Verificar resultado final\n    const allActivities = await db.select().from(activities);\n    console.log(`\\nüìä Total de atividades no banco: ${allActivities.length}`);\n    \n    const locationCount = {};\n    allActivities.forEach(activity => {\n      const loc = activity.location || 'Sem localiza√ß√£o';\n      locationCount[loc] = (locationCount[loc] || 0) + 1;\n    });\n    \n    console.log('\\nüìç ATIVIDADES POR LOCALIZA√á√ÉO:');\n    Object.entries(locationCount)\n      .sort(([,a], [,b]) => b - a)\n      .forEach(([location, count]) => {\n        console.log(`  ${location}: ${count} atividades`);\n      });\n    \n  } catch (error) {\n    console.error('‚ùå Erro durante processo:', error);\n  }\n  \n  process.exit(0);\n}\n\nseedComprehensiveActivities();","size_bytes":13943},"server/comprehensive-seed-realistic.ts":{"content":"import { db } from './db.js';\nimport { sql } from 'drizzle-orm';\nimport { createHash } from 'crypto';\n\nasync function hashPassword(password: string): Promise<string> {\n  return createHash('sha256').update(password).digest('hex');\n}\n\nfunction generateReferralCode(username: string, id: number): string {\n  return `${username.toUpperCase().slice(0, 3)}${id.toString().padStart(3, '0')}`;\n}\n\nexport async function createRealisticSeedData() {\n  console.log('üå± Criando dados real√≠sticos completos para o sistema...');\n\n  try {\n    // 1. Primeiro executar o script de colunas de rating\n    console.log('üîß Verificando estrutura do banco...');\n    await db.execute(sql`\n      CREATE TABLE IF NOT EXISTS activity_budget_proposals (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        activity_id INT NOT NULL,\n        created_by INT,\n        title VARCHAR(255) NOT NULL,\n        description TEXT,\n        price_type VARCHAR(50) DEFAULT 'per_person' NOT NULL,\n        amount DECIMAL(10,2),\n        currency VARCHAR(10) DEFAULT 'BRL' NOT NULL,\n        inclusions JSON,\n        exclusions JSON,\n        valid_until TIMESTAMP NULL,\n        is_active BOOLEAN DEFAULT TRUE NOT NULL,\n        votes INT DEFAULT 0 NOT NULL,\n        is_popular BOOLEAN DEFAULT FALSE NOT NULL,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n        FOREIGN KEY (activity_id) REFERENCES activities(id) ON DELETE CASCADE,\n        FOREIGN KEY (created_by) REFERENCES users(id) ON DELETE SET NULL\n      )\n    `);\n\n    await db.execute(sql`\n      CREATE TABLE IF NOT EXISTS activity_reviews (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        activity_id INT NOT NULL,\n        user_id INT NOT NULL,\n        rating INT NOT NULL CHECK (rating >= 1 AND rating <= 5),\n        comment TEXT,\n        visit_date DATE,\n        photos JSON,\n        is_verified BOOLEAN DEFAULT FALSE NOT NULL,\n        helpful_votes INT DEFAULT 0 NOT NULL,\n        is_hidden BOOLEAN DEFAULT FALSE NOT NULL,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n        UNIQUE KEY unique_user_activity (user_id, activity_id),\n        FOREIGN KEY (activity_id) REFERENCES activities(id) ON DELETE CASCADE,\n        FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE\n      )\n    `);\n\n    console.log('‚úÖ Estrutura do banco verificada');\n\n    // 2. Obter atividades existentes\n    const activities = await db.execute(sql`SELECT id, title FROM activities ORDER BY id`);\n    console.log(`üìä Encontradas ${activities.length} atividades`);\n\n    // 3. Criar propostas de or√ßamento real√≠sticas para cada atividade\n    console.log('üí∞ Criando propostas de or√ßamento...');\n    \n    for (const activity of activities) {\n      await createBudgetProposalsForActivity(activity.id, activity.title);\n    }\n\n    // 4. Criar avalia√ß√µes real√≠sticas\n    console.log('‚≠ê Criando avalia√ß√µes real√≠sticas...');\n    \n    const users = await db.execute(sql`SELECT id, username FROM users LIMIT 10`);\n    \n    for (const activity of activities) {\n      await createReviewsForActivity(activity.id, users);\n    }\n\n    // 5. Atualizar m√©dias de rating das atividades\n    console.log('üìä Atualizando m√©dias de rating...');\n    await updateActivityRatings();\n\n    console.log('üéâ Dados real√≠sticos criados com sucesso!');\n\n  } catch (error) {\n    console.error('‚ùå Erro ao criar dados real√≠sticos:', error);\n    throw error;\n  }\n}\n\nasync function createBudgetProposalsForActivity(activityId: number, activityTitle: string) {\n  // Definir propostas baseadas no tipo de atividade\n  const proposals = getBudgetProposalsForActivity(activityTitle);\n  \n  for (const proposal of proposals) {\n    await db.execute(sql`\n      INSERT INTO activity_budget_proposals (\n        activity_id, title, description, amount, currency,\n        inclusions, exclusions, votes, is_popular\n      ) VALUES (\n        ${activityId},\n        ${proposal.title},\n        ${proposal.description},\n        ${proposal.amount},\n        'BRL',\n        ${JSON.stringify(proposal.inclusions)},\n        ${JSON.stringify(proposal.exclusions)},\n        ${proposal.votes},\n        ${proposal.isPopular}\n      )\n    `);\n  }\n}\n\nfunction getBudgetProposalsForActivity(title: string) {\n  const baseProposals = {\n    'Cristo Redentor / Corcovado': [\n      {\n        title: 'Op√ß√£o Econ√¥mica',\n        description: 'Van oficial at√© o Cristo Redentor',\n        amount: 85.00,\n        inclusions: ['Transporte van oficial', 'Entrada para o monumento'],\n        exclusions: ['Alimenta√ß√£o', 'Bebidas', 'Compras pessoais'],\n        votes: Math.floor(Math.random() * 30) + 15,\n        isPopular: false\n      },\n      {\n        title: 'Op√ß√£o Intermedi√°ria',\n        description: 'Trem do Corcovado + entrada + guia',\n        amount: 160.00,\n        inclusions: ['Trem do Corcovado', 'Entrada para o monumento', 'Guia tur√≠stico'],\n        exclusions: ['Bebidas alco√≥licas', 'Compras pessoais'],\n        votes: Math.floor(Math.random() * 50) + 35,\n        isPopular: true\n      },\n      {\n        title: 'Op√ß√£o Premium',\n        description: 'Tour privativo com transporte executivo',\n        amount: 320.00,\n        inclusions: ['Transporte privativo', 'Guia exclusivo', 'Entrada VIP', 'Fotos profissionais'],\n        exclusions: ['Compras pessoais'],\n        votes: Math.floor(Math.random() * 25) + 10,\n        isPopular: false\n      }\n    ],\n    'P√£o de A√ß√∫car (Bondinho)': [\n      {\n        title: 'Ingresso Padr√£o',\n        description: 'Bondinho ida e volta',\n        amount: 120.00,\n        inclusions: ['Bondinho ida e volta', 'Acesso aos mirantes'],\n        exclusions: ['Alimenta√ß√£o', 'Bebidas', 'Fotos'],\n        votes: Math.floor(Math.random() * 20) + 8,\n        isPopular: false\n      },\n      {\n        title: 'Com Guia',\n        description: 'Bondinho + guia tur√≠stico especializado',\n        amount: 190.00,\n        inclusions: ['Bondinho ida e volta', 'Guia tur√≠stico', 'Mapa da regi√£o'],\n        exclusions: ['Bebidas alco√≥licas', 'Fotos profissionais'],\n        votes: Math.floor(Math.random() * 40) + 25,\n        isPopular: true\n      },\n      {\n        title: 'Experi√™ncia Completa',\n        description: 'Bondinho + helic√≥ptero + jantar',\n        amount: 650.00,\n        inclusions: ['Bondinho ida e volta', 'Voo de helic√≥ptero 15min', 'Jantar com vista', 'Fotos a√©reas'],\n        exclusions: ['Compras pessoais'],\n        votes: Math.floor(Math.random() * 15) + 5,\n        isPopular: false\n      }\n    ]\n  };\n\n  // Proposta gen√©rica para atividades n√£o mapeadas\n  const genericProposals = [\n    {\n      title: 'Op√ß√£o B√°sica',\n      description: 'Experi√™ncia padr√£o da atividade',\n      amount: proposal.amount * 100 + 50).toFixed(2)),\n      inclusions: ['Atividade principal', 'Equipamentos b√°sicos'],\n      exclusions: ['Alimenta√ß√£o', 'Bebidas', 'Transporte'],\n      votes: Math.floor(Math.random() * 20) + 5,\n      isPopular: false\n    },\n    {\n      title: 'Op√ß√£o Completa',\n      description: 'Experi√™ncia com guia e comodidades',\n      amount: proposal.amount * 150 + 100).toFixed(2)),\n      inclusions: ['Atividade principal', 'Guia especializado', 'Equipamentos', 'Lanche'],\n      exclusions: ['Bebidas alco√≥licas', 'Compras pessoais'],\n      votes: Math.floor(Math.random() * 35) + 20,\n      isPopular: true\n    },\n    {\n      title: 'Op√ß√£o Premium',\n      description: 'Experi√™ncia exclusiva e personalizada',\n      amount: proposal.amount * 200 + 200).toFixed(2)),\n      inclusions: ['Experi√™ncia privativa', 'Guia exclusivo', 'Transporte', 'Refei√ß√£o', 'Fotos'],\n      exclusions: ['Compras pessoais'],\n      votes: Math.floor(Math.random() * 15) + 8,\n      isPopular: false\n    }\n  ];\n\n  return baseProposals[title] || genericProposals;\n}\n\nasync function createReviewsForActivity(activityId: number, users: any[]) {\n  // Criar de 2 a 5 avalia√ß√µes por atividade\n  const numReviews = Math.floor(Math.random() * 4) + 2;\n  const shuffledUsers = [...users].sort(() => Math.random() - 0.5);\n  \n  const reviewTexts = [\n    'Experi√™ncia incr√≠vel! Superou todas as expectativas. Recomendo muito!',\n    'Muito bom, mas poderia ser um pouco melhor organizado.',\n    'Perfeito! Vista sensacional e atendimento excelente.',\n    'Legal, mas achei um pouco caro para o que oferece.',\n    'Fant√°stico! Uma das melhores experi√™ncias que j√° tive.',\n    'Boa atividade, mas estava muito cheio no dia.',\n    'Maravilhoso! Vale cada centavo. Voltaria com certeza.',\n    'Interessante, mas esperava mais. Talvez seja melhor em outra √©poca.',\n    'Simplesmente espetacular! N√£o h√° palavras para descrever.',\n    'Gostei, mas o tempo da atividade foi um pouco corrido.'\n  ];\n\n  for (let i = 0; i < Math.min(numReviews, shuffledUsers.length); i++) {\n    const user = shuffledUsers[i];\n    const rating = Math.floor(Math.random() * 2) + 4; // Ratings entre 4 e 5 (mais real√≠stico)\n    const comment = reviewTexts[Math.floor(Math.random() * reviewTexts.length)];\n    const helpfulVotes = Math.floor(Math.random() * 20) + 1;\n    \n    // Data de visita aleat√≥ria nos √∫ltimos 6 meses\n    const visitDate = new Date();\n    visitDate.setDate(visitDate.getDate() - Math.floor(Math.random() * 180));\n    \n    try {\n      await db.execute(sql`\n        INSERT INTO activity_reviews (\n          activity_id, user_id, rating, comment, visit_date, \n          is_verified, helpful_votes\n        ) VALUES (\n          ${activityId},\n          ${user.id},\n          ${rating},\n          ${comment},\n          ${visitDate.toISOString().split('T')[0]},\n          ${Math.random() > 0.3}, -- 70% verificadas\n          ${helpfulVotes}\n        )\n      `);\n    } catch (error) {\n      // Ignora duplicatas (mesmo usu√°rio avaliando a mesma atividade)\n      if (!error.message.includes('Duplicate entry')) {\n        console.error(`Erro ao criar avalia√ß√£o: ${error.message}`);\n      }\n    }\n  }\n}\n\nasync function updateActivityRatings() {\n  // Atualizar a m√©dia de rating para cada atividade\n  await db.execute(sql`\n    UPDATE activities a\n    SET \n      average_rating = (\n        SELECT COALESCE(AVG(r.rating), 0)\n        FROM activity_reviews r \n        WHERE r.activity_id = a.id AND r.is_hidden = FALSE\n      ),\n      total_ratings = (\n        SELECT COUNT(*)\n        FROM activity_reviews r \n        WHERE r.activity_id = a.id AND r.is_hidden = FALSE\n      )\n  `);\n}\n\n// Executar se chamado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  createRealisticSeedData()\n    .then(() => {\n      console.log('‚úÖ Seed real√≠stico conclu√≠do!');\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('‚ùå Erro no seed:', error);\n      process.exit(1);\n    });\n}","size_bytes":10840},"server/comprehensive-seed-simple.ts":{"content":"import { db } from \"./db\";\nimport { users, trips, tripParticipants, messages, activities, activityReviews } from \"../shared/schema\";\nimport { scrypt, randomBytes } from \"crypto\";\nimport { promisify } from \"util\";\nimport { sql } from \"drizzle-orm\";\n\nconst asyncScrypt = promisify(scrypt);\n\nasync function hashPassword(password: string): Promise<string> {\n  const salt = randomBytes(16).toString('hex');\n  const derivedKey = await asyncScrypt(password, salt, 64);\n  return `${(derivedKey as Buffer).toString('hex')}.${salt}`;\n}\n\nexport async function createSimpleSeedData() {\n  console.log(\"üå± Criando dados simples de teste...\");\n\n  try {\n    // Verificar se o banco est√° limpo\n    const [userCount] = await db.select({ count: sql`count(*)` }).from(users);\n    if (userCount.count > 0) {\n      console.log(\"‚ö†Ô∏è Banco n√£o est√° vazio. Executando reset...\");\n      const { resetDatabase } = await import(\"./reset-database\");\n      await resetDatabase();\n      console.log(\"‚úÖ Reset conclu√≠do, continuando com seed...\");\n    }\n\n    const hashedPassword = await hashPassword(\"demo123\");\n\n    // Create 5 users\n    const usersList = [\n      {\n        username: \"tom\",\n        email: \"tom@exemplo.com\",\n        fullName: \"Tom Silva\",\n        phone: \"(11) 98765-4321\",\n        bio: \"Aventureiro e amante da natureza\",\n        location: \"S√£o Paulo, SP\",\n        languages: JSON.stringify([\"Portugu√™s\", \"Ingl√™s\"]),\n        interests: JSON.stringify([\"Natureza\", \"Aventura\", \"Fotografia\"]),\n        travelStyle: JSON.stringify([\"aventura\"]),\n        isVerified: true,\n        verificationMethod: \"document\",\n        referredBy: null,\n        averageRating: 4.8,\n        totalRatings: 15\n      },\n      {\n        username: \"maria\",\n        email: \"maria@exemplo.com\", \n        fullName: \"Maria Santos\",\n        phone: \"(21) 99888-7766\",\n        bio: \"Exploradora urbana e gastron√¥mica\",\n        location: \"Rio de Janeiro, RJ\",\n        languages: JSON.stringify([\"Portugu√™s\", \"Espanhol\"]),\n        interests: JSON.stringify([\"Gastronomia\", \"Cultura\", \"Praia\"]),\n        travelStyle: JSON.stringify([\"culturais\"]),\n        isVerified: true,\n        verificationMethod: \"social\",\n        referredBy: \"PARTIU-TOM01\",\n        averageRating: 4.6,\n        totalRatings: 12\n      },\n      {\n        username: \"carlos\",\n        email: \"carlos@exemplo.com\",\n        fullName: \"Carlos Oliveira\", \n        phone: \"(31) 97777-5544\",\n        bio: \"Viajante econ√¥mico e backpacker\",\n        location: \"Belo Horizonte, MG\",\n        languages: JSON.stringify([\"Portugu√™s\"]),\n        interests: JSON.stringify([\"Mochil√£o\", \"Economia\", \"Montanha\"]),\n        travelStyle: JSON.stringify([\"natureza\"]),\n        isVerified: false,\n        verificationMethod: null,\n        referredBy: \"PARTIU-MARIA02\",\n        averageRating: 4.2,\n        totalRatings: 8\n      }\n    ];\n\n    console.log(\"üë• Criando usu√°rios...\");\n    const userIds: number[] = [];\n    for (const userData of usersList) {\n      const [insertResult] = await db.insert(users).values({\n        ...userData,\n        password: hashedPassword\n      });\n      userIds.push(insertResult.insertId);\n      console.log(`‚úÖ Usu√°rio criado: ${userData.username} (ID: ${insertResult.insertId})`);\n    }\n\n    // Create 3 trips\n    console.log(\"üöó Criando viagens...\");\n    const tripsData = [\n      {\n        creatorId: userIds[0], // tom\n        title: \"Rio de Janeiro Completo\",\n        destination: \"Rio de Janeiro, RJ\",\n        startDate: new Date(\"2025-08-15\"),\n        endDate: new Date(\"2025-08-20\"),\n        budget: 2000,\n        budgetBreakdown: JSON.stringify({\n          transport: 400,\n          accommodation: 600,\n          food: 500,\n          insurance: 100,\n          other: 400\n        }),\n        maxParticipants: 6,\n        description: \"Explore o Rio de Janeiro com praias, trilhas e cultura local.\",\n        travelStyle: \"aventura\",\n        status: \"open\"\n      },\n      {\n        creatorId: userIds[1], // maria\n        title: \"S√£o Paulo Gastron√¥mico\",\n        destination: \"S√£o Paulo, SP\", \n        startDate: new Date(\"2025-09-10\"),\n        endDate: new Date(\"2025-09-13\"),\n        budget: 1500,\n        budgetBreakdown: JSON.stringify({\n          transport: 300,\n          accommodation: 400,\n          food: 600,\n          insurance: 50,\n          other: 150\n        }),\n        maxParticipants: 4,\n        description: \"Tour gastron√¥mico pelos melhores restaurantes de SP.\",\n        travelStyle: \"culturais\",\n        status: \"open\"\n      }\n    ];\n\n    const tripIds: number[] = [];\n    for (const tripData of tripsData) {\n      const [insertResult] = await db.insert(trips).values(tripData);\n      tripIds.push(insertResult.insertId);\n      console.log(`‚úÖ Viagem criada: ${tripData.title} (ID: ${insertResult.insertId})`);\n\n      // Add creator as participant\n      await db.insert(tripParticipants).values({\n        tripId: insertResult.insertId,\n        userId: tripData.creatorId,\n        status: \"accepted\",\n        joinedAt: new Date()\n      });\n    }\n\n    // Add some participants\n    console.log(\"üë• Adicionando participantes...\");\n    // Tom joins Maria's trip\n    await db.insert(tripParticipants).values({\n      tripId: tripIds[1],\n      userId: userIds[0],\n      status: \"accepted\", \n      joinedAt: new Date()\n    });\n\n    // Carlos joins both trips\n    await db.insert(tripParticipants).values({\n      tripId: tripIds[0],\n      userId: userIds[2],\n      status: \"accepted\",\n      joinedAt: new Date()\n    });\n\n    // Create some chat messages\n    console.log(\"üí¨ Criando mensagens...\");\n    const messagesData = [\n      {\n        tripId: tripIds[0],\n        senderId: userIds[0],\n        content: \"Pessoal, que anima√ß√£o para essa viagem ao Rio!\",\n        timestamp: new Date(\"2025-07-10T10:00:00\")\n      },\n      {\n        tripId: tripIds[0], \n        senderId: userIds[2],\n        content: \"Tamb√©m estou muito empolgado! Algu√©m tem sugest√µes de praias?\",\n        timestamp: new Date(\"2025-07-10T10:30:00\")\n      },\n      {\n        tripId: tripIds[1],\n        senderId: userIds[1], \n        content: \"Galera, j√° reservei mesa no restaurante Mocot√≥ para sexta!\",\n        timestamp: new Date(\"2025-07-11T14:00:00\")\n      }\n    ];\n\n    for (const messageData of messagesData) {\n      await db.insert(messages).values(messageData);\n    }\n\n    // Create some activities\n    console.log(\"üéØ Criando atividades...\");\n    const activitiesData = [\n      {\n        title: \"Trilha no P√£o de A√ß√∫car\",\n        description: \"Trilha guiada at√© o topo do P√£o de A√ß√∫car com vista panor√¢mica da cidade.\",\n        location: \"Rio de Janeiro, RJ\",\n        category: \"aventura\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceAmount: 120.00,\n        duration: \"4 horas\",\n        difficultyLevel: \"intermedi√°rio\",\n        minParticipants: 2,\n        maxParticipants: 12,\n        coverImage: \"https://images.unsplash.com/photo-1518639192441-8fce0c4e2b62\",\n        averageRating: 4.7,\n        totalRatings: 25,\n        createdById: userIds[0]\n      },\n      {\n        title: \"Tour Gastron√¥mico na Vila Madalena\",\n        description: \"Degusta√ß√£o nos melhores bares e restaurantes da Vila Madalena.\",\n        location: \"S√£o Paulo, SP\", \n        category: \"gastronomia\",\n        \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceAmount: 180.00,\n        duration: \"5 horas\",\n        difficultyLevel: \"f√°cil\",\n        minParticipants: 4,\n        maxParticipants: 10,\n        coverImage: \"https://images.unsplash.com/photo-1504674900247-0877df9cc836\",\n        averageRating: 4.9,\n        totalRatings: 18,\n        createdById: userIds[1]\n      }\n    ];\n\n    const activityIds: number[] = [];\n    for (const activityData of activitiesData) {\n      const [insertResult] = await db.insert(activities).values(activityData);\n      activityIds.push(insertResult.insertId);\n      console.log(`‚úÖ Atividade criada: ${activityData.title} (ID: ${insertResult.insertId})`);\n    }\n\n    // Create some activity reviews\n    console.log(\"‚≠ê Criando avalia√ß√µes...\");\n    const reviewsData = [\n      {\n        activityId: activityIds[0],\n        userId: userIds[1],\n        rating: 5,\n        review: \"Trilha incr√≠vel! Vista espetacular e guia muito atencioso.\",\n        visitDate: new Date(\"2025-06-15\"),\n        isVerified: true\n      },\n      {\n        activityId: activityIds[1], \n        userId: userIds[0],\n        rating: 5,\n        review: \"Melhor tour gastron√¥mico que j√° fiz! Lugares incr√≠veis.\",\n        visitDate: new Date(\"2025-06-20\"),\n        isVerified: true\n      }\n    ];\n\n    for (const reviewData of reviewsData) {\n      await db.insert(activityReviews).values(reviewData);\n    }\n\n    console.log(\"‚úÖ Seed data simplificado criado com sucesso!\");\n\n  } catch (error) {\n    console.error(\"‚ùå Erro ao criar seed data:\", error);\n    throw error;\n  }\n}","size_bytes":8926},"server/comprehensive-seed.ts":{"content":"import { db } from \"./db\";\nimport { \n  users, trips, tripParticipants, messages, expenses, expenseSplits,\n  activities, activityReviews, activityBookings\n} from \"../shared/schema\";\nimport bcrypt from \"bcryptjs\";\n\nconst destinationActivities = {\n  \"Rio de Janeiro, RJ\": [\n    {\n      title: \"Trilha no P√£o de A√ß√∫car\",\n      description: \"Trilha guiada at√© o topo do P√£o de A√ß√∫car com vista panor√¢mica da cidade maravilhosa.\",\n      category: \"adventure\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"Rio de Janeiro, RJ\",\n      price: 80,\n      duration: \"4 horas\",\n      difficulty: \"medium\",\n      minParticipants: 2,\n      maxParticipants: 12,\n      coverImage: \"https://images.unsplash.com/photo-1483729558449-99ef09a8c325?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1483729558449-99ef09a8c325?w=800&q=80\"],\n      inclusions: [\"Guia especializado\", \"Equipamentos de seguran√ßa\", \"√Ågua\", \"Seguro\"],\n      exclusions: [\"Transporte at√© o local\", \"Alimenta√ß√£o\"],\n      requirements: [\"Condicionamento f√≠sico b√°sico\", \"Cal√ßado adequado\", \"Idade m√≠nima 12 anos\"]\n    },\n    {\n      title: \"City Tour Rio Hist√≥rico\",\n      description: \"Conhe√ßa os principais pontos tur√≠sticos e hist√≥ricos do Rio de Janeiro em um tour completo.\",\n      category: \"sightseeing\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"Rio de Janeiro, RJ\",\n      price: 120,\n      duration: \"8 horas\",\n      difficulty: \"easy\",\n      minParticipants: 4,\n      maxParticipants: 20,\n      coverImage: \"https://images.unsplash.com/photo-1544966503-7cc5ac882d5f?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1544966503-7cc5ac882d5f?w=800&q=80\"],\n      inclusions: [\"Transporte\", \"Guia tur√≠stico\", \"Entrada nos pontos tur√≠sticos\", \"Almo√ßo\"],\n      exclusions: [\"Bebidas extras\", \"Compras pessoais\"],\n      requirements: [\"Documento de identifica√ß√£o\"]\n    },\n    {\n      title: \"Aula de Surf em Ipanema\",\n      description: \"Aprenda a surfar nas ondas de Ipanema com instrutores experientes.\",\n      category: \"sports\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"Rio de Janeiro, RJ\", \n      price: 100,\n      duration: \"3 horas\",\n      difficulty: \"beginner\",\n      minParticipants: 1,\n      maxParticipants: 8,\n      coverImage: \"https://images.unsplash.com/photo-1502680390469-be75c86b636f?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1502680390469-be75c86b636f?w=800&q=80\"],\n      inclusions: [\"Prancha\", \"Roupa de neoprene\", \"Instrutor\", \"Seguro\"],\n      exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n      requirements: [\"Saber nadar\", \"Condicionamento f√≠sico b√°sico\"]\n    },\n    {\n      title: \"Tour Gastron√¥mico Santa Teresa\",\n      description: \"Deguste os sabores aut√™nticos do Rio no charmoso bairro de Santa Teresa.\",\n      category: \"food\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"Rio de Janeiro, RJ\",\n      price: 95,\n      duration: \"4 horas\",\n      difficulty: \"easy\",\n      minParticipants: 4,\n      maxParticipants: 15,\n      coverImage: \"https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=800&q=80\"],\n      inclusions: [\"Degusta√ß√µes\", \"Guia gastron√¥mico\", \"Bebidas\", \"Sobremesas\"],\n      exclusions: [\"Transporte\", \"Refei√ß√µes completas\"],\n      requirements: [\"Informar restri√ß√µes alimentares\"]\n    },\n    {\n      title: \"Passeio de Barco Ba√≠a de Guanabara\",\n      description: \"Navegue pela Ba√≠a de Guanabara e aprecie o Rio de Janeiro de uma perspectiva √∫nica.\",\n      category: \"boat\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"Rio de Janeiro, RJ\",\n      price: 150,\n      duration: \"6 horas\",\n      difficulty: \"easy\",\n      minParticipants: 8,\n      maxParticipants: 30,\n      coverImage: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\"],\n      inclusions: [\"Embarca√ß√£o\", \"Tripula√ß√£o\", \"Colete salva-vidas\", \"Bebidas\", \"Lanche\"],\n      exclusions: [\"Transporte at√© o pier\", \"Refei√ß√µes principais\"],\n      requirements: [\"Documento de identifica√ß√£o\", \"N√£o ter enjoo mar√≠timo\"]\n    }\n  ],\n  \"S√£o Paulo, SP\": [\n    {\n      title: \"Tour Gastron√¥mico Vila Madalena\",\n      description: \"Explore os melhores restaurantes e bares da bo√™mia Vila Madalena.\",\n      category: \"food\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"S√£o Paulo, SP\",\n      price: 110,\n      duration: \"5 horas\",\n      difficulty: \"easy\",\n      minParticipants: 4,\n      maxParticipants: 12,\n      coverImage: \"https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=800&q=80\"],\n      inclusions: [\"Degusta√ß√µes\", \"Guia gastron√¥mico\", \"3 estabelecimentos\", \"Bebidas\"],\n      exclusions: [\"Transporte\", \"Refei√ß√µes completas\"],\n      requirements: [\"Idade m√≠nima 18 anos\", \"Informar restri√ß√µes alimentares\"]\n    },\n    {\n      title: \"Visita ao MASP e Pinacoteca\",\n      description: \"Conhe√ßa os principais museus de arte de S√£o Paulo em uma visita guiada.\",\n      category: \"culture\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"S√£o Paulo, SP\",\n      price: 85,\n      duration: \"6 horas\",\n      difficulty: \"easy\",\n      minParticipants: 2,\n      maxParticipants: 15,\n      coverImage: \"https://images.unsplash.com/photo-1554907984-15263bfd63bd?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1554907984-15263bfd63bd?w=800&q=80\"],\n      inclusions: [\"Entrada nos museus\", \"Guia especializado\", \"Material educativo\"],\n      exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Audioguia\"],\n      requirements: [\"Documento de identifica√ß√£o\"]\n    },\n    {\n      title: \"Escalada Indoor Urban Climb\",\n      description: \"Desafie-se nas paredes de escalada indoor mais modernas da cidade.\",\n      category: \"sports\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"S√£o Paulo, SP\",\n      price: 75,\n      duration: \"3 horas\",\n      difficulty: \"medium\",\n      minParticipants: 1,\n      maxParticipants: 10,\n      coverImage: \"https://images.unsplash.com/photo-1544947950-fa07a98d237f?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1544947950-fa07a98d237f?w=800&q=80\"],\n      inclusions: [\"Equipamentos\", \"Instrutor\", \"Seguro\", \"Vesti√°rio\"],\n      exclusions: [\"Cal√ßado espec√≠fico\", \"Alimenta√ß√£o\"],\n      requirements: [\"Condicionamento f√≠sico b√°sico\", \"Roupa adequada\", \"Idade m√≠nima 12 anos\"]\n    },\n    {\n      title: \"City Tour Arquitet√¥nico\",\n      description: \"Descubra a arquitetura √∫nica de S√£o Paulo com especialista em urbanismo.\",\n      category: \"sightseeing\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"S√£o Paulo, SP\",\n      price: 95,\n      duration: \"4 horas\",\n      difficulty: \"easy\",\n      minParticipants: 6,\n      maxParticipants: 20,\n      coverImage: \"https://images.unsplash.com/photo-1541578460-2c70e5a12c14?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1541578460-2c70e5a12c14?w=800&q=80\"],\n      inclusions: [\"Transporte\", \"Guia arquiteto\", \"Material informativo\", \"√Ågua\"],\n      exclusions: [\"Entrada em edif√≠cios privados\", \"Alimenta√ß√£o\"],\n      requirements: [\"Disposi√ß√£o para caminhar\"]\n    },\n    {\n      title: \"Aula de Culin√°ria Brasileira\",\n      description: \"Aprenda a preparar pratos t√≠picos brasileiros com chef renomado.\",\n      category: \"food\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"S√£o Paulo, SP\",\n      price: 130,\n      duration: \"4 horas\",\n      difficulty: \"easy\",\n      minParticipants: 6,\n      maxParticipants: 12,\n      coverImage: \"https://images.unsplash.com/photo-1556909202-f58e882332fb?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1556909202-f58e882332fb?w=800&q=80\"],\n      inclusions: [\"Ingredientes\", \"Chef instrutor\", \"Degusta√ß√£o\", \"Receitas\", \"Avental\"],\n      exclusions: [\"Transporte\", \"Bebidas alco√≥licas\"],\n      requirements: [\"Informar alergias alimentares\"]\n    }\n  ],\n  \"Florian√≥polis, SC\": [\n    {\n      title: \"Trilha Lagoa do Peri\",\n      description: \"Trilha ecol√≥gica pela maior lagoa de √°gua doce da ilha com banho refrescante.\",\n      category: \"adventure\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"Florian√≥polis, SC\",\n      price: 60,\n      duration: \"5 horas\",\n      difficulty: \"medium\",\n      minParticipants: 4,\n      maxParticipants: 15,\n      coverImage: \"https://images.unsplash.com/photo-1587474260584-136574528ed5?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1587474260584-136574528ed5?w=800&q=80\"],\n      inclusions: [\"Guia ambiental\", \"Lanche\", \"√Ågua\", \"Seguro\"],\n      exclusions: [\"Transporte\", \"Equipamentos de mergulho\"],\n      requirements: [\"Condicionamento f√≠sico b√°sico\", \"Roupa de banho\", \"Protetor solar\"]\n    },\n    {\n      title: \"Tour Hist√≥rico Centro de Florian√≥polis\",\n      description: \"Conhe√ßa a hist√≥ria e cultura a√ßoriana da capital catarinense.\",\n      category: \"culture\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"Florian√≥polis, SC\",\n      price: 50,\n      duration: \"3 horas\",\n      difficulty: \"easy\",\n      minParticipants: 4,\n      maxParticipants: 20,\n      coverImage: \"https://images.unsplash.com/photo-1574798834391-25b2b7f98b58?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1574798834391-25b2b7f98b58?w=800&q=80\"],\n      inclusions: [\"Guia hist√≥rico\", \"Entrada em museus\", \"Material educativo\"],\n      exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n      requirements: [\"Documento de identifica√ß√£o\"]\n    },\n    {\n      title: \"Aula de Surf na Joaquina\",\n      description: \"Aprenda a surfar na praia mais famosa para surf de Santa Catarina.\",\n      category: \"sports\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"Florian√≥polis, SC\",\n      price: 90,\n      duration: \"3 horas\",\n      difficulty: \"beginner\",\n      minParticipants: 2,\n      maxParticipants: 8,\n      coverImage: \"https://images.unsplash.com/photo-1502680390469-be75c86b636f?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1502680390469-be75c86b636f?w=800&q=80\"],\n      inclusions: [\"Prancha\", \"Roupa de neoprene\", \"Instrutor certificado\", \"Seguro\"],\n      exclusions: [\"Transporte\", \"Alimenta√ß√£o\"],\n      requirements: [\"Saber nadar\", \"Idade m√≠nima 12 anos\"]\n    },\n    {\n      title: \"Passeio de Barco Ilha do Campeche\",\n      description: \"Navegue at√© a paradis√≠aca Ilha do Campeche com snorkeling incluso.\",\n      category: \"boat\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"Florian√≥polis, SC\",\n      price: 180,\n      duration: \"8 horas\",\n      difficulty: \"easy\",\n      minParticipants: 8,\n      maxParticipants: 25,\n      coverImage: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\"],\n      inclusions: [\"Embarca√ß√£o\", \"Equipamento snorkeling\", \"Almo√ßo\", \"Bebidas\", \"Guia\"],\n      exclusions: [\"Transporte at√© o pier\", \"Equipamentos profissionais\"],\n      requirements: [\"Saber nadar\", \"Documento de identifica√ß√£o\"]\n    },\n    {\n      title: \"Degusta√ß√£o de Ostras Santo Ant√¥nio\",\n      description: \"Experimente as melhores ostras da regi√£o em fazenda marinha tradicional.\",\n      category: \"food\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",location: \"Florian√≥polis, SC\",\n      price: 85,\n      duration: \"4 horas\",\n      difficulty: \"easy\",\n      minParticipants: 4,\n      maxParticipants: 12,\n      coverImage: \"https://images.unsplash.com/photo-1562342140-ad31c9b41e77?w=800&q=80\",\n      images: [\"https://images.unsplash.com/photo-1562342140-ad31c9b41e77?w=800&q=80\"],\n      inclusions: [\"Degusta√ß√£o ostras\", \"Guia especializado\", \"Bebidas\", \"Aperitivos\"],\n      exclusions: [\"Transporte\", \"Refei√ß√µes principais\"],\n      requirements: [\"N√£o ter alergia a frutos do mar\"]\n    }\n  ]\n};\n\nasync function hashPassword(password: string): Promise<string> {\n  return await bcrypt.hash(password, 10);\n}\n\nexport async function createComprehensiveSeedData() {\n  console.log(\"üå± Criando dados abrangentes de teste...\");\n  \n  try {\n    // Clear existing data\n    console.log(\"üßπ Limpando dados existentes...\");\n    await db.delete(activityReviews);\n    await db.delete(activityBookings);\n    await db.delete(activities);\n    await db.delete(expenseSplits);\n    await db.delete(expenses);\n    await db.delete(messages);\n    await db.delete(tripParticipants);\n    await db.delete(trips);\n    await db.delete(users);\n\n    // Create users\n    console.log(\"üë• Criando usu√°rios...\");\n    const hashedPassword = await hashPassword(\"demo123\");\n    \n    const usersList = [\n      {\n        username: \"tom\",\n        email: \"tom@example.com\",\n        fullName: \"Tom Tubin\",\n        phone: \"(51) 99999-9999\",\n        bio: \"Aventureiro nato, sempre em busca de novas experi√™ncias. Criador da comunidade PartiuTrip!\",\n        location: \"Porto Alegre, RS\",\n        languages: JSON.stringify([\"Portugu√™s\", \"Ingl√™s\", \"Espanhol\"]),\n        interests: JSON.stringify([\"Aventura\", \"Fotografia\", \"Culin√°ria Local\", \"Hist√≥ria\"]),\n        travelStyle: \"aventura\",\n        isVerified: true,\n        verificationMethod: \"founder\"\n      },\n      {\n        username: \"maria\",\n        email: \"maria@example.com\", \n        fullName: \"Maria Silva\",\n        phone: \"(11) 98888-8888\",\n        bio: \"Apaixonada por praias e culturas diferentes. Sempre pronta para uma nova aventura!\",\n        location: \"S√£o Paulo, SP\",\n        languages: JSON.stringify([\"Portugu√™s\", \"Ingl√™s\"]),\n        interests: JSON.stringify([\"Praia\", \"Cultura\", \"Gastronomia\", \"Fotografia\"]),\n        travelStyle: \"praia\",\n        isVerified: true,\n        verificationMethod: \"referral\"\n      },\n      {\n        username: \"carlos\",\n        email: \"carlos@example.com\",\n        fullName: \"Carlos Mendes\",\n        phone: \"(21) 97777-7777\", \n        bio: \"Montanhista experiente, guia de trilhas e amante da natureza.\",\n        location: \"Rio de Janeiro, RJ\",\n        languages: JSON.stringify([\"Portugu√™s\", \"Ingl√™s\", \"Franc√™s\"]),\n        interests: JSON.stringify([\"Montanhismo\", \"Trilhas\", \"Natureza\", \"Escalada\"]),\n        travelStyle: \"natureza\",\n        isVerified: true,\n        verificationMethod: \"referral\"\n      },\n      {\n        username: \"ana\",\n        email: \"ana@example.com\",\n        fullName: \"Ana Costa\",\n        phone: \"(47) 96666-6666\",\n        bio: \"Historiadora e especialista em turismo cultural. Amo descobrir hist√≥rias locais!\",\n        location: \"Florian√≥polis, SC\",\n        languages: JSON.stringify([\"Portugu√™s\", \"Espanhol\", \"Italiano\"]),\n        interests: JSON.stringify([\"Hist√≥ria\", \"Museus\", \"Arquitetura\", \"Arte\"]),\n        travelStyle: \"cultural\",\n        isVerified: true,\n        verificationMethod: \"referral\"\n      },\n      {\n        username: \"ricardo\",\n        email: \"ricardo@example.com\",\n        fullName: \"Ricardo Santos\",\n        phone: \"(85) 95555-5555\",\n        bio: \"Chef de cozinha e especialista em gastronomia regional brasileira.\",\n        location: \"Fortaleza, CE\",\n        languages: JSON.stringify([\"Portugu√™s\", \"Ingl√™s\"]),\n        interests: JSON.stringify([\"Gastronomia\", \"Culin√°ria Regional\", \"Mercados Locais\", \"Vinhos\"]),\n        travelStyle: \"cultural\",\n        isVerified: true,\n        verificationMethod: \"referral\"\n      }\n    ];\n\n    const userIds: number[] = [];\n    for (const userData of usersList) {\n      const [insertResult] = await db.insert(users).values({\n        ...userData,\n        password: hashedPassword\n      });\n      userIds.push(insertResult.insertId);\n      console.log(`‚úÖ Usu√°rio criado: ${userData.username} (ID: ${insertResult.insertId})`);\n    }\n\n    // Create comprehensive trips\n    console.log(\"üöó Criando viagens abrangentes...\");\n    \n    const tripsData = [\n      // Tom's trips\n      {\n        creatorId: userIds[0], // tom\n        title: \"Aventura Completa no Rio de Janeiro\",\n        destination: \"Rio de Janeiro, RJ\",\n        startDate: new Date(\"2025-08-15\"),\n        endDate: new Date(\"2025-08-20\"),\n        budget: 2500,\n        budgetBreakdown: JSON.stringify({\n          transport: 600,\n          accommodation: 800,\n          food: 500,\n          activities: 400,\n          insurance: 100,\n          other: 100\n        }),\n        maxParticipants: 8,\n        description: \"Explore o Rio de Janeiro com trilhas, praias, gastronomia e cultura local. Uma experi√™ncia completa na cidade maravilhosa!\",\n        travelStyle: \"aventura\",\n        status: \"open\"\n      },\n      {\n        creatorId: userIds[0], // tom\n        title: \"Descobrindo S√£o Paulo Cultural\",\n        destination: \"S√£o Paulo, SP\",\n        startDate: new Date(\"2025-09-10\"),\n        endDate: new Date(\"2025-09-14\"),\n        budget: 1800,\n        budgetBreakdown: JSON.stringify({\n          transport: 400,\n          accommodation: 600,\n          food: 450,\n          activities: 250,\n          insurance: 50,\n          other: 50\n        }),\n        maxParticipants: 6,\n        description: \"Mergulhe na cultura paulistana: museus, gastronomia, arquitetura e vida noturna da maior metr√≥pole do Brasil.\",\n        travelStyle: \"urbanas\",\n        status: \"open\"\n      },\n      {\n        creatorId: userIds[0], // tom\n        title: \"Relaxamento em Florian√≥polis\",\n        destination: \"Florian√≥polis, SC\", \n        startDate: new Date(\"2025-10-05\"),\n        endDate: new Date(\"2025-10-10\"),\n        budget: 2200,\n        budgetBreakdown: JSON.stringify({\n          transport: 500,\n          accommodation: 700,\n          food: 400,\n          activities: 450,\n          insurance: 75,\n          other: 75\n        }),\n        maxParticipants: 10,\n        description: \"Praias paradis√≠acas, trilhas ecol√≥gicas e gastronomia local em uma das ilhas mais belas do Brasil.\",\n        travelStyle: \"praia\",\n        status: \"open\"\n      },\n      {\n        creatorId: userIds[0], // tom\n        title: \"Expedi√ß√£o Pantanal Selvagem\",\n        destination: \"Pantanal, MS\",\n        startDate: new Date(\"2025-11-20\"),\n        endDate: new Date(\"2025-11-26\"),\n        budget: 3500,\n        budgetBreakdown: JSON.stringify({\n          transport: 800,\n          accommodation: 1200,\n          food: 600,\n          activities: 700,\n          insurance: 100,\n          other: 100\n        }),\n        maxParticipants: 12,\n        description: \"Safari fotogr√°fico na maior plan√≠cie alag√°vel do mundo. Encontros √∫nicos com a fauna brasileira.\",\n        travelStyle: \"natureza\",\n        status: \"open\"\n      },\n      {\n        creatorId: userIds[0], // tom\n        title: \"Aventura no Nordeste - Chapada Diamantina\",\n        destination: \"Chapada Diamantina, BA\",\n        startDate: new Date(\"2025-12-15\"),\n        endDate: new Date(\"2025-12-22\"),\n        budget: 2800,\n        budgetBreakdown: JSON.stringify({\n          transport: 700,\n          accommodation: 900,\n          food: 450,\n          activities: 550,\n          insurance: 100,\n          other: 100\n        }),\n        maxParticipants: 8,\n        description: \"Cachoeiras cristalinas, cavernas misteriosas e trilhas desafiadoras na joia baiana.\",\n        travelStyle: \"natureza\",\n        status: \"open\"\n      },\n      // Maria's trips\n      {\n        creatorId: userIds[1], // maria\n        title: \"Praias Secretas de S√£o Paulo\",\n        destination: \"Ubatuba, SP\",\n        startDate: new Date(\"2025-08-22\"),\n        endDate: new Date(\"2025-08-26\"),\n        budget: 1600,\n        budgetBreakdown: JSON.stringify({\n          transport: 350,\n          accommodation: 600,\n          food: 350,\n          activities: 200,\n          insurance: 50,\n          other: 50\n        }),\n        maxParticipants: 6,\n        description: \"Explore praias selvagens e intocadas do litoral norte paulista com acesso exclusivo.\",\n        travelStyle: \"praia\",\n        status: \"open\"\n      },\n      {\n        creatorId: userIds[1], // maria\n        title: \"Cultural Rio de Janeiro\",\n        destination: \"Rio de Janeiro, RJ\",\n        startDate: new Date(\"2025-09-18\"),\n        endDate: new Date(\"2025-09-22\"),\n        budget: 2000,\n        budgetBreakdown: JSON.stringify({\n          transport: 450,\n          accommodation: 700,\n          food: 400,\n          activities: 350,\n          insurance: 50,\n          other: 50\n        }),\n        maxParticipants: 10,\n        description: \"Mergulhe na cultura carioca: museus, centros culturais, m√∫sica e gastronomia local.\",\n        travelStyle: \"cultural\",\n        status: \"open\"\n      },\n      {\n        creatorId: userIds[1], // maria\n        title: \"Gastronomia de Minas Gerais\",\n        destination: \"Ouro Preto, MG\",\n        startDate: new Date(\"2025-10-12\"),\n        endDate: new Date(\"2025-10-16\"),\n        budget: 1400,\n        budgetBreakdown: JSON.stringify({\n          transport: 300,\n          accommodation: 500,\n          food: 350,\n          activities: 200,\n          insurance: 25,\n          other: 25\n        }),\n        maxParticipants: 8,\n        description: \"Patrim√¥nio hist√≥rico e culin√°ria mineira tradicional em uma das cidades mais charmosas do Brasil.\",\n        travelStyle: \"cultural\",\n        status: \"open\"\n      },\n      {\n        creatorId: userIds[1], // maria\n        title: \"Praias do Nordeste - Jericoacoara\",\n        destination: \"Jericoacoara, CE\",\n        startDate: new Date(\"2025-11-10\"),\n        endDate: new Date(\"2025-11-15\"),\n        budget: 2400,\n        budgetBreakdown: JSON.stringify({\n          transport: 650,\n          accommodation: 800,\n          food: 400,\n          activities: 450,\n          insurance: 50,\n          other: 50\n        }),\n        maxParticipants: 12,\n        description: \"Para√≠so nordestino com dunas, lagoas cristalinas e p√¥r do sol inesquec√≠vel.\",\n        travelStyle: \"praia\",\n        status: \"open\"\n      },\n      {\n        creatorId: userIds[1], // maria\n        title: \"Arquitetura e Design em Bras√≠lia\",\n        destination: \"Bras√≠lia, DF\",\n        startDate: new Date(\"2025-12-08\"),\n        endDate: new Date(\"2025-12-11\"),\n        budget: 1200,\n        budgetBreakdown: JSON.stringify({\n          transport: 400,\n          accommodation: 450,\n          food: 200,\n          activities: 120,\n          insurance: 15,\n          other: 15\n        }),\n        maxParticipants: 8,\n        description: \"Descubra a arquitetura modernista √∫nica da capital federal e sua hist√≥ria.\",\n        travelStyle: \"cultural\",\n        status: \"open\"\n      }\n    ];\n\n    // Insert trips\n    const tripIds: number[] = [];\n    for (const tripData of tripsData) {\n      const [insertResult] = await db.insert(trips).values(tripData);\n      const tripId = insertResult.insertId;\n      tripIds.push(tripId);\n      console.log(`‚úÖ Viagem criada: ${tripData.title} (ID: ${tripId})`);\n    }\n\n    // Create activities for each destination\n    console.log(\"üéØ Criando atividades por destino...\");\n    \n    const allActivities: any[] = [];\n    for (const [destination, destinationActivitiesList] of Object.entries(destinationActivities)) {\n      for (const activity of destinationActivitiesList) {\n        const [insertResult] = await db.insert(activities).values({\n          ...activity,\n          createdById: userIds[0], // tom as creator\n          averageRating: 4 + Math.random(), // 4.0-5.0 rating\n          totalReviews: Math.floor(Math.random() * 50) + 10 // 10-60 reviews\n        });\n        allActivities.push({ id: insertResult.insertId, ...activity });\n        console.log(`‚úÖ Atividade criada: ${activity.title}`);\n      }\n    }\n\n    // Create trip participants\n    console.log(\"üë• Adicionando participantes √†s viagens...\");\n    \n    const participantCombos = [\n      [1, 2, 3], // tom, maria, carlos\n      [1, 4, 5], // tom, ana, ricardo\n      [2, 3, 4], // maria, carlos, ana\n      [2, 1, 5], // maria, tom, ricardo\n      [3, 4, 5], // carlos, ana, ricardo\n    ];\n\n    for (let i = 0; i < tripIds.length; i++) {\n      const tripId = tripIds[i];\n      const participants = participantCombos[i % participantCombos.length];\n      \n      for (const userId of participants) {\n        await db.insert(tripParticipants).values({\n          tripId,\n          userId,\n          status: \"accepted\",\n          joinedAt: new Date()\n        });\n      }\n      \n      // Update trip currentParticipants count\n      await db.update(trips).set({ \n        currentParticipants: participants.length \n      }).where({ id: tripId });\n    }\n\n    // Create messages for each trip\n    console.log(\"üí¨ Criando mensagens de chat...\");\n    \n    const sampleMessages = [\n      \"Pessoal, estou muito animado para essa viagem! üéâ\",\n      \"J√° confirmei a hospedagem, est√° tudo certo!\",\n      \"Que horas voc√™s chegam no aeroporto?\",\n      \"Encontrei um restaurante incr√≠vel para experimentarmos\",\n      \"N√£o esque√ßam do protetor solar! ‚òÄÔ∏è\",\n      \"Viagem vai ser √©pica! Mal posso esperar\",\n      \"J√° separei as roupas, falta pouco!\",\n      \"Checklist da viagem: passagens ‚úì hospedagem ‚úì divers√£o ‚úì\",\n      \"Voc√™s viram a previs√£o do tempo? Perfeita!\",\n      \"Essa vai ser inesquec√≠vel!\"\n    ];\n\n    for (let i = 0; i < tripIds.length; i++) {\n      const tripId = tripIds[i];\n      const participants = participantCombos[i % participantCombos.length];\n      \n      // Create 3-5 messages per trip\n      const messageCount = Math.floor(Math.random() * 3) + 3;\n      for (let j = 0; j < messageCount; j++) {\n        const senderId = participants[Math.floor(Math.random() * participants.length)];\n        const message = sampleMessages[Math.floor(Math.random() * sampleMessages.length)];\n        \n        await db.insert(messages).values({\n          tripId,\n          senderId,\n          content: message,\n          sentAt: new Date(Date.now() - Math.random() * 7 * 24 * 60 * 60 * 1000) // Random date within last week\n        });\n      }\n    }\n\n    // Create expenses for each trip\n    console.log(\"üí∞ Criando despesas compartilhadas...\");\n    \n    const expenseCategories = [\n      { category: \"transport\", \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",description: \"Passagens a√©reas\", amount: 400 },\n      { category: \"accommodation\", \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",description: \"Hospedagem 3 noites\", amount: 300 },\n      { category: \"food\", \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",description: \"Jantar no restaurante local\", amount: 150 },\n      { category: \"activities\", \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",description: \"Passeio guiado\", amount: 100 },\n      { category: \"transport\", \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",description: \"T√°xi do aeroporto\", amount: 80 },\n      { category: \"food\", \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",description: \"Almo√ßo na praia\", amount: 120 },\n      { category: \"other\", \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",description: \"Souvenirs\", amount: 60 }\n    ];\n\n    for (let i = 0; i < tripIds.length; i++) {\n      const tripId = tripIds[i];\n      const participants = participantCombos[i % participantCombos.length];\n      \n      // Create 2-4 expenses per trip\n      const expenseCount = Math.floor(Math.random() * 3) + 2;\n      for (let j = 0; j < expenseCount; j++) {\n        const expense = expenseCategories[j % expenseCategories.length];\n        const paidBy = participants[Math.floor(Math.random() * participants.length)];\n        \n        const [expenseResult] = await db.insert(expenses).values({\n          tripId,\n          paidBy,\n          amount: expense.amount,\n          description: expense.description,\n          category: expense.category\n        });\n        \n        const expenseId = expenseResult.insertId;\n        \n        // Create expense splits for all participants\n        const amountPerPerson = expense.amount / participants.length;\n        for (const userId of participants) {\n          await db.insert(expenseSplits).values({\n            expenseId,\n            userId,\n            amount: amountPerPerson,\n            paid: userId === paidBy || Math.random() > 0.5 // Payer or 50% chance others paid\n          });\n        }\n      }\n    }\n\n    // Create activity reviews\n    console.log(\"‚≠ê Criando avalia√ß√µes de atividades...\");\n    \n    const reviewComments = [\n      \"Experi√™ncia incr√≠vel! Recomendo muito!\",\n      \"Superou todas as expectativas. Guia excelente!\",\n      \"Vale muito a pena! Voltaria sem d√∫vida.\",\n      \"Atividade bem organizada e divertida.\",\n      \"Momentos inesquec√≠veis! Equipe muito profissional.\",\n      \"Perfeito para quem busca aventura!\",\n      \"√ìtimo custo-benef√≠cio. Adorei!\",\n      \"Experi√™ncia √∫nica! Staff muito atencioso.\"\n    ];\n\n    for (const activity of allActivities) {\n      // Create 3-8 reviews per activity\n      const reviewCount = Math.floor(Math.random() * 6) + 3;\n      for (let i = 0; i < reviewCount; i++) {\n        const userId = userIds[Math.floor(Math.random() * userIds.length)]; // Random user 1-5\n        const rating = Math.floor(Math.random() * 2) + 4; // 4-5 stars\n        const comment = reviewComments[Math.floor(Math.random() * reviewComments.length)];\n        \n        await db.insert(activityReviews).values({\n          activityId: activity.id,\n          userId,\n          rating,\n          review: comment,\n          createdAt: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000) // Random date within last 30 days\n        });\n      }\n    }\n\n    // Create some activity bookings\n    console.log(\"üìÖ Criando reservas de atividades...\");\n    \n    for (let i = 0; i < 20; i++) {\n      const activity = allActivities[Math.floor(Math.random() * allActivities.length)];\n      const userId = userIds[Math.floor(Math.random() * userIds.length)];\n      \n      await db.insert(activityBookings).values({\n        activityId: activity.id,\n        userId,\n        participants: Math.floor(Math.random() * 4) + 1,\n        contactName: `Usu√°rio ${userId}`,\n        contactEmail: `user${userId}@example.com`,\n        contactPhone: `(11) 9999${userId}-000${userId}`,\n        bookingDate: new Date(Date.now() + Math.random() * 60 * 24 * 60 * 60 * 1000), // Random future date within 60 days\n        totalAmount: activity.price * (Math.floor(Math.random() * 4) + 1),\n        status: Math.random() > 0.2 ? \"confirmed\" : \"pending\"\n      });\n    }\n    \n    console.log(\"‚úÖ Sistema abrangente de dados criado com sucesso!\");\n    console.log(`üìä Resumo criado:`);\n    console.log(`üë• 5 usu√°rios completos`);\n    console.log(`üöó ${tripsData.length} viagens com or√ßamentos detalhados`);\n    console.log(`üéØ ${allActivities.length} atividades por destino`);\n    console.log(`üí¨ Mensagens de chat em todas as viagens`);\n    console.log(`üí∞ Despesas compartilhadas com divis√£o`);\n    console.log(`‚≠ê Avalia√ß√µes e reservas de atividades`);\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro ao criar dados abrangentes:\", error);\n    throw error;\n  }\n}","size_bytes":31830},"server/create-activity-data.ts":{"content":"import { db } from \"./db\";\nimport { activities, activityBudgetProposals } from \"@shared/schema\";\n\n// Create missing activities table if it doesn't exist\nasync function createActivitiesTable() {\n  try {\n    console.log(\"üèóÔ∏è Creating activities table...\");\n    \n    // Create activity_budget_proposals table\n    await db.execute(`\n      CREATE TABLE IF NOT EXISTS activity_budget_proposals (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        activity_id INT NOT NULL,\n        created_by INT NOT NULL,\n        title VARCHAR(255) NOT NULL,\n        description TEXT,\n        price_type VARCHAR(50) NOT NULL DEFAULT 'per_person',\n        amount DECIMAL(10,2) NOT NULL,\n        currency VARCHAR(10) DEFAULT 'BRL' NOT NULL,\n        inclusions JSON,\n        exclusions JSON,\n        valid_until TIMESTAMP NULL,\n        is_active BOOLEAN DEFAULT TRUE NOT NULL,\n        votes INT DEFAULT 0 NOT NULL,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL,\n        FOREIGN KEY (activity_id) REFERENCES activities(id),\n        FOREIGN KEY (created_by) REFERENCES users(id)\n      )\n    `);\n    \n    console.log(\"‚úÖ Activities tables created successfully!\");\n  } catch (error) {\n    console.error(\"‚ùå Error creating activities table:\", error);\n  }\n}\n\n// Comprehensive activity data for major Brazilian destinations\nexport const activityData = [\n  // Rio de Janeiro Activities\n  {\n    title: \"Cristo Redentor (Corcovado)\",\n    description: \"Visite uma das Sete Maravilhas do Mundo Moderno! Suba de trem pelo Parque Nacional da Tijuca at√© o topo do Corcovado para ver o Cristo Redentor e ter uma vista panor√¢mica incr√≠vel da cidade.\",\n    location: \"Rio de Janeiro, RJ\",\n    category: \"sightseeing\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 89.00,\n    duration: \"4 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 1,\n    maxParticipants: 50,\n    languages: [\"portugu√™s\", \"ingl√™s\", \"espanhol\"],\n    inclusions: [\"Ingresso do trem\", \"Guia tur√≠stico\", \"Transporte at√© a esta√ß√£o\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Seguro viagem\"],\n    requirements: [\"N√£o recomendado para pessoas com problemas card√≠acos\", \"Crian√ßas devem estar acompanhadas\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 24 horas antes\",\n    contactInfo: {\n      email: \"contato@cristoredentor.com.br\",\n      phone: \"(21) 2558-1329\",\n      website: \"https://www.tremdocorcovado.rio\",\n      whatsapp: \"+5521987654321\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1483729558449-99ef09a8c325?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1483729558449-99ef09a8c325?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Passeio de Bondinho no P√£o de A√ß√∫car\",\n    description: \"Experi√™ncia √∫nica no bondinho mais famoso do Brasil! Dois est√°gios de telef√©rico levam voc√™ at√© o topo do P√£o de A√ß√∫car para uma vista de 360¬∞ da Ba√≠a de Guanabara.\",\n    location: \"Rio de Janeiro, RJ\",\n    category: \"sightseeing\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 120.00,\n    duration: \"3 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 1,\n    maxParticipants: 40,\n    languages: [\"portugu√™s\", \"ingl√™s\", \"espanhol\", \"franc√™s\"],\n    inclusions: [\"Ingresso do bondinho\", \"Guia especializado\", \"Seguro do passeio\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Transporte at√© o local\"],\n    requirements: [\"N√£o recomendado para pessoas com medo de altura\", \"Hor√°rio de funcionamento: 8h √†s 20h\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 2 horas antes\",\n    contactInfo: {\n      email: \"info@bondinhopoeacucar.com.br\",\n      phone: \"(21) 2546-8400\",\n      website: \"https://www.bondinhopoeacucar.com.br\",\n      whatsapp: \"+5521912345678\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Tour pelas Praias de Copacabana e Ipanema\",\n    description: \"Conhe√ßa as praias mais famosas do mundo! Caminhada guiada pelas areias de Copacabana e Ipanema, com paradas para √°gua de coco e explica√ß√µes sobre a cultura carioca.\",\n    location: \"Rio de Janeiro, RJ\",\n    category: \"beach\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 45.00,\n    duration: \"3 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 2,\n    maxParticipants: 20,\n    languages: [\"portugu√™s\", \"ingl√™s\"],\n    inclusions: [\"Guia local\", \"√Ågua de coco\", \"Protetor solar\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Cadeiras de praia\", \"Transporte\"],\n    requirements: [\"Usar roupas confort√°veis\", \"Levar toalha e mai√¥\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 1 hora antes\",\n    contactInfo: {\n      email: \"praias@rioturismo.com.br\",\n      phone: \"(21) 3544-8888\",\n      whatsapp: \"+5521999887766\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1483729558449-99ef09a8c325?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1483729558449-99ef09a8c325?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Visita ao Jardim Bot√¢nico do Rio\",\n    description: \"Explore o para√≠so verde do Rio de Janeiro! Mais de 350 hectares com 7.000 esp√©cies de plantas nativas e ex√≥ticas, incluindo orqu√≠deas, brom√©lias e √°rvores centen√°rias.\",\n    location: \"Rio de Janeiro, RJ\",\n    category: \"nature\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 25.00,\n    duration: \"2 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 1,\n    maxParticipants: 30,\n    languages: [\"portugu√™s\", \"ingl√™s\"],\n    inclusions: [\"Entrada do jardim\", \"Guia bot√¢nico\", \"Mapa ilustrado\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Transporte\"],\n    requirements: [\"Usar sapatos confort√°veis\", \"Levar repelente\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 30 minutos antes\",\n    contactInfo: {\n      email: \"visitas@jbrj.gov.br\",\n      phone: \"(21) 3204-2000\",\n      website: \"https://www.jbrj.gov.br\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Escadaria Selar√≥n e Santa Teresa\",\n    description: \"Descubra a arte de rua mais famosa do Rio! Caminhada pelos 250 degraus coloridos da Escadaria Selar√≥n e pelo charmoso bairro de Santa Teresa.\",\n    location: \"Rio de Janeiro, RJ\",\n    category: \"culture\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 35.00,\n    duration: \"2.5 horas\",\n    difficultyLevel: \"moderate\",\n    minParticipants: 3,\n    maxParticipants: 15,\n    languages: [\"portugu√™s\", \"ingl√™s\"],\n    inclusions: [\"Guia cultural\", \"Visita a ateli√™s locais\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Transporte\", \"Compras\"],\n    requirements: [\"Condicionamento f√≠sico b√°sico\", \"Sapatos antiderrapantes\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 2 horas antes\",\n    contactInfo: {\n      email: \"cultura@santateresa.com.br\",\n      phone: \"(21) 3970-1234\",\n      whatsapp: \"+5521987123456\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1483729558449-99ef09a8c325?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\",\n    createdById: 1\n  },\n\n  // S√£o Paulo Activities\n  {\n    title: \"Tour pelo Parque Ibirapuera\",\n    description: \"Explore o 'Central Park' de S√£o Paulo! Conhe√ßa os museus, lagos e √°reas verdes deste ic√¥nico parque urbano, incluindo o Museu de Arte Moderna e o Planet√°rio.\",\n    location: \"S√£o Paulo, SP\",\n    category: \"culture\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 40.00,\n    duration: \"3 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 2,\n    maxParticipants: 25,\n    languages: [\"portugu√™s\", \"ingl√™s\"],\n    inclusions: [\"Guia especializado\", \"Entrada nos museus\", \"Mapa do parque\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Transporte\"],\n    requirements: [\"Usar roupas confort√°veis\", \"Levar √°gua\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 1 hora antes\",\n    contactInfo: {\n      email: \"tours@ibirapuera.org.br\",\n      phone: \"(11) 5574-5177\",\n      website: \"https://www.parqueibirapuera.org\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1541370732-3d2c4c3eb567?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1541370732-3d2c4c3eb567?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Experi√™ncia Gastron√¥mica no Mercad√£o\",\n    description: \"Aventura culin√°ria no famoso Mercado Municipal! Deguste o sandu√≠che de mortadela, past√©is, frutas ex√≥ticas e outros sabores √∫nicos de S√£o Paulo.\",\n    location: \"S√£o Paulo, SP\",\n    category: \"food\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 65.00,\n    duration: \"2.5 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 4,\n    maxParticipants: 18,\n    languages: [\"portugu√™s\", \"ingl√™s\"],\n    inclusions: [\"Degusta√ß√£o de 8 especialidades\", \"Guia gastron√¥mico\", \"√Ågua mineral\"],\n    exclusions: [\"Bebidas alco√≥licas\", \"Compras adicionais\"],\n    requirements: [\"Informar alergias alimentares\", \"N√£o recomendado para veganos\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 3 horas antes\",\n    contactInfo: {\n      email: \"gastronomia@mercadao.com.br\",\n      phone: \"(11) 3313-3365\",\n      whatsapp: \"+5511987654321\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1567306301408-9b74779a11af?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Street Art Tour - Beco do Batman\",\n    description: \"Imers√£o na arte urbana de S√£o Paulo! Explore o famoso Beco do Batman e outros pontos de street art em Vila Madalena com artistas locais.\",\n    location: \"S√£o Paulo, SP\",\n    category: \"culture\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 50.00,\n    duration: \"3 horas\",\n    difficultyLevel: \"moderate\",\n    minParticipants: 3,\n    maxParticipants: 12,\n    languages: [\"portugu√™s\", \"ingl√™s\"],\n    inclusions: [\"Guia artista local\", \"Visita a 5 pontos de street art\", \"Oficina de stencil\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Materiais de arte\", \"Transporte\"],\n    requirements: [\"Condicionamento f√≠sico b√°sico\", \"Roupas que podem sujar\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 2 horas antes\",\n    contactInfo: {\n      email: \"arte@streetartsp.com.br\",\n      phone: \"(11) 3031-2020\",\n      whatsapp: \"+5511912345678\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Visita ao MASP - Museu de Arte\",\n    description: \"Conhe√ßa o ic√¥nico Museu de Arte de S√£o Paulo! Veja obras de Van Gogh, Picasso e Rembrandt na famosa estrutura suspensa da Avenida Paulista.\",\n    location: \"S√£o Paulo, SP\",\n    category: \"culture\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 30.00,\n    duration: \"2 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 1,\n    maxParticipants: 20,\n    languages: [\"portugu√™s\", \"ingl√™s\"],\n    inclusions: [\"Entrada do museu\", \"Guia de arte\", \"Audioguia\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Estacionamento\"],\n    requirements: [\"N√£o √© permitido fotografar algumas obras\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 1 hora antes\",\n    contactInfo: {\n      email: \"visitacao@masp.org.br\",\n      phone: \"(11) 3149-5959\",\n      website: \"https://www.masp.org.br\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1594736797933-d0401ba2a89b?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1541370732-3d2c4c3eb567?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1594736797933-d0401ba2a89b?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Passeio Cultural pela Liberdade\",\n    description: \"Descubra a maior comunidade japonesa fora do Jap√£o! Explore templos, lojas tradicionais e prove a aut√™ntica culin√°ria japonesa no bairro da Liberdade.\",\n    location: \"S√£o Paulo, SP\",\n    category: \"culture\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 55.00,\n    duration: \"3.5 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 2,\n    maxParticipants: 15,\n    languages: [\"portugu√™s\", \"japon√™s\"],\n    inclusions: [\"Guia cultural\", \"Degusta√ß√£o de doces japoneses\", \"Entrada no templo\"],\n    exclusions: [\"Almo√ßo\", \"Compras\", \"Transporte\"],\n    requirements: [\"Respeitar costumes locais\", \"Tirar sapatos nos templos\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 2 horas antes\",\n    contactInfo: {\n      email: \"cultura@liberdade.com.br\",\n      phone: \"(11) 3209-5555\",\n      whatsapp: \"+5511987456123\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1528360983277-13d401cdc186?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1528360983277-13d401cdc186?w=800&q=80\",\n    createdById: 1\n  },\n\n  // Florian√≥polis Activities\n  {\n    title: \"Trilha para Lagoinha do Leste\",\n    description: \"A praia mais bonita de Florian√≥polis! Trilha de 2 horas pela natureza at√© uma praia paradis√≠aca com √°guas cristalinas e dunas de areia.\",\n    location: \"Florian√≥polis, SC\",\n    category: \"adventure\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 75.00,\n    duration: \"6 horas\",\n    difficultyLevel: \"moderate\",\n    minParticipants: 4,\n    maxParticipants: 12,\n    languages: [\"portugu√™s\"],\n    inclusions: [\"Guia de trilha\", \"Lanche energ√©tico\", \"Seguro de aventura\"],\n    exclusions: [\"Transporte at√© o in√≠cio da trilha\", \"Equipamentos pessoais\"],\n    requirements: [\"Bom condicionamento f√≠sico\", \"Cal√ßados de trilha\", \"Protetor solar\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 12 horas antes\",\n    contactInfo: {\n      email: \"trilhas@floripa.com.br\",\n      phone: \"(48) 3334-5555\",\n      whatsapp: \"+5548999887766\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Sandboard na Praia da Joaquina\",\n    description: \"Aventura nas dunas de areia branca! Aprenda sandboard nas famosas dunas da Joaquina, uma das praias mais conhecidas para surf em Florian√≥polis.\",\n    location: \"Florian√≥polis, SC\",\n    category: \"adventure\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 85.00,\n    duration: \"3 horas\",\n    difficultyLevel: \"moderate\",\n    minParticipants: 2,\n    maxParticipants: 8,\n    languages: [\"portugu√™s\", \"ingl√™s\"],\n    inclusions: [\"Equipamento de sandboard\", \"Instrutor\", \"Seguro de atividade\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Transporte\"],\n    requirements: [\"Idade m√≠nima: 12 anos\", \"Roupas que podem sujar\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 4 horas antes\",\n    contactInfo: {\n      email: \"sandboard@joaquina.com.br\",\n      phone: \"(48) 3232-8888\",\n      whatsapp: \"+5548987654321\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Esportes Aqu√°ticos na Lagoa da Concei√ß√£o\",\n    description: \"Divers√£o na lagoa mais famosa da ilha! Stand-up paddle, caiaque e windsurf na Lagoa da Concei√ß√£o, com vista para as montanhas e dunas.\",\n    location: \"Florian√≥polis, SC\",\n    category: \"water_sports\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 95.00,\n    duration: \"4 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 2,\n    maxParticipants: 10,\n    languages: [\"portugu√™s\", \"ingl√™s\"],\n    inclusions: [\"Equipamentos (SUP, caiaque)\", \"Instrutor\", \"Colete salva-vidas\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Roupas de neoprene\"],\n    requirements: [\"Saber nadar\", \"Trazer roupa de banho\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 3 horas antes\",\n    contactInfo: {\n      email: \"esportes@lagoa.com.br\",\n      phone: \"(48) 3232-4444\",\n      whatsapp: \"+5548912345678\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Centro Hist√≥rico e Mercado P√∫blico\",\n    description: \"Mergulhe na hist√≥ria de Florian√≥polis! Conhe√ßa o centro hist√≥rico, a famosa Figueira centen√°ria e deguste pratos t√≠picos no Mercado P√∫blico.\",\n    location: \"Florian√≥polis, SC\",\n    category: \"culture\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 45.00,\n    duration: \"3 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 3,\n    maxParticipants: 20,\n    languages: [\"portugu√™s\"],\n    inclusions: [\"Guia hist√≥rico\", \"Degusta√ß√£o de sequ√™ncia de camar√£o\", \"Entrada nos museus\"],\n    exclusions: [\"Bebidas alco√≥licas\", \"Compras no mercado\"],\n    requirements: [\"Documentos com foto\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 2 horas antes\",\n    contactInfo: {\n      email: \"historia@floripa.com.br\",\n      phone: \"(48) 3251-1234\",\n      website: \"https://www.pmf.sc.gov.br\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1528360983277-13d401cdc186?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Beach Club em Jurer√™ Internacional\",\n    description: \"Viva a sofistica√ß√£o de Florian√≥polis! Dia completo nos melhores beach clubs de Jurer√™, com m√∫sica ao vivo, gastronomia e vista para o mar.\",\n    location: \"Florian√≥polis, SC\",\n    category: \"nightlife\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 180.00,\n    duration: \"8 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 2,\n    maxParticipants: 15,\n    languages: [\"portugu√™s\", \"ingl√™s\"],\n    inclusions: [\"Entrada no beach club\", \"Welcome drink\", \"Cadeira e sombreiro\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Bebidas adicionais\", \"Transporte\"],\n    requirements: [\"Idade m√≠nima: 18 anos\", \"Traje social beach\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 24 horas antes\",\n    contactInfo: {\n      email: \"eventos@jurere.com.br\",\n      phone: \"(48) 3261-5555\",\n      whatsapp: \"+5548987123456\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=800&q=80\",\n    createdById: 1\n  },\n\n  // Salvador Activities\n  {\n    title: \"Tour pelo Pelourinho\",\n    description: \"Patrim√¥nio Mundial da UNESCO! Caminhada pelas ruas coloridas do centro hist√≥rico de Salvador, com visita √†s igrejas barrocas e museus.\",\n    location: \"Salvador, BA\",\n    category: \"culture\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 55.00,\n    duration: \"3 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 4,\n    maxParticipants: 25,\n    languages: [\"portugu√™s\", \"ingl√™s\"],\n    inclusions: [\"Guia hist√≥rico\", \"Entrada nos museus\", \"Apresenta√ß√£o de capoeira\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Lembran√ßas\"],\n    requirements: [\"Sapatos confort√°veis\", \"Protetor solar\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 2 horas antes\",\n    contactInfo: {\n      email: \"turismo@pelourinho.com.br\",\n      phone: \"(71) 3116-6000\",\n      website: \"https://www.pelourinho.ba.gov.br\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1528360983277-13d401cdc186?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Igreja de S√£o Francisco - Arte Barroca\",\n    description: \"Maravilha do barroco brasileiro! Visita guiada √† igreja mais ornamentada do Brasil, com altar folheado a ouro e azulejos portugueses.\",\n    location: \"Salvador, BA\",\n    category: \"culture\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 35.00,\n    duration: \"1.5 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 1,\n    maxParticipants: 30,\n    languages: [\"portugu√™s\", \"ingl√™s\"],\n    inclusions: [\"Entrada da igreja\", \"Guia especializado em arte sacra\"],\n    exclusions: [\"Fotografias do interior\"],\n    requirements: [\"Vestimenta adequada para templo religioso\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 1 hora antes\",\n    contactInfo: {\n      email: \"visitas@saofrancisco.org.br\",\n      phone: \"(71) 3321-6968\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1594736797933-d0401ba2a89b?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1528360983277-13d401cdc186?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1594736797933-d0401ba2a89b?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Elevador Lacerda e Cidade Baixa\",\n    description: \"Patrim√¥nio hist√≥rico e vista incr√≠vel! Suba no primeiro elevador urbano do mundo e explore a Cidade Baixa com o Mercado Modelo.\",\n    location: \"Salvador, BA\",\n    category: \"sightseeing\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 25.00,\n    duration: \"2 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 2,\n    maxParticipants: 20,\n    languages: [\"portugu√™s\"],\n    inclusions: [\"Passagem do elevador\", \"Guia local\", \"Visita ao Mercado Modelo\"],\n    exclusions: [\"Compras\", \"Alimenta√ß√£o\"],\n    requirements: [\"Documento com foto\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 30 minutos antes\",\n    contactInfo: {\n      email: \"elevador@salvador.ba.gov.br\",\n      phone: \"(71) 3116-4800\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Praia do Porto da Barra\",\n    description: \"A praia urbana mais famosa de Salvador! Relaxe nas areias douradas com vista para o p√¥r do sol mais bonito da Bahia.\",\n    location: \"Salvador, BA\",\n    category: \"beach\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 40.00,\n    duration: \"4 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 2,\n    maxParticipants: 15,\n    languages: [\"portugu√™s\"],\n    inclusions: [\"Cadeira e guarda-sol\", \"√Ågua de coco\", \"Protetor solar\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Transporte\"],\n    requirements: [\"Traje de banho\", \"Toalha\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 2 horas antes\",\n    contactInfo: {\n      email: \"praia@portobarra.com.br\",\n      phone: \"(71) 3264-4000\",\n      whatsapp: \"+5571987654321\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1483729558449-99ef09a8c325?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Experi√™ncia Gastron√¥mica Baiana\",\n    description: \"Sabores √∫nicos da Bahia! Aprenda a fazer acaraj√©, prove moqueca de camar√£o e descubra os temperos e ingredientes t√≠picos baianos.\",\n    location: \"Salvador, BA\",\n    category: \"food\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 80.00,\n    duration: \"4 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 6,\n    maxParticipants: 12,\n    languages: [\"portugu√™s\"],\n    inclusions: [\"Aula de culin√°ria\", \"Degusta√ß√£o completa\", \"Receitas impressas\"],\n    exclusions: [\"Bebidas alco√≥licas\", \"Transporte\"],\n    requirements: [\"Informar restri√ß√µes alimentares\", \"Avental fornecido\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 6 horas antes\",\n    contactInfo: {\n      email: \"culinaria@bahia.com.br\",\n      phone: \"(71) 3321-9999\",\n      whatsapp: \"+5571912345678\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1567306301408-9b74779a11af?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1504674900247-0877df9cc836?w=800&q=80\",\n    createdById: 1\n  },\n\n  // Campos do Jord√£o Activities\n  {\n    title: \"Passeio no Parque Amantikir\",\n    description: \"Jardim bot√¢nico espetacular! Explore mais de 700 esp√©cies de plantas em 60 mil m¬≤ de jardins tem√°ticos com vista para as montanhas.\",\n    location: \"Campos do Jord√£o, SP\",\n    category: \"nature\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 45.00,\n    duration: \"3 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 1,\n    maxParticipants: 30,\n    languages: [\"portugu√™s\"],\n    inclusions: [\"Entrada do parque\", \"Guia bot√¢nico\", \"Mapa ilustrado\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Transporte\"],\n    requirements: [\"Sapatos confort√°veis\", \"Roupas adequadas ao clima\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 2 horas antes\",\n    contactInfo: {\n      email: \"visitas@amantikir.com.br\",\n      phone: \"(12) 3668-1000\",\n      website: \"https://www.amantikir.com.br\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Vila Capivari - Gastronomia e Compras\",\n    description: \"Charme europeu no cora√ß√£o de Campos do Jord√£o! Explore a famosa Vila Capivari com restaurantes, lojas e arquitetura alem√£.\",\n    location: \"Campos do Jord√£o, SP\",\n    category: \"culture\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 60.00,\n    duration: \"4 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 2,\n    maxParticipants: 20,\n    languages: [\"portugu√™s\"],\n    inclusions: [\"Guia local\", \"Degusta√ß√£o de chocolate\", \"Entrada no Memorial\"],\n    exclusions: [\"Almo√ßo\", \"Compras\", \"Transporte\"],\n    requirements: [\"Roupas de frio\", \"Documentos\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 3 horas antes\",\n    contactInfo: {\n      email: \"turismo@capivari.com.br\",\n      phone: \"(12) 3664-4000\",\n      whatsapp: \"+5512987654321\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1528360983277-13d401cdc186?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Horto Florestal - Trilhas e Arvorismo\",\n    description: \"Aventura na natureza! Trilhas no Horto Florestal com arvorismo, tirolesa e contato com a Mata Atl√¢ntica preservada.\",\n    location: \"Campos do Jord√£o, SP\",\n    category: \"adventure\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 85.00,\n    duration: \"5 horas\",\n    difficultyLevel: \"moderate\",\n    minParticipants: 4,\n    maxParticipants: 15,\n    languages: [\"portugu√™s\"],\n    inclusions: [\"Equipamentos de seguran√ßa\", \"Instrutor\", \"Seguro de atividade\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Roupas espec√≠ficas\"],\n    requirements: [\"Idade m√≠nima: 8 anos\", \"Peso m√°ximo: 120kg\", \"Condicionamento f√≠sico\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 12 horas antes\",\n    contactInfo: {\n      email: \"aventura@horto.com.br\",\n      phone: \"(12) 3663-3762\",\n      whatsapp: \"+5512912345678\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Pico do Itapeva - Nascer do Sol\",\n    description: \"Vista espetacular a 2.000 metros! Excurs√£o para ver o nascer do sol no ponto mais alto de Campos do Jord√£o com vista do Vale do Para√≠ba.\",\n    location: \"Campos do Jord√£o, SP\",\n    category: \"sightseeing\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 70.00,\n    duration: \"4 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 3,\n    maxParticipants: 18,\n    languages: [\"portugu√™s\"],\n    inclusions: [\"Transporte 4x4\", \"Guia de montanha\", \"Chocolate quente\"],\n    exclusions: [\"Caf√© da manh√£\", \"Roupas de frio\"],\n    requirements: [\"Sa√≠da √†s 5h30\", \"Roupas muito quentes\", \"Cal√ßados fechados\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 18 horas antes\",\n    contactInfo: {\n      email: \"itapeva@montanha.com.br\",\n      phone: \"(12) 3664-7777\",\n      whatsapp: \"+5512987123456\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    createdById: 1\n  },\n  {\n    title: \"Ducha de Prata - Tirolesa e Cachoeiras\",\n    description: \"Divers√£o e natureza! Complexo de cachoeiras artificiais com tirolesa sobre as √°guas e trilhas pela mata preservada.\",\n    location: \"Campos do Jord√£o, SP\",\n    category: \"adventure\",\n    \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n    priceAmount: 50.00,\n    duration: \"3 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 2,\n    maxParticipants: 25,\n    languages: [\"portugu√™s\"],\n    inclusions: [\"Entrada do complexo\", \"Tirolesa\", \"Equipamentos\"],\n    exclusions: [\"Alimenta√ß√£o\", \"Estacionamento\"],\n    requirements: [\"Idade m√≠nima: 6 anos\", \"Roupas que podem molhar\"],\n    cancellationPolicy: \"Cancelamento gratuito at√© 1 hora antes\",\n    contactInfo: {\n      email: \"info@duchadeprata.com.br\",\n      phone: \"(12) 3664-2988\",\n      whatsapp: \"+5512987456789\"\n    },\n    images: [\n      \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n      \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\"\n    ],\n    coverImage: \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n    createdById: 1\n  }\n];\n\nexport async function createActivitiesData() {\n  try {\n    await createActivitiesTable();\n    \n    console.log(\"üéØ Inserindo atividades tur√≠sticas...\");\n    \n    for (const activity of activityData) {\n      try {\n        // Insert activity\n        const [result] = await db.insert(activities).values({\n          title: activity.title,\n          description: activity.description,\n          location: activity.location,\n          category: activity.category,\n          priceType: activity.priceType,\n          priceAmount: activity.priceAmount.toString(),\n          duration: activity.duration,\n          difficultyLevel: activity.difficultyLevel,\n          minParticipants: activity.minParticipants,\n          maxParticipants: activity.maxParticipants,\n          languages: JSON.stringify(activity.languages),\n          inclusions: JSON.stringify(activity.inclusions),\n          exclusions: JSON.stringify(activity.exclusions),\n          requirements: JSON.stringify(activity.requirements),\n          cancellationPolicy: activity.cancellationPolicy,\n          contactInfo: JSON.stringify(activity.contactInfo),\n          images: JSON.stringify(activity.images),\n          coverImage: activity.coverImage,\n          createdById: activity.createdById,\n          averageRating: \"4.5\",\n          totalRatings: Math.floor(Math.random() * 50) + 10\n        });\n        \n        const activityId = result.insertId;\n        \n        // Create budget proposals for each activity\n        const proposals = [\n          {\n            title: \"Op√ß√£o B√°sica\",\n            description: \"Pacote b√°sico com o essencial\",\n            amount: activity.priceAmount,\n            inclusions: activity.inclusions.slice(0, 2)\n          },\n          {\n            title: \"Op√ß√£o Completa\",\n            description: \"Pacote completo com todos os extras\",\n            amount: activity.priceAmount * 1.5,\n            inclusions: activity.inclusions\n          },\n          {\n            title: \"Op√ß√£o Premium\",\n            description: \"Experi√™ncia premium com servi√ßos exclusivos\",\n            amount: activity.priceAmount * 2,\n            inclusions: [...activity.inclusions, \"Transporte privado\", \"Fot√≥grafo profissional\"]\n          }\n        ];\n        \n        for (const proposal of proposals) {\n          await db.insert(activityBudgetProposals).values({\n            activityId: activityId,\n            createdBy: 1,\n            title: proposal.title,\n            description: proposal.description,\n            priceType: \"per_person\",\n            amount: proposal.amount.toString(),\n            currency: \"BRL\",\n            inclusions: JSON.stringify(proposal.inclusions),\n            exclusions: JSON.stringify(activity.exclusions),\n            isActive: true,\n            votes: Math.floor(Math.random() * 20) + 1\n          });\n        }\n        \n        console.log(`‚úÖ Atividade criada: ${activity.title}`);\n        \n      } catch (error) {\n        console.error(`‚ùå Erro ao criar atividade ${activity.title}:`, error);\n      }\n    }\n    \n    console.log(\"üéâ Todas as atividades foram criadas com sucesso!\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro ao criar dados de atividades:\", error);\n  }\n}\n\n// Run if called directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  createActivitiesData();\n}","size_bytes":36497},"server/create-budget-proposals-simple.ts":{"content":"import { db } from './db.js';\n\nasync function createBudgetProposalsSimple() {\n  try {\n    console.log('üí∞ CRIANDO PROPOSTAS DE OR√áAMENTO PARA TODAS AS ATIVIDADES...\\n');\n    \n    // Buscar todas as atividades\n    const [activitiesResult] = await db.execute('SELECT id, title, location FROM activities ORDER BY id');\n    const activities = activitiesResult as any[];\n    \n    console.log(`üìä Encontradas ${activities.length} atividades`);\n    \n    let totalProposals = 0;\n    \n    for (const activity of activities) {\n      console.log(`\\nüí° Criando propostas para: ${activity.title} (${activity.location})`);\n      \n      // Verificar se j√° tem propostas\n      const [existingResult] = await db.execute(\n        `SELECT COUNT(*) as count FROM activity_budget_proposals WHERE activity_id = ${activity.id}`\n      );\n      \n      const existingCount = (existingResult as any)[0].count;\n      if (existingCount > 0) {\n        console.log(`  ‚ö†Ô∏è  J√° possui ${existingCount} propostas - pulando`);\n        continue;\n      }\n      \n      // Criar 3 propostas para cada atividade\n      const basePrice = Math.floor(Math.random() * 100) + 50; // R$ 50-150 base\n      \n      const proposals = [\n        {\n          title: 'Econ√¥mico',\n          description: 'Op√ß√£o b√°sica com o essencial para a atividade',\n          amount: basePrice,\n          inclusions: '[\"Guia local\", \"Seguro b√°sico\"]',\n          exclusions: '[\"Transporte\", \"Alimenta√ß√£o\", \"Equipamentos extras\"]'\n        },\n        {\n          title: 'Completo',\n          description: 'Experi√™ncia completa com conforto e praticidade',\n          amount: Math.floor(basePrice * 1.6),\n          inclusions: '[\"Guia especializado\", \"Transporte\", \"Seguro\", \"Lanche\", \"Equipamentos\"]',\n          exclusions: '[\"Alimenta√ß√£o completa\", \"Bebidas alco√≥licas\"]'\n        },\n        {\n          title: 'Premium',\n          description: 'Experi√™ncia de luxo com todos os extras inclu√≠dos',\n          amount: Math.floor(basePrice * 2.5),\n          inclusions: '[\"Guia exclusivo\", \"Transporte executivo\", \"Seguro premium\", \"Alimenta√ß√£o completa\", \"Equipamentos profissionais\", \"Fotos\", \"Souvenirs\"]',\n          exclusions: '[]'\n        }\n      ];\n      \n      for (const proposal of proposals) {\n        try {\n          const sql = `\n            INSERT INTO activity_budget_proposals (\n              activity_id, created_by, title, description, \n              price_type, amount, currency, inclusions, exclusions,\n              is_active, votes, created_at, updated_at\n            ) VALUES (\n              ${activity.id}, \n              1, \n              '${proposal.title}', \n              '${proposal.description}', \n              'per_person', \n              ${proposal.amount}, \n              'BRL', \n              '${proposal.inclusions}', \n              '${proposal.exclusions}',\n              1, \n              0, \n              NOW(), \n              NOW()\n            )\n          `;\n          \n          await db.execute(sql);\n          \n          console.log(`    ‚úÖ ${proposal.title}: R$ ${proposal.amount}`);\n          totalProposals++;\n          \n        } catch (error) {\n          console.error(`    ‚ùå Erro ao criar proposta ${proposal.title}:`, error);\n        }\n      }\n    }\n    \n    console.log(`\\n‚úÖ Processo conclu√≠do! ${totalProposals} propostas criadas.`);\n    \n    // Verificar resultado final\n    const [finalResult] = await db.execute(`\n      SELECT \n        a.id,\n        a.title,\n        a.location,\n        COUNT(p.id) as proposals_count,\n        GROUP_CONCAT(CONCAT(p.title, ': R$ ', p.amount) SEPARATOR ', ') as proposals\n      FROM activities a\n      LEFT JOIN activity_budget_proposals p ON a.id = p.activity_id\n      GROUP BY a.id, a.title, a.location\n      ORDER BY a.id\n      LIMIT 10\n    `);\n    \n    console.log('\\nüìä VERIFICA√á√ÉO FINAL (primeiras 10 atividades):');\n    (finalResult as any).forEach(row => {\n      console.log(`\\n  ${row.title} (${row.location})`);\n      console.log(`    Propostas: ${row.proposals_count}`);\n      if (row.proposals) {\n        console.log(`    Detalhes: ${row.proposals}`);\n      }\n    });\n    \n    // Verificar total geral\n    const [totalResult] = await db.execute('SELECT COUNT(*) as total FROM activity_budget_proposals');\n    const totalFinal = (totalResult as any)[0].total;\n    console.log(`\\nüéØ TOTAL FINAL: ${totalFinal} propostas de or√ßamento criadas`);\n    \n  } catch (error) {\n    console.error('‚ùå Erro durante cria√ß√£o de propostas:', error);\n  }\n  \n  process.exit(0);\n}\n\ncreateBudgetProposalsSimple();","size_bytes":4560},"server/create-budget-proposals.ts":{"content":"import { db } from './db.js';\n\nasync function createBudgetProposals() {\n  try {\n    console.log('üí∞ CRIANDO PROPOSTAS DE OR√áAMENTO PARA TODAS AS ATIVIDADES...\\n');\n    \n    // Buscar todas as atividades\n    const [activitiesResult] = await db.execute('SELECT id, title, location FROM activities ORDER BY id');\n    const activities = activitiesResult as any[];\n    \n    console.log(`üìä Encontradas ${activities.length} atividades`);\n    \n    let totalProposals = 0;\n    \n    for (const activity of activities) {\n      console.log(`\\nüí° Criando propostas para: ${activity.title} (${activity.location})`);\n      \n      // Verificar se j√° tem propostas\n      const [existingResult] = await db.execute(\n        'SELECT COUNT(*) as count FROM activity_budget_proposals WHERE activity_id = ?',\n        [activity.id]\n      );\n      \n      const existingCount = (existingResult as any)[0].count;\n      if (existingCount > 0) {\n        console.log(`  ‚ö†Ô∏è  J√° possui ${existingCount} propostas - pulando`);\n        continue;\n      }\n      \n      // Criar 3 propostas para cada atividade\n      const basePrice = Math.floor(Math.random() * 100) + 50; // R$ 50-150 base\n      \n      const proposals = [\n        {\n          title: 'Econ√¥mico',\n          description: 'Op√ß√£o b√°sica com o essencial para a atividade',\n          amount: basePrice,\n          inclusions: JSON.stringify(['Guia local', 'Seguro b√°sico']),\n          exclusions: JSON.stringify(['Transporte', 'Alimenta√ß√£o', 'Equipamentos extras'])\n        },\n        {\n          title: 'Completo',\n          description: 'Experi√™ncia completa com conforto e praticidade',\n          amount: Math.floor(basePrice * 1.6),\n          inclusions: JSON.stringify(['Guia especializado', 'Transporte', 'Seguro', 'Lanche', 'Equipamentos']),\n          exclusions: JSON.stringify(['Alimenta√ß√£o completa', 'Bebidas alco√≥licas'])\n        },\n        {\n          title: 'Premium',\n          description: 'Experi√™ncia de luxo com todos os extras inclu√≠dos',\n          amount: Math.floor(basePrice * 2.5),\n          inclusions: JSON.stringify(['Guia exclusivo', 'Transporte executivo', 'Seguro premium', 'Alimenta√ß√£o completa', 'Equipamentos profissionais', 'Fotos', 'Souvenirs']),\n          exclusions: JSON.stringify([])\n        }\n      ];\n      \n      for (const proposal of proposals) {\n        try {\n          await db.execute(`\n            INSERT INTO activity_budget_proposals (\n              activity_id, created_by, title, description, \n              price_type, amount, currency, inclusions, exclusions,\n              is_active, votes, created_at, updated_at\n            ) VALUES (?, 1, ?, ?, 'per_person', ?, 'BRL', ?, ?, 1, 0, NOW(), NOW())\n          `, [\n            activity.id,\n            proposal.title,\n            proposal.description,\n            proposal.amount,\n            proposal.inclusions,\n            proposal.exclusions\n          ]);\n          \n          console.log(`    ‚úÖ ${proposal.title}: R$ ${proposal.amount}`);\n          totalProposals++;\n          \n        } catch (error) {\n          console.error(`    ‚ùå Erro ao criar proposta ${proposal.title}:`, error);\n        }\n      }\n    }\n    \n    console.log(`\\n‚úÖ Processo conclu√≠do! ${totalProposals} propostas criadas.`);\n    \n    // Verificar resultado final\n    const [finalResult] = await db.execute(`\n      SELECT \n        a.id,\n        a.title,\n        a.location,\n        COUNT(p.id) as proposals_count,\n        GROUP_CONCAT(CONCAT(p.title, ': R$ ', p.amount) SEPARATOR ', ') as proposals\n      FROM activities a\n      LEFT JOIN activity_budget_proposals p ON a.id = p.activity_id\n      GROUP BY a.id, a.title, a.location\n      ORDER BY a.id\n      LIMIT 10\n    `);\n    \n    console.log('\\nüìä VERIFICA√á√ÉO FINAL (primeiras 10 atividades):');\n    (finalResult as any).forEach(row => {\n      console.log(`\\n  ${row.title} (${row.location})`);\n      console.log(`    Propostas: ${row.proposals_count}`);\n      if (row.proposals) {\n        console.log(`    Detalhes: ${row.proposals}`);\n      }\n    });\n    \n  } catch (error) {\n    console.error('‚ùå Erro durante cria√ß√£o de propostas:', error);\n  }\n  \n  process.exit(0);\n}\n\ncreateBudgetProposals();","size_bytes":4198},"server/create-missing-proposals.ts":{"content":"#!/usr/bin/env tsx\nimport { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { sql } from 'drizzle-orm';\n\n/**\n * Create budget proposals for activities that don't have any\n */\n\nasync function createMissingProposals() {\n  console.log('üîß Creating missing budget proposals...');\n  \n  // Find activities without proposals\n  const activitiesWithoutProposals = await db.select({\n    id: activities.id,\n    title: activities.title,\n    location: activities.location,\n    category: activities.category,\n    countryType: activities.countryType\n  }).from(activities)\n  .leftJoin(activityBudgetProposals, sql`${activities.id} = ${activityBudgetProposals.activityId}`)\n  .where(sql`${activityBudgetProposals.activityId} IS NULL`);\n  \n  console.log(`üìä Found ${activitiesWithoutProposals.length} activities without proposals`);\n  \n  for (const activity of activitiesWithoutProposals) {\n    console.log(`üí∞ Creating proposals for: ${activity.title}`);\n    \n    // Determine currency and price range based on location\n    let currency = 'BRL';\n    let basePrice = 100;\n    \n    if (activity.countryType === 'internacional') {\n      if (activity.location?.includes('Argentina')) {\n        currency = 'USD';\n        basePrice = 15;\n      } else if (activity.location?.includes('EUA') || activity.location?.includes('Nova York')) {\n        currency = 'USD';\n        basePrice = 50;\n      } else if (activity.location?.includes('Reino Unido') || activity.location?.includes('Londres')) {\n        currency = 'GBP';\n        basePrice = 25;\n      } else if (activity.location?.includes('It√°lia') || activity.location?.includes('Roma')) {\n        currency = 'EUR';\n        basePrice = 30;\n      } else if (activity.location?.includes('Fran√ßa') || activity.location?.includes('Paris')) {\n        currency = 'EUR';\n        basePrice = 35;\n      }\n    }\n    \n    // Adjust price based on category\n    if (activity.category === 'adventure' || activity.category === 'water_sports') {\n      basePrice *= 1.5;\n    } else if (activity.category === 'cultural' || activity.category === 'sightseeing') {\n      basePrice *= 0.8;\n    } else if (activity.category === 'food_tours') {\n      basePrice *= 1.2;\n    }\n    \n    const proposals = [\n      {\n        title: 'Econ√¥mico',\n        description: 'Op√ß√£o b√°sica com o essencial inclu√≠do',\n        amount: basePrice.toFixed(2),\n        currency,\n        inclusions: JSON.stringify(['Guia local', 'Entrada b√°sica', 'Seguro']),\n        exclusions: JSON.stringify(['Alimenta√ß√£o', 'Transporte', 'Souvenirs']),\n        activityId: activity.id,\n        createdBy: 1,\n        isActive: true\n      },\n      {\n        title: 'Completo',\n        description: 'Experi√™ncia completa com extras inclu√≠dos',\n        amount: (basePrice * 1.5).toFixed(2),\n        currency,\n        inclusions: JSON.stringify(['Guia especializado', 'Entrada premium', 'Lanche', 'Fotos', 'Seguro']),\n        exclusions: JSON.stringify(['Bebidas extras', 'Transporte', 'Souvenirs']),\n        activityId: activity.id,\n        createdBy: 1,\n        isActive: true\n      },\n      {\n        title: 'Premium',\n        description: 'Experi√™ncia VIP com tudo inclu√≠do',\n        amount: (basePrice * 2.5).toFixed(2),\n        currency,\n        inclusions: JSON.stringify(['Guia privado', 'Acesso VIP', 'Refei√ß√£o completa', 'Transporte', 'Fotos profissionais', 'Brinde exclusivo']),\n        exclusions: JSON.stringify(['Bebidas alco√≥licas premium', 'Gorjetas']),\n        activityId: activity.id,\n        createdBy: 1,\n        isActive: true\n      }\n    ];\n    \n    for (const proposal of proposals) {\n      try {\n        await db.insert(activityBudgetProposals).values(proposal);\n        console.log(`  ‚úÖ ${proposal.title}: ${proposal.currency} ${proposal.amount}`);\n      } catch (error: any) {\n        if (error.code !== 'ER_DUP_ENTRY') {\n          console.error(`  ‚ùå Error creating ${proposal.title}:`, error.message);\n        }\n      }\n    }\n  }\n  \n  console.log('üéâ Missing proposals creation completed!');\n}\n\ncreateMissingProposals().catch(console.error);","size_bytes":4114},"server/create-referral-codes.ts":{"content":"import { db } from \"./db\";\nimport { referralCodes } from \"@shared/schema\";\nimport { eq } from \"drizzle-orm\";\n\nasync function createReferralCodes() {\n  try {\n    console.log('üé´ Criando c√≥digos de indica√ß√£o para teste...');\n\n    const codes = [\n      { code: 'BETA2025', maxUses: 100 },\n      { code: 'VIAJANTE', maxUses: 50 },\n      { code: 'AMIGO123', maxUses: 10 },\n      { code: 'TESTE', maxUses: 1 },\n      { code: 'EXPLORER', maxUses: 25 },\n    ];\n\n    for (const codeData of codes) {\n      // Check if code already exists\n      const existing = await db.select()\n        .from(referralCodes)\n        .where(eq(referralCodes.code, codeData.code))\n        .limit(1);\n\n      if (existing.length === 0) {\n        await db.insert(referralCodes).values({\n          code: codeData.code,\n          maxUses: codeData.maxUses,\n          currentUses: 0,\n          isActive: true,\n          createdBy: null, // System created\n          expiresAt: null, // No expiration\n        });\n        console.log(`‚úÖ C√≥digo criado: ${codeData.code} (${codeData.maxUses} usos)`);\n      } else {\n        console.log(`‚ÑπÔ∏è C√≥digo j√° existe: ${codeData.code}`);\n      }\n    }\n\n    console.log('üéâ C√≥digos de indica√ß√£o criados com sucesso!');\n  } catch (error) {\n    console.error('‚ùå Erro ao criar c√≥digos de indica√ß√£o:', error);\n  }\n}\n\nexport { createReferralCodes };","size_bytes":1367},"server/create-reviews.ts":{"content":"import { db } from './db.js';\nimport { sql } from 'drizzle-orm';\n\nasync function createActivityReviews() {\n  console.log('‚≠ê Criando avalia√ß√µes real√≠sticas para todas as atividades...');\n\n  try {\n    // Obter todas as atividades e usu√°rios\n    const activities = await db.execute(sql`SELECT id, title FROM activities`);\n    const users = await db.execute(sql`SELECT id, username FROM users`);\n    \n    console.log(`üìä Encontradas ${activities.length} atividades e ${users.length} usu√°rios`);\n\n    // Limpar avalia√ß√µes existentes (se houver)\n    await db.execute(sql`DELETE FROM activity_reviews`);\n\n    let totalReviews = 0;\n\n    // Coment√°rios real√≠sticos para as avalia√ß√µes\n    const reviewComments = [\n      'Experi√™ncia incr√≠vel! Superou todas as expectativas. Recomendo muito!',\n      'Muito bom, mas poderia ser um pouco melhor organizado.',\n      'Perfeito! Vista sensacional e atendimento excelente.',\n      'Legal, mas achei um pouco caro para o que oferece.',\n      'Fant√°stico! Uma das melhores experi√™ncias que j√° tive.',\n      'Boa atividade, mas estava muito cheio no dia.',\n      'Maravilhoso! Vale cada centavo. Voltaria com certeza.',\n      'Interessante, mas esperava mais. Talvez seja melhor em outra √©poca.',\n      'Simplesmente espetacular! N√£o h√° palavras para descrever.',\n      'Gostei, mas o tempo da atividade foi um pouco corrido.',\n      'Incr√≠vel! A vista √© de tirar o f√¥lego. Recomendo ir no p√¥r do sol.',\n      'Muito bem organizado e o guia foi excelente. Valeu muito a pena!',\n      'Atividade boa, mas o pre√ßo est√° meio salgado para o que oferece.',\n      'Adorei! Foi uma das melhores partes da minha viagem.',\n      'Experi√™ncia √∫nica! Definitivamente algo que todos deveriam fazer.'\n    ];\n\n    for (const activity of activities) {\n      console.log(`üí¨ Criando avalia√ß√µes para: ${activity.title}`);\n      \n      // Criar entre 2 a 6 avalia√ß√µes por atividade\n      const numReviews = Math.floor(Math.random() * 5) + 2;\n      const shuffledUsers = [...users].sort(() => Math.random() - 0.5);\n      \n      for (let i = 0; i < Math.min(numReviews, shuffledUsers.length); i++) {\n        const user = shuffledUsers[i];\n        const rating = Math.floor(Math.random() * 2) + 4; // Rating entre 4 e 5 (mais real√≠stico)\n        const comment = reviewComments[Math.floor(Math.random() * reviewComments.length)];\n        const helpfulVotes = Math.floor(Math.random() * 25) + 1;\n        const isVerified = Math.random() > 0.25; // 75% verificadas\n        \n        // Data de visita aleat√≥ria nos √∫ltimos 6 meses\n        const visitDate = new Date();\n        visitDate.setDate(visitDate.getDate() - Math.floor(Math.random() * 180));\n        const visitDateStr = visitDate.toISOString().split('T')[0];\n        \n        try {\n          await db.execute(sql`\n            INSERT INTO activity_reviews (\n              activity_id, user_id, rating, comment, visit_date, \n              is_verified, helpful_votes, is_hidden\n            ) VALUES (\n              ${activity.id},\n              ${user.id},\n              ${rating},\n              ${comment},\n              ${visitDateStr},\n              ${isVerified},\n              ${helpfulVotes},\n              false\n            )\n          `);\n          totalReviews++;\n        } catch (error) {\n          // Ignora erro de usu√°rio duplicado avaliando a mesma atividade\n          if (!error.message.includes('Duplicate entry')) {\n            console.error(`Erro ao criar avalia√ß√£o: ${error.message}`);\n          }\n        }\n      }\n    }\n\n    console.log(`‚úÖ ${totalReviews} avalia√ß√µes criadas com sucesso!`);\n\n    // Atualizar as m√©dias de rating das atividades\n    console.log('üìä Atualizando m√©dias de rating...');\n    await updateActivityRatings();\n\n  } catch (error) {\n    console.error('‚ùå Erro ao criar avalia√ß√µes:', error);\n    throw error;\n  }\n}\n\nasync function updateActivityRatings() {\n  // Atualizar a m√©dia de rating e total de avalia√ß√µes para cada atividade\n  await db.execute(sql`\n    UPDATE activities a\n    SET \n      average_rating = (\n        SELECT COALESCE(AVG(r.rating), 0)\n        FROM activity_reviews r \n        WHERE r.activity_id = a.id AND r.is_hidden = FALSE\n      ),\n      total_ratings = (\n        SELECT COUNT(*)\n        FROM activity_reviews r \n        WHERE r.activity_id = a.id AND r.is_hidden = FALSE\n      )\n  `);\n  \n  console.log('‚úÖ M√©dias de rating atualizadas!');\n}\n\n// Executar se chamado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  createActivityReviews()\n    .then(() => {\n      console.log('‚úÖ Cria√ß√£o de avalia√ß√µes conclu√≠da!');\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('‚ùå Erro no processo:', error);\n      process.exit(1);\n    });\n}","size_bytes":4769},"server/create-test-data.ts":{"content":"import { db } from './db.js';\nimport { sql } from 'drizzle-orm';\n\nasync function main() {\n  console.log('üå± Criando dados de teste completos...');\n\n  try {\n    // 1. Primeiro verificar quantas atividades temos\n    console.log('üìä Verificando atividades existentes...');\n    const activities = await db.execute(sql`SELECT id, title FROM activities WHERE id IS NOT NULL`);\n    console.log(`‚úÖ Encontradas ${activities.length} atividades:`);\n    activities.forEach(activity => {\n      console.log(`   - ID ${activity.id}: ${activity.title}`);\n    });\n\n    // 2. Criar propostas de or√ßamento usando IDs espec√≠ficos\n    console.log('\\nüí∞ Criando propostas de or√ßamento...');\n    \n    // Limpar propostas existentes\n    await db.execute(sql`DELETE FROM activity_budget_proposals WHERE 1=1`);\n    \n    // Cristo Redentor (ID 9)\n    await db.execute(sql`\n      INSERT INTO activity_budget_proposals \n      (activity_id, title, description, amount, currency, inclusions, exclusions, votes, is_popular) \n      VALUES \n      (9, 'Van Oficial', 'Transporte em van oficial at√© o Cristo Redentor', 85.00, 'BRL', \n       '[\"Transporte van\", \"Entrada do monumento\"]', '[\"Alimenta√ß√£o\", \"Bebidas\"]', 28, false),\n      (9, 'Trem do Corcovado', 'Experi√™ncia completa com trem e guia tur√≠stico', 160.00, 'BRL', \n       '[\"Trem do Corcovado\", \"Guia tur√≠stico\", \"Entrada\"]', '[\"Bebidas alco√≥licas\"]', 45, true),\n      (9, 'Tour Premium', 'Tour privativo com transporte executivo e fotografia', 320.00, 'BRL', \n       '[\"Transporte privativo\", \"Guia exclusivo\", \"Fotos profissionais\"]', '[\"Compras pessoais\"]', 18, false)\n    `);\n    \n    // P√£o de A√ß√∫car (ID 10)\n    await db.execute(sql`\n      INSERT INTO activity_budget_proposals \n      (activity_id, title, description, amount, currency, inclusions, exclusions, votes, is_popular) \n      VALUES \n      (10, 'Ingresso Simples', 'Bondinho ida e volta com acesso aos mirantes', 120.00, 'BRL', \n       '[\"Bondinho ida/volta\", \"Acesso mirantes\"]', '[\"Alimenta√ß√£o\", \"Bebidas\"]', 15, false),\n      (10, 'Com Guia Tur√≠stico', 'Bondinho com guia especializado e material informativo', 190.00, 'BRL', \n       '[\"Bondinho\", \"Guia tur√≠stico\", \"Material informativo\"]', '[\"Fotos profissionais\"]', 32, true),\n      (10, 'Experi√™ncia VIP', 'Bondinho + voo de helic√≥ptero + jantar com vista', 650.00, 'BRL', \n       '[\"Bondinho\", \"Helic√≥ptero 15min\", \"Jantar panor√¢mico\"]', '[\"Compras pessoais\"]', 12, false)\n    `);\n\n    // Copacabana/Ipanema (ID 11)\n    await db.execute(sql`\n      INSERT INTO activity_budget_proposals \n      (activity_id, title, description, amount, currency, inclusions, exclusions, votes, is_popular) \n      VALUES \n      (11, 'Aula de Surf', 'Aula b√°sica de surf com instrutor qualificado', 100.00, 'BRL', \n       '[\"Aula de surf\", \"Prancha\", \"Instrutor\"]', '[\"Transporte\", \"Alimenta√ß√£o\"]', 22, false),\n      (11, 'Dia Completo', 'Surf + v√¥lei + bike tour pela orla', 180.00, 'BRL', \n       '[\"Surf\", \"V√¥lei\", \"Bike tour\", \"Equipamentos\"]', '[\"Refei√ß√µes\"]', 35, true),\n      (11, 'Experi√™ncia Premium', 'Aulas privadas + almo√ßo + massagem na praia', 350.00, 'BRL', \n       '[\"Aulas privadas\", \"Almo√ßo\", \"Massagem\", \"Bebidas\"]', '[\"Compras pessoais\"]', 15, false)\n    `);\n\n    // MASP (ID 12) \n    await db.execute(sql`\n      INSERT INTO activity_budget_proposals \n      (activity_id, title, description, amount, currency, inclusions, exclusions, votes, is_popular) \n      VALUES \n      (12, 'Entrada B√°sica', 'Visita livre ao museu', 40.00, 'BRL', \n       '[\"Entrada do museu\"]', '[\"Guia\", \"Audioguia\"]', 18, false),\n      (12, 'Visita Guiada', 'Tour com guia especializado em arte', 75.00, 'BRL', \n       '[\"Entrada\", \"Guia especializado\", \"Material informativo\"]', '[\"Transporte\"]', 28, true),\n      (12, 'Tour Completo', 'MASP + Paulista + Pinacoteca', 120.00, 'BRL', \n       '[\"MASP\", \"Paulista\", \"Pinacoteca\", \"Guia\", \"Transporte\"]', '[\"Refei√ß√µes\"]', 12, false)\n    `);\n\n    // Pelourinho (ID 13)\n    await db.execute(sql`\n      INSERT INTO activity_budget_proposals \n      (activity_id, title, description, amount, currency, inclusions, exclusions, votes, is_popular) \n      VALUES \n      (13, 'Caminhada Hist√≥rica', 'Tour a p√© pelo centro hist√≥rico', 60.00, 'BRL', \n       '[\"Tour guiado\", \"Elevador Lacerda\"]', '[\"Alimenta√ß√£o\", \"Bebidas\"]', 25, false),\n      (13, 'Experi√™ncia Cultural', 'Tour + show de capoeira + degusta√ß√£o', 120.00, 'BRL', \n       '[\"Tour\", \"Show capoeira\", \"Degusta√ß√£o\", \"Guia\"]', '[\"Compras\"]', 40, true),\n      (13, 'Viv√™ncia Completa', 'Tour + oficina + almo√ßo t√≠pico + apresenta√ß√£o', 200.00, 'BRL', \n       '[\"Tour completo\", \"Oficina\", \"Almo√ßo\", \"Apresenta√ß√£o\"]', '[\"Compras pessoais\"]', 18, false)\n    `);\n\n    // Cataratas (ID 14)\n    await db.execute(sql`\n      INSERT INTO activity_budget_proposals \n      (activity_id, title, description, amount, currency, inclusions, exclusions, votes, is_popular) \n      VALUES \n      (14, 'Entrada B√°sica', 'Acesso ao parque com trilha panor√¢mica', 85.00, 'BRL', \n       '[\"Entrada do parque\", \"Trilha panor√¢mica\"]', '[\"Transporte\", \"Alimenta√ß√£o\"]', 22, false),\n      (14, 'Tour Completo', 'Parque + transporte + guia especializado', 150.00, 'BRL', \n       '[\"Entrada\", \"Transporte\", \"Guia especializado\", \"Capa de chuva\"]', '[\"Refei√ß√µes\"]', 38, true),\n      (14, 'Experi√™ncia Premium', 'Tour completo + voo de helic√≥ptero sobre as cataratas', 450.00, 'BRL', \n       '[\"Tour completo\", \"Voo helic√≥ptero\", \"Almo√ßo\", \"Fotos a√©reas\"]', '[\"Compras pessoais\"]', 15, false)\n    `);\n\n    console.log('‚úÖ Propostas de or√ßamento criadas!');\n\n    // 3. Criar avalia√ß√µes real√≠sticas\n    console.log('\\n‚≠ê Criando avalia√ß√µes...');\n    \n    // Limpar avalia√ß√µes existentes\n    await db.execute(sql`DELETE FROM activity_reviews WHERE 1=1`);\n    \n    // Obter usu√°rios\n    const users = await db.execute(sql`SELECT id, username FROM users LIMIT 5`);\n    console.log(`üë• Usu√°rios dispon√≠veis: ${users.length}`);\n\n    if (users.length > 0) {\n      // Cristo Redentor - avalia√ß√µes\n      await db.execute(sql`\n        INSERT INTO activity_reviews \n        (activity_id, user_id, rating, comment, visit_date, is_verified, helpful_votes) \n        VALUES \n        (9, ${users[0].id}, 5, 'Experi√™ncia incr√≠vel! A vista √© de tirar o f√¥lego. O Cristo Redentor √© realmente uma das maravilhas do mundo.', '2024-12-15', true, 12),\n        (9, ${users[1] ? users[1].id : users[0].id}, 4, 'Muito bonito, mas estava bem cheio. O trem demora um pouco para subir, mas vale a pena. Leve protetor solar!', '2024-12-10', true, 8)\n      `);\n\n      // P√£o de A√ß√∫car - avalia√ß√µes\n      await db.execute(sql`\n        INSERT INTO activity_reviews \n        (activity_id, user_id, rating, comment, visit_date, is_verified, helpful_votes) \n        VALUES \n        (10, ${users[0].id}, 5, 'O bondinho √© uma experi√™ncia √∫nica! A vista da Ba√≠a de Guanabara √© espetacular. Recomendo ir no final da tarde.', '2024-12-08', true, 15),\n        (10, ${users[1] ? users[1].id : users[0].id}, 4, 'Vista incr√≠vel! O bondinho hist√≥rico funciona muito bem. S√≥ achei um pouco caro, mas √© um passeio cl√°ssico do Rio.', '2024-12-05', true, 6)\n      `);\n\n      // Cataratas - avalia√ß√µes\n      await db.execute(sql`\n        INSERT INTO activity_reviews \n        (activity_id, user_id, rating, comment, visit_date, is_verified, helpful_votes) \n        VALUES \n        (14, ${users[0].id}, 5, 'Uma das experi√™ncias mais impressionantes que j√° tive! As cataratas s√£o majestosas e a for√ßa da natureza √© esmagadora.', '2024-11-28', true, 22),\n        (14, ${users[1] ? users[1].id : users[0].id}, 4, 'Incr√≠vel! As 275 quedas s√£o um espet√°culo da natureza. O parque √© bem organizado, mas prepare-se para se molhar!', '2024-11-25', true, 14)\n      `);\n\n      console.log('‚úÖ Avalia√ß√µes criadas!');\n    } else {\n      console.log('‚ö†Ô∏è Nenhum usu√°rio encontrado para criar avalia√ß√µes');\n    }\n\n    // 4. Atualizar m√©dias de rating\n    console.log('\\nüìä Atualizando m√©dias de rating...');\n    await db.execute(sql`\n      UPDATE activities a\n      SET \n        average_rating = (\n          SELECT COALESCE(AVG(r.rating), 0)\n          FROM activity_reviews r \n          WHERE r.activity_id = a.id AND r.is_hidden = FALSE\n        ),\n        total_ratings = (\n          SELECT COUNT(*)\n          FROM activity_reviews r \n          WHERE r.activity_id = a.id AND r.is_hidden = FALSE\n        )\n    `);\n\n    console.log('‚úÖ M√©dias atualizadas!');\n\n    // 5. Verificar resultados finais\n    console.log('\\nüìã Verificando resultados...');\n    const proposalsCount = await db.execute(sql`SELECT COUNT(*) as count FROM activity_budget_proposals`);\n    const reviewsCount = await db.execute(sql`SELECT COUNT(*) as count FROM activity_reviews`);\n    \n    console.log(`üí∞ Propostas criadas: ${proposalsCount[0].count}`);\n    console.log(`‚≠ê Avalia√ß√µes criadas: ${reviewsCount[0].count}`);\n\n    console.log('\\nüéâ Dados de teste criados com sucesso!');\n\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n    throw error;\n  }\n}\n\nmain()\n  .then(() => {\n    console.log('‚úÖ Processo conclu√≠do!');\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error('‚ùå Erro no processo:', error);\n    process.exit(1);\n  });","size_bytes":9299},"server/db.ts":{"content":"import { drizzle } from \"drizzle-orm/postgres-js\";\nimport postgres from \"postgres\";\nimport * as schema from \"@shared/schema\";\nimport { sql } from \"drizzle-orm\";\nimport { users } from \"@shared/schema\";\nimport dotenv from \"dotenv\";\nimport { initializeDatabaseSecurity, validateDatabaseUrl as validateDbUrl } from \"./db-security\";\n\n// Carregar vari√°veis de ambiente\ndotenv.config();\n\n// INICIALIZAR PROTE√á√ïES DE SEGURAN√áA\ninitializeDatabaseSecurity();\n\nconsole.log(`üîó Conectando ao PostgreSQL...`);\n\n// PROTE√á√ÉO DE SEGURAN√áA: Valida√ß√£o rigorosa da DATABASE_URL\nfunction validateDatabaseUrl(url: string): string {\n  if (!url) {\n    throw new Error(\"üö® SEGURAN√áA: DATABASE_URL √© obrigat√≥ria e n√£o pode estar vazia\");\n  }\n\n  // Lista de dom√≠nios autorizados para conex√£o\n  const allowedDomains = [\n    'neon.tech',           // Neon PostgreSQL (configurado no .env)\n    'ep-dark-frog-acs6c8yp.sa-east-1.aws.neon.tech'  // Dom√≠nio espec√≠fico do projeto\n  ];\n\n  // Bloquear tentativas de conex√£o com bancos nativos do Replit\n  const blockedPatterns = [\n    'replit.dev',\n    'repl.co',\n    'localhost',\n    '127.0.0.1',\n    '0.0.0.0',\n    'sqlite',\n    'file:',\n    'memory:'\n  ];\n\n  // Verificar se cont√©m padr√µes bloqueados\n  for (const pattern of blockedPatterns) {\n    if (url.toLowerCase().includes(pattern.toLowerCase())) {\n      throw new Error(`üö® SEGURAN√áA: Conex√£o bloqueada - tentativa de usar banco n√£o autorizado: ${pattern}`);\n    }\n  }\n\n  // Verificar se est√° usando um dom√≠nio autorizado\n  const urlObj = new URL(url);\n  const isAuthorized = allowedDomains.some(domain => \n    urlObj.hostname.includes(domain)\n  );\n\n  if (!isAuthorized) {\n    throw new Error(`üö® SEGURAN√áA: Dom√≠nio n√£o autorizado: ${urlObj.hostname}. Apenas dom√≠nios Neon s√£o permitidos.`);\n  }\n\n  // Verificar se √© PostgreSQL\n  if (!url.startsWith('postgresql://') && !url.startsWith('postgres://')) {\n    throw new Error(\"üö® SEGURAN√áA: Apenas conex√µes PostgreSQL s√£o permitidas\");\n  }\n\n  console.log(`‚úÖ SEGURAN√áA: URL do banco validada - conectando ao Neon PostgreSQL`);\n  return url;\n}\n\n// Configura√ß√£o do banco PostgreSQL com valida√ß√µes de seguran√ßa\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"üö® SEGURAN√áA: DATABASE_URL √© obrigat√≥ria no arquivo .env\");\n}\n\n// Validar e proteger a URL do banco\nconst secureDbUrl = validateDatabaseUrl(process.env.DATABASE_URL);\nconst connection = postgres(secureDbUrl, { \n  ssl: 'require',\n  // Configura√ß√µes adicionais de seguran√ßa\n  connect_timeout: 10,\n  max: 10,\n  idle_timeout: 20,\n  max_lifetime: 60 * 30 // 30 minutos\n});\n\n// Configurar Drizzle com PostgreSQL\nexport const db = drizzle(connection, { schema });\n\n// Testar conex√£o com valida√ß√µes de seguran√ßa\nexport async function testConnection() {\n  try {\n    console.log(\"üîó Testando conex√£o PostgreSQL...\");\n    \n    // Testar conex√£o b√°sica\n    await db.execute(sql`SELECT 1`);\n    \n    // Verificar se estamos conectados ao banco correto\n    const result = await db.execute(sql`SELECT current_database(), current_user, inet_server_addr()`);\n    const dbInfo = result[0] as any;\n    \n    console.log(\"‚úÖ Conex√£o PostgreSQL estabelecida com sucesso!\");\n    console.log(`üìä Banco: ${dbInfo.current_database}, Usu√°rio: ${dbInfo.current_user}`);\n    \n    // Verifica√ß√£o adicional de seguran√ßa - confirmar que n√£o √© banco local\n    const serverAddr = dbInfo.inet_server_addr;\n    if (serverAddr && typeof serverAddr === 'string' && (\n      serverAddr.includes('127.0.0.1') || \n      serverAddr.includes('localhost')\n    )) {\n      throw new Error(\"üö® SEGURAN√áA: Detectada conex√£o com banco local - bloqueando\");\n    }\n    \n    return true;\n  } catch (error) {\n    console.error(\"‚ùå Erro ao conectar com PostgreSQL:\", error);\n    return false;\n  }\n}\n\n// Reset completo do banco\nexport async function resetDatabase() {\n  const { resetDatabase: resetDB } = await import(\"./reset-database\");\n  return await resetDB();\n}\n\n// Inicializar tabelas usando Drizzle\nexport async function initializeTables() {\n  try {\n    console.log(\"üèóÔ∏è Inicializando tabelas do schema PostgreSQL...\");\n    \n    // With Drizzle and PostgreSQL Neon, schema is managed by migrations\n    // Check if we need to create initial test data\n    try {\n      const userCount = await db.select().from(users).limit(1);\n      if (userCount.length === 0) {\n        console.log(\"üå± Criando dados b√°sicos de teste...\");\n        const { createSimpleSeedData } = await import(\"./simple-postgres-seed\");\n        await createSimpleSeedData();\n      }\n    } catch (error) {\n      console.log(\"üå± Tabelas n√£o existem ainda, criando dados b√°sicos...\");\n      const { createSimpleSeedData } = await import(\"./simple-postgres-seed\");\n      await createSimpleSeedData();\n    }\n    \n    console.log(\"‚úÖ Inicializa√ß√£o das tabelas conclu√≠da!\");\n  } catch (error) {\n    console.error(\"‚ùå Erro na inicializa√ß√£o do banco:\", error);\n    throw error;\n  }\n}\n","size_bytes":4975},"server/debug-activities-api.ts":{"content":"import { db } from './db.js';\n\nasync function debugActivitiesAPI() {\n  try {\n    console.log('üîç DEPURANDO API DE ATIVIDADES...\\n');\n    \n    // Verificar total de atividades no banco\n    const [countResult] = await db.execute('SELECT COUNT(*) as total FROM activities');\n    const totalActivities = (countResult as any)[0].total;\n    console.log(`üìä Total de atividades no banco: ${totalActivities}`);\n    \n    // Verificar atividades ativas\n    const [activeResult] = await db.execute('SELECT COUNT(*) as total FROM activities WHERE is_active = 1');\n    const activeActivities = (activeResult as any)[0].total;\n    console.log(`‚úÖ Atividades ativas: ${activeActivities}`);\n    \n    // Verificar propostas de or√ßamento\n    const [proposalsResult] = await db.execute('SELECT COUNT(*) as total FROM activity_budget_proposals');\n    const totalProposals = (proposalsResult as any)[0].total;\n    console.log(`üí∞ Total de propostas de or√ßamento: ${totalProposals}`);\n    \n    // Verificar primeiras 5 atividades\n    const [activitiesResult] = await db.execute(`\n      SELECT id, title, location, is_active \n      FROM activities \n      ORDER BY id \n      LIMIT 10\n    `);\n    \n    console.log('\\nüìù PRIMEIRAS 10 ATIVIDADES:');\n    (activitiesResult as any).forEach((activity, index) => {\n      console.log(`  ${index + 1}. [ID ${activity.id}] ${activity.title} (${activity.location}) - Ativo: ${activity.is_active ? 'Sim' : 'N√£o'}`);\n    });\n    \n    // Verificar propostas por atividade\n    console.log('\\nüí∞ PROPOSTAS POR ATIVIDADE:');\n    const [proposalsCountResult] = await db.execute(`\n      SELECT a.id, a.title, COUNT(p.id) as proposals_count\n      FROM activities a\n      LEFT JOIN activity_budget_proposals p ON a.id = p.activity_id\n      GROUP BY a.id, a.title\n      ORDER BY a.id\n      LIMIT 10\n    `);\n    \n    (proposalsCountResult as any).forEach(row => {\n      console.log(`  Atividade ${row.id} (${row.title}): ${row.proposals_count} propostas`);\n    });\n    \n    // Verificar schema das propostas\n    console.log('\\nüèóÔ∏è SCHEMA DA TABELA activity_budget_proposals:');\n    const [schemaResult] = await db.execute('DESCRIBE activity_budget_proposals');\n    (schemaResult as any).forEach(row => {\n      console.log(`  ${row.Field}: ${row.Type} (${row.Null === 'YES' ? 'NULL' : 'NOT NULL'})`);\n    });\n    \n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  }\n  \n  process.exit(0);\n}\n\ndebugActivitiesAPI();","size_bytes":2443},"server/debug-budget.ts":{"content":"import { db } from './db.js';\nimport { trips } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\n\nasync function debugBudget() {\n  console.log('üîç Debugging budget data for trip 13...');\n  \n  try {\n    const [trip] = await db.select().from(trips).where(eq(trips.id, 13));\n    \n    if (!trip) {\n      console.log('‚ùå Trip 13 not found');\n      return;\n    }\n    \n    console.log('üìä Trip Data:');\n    console.log('- Title:', trip.title);\n    console.log('- Budget:', trip.budget);\n    console.log('- BudgetBreakdown type:', typeof trip.budgetBreakdown);\n    console.log('- BudgetBreakdown raw:', trip.budgetBreakdown);\n    console.log('- BudgetBreakdown length:', trip.budgetBreakdown?.length);\n    \n    if (trip.budgetBreakdown) {\n      try {\n        const parsed = JSON.parse(trip.budgetBreakdown);\n        console.log('‚úÖ BudgetBreakdown parsed successfully:', parsed);\n        console.log('- Object keys:', Object.keys(parsed));\n        console.log('- Object entries:', Object.entries(parsed));\n      } catch (e: any) {\n        console.log('‚ùå Parse error:', e.message);\n        \n        // Try double parsing for escaped JSON\n        try {\n          const doubleParsed = JSON.parse(JSON.parse(trip.budgetBreakdown));\n          console.log('‚úÖ Double-parsed successfully:', doubleParsed);\n        } catch (e2: any) {\n          console.log('‚ùå Double-parse also failed:', e2.message);\n        }\n      }\n    } else {\n      console.log('‚ö†Ô∏è  BudgetBreakdown is null, undefined, or empty');\n    }\n    \n  } catch (error) {\n    console.error('‚ùå Error:', error);\n  }\n}\n\ndebugBudget();","size_bytes":1606},"server/debug-proposals.ts":{"content":"import { db } from './db.js';\nimport { activityBudgetProposals, activities } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nasync function debugProposals() {\n  try {\n    console.log('üîç Debugando propostas para atividade 163...');\n    \n    // Verificar se a atividade existe\n    const activity = await db.select().from(activities).where(eq(activities.id, 163));\n    console.log('Atividade 163:', activity[0]?.title || 'N√ÉO ENCONTRADA');\n    \n    // Verificar propostas para atividade 163\n    const proposals = await db.select().from(activityBudgetProposals)\n      .where(eq(activityBudgetProposals.activityId, 163));\n    \n    console.log(`Total de propostas para atividade 163: ${proposals.length}`);\n    \n    if (proposals.length > 0) {\n      proposals.forEach((proposal, index) => {\n        console.log(`  ${index + 1}. ${proposal.title} - R$ ${proposal.amount} (Ativo: ${proposal.isActive})`);\n      });\n    }\n    \n    // Verificar o m√©todo storage diretamente\n    const { storage } = await import('./storage.js');\n    const storageProposals = await storage.getActivityBudgetProposals(163);\n    console.log(`Propostas via storage: ${storageProposals.length}`);\n    \n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  }\n}\n\ndebugProposals().then(() => process.exit(0)).catch(err => {\n  console.error(err);\n  process.exit(1);\n});","size_bytes":1406},"server/debug-trip-13.ts":{"content":"import { db } from './db';\nimport { trips } from '../shared/schema';\nimport { eq } from 'drizzle-orm';\n\nasync function debugTrip13() {\n  try {\n    const trip = await db.select().from(trips).where(eq(trips.id, 13));\n    \n    if (trip.length === 0) {\n      console.log('Viagem 13 n√£o encontrada');\n      return;\n    }\n    \n    console.log('=== DADOS DA VIAGEM 13 ===');\n    console.log('ID:', trip[0].id);\n    console.log('T√≠tulo:', trip[0].title);\n    console.log('Or√ßamento:', trip[0].budget);\n    console.log('Breakdown raw:', trip[0].budgetBreakdown);\n    console.log('Tipo do breakdown:', typeof trip[0].budgetBreakdown);\n    \n    // Tentar parsear o breakdown\n    if (trip[0].budgetBreakdown) {\n      try {\n        const parsed = JSON.parse(trip[0].budgetBreakdown);\n        console.log('Breakdown parseado:', parsed);\n      } catch (e) {\n        console.log('Erro ao parsear breakdown:', e);\n      }\n    }\n    \n    // Corrigir se necess√°rio\n    const correctBreakdown = {\n      transport: 1680,\n      accommodation: 1680,\n      food: 840,\n      activities: 0\n    };\n    \n    await db.update(trips)\n      .set({\n        budget: 4200,\n        budgetBreakdown: JSON.stringify(correctBreakdown)\n      })\n      .where(eq(trips.id, 13));\n      \n    console.log('‚úÖ Viagem 13 corrigida com sucesso!');\n    \n  } catch (error) {\n    console.error('Erro:', error);\n  }\n}\n\ndebugTrip13();","size_bytes":1386},"server/final-schema-fix.ts":{"content":"import { db } from './db.js';\nimport { sql } from 'drizzle-orm';\n\nasync function finalSchemaFix() {\n  console.log('üîß Corre√ß√£o final do schema...');\n\n  try {\n    // 1. Adicionar todas as colunas que faltam na tabela de propostas\n    console.log('üèóÔ∏è  Adicionando colunas faltantes...');\n    \n    await db.execute(sql`\n      ALTER TABLE activity_budget_proposals \n      ADD COLUMN IF NOT EXISTS valid_until TIMESTAMP NULL,\n      ADD COLUMN IF NOT EXISTS created_by INT DEFAULT NULL,\n      ADD COLUMN IF NOT EXISTS votes INT DEFAULT 0\n    `);\n\n    console.log('‚úÖ Colunas adicionadas');\n\n    // 2. Atualizar valores de votes para as propostas existentes\n    console.log('üìä Atualizando votos das propostas...');\n    \n    await db.execute(sql`\n      UPDATE activity_budget_proposals \n      SET votes = FLOOR(RAND() * 50) + 5 \n      WHERE votes = 0\n    `);\n\n    // 3. Verificar se as propostas est√£o sendo retornadas corretamente\n    console.log('üß™ Testando consulta de propostas...');\n    \n    const testProposals = await db.execute(sql`\n      SELECT id, activity_id, title, description, amount, votes, is_active \n      FROM activity_budget_proposals \n      WHERE activity_id = 14 AND is_active = true\n      ORDER BY votes DESC\n      LIMIT 5\n    `);\n\n    console.log(`‚úÖ Teste propostas ID 14: ${testProposals.length} registros`);\n    testProposals.forEach((p: any) => {\n      console.log(`   - ${p.title}: R$ ${p.amount} (${p.votes} votos)`);\n    });\n\n    // 4. Verificar todas as propostas\n    const allProposals = await db.execute(sql`\n      SELECT COUNT(*) as count, \n             COUNT(CASE WHEN votes > 0 THEN 1 END) as with_votes\n      FROM activity_budget_proposals\n    `);\n\n    console.log(`\\nüìä Total de propostas: ${allProposals[0].count}`);\n    console.log(`üìä Com votos: ${allProposals[0].with_votes}`);\n\n    // 5. Exibir algumas propostas por atividade\n    const proposalsByActivity = await db.execute(sql`\n      SELECT activity_id, COUNT(*) as proposals_count\n      FROM activity_budget_proposals \n      GROUP BY activity_id \n      ORDER BY activity_id\n    `);\n\n    console.log('\\nüí° Propostas por atividade:');\n    proposalsByActivity.forEach((row: any) => {\n      console.log(`   Atividade ${row.activity_id}: ${row.proposals_count} propostas`);\n    });\n\n    console.log('\\nüéâ Corre√ß√£o final conclu√≠da com sucesso!');\n\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n    throw error;\n  }\n}\n\n// Executar se chamado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  finalSchemaFix()\n    .then(() => {\n      console.log('‚úÖ Processo conclu√≠do!');\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('‚ùå Erro no processo:', error);\n      process.exit(1);\n    });\n}","size_bytes":2756},"server/final-verification.ts":{"content":"import { db } from './db.js';\n\nasync function finalVerification() {\n  try {\n    console.log('‚úÖ VERIFICA√á√ÉO FINAL DA MIGRA√á√ÉO REPLIT AGENT ‚Üí REPLIT PADR√ÉO\\n');\n    \n    // Verificar atividades\n    const [activitiesResult] = await db.execute('SELECT COUNT(*) as total FROM activities WHERE is_active = 1');\n    const totalActivities = (activitiesResult as any)[0].total;\n    \n    // Verificar propostas\n    const [proposalsResult] = await db.execute('SELECT COUNT(*) as total FROM activity_budget_proposals WHERE is_active = 1');\n    const totalProposals = (proposalsResult as any)[0].total;\n    \n    // Verificar viagens\n    const [tripsResult] = await db.execute('SELECT COUNT(*) as total FROM trips');\n    const totalTrips = (tripsResult as any)[0].total;\n    \n    // Verificar usu√°rios\n    const [usersResult] = await db.execute('SELECT COUNT(*) as total FROM users');\n    const totalUsers = (usersResult as any)[0].total;\n    \n    // Verificar atividades por destino\n    const [destinationsResult] = await db.execute(`\n      SELECT location, COUNT(*) as count \n      FROM activities \n      WHERE is_active = 1 \n      GROUP BY location \n      ORDER BY count DESC\n    `);\n    \n    console.log('üìä RESUMO FINAL DO BANCO DE DADOS:');\n    console.log(`  ‚úÖ Atividades ativas: ${totalActivities}`);\n    console.log(`  üí∞ Propostas de or√ßamento: ${totalProposals}`);\n    console.log(`  üöó Viagens cadastradas: ${totalTrips}`);\n    console.log(`  üë• Usu√°rios registrados: ${totalUsers}`);\n    \n    console.log('\\nüåç ATIVIDADES POR DESTINO:');\n    (destinationsResult as any).forEach(row => {\n      console.log(`  ${row.location}: ${row.count} atividades`);\n    });\n    \n    // Verificar propostas por atividade (sample)\n    const [sampleProposalsResult] = await db.execute(`\n      SELECT a.title, COUNT(p.id) as proposals_count\n      FROM activities a\n      LEFT JOIN activity_budget_proposals p ON a.id = p.activity_id\n      WHERE a.is_active = 1\n      GROUP BY a.id, a.title\n      HAVING proposals_count > 0\n      ORDER BY a.id\n      LIMIT 10\n    `);\n    \n    console.log('\\nüí∞ AMOSTRA DE ATIVIDADES COM PROPOSTAS:');\n    (sampleProposalsResult as any).forEach(row => {\n      console.log(`  ${row.title}: ${row.proposals_count} propostas`);\n    });\n    \n    // Status final\n    const migrationStatus = {\n      database: 'MySQL ‚úÖ',\n      activities: `${totalActivities} atividades ‚úÖ`,\n      proposals: `${totalProposals} propostas ‚úÖ`,\n      trips: `${totalTrips} viagens ‚úÖ`,\n      users: `${totalUsers} usu√°rios ‚úÖ`,\n      authentication: 'Funcionando ‚úÖ',\n      frontend: 'React + TypeScript ‚úÖ',\n      backend: 'Express.js + MySQL ‚úÖ'\n    };\n    \n    console.log('\\nüéØ STATUS DA MIGRA√á√ÉO:');\n    Object.entries(migrationStatus).forEach(([key, value]) => {\n      console.log(`  ${key}: ${value}`);\n    });\n    \n    console.log('\\nüéâ MIGRA√á√ÉO REPLIT AGENT ‚Üí REPLIT PADR√ÉO FINALIZADA COM SUCESSO!');\n    console.log('üì± Aplica√ß√£o PartiuTrip totalmente operacional no ambiente Replit padr√£o');\n    \n  } catch (error) {\n    console.error('‚ùå Erro na verifica√ß√£o final:', error);\n  }\n  \n  process.exit(0);\n}\n\nfinalVerification();","size_bytes":3178},"server/fix-activity-locations.ts":{"content":"import { db } from './db.js';\nimport { activities } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nasync function fixActivityLocations() {\n  try {\n    console.log('üîß Corrigindo classifica√ß√£o de localidades das atividades...');\n    \n    // Mapeamento de localidades corretas\n    const locationMapping = {\n      // Rio de Janeiro\n      'Rio de Janeiro, RJ': ['Trilha no P√£o de A√ß√∫car', 'Cristo Redentor e Corcovado', 'P√£o de A√ß√∫car de Bondinho', 'Trilha na Tijuca', 'Cristo Redentor e P√£o de A√ß√∫car', 'Trilha na Floresta da Tijuca', 'Tour Gastron√¥mico Santa Teresa'],\n      \n      // S√£o Paulo\n      'S√£o Paulo, SP': ['Tour Gastron√¥mico na Vila Madalena', 'Mercado Municipal e Centro Hist√≥rico', 'Museu de Arte Moderna', 'Parque Ibirapuera', 'Avenida Paulista e MASP', 'Mercado Municipal - Mercad√£o', 'Beco do Batman - Vila Madalena', 'Pinacoteca do Estado'],\n      \n      // Pantanal\n      'Pantanal, MT': ['Safari Fotogr√°fico Pantanal', 'Pescaria no Pantanal'],\n      \n      // Salvador\n      'Salvador, BA': ['Tour Pelourinho', 'Aulas de Capoeira'],\n      \n      // Serra da Mantiqueira\n      'Serra da Mantiqueira, MG': ['Pico da Bandeira', 'Vale do Matutu'],\n      \n      // Maragogi\n      'Maragogi, AL': ['Gal√©s de Maragogi', 'Passeio de Catamar√£'],\n      \n      // Ouro Preto\n      'Ouro Preto, MG': ['Igreja S√£o Francisco de Assis', 'Mina de Ouro do Chico Rei'],\n      \n      // Manaus\n      'Manaus, AM': ['Encontro das √Åguas', 'Teatro Amazonas', 'Arquip√©lago de Anavilhanas', 'Mercado Adolpho Lisboa'],\n      \n      // Florian√≥polis\n      'Florian√≥polis, SC': ['Surf na Joaquina', 'Trilha da Lagoinha do Leste', 'Praia da Lagoinha do Leste', 'Praia da Joaquina - Sandboard', 'Lagoa da Concei√ß√£o', 'Centro Hist√≥rico de Florian√≥polis', 'Fortaleza de S√£o Jos√© da Ponta Grossa'],\n      \n      // Gramado\n      'Gramado, RS': ['Tour de Vin√≠colas', 'Trem Maria Fuma√ßa', 'Mini Mundo', 'Dreamland Museu de Cera', 'GramadoZoo', 'Tour de Vin√≠colas no Vale dos Vinhedos', 'Snowland'],\n      \n      // Len√ß√≥is Maranhenses\n      'Len√ß√≥is Maranhenses, MA': ['Trekking pelas Dunas', 'Voo de Ultraleve'],\n      \n      // Caruaru\n      'Caruaru, PE': ['Festa Junina Aut√™ntica', 'Casa de Cultura Popular'],\n      \n      // Buenos Aires\n      'Buenos Aires, Argentina': ['Show de Tango com Jantar Tradicional', 'Tour pelo Bairro La Boca - Caminito', 'Cemit√©rio da Recoleta - Visita Hist√≥rica', 'MALBA - Museu de Arte Latino-Americana', 'Degusta√ß√£o de Vinhos e Carnes Premium', 'Show de Tango e Jantar'],\n      \n      // Londres\n      'Londres, Reino Unido': ['London Eye - Roda Gigante Ic√¥nica', 'Torre de Londres - Fortaleza Hist√≥rica', 'Museu Brit√¢nico - Tesouros Mundiais', 'West End - Teatro de Classe Mundial', 'Pal√°cio de Buckingham - Resid√™ncia Real', 'Torre de Londres e Joias da Coroa'],\n      \n      // Paris\n      'Paris, Fran√ßa': ['Torre Eiffel - S√≠mbolo de Paris', 'Museu do Louvre - Tesouro da Arte Mundial', 'Cruzeiro pelo Rio Sena - Paris das √Åguas', 'Catedral de Notre-Dame - Joia G√≥tica', 'Pal√°cio de Versalhes - Grandeza Real', 'Torre Eiffel e Cruzeiro no Sena'],\n      \n      // Roma\n      'Roma, It√°lia': ['Coliseu - Anfiteatro Romano', 'Vaticano e Bas√≠lica de S√£o Pedro', 'Fontana di Trevi e Centro Hist√≥rico', 'Pante√£o de Roma - Templo dos Deuses', 'Trastevere - Bairro Bo√™mio Aut√™ntico', 'Coliseu e F√≥rum Romano'],\n      \n      // Nova York\n      'Nova York, EUA': ['Est√°tua da Liberdade e Ellis Island', 'Empire State Building - √çcone de NY', 'Broadway Show - Teatro de Classe Mundial', 'Central Park - O√°sis Verde de Manhattan', 'Museu Metropolitano de Arte (Met)'],\n      \n      // Bonito\n      'Bonito, MS': ['Flutua√ß√£o no Rio da Prata', 'Gruta do Lago Azul', 'Aqu√°rio Natural', 'Abismo Anhumas', 'Buraco das Araras'],\n      \n      // Fortaleza\n      'Fortaleza, CE': ['Beach Park - Aquiraz', 'Centro Drag√£o do Mar', 'Cumbuco - Passeio de Buggy'],\n      \n      // Curitiba\n      'Curitiba, PR': ['Jardim Bot√¢nico de Curitiba', 'Museu Oscar Niemeyer', '√ìpera de Arame', 'Trem Serra Verde Express para Morretes', 'Largo da Ordem - Feira de Domingo'],\n      \n      // Bel√©m\n      'Bel√©m, PA': ['Mercado Ver-o-Peso', 'Esta√ß√£o das Docas', 'Mangal das Gar√ßas', 'Complexo Feliz Lusit√¢nia', 'Theatro da Paz'],\n      \n      // Goi√¢nia\n      'Goi√¢nia, GO': ['Parque Flamboyant', 'Parque Vaca Brava', 'Bosque dos Buritis', 'Memorial do Cerrado', 'Pra√ßa C√≠vica e Centro Cultural'],\n      \n      // Vit√≥ria\n      'Vit√≥ria, ES': ['Praia de Camburi', 'Parque Pedra da Cebola', 'Praia do Canto e Curva da Jurema', 'Espa√ßo Baleia Jubarte', 'Pal√°cio Anchieta']\n    };\n\n    let updatedCount = 0;\n\n    // Buscar todas as atividades\n    const allActivities = await db.select().from(activities);\n    console.log(`üìä Total de atividades para corrigir: ${allActivities.length}`);\n\n    for (const [correctLocation, activityTitles] of Object.entries(locationMapping)) {\n      for (const activityTitle of activityTitles) {\n        // Encontrar a atividade pelo t√≠tulo\n        const activity = allActivities.find(a => a.title === activityTitle);\n        \n        if (activity && activity.location !== correctLocation) {\n          console.log(`üîß Corrigindo: \"${activity.title}\" de \"${activity.location}\" para \"${correctLocation}\"`);\n          \n          await db.update(activities)\n            .set({ location: correctLocation })\n            .where(eq(activities.id, activity.id));\n          \n          updatedCount++;\n        }\n      }\n    }\n\n    console.log(`‚úÖ ${updatedCount} atividades tiveram suas localidades corrigidas`);\n\n    // Verifica√ß√£o final - mostrar distribui√ß√£o por localidade\n    const finalActivities = await db.select().from(activities);\n    const locationGroups = finalActivities.reduce((acc, activity) => {\n      acc[activity.location] = (acc[activity.location] || 0) + 1;\n      return acc;\n    }, {} as Record<string, number>);\n\n    console.log('\\nüìä Distribui√ß√£o final por localidade:');\n    Object.entries(locationGroups)\n      .sort(([,a], [,b]) => b - a)\n      .forEach(([location, count]) => {\n        console.log(`  ${location}: ${count} atividades`);\n      });\n\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  }\n}\n\nfixActivityLocations().then(() => process.exit(0)).catch(err => {\n  console.error(err);\n  process.exit(1);\n});","size_bytes":6422},"server/fix-all-activity-scripts-mysql.ts":{"content":"#!/usr/bin/env tsx\nimport { readFileSync, writeFileSync, readdirSync } from 'fs';\nimport { join } from 'path';\n\n/**\n * Script to automatically update all activity scripts to use correct MySQL schema\n * Converts snake_case field names to camelCase for JavaScript objects\n */\n\nconst FIELD_MAPPINGS = {\n  // Snake case to camelCase mappings\n  'country_type': 'countryType',\n  'price_type': 'priceType', \n  'price_amount': 'priceAmount',\n  'difficulty_level': 'difficultyLevel',\n  'min_participants': 'minParticipants',\n  'max_participants': 'maxParticipants',\n  'cover_image': 'coverImage',\n  'average_rating': 'averageRating',\n  'total_ratings': 'totalRatings',\n  'created_by_id': 'createdById',\n  'is_active': 'isActive',\n  'activity_id': 'activityId',\n  'created_by': 'createdBy'\n};\n\nfunction updateActivityScript(filePath: string): void {\n  console.log(`üîß Updating ${filePath}...`);\n  \n  let content = readFileSync(filePath, 'utf-8');\n  \n  // Update field names in object definitions\n  for (const [snakeCase, camelCase] of Object.entries(FIELD_MAPPINGS)) {\n    // Match field definitions like: field_name: value\n    const regex = new RegExp(`\\\\b${snakeCase}:\\\\s*`, 'g');\n    content = content.replace(regex, `${camelCase}: `);\n  }\n  \n  // Fix specific patterns for activity data structures\n  content = content.replace(/duration:\\s*(\\d+),?\\s*$/gm, 'duration: \"$1 horas\",');\n  content = content.replace(/difficulty:\\s*\"([^\"]+)\"/g, 'difficultyLevel: \"$1\"');\n  content = content.replace(/priceRange:\\s*\"[^\"]*\"/g, ''); // Remove priceRange as it's not in schema\n  \n  // Add missing required fields for activities\n  if (content.includes('title:') && !content.includes('countryType:')) {\n    content = content.replace(\n      /(category:\\s*\"[^\"]+\",?\\s*)/g,\n      '$1\\n    countryType: \"nacional\",\\n    region: \"Brasil\",\\n    city: \"Cidade\",\\n    priceType: \"per_person\",'\n    );\n  }\n  \n  writeFileSync(filePath, content, 'utf-8');\n  console.log(`‚úÖ Updated ${filePath}`);\n}\n\nfunction main() {\n  console.log('üöÄ Starting systematic update of all activity scripts...');\n  \n  const serverDir = '.';\n  const files = readdirSync(serverDir);\n  \n  // Find all activity-related scripts\n  const activityScripts = files.filter(file => \n    file.includes('activities') && \n    file.endsWith('.ts') && \n    !file.includes('fixed') &&\n    !file.includes('test')\n  );\n  \n  console.log(`üìã Found ${activityScripts.length} scripts to update:`);\n  activityScripts.forEach(script => console.log(`  - ${script}`));\n  \n  // Update each script\n  for (const script of activityScripts) {\n    const filePath = join(serverDir, script);\n    try {\n      updateActivityScript(filePath);\n    } catch (error) {\n      console.error(`‚ùå Error updating ${script}:`, error);\n    }\n  }\n  \n  console.log('üéâ All activity scripts updated to MySQL schema compatibility!');\n}\n\nmain();","size_bytes":2849},"server/fix-all-budgets.ts":{"content":"import { db } from './db';\nimport { sql } from 'drizzle-orm';\n\n/**\n * Script para corrigir todos os or√ßamentos das viagens\n * Aplica valores realistas baseados no destino e dura√ß√£o\n */\n\ninterface BudgetData {\n  budget: number;\n  budgetBreakdown: {\n    transport: number;\n    accommodation: number;\n    food: number;\n    insurance?: number;\n    medical?: number;\n    activities?: number;\n    other?: number;\n  };\n}\n\n// Fun√ß√£o para calcular or√ßamento baseado no destino e dura√ß√£o\nfunction calculateBudgetForTrip(title: string, destination: string, startDate: string, endDate: string): BudgetData {\n  const start = new Date(startDate);\n  const end = new Date(endDate);\n  let days = Math.ceil((end.getTime() - start.getTime()) / (1000 * 60 * 60 * 24));\n  \n  // Fallback para casos onde as datas s√£o inv√°lidas\n  if (isNaN(days) || days <= 0) {\n    days = 7; // 7 dias como padr√£o\n  }\n  \n  let dailyBudget = 150; // Base di√°ria em reais\n  let transportMultiplier = 1;\n  let accommodationMultiplier = 1;\n  let foodMultiplier = 1;\n  \n  // Ajustar multiplicadores baseado no destino\n  const dest = (destination || '').toLowerCase();\n  \n  if (dest.includes('qu√™nia') || dest.includes('nairobi')) {\n    dailyBudget = 300;\n    transportMultiplier = 3;\n    accommodationMultiplier = 2;\n  } else if (dest.includes('peru') || dest.includes('cusco')) {\n    dailyBudget = 200;\n    transportMultiplier = 2;\n    accommodationMultiplier = 1.5;\n  } else if (dest.includes('rio') || dest.includes('copacabana')) {\n    dailyBudget = 250;\n    transportMultiplier = 1.5;\n    accommodationMultiplier = 2;\n  } else if (dest.includes('maragogi') || dest.includes('alagoas')) {\n    dailyBudget = 180;\n    transportMultiplier = 1.2;\n    accommodationMultiplier = 1.3;\n  } else if (dest.includes('pantanal')) {\n    dailyBudget = 220;\n    transportMultiplier = 1.8;\n    accommodationMultiplier = 1.5;\n  } else if (dest.includes('gramado') || dest.includes('serra ga√∫cha')) {\n    dailyBudget = 160;\n    transportMultiplier = 1.1;\n    accommodationMultiplier = 1.2;\n  } else if (dest.includes('florian√≥polis')) {\n    dailyBudget = 170;\n    transportMultiplier = 1.2;\n    accommodationMultiplier = 1.3;\n  } else if (dest.includes('manaus') || dest.includes('amaz√¥nia')) {\n    dailyBudget = 190;\n    transportMultiplier = 1.6;\n    accommodationMultiplier = 1.4;\n  } else if (dest.includes('ouro preto')) {\n    dailyBudget = 140;\n    transportMultiplier = 1.1;\n    accommodationMultiplier = 1.1;\n  } else if (dest.includes('salvador')) {\n    dailyBudget = 180;\n    transportMultiplier = 1.3;\n    accommodationMultiplier = 1.4;\n  } else if (dest.includes('len√ß√≥is maranhenses')) {\n    dailyBudget = 170;\n    transportMultiplier = 1.4;\n    accommodationMultiplier = 1.2;\n  } else if (dest.includes('caruaru')) {\n    dailyBudget = 130;\n    transportMultiplier = 1.1;\n    accommodationMultiplier = 1.1;\n  } else if (dest.includes('mantiqueira')) {\n    dailyBudget = 140;\n    transportMultiplier = 1.2;\n    accommodationMultiplier = 1.2;\n  }\n  \n  // Calcular componentes do or√ßamento\n  const totalBudget = Math.round(dailyBudget * days);\n  const transport = Math.round(totalBudget * 0.3 * transportMultiplier);\n  const accommodation = Math.round(totalBudget * 0.4 * accommodationMultiplier);\n  const food = Math.round(totalBudget * 0.2 * foodMultiplier);\n  const activities = Math.round(totalBudget * 0.1);\n  \n  // Ajustar total para que seja coerente\n  const calculatedTotal = transport + accommodation + food + activities;\n  const finalBudget = Math.round(calculatedTotal * 1.1); // 10% de margem\n  \n  // Validar que todos os valores s√£o n√∫meros v√°lidos\n  if (isNaN(finalBudget) || isNaN(transport) || isNaN(accommodation) || isNaN(food) || isNaN(activities)) {\n    throw new Error(`Erro ao calcular or√ßamento para ${title}: valores inv√°lidos`);\n  }\n  \n  return {\n    budget: finalBudget,\n    budgetBreakdown: {\n      transport,\n      accommodation,\n      food,\n      activities,\n      insurance: Math.round(finalBudget * 0.05),\n      medical: Math.round(finalBudget * 0.03),\n      other: Math.round(finalBudget * 0.02)\n    }\n  };\n}\n\nasync function fixAllBudgets() {\n  console.log('üîß Iniciando corre√ß√£o de todos os or√ßamentos...');\n  \n  try {\n    // Buscar todas as viagens\n    const results = await db.execute(sql`\n      SELECT id, title, destination, start_date, end_date, budget, budget_breakdown \n      FROM trips \n      ORDER BY id\n    `);\n    \n    const trips = results.map((row: any) => ({\n      id: row.id,\n      title: row.title || '',\n      destination: row.destination || '',\n      startDate: row.start_date,\n      endDate: row.end_date,\n      currentBudget: row.budget,\n      currentBreakdown: row.budget_breakdown\n    }));\n    \n    console.log(`üìä Encontradas ${trips.length} viagens para corrigir`);\n    \n    let updatedCount = 0;\n    \n    for (const trip of trips) {\n      try {\n        const { budget, budgetBreakdown } = calculateBudgetForTrip(\n          trip.title,\n          trip.destination,\n          trip.startDate,\n          trip.endDate\n        );\n        \n        // Atualizar no banco\n        await db.execute(sql`\n          UPDATE trips \n          SET budget = ${budget}, \n              budget_breakdown = ${JSON.stringify(budgetBreakdown)}\n          WHERE id = ${trip.id}\n        `);\n        \n        console.log(`‚úÖ Viagem ${trip.id} (${trip.title}): R$ ${trip.currentBudget} ‚Üí R$ ${budget}`);\n        updatedCount++;\n      } catch (error) {\n        console.error(`‚ùå Erro ao processar viagem ${trip.id} (${trip.title}):`, error);\n        continue;\n      }\n    }\n    \n    console.log(`üéâ Corre√ß√£o conclu√≠da! ${updatedCount} viagens atualizadas`);\n    \n  } catch (error) {\n    console.error('‚ùå Erro ao corrigir or√ßamentos:', error);\n    throw error;\n  }\n}\n\n// Executar diretamente\nfixAllBudgets().catch(console.error);\n\nexport { fixAllBudgets };","size_bytes":5877},"server/fix-all-missing-proposals.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { eq, sql, notInArray } from 'drizzle-orm';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nasync function fixAllMissingProposals() {\n  try {\n    console.log('üîç Verificando quais atividades n√£o t√™m propostas...');\n    \n    // Primeiro, vamos ver quais atividades t√™m propostas\n    const activitiesWithProposals = await db.select({ \n      activityId: activityBudgetProposals.activityId \n    })\n    .from(activityBudgetProposals)\n    .groupBy(activityBudgetProposals.activityId);\n\n    const activityIdsWithProposals = activitiesWithProposals.map(p => p.activityId);\n    console.log(`üìä ${activityIdsWithProposals.length} atividades j√° t√™m propostas`);\n\n    // Buscar todas as atividades\n    const allActivities = await db.select().from(activities);\n    console.log(`üìä Total de atividades: ${allActivities.length}`);\n\n    // Filtrar atividades sem propostas\n    const activitiesWithoutProposals = allActivities.filter(\n      activity => !activityIdsWithProposals.includes(activity.id)\n    );\n\n    console.log(`üìä ${activitiesWithoutProposals.length} atividades SEM propostas`);\n\n    let addedCount = 0;\n\n    for (const activity of activitiesWithoutProposals) {\n      console.log(`üîß Adicionando propostas para: ${activity.title} (ID: ${activity.id})`);\n      \n      // Definir pre√ßos baseados na localiza√ß√£o\n      let basePrice = 30;\n      const location = activity.location.toLowerCase();\n      \n      if (location.includes('paris') || location.includes('londres') || location.includes('nova york')) {\n        basePrice = 50; // Destinos internacionais mais caros\n      } else if (location.includes('rio') || location.includes('s√£o paulo')) {\n        basePrice = 40; // Grandes capitais\n      } else if (location.includes('pantanal') || location.includes('amaz√¥nia')) {\n        basePrice = 60; // Turismo de natureza\n      }\n\n      const proposalsToAdd = [\n        {\n          title: \"Econ√¥mico\",\n          description: \"Op√ß√£o b√°sica com essenciais inclu√≠dos\",\n          amount: basePrice.toFixed(2),\n          inclusions: [\"Entrada b√°sica\", \"Informa√ß√µes gerais\"],\n          exclusions: [\"Guia especializado\", \"Transporte\", \"Alimenta√ß√£o\"]\n        },\n        {\n          title: \"Completo\", \n          description: \"Experi√™ncia completa com servi√ßos extras\",\n          amount: (basePrice * 2.5).toFixed(2),\n          inclusions: [\"Entrada premium\", \"Guia especializado\", \"Material informativo\"],\n          exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Souvenirs\"]\n        },\n        {\n          title: \"Premium\",\n          description: \"Experi√™ncia VIP com todos os luxos inclu√≠dos\",\n          amount: (basePrice * 4.5).toFixed(2),\n          inclusions: [\"Acesso VIP\", \"Guia privado\", \"Transporte premium\", \"Cortesias\"],\n          exclusions: [\"Alimenta√ß√£o externa\", \"Compras pessoais\"]\n        }\n      ];\n\n      for (const proposal of proposalsToAdd) {\n        await db.insert(activityBudgetProposals).values({\n          activityId: activity.id,\n          createdBy: 1,\n          title: proposal.title,\n          description: proposal.description,\n          amount: proposal.amount,\n          currency: \"BRL\",\n          priceType: \"per_person\",\n          inclusions: JSON.stringify(proposal.inclusions),\n          exclusions: JSON.stringify(proposal.exclusions),\n          isActive: true,\n          votes: Math.floor(Math.random() * 50) + 1\n        });\n        addedCount++;\n      }\n    }\n\n    console.log(`‚úÖ Adicionadas ${addedCount} propostas para ${activitiesWithoutProposals.length} atividades`);\n\n    // Verifica√ß√£o final\n    const finalProposalCount = await db.select({ count: sql`COUNT(*)` }).from(activityBudgetProposals);\n    console.log(`üìä Total final de propostas no banco: ${finalProposalCount[0].count}`);\n\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  }\n}\n\nfixAllMissingProposals().then(() => process.exit(0)).catch(err => {\n  console.error(err);\n  process.exit(1);\n});","size_bytes":4051},"server/fix-auth-mysql.ts":{"content":"import { db } from \"./db\";\nimport { users } from \"../shared/schema\";\nimport { scrypt, randomBytes } from \"crypto\";\nimport { promisify } from \"util\";\nimport { eq } from \"drizzle-orm\";\n\nconst asyncScrypt = promisify(scrypt);\n\nasync function hashPassword(password: string): Promise<string> {\n  const salt = randomBytes(16).toString('hex');\n  const derivedKey = await asyncScrypt(password, salt, 64);\n  return `${(derivedKey as Buffer).toString('hex')}.${salt}`;\n}\n\nasync function fixAuthenticationPasswords() {\n  console.log(\"üîß Corrigindo senhas dos usu√°rios para formato correto...\");\n  \n  try {\n    const hashedPassword = await hashPassword(\"demo123\");\n    \n    // Update all existing users with correct password format\n    const allUsers = await db.select().from(users);\n    \n    for (const user of allUsers) {\n      await db.update(users)\n        .set({ password: hashedPassword })\n        .where(eq(users.id, user.id));\n      \n      console.log(`‚úÖ Senha corrigida para usu√°rio: ${user.username}`);\n    }\n    \n    console.log(\"‚úÖ Todas as senhas foram corrigidas para o formato correto!\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro ao corrigir senhas:\", error);\n  }\n}\n\n// Run the fix\nfixAuthenticationPasswords().then(() => {\n  console.log(\"üéâ Corre√ß√£o de autentica√ß√£o conclu√≠da!\");\n  process.exit(0);\n}).catch(console.error);","size_bytes":1353},"server/fix-budget-data.ts":{"content":"import { db } from './db';\nimport { sql } from 'drizzle-orm';\n\n/**\n * Script para corrigir dados de or√ßamento das viagens\n * Converte strings JSON malformadas para objetos v√°lidos\n */\n\ninterface BudgetBreakdown {\n  transport?: number;\n  accommodation?: number;\n  food?: number;\n  insurance?: number;\n  medical?: number;\n  activities?: number;\n  other?: number;\n}\n\nasync function fixBudgetData() {\n  console.log('üîß Iniciando corre√ß√£o dos dados de or√ßamento...');\n  \n  try {\n    // Buscar todas as viagens com problemas de or√ßamento\n    const results = await db.execute(sql`\n      SELECT id, title, budget, budget_breakdown \n      FROM trips \n      WHERE budget_breakdown IS NOT NULL\n    `);\n    \n    const trips = results.map((row: any) => ({\n      id: row.id,\n      title: row.title,\n      budget: row.budget,\n      budgetBreakdown: row.budget_breakdown\n    }));\n    \n    console.log(`üìä Encontradas ${trips.length} viagens com dados de or√ßamento`);\n    \n    let fixedCount = 0;\n    \n    for (const trip of trips) {\n      const tripData = trip as any;\n      let needsUpdate = false;\n      let fixedBreakdown: BudgetBreakdown | null = null;\n      \n      // Tentar parsear o budget_breakdown\n      if (tripData.budget_breakdown) {\n        try {\n          let parsed = tripData.budget_breakdown;\n          \n          // Se for string, tentar parsear\n          if (typeof parsed === 'string') {\n            try {\n              parsed = JSON.parse(parsed);\n            } catch (e) {\n              // Pode estar duplamente escapado\n              try {\n                parsed = JSON.parse(parsed);\n              } catch (e2) {\n                console.warn(`‚ö†Ô∏è N√£o foi poss√≠vel parsear or√ßamento da viagem ${tripData.id}: ${tripData.title}`);\n                continue;\n              }\n            }\n          }\n          \n          // Verificar se o objeto est√° v√°lido\n          if (typeof parsed === 'object' && parsed !== null) {\n            // Garantir que todos os valores s√£o n√∫meros\n            const validBreakdown: BudgetBreakdown = {};\n            let hasValidData = false;\n            \n            const categories = ['transport', 'accommodation', 'food', 'insurance', 'medical', 'activities', 'other'];\n            \n            for (const category of categories) {\n              if (parsed[category] !== undefined && parsed[category] !== null) {\n                const value = Number(parsed[category]);\n                if (!isNaN(value) && value >= 0) {\n                  validBreakdown[category as keyof BudgetBreakdown] = value;\n                  hasValidData = true;\n                }\n              }\n            }\n            \n            if (hasValidData) {\n              // Verificar se o total bate com o or√ßamento\n              const totalFromBreakdown = Object.values(validBreakdown).reduce((sum, value) => sum + (value || 0), 0);\n              \n              if (totalFromBreakdown > 0) {\n                fixedBreakdown = validBreakdown;\n                \n                // Se o budget total n√£o existe ou est√° incorreto, corrigir\n                if (!tripData.budget || Math.abs(tripData.budget - totalFromBreakdown) > 1) {\n                  console.log(`üí∞ Corrigindo budget total da viagem ${tripData.id}: ${tripData.budget} ‚Üí ${totalFromBreakdown}`);\n                  \n                  await db.execute(sql`\n                    UPDATE trips \n                    SET budget = ${totalFromBreakdown}, budget_breakdown = ${JSON.stringify(fixedBreakdown)}\n                    WHERE id = ${tripData.id}\n                  `);\n                  \n                  fixedCount++;\n                } else {\n                  // Apenas atualizar o breakdown se necess√°rio\n                  if (JSON.stringify(parsed) !== JSON.stringify(fixedBreakdown)) {\n                    await db.execute(sql`\n                      UPDATE trips \n                      SET budget_breakdown = ${JSON.stringify(fixedBreakdown)}\n                      WHERE id = ${tripData.id}\n                    `);\n                    \n                    fixedCount++;\n                  }\n                }\n              }\n            }\n          }\n        } catch (error) {\n          console.error(`‚ùå Erro ao processar viagem ${tripData.id}:`, error);\n        }\n      } else if (tripData.budget && tripData.budget > 0) {\n        // Se n√£o tem breakdown mas tem budget, criar um breakdown padr√£o\n        const defaultBreakdown: BudgetBreakdown = {\n          transport: Math.round(tripData.budget * 0.4),\n          accommodation: Math.round(tripData.budget * 0.4),\n          food: Math.round(tripData.budget * 0.2)\n        };\n        \n        console.log(`üî® Criando breakdown padr√£o para viagem ${tripData.id}: ${tripData.title}`);\n        \n        await db.execute(sql`\n          UPDATE trips \n          SET budget_breakdown = ${JSON.stringify(defaultBreakdown)}\n          WHERE id = ${tripData.id}\n        `);\n        \n        fixedCount++;\n      }\n    }\n    \n    console.log(`‚úÖ Corre√ß√£o conclu√≠da! ${fixedCount} viagens foram corrigidas.`);\n    \n    // Verificar resultados\n    const verificationResults = await db.execute(sql`\n      SELECT id, title, budget, budget_breakdown \n      FROM trips \n      WHERE budget_breakdown IS NOT NULL\n      LIMIT 5\n    `);\n    \n    const verificationTrips = verificationResults.map((row: any) => ({\n      id: row.id,\n      title: row.title,\n      budget: row.budget,\n      budgetBreakdown: row.budget_breakdown\n    }));\n    \n    console.log('\\nüìã Verifica√ß√£o dos dados corrigidos:');\n    for (const trip of verificationTrips) {\n      const tripData = trip as any;\n      console.log(`- Viagem ${tripData.id}: ${tripData.title}`);\n      console.log(`  Budget: R$ ${tripData.budget}`);\n      console.log(`  Breakdown: ${tripData.budget_breakdown}`);\n      \n      try {\n        const parsed = JSON.parse(tripData.budget_breakdown);\n        const total = Object.values(parsed).reduce((sum: number, value: any) => sum + (Number(value) || 0), 0);\n        console.log(`  Total calculado: R$ ${total}`);\n      } catch (e) {\n        console.log(`  ‚ö†Ô∏è Ainda com problema de parsing`);\n      }\n      console.log('');\n    }\n    \n  } catch (error) {\n    console.error('‚ùå Erro durante a corre√ß√£o:', error);\n  }\n}\n\n// Executar se chamado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  fixBudgetData().then(() => {\n    console.log('üéâ Script de corre√ß√£o finalizado!');\n    process.exit(0);\n  }).catch((error) => {\n    console.error('üí• Erro fatal:', error);\n    process.exit(1);\n  });\n}\n\nexport { fixBudgetData };","size_bytes":6593},"server/fix-budget-schema.ts":{"content":"import { db } from './db.js';\nimport { sql } from 'drizzle-orm';\n\nasync function fixBudgetSchema() {\n  console.log('üîß Corrigindo schema das tabelas...');\n\n  try {\n    // 1. Atualizar tabela de propostas adicionando colunas que faltam\n    console.log('üèóÔ∏è  Atualizando tabela activity_budget_proposals...');\n    \n    // Adicionar colunas que podem estar faltando\n    await db.execute(sql`\n      ALTER TABLE activity_budget_proposals \n      ADD COLUMN IF NOT EXISTS created_by INT DEFAULT NULL,\n      ADD COLUMN IF NOT EXISTS votes INT DEFAULT 0,\n      ADD COLUMN IF NOT EXISTS is_popular BOOLEAN DEFAULT FALSE\n    `);\n\n    // 2. Atualizar tabela de avalia√ß√µes adicionando colunas que faltam\n    console.log('üèóÔ∏è  Atualizando tabela activity_reviews...');\n    \n    await db.execute(sql`\n      ALTER TABLE activity_reviews \n      ADD COLUMN IF NOT EXISTS review TEXT,\n      ADD COLUMN IF NOT EXISTS photos JSON,\n      ADD COLUMN IF NOT EXISTS report_count INT DEFAULT 0\n    `);\n\n    // Copiar dados de comment para review se necess√°rio\n    await db.execute(sql`\n      UPDATE activity_reviews \n      SET review = comment \n      WHERE review IS NULL AND comment IS NOT NULL\n    `);\n\n    console.log('‚úÖ Schema corrigido');\n\n    // 3. Verificar se tudo est√° funcionando\n    console.log('üß™ Testando consultas...');\n    \n    const proposalsTest = await db.execute(sql`\n      SELECT id, activity_id, created_by, title, description, amount, votes \n      FROM activity_budget_proposals \n      LIMIT 3\n    `);\n    \n    const reviewsTest = await db.execute(sql`\n      SELECT id, activity_id, user_id, rating, review, comment, report_count, helpful_votes \n      FROM activity_reviews \n      LIMIT 3\n    `);\n\n    console.log(`‚úÖ Teste propostas: ${proposalsTest.length} registros`);\n    console.log(`‚úÖ Teste avalia√ß√µes: ${reviewsTest.length} registros`);\n\n    // 4. Verificar contagens\n    const [proposalsCount, reviewsCount] = await Promise.all([\n      db.execute(sql`SELECT COUNT(*) as count FROM activity_budget_proposals`),\n      db.execute(sql`SELECT COUNT(*) as count FROM activity_reviews`)\n    ]);\n    \n    console.log(`\\nüìä Status final:`);\n    console.log(`üí∞ Propostas: ${proposalsCount[0].count}`);\n    console.log(`‚≠ê Avalia√ß√µes: ${reviewsCount[0].count}`);\n\n    console.log('\\nüéâ Corre√ß√£o do schema conclu√≠da!');\n\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n    throw error;\n  }\n}\n\n// Executar se chamado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  fixBudgetSchema()\n    .then(() => {\n      console.log('‚úÖ Processo conclu√≠do!');\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('‚ùå Erro no processo:', error);\n      process.exit(1);\n    });\n}","size_bytes":2747},"server/fix-budgets-simple.ts":{"content":"import { db } from './db';\nimport { trips } from '../shared/schema';\nimport { eq } from 'drizzle-orm';\n\nasync function fixBudgetsSimple() {\n  console.log('üîß Iniciando corre√ß√£o simplificada de or√ßamentos...');\n  \n  try {\n    // Buscar todas as viagens\n    const allTrips = await db.select().from(trips);\n    console.log(`üìä Encontradas ${allTrips.length} viagens`);\n    \n    let updatedCount = 0;\n    \n    for (const trip of allTrips) {\n      // Calcular or√ßamento baseado no destino\n      let budget = 2000; // Base padr√£o\n      let budgetData = {\n        transport: 600,\n        accommodation: 800,\n        food: 400,\n        activities: 200\n      };\n      \n      const dest = (trip.destination || '').toLowerCase();\n      \n      if (dest.includes('qu√™nia') || dest.includes('nairobi')) {\n        budget = 5800;\n        budgetData = { transport: 2320, accommodation: 2320, food: 1160, activities: 0 };\n      } else if (dest.includes('peru') || dest.includes('cusco')) {\n        budget = 4200;\n        budgetData = { transport: 1680, accommodation: 1680, food: 840, activities: 0 };\n      } else if (dest.includes('rio') || dest.includes('copacabana')) {\n        budget = 3500;\n        budgetData = { transport: 1050, accommodation: 1400, food: 700, activities: 350 };\n      } else if (dest.includes('maragogi')) {\n        budget = 2200;\n        budgetData = { transport: 880, accommodation: 880, food: 440, activities: 0 };\n      } else if (dest.includes('pantanal')) {\n        budget = 2800;\n        budgetData = { transport: 1120, accommodation: 1120, food: 560, activities: 0 };\n      } else if (dest.includes('gramado')) {\n        budget = 1800;\n        budgetData = { transport: 540, accommodation: 720, food: 360, activities: 180 };\n      } else if (dest.includes('florian√≥polis')) {\n        budget = 1600;\n        budgetData = { transport: 480, accommodation: 640, food: 320, activities: 160 };\n      } else if (dest.includes('manaus')) {\n        budget = 2400;\n        budgetData = { transport: 960, accommodation: 960, food: 480, activities: 0 };\n      } else if (dest.includes('ouro preto')) {\n        budget = 1400;\n        budgetData = { transport: 420, accommodation: 560, food: 280, activities: 140 };\n      } else if (dest.includes('salvador')) {\n        budget = 1800;\n        budgetData = { transport: 720, accommodation: 720, food: 360, activities: 0 };\n      } else if (dest.includes('len√ß√≥is')) {\n        budget = 2000;\n        budgetData = { transport: 800, accommodation: 800, food: 400, activities: 0 };\n      } else if (dest.includes('caruaru')) {\n        budget = 1300;\n        budgetData = { transport: 520, accommodation: 520, food: 260, activities: 0 };\n      } else if (dest.includes('mantiqueira')) {\n        budget = 1500;\n        budgetData = { transport: 600, accommodation: 600, food: 300, activities: 0 };\n      }\n      \n      // Atualizar a viagem\n      await db.update(trips)\n        .set({\n          budget: budget,\n          budgetBreakdown: JSON.stringify(budgetData)\n        })\n        .where(eq(trips.id, trip.id));\n      \n      console.log(`‚úÖ Viagem ${trip.id} (${trip.title}): R$ ${budget}`);\n      updatedCount++;\n    }\n    \n    console.log(`üéâ Corre√ß√£o conclu√≠da! ${updatedCount} viagens atualizadas`);\n    \n  } catch (error) {\n    console.error('‚ùå Erro ao corrigir or√ßamentos:', error);\n    throw error;\n  }\n}\n\n// Executar\nfixBudgetsSimple().catch(console.error);","size_bytes":3435},"server/fix-creators-as-participants.ts":{"content":"import { db } from \"./db\";\nimport { trips, tripParticipants, users } from \"@shared/schema\";\nimport { eq, and } from \"drizzle-orm\";\n\n// Script to fix existing trips by ensuring creators are participants\nexport async function fixCreatorsAsParticipants() {\n  console.log('üîß Iniciando corre√ß√£o: adicionando criadores como participantes...');\n  \n  try {\n    // Get all trips\n    const allTrips = await db.select().from(trips);\n    console.log(`üìä Encontradas ${allTrips.length} viagens para verificar`);\n    \n    let fixedCount = 0;\n    \n    for (const trip of allTrips) {\n      // Check if creator is already a participant\n      const existingParticipant = await db.select()\n        .from(tripParticipants)\n        .where(and(\n          eq(tripParticipants.trip_id, trip.id),\n          eq(tripParticipants.user_id, trip.creator_id)\n        ))\n        .limit(1);\n      \n      if (existingParticipant.length === 0) {\n        // Creator is not a participant, add them\n        try {\n          await db.insert(tripParticipants).values({\n            tripId: trip.id,\n            userId: trip.creator_id,\n            status: 'accepted',\n            joined_at: new Date()\n          });\n          \n          console.log(`‚úÖ Criador ${trip.creator_id} adicionado como participante na viagem ${trip.id}: \"${trip.title}\"`);\n          fixedCount++;\n        } catch (error) {\n          console.error(`‚ùå Erro ao adicionar criador ${trip.creator_id} na viagem ${trip.id}:`, error);\n        }\n      } else {\n        console.log(`‚ÑπÔ∏è Criador ${trip.creator_id} j√° √© participante da viagem ${trip.id}: \"${trip.title}\"`);\n      }\n    }\n    \n    console.log(`üéâ Corre√ß√£o conclu√≠da! ${fixedCount} criadores foram adicionados como participantes.`);\n    return fixedCount;\n  } catch (error) {\n    console.error('‚ùå Erro durante a corre√ß√£o:', error);\n    throw error;\n  }\n}\n\n// Execute the fix if this file is run directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  fixCreatorsAsParticipants()\n    .then((count) => {\n      console.log(`‚ú® Script finalizado. ${count} corre√ß√µes aplicadas.`);\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('üí• Script falhou:', error);\n      process.exit(1);\n    });\n}","size_bytes":2239},"server/fix-destination-activities.ts":{"content":"import { db } from \"./db\";\nimport { activities } from \"@shared/schema\";\nimport { sql } from \"drizzle-orm\";\n\n// Script to add activities for all trip destinations\nasync function addActivitiesForDestinations() {\n  console.log(\"üéØ Adicionando atividades para destinos das viagens...\");\n  \n  const destinationActivities = [\n    // Pantanal, MS\n    {\n      title: \"Safari Fotogr√°fico no Pantanal\",\n      description: \"Passeio em ve√≠culo 4x4 para observa√ß√£o de fauna selvagem com guia especializado. Oportunidade √∫nica de fotografar on√ßas, jacar√©s, capivaras e aves ex√≥ticas em seu habitat natural.\",\n      location: \"Pantanal, MS\",\n      category: \"adventure\",\n      city: \"Pantanal\",\n      countryType: \"nacional\",\n      region: \"Centro-Oeste\",\n      priceType: \"per_person\",\n      priceAmount: \"180.00\",\n      duration: \"6-8 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 2,\n      maxParticipants: 8,\n      coverImage: \"https://images.unsplash.com/photo-1594736797933-d0401ba2fe65?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1594736797933-d0401ba2fe65?w=800&q=80\",\n        \"https://images.unsplash.com/photo-1573160103600-3b4c8b68b7e3?w=800&q=80\"\n      ]),\n      inclusions: JSON.stringify([\"Guia especializado\", \"Ve√≠culo 4x4\", \"Equipamentos de observa√ß√£o\", \"Lanche\", \"√Ågua\", \"Seguro\"]),\n      exclusions: JSON.stringify([\"Hospedagem\", \"Refei√ß√µes principais\", \"Transporte at√© o Pantanal\"]),\n      requirements: JSON.stringify([\"Roupas neutras\", \"Protetor solar\", \"Repelente\", \"Cal√ßado fechado\"]),\n      contactInfo: JSON.stringify({\n        phone: \"(65) 99999-1001\",\n        email: \"safaris@pantanal.com.br\",\n        whatsapp: \"(65) 99999-1001\"\n      }),\n      createdById: 1\n    },\n    {\n      title: \"Pesca Esportiva no Pantanal\",\n      description: \"Pesca de tucunar√©, dourado e pacu em rios cristalinos do Pantanal. Inclui equipamentos profissionais e barco com piloteiro experiente.\",\n      location: \"Pantanal, MS\",\n      category: \"adventure\",\n      city: \"Pantanal\",\n      countryType: \"nacional\",\n      region: \"Centro-Oeste\",\n      priceType: \"per_person\",\n      priceAmount: \"220.00\",\n      duration: \"8 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 2,\n      maxParticipants: 6,\n      coverImage: \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\"\n      ]),\n      inclusions: JSON.stringify([\"Barco\", \"Piloteiro\", \"Equipamentos de pesca\", \"Iscas\", \"Almo√ßo\", \"Bebidas\"]),\n      exclusions: JSON.stringify([\"Hospedagem\", \"Transporte at√© o local\"]),\n      requirements: JSON.stringify([\"Protetor solar\", \"Chap√©u\", \"Roupas leves\"]),\n      contactInfo: JSON.stringify({\n        phone: \"(65) 99999-1002\",\n        email: \"pesca@pantanal.com.br\"\n      }),\n      createdById: 1\n    },\n\n    // Mantiqueira, MG\n    {\n      title: \"Trilha da Pedra do Ba√∫\",\n      description: \"Trilha desafiadora at√© o topo da famosa Pedra do Ba√∫ com vista panor√¢mica da Serra da Mantiqueira. Uma das mais belas paisagens de Minas Gerais.\",\n      location: \"Mantiqueira, MG\",\n      category: \"adventure\",\n      city: \"Mantiqueira\",\n      countryType: \"nacional\",\n      region: \"Sudeste\",\n      priceType: \"per_person\",\n      priceAmount: \"85.00\",\n      duration: \"6-8 horas\",\n      difficultyLevel: \"challenging\",\n      minParticipants: 2,\n      maxParticipants: 12,\n      coverImage: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\"\n      ]),\n      inclusions: JSON.stringify([\"Guia de montanha\", \"Equipamentos de seguran√ßa\", \"Lanche energ√©tico\", \"√Ågua\", \"Seguro\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Refei√ß√µes principais\", \"Hospedagem\"]),\n      requirements: JSON.stringify([\"Bom condicionamento f√≠sico\", \"Cal√ßado de trilha\", \"Roupas adequadas\", \"Idade m√≠nima 14 anos\"]),\n      contactInfo: JSON.stringify({\n        phone: \"(35) 99999-2001\",\n        email: \"trilhas@mantiqueira.com.br\"\n      }),\n      createdById: 1\n    },\n\n    // Maragogi, AL\n    {\n      title: \"Passeio de Catamaran - Gal√©s de Maragogi\",\n      description: \"Navega√ß√£o at√© as piscinas naturais dos Gal√©s de Maragogi. √Åguas cristalinas, mergulho livre e observa√ß√£o de peixes coloridos.\",\n      location: \"Maragogi, AL\",\n      category: \"aquatic\",\n      city: \"Maragogi\",\n      countryType: \"nacional\",\n      region: \"Nordeste\",\n      priceType: \"per_person\",\n      priceAmount: \"120.00\",\n      duration: \"5-6 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 10,\n      maxParticipants: 40,\n      coverImage: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\"\n      ]),\n      inclusions: JSON.stringify([\"Transporte mar√≠timo\", \"Equipamentos de mergulho\", \"Instrutor\", \"Colete salva-vidas\", \"Lanche\"]),\n      exclusions: JSON.stringify([\"Almo√ßo\", \"Bebidas alco√≥licas\", \"Fotos subaqu√°ticas\"]),\n      requirements: JSON.stringify([\"Saber nadar\", \"Idade m√≠nima 8 anos\", \"Protetor solar biodegrad√°vel\"]),\n      contactInfo: JSON.stringify({\n        phone: \"(82) 99999-3001\",\n        email: \"passeios@maragogi.com.br\"\n      }),\n      createdById: 1\n    },\n\n    // Ouro Preto, MG\n    {\n      title: \"Tour Hist√≥rico pelo Centro de Ouro Preto\",\n      description: \"Caminhada guiada pelos principais pontos hist√≥ricos de Ouro Preto, incluindo igrejas barrocas, museus e arquitetura colonial.\",\n      location: \"Ouro Preto, MG\",\n      category: \"culture\",\n      city: \"Ouro Preto\",\n      countryType: \"nacional\",\n      region: \"Sudeste\",\n      priceType: \"per_person\",\n      priceAmount: \"65.00\",\n      duration: \"4 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 2,\n      maxParticipants: 20,\n      coverImage: \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\"\n      ]),\n      inclusions: JSON.stringify([\"Guia historiador\", \"Entradas nos museus\", \"Mapa hist√≥rico\", \"Degusta√ß√£o de quitutes\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Almo√ßo\", \"Compras pessoais\"]),\n      requirements: JSON.stringify([\"Cal√ßado confort√°vel\", \"Roupa adequada para igrejas\", \"Protetor solar\"]),\n      contactInfo: JSON.stringify({\n        phone: \"(31) 99999-4001\",\n        email: \"turismo@ouropreto.com.br\"\n      }),\n      createdById: 1\n    },\n\n    // Manaus, AM\n    {\n      title: \"Encontro das √Åguas + Cidade Flutuante\",\n      description: \"Passeio pelo famoso Encontro das √Åguas do Rio Negro e Solim√µes, visita √† cidade flutuante e observa√ß√£o de botos cor-de-rosa.\",\n      location: \"Manaus, AM\",\n      category: \"nature\",\n      city: \"Manaus\",\n      countryType: \"nacional\",\n      region: \"Norte\",\n      priceType: \"per_person\",\n      priceAmount: \"150.00\",\n      duration: \"6-8 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 4,\n      maxParticipants: 30,\n      coverImage: \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\"\n      ]),\n      inclusions: JSON.stringify([\"Transporte mar√≠timo\", \"Guia local\", \"Almo√ßo regional\", \"√Ågua\", \"Seguro\"]),\n      exclusions: JSON.stringify([\"Hospedagem\", \"Bebidas alco√≥licas\", \"Compras\"]),\n      requirements: JSON.stringify([\"Protetor solar\", \"Repelente\", \"Chap√©u\", \"Roupas leves\"]),\n      contactInfo: JSON.stringify({\n        phone: \"(92) 99999-5001\",\n        email: \"amazonia@manaus.com.br\"\n      }),\n      createdById: 1\n    },\n\n    // Gramado, RS\n    {\n      title: \"Tour pelas Vin√≠colas da Serra Ga√∫cha\",\n      description: \"Visita √†s principais vin√≠colas da regi√£o com degusta√ß√£o de vinhos premiados, almo√ßo harmonizado e passeio pelos parreirais.\",\n      location: \"Gramado, RS\",\n      category: \"food\",\n      city: \"Gramado\",\n      countryType: \"nacional\",\n      region: \"Sul\",\n      priceType: \"per_person\",\n      priceAmount: \"180.00\",\n      duration: \"8 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 2,\n      maxParticipants: 15,\n      coverImage: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\"\n      ]),\n      inclusions: JSON.stringify([\"Transporte\", \"Guia especializado\", \"Degusta√ß√£o de vinhos\", \"Almo√ßo harmonizado\", \"Visita a 3 vin√≠colas\"]),\n      exclusions: JSON.stringify([\"Hospedagem\", \"Compras de vinhos\", \"Bebidas extras\"]),\n      requirements: JSON.stringify([\"Idade m√≠nima 18 anos\", \"Documento de identifica√ß√£o\", \"Roupas adequadas\"]),\n      contactInfo: JSON.stringify({\n        phone: \"(54) 99999-6001\",\n        email: \"vinhos@gramado.com.br\"\n      }),\n      createdById: 1\n    },\n\n    // Len√ß√≥is Maranhenses, MA\n    {\n      title: \"Sobrevoo de Avi√£o pelos Len√ß√≥is Maranhenses\",\n      description: \"Voo panor√¢mico sobre as dunas e lagoas dos Len√ß√≥is Maranhenses. Vista a√©rea √∫nica das lagoas de √°guas cristalinas.\",\n      location: \"Len√ß√≥is Maranhenses, MA\",\n      category: \"adventure\",\n      city: \"Len√ß√≥is Maranhenses\",\n      countryType: \"nacional\",\n      region: \"Nordeste\",\n      priceType: \"per_person\",\n      priceAmount: \"350.00\",\n      duration: \"1 hora\",\n      difficultyLevel: \"easy\",\n      minParticipants: 2,\n      maxParticipants: 4,\n      coverImage: \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\"\n      ]),\n      inclusions: JSON.stringify([\"Voo de avi√£o\", \"Piloto experiente\", \"Briefing de seguran√ßa\", \"Seguro de voo\"]),\n      exclusions: JSON.stringify([\"Transporte at√© o aeroporto\", \"Hospedagem\", \"Refei√ß√µes\"]),\n      requirements: JSON.stringify([\"Peso m√°ximo 100kg\", \"Idade m√≠nima 12 anos\", \"Documento de identifica√ß√£o\"]),\n      contactInfo: JSON.stringify({\n        phone: \"(98) 99999-7001\",\n        email: \"voos@lencois.com.br\"\n      }),\n      createdById: 1\n    },\n\n    // Caruaru, PE\n    {\n      title: \"Forr√≥ e Cultura Nordestina\",\n      description: \"Noite cultural com apresenta√ß√£o de forr√≥ p√©-de-serra, quadrilha junina e degusta√ß√£o de pratos t√≠picos nordestinos.\",\n      location: \"Caruaru, PE\",\n      category: \"culture\",\n      city: \"Caruaru\",\n      countryType: \"nacional\",\n      region: \"Nordeste\",\n      priceType: \"per_person\",\n      priceAmount: \"85.00\",\n      duration: \"4 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 4,\n      maxParticipants: 50,\n      coverImage: \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\",\n      images: JSON.stringify([\n        \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=800&q=80\"\n      ]),\n      inclusions: JSON.stringify([\"Apresenta√ß√£o cultural\", \"Jantar t√≠pico\", \"Aulas de forr√≥\", \"Bebidas inclusas\"]),\n      exclusions: JSON.stringify([\"Transporte\", \"Hospedagem\", \"Bebidas extras\"]),\n      requirements: JSON.stringify([\"Roupas confort√°veis\", \"Disposi√ß√£o para dan√ßar\"]),\n      contactInfo: JSON.stringify({\n        phone: \"(81) 99999-8001\",\n        email: \"cultura@caruaru.com.br\"\n      }),\n      createdById: 1\n    }\n  ];\n\n  try {\n    for (const activity of destinationActivities) {\n      try {\n        await db.insert(activities).values({\n          ...activity,\n          priceAmount: activity.priceAmount ? parseFloat(activity.priceAmount) : null,\n          isActive: true\n        });\n        console.log(`‚úÖ Atividade criada: ${activity.title} - ${activity.location}`);\n      } catch (insertError: any) {\n        if (insertError.code === 'ER_DUP_ENTRY') {\n          console.log(`‚ÑπÔ∏è Atividade j√° existe: ${activity.title}`);\n        } else {\n          console.error(`‚ùå Erro ao criar ${activity.title}:`, insertError.message);\n        }\n      }\n    }\n\n    console.log(\"üéâ Processamento conclu√≠do!\");\n  } catch (error) {\n    console.error(\"‚ùå Erro geral:\", error);\n  }\n}\n\n// Execute the function\naddActivitiesForDestinations().catch(console.error);","size_bytes":12418},"server/fix-destination-references-final.ts":{"content":"#!/usr/bin/env tsx\n\nimport { db } from \"./db\";\nimport { sql } from \"drizzle-orm\";\n\nasync function fixDestinationReferences() {\n  console.log(\"üöÄ Corrigindo refer√™ncias de destination_id...\");\n  \n  try {\n    // 1. Verificar qual destination ID usar (Rio de Janeiro)\n    const rioCheck = await db.execute(sql`SELECT id FROM destinations WHERE name = 'Rio de Janeiro' LIMIT 1`);\n    \n    if (rioCheck.length === 0) {\n      console.log(\"‚ùå Destino Rio de Janeiro n√£o encontrado. Criando...\");\n      await db.execute(sql`\n        INSERT INTO destinations (name, state, country, country_type, continent, region, is_active, created_at)\n        VALUES ('Rio de Janeiro', 'RJ', 'Brasil', 'nacional', 'Am√©rica do Sul', 'Sudeste', true, NOW())\n      `);\n    }\n    \n    const rioDestination = await db.execute(sql`SELECT id FROM destinations WHERE name = 'Rio de Janeiro' LIMIT 1`);\n    const rioId = (rioDestination[0] as any).id;\n    console.log(`üìç Usando Rio de Janeiro como destino padr√£o (ID: ${rioId})`);\n    \n    // 2. Corrigir trips √≥rf√£os\n    console.log(\"üîç Verificando trips √≥rf√£os...\");\n    const orphanTripsResult = await db.execute(sql`\n      SELECT t.id, t.title, t.destination_id \n      FROM trips t \n      LEFT JOIN destinations d ON t.destination_id = d.id \n      WHERE d.id IS NULL\n    `);\n    \n    console.log(`üìã Encontrados ${orphanTripsResult.length} trips √≥rf√£os`);\n    \n    if (orphanTripsResult.length > 0) {\n      await db.execute(sql`\n        UPDATE trips \n        SET destination_id = ${rioId}\n        WHERE id IN (\n          SELECT trip_id FROM (\n            SELECT t.id as trip_id\n            FROM trips t \n            LEFT JOIN destinations d ON t.destination_id = d.id \n            WHERE d.id IS NULL\n          ) as orphan_trips\n        )\n      `);\n      console.log(`‚úÖ ${orphanTripsResult.length} trips √≥rf√£os corrigidos`);\n    }\n    \n    // 3. Corrigir activities √≥rf√£os\n    console.log(\"üéØ Verificando activities √≥rf√£os...\");\n    const orphanActivitiesResult = await db.execute(sql`\n      SELECT a.id, a.title, a.destination_id \n      FROM activities a \n      LEFT JOIN destinations d ON a.destination_id = d.id \n      WHERE d.id IS NULL\n    `);\n    \n    console.log(`üìã Encontrados ${orphanActivitiesResult.length} activities √≥rf√£os`);\n    \n    if (orphanActivitiesResult.length > 0) {\n      await db.execute(sql`\n        UPDATE activities \n        SET destination_id = ${rioId}\n        WHERE id IN (\n          SELECT activity_id FROM (\n            SELECT a.id as activity_id\n            FROM activities a \n            LEFT JOIN destinations d ON a.destination_id = d.id \n            WHERE d.id IS NULL\n          ) as orphan_activities\n        )\n      `);\n      console.log(`‚úÖ ${orphanActivitiesResult.length} activities √≥rf√£os corrigidos`);\n    }\n    \n    // 4. Agora tentar adicionar as foreign keys\n    console.log(\"üîó Adicionando foreign keys...\");\n    \n    try {\n      await db.execute(sql`ALTER TABLE trips ADD CONSTRAINT trips_destinations_fk FOREIGN KEY (destination_id) REFERENCES destinations(id)`);\n      console.log(\"‚úÖ Foreign key trips_destinations_fk adicionada\");\n    } catch (error: any) {\n      if (error.message.includes('already exists')) {\n        console.log(\"‚ÑπÔ∏è Foreign key trips_destinations_fk j√° existe\");\n      } else {\n        console.log(\"‚ö†Ô∏è Erro ao adicionar FK trips:\", error.message);\n      }\n    }\n    \n    try {\n      await db.execute(sql`ALTER TABLE activities ADD CONSTRAINT activities_destinations_fk FOREIGN KEY (destination_id) REFERENCES destinations(id)`);\n      console.log(\"‚úÖ Foreign key activities_destinations_fk adicionada\");\n    } catch (error: any) {\n      if (error.message.includes('already exists')) {\n        console.log(\"‚ÑπÔ∏è Foreign key activities_destinations_fk j√° existe\");\n      } else {\n        console.log(\"‚ö†Ô∏è Erro ao adicionar FK activities:\", error.message);\n      }\n    }\n    \n    // 5. Verifica√ß√£o final\n    console.log(\"üîç Verifica√ß√£o final...\");\n    \n    const finalOrphanTrips = await db.execute(sql`\n      SELECT COUNT(*) as count\n      FROM trips t \n      LEFT JOIN destinations d ON t.destination_id = d.id \n      WHERE d.id IS NULL\n    `);\n    \n    const finalOrphanActivities = await db.execute(sql`\n      SELECT COUNT(*) as count\n      FROM activities a \n      LEFT JOIN destinations d ON a.destination_id = d.id \n      WHERE d.id IS NULL\n    `);\n    \n    console.log(`üìä Trips √≥rf√£os restantes: ${(finalOrphanTrips[0] as any).count}`);\n    console.log(`üìä Activities √≥rf√£os restantes: ${(finalOrphanActivities[0] as any).count}`);\n    \n    console.log(\"üéâ Migra√ß√£o de cities ‚Üí destinations conclu√≠da com sucesso!\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro durante a corre√ß√£o:\", error);\n    throw error;\n  }\n}\n\n// Executar se chamado diretamente\nfixDestinationReferences()\n  .then(() => {\n    console.log(\"‚úÖ Corre√ß√£o executada com sucesso!\");\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error(\"‚ùå Falha na corre√ß√£o:\", error);\n    process.exit(1);\n  });\n\nexport { fixDestinationReferences };","size_bytes":5106},"server/fix-destination-simple.ts":{"content":"#!/usr/bin/env tsx\n\nimport { db } from \"./db\";\nimport { sql } from \"drizzle-orm\";\n\nasync function fixDestinationSimple() {\n  console.log(\"üöÄ Corrigindo refer√™ncias destination_id de forma simples...\");\n  \n  try {\n    // 1. Primeiro, garantir que temos o Rio de Janeiro\n    console.log(\"üìç Verificando destino Rio de Janeiro...\");\n    const rioCheck = await db.execute(sql`SELECT id FROM destinations WHERE name = 'Rio de Janeiro'`);\n    \n    let rioId: number;\n    if (rioCheck.length === 0) {\n      console.log(\"üìç Criando Rio de Janeiro...\");\n      await db.execute(sql`\n        INSERT INTO destinations (name, state, country, country_type, continent, region, is_active, created_at)\n        VALUES ('Rio de Janeiro', 'RJ', 'Brasil', 'nacional', 'Am√©rica do Sul', 'Sudeste', true, NOW())\n      `);\n      const newRio = await db.execute(sql`SELECT id FROM destinations WHERE name = 'Rio de Janeiro'`);\n      rioId = (newRio[0] as any).id;\n    } else {\n      rioId = (rioCheck[0] as any).id;\n    }\n    \n    console.log(`‚úÖ Rio de Janeiro ID: ${rioId}`);\n    \n    // 2. Corrigir trips √≥rf√£os de forma simples\n    console.log(\"üîß Corrigindo trips √≥rf√£os...\");\n    await db.execute(sql.raw(`UPDATE trips SET destination_id = ${rioId} WHERE destination_id = 999 OR destination_id = 998 OR destination_id NOT IN (SELECT id FROM destinations)`));\n    console.log(\"‚úÖ Trips corrigidos\");\n    \n    // 3. Corrigir activities √≥rf√£os de forma simples\n    console.log(\"üîß Corrigindo activities √≥rf√£os...\");\n    await db.execute(sql.raw(`UPDATE activities SET destination_id = ${rioId} WHERE destination_id = 999 OR destination_id = 998 OR destination_id NOT IN (SELECT id FROM destinations)`));\n    console.log(\"‚úÖ Activities corrigidos\");\n    \n    // 4. Tentar adicionar foreign keys\n    console.log(\"üîó Adicionando foreign keys...\");\n    \n    try {\n      await db.execute(sql.raw(`ALTER TABLE trips ADD CONSTRAINT trips_destinations_fk FOREIGN KEY (destination_id) REFERENCES destinations(id)`));\n      console.log(\"‚úÖ FK trips adicionada\");\n    } catch (e: any) {\n      console.log(\"‚ÑπÔ∏è FK trips:\", e.message.substring(0, 50));\n    }\n    \n    try {\n      await db.execute(sql.raw(`ALTER TABLE activities ADD CONSTRAINT activities_destinations_fk FOREIGN KEY (destination_id) REFERENCES destinations(id)`));\n      console.log(\"‚úÖ FK activities adicionada\");\n    } catch (e: any) {\n      console.log(\"‚ÑπÔ∏è FK activities:\", e.message.substring(0, 50));\n    }\n    \n    console.log(\"üéâ Migra√ß√£o conclu√≠da!\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro:\", error);\n    throw error;\n  }\n}\n\n// Executar\nfixDestinationSimple()\n  .then(() => {\n    console.log(\"‚úÖ Sucesso!\");\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error(\"‚ùå Falha:\", error);\n    process.exit(1);\n  });","size_bytes":2817},"server/fix-destinations-manual.ts":{"content":"import mysql from 'mysql2/promise';\nimport * as dotenv from 'dotenv';\n\ndotenv.config();\n\nasync function fixDestinationsManual() {\n  let connection;\n  \n  try {\n    console.log('üîÑ CONECTANDO AO MYSQL E CORRIGINDO DESTINOS...\\n');\n    \n    // Conectar ao MySQL\n    connection = await mysql.createConnection({\n      host: process.env.DB_HOST || 'srv1661.hstgr.io',\n      user: process.env.DB_USER || 'u574849128_partiutrip',\n      password: process.env.DB_PASSWORD || 'PartiuTrip2024!',\n      database: process.env.DB_NAME || 'u574849128_partiutrip',\n      ssl: undefined\n    });\n    \n    console.log('‚úÖ Conectado ao MySQL!');\n    \n    // Verificar schema da tabela trips\n    const [schemaRows] = await connection.execute('DESCRIBE trips');\n    console.log('\\nüìã SCHEMA DA TABELA TRIPS:');\n    (schemaRows as any[]).forEach(row => {\n      console.log(`  ${row.Field}: ${row.Type} (${row.Null === 'YES' ? 'NULL' : 'NOT NULL'})`);\n    });\n    \n    // Verificar viagens atuais\n    const [trips] = await connection.execute('SELECT id, title, destination FROM trips LIMIT 10');\n    console.log('\\nüìù VIAGENS ATUAIS:');\n    (trips as any[]).forEach(trip => {\n      console.log(`  ID ${trip.id}: \"${trip.title}\" ‚Üí \"${trip.destination}\"`);\n    });\n    \n    // Definir as corre√ß√µes\n    const corrections = [\n      { title: 'Rio de Janeiro Completo', destination: 'Rio de Janeiro, RJ' },\n      { title: 'S√£o Paulo Gastron√¥mico', destination: 'S√£o Paulo, SP' },\n      { title: 'Aventura no Pantanal', destination: 'Pantanal, MT' },\n      { title: 'Carnaval em Salvador', destination: 'Salvador, BA' },\n      { title: 'Trilha na Serra da Mantiqueira', destination: 'Serra da Mantiqueira, MG' },\n      { title: 'Praias de Maragogi', destination: 'Maragogi, AL' },\n      { title: 'Cultura em Ouro Preto', destination: 'Ouro Preto, MG' },\n      { title: 'Amaz√¥nia - Manaus', destination: 'Manaus, AM' },\n      { title: 'Surf em Florian√≥polis', destination: 'Florian√≥polis, SC' },\n      { title: 'Vin√≠colas na Serra Ga√∫cha', destination: 'Serra Ga√∫cha, RS' },\n      { title: 'Len√ß√≥is Maranhenses', destination: 'Len√ß√≥is Maranhenses, MA' },\n      { title: 'Festa Junina em Caruaru', destination: 'Caruaru, PE' },\n      { title: 'R√©veillon em Copacabana', destination: 'Rio de Janeiro, RJ' },\n      { title: 'Patag√¥nia Argentina', destination: 'El Calafate, Argentina' },\n      { title: 'Machu Picchu', destination: 'Cusco, Peru' },\n      { title: 'Saf√°ri no Qu√™nia', destination: 'Nairobi, Qu√™nia' }\n    ];\n    \n    console.log('\\nüîß APLICANDO CORRE√á√ïES...');\n    let totalUpdated = 0;\n    \n    for (const correction of corrections) {\n      console.log(`  Atualizando \"${correction.title}\" ‚Üí \"${correction.destination}\"`);\n      \n      const [result] = await connection.execute(\n        'UPDATE trips SET destination = ? WHERE title = ?',\n        [correction.destination, correction.title]\n      );\n      \n      const affectedRows = (result as any).affectedRows;\n      totalUpdated += affectedRows;\n      console.log(`    ‚úÖ ${affectedRows} viagens atualizadas`);\n    }\n    \n    console.log(`\\n‚úÖ Corre√ß√£o conclu√≠da! Total: ${totalUpdated} viagens atualizadas.`);\n    \n    // Verificar resultado\n    console.log('\\nüîç VERIFICANDO RESULTADO...');\n    \n    const [destinationsResult] = await connection.execute(`\n      SELECT destination, COUNT(*) as count \n      FROM trips \n      WHERE destination IS NOT NULL AND destination != 'undefined' \n      GROUP BY destination \n      ORDER BY destination\n    `);\n    \n    const [activitiesResult] = await connection.execute(`\n      SELECT location, COUNT(*) as count \n      FROM activities \n      WHERE location IS NOT NULL \n      GROUP BY location \n      ORDER BY location\n    `);\n    \n    console.log('\\nüìç DESTINOS DAS VIAGENS (ap√≥s corre√ß√£o):');\n    (destinationsResult as any[]).forEach(row => {\n      console.log(`  - \"${row.destination}\" (${row.count} viagens)`);\n    });\n    \n    console.log('\\nüèõÔ∏è LOCALIZA√á√ïES DAS ATIVIDADES:');\n    (activitiesResult as any[]).forEach(row => {\n      console.log(`  - \"${row.location}\" (${row.count} atividades)`);\n    });\n    \n    // Verificar correspond√™ncias\n    const tripDestinations = (destinationsResult as any[]).map(row => row.destination);\n    const activityLocations = (activitiesResult as any[]).map(row => row.location);\n    \n    const matched = activityLocations.filter(loc => tripDestinations.includes(loc));\n    const unmatched = activityLocations.filter(loc => !tripDestinations.includes(loc));\n    \n    console.log(`\\n‚úÖ Localiza√ß√µes correspondentes: ${matched.length}`);\n    matched.forEach(loc => console.log(`  ‚úì \"${loc}\"`));\n    \n    console.log(`\\n‚ùå Localiza√ß√µes sem correspond√™ncia: ${unmatched.length}`);\n    unmatched.forEach(loc => console.log(`  ‚úó \"${loc}\"`));\n    \n    const destinationsWithoutActivities = tripDestinations.filter(dest => !activityLocations.includes(dest));\n    console.log(`\\nüö® DESTINOS SEM ATIVIDADES (${destinationsWithoutActivities.length}):`);\n    destinationsWithoutActivities.forEach(dest => console.log(`  - \"${dest}\"`));\n    \n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  } finally {\n    if (connection) {\n      await connection.end();\n      console.log('\\nüîå Conex√£o MySQL fechada');\n    }\n  }\n}\n\nfixDestinationsManual();","size_bytes":5330},"server/fix-destinations-sql.ts":{"content":"import { db } from './db.js';\n\nasync function fixDestinationsWithSQL() {\n  try {\n    console.log('üîÑ CORRIGINDO DESTINOS DAS VIAGENS COM SQL DIRETO...\\n');\n    \n    // Definir as corre√ß√µes por t√≠tulo\n    const corrections = [\n      { title: 'Rio de Janeiro Completo', destination: 'Rio de Janeiro, RJ' },\n      { title: 'S√£o Paulo Gastron√¥mico', destination: 'S√£o Paulo, SP' },\n      { title: 'Aventura no Pantanal', destination: 'Pantanal, MT' },\n      { title: 'Carnaval em Salvador', destination: 'Salvador, BA' },\n      { title: 'Trilha na Serra da Mantiqueira', destination: 'Serra da Mantiqueira, MG' },\n      { title: 'Praias de Maragogi', destination: 'Maragogi, AL' },\n      { title: 'Cultura em Ouro Preto', destination: 'Ouro Preto, MG' },\n      { title: 'Amaz√¥nia - Manaus', destination: 'Manaus, AM' },\n      { title: 'Surf em Florian√≥polis', destination: 'Florian√≥polis, SC' },\n      { title: 'Vin√≠colas na Serra Ga√∫cha', destination: 'Serra Ga√∫cha, RS' },\n      { title: 'Len√ß√≥is Maranhenses', destination: 'Len√ß√≥is Maranhenses, MA' },\n      { title: 'Festa Junina em Caruaru', destination: 'Caruaru, PE' },\n      { title: 'R√©veillon em Copacabana', destination: 'Rio de Janeiro, RJ' },\n      { title: 'Patag√¥nia Argentina', destination: 'El Calafate, Argentina' },\n      { title: 'Machu Picchu', destination: 'Cusco, Peru' },\n      { title: 'Saf√°ri no Qu√™nia', destination: 'Nairobi, Qu√™nia' }\n    ];\n    \n    let updatedCount = 0;\n    \n    for (const correction of corrections) {\n      console.log(`  Atualizando \"${correction.title}\" ‚Üí \"${correction.destination}\"`);\n      \n      const result = await db.execute(`\n        UPDATE trips \n        SET destination = ? \n        WHERE title = ?\n      `, [correction.destination, correction.title]);\n      \n      updatedCount += (result as any).affectedRows || 0;\n    }\n    \n    console.log(`\\n‚úÖ Corre√ß√£o conclu√≠da! ${updatedCount} viagens atualizadas.`);\n    \n    // Verificar resultado\n    console.log('\\nüîç VERIFICANDO RESULTADO...');\n    \n    const tripsResult = await db.execute('SELECT DISTINCT destination FROM trips WHERE destination IS NOT NULL ORDER BY destination');\n    const activitiesResult = await db.execute('SELECT DISTINCT location FROM activities WHERE location IS NOT NULL ORDER BY location');\n    \n    const tripDestinations = (tripsResult as any).map((row: any) => row.destination);\n    const activityLocations = (activitiesResult as any).map((row: any) => row.location);\n    \n    console.log('\\nüìç DESTINOS DAS VIAGENS (ap√≥s corre√ß√£o):');\n    for (const dest of tripDestinations) {\n      const countResult = await db.execute('SELECT COUNT(*) as count FROM trips WHERE destination = ?', [dest]);\n      const count = (countResult as any)[0].count;\n      console.log(`  - \"${dest}\" (${count} viagens)`);\n    }\n    \n    console.log('\\nüèõÔ∏è LOCALIZA√á√ïES DAS ATIVIDADES:');\n    for (const loc of activityLocations) {\n      const countResult = await db.execute('SELECT COUNT(*) as count FROM activities WHERE location = ?', [loc]);\n      const count = (countResult as any)[0].count;\n      console.log(`  - \"${loc}\" (${count} atividades)`);\n    }\n    \n    const matched = activityLocations.filter(loc => tripDestinations.includes(loc));\n    const unmatched = activityLocations.filter(loc => !tripDestinations.includes(loc));\n    \n    console.log(`\\n‚úÖ Localiza√ß√µes correspondentes: ${matched.length}`);\n    matched.forEach(loc => console.log(`  ‚úì \"${loc}\"`));\n    \n    console.log(`\\n‚ùå Localiza√ß√µes sem correspond√™ncia: ${unmatched.length}`);\n    unmatched.forEach(loc => console.log(`  ‚úó \"${loc}\"`));\n    \n    // Destinos sem atividades\n    const destinationsWithoutActivities = tripDestinations.filter(dest => !activityLocations.includes(dest));\n    console.log(`\\nüö® DESTINOS SEM ATIVIDADES (${destinationsWithoutActivities.length}):`);\n    destinationsWithoutActivities.forEach(dest => console.log(`  - \"${dest}\"`));\n    \n  } catch (error) {\n    console.error('‚ùå Erro durante corre√ß√£o:', error);\n  }\n  \n  process.exit(0);\n}\n\nfixDestinationsWithSQL();","size_bytes":4090},"server/fix-hierarchical-data.ts":{"content":"import { db } from './db.js';\nimport { activities } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\n\nasync function fixHierarchicalData() {\n  try {\n    console.log(\"üîÑ Corrigindo classifica√ß√£o hier√°rquica...\");\n    \n    // Fix incorrect classifications\n    const fixes = [\n      { title: \"Passeio de Catamaran em Bombinhas\", countryType: \"nacional\", region: \"Sul\", city: \"Bombinhas\" },\n      { title: \"Observa√ß√£o de Baleias - Praia do Rosa\", countryType: \"nacional\", region: \"Sul\", city: \"Imbituba\" },\n      { title: \"Aula de Surf - Praia do Campeche\", countryType: \"nacional\", region: \"Sul\", city: \"Florian√≥polis\" },\n    ];\n    \n    for (const fix of fixes) {\n      const activity = await db.select().from(activities).where(eq(activities.title, fix.title)).limit(1);\n      \n      if (activity.length > 0) {\n        await db.update(activities)\n          .set({\n            countryType: fix.countryType,\n            region: fix.region,\n            city: fix.city\n          })\n          .where(eq(activities.id, activity[0].id));\n        \n        console.log(`‚úÖ Corrigida atividade \"${fix.title}\" - ${fix.countryType}/${fix.region}/${fix.city}`);\n      }\n    }\n    \n    console.log(\"‚úÖ Corre√ß√µes aplicadas com sucesso!\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro ao corrigir dados:\", error);\n  }\n}\n\nif (import.meta.url === `file://${process.argv[1]}`) {\n  fixHierarchicalData().then(() => process.exit(0));\n}\n\nexport { fixHierarchicalData };","size_bytes":1478},"server/fix-localidades-final.ts":{"content":"import { db } from './db.js';\n\nasync function fixLocalidadesFinal() {\n  try {\n    console.log('üîÑ CORRIGINDO CAMPO LOCALIDADE DAS VIAGENS...\\n');\n    \n    // Mapeamento de t√≠tulos para localidades\n    const titleToLocalidade = {\n      'Rio de Janeiro Completo': 'Rio de Janeiro, RJ',\n      'S√£o Paulo Gastron√¥mico': 'S√£o Paulo, SP',\n      'Aventura no Pantanal': 'Pantanal, MT',\n      'Carnaval em Salvador': 'Salvador, BA',\n      'Trilha na Serra da Mantiqueira': 'Serra da Mantiqueira, MG',\n      'Praias de Maragogi': 'Maragogi, AL',\n      'Cultura em Ouro Preto': 'Ouro Preto, MG',\n      'Amaz√¥nia - Manaus': 'Manaus, AM',\n      'Surf em Florian√≥polis': 'Florian√≥polis, SC',\n      'Vin√≠colas na Serra Ga√∫cha': 'Serra Ga√∫cha, RS',\n      'Len√ß√≥is Maranhenses': 'Len√ß√≥is Maranhenses, MA',\n      'Festa Junina em Caruaru': 'Caruaru, PE',\n      'R√©veillon em Copacabana': 'Rio de Janeiro, RJ',\n      'Patag√¥nia Argentina': 'El Calafate, Argentina',\n      'Machu Picchu': 'Cusco, Peru',\n      'Saf√°ri no Qu√™nia': 'Nairobi, Qu√™nia'\n    };\n\n    let updatedCount = 0;\n    \n    for (const [title, localidade] of Object.entries(titleToLocalidade)) {\n      console.log(`  Atualizando \"${title}\" ‚Üí \"${localidade}\"`);\n      \n      const result = await db.execute(\n        'UPDATE trips SET localidade = ? WHERE title = ?',\n        [localidade, title]\n      );\n      \n      const affectedRows = (result as any).affectedRows || 0;\n      updatedCount += affectedRows;\n      console.log(`    ‚úÖ ${affectedRows} viagens atualizadas`);\n    }\n    \n    console.log(`\\n‚úÖ Corre√ß√£o conclu√≠da! Total: ${updatedCount} viagens atualizadas.`);\n    \n    // Verificar resultado\n    console.log('\\nüîç VERIFICANDO CORRESPOND√äNCIAS...');\n    \n    const tripsResult = await db.execute(`\n      SELECT localidade, COUNT(*) as count \n      FROM trips \n      WHERE localidade IS NOT NULL AND localidade != '' \n      GROUP BY localidade \n      ORDER BY localidade\n    `);\n    \n    const activitiesResult = await db.execute(`\n      SELECT location, COUNT(*) as count \n      FROM activities \n      WHERE location IS NOT NULL \n      GROUP BY location \n      ORDER BY location\n    `);\n    \n    console.log('\\nüìç LOCALIDADES DAS VIAGENS (ap√≥s corre√ß√£o):');\n    (tripsResult as any).forEach(row => {\n      console.log(`  - \"${row.localidade}\" (${row.count} viagens)`);\n    });\n    \n    console.log('\\nüèõÔ∏è LOCALIZA√á√ïES DAS ATIVIDADES:');\n    (activitiesResult as any).forEach(row => {\n      console.log(`  - \"${row.location}\" (${row.count} atividades)`);\n    });\n    \n    // Verificar correspond√™ncias\n    const tripLocalidades = (tripsResult as any).map(row => row.localidade);\n    const activityLocations = (activitiesResult as any).map(row => row.location);\n    \n    const matched = activityLocations.filter(loc => tripLocalidades.includes(loc));\n    const unmatched = activityLocations.filter(loc => !tripLocalidades.includes(loc));\n    \n    console.log(`\\n‚úÖ Localiza√ß√µes correspondentes: ${matched.length}`);\n    matched.forEach(loc => console.log(`  ‚úì \"${loc}\"`));\n    \n    console.log(`\\n‚ùå Localiza√ß√µes sem correspond√™ncia: ${unmatched.length}`);\n    unmatched.forEach(loc => console.log(`  ‚úó \"${loc}\"`));\n    \n    // Localidades sem atividades\n    const localidadesWithoutActivities = tripLocalidades.filter(loc => !activityLocations.includes(loc));\n    console.log(`\\nüö® LOCALIDADES SEM ATIVIDADES (${localidadesWithoutActivities.length}):`);\n    localidadesWithoutActivities.forEach(loc => console.log(`  - \"${loc}\"`));\n    \n    if (localidadesWithoutActivities.length > 0) {\n      console.log('\\nüí° SUGEST√ÉO: Adicionar atividades para essas localidades para melhorar a experi√™ncia do usu√°rio.');\n    }\n    \n  } catch (error) {\n    console.error('‚ùå Erro durante corre√ß√£o:', error);\n  }\n  \n  process.exit(0);\n}\n\nfixLocalidadesFinal();","size_bytes":3868},"server/fix-localidades-simple.ts":{"content":"import { db } from './db.js';\n\nasync function fixLocalidadesSimple() {\n  try {\n    console.log('üîÑ CORRIGINDO LOCALIDADES DAS VIAGENS (SQL DIRETO)...\\n');\n    \n    const updates = [\n      { title: 'Rio de Janeiro Completo', localidade: 'Rio de Janeiro, RJ' },\n      { title: 'S√£o Paulo Gastron√¥mico', localidade: 'S√£o Paulo, SP' },\n      { title: 'Aventura no Pantanal', localidade: 'Pantanal, MT' },\n      { title: 'Carnaval em Salvador', localidade: 'Salvador, BA' },\n      { title: 'Trilha na Serra da Mantiqueira', localidade: 'Serra da Mantiqueira, MG' },\n      { title: 'Praias de Maragogi', localidade: 'Maragogi, AL' },\n      { title: 'Cultura em Ouro Preto', localidade: 'Ouro Preto, MG' },\n      { title: 'Amaz√¥nia - Manaus', localidade: 'Manaus, AM' },\n      { title: 'Surf em Florian√≥polis', localidade: 'Florian√≥polis, SC' },\n      { title: 'Vin√≠colas na Serra Ga√∫cha', localidade: 'Serra Ga√∫cha, RS' },\n      { title: 'Len√ß√≥is Maranhenses', localidade: 'Len√ß√≥is Maranhenses, MA' },\n      { title: 'Festa Junina em Caruaru', localidade: 'Caruaru, PE' },\n      { title: 'R√©veillon em Copacabana', localidade: 'Rio de Janeiro, RJ' },\n      { title: 'Patag√¥nia Argentina', localidade: 'El Calafate, Argentina' },\n      { title: 'Machu Picchu', localidade: 'Cusco, Peru' },\n      { title: 'Saf√°ri no Qu√™nia', localidade: 'Nairobi, Qu√™nia' }\n    ];\n\n    let totalUpdated = 0;\n    \n    for (const update of updates) {\n      console.log(`  Atualizando \"${update.title}\" ‚Üí \"${update.localidade}\"`);\n      \n      const sql = `UPDATE trips SET localidade = '${update.localidade}' WHERE title = '${update.title}'`;\n      const result = await db.execute(sql);\n      \n      const affectedRows = (result as any).affectedRows || 0;\n      totalUpdated += affectedRows;\n      console.log(`    ‚úÖ ${affectedRows} viagens atualizadas`);\n    }\n    \n    console.log(`\\n‚úÖ Corre√ß√£o conclu√≠da! Total: ${totalUpdated} viagens atualizadas.`);\n    \n    // Verificar resultado\n    console.log('\\nüîç VERIFICANDO CORRESPOND√äNCIAS...');\n    \n    const [tripsResult] = await db.execute(`\n      SELECT localidade, COUNT(*) as count \n      FROM trips \n      WHERE localidade IS NOT NULL AND localidade != '' \n      GROUP BY localidade \n      ORDER BY localidade\n    `);\n    \n    const [activitiesResult] = await db.execute(`\n      SELECT location, COUNT(*) as count \n      FROM activities \n      WHERE location IS NOT NULL \n      GROUP BY location \n      ORDER BY location\n    `);\n    \n    console.log('\\nüìç LOCALIDADES DAS VIAGENS (ap√≥s corre√ß√£o):');\n    (tripsResult as any).forEach(row => {\n      console.log(`  - \"${row.localidade}\" (${row.count} viagens)`);\n    });\n    \n    console.log('\\nüèõÔ∏è LOCALIZA√á√ïES DAS ATIVIDADES:');\n    (activitiesResult as any).forEach(row => {\n      console.log(`  - \"${row.location}\" (${row.count} atividades)`);\n    });\n    \n    // Verificar correspond√™ncias\n    const tripLocalidades = (tripsResult as any).map(row => row.localidade);\n    const activityLocations = (activitiesResult as any).map(row => row.location);\n    \n    const matched = activityLocations.filter(loc => tripLocalidades.includes(loc));\n    const unmatched = activityLocations.filter(loc => !tripLocalidades.includes(loc));\n    \n    console.log(`\\n‚úÖ Localiza√ß√µes correspondentes: ${matched.length}`);\n    matched.forEach(loc => console.log(`  ‚úì \"${loc}\"`));\n    \n    console.log(`\\n‚ùå Localiza√ß√µes sem correspond√™ncia: ${unmatched.length}`);\n    unmatched.forEach(loc => console.log(`  ‚úó \"${loc}\"`));\n    \n    // Localidades sem atividades  \n    const localidadesWithoutActivities = tripLocalidades.filter(loc => !activityLocations.includes(loc));\n    console.log(`\\nüö® LOCALIDADES SEM ATIVIDADES (${localidadesWithoutActivities.length}):`);\n    localidadesWithoutActivities.forEach(loc => console.log(`  - \"${loc}\"`));\n    \n    console.log(`\\nüìä RESUMO FINAL:`);\n    console.log(`  ‚Ä¢ Total de localidades com viagens: ${tripLocalidades.length}`);\n    console.log(`  ‚Ä¢ Total de localiza√ß√µes com atividades: ${activityLocations.length}`);\n    console.log(`  ‚Ä¢ Correspond√™ncias: ${matched.length}`);\n    console.log(`  ‚Ä¢ Taxa de correspond√™ncia: ${Math.round((matched.length / Math.max(tripLocalidades.length, 1)) * 100)}%`);\n    \n  } catch (error) {\n    console.error('‚ùå Erro durante corre√ß√£o:', error);\n  }\n  \n  process.exit(0);\n}\n\nfixLocalidadesSimple();","size_bytes":4415},"server/fix-location-standardization.ts":{"content":"import { db } from './db.js';\nimport { activities, trips } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\n\n// Mapeamento padronizado de destinos\nconst LOCATION_MAPPING = {\n  // Destinos nacionais\n  'Rio de Janeiro': 'Rio de Janeiro, RJ',\n  'S√£o Paulo': 'S√£o Paulo, SP',\n  'Pantanal': 'Pantanal, MT',\n  'Salvador': 'Salvador, BA',\n  'Serra da Mantiqueira': 'Serra da Mantiqueira, MG',\n  'Maragogi': 'Maragogi, AL',\n  'Ouro Preto': 'Ouro Preto, MG',\n  'Manaus': 'Manaus, AM',\n  'Florian√≥polis': 'Florian√≥polis, SC',\n  'Serra Ga√∫cha': 'Serra Ga√∫cha, RS',\n  'Gramado': 'Gramado, RS',\n  'Len√ß√≥is Maranhenses': 'Len√ß√≥is Maranhenses, MA',\n  'Caruaru': 'Caruaru, PE',\n  'Bonito': 'Bonito, MS',\n  'Copacabana': 'Rio de Janeiro, RJ',\n  \n  // Destinos internacionais\n  'Patag√¥nia Argentina': 'El Calafate, Argentina',\n  'Machu Picchu': 'Cusco, Peru',\n  'Saf√°ri no Qu√™nia': 'Nairobi, Qu√™nia',\n  'Paris': 'Paris, Fran√ßa',\n  'Nova York': 'Nova York, EUA',\n  'Londres': 'Londres, Reino Unido',\n  'Roma': 'Roma, It√°lia',\n  'Buenos Aires': 'Buenos Aires, Argentina'\n};\n\nasync function standardizeLocations() {\n  try {\n    console.log('üîÑ INICIANDO PADRONIZA√á√ÉO DE LOCALIZA√á√ïES...\\n');\n    \n    // Verificar viagens atuais\n    const allTrips = await db.select().from(trips);\n    console.log(`üìä Total de viagens encontradas: ${allTrips.length}`);\n    \n    // Agrupar por destino\n    const destinationGroups = allTrips.reduce((acc, trip) => {\n      if (!acc[trip.destination]) acc[trip.destination] = [];\n      acc[trip.destination].push(trip);\n      return acc;\n    }, {} as Record<string, any[]>);\n    \n    console.log('\\nüó∫Ô∏è DESTINOS ATUAIS DAS VIAGENS:');\n    Object.keys(destinationGroups).forEach(dest => {\n      console.log(`  \"${dest}\" (${destinationGroups[dest].length} viagens)`);\n    });\n    \n    // Aplicar padroniza√ß√£o\n    console.log('\\nüîß APLICANDO PADRONIZA√á√ÉO...');\n    let updatedCount = 0;\n    \n    for (const [oldDestination, newLocation] of Object.entries(LOCATION_MAPPING)) {\n      const tripsToUpdate = allTrips.filter(trip => trip.destination === oldDestination);\n      \n      if (tripsToUpdate.length > 0) {\n        console.log(`  Atualizando \"${oldDestination}\" ‚Üí \"${newLocation}\" (${tripsToUpdate.length} viagens)`);\n        \n        for (const trip of tripsToUpdate) {\n          await db.update(trips)\n            .set({ destination: newLocation })\n            .where(eq(trips.id, trip.id));\n          updatedCount++;\n        }\n      }\n    }\n    \n    console.log(`\\n‚úÖ Padroniza√ß√£o conclu√≠da! ${updatedCount} viagens atualizadas.`);\n    \n    // Verificar correspond√™ncias ap√≥s padroniza√ß√£o\n    console.log('\\nüîç VERIFICANDO CORRESPOND√äNCIAS AP√ìS PADRONIZA√á√ÉO...');\n    \n    const updatedTrips = await db.select().from(trips);\n    const allActivities = await db.select().from(activities);\n    \n    const tripDestinations = [...new Set(updatedTrips.map(t => t.destination))].filter(Boolean);\n    const activityLocations = [...new Set(allActivities.map(a => a.location))].filter(Boolean);\n    \n    console.log('\\nüìç DESTINOS DAS VIAGENS (ap√≥s padroniza√ß√£o):');\n    tripDestinations.forEach(dest => console.log(`  - \"${dest}\"`));\n    \n    console.log('\\nüèõÔ∏è LOCALIZA√á√ïES DAS ATIVIDADES:');\n    activityLocations.forEach(loc => console.log(`  - \"${loc}\"`));\n    \n    const matched = activityLocations.filter(loc => tripDestinations.includes(loc));\n    const unmatched = activityLocations.filter(loc => !tripDestinations.includes(loc));\n    \n    console.log(`\\n‚úÖ Localiza√ß√µes correspondentes: ${matched.length}`);\n    matched.forEach(loc => console.log(`  ‚úì \"${loc}\"`));\n    \n    console.log(`\\n‚ùå Localiza√ß√µes sem correspond√™ncia: ${unmatched.length}`);\n    unmatched.forEach(loc => console.log(`  ‚úó \"${loc}\"`));\n    \n    // Adicionar atividades para destinos sem atividades\n    const destinationsWithoutActivities = tripDestinations.filter(dest => !activityLocations.includes(dest));\n    \n    if (destinationsWithoutActivities.length > 0) {\n      console.log(`\\nüö® DESTINOS SEM ATIVIDADES (${destinationsWithoutActivities.length}):`);\n      destinationsWithoutActivities.forEach(dest => {\n        const tripCount = updatedTrips.filter(t => t.destination === dest).length;\n        console.log(`  - \"${dest}\" (${tripCount} viagens)`);\n      });\n    }\n    \n  } catch (error) {\n    console.error('‚ùå Erro durante padroniza√ß√£o:', error);\n  }\n  \n  process.exit(0);\n}\n\nstandardizeLocations();","size_bytes":4483},"server/fix-proposals-insert.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nasync function fixProposalsInsert() {\n  try {\n    console.log('üîß Corrigindo inser√ß√£o de propostas...');\n    \n    // Testar inser√ß√£o em uma atividade espec√≠fica primeiro\n    const testActivity = await db.select().from(activities).limit(1);\n    if (testActivity.length === 0) {\n      console.error('‚ùå Nenhuma atividade encontrada');\n      return;\n    }\n\n    const activity = testActivity[0];\n    console.log(`üéØ Testando com atividade: ${activity.title} (ID: ${activity.id})`);\n\n    // Verificar se j√° existe proposta para esta atividade\n    const existingProposals = await db.select()\n      .from(activityBudgetProposals)\n      .where(eq(activityBudgetProposals.activityId, activity.id));\n\n    console.log(`üìã Propostas existentes: ${existingProposals.length}`);\n\n    if (existingProposals.length === 0) {\n      console.log('üí° Inserindo proposta de teste...');\n      \n      try {\n        const insertResult = await db.insert(activityBudgetProposals).values({\n          activityId: activity.id,\n          createdBy: 1,\n          title: \"Teste Econ√¥mico\",\n          description: \"Proposta de teste econ√¥mica\",\n          amount: \"50.00\",\n          inclusions: JSON.stringify([\"Entrada\", \"Guia\"]),\n          exclusions: JSON.stringify([\"Transporte\", \"Alimenta√ß√£o\"]),\n          isActive: true,\n          votes: 0\n        });\n        \n        console.log('‚úÖ Proposta inserida com sucesso!', insertResult);\n        \n        // Verificar se foi inserida\n        const newProposals = await db.select()\n          .from(activityBudgetProposals)\n          .where(eq(activityBudgetProposals.activityId, activity.id));\n        \n        console.log(`‚úÖ Verifica√ß√£o: ${newProposals.length} propostas encontradas`);\n        \n      } catch (insertError) {\n        console.error('‚ùå Erro na inser√ß√£o:', insertError);\n      }\n    }\n\n  } catch (error) {\n    console.error('‚ùå Erro geral:', error);\n  }\n}\n\nfixProposalsInsert().then(() => process.exit(0)).catch(err => {\n  console.error(err);\n  process.exit(1);\n});","size_bytes":2209},"server/fix-rio-proposals.ts":{"content":"import { db } from './db.js';\nimport { activityBudgetProposals } from '../shared/schema.js';\nimport { eq, and, gte, lte } from 'drizzle-orm';\n\nasync function fixRioProposals() {\n  console.log('üîß Corrigindo propostas de or√ßamento das atividades do Rio...');\n  \n  try {\n    // Delete existing proposals for Rio activities (IDs 16-20)\n    console.log('üóëÔ∏è Removendo propostas incorretas...');\n    await db.delete(activityBudgetProposals).where(\n      and(\n        gte(activityBudgetProposals.activityId, 16),\n        lte(activityBudgetProposals.activityId, 20)\n      )\n    );\n    \n    // Budget proposals data for each activity\n    const proposalsData = [\n      // Cristo Redentor / Corcovado (ID: 16)\n      { activityId: 16, title: \"Econ√¥mico\", description: \"Van oficial b√°sica\", amount: \"85.00\", inclusions: [\"Transporte\", \"Ingresso\"] },\n      { activityId: 16, title: \"Completo\", description: \"Trem do Corcovado\", amount: \"160.00\", inclusions: [\"Trem\", \"Ingresso\", \"Guia\"] },\n      { activityId: 16, title: \"Premium\", description: \"Tour premium VIP\", amount: \"300.00\", inclusions: [\"Trem\", \"Ingresso\", \"Guia VIP\", \"Fotos\"] },\n      \n      // P√£o de A√ß√∫car (ID: 17)\n      { activityId: 17, title: \"Econ√¥mico\", description: \"Bondinho b√°sico\", amount: \"120.00\", inclusions: [\"Bondinho\", \"Ingresso\"] },\n      { activityId: 17, title: \"Completo\", description: \"Bondinho + guia\", amount: \"200.00\", inclusions: [\"Bondinho\", \"Ingresso\", \"Guia\", \"Lanche\"] },\n      { activityId: 17, title: \"Premium\", description: \"Experi√™ncia VIP\", amount: \"350.00\", inclusions: [\"Bondinho\", \"Ingresso\", \"Guia VIP\", \"Jantar\", \"Fotos\"] },\n      \n      // Copacabana/Ipanema (ID: 18)\n      { activityId: 18, title: \"Econ√¥mico\", description: \"Gratuito - praia livre\", amount: \"0.00\", inclusions: [\"Acesso √† praia\"] },\n      { activityId: 18, title: \"Completo\", description: \"Aluguel de equipamentos\", amount: \"80.00\", inclusions: [\"Prancha surf\", \"Cadeira\", \"Guarda-sol\"] },\n      { activityId: 18, title: \"Premium\", description: \"Aula de surf profissional\", amount: \"150.00\", inclusions: [\"Aula surf\", \"Equipamentos\", \"Instrutor\", \"Fotos\"] },\n      \n      // Trilha Pedra Bonita (ID: 19)\n      { activityId: 19, title: \"Econ√¥mico\", description: \"Trilha livre\", amount: \"0.00\", inclusions: [\"Acesso √† trilha\"] },\n      { activityId: 19, title: \"Completo\", description: \"Trilha com guia\", amount: \"120.00\", inclusions: [\"Guia\", \"Equipamentos\", \"Lanche\"] },\n      { activityId: 19, title: \"Premium\", description: \"Trilha VIP com fotos\", amount: \"250.00\", inclusions: [\"Guia especializado\", \"Equipamentos\", \"Fotos profissionais\", \"Lanche gourmet\"] },\n      \n      // Tour Cultural (ID: 20)\n      { activityId: 20, title: \"Econ√¥mico\", description: \"Visita individual\", amount: \"30.00\", inclusions: [\"Ingressos b√°sicos\"] },\n      { activityId: 20, title: \"Completo\", description: \"Tour guiado\", amount: \"120.00\", inclusions: [\"Ingressos\", \"Guia\", \"Transporte\"] },\n      { activityId: 20, title: \"Premium\", description: \"Tour cultural VIP\", amount: \"280.00\", inclusions: [\"Ingressos\", \"Guia especializado\", \"Transporte VIP\", \"Almo√ßo\", \"Material exclusivo\"] }\n    ];\n    \n    // Insert correct proposals\n    console.log('‚úÖ Inserindo propostas corretas...');\n    for (const proposal of proposalsData) {\n      await db.insert(activityBudgetProposals).values({\n        activityId: proposal.activityId,\n        createdBy: 1, // User tom\n        title: proposal.title,\n        description: proposal.description,\n        amount: proposal.amount,\n        inclusions: JSON.stringify(proposal.inclusions),\n        exclusions: JSON.stringify([]),\n        votes: Math.floor(Math.random() * 50) + 10,\n        isActive: true\n      });\n      \n      console.log(`üí∞ Proposta \"${proposal.title}\" criada para atividade ${proposal.activityId}: R$ ${proposal.amount}`);\n    }\n    \n    console.log('üéâ Todas as propostas foram corrigidas com sucesso!');\n    \n  } catch (error) {\n    console.error('‚ùå Erro ao corrigir propostas:', error);\n  }\n}\n\nfixRioProposals();","size_bytes":4039},"server/fix-storage-mysql.ts":{"content":"#!/usr/bin/env tsx\nimport { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { sql } from 'drizzle-orm';\n\n/**\n * Script to fix storage.ts MySQL compatibility issues and fill missing activity data\n */\n\nasync function fixStorageMySQL() {\n  console.log('üîß Fixing storage.ts MySQL compatibility issues...');\n  \n  // Check activities without proposals\n  const activitiesWithoutProposals = await db.select({\n    id: activities.id,\n    title: activities.title,\n    location: activities.location\n  }).from(activities)\n  .leftJoin(activityBudgetProposals, sql`${activities.id} = ${activityBudgetProposals.activityId}`)\n  .where(sql`${activityBudgetProposals.activityId} IS NULL`)\n  .limit(10);\n  \n  console.log(`üìä Found ${activitiesWithoutProposals.length} activities without proposals:`);\n  activitiesWithoutProposals.forEach(a => console.log(`- ${a.title} (ID: ${a.id}) - ${a.location}`));\n  \n  // Check for activities with missing fields\n  const activitiesWithMissingFields = await db.select().from(activities)\n    .where(sql`${activities.countryType} IS NULL OR ${activities.region} IS NULL OR ${activities.priceType} IS NULL`)\n    .limit(10);\n  \n  console.log(`üìä Found ${activitiesWithMissingFields.length} activities with missing required fields`);\n  \n  // Update activities with missing fields\n  if (activitiesWithMissingFields.length > 0) {\n    for (const activity of activitiesWithMissingFields) {\n      const updates: any = {};\n      \n      if (!activity.countryType) {\n        updates.countryType = activity.location?.includes('Argentina') || activity.location?.includes('EUA') || \n                             activity.location?.includes('Reino Unido') || activity.location?.includes('It√°lia') ? \n                             'internacional' : 'nacional';\n      }\n      \n      if (!activity.region) {\n        if (activity.location?.includes('Argentina')) updates.region = 'Am√©rica do Sul';\n        else if (activity.location?.includes('EUA')) updates.region = 'Am√©rica do Norte';\n        else if (activity.location?.includes('Reino Unido')) updates.region = 'Europa';\n        else if (activity.location?.includes('It√°lia')) updates.region = 'Europa';\n        else updates.region = 'Brasil';\n      }\n      \n      if (!activity.priceType) {\n        updates.priceType = 'per_person';\n      }\n      \n      if (Object.keys(updates).length > 0) {\n        await db.update(activities).set(updates).where(sql`id = ${activity.id}`);\n        console.log(`‚úÖ Updated activity ${activity.id}: ${activity.title}`);\n      }\n    }\n  }\n  \n  console.log('üéâ Storage MySQL fixes completed!');\n}\n\nfixStorageMySQL().catch(console.error);","size_bytes":2689},"server/fix-table-schema.ts":{"content":"import { createConnection } from 'mysql2/promise';\n\nasync function fixTableSchema() {\n  const connection = await createConnection({\n    host: process.env.DB_HOST || 'srv1661.hstgr.io',\n    user: process.env.DB_USER || 'u715665838_partiutrip',\n    password: process.env.DB_PASSWORD || '@PartiuTrip2024',\n    database: process.env.DB_NAME || 'u715665838_partiutrip',\n  });\n\n  try {\n    console.log('üîç Verificando estrutura da tabela activity_budget_proposals...');\n    \n    // Check if table exists and what columns it has\n    const [tables] = await connection.execute(`\n      SELECT * FROM information_schema.TABLES \n      WHERE TABLE_SCHEMA = 'u715665838_partiutrip' \n      AND TABLE_NAME = 'activity_budget_proposals'\n    `);\n    \n    if (tables.length === 0) {\n      console.log('‚ùå Tabela activity_budget_proposals n√£o existe! Criando...');\n      \n      await connection.execute(`\n        CREATE TABLE activity_budget_proposals (\n          id INT AUTO_INCREMENT PRIMARY KEY,\n          activity_id INT NOT NULL,\n          created_by INT NOT NULL,\n          title VARCHAR(255) NOT NULL,\n          description TEXT,\n          price_type VARCHAR(50) DEFAULT 'per_person' NOT NULL,\n          amount DECIMAL(10,2) NOT NULL,\n          currency VARCHAR(3) DEFAULT 'BRL' NOT NULL,\n          inclusions JSON,\n          exclusions JSON,\n          valid_until TIMESTAMP NULL,\n          is_active BOOLEAN DEFAULT TRUE NOT NULL,\n          votes INT DEFAULT 0 NOT NULL,\n          created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n          updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n          FOREIGN KEY (activity_id) REFERENCES activities(id) ON DELETE CASCADE,\n          FOREIGN KEY (created_by) REFERENCES users(id) ON DELETE CASCADE\n        )\n      `);\n      \n      console.log('‚úÖ Tabela activity_budget_proposals criada!');\n    } else {\n      console.log('‚úÖ Tabela activity_budget_proposals existe');\n    }\n\n    // Check columns\n    const [columns] = await connection.execute(`\n      SELECT COLUMN_NAME, DATA_TYPE, IS_NULLABLE, COLUMN_KEY \n      FROM information_schema.COLUMNS \n      WHERE TABLE_SCHEMA = 'u715665838_partiutrip' \n      AND TABLE_NAME = 'activity_budget_proposals'\n      ORDER BY ORDINAL_POSITION\n    `);\n    \n    console.log('üìã Colunas da tabela:');\n    columns.forEach((col: any) => {\n      console.log(`- ${col.COLUMN_NAME} (${col.DATA_TYPE}) ${col.IS_NULLABLE === 'NO' ? 'NOT NULL' : 'NULL'} ${col.COLUMN_KEY || ''}`);\n    });\n\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  } finally {\n    await connection.end();\n  }\n}\n\nfixTableSchema().catch(console.error);","size_bytes":2641},"server/fix-trip-budgets-v2.ts":{"content":"import { db } from './db.js';\nimport { trips } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\n\n// Mapping function to match destinations with realistic budgets\nfunction getBudgetForTrip(title: string, destination: string) {\n  // International destinations\n  if (destination.includes('Qu√™nia') || title.includes('Saf√°ri')) {\n    return {\n      budget: 15000.00,\n      budgetBreakdown: JSON.stringify({\n        accommodation: 6000.00,    // Safari lodges\n        transport: 4500.00,        // International + safari vehicles\n        food: 2000.00,            // Lodge meals\n        activities: 2500.00       // Safari tours, park fees\n      })\n    };\n  }\n  \n  if (destination.includes('Argentina') || destination.includes('El Calafate') || title.includes('Patag√¥nia')) {\n    return {\n      budget: 8500.00,\n      budgetBreakdown: JSON.stringify({\n        accommodation: 3200.00,    // Lodge accommodations\n        transport: 3000.00,        // Flights + transfers\n        food: 1500.00,            // Regional cuisine\n        activities: 800.00        // Hiking tours, excursions\n      })\n    };\n  }\n  \n  if (destination.includes('Peru') || destination.includes('Cusco') || title.includes('Machu Picchu')) {\n    return {\n      budget: 5500.00,\n      budgetBreakdown: JSON.stringify({\n        accommodation: 2000.00,    // Hotels in Cusco/Aguas Calientes\n        transport: 2200.00,        // Flight + train to Machu Picchu\n        food: 800.00,             // Peruvian cuisine\n        activities: 500.00        // Machu Picchu entry + guides\n      })\n    };\n  }\n\n  // Brazilian destinations\n  if (destination.includes('Pantanal') || destination.includes('MS')) {\n    return {\n      budget: 3200.00,\n      budgetBreakdown: JSON.stringify({\n        accommodation: 1200.00,    // Eco lodges\n        transport: 800.00,         // Domestic flight + transfers\n        food: 600.00,             // Regional meals\n        activities: 600.00        // Wildlife tours, fishing\n      })\n    };\n  }\n  \n  if (destination.includes('Salvador') || destination.includes('BA')) {\n    return {\n      budget: 2800.00,\n      budgetBreakdown: JSON.stringify({\n        accommodation: 1000.00,    // Salvador hotels\n        transport: 700.00,         // Flight + local transport\n        food: 500.00,             // Bahian cuisine\n        activities: 600.00        // Carnival, city tours\n      })\n    };\n  }\n  \n  if (destination.includes('Mantiqueira') || destination.includes('MG')) {\n    return {\n      budget: 2200.00,\n      budgetBreakdown: JSON.stringify({\n        accommodation: 800.00,     // Mountain lodges\n        transport: 600.00,         // Car rental + gas\n        food: 400.00,             // Local restaurants\n        activities: 400.00        // Hiking, nature tours\n      })\n    };\n  }\n  \n  if (destination.includes('Maragogi') || destination.includes('AL')) {\n    return {\n      budget: 3500.00,\n      budgetBreakdown: JSON.stringify({\n        accommodation: 1400.00,    // Beach resorts\n        transport: 800.00,         // Flight + transfers\n        food: 700.00,             // Seafood restaurants\n        activities: 600.00        // Diving, boat tours\n      })\n    };\n  }\n  \n  if (destination.includes('Ouro Preto')) {\n    return {\n      budget: 2000.00,\n      budgetBreakdown: JSON.stringify({\n        accommodation: 700.00,     // Historic inns\n        transport: 500.00,         // Car/bus transport\n        food: 400.00,             // Traditional cuisine\n        activities: 400.00        // Museums, historic tours\n      })\n    };\n  }\n  \n  if (destination.includes('Manaus') || destination.includes('AM')) {\n    return {\n      budget: 4200.00,\n      budgetBreakdown: JSON.stringify({\n        accommodation: 1500.00,    // Amazon lodges\n        transport: 1200.00,        // Flight + boat transfers\n        food: 700.00,             // Regional cuisine\n        activities: 800.00        // Amazon tours, boat trips\n      })\n    };\n  }\n  \n  if (destination.includes('Florian√≥polis') || destination.includes('SC')) {\n    return {\n      budget: 2800.00,\n      budgetBreakdown: JSON.stringify({\n        accommodation: 1100.00,    // Beach hotels\n        transport: 600.00,         // Flight + local transport\n        food: 500.00,             // Seafood and local food\n        activities: 600.00        // Surfing, beach activities\n      })\n    };\n  }\n  \n  if (destination.includes('Gramado') || destination.includes('RS') || title.includes('Serra Ga√∫cha')) {\n    return {\n      budget: 2500.00,\n      budgetBreakdown: JSON.stringify({\n        accommodation: 900.00,     // Wine country hotels\n        transport: 500.00,         // Car rental\n        food: 600.00,             // Wine tastings and meals\n        activities: 500.00        // Winery tours\n      })\n    };\n  }\n  \n  if (destination.includes('Len√ß√≥is Maranhenses') || destination.includes('MA')) {\n    return {\n      budget: 3800.00,\n      budgetBreakdown: JSON.stringify({\n        accommodation: 1300.00,    // Local pousadas\n        transport: 1200.00,        // Flight + 4x4 transfers\n        food: 600.00,             // Regional cuisine\n        activities: 700.00        // Dune tours, lagoon visits\n      })\n    };\n  }\n  \n  if (destination.includes('Caruaru') || destination.includes('PE')) {\n    return {\n      budget: 2200.00,\n      budgetBreakdown: JSON.stringify({\n        accommodation: 700.00,     // Local hotels\n        transport: 600.00,         // Transport to interior\n        food: 400.00,             // Regional food\n        activities: 500.00        // June festivals, cultural tours\n      })\n    };\n  }\n  \n  if (destination.includes('Rio de Janeiro') || destination.includes('Copacabana') || title.includes('R√©veillon')) {\n    return {\n      budget: 4500.00,\n      budgetBreakdown: JSON.stringify({\n        accommodation: 1800.00,    // Copacabana hotels for NYE\n        transport: 800.00,         // Flight + local transport\n        food: 1000.00,            // Restaurant meals\n        activities: 900.00        // New Year's celebration, tours\n      })\n    };\n  }\n\n  // Default budget for unmatched destinations\n  return {\n    budget: 3000.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 1200.00,\n      transport: 800.00,\n      food: 600.00,\n      activities: 400.00\n    })\n  };\n}\n\nasync function fixTripBudgetsV2() {\n  console.log('üí∞ Iniciando corre√ß√£o V2 de or√ßamentos de viagens com mapeamento aprimorado...');\n  \n  try {\n    // Get all trips from database\n    const allTrips = await db.select().from(trips);\n    console.log(`üìä Encontradas ${allTrips.length} viagens para atualizar`);\n    \n    let updatedCount = 0;\n    \n    for (const trip of allTrips) {\n      const budgetData = getBudgetForTrip(trip.title, trip.destination);\n      \n      try {\n        await db\n          .update(trips)\n          .set({\n            budget: budgetData.budget,\n            budgetBreakdown: budgetData.budgetBreakdown\n          })\n          .where(eq(trips.id, trip.id));\n        \n        console.log(`‚úÖ \"${trip.title}\" (${trip.destination}): R$ ${budgetData.budget.toFixed(2)}`);\n        updatedCount++;\n      } catch (error: any) {\n        console.error(`‚ùå Erro ao atualizar viagem ${trip.id}:`, error.message);\n      }\n    }\n    \n    console.log(`\\nüéâ Corre√ß√£o V2 conclu√≠da com sucesso!`);\n    console.log(`üìà ${updatedCount}/${allTrips.length} viagens atualizadas`);\n    console.log(`\\nüí° Or√ßamentos baseados em pesquisa de mercado atual:`);\n    console.log(`   ‚Ä¢ Destinos internacionais: R$ 5.500 - R$ 15.000`);\n    console.log(`   ‚Ä¢ Destinos nacionais premium: R$ 3.200 - R$ 4.500`);\n    console.log(`   ‚Ä¢ Destinos nacionais m√©dios: R$ 2.200 - R$ 2.800`);\n    console.log(`   ‚Ä¢ Destinos nacionais econ√¥micos: R$ 2.000 - R$ 2.500`);\n    \n  } catch (error) {\n    console.error('‚ùå Erro na corre√ß√£o V2:', error);\n  }\n}\n\n// Execute the improved budget fix\nfixTripBudgetsV2();","size_bytes":7926},"server/fix-trip-budgets.ts":{"content":"import { db } from './db.js';\nimport { trips } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\n\n// Realistic budget values based on destination and trip duration\nconst realisticBudgets = {\n  // International destinations (per person)\n  'Paris, Fran√ßa': {\n    budget: 8500.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 3200.00,    // Hotels 4-5 star for 7-10 days\n      transport: 2500.00,        // Flight + local transport\n      food: 1800.00,            // Restaurant meals\n      activities: 1000.00       // Museums, tours, attractions\n    })\n  },\n  'Londres, Reino Unido': {\n    budget: 9200.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 3800.00,    // London hotels are expensive\n      transport: 2800.00,        // Flight + tube/taxi\n      food: 1800.00,            // Pub meals, restaurants\n      activities: 800.00         // Attractions, theaters\n    })\n  },\n  'Nova York, EUA': {\n    budget: 12000.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 4500.00,    // Manhattan hotels\n      transport: 3200.00,        // Flight + subway/taxi\n      food: 2500.00,            // NYC dining\n      activities: 1800.00       // Broadway, museums, tours\n    })\n  },\n  'Roma, It√°lia': {\n    budget: 7200.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 2800.00,    // Mid-range hotels\n      transport: 2200.00,        // Flight + local transport\n      food: 1400.00,            // Italian cuisine\n      activities: 800.00        // Vatican, Colosseum, etc\n    })\n  },\n  'Buenos Aires, Argentina': {\n    budget: 4500.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 1800.00,    // Good hotels in Argentina\n      transport: 1500.00,        // Flight + local transport\n      food: 800.00,             // Local cuisine\n      activities: 400.00        // Tango shows, tours\n    })\n  },\n  'Barcelona, Espanha': {\n    budget: 6800.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 2600.00,    // Barcelona hotels\n      transport: 2400.00,        // Flight + metro\n      food: 1200.00,            // Spanish cuisine\n      activities: 600.00        // Gaudi sites, beaches\n    })\n  },\n  'Qu√™nia, √Åfrica': {\n    budget: 15000.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 6000.00,    // Safari lodges\n      transport: 4500.00,        // International + safari vehicles\n      food: 2000.00,            // Lodge meals\n      activities: 2500.00       // Safari tours, park fees\n    })\n  },\n  'Patag√¥nia, Argentina': {\n    budget: 8500.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 3200.00,    // Lodge accommodations\n      transport: 3000.00,        // Flights + transfers\n      food: 1500.00,            // Regional cuisine\n      activities: 800.00        // Hiking tours, excursions\n    })\n  },\n  'Machu Picchu, Peru': {\n    budget: 5500.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 2000.00,    // Hotels in Cusco/Aguas Calientes\n      transport: 2200.00,        // Flight + train to Machu Picchu\n      food: 800.00,             // Peruvian cuisine\n      activities: 500.00        // Machu Picchu entry + guides\n    })\n  },\n\n  // Brazilian destinations (per person)\n  'Pantanal, MT': {\n    budget: 3200.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 1200.00,    // Eco lodges\n      transport: 800.00,         // Domestic flight + transfers\n      food: 600.00,             // Regional meals\n      activities: 600.00        // Wildlife tours, fishing\n    })\n  },\n  'Salvador, BA': {\n    budget: 2800.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 1000.00,    // Salvador hotels\n      transport: 700.00,         // Flight + local transport\n      food: 500.00,             // Bahian cuisine\n      activities: 600.00        // Carnival, city tours\n    })\n  },\n  'Serra da Mantiqueira, MG': {\n    budget: 2200.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 800.00,     // Mountain lodges\n      transport: 600.00,         // Car rental + gas\n      food: 400.00,             // Local restaurants\n      activities: 400.00        // Hiking, nature tours\n    })\n  },\n  'Maragogi, AL': {\n    budget: 3500.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 1400.00,    // Beach resorts\n      transport: 800.00,         // Flight + transfers\n      food: 700.00,             // Seafood restaurants\n      activities: 600.00        // Diving, boat tours\n    })\n  },\n  'Ouro Preto, MG': {\n    budget: 2000.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 700.00,     // Historic inns\n      transport: 500.00,         // Car/bus transport\n      food: 400.00,             // Traditional cuisine\n      activities: 400.00        // Museums, historic tours\n    })\n  },\n  'Manaus, AM': {\n    budget: 4200.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 1500.00,    // Amazon lodges\n      transport: 1200.00,        // Flight + boat transfers\n      food: 700.00,             // Regional cuisine\n      activities: 800.00        // Amazon tours, boat trips\n    })\n  },\n  'Florian√≥polis, SC': {\n    budget: 2800.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 1100.00,    // Beach hotels\n      transport: 600.00,         // Flight + local transport\n      food: 500.00,             // Seafood and local food\n      activities: 600.00        // Surfing, beach activities\n    })\n  },\n  'Serra Ga√∫cha, RS': {\n    budget: 2500.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 900.00,     // Wine country hotels\n      transport: 500.00,         // Car rental\n      food: 600.00,             // Wine tastings and meals\n      activities: 500.00        // Winery tours\n    })\n  },\n  'Len√ß√≥is Maranhenses, MA': {\n    budget: 3800.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 1300.00,    // Local pousadas\n      transport: 1200.00,        // Flight + 4x4 transfers\n      food: 600.00,             // Regional cuisine\n      activities: 700.00        // Dune tours, lagoon visits\n    })\n  },\n  'Caruaru, PE': {\n    budget: 2200.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 700.00,     // Local hotels\n      transport: 600.00,         // Transport to interior\n      food: 400.00,             // Regional food\n      activities: 500.00        // June festivals, cultural tours\n    })\n  },\n  'Copacabana, RJ': {\n    budget: 4500.00,\n    budgetBreakdown: JSON.stringify({\n      accommodation: 1800.00,    // Copacabana hotels for NYE\n      transport: 800.00,         // Flight + local transport\n      food: 1000.00,            // Restaurant meals\n      activities: 900.00        // New Year's celebration, tours\n    })\n  }\n};\n\nasync function fixTripBudgets() {\n  console.log('üí∞ Iniciando corre√ß√£o de or√ßamentos de viagens para valores realistas...');\n  \n  try {\n    // Get all trips from database\n    const allTrips = await db.select().from(trips);\n    console.log(`üìä Encontradas ${allTrips.length} viagens para atualizar`);\n    \n    let updatedCount = 0;\n    \n    for (const trip of allTrips) {\n      const budgetData = realisticBudgets[trip.destination as keyof typeof realisticBudgets];\n      \n      if (budgetData) {\n        try {\n          await db\n            .update(trips)\n            .set({\n              budget: budgetData.budget,\n              budgetBreakdown: budgetData.budgetBreakdown\n            })\n            .where(eq(trips.id, trip.id));\n          \n          console.log(`‚úÖ Or√ßamento atualizado para \"${trip.title}\" (${trip.destination}): R$ ${budgetData.budget.toFixed(2)}`);\n          updatedCount++;\n        } catch (error: any) {\n          console.error(`‚ùå Erro ao atualizar viagem ${trip.id}:`, error.message);\n        }\n      } else {\n        // Set default budget for destinations not in our list\n        const defaultBudget = 3000.00;\n        const defaultBreakdown = JSON.stringify({\n          accommodation: 1200.00,\n          transport: 800.00,\n          food: 600.00,\n          activities: 400.00\n        });\n        \n        try {\n          await db\n            .update(trips)\n            .set({\n              budget: defaultBudget,\n              budgetBreakdown: defaultBreakdown\n            })\n            .where(eq(trips.id, trip.id));\n          \n          console.log(`‚úÖ Or√ßamento padr√£o aplicado para \"${trip.title}\" (${trip.destination}): R$ ${defaultBudget.toFixed(2)}`);\n          updatedCount++;\n        } catch (error: any) {\n          console.error(`‚ùå Erro ao aplicar or√ßamento padr√£o para viagem ${trip.id}:`, error.message);\n        }\n      }\n    }\n    \n    console.log(`\\nüéâ Corre√ß√£o conclu√≠da!`);\n    console.log(`üìà ${updatedCount} viagens tiveram seus or√ßamentos atualizados`);\n    console.log(`üí° Or√ßamentos agora refletem valores realistas baseados em:`)\n    console.log(`   ‚Ä¢ Destino e custo de vida local`);\n    console.log(`   ‚Ä¢ Dura√ß√£o t√≠pica da viagem`);\n    console.log(`   ‚Ä¢ Qualidade de acomoda√ß√£o e atividades`);\n    console.log(`   ‚Ä¢ Custos de transporte atual`);\n    console.log(`\\nüí∞ Categorias de or√ßamento incluem:`);\n    console.log(`   ‚Ä¢ Acomoda√ß√£o (hot√©is, pousadas, lodges)`);\n    console.log(`   ‚Ä¢ Transporte (voos, transfers, local)`);\n    console.log(`   ‚Ä¢ Alimenta√ß√£o (restaurantes, refei√ß√µes)`);\n    console.log(`   ‚Ä¢ Atividades (tours, ingressos, experi√™ncias)`);\n    \n  } catch (error) {\n    console.error('‚ùå Erro na corre√ß√£o geral de or√ßamentos:', error);\n  }\n}\n\n// Execute the budget fix\nfixTripBudgets();","size_bytes":9510},"server/fix-trips-destinations.ts":{"content":"import { db } from './db.js';\nimport { activities, trips } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\n\n// Defini√ß√µes de destinos baseados nos t√≠tulos das viagens\nconst TRIP_DESTINATIONS = {\n  'Rio de Janeiro Completo': 'Rio de Janeiro, RJ',\n  'S√£o Paulo Gastron√¥mico': 'S√£o Paulo, SP',\n  'Aventura no Pantanal': 'Pantanal, MT',\n  'Carnaval em Salvador': 'Salvador, BA',\n  'Trilha na Serra da Mantiqueira': 'Serra da Mantiqueira, MG',\n  'Praias de Maragogi': 'Maragogi, AL',\n  'Cultura em Ouro Preto': 'Ouro Preto, MG',\n  'Amaz√¥nia - Manaus': 'Manaus, AM',\n  'Surf em Florian√≥polis': 'Florian√≥polis, SC',\n  'Vin√≠colas na Serra Ga√∫cha': 'Serra Ga√∫cha, RS',\n  'Len√ß√≥is Maranhenses': 'Len√ß√≥is Maranhenses, MA',\n  'Festa Junina em Caruaru': 'Caruaru, PE',\n  'R√©veillon em Copacabana': 'Rio de Janeiro, RJ',\n  'Patag√¥nia Argentina': 'El Calafate, Argentina',\n  'Machu Picchu': 'Cusco, Peru',\n  'Saf√°ri no Qu√™nia': 'Nairobi, Qu√™nia'\n};\n\nasync function fixTripsDestinations() {\n  try {\n    console.log('üîÑ CORRIGINDO DESTINOS DAS VIAGENS...\\n');\n    \n    // Buscar todas as viagens\n    const allTrips = await db.select().from(trips);\n    console.log(`üìä Total de viagens encontradas: ${allTrips.length}`);\n    \n    // Mostrar t√≠tulos atuais\n    console.log('\\nüìù T√çTULOS DAS VIAGENS:');\n    allTrips.forEach(trip => {\n      console.log(`  ID ${trip.id}: \"${trip.title}\" ‚Üí destination: \"${trip.destination}\"`);\n    });\n    \n    // Aplicar corre√ß√µes\n    console.log('\\nüîß APLICANDO CORRE√á√ïES DE DESTINOS...');\n    let updatedCount = 0;\n    \n    for (const trip of allTrips) {\n      // Buscar destino baseado no t√≠tulo\n      let newDestination = null;\n      \n      // Busca exata primeiro\n      if (TRIP_DESTINATIONS[trip.title]) {\n        newDestination = TRIP_DESTINATIONS[trip.title];\n      } else {\n        // Busca por palavras-chave no t√≠tulo\n        const title = trip.title.toLowerCase();\n        if (title.includes('rio de janeiro') || title.includes('copacabana')) {\n          newDestination = 'Rio de Janeiro, RJ';\n        } else if (title.includes('s√£o paulo')) {\n          newDestination = 'S√£o Paulo, SP';\n        } else if (title.includes('pantanal')) {\n          newDestination = 'Pantanal, MT';\n        } else if (title.includes('salvador')) {\n          newDestination = 'Salvador, BA';\n        } else if (title.includes('mantiqueira')) {\n          newDestination = 'Serra da Mantiqueira, MG';\n        } else if (title.includes('maragogi')) {\n          newDestination = 'Maragogi, AL';\n        } else if (title.includes('ouro preto')) {\n          newDestination = 'Ouro Preto, MG';\n        } else if (title.includes('manaus') || title.includes('amaz√¥nia')) {\n          newDestination = 'Manaus, AM';\n        } else if (title.includes('florian√≥polis')) {\n          newDestination = 'Florian√≥polis, SC';\n        } else if (title.includes('serra ga√∫cha') || title.includes('gramado')) {\n          newDestination = 'Serra Ga√∫cha, RS';\n        } else if (title.includes('len√ß√≥is maranhenses')) {\n          newDestination = 'Len√ß√≥is Maranhenses, MA';\n        } else if (title.includes('caruaru')) {\n          newDestination = 'Caruaru, PE';\n        } else if (title.includes('patag√¥nia')) {\n          newDestination = 'El Calafate, Argentina';\n        } else if (title.includes('machu picchu')) {\n          newDestination = 'Cusco, Peru';\n        } else if (title.includes('qu√™nia') || title.includes('saf√°ri')) {\n          newDestination = 'Nairobi, Qu√™nia';\n        } else if (title.includes('bonito')) {\n          newDestination = 'Bonito, MS';\n        } else if (title.includes('paris')) {\n          newDestination = 'Paris, Fran√ßa';\n        } else if (title.includes('nova york')) {\n          newDestination = 'Nova York, EUA';\n        } else if (title.includes('londres')) {\n          newDestination = 'Londres, Reino Unido';\n        } else if (title.includes('roma')) {\n          newDestination = 'Roma, It√°lia';\n        } else if (title.includes('buenos aires')) {\n          newDestination = 'Buenos Aires, Argentina';\n        } else {\n          // Fallback baseado em padr√µes comuns\n          newDestination = 'Rio de Janeiro, RJ'; // padr√£o\n        }\n      }\n      \n      if (newDestination && (trip.destination === undefined || trip.destination === null || trip.destination === 'undefined' || trip.destination !== newDestination)) {\n        console.log(`  Atualizando viagem \"${trip.title}\" ‚Üí \"${newDestination}\"`);\n        try {\n          await db.update(trips)\n            .set({ destination: newDestination })\n            .where(eq(trips.id, trip.id));\n          updatedCount++;\n        } catch (updateError) {\n          console.error(`    Erro ao atualizar viagem ${trip.id}:`, updateError);\n        }\n      }\n    }\n    \n    console.log(`\\n‚úÖ Corre√ß√£o conclu√≠da! ${updatedCount} viagens atualizadas.`);\n    \n    // Verificar resultado\n    console.log('\\nüîç VERIFICANDO RESULTADO...');\n    const updatedTrips = await db.select().from(trips);\n    const allActivities = await db.select().from(activities);\n    \n    const tripDestinations = [...new Set(updatedTrips.map(t => t.destination))].filter(Boolean);\n    const activityLocations = [...new Set(allActivities.map(a => a.location))].filter(Boolean);\n    \n    console.log('\\nüìç DESTINOS DAS VIAGENS (ap√≥s corre√ß√£o):');\n    tripDestinations.forEach(dest => {\n      const count = updatedTrips.filter(t => t.destination === dest).length;\n      console.log(`  - \"${dest}\" (${count} viagens)`);\n    });\n    \n    console.log('\\nüèõÔ∏è LOCALIZA√á√ïES DAS ATIVIDADES:');\n    activityLocations.forEach(loc => {\n      const count = allActivities.filter(a => a.location === loc).length;\n      console.log(`  - \"${loc}\" (${count} atividades)`);\n    });\n    \n    const matched = activityLocations.filter(loc => tripDestinations.includes(loc));\n    const unmatched = activityLocations.filter(loc => !tripDestinations.includes(loc));\n    \n    console.log(`\\n‚úÖ Localiza√ß√µes correspondentes: ${matched.length}`);\n    matched.forEach(loc => console.log(`  ‚úì \"${loc}\"`));\n    \n    console.log(`\\n‚ùå Localiza√ß√µes sem correspond√™ncia: ${unmatched.length}`);\n    unmatched.forEach(loc => console.log(`  ‚úó \"${loc}\"`));\n    \n    // Destinos sem atividades\n    const destinationsWithoutActivities = tripDestinations.filter(dest => !activityLocations.includes(dest));\n    console.log(`\\nüö® DESTINOS SEM ATIVIDADES (${destinationsWithoutActivities.length}):`);\n    destinationsWithoutActivities.forEach(dest => {\n      const tripCount = updatedTrips.filter(t => t.destination === dest).length;\n      console.log(`  - \"${dest}\" (${tripCount} viagens)`);\n    });\n    \n  } catch (error) {\n    console.error('‚ùå Erro durante corre√ß√£o:', error);\n  }\n  \n  process.exit(0);\n}\n\nfixTripsDestinations();","size_bytes":6839},"server/fix-user-verification.ts":{"content":"import { db } from \"./db\";\nimport { users } from \"@shared/schema\";\nimport { eq } from \"drizzle-orm\";\n\nexport async function fixUserVerificationStatus() {\n  try {\n    // Update verification status for test users\n    const testUsers = ['tom', 'maria', 'carlos'];\n    \n    for (const username of testUsers) {\n      await db.update(users)\n        .set({ isVerified: true, averageRating: 5 })\n        .where(eq(users.username, username));\n      \n      console.log(`‚úÖ Status de verifica√ß√£o corrigido para ${username}`);\n    }\n  } catch (error) {\n    console.log(\"‚ö†Ô∏è Erro ao corrigir status de verifica√ß√£o:\", error);\n  }\n}","size_bytes":625},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport cookieParser from \"cookie-parser\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\nimport { testConnection, initializeTables, db } from \"./db\";\nimport { users } from \"../shared/schema\";\nimport { eq } from \"drizzle-orm\";\nimport { syncParticipantsCount } from \"./sync-participants.ts\";\n// Importar prote√ß√µes de seguran√ßa do banco\nimport \"./db-security\";\n// import { setupReferralSystem } from \"./setup-referral-system\"; // Removed for PostgreSQL migration\n\nconst app = express();\n\n// Trust proxy for Replit environment\napp.set(\"trust proxy\", 1);\n\n// Cookie parser before any other middleware that needs it\napp.use(cookieParser());\n\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\n// Adicionar middlewares de seguran√ßa\nimport { \n  securityMonitorMiddleware, \n  environmentProtectionMiddleware, \n  auditLogMiddleware \n} from \"./middleware/security\";\n\napp.use(auditLogMiddleware);\napp.use(securityMonitorMiddleware);\napp.use(environmentProtectionMiddleware);\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"‚Ä¶\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n// Function to fix user verification status  \nasync function fixUserVerificationStatusLocal() {\n  try {\n    const verifiedUsers = ['tom', 'maria', 'carlos'];\n    \n    for (const username of verifiedUsers) {\n      const result = await db.update(users)\n        .set({ \n          is_verified: true, \n          verification_method: 'referral' \n        })\n        .where(eq(users.username, username));\n        \n      console.log(`‚úÖ Status de verifica√ß√£o corrigido para ${username}`);\n    }\n  } catch (error) {\n    console.error('‚ùå Erro ao corrigir status de verifica√ß√£o:', error);\n  }\n}\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on port 5000\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = 5000;\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n\n  // Initialize database in background after server starts\n  (async () => {\n    console.log(\"üîó Testando conex√£o PostgreSQL...\");\n    await testConnection();\n    console.log(\"üèóÔ∏è Inicializando tabelas PostgreSQL...\");\n    await initializeTables();\n    \n    // Fix user verification status\n    console.log(\"üîß Corrigindo status de verifica√ß√£o dos usu√°rios...\");\n    await fixUserVerificationStatusLocal();\n    \n    // Sync participants count\n    console.log(\"üîÑ Sincronizando contagem de participantes...\");\n    await syncParticipantsCount();\n    \n    // Setup referral system\n    console.log(\"üé´ Configurando sistema de c√≥digos de indica√ß√£o...\");\n    // System will be setup later\n  })().catch(console.error);\n})();\n","size_bytes":4088},"server/migrate-cities-to-destinations.ts":{"content":"#!/usr/bin/env tsx\n\nimport { db } from \"./db\";\nimport { sql } from \"drizzle-orm\";\n\nasync function migrateCitiesToDestinations() {\n  console.log(\"üöÄ Iniciando migra√ß√£o de cities para destinations...\");\n  \n  try {\n    // 1. Renomear tabela cities para destinations\n    console.log(\"üìã Renomeando tabela cities para destinations...\");\n    await db.execute(sql`RENAME TABLE cities TO destinations`);\n    console.log(\"‚úÖ Tabela renomeada com sucesso\");\n    \n    // 2. Atualizar foreign keys na tabela trips\n    console.log(\"üîó Atualizando foreign keys na tabela trips...\");\n    \n    // Primeiro remover a constraint existente\n    try {\n      await db.execute(sql`ALTER TABLE trips DROP FOREIGN KEY trips_ibfk_2`);\n      console.log(\"‚úÖ Foreign key antiga removida\");\n    } catch (error: any) {\n      console.log(\"‚ÑπÔ∏è Foreign key trips_ibfk_2 n√£o encontrada, continuando...\");\n    }\n    \n    // Renomear coluna city_id para destination_id\n    await db.execute(sql`ALTER TABLE trips CHANGE COLUMN city_id destination_id INT NOT NULL`);\n    console.log(\"‚úÖ Coluna city_id renomeada para destination_id\");\n    \n    // Adicionar nova foreign key\n    await db.execute(sql`ALTER TABLE trips ADD CONSTRAINT trips_destinations_fk FOREIGN KEY (destination_id) REFERENCES destinations(id)`);\n    console.log(\"‚úÖ Nova foreign key adicionada\");\n    \n    // 3. Atualizar foreign keys na tabela activities\n    console.log(\"üéØ Atualizando foreign keys na tabela activities...\");\n    \n    // Verificar se a coluna city_id existe\n    try {\n      await db.execute(sql`ALTER TABLE activities CHANGE COLUMN city_id destination_id INT NOT NULL`);\n      console.log(\"‚úÖ Coluna city_id em activities renomeada para destination_id\");\n      \n      // Adicionar foreign key se n√£o existir\n      await db.execute(sql`ALTER TABLE activities ADD CONSTRAINT activities_destinations_fk FOREIGN KEY (destination_id) REFERENCES destinations(id)`);\n      console.log(\"‚úÖ Foreign key adicionada em activities\");\n    } catch (error: any) {\n      console.log(\"‚ÑπÔ∏è Coluna city_id em activities n√£o encontrada ou j√° migrada:\", error.message);\n    }\n    \n    // 4. Atualizar tabela destination_ratings se existir\n    console.log(\"‚≠ê Atualizando tabela de ratings...\");\n    try {\n      await db.execute(sql`RENAME TABLE city_ratings TO destination_ratings`);\n      console.log(\"‚úÖ Tabela city_ratings renomeada para destination_ratings\");\n      \n      await db.execute(sql`ALTER TABLE destination_ratings CHANGE COLUMN city_id destination_id INT NOT NULL`);\n      console.log(\"‚úÖ Coluna em destination_ratings atualizada\");\n    } catch (error) {\n      console.log(\"‚ÑπÔ∏è Tabela city_ratings n√£o encontrada:\", error.message);\n    }\n    \n    console.log(\"üéâ Migra√ß√£o conclu√≠da com sucesso!\");\n    console.log(\"üìù Resumo das mudan√ßas:\");\n    console.log(\"   - cities ‚Üí destinations\");\n    console.log(\"   - city_id ‚Üí destination_id em todas as tabelas\");\n    console.log(\"   - Foreign keys atualizadas\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro durante a migra√ß√£o:\", error);\n    throw error;\n  }\n}\n\n// Executar se chamado diretamente\nmigrateCitiesToDestinations()\n  .then(() => {\n    console.log(\"‚úÖ Migra√ß√£o executada com sucesso!\");\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error(\"‚ùå Falha na migra√ß√£o:\", error);\n    process.exit(1);\n  });\n\nexport { migrateCitiesToDestinations };","size_bytes":3415},"server/migrate-to-cities-table.ts":{"content":"import { db } from \"./db\";\nimport { destinations, trips, activities } from \"@shared/schema\";\nimport { sql, eq } from \"drizzle-orm\";\n\ninterface LocationData {\n  name: string;\n  state?: string;\n  country: string;\n  countryType: 'nacional' | 'internacional';\n  region?: string;\n  latitude?: number;\n  longitude?: number;\n  timezone?: string;\n}\n\n// Mapping of existing locations to structured city data\nconst cityMappings: Record<string, LocationData> = {\n  // National destinations\n  \"Rio de Janeiro, RJ\": {\n    name: \"Rio de Janeiro\",\n    state: \"RJ\",\n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Sudeste\",\n    latitude: -22.9068,\n    longitude: -43.1729,\n    timezone: \"America/Sao_Paulo\"\n  },\n  \"S√£o Paulo, SP\": {\n    name: \"S√£o Paulo\", \n    state: \"SP\",\n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Sudeste\",\n    latitude: -23.5505,\n    longitude: -46.6333,\n    timezone: \"America/Sao_Paulo\"\n  },\n  \"Salvador, BA\": {\n    name: \"Salvador\",\n    state: \"BA\", \n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Nordeste\",\n    latitude: -12.9714,\n    longitude: -38.5124,\n    timezone: \"America/Bahia\"\n  },\n  \"Mantiqueira, MG\": {\n    name: \"Serra da Mantiqueira\",\n    state: \"MG\",\n    country: \"Brasil\", \n    countryType: \"nacional\",\n    region: \"Sudeste\",\n    latitude: -22.4667,\n    longitude: -44.6167,\n    timezone: \"America/Sao_Paulo\"\n  },\n  \"Maragogi, AL\": {\n    name: \"Maragogi\",\n    state: \"AL\",\n    country: \"Brasil\",\n    countryType: \"nacional\", \n    region: \"Nordeste\",\n    latitude: -9.0122,\n    longitude: -35.2225,\n    timezone: \"America/Maceio\"\n  },\n  \"Ouro Preto, MG\": {\n    name: \"Ouro Preto\",\n    state: \"MG\",\n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Sudeste\", \n    latitude: -20.3856,\n    longitude: -43.5035,\n    timezone: \"America/Sao_Paulo\"\n  },\n  \"Manaus, AM\": {\n    name: \"Manaus\",\n    state: \"AM\",\n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Norte\",\n    latitude: -3.1190,\n    longitude: -60.0217,\n    timezone: \"America/Manaus\"\n  },\n  \"Florian√≥polis, SC\": {\n    name: \"Florian√≥polis\",\n    state: \"SC\", \n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Sul\",\n    latitude: -27.5954,\n    longitude: -48.5480,\n    timezone: \"America/Sao_Paulo\"\n  },\n  \"Gramado, RS\": {\n    name: \"Gramado\",\n    state: \"RS\",\n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Sul\",\n    latitude: -29.3788,\n    longitude: -50.8740,\n    timezone: \"America/Sao_Paulo\"\n  },\n  \"Len√ß√≥is Maranhenses, MA\": {\n    name: \"Len√ß√≥is Maranhenses\",\n    state: \"MA\",\n    country: \"Brasil\", \n    countryType: \"nacional\",\n    region: \"Nordeste\",\n    latitude: -2.4856,\n    longitude: -43.1283,\n    timezone: \"America/Fortaleza\"\n  },\n  \"Caruaru, PE\": {\n    name: \"Caruaru\",\n    state: \"PE\",\n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Nordeste\",\n    latitude: -8.2837,\n    longitude: -35.9708,\n    timezone: \"America/Recife\"\n  },\n  \"Bonito, MS\": {\n    name: \"Bonito\",\n    state: \"MS\",\n    country: \"Brasil\",\n    countryType: \"nacional\", \n    region: \"Centro-Oeste\",\n    latitude: -21.1295,\n    longitude: -56.4890,\n    timezone: \"America/Campo_Grande\"\n  },\n  \"Pantanal, MT\": {\n    name: \"Pantanal\",\n    state: \"MT\",\n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Centro-Oeste\",\n    latitude: -16.4896,\n    longitude: -56.4896,\n    timezone: \"America/Cuiaba\"\n  },\n\n  // International destinations\n  \"Paris, Fran√ßa\": {\n    name: \"Paris\",\n    country: \"Fran√ßa\",\n    countryType: \"internacional\",\n    region: \"Europa\",\n    latitude: 48.8566,\n    longitude: 2.3522,\n    timezone: \"Europe/Paris\"\n  },\n  \"Nova York, EUA\": {\n    name: \"Nova York\", \n    country: \"Estados Unidos\",\n    countryType: \"internacional\",\n    region: \"Am√©rica do Norte\",\n    latitude: 40.7128,\n    longitude: -74.0060,\n    timezone: \"America/New_York\"\n  },\n  \"Londres, Reino Unido\": {\n    name: \"Londres\",\n    country: \"Reino Unido\",\n    countryType: \"internacional\",\n    region: \"Europa\",\n    latitude: 51.5074,\n    longitude: -0.1278,\n    timezone: \"Europe/London\"\n  },\n  \"Roma, It√°lia\": {\n    name: \"Roma\",\n    country: \"It√°lia\", \n    countryType: \"internacional\",\n    region: \"Europa\",\n    latitude: 41.9028,\n    longitude: 12.4964,\n    timezone: \"Europe/Rome\"\n  },\n  \"Buenos Aires, Argentina\": {\n    name: \"Buenos Aires\",\n    country: \"Argentina\",\n    countryType: \"internacional\",\n    region: \"Am√©rica do Sul\",\n    latitude: -34.6118,\n    longitude: -58.3960,\n    timezone: \"America/Argentina/Buenos_Aires\"\n  },\n  \"Patag√¥nia, Argentina\": {\n    name: \"Patag√¥nia\",\n    country: \"Argentina\",\n    countryType: \"internacional\", \n    region: \"Am√©rica do Sul\",\n    latitude: -49.3273,\n    longitude: -67.7027,\n    timezone: \"America/Argentina/Rio_Gallegos\"\n  },\n  \"Machu Picchu, Peru\": {\n    name: \"Machu Picchu\",\n    country: \"Peru\",\n    countryType: \"internacional\",\n    region: \"Am√©rica do Sul\",\n    latitude: -13.1631,\n    longitude: -72.5450,\n    timezone: \"America/Lima\"\n  },\n  \"Qu√™nia\": {\n    name: \"Nairobi\",\n    country: \"Qu√™nia\", \n    countryType: \"internacional\",\n    region: \"√Åfrica\",\n    latitude: -1.2921,\n    longitude: 36.8219,\n    timezone: \"Africa/Nairobi\"\n  },\n  \"Copacabana, RJ\": {\n    name: \"Rio de Janeiro\",\n    state: \"RJ\",\n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Sudeste\", \n    latitude: -22.9068,\n    longitude: -43.1729,\n    timezone: \"America/Sao_Paulo\"\n  }\n};\n\nexport async function migrateToCitiesTable() {\n  try {\n    console.log(\"üèóÔ∏è Criando tabela destinations...\");\n    \n    // Create destinations table\n    await db.execute(sql`\n      CREATE TABLE IF NOT EXISTS destinations (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        name VARCHAR(255) NOT NULL,\n        state VARCHAR(255),\n        country VARCHAR(255) NOT NULL,\n        country_type VARCHAR(50) NOT NULL,\n        region VARCHAR(255),\n        latitude DECIMAL(10,8),\n        longitude DECIMAL(11,8), \n        timezone VARCHAR(50),\n        is_active BOOLEAN DEFAULT TRUE NOT NULL,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        UNIQUE KEY unique_city (name, state, country)\n      )\n    `);\n\n    console.log(\"‚úÖ Tabela destinations criada!\");\n\n    // Insert all unique destinations\n    console.log(\"üìç Inserindo cidades...\");\n    \n    const cityInserts = Object.values(cityMappings).reduce((acc: LocationData[], city) => {\n      const existing = acc.find(c => c.name === city.name && c.country === city.country);\n      if (!existing) {\n        acc.push(city);\n      }\n      return acc;\n    }, []);\n\n    for (const cityData of cityInserts) {\n      try {\n        await db.insert(destinations).values(cityData).ignore();\n        console.log(`   ‚úÖ Cidade inserida: ${cityData.name}, ${cityData.country}`);\n      } catch (error) {\n        console.log(`   ‚ö†Ô∏è Cidade j√° existe: ${cityData.name}, ${cityData.country}`);\n      }\n    }\n\n    console.log(\"üîÑ Migrando dados das viagens...\");\n\n    // Add cityId column to trips table if not exists\n    try {\n      await db.execute(sql`\n        ALTER TABLE trips \n        ADD COLUMN destination_id INT,\n        ADD FOREIGN KEY (destination_id) REFERENCES destinations(id)\n      `);\n      console.log(\"   ‚úÖ Coluna destination_id adicionada √† tabela trips\");\n    } catch (error) {\n      console.log(\"   ‚ö†Ô∏è Coluna destination_id j√° existe em trips\");\n    }\n\n    // Get all trips with their current localidade (use raw SQL to avoid schema conflicts)\n    const allTripsResult = await db.execute(sql`\n      SELECT id, title, localidade FROM trips\n    `);\n    const allTrips = allTripsResult as Array<{id: number, title: string, localidade: string}>;\n\n    // Update trips with cityId\n    for (const trip of allTrips) {\n      const cityMapping = cityMappings[trip.localidade as string];\n      if (cityMapping) {\n        // Find the city ID\n        const [city] = await db.select().from(destinations).where(\n          sql`name = ${cityMapping.name} AND country = ${cityMapping.country}`\n        );\n        \n        if (city) {\n          await db.execute(sql`\n            UPDATE trips SET destination_id = ${city.id} WHERE id = ${trip.id}\n          `);\n          console.log(`   ‚úÖ Viagem \"${trip.title}\" vinculada √† cidade ${cityMapping.name}`);\n        }\n      } else {\n        console.log(`   ‚ö†Ô∏è Mapeamento n√£o encontrado para: ${trip.localidade}`);\n      }\n    }\n\n    console.log(\"üéØ Migrando dados das atividades...\");\n    \n    // Add cityId column to activities table if not exists\n    try {\n      await db.execute(sql`\n        ALTER TABLE activities \n        ADD COLUMN destination_id INT,\n        ADD FOREIGN KEY (destination_id) REFERENCES destinations(id)\n      `);\n      console.log(\"   ‚úÖ Coluna destination_id adicionada √† tabela activities\");\n    } catch (error) {\n      console.log(\"   ‚ö†Ô∏è Coluna destination_id j√° existe em activities\");\n    }\n    \n    // Get all activities using raw SQL to avoid schema conflicts\n    const allActivitiesResult = await db.execute(sql`\n      SELECT id, title, location, city FROM activities\n    `);\n    const allActivities = allActivitiesResult as Array<{id: number, title: string, location?: string, city?: string}>;\n\n    // Update activities with cityId based on location field\n    for (const activity of allActivities) {\n      const activityLocation = activity.location || activity.city;\n      \n      // Skip if no location data\n      if (!activityLocation) {\n        console.log(`   ‚ö†Ô∏è Atividade sem localiza√ß√£o: ${activity.title}`);\n        continue;\n      }\n      \n      // Try to find matching city mapping\n      let cityMapping: LocationData | undefined;\n      \n      // Direct mapping lookup\n      cityMapping = cityMappings[activityLocation];\n      \n      // If not found, try partial matching\n      if (!cityMapping) {\n        const mappingKey = Object.keys(cityMappings).find(key => \n          key.includes(activityLocation) || activityLocation.includes(key.split(',')[0])\n        );\n        if (mappingKey) {\n          cityMapping = cityMappings[mappingKey];\n        }\n      }\n\n      if (cityMapping) {\n        // Find the city ID\n        const [city] = await db.select().from(destinations).where(\n          sql`name = ${cityMapping.name} AND country = ${cityMapping.country}`\n        );\n        \n        if (city) {\n          await db.execute(sql`\n            UPDATE activities SET destination_id = ${city.id} WHERE id = ${activity.id}\n          `);\n          console.log(`   ‚úÖ Atividade \"${activity.title}\" vinculada √† cidade ${cityMapping.name}`);\n        }\n      } else {\n        console.log(`   ‚ö†Ô∏è Mapeamento n√£o encontrado para atividade: ${activityLocation}`);\n      }\n    }\n\n    console.log(\"‚úÖ Migra√ß√£o para tabela destinations conclu√≠da com sucesso!\");\n    \n    // Show summary\n    const cityCount = await db.select({ count: sql`count(*)` }).from(destinations);\n    console.log(`üìä Total de cidades cadastradas: ${cityCount[0].count}`);\n\n  } catch (error) {\n    console.error(\"‚ùå Erro na migra√ß√£o:\", error);\n    throw error;\n  }\n}\n\n// Execute migration if run directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  migrateToCitiesTable()\n    .then(() => {\n      console.log(\"üéâ Migra√ß√£o conclu√≠da!\");\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error(\"üí• Erro na migra√ß√£o:\", error);\n      process.exit(1);\n    });\n}","size_bytes":11399},"server/migrate-travel-styles.ts":{"content":"import { db } from './db';\nimport { users } from '../shared/schema';\nimport { sql } from 'drizzle-orm';\n\nasync function migrateTravelStyles() {\n  console.log('üîÑ Iniciando migra√ß√£o de travel_style para travel_styles...');\n  \n  try {\n    // Migrar dados existentes do travel_style para travel_styles\n    const allUsers = await db.execute(sql`SELECT id, travel_style FROM users WHERE travel_style IS NOT NULL AND travel_styles IS NULL`);\n    \n    for (const user of allUsers) {\n      const travelStyle = user.travel_style;\n      if (travelStyle) {\n        await db.execute(sql`UPDATE users SET travel_styles = JSON_ARRAY(${travelStyle}) WHERE id = ${user.id}`);\n        console.log(`‚úÖ Usu√°rio ${user.id} migrado: ${travelStyle} -> [${travelStyle}]`);\n      }\n    }\n    \n    // Remover coluna antiga\n    await db.execute(sql`ALTER TABLE users DROP COLUMN travel_style`);\n    console.log('‚úÖ Coluna travel_style removida com sucesso');\n    \n    console.log('üéâ Migra√ß√£o conclu√≠da com sucesso!');\n  } catch (error) {\n    console.error('‚ùå Erro durante a migra√ß√£o:', error);\n    \n    // Se a coluna n√£o existe, apenas continue\n    if (error.code === 'ER_CANT_DROP_FIELD_OR_KEY') {\n      console.log('‚ÑπÔ∏è Coluna travel_style j√° foi removida, continuando...');\n    } else {\n      throw error;\n    }\n  }\n}\n\n// Executar migra√ß√£o se chamado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  migrateTravelStyles().catch(console.error);\n}\n\nexport { migrateTravelStyles };","size_bytes":1500},"server/mysql-complete-verification.ts":{"content":"import { db } from \"./db\";\nimport { users, trips, tripParticipants, messages, activities } from \"../shared/schema\";\nimport { sql } from \"drizzle-orm\";\n\nasync function completeVerification() {\n  console.log(\"üîç VERIFICA√á√ÉO COMPLETA: Todas as fun√ß√µes usando exclusivamente MySQL\");\n  console.log(\"=\" + \"=\".repeat(70));\n  \n  try {\n    // 1. Test database connection\n    console.log(\"\\n1. üîó Testando conex√£o com MySQL...\");\n    await db.execute(sql`SELECT 1`);\n    console.log(\"   ‚úÖ Conex√£o MySQL estabelecida com sucesso\");\n\n    // 2. Verify users table and data\n    console.log(\"\\n2. üë• Verificando tabela de usu√°rios (MySQL)...\");\n    const usersList = await db.select().from(users);\n    console.log(`   ‚úÖ Total de usu√°rios: ${usersList.length}`);\n    usersList.forEach(user => {\n      console.log(`   - ${user.username} (${user.email}) - Verificado: ${user.isVerified}`);\n    });\n\n    // 3. Verify trips table and data\n    console.log(\"\\n3. üß≥ Verificando tabela de viagens (MySQL)...\");\n    const tripsList = await db.select().from(trips);\n    console.log(`   ‚úÖ Total de viagens: ${tripsList.length}`);\n    tripsList.slice(0, 5).forEach(trip => {\n      console.log(`   - ${trip.title} ‚Üí ${trip.destination} (R$ ${trip.budget})`);\n    });\n\n    // 4. Verify participants table\n    console.log(\"\\n4. üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Verificando tabela de participantes (MySQL)...\");\n    const participantsList = await db.select().from(tripParticipants);\n    console.log(`   ‚úÖ Total de participa√ß√µes: ${participantsList.length}`);\n\n    // 5. Verify messages table\n    console.log(\"\\n5. üí¨ Verificando tabela de mensagens (MySQL)...\");\n    const messagesList = await db.select().from(messages);\n    console.log(`   ‚úÖ Total de mensagens: ${messagesList.length}`);\n\n    // 6. Verify activities table\n    console.log(\"\\n6. üéØ Verificando tabela de atividades (MySQL)...\");\n    const activitiesList = await db.select().from(activities);\n    console.log(`   ‚úÖ Total de atividades: ${activitiesList.length}`);\n\n    // 7. Test complex queries to ensure MySQL is working\n    console.log(\"\\n7. üîç Testando consultas complexas (MySQL)...\");\n    const tripsWithCreators = await db.execute(sql`\n      SELECT t.title, u.username as creator \n      FROM trips t \n      JOIN users u ON t.creator_id = u.id \n      LIMIT 3\n    `);\n    console.log(\"   ‚úÖ Consulta JOIN trips+users funcionando:\");\n    tripsWithCreators.forEach((trip: any) => {\n      console.log(`   - \"${trip.title}\" criada por ${trip.creator}`);\n    });\n\n    // 8. Geographic diversity verification\n    console.log(\"\\n8. üåç Verificando diversidade geogr√°fica dos usu√°rios...\");\n    const usersByLocation = await db.execute(sql`\n      SELECT location, COUNT(*) as count \n      FROM users \n      GROUP BY location\n    `);\n    console.log(\"   ‚úÖ Distribui√ß√£o geogr√°fica dos usu√°rios:\");\n    usersByLocation.forEach((loc: any) => {\n      console.log(`   - ${loc.location}: ${loc.count} usu√°rios`);\n    });\n\n    // 9. Trip destination diversity\n    console.log(\"\\n9. üó∫Ô∏è Verificando diversidade de destinos das viagens...\");\n    const tripsByDestination = await db.execute(sql`\n      SELECT destination, COUNT(*) as count \n      FROM trips \n      GROUP BY destination\n    `);\n    console.log(\"   ‚úÖ Distribui√ß√£o de destinos das viagens:\");\n    tripsByDestination.forEach((dest: any) => {\n      console.log(`   - ${dest.destination}: ${dest.count} viagens`);\n    });\n\n    console.log(\"\\n\" + \"=\".repeat(70));\n    console.log(\"‚úÖ VERIFICA√á√ÉO COMPLETA CONCLU√çDA COM SUCESSO!\");\n    console.log(\"üéâ Todas as fun√ß√µes est√£o usando exclusivamente MySQL!\");\n    console.log(\"üöÄ Sistema totalmente migrado e operacional!\");\n    console.log(\"üìä Dados de teste com diversidade geogr√°fica implementados!\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro na verifica√ß√£o:\", error);\n    process.exit(1);\n  }\n}\n\n// Execute verification\ncompleteVerification().then(() => {\n  process.exit(0);\n}).catch(console.error);","size_bytes":4010},"server/populate-all-activities-comprehensive.ts":{"content":"import { db } from \"./db\";\nimport { activities, activityBudgetProposals } from \"@shared/schema\";\n\nconst comprehensiveActivities = [\n  // === BRASIL - REGI√ÉO SUDESTE ===\n  {\n    title: \"Cristo Redentor e P√£o de A√ß√∫car\",\n    description: \"Visite os dois cart√µes postais mais famosos do Rio de Janeiro em um √∫nico tour. Inclui transporte pelo bondinho do P√£o de A√ß√∫car e trem do Corcovado.\",\n    location: \"Rio de Janeiro, RJ\",\n    city: \"Rio de Janeiro\",\n    region: \"Sudeste\",\n    countryType: \"nacional\",\n    category: \"pontos_turisticos\",\n    duration: \"8 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 1,\n    maxParticipants: 15,\n    coverImage: \"https://images.unsplash.com/photo-1518905208889-90a2ba3d1f93?w=1200&h=800&fit=crop&q=85\",\n    languages: [\"Portugu√™s\", \"Ingl√™s\", \"Espanhol\"],\n    inclusions: [\"Transporte\", \"Ingressos\", \"Guia bil√≠ngue\"],\n    exclusions: [\"Refei√ß√µes\", \"Bebidas\", \"Gorjetas\"],\n    requirements: [\"Idade m√≠nima: 3 anos\"],\n    contactInfo: {\n      phone: \"+55 21 2558-1329\",\n      email: \"tours@riodejaneiro.com\",\n      website: \"www.christtours.com.br\"\n    },\n    budgetProposals: [\n      {\n        title: \"Econ√¥mico\",\n        description: \"Tour b√°sico com transporte compartilhado\",\n        amount: 85.00,\n        inclusions: [\"Transporte compartilhado\", \"Ingressos b√°sicos\"],\n        exclusions: [\"Guia\", \"Lanche\", \"Fotos profissionais\"]\n      },\n      {\n        title: \"Completo\",\n        description: \"Tour completo com guia e lanche\",\n        amount: 160.00,\n        inclusions: [\"Van com ar condicionado\", \"Guia credenciado\", \"Lanche\", \"Seguro\"],\n        exclusions: [\"Almo√ßo\", \"Bebidas alco√≥licas\"]\n      },\n      {\n        title: \"Premium\",\n        description: \"Tour privado com fot√≥grafo\",\n        amount: 350.00,\n        inclusions: [\"Carro privado\", \"Guia especializado\", \"Fot√≥grafo\", \"Almo√ßo em restaurante\", \"Certificado\"],\n        exclusions: [\"Bebidas extras\", \"Compras pessoais\"]\n      }\n    ]\n  },\n  {\n    title: \"Trilha na Floresta da Tijuca\",\n    description: \"Aventura pela maior floresta urbana do mundo com cachoeiras, vistas panor√¢micas e rica biodiversidade da Mata Atl√¢ntica.\",\n    location: \"Rio de Janeiro, RJ\", \n    city: \"Rio de Janeiro\",\n    region: \"Sudeste\",\n    countryType: \"nacional\",\n    category: \"adventure\",\n    duration: \"6 horas\",\n    difficultyLevel: \"moderate\",\n    minParticipants: 2,\n    maxParticipants: 12,\n    coverImage: \"https://images.unsplash.com/photo-1605540436563-5bca919ae766?w=1200&h=800&fit=crop&q=85\",\n    languages: [\"Portugu√™s\", \"Ingl√™s\"],\n    inclusions: [\"Guia especializado\", \"Equipamentos de seguran√ßa\", \"Lanche\"],\n    exclusions: [\"Transporte ao ponto de encontro\", \"Almo√ßo\", \"Roupas adequadas\"],\n    requirements: [\"Idade m√≠nima: 12 anos\", \"Condicionamento f√≠sico b√°sico\", \"Cal√ßado de trilha\"],\n    budgetProposals: [\n      {\n        title: \"B√°sico\",\n        description: \"Trilha simples com guia local\",\n        amount: 45.00,\n        inclusions: [\"Guia local\", \"Lanche b√°sico\"],\n        exclusions: [\"Equipamentos\", \"Transporte\", \"Seguro\"]\n      },\n      {\n        title: \"Aventura\",\n        description: \"Trilha completa com equipamentos\",\n        amount: 95.00,\n        inclusions: [\"Guia especializado\", \"Equipamentos completos\", \"Lanche energ√©tico\", \"Seguro\"],\n        exclusions: [\"Transporte\", \"Almo√ßo\", \"Roupas\"]\n      },\n      {\n        title: \"Expedi√ß√£o\",\n        description: \"Trilha t√©cnica com rapel e escalada\",\n        amount: 180.00,\n        inclusions: [\"Instrutor t√©cnico\", \"Equipamentos premium\", \"Almo√ßo na trilha\", \"Fotos\", \"Certificado\"],\n        exclusions: [\"Transporte privado\", \"Roupas t√©cnicas\"]\n      }\n    ]\n  },\n  {\n    title: \"Tour Gastron√¥mico Santa Teresa\",\n    description: \"Descubra os sabores √∫nicos do bairro bo√™mio Santa Teresa, visitando restaurantes tradicionais, bares hist√≥ricos e ateli√™s de artistas locais.\",\n    location: \"Rio de Janeiro, RJ\",\n    city: \"Rio de Janeiro\", \n    region: \"Sudeste\",\n    countryType: \"nacional\",\n    category: \"food_tours\",\n    duration: \"4 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 3,\n    maxParticipants: 10,\n    coverImage: \"https://images.unsplash.com/photo-1414235077428-338989a2e8c0?w=1200&h=800&fit=crop&q=85\",\n    languages: [\"Portugu√™s\", \"Ingl√™s\", \"Franc√™s\"],\n    inclusions: [\"Guia gastron√¥mico\", \"Degusta√ß√µes\", \"Transporte local\"],\n    exclusions: [\"Bebidas alco√≥licas extras\", \"Compras pessoais\"],\n    requirements: [\"Sem restri√ß√µes diet√°rias severas\"],\n    budgetProposals: [\n      {\n        title: \"Degusta√ß√£o\",\n        description: \"Tour b√°sico com 4 paradas\",\n        amount: 75.00,\n        inclusions: [\"4 degusta√ß√µes\", \"Guia local\", \"√Ågua\"],\n        exclusions: [\"Bebidas\", \"Refei√ß√£o completa\", \"Transporte\"]\n      },\n      {\n        title: \"Gastron√¥mico\",\n        description: \"Tour completo com refei√ß√£o\",\n        amount: 140.00,\n        inclusions: [\"6 degusta√ß√µes\", \"Refei√ß√£o completa\", \"Bebida inclu√≠da\", \"Guia especializado\"],\n        exclusions: [\"Bebidas premium\", \"Sobremesas extras\"]\n      },\n      {\n        title: \"Gourmet\",\n        description: \"Experi√™ncia premium com chef\",\n        amount: 280.00,\n        inclusions: [\"Chef acompanhante\", \"Restaurantes selecionados\", \"Vinhos harmonizados\", \"Transporte privado\"],\n        exclusions: [\"Compras no mercado\", \"Lembran√ßas\"]\n      }\n    ]\n  },\n\n  // === BONITO, MS ===\n  {\n    title: \"Flutua√ß√£o no Rio da Prata\",\n    description: \"Uma das mais belas flutua√ß√µes do Brasil, com √°guas cristalinas e rica fauna aqu√°tica. Visibilidade de at√© 50 metros de profundidade.\",\n    location: \"Bonito, MS\",\n    city: \"Bonito\",\n    region: \"Centro-Oeste\", \n    countryType: \"nacional\",\n    category: \"water_sports\",\n    duration: \"5 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 2,\n    maxParticipants: 20,\n    coverImage: \"https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=1200&h=800&fit=crop&q=85\",\n    languages: [\"Portugu√™s\", \"Ingl√™s\", \"Espanhol\"],\n    inclusions: [\"Equipamentos de flutua√ß√£o\", \"Instru√ß√µes\", \"Lanche\"],\n    exclusions: [\"Transporte\", \"Almo√ßo\", \"Roupas de neoprene\"],\n    requirements: [\"Saber nadar\", \"Idade m√≠nima: 5 anos\"],\n    budgetProposals: [\n      {\n        title: \"Flutua√ß√£o Simples\",\n        description: \"Flutua√ß√£o b√°sica de 1.5km\",\n        amount: 90.00,\n        inclusions: [\"Equipamentos b√°sicos\", \"Instru√ß√µes\", \"Seguro\"],\n        exclusions: [\"Lanche\", \"Fotos\", \"Transporte\"]\n      },\n      {\n        title: \"Experi√™ncia Completa\", \n        description: \"Flutua√ß√£o completa com trilha\",\n        amount: 165.00,\n        inclusions: [\"Equipamentos completos\", \"Trilha interpretativa\", \"Lanche\", \"Guia especializado\"],\n        exclusions: [\"Transporte\", \"Almo√ßo\", \"Fotos subaqu√°ticas\"]\n      },\n      {\n        title: \"Premium Aqu√°tico\",\n        description: \"Experi√™ncia exclusiva com fotografia\",\n        amount: 295.00,\n        inclusions: [\"Equipamentos premium\", \"Fot√≥grafo subaqu√°tico\", \"Almo√ßo inclu√≠do\", \"Transporte\", \"V√≠deo\"],\n        exclusions: [\"Hospedagem\", \"Bebidas extras\"]\n      }\n    ]\n  },\n\n  // === GRAMADO, RS ===\n  {\n    title: \"Mini Mundo\",\n    description: \"Parque tem√°tico com miniaturas em escala real de constru√ß√µes famosas do mundo, jardins exuberantes e arquitetura europeia encantadora.\",\n    location: \"Gramado, RS\",\n    city: \"Gramado\",\n    region: \"Sul\",\n    countryType: \"nacional\", \n    category: \"cultural\",\n    duration: \"3 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 1,\n    maxParticipants: 50,\n    coverImage: \"https://images.unsplash.com/photo-1594736797933-d0c267cbcc2c?w=1200&h=800&fit=crop&q=85\",\n    languages: [\"Portugu√™s\", \"Ingl√™s\", \"Espanhol\"],\n    inclusions: [\"Entrada no parque\", \"Mapa ilustrativo\"],\n    exclusions: [\"Lanche\", \"Lembran√ßas\", \"Transporte\"],\n    requirements: [\"Sem restri√ß√µes\"],\n    budgetProposals: [\n      {\n        title: \"Entrada B√°sica\",\n        description: \"Acesso ao parque por 3 horas\",\n        amount: 45.00,\n        inclusions: [\"Entrada\", \"Mapa\"],\n        exclusions: [\"Guia\", \"Lanche\", \"Estacionamento\"]\n      },\n      {\n        title: \"Visita Guiada\",\n        description: \"Tour com guia especializado\",\n        amount: 75.00,\n        inclusions: [\"Entrada\", \"Guia especializado\", \"Lanche\", \"Estacionamento\"],\n        exclusions: [\"Transporte\", \"Lembran√ßas\", \"Fotos profissionais\"]\n      },\n      {\n        title: \"Experi√™ncia Premium\",\n        description: \"Tour VIP com fot√≥grafo\",\n        amount: 150.00,\n        inclusions: [\"Entrada VIP\", \"Guia exclusivo\", \"Sess√£o de fotos\", \"Lanche gourmet\", \"Lembran√ßa\"],\n        exclusions: [\"Transporte privado\", \"Hospedagem\"]\n      }\n    ]\n  },\n\n  // === PARIS, FRAN√áA ===\n  {\n    title: \"Torre Eiffel e Cruzeiro no Sena\",\n    description: \"Suba √† Torre Eiffel e navegue pelo Rio Sena admirando os monumentos hist√≥ricos de Paris iluminados ao entardecer.\",\n    location: \"Paris, Fran√ßa\",\n    city: \"Paris\",\n    region: \"Europa Ocidental\",\n    countryType: \"internacional\",\n    category: \"pontos_turisticos\",\n    duration: \"6 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 2,\n    maxParticipants: 25,\n    coverImage: \"https://images.unsplash.com/photo-1502602898536-47ad22581b52?w=1200&h=800&fit=crop&q=85\",\n    languages: [\"Fran√ßais\", \"English\", \"Espa√±ol\", \"Portugu√™s\"],\n    inclusions: [\"Torre Eiffel\", \"Cruzeiro\", \"Audioguia\"],\n    exclusions: [\"Refei√ß√µes\", \"Transporte hotel\", \"Bebidas\"],\n    requirements: [\"Passaporte v√°lido\"],\n    budgetProposals: [\n      {\n        title: \"√âconomique\",\n        description: \"Visite de base avec ascenseur\",\n        amount: 65.00,\n        currency: \"EUR\",\n        inclusions: [\"2¬∫ andar Torre Eiffel\", \"Cruzeiro b√°sico\"],\n        exclusions: [\"Topo da torre\", \"Jantar\", \"Transporte\"]\n      },\n      {\n        title: \"Complet\",\n        description: \"Exp√©rience compl√®te avec d√Æner\",\n        amount: 120.00,\n        currency: \"EUR\", \n        inclusions: [\"Topo da Torre Eiffel\", \"Cruzeiro com jantar\", \"Audioguia\", \"Transporte\"],\n        exclusions: [\"Bebidas premium\", \"Lembran√ßas\"]\n      },\n      {\n        title: \"Premium\",\n        description: \"Exp√©rience VIP avec champagne\",\n        amount: 250.00,\n        currency: \"EUR\",\n        inclusions: [\"Acesso VIP\", \"Jantar gourmet\", \"Champagne\", \"Guia privado\", \"Transporte de luxo\"],\n        exclusions: [\"Hotel\", \"Compras pessoais\"]\n      }\n    ]\n  },\n\n  // === NOVA YORK, EUA ===\n  {\n    title: \"Est√°tua da Liberdade e Ellis Island\",\n    description: \"Visite os s√≠mbolos da liberdade americana, incluindo ferry, museu da imigra√ß√£o e vistas espetaculares de Manhattan.\",\n    location: \"Nova York, EUA\",\n    city: \"Nova York\",\n    region: \"Am√©rica do Norte\",\n    countryType: \"internacional\",\n    category: \"pontos_turisticos\", \n    duration: \"6 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 1,\n    maxParticipants: 30,\n    coverImage: \"https://images.unsplash.com/photo-1485738422979-f5c462d49f74?w=1200&h=800&fit=crop&q=85\",\n    languages: [\"English\", \"Espa√±ol\", \"Fran√ßais\", \"Portugu√™s\"],\n    inclusions: [\"Ferry\", \"Entrada museus\", \"Audioguia\"],\n    exclusions: [\"Coroa da est√°tua\", \"Almo√ßo\", \"Transporte hotel\"],\n    requirements: [\"Documento de identidade\", \"Reserva antecipada\"],\n    budgetProposals: [\n      {\n        title: \"Basic Tour\",\n        description: \"Standard ferry and museum access\",\n        amount: 45.00,\n        currency: \"USD\",\n        inclusions: [\"Ferry tickets\", \"Ellis Island Museum\", \"Basic audioguide\"],\n        exclusions: [\"Pedestal access\", \"Food\", \"Transportation\"]\n      },\n      {\n        title: \"Complete Experience\",\n        description: \"Full access including pedestal\",\n        amount: 85.00,\n        currency: \"USD\",\n        inclusions: [\"Pedestal access\", \"Both museums\", \"Enhanced audioguide\", \"Reserved ferry\"],\n        exclusions: [\"Crown access\", \"Meals\", \"Hotel transport\"]\n      },\n      {\n        title: \"VIP Crown Access\",\n        description: \"Exclusive crown access with priority\",\n        amount: 180.00,\n        currency: \"USD\",\n        inclusions: [\"Crown access\", \"Priority boarding\", \"Guided tour\", \"Lunch\", \"Transportation\"],\n        exclusions: [\"Hotel accommodation\", \"Personal purchases\"]\n      }\n    ]\n  },\n\n  // === LONDRES, REINO UNIDO ===\n  {\n    title: \"Torre de Londres e Joias da Coroa\",\n    description: \"Explore a hist√≥rica Torre de Londres, lar das Joias da Coroa Brit√¢nica, com mais de 1000 anos de hist√≥ria real inglesa.\",\n    location: \"Londres, Reino Unido\",\n    city: \"Londres\", \n    region: \"Europa Ocidental\",\n    countryType: \"internacional\",\n    category: \"cultural\",\n    duration: \"4 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 1,\n    maxParticipants: 20,\n    coverImage: \"https://images.unsplash.com/photo-1529655683826-f8e02fb17597?w=1200&h=800&fit=crop&q=85\",\n    languages: [\"English\", \"Fran√ßais\", \"Espa√±ol\", \"Deutsch\"],\n    inclusions: [\"Entrada Torre\", \"Audioguia\", \"Guia Yeoman\"],\n    exclusions: [\"Transporte\", \"Refei√ß√µes\", \"Lembran√ßas\"],\n    requirements: [\"Reserva antecipada recomendada\"],\n    budgetProposals: [\n      {\n        title: \"Standard Entry\",\n        description: \"Regular admission with audioguide\",\n        amount: 35.00,\n        currency: \"GBP\",\n        inclusions: [\"Tower admission\", \"Crown Jewels\", \"Basic audioguide\"],\n        exclusions: [\"Yeoman tour\", \"Food\", \"Transport\"]\n      },\n      {\n        title: \"Guided Experience\", \n        description: \"Full tour with Yeoman Warder\",\n        amount: 65.00,\n        currency: \"GBP\",\n        inclusions: [\"Premium admission\", \"Yeoman Warder tour\", \"Enhanced audioguide\", \"Guidebook\"],\n        exclusions: [\"Meals\", \"Transportation\", \"Special exhibitions\"]\n      },\n      {\n        title: \"Royal Experience\",\n        description: \"VIP access with private guide\",\n        amount: 120.00,\n        currency: \"GBP\",\n        inclusions: [\"VIP admission\", \"Private guide\", \"Special access areas\", \"Afternoon tea\", \"Souvenir\"],\n        exclusions: [\"Hotel transport\", \"Additional purchases\"]\n      }\n    ]\n  },\n\n  // === ROMA, IT√ÅLIA ===\n  {\n    title: \"Coliseu e F√≥rum Romano\",\n    description: \"Mergulhe na Roma Antiga visitando o ic√¥nico Coliseu, F√≥rum Romano e Monte Palatino com guia arque√≥logo especializado.\",\n    location: \"Roma, It√°lia\",\n    city: \"Roma\",\n    region: \"Europa do Sul\", \n    countryType: \"internacional\",\n    category: \"cultural\",\n    duration: \"5 horas\",\n    difficultyLevel: \"moderate\",\n    minParticipants: 2,\n    maxParticipants: 18,\n    coverImage: \"https://images.unsplash.com/photo-1552832230-c0197dd311b5?w=1200&h=800&fit=crop&q=85\",\n    languages: [\"Italiano\", \"English\", \"Fran√ßais\", \"Espa√±ol\"],\n    inclusions: [\"Ingressos priorit√°rios\", \"Guia arque√≥logo\", \"Fones de ouvido\"],\n    exclusions: [\"Arena do Coliseu\", \"Transporte\", \"Refei√ß√µes\"],\n    requirements: [\"Cal√ßado confort√°vel\", \"Protetor solar\"],\n    budgetProposals: [\n      {\n        title: \"Ingresso B√°sico\",\n        description: \"Entrada padr√£o com audioguia\",\n        amount: 25.00,\n        currency: \"EUR\",\n        inclusions: [\"Coliseu\", \"F√≥rum Romano\", \"Audioguia b√°sico\"],\n        exclusions: [\"Arena\", \"Guia humano\", \"Monte Palatino\"]\n      },\n      {\n        title: \"Tour Completo\",\n        description: \"Visita guiada com arque√≥logo\",\n        amount: 75.00,\n        currency: \"EUR\",\n        inclusions: [\"Acesso priorit√°rio\", \"Guia especializado\", \"Monte Palatino\", \"Fones individuais\"],\n        exclusions: [\"Arena do gladiador\", \"Transporte\", \"Almo√ßo\"]\n      },\n      {\n        title: \"Experi√™ncia Arena\",\n        description: \"Acesso exclusivo √† arena dos gladiadores\",\n        amount: 150.00,\n        currency: \"EUR\",\n        inclusions: [\"Arena do gladiador\", \"Subterr√¢neos\", \"Tour privado\", \"Almo√ßo romano\", \"Certificado\"],\n        exclusions: [\"Hotel transport\", \"Jantar\", \"Lembran√ßas extras\"]\n      }\n    ]\n  },\n\n  // === BUENOS AIRES, ARGENTINA ===\n  {\n    title: \"Show de Tango e Jantar\",\n    description: \"Noite aut√™ntica portenha com show de tango profissional, jantar argentino e vinhos selecionados no hist√≥rico bairro San Telmo.\",\n    location: \"Buenos Aires, Argentina\", \n    city: \"Buenos Aires\",\n    region: \"Am√©rica do Sul\",\n    countryType: \"internacional\",\n    category: \"cultural\",\n    duration: \"4 horas\",\n    difficultyLevel: \"easy\",\n    minParticipants: 2,\n    maxParticipants: 40,\n    coverImage: \"https://images.unsplash.com/photo-1514222709107-a180c68d716f?w=1200&h=800&fit=crop&q=85\",\n    languages: [\"Espa√±ol\", \"English\", \"Portugu√™s\", \"Fran√ßais\"],\n    inclusions: [\"Show profissional\", \"Jantar\", \"Vinho\", \"Transporte\"],\n    exclusions: [\"Bebidas premium\", \"Aula de tango\", \"Gorjetas\"],\n    requirements: [\"Reserva antecipada\", \"Traje social\"],\n    budgetProposals: [\n      {\n        title: \"Tango B√°sico\",\n        description: \"Show e jantar simples\",\n        amount: 45.00,\n        currency: \"USD\",\n        inclusions: [\"Show de tango\", \"Jantar b√°sico\", \"1 bebida\"],\n        exclusions: [\"Transporte\", \"Vinhos premium\", \"Aula de dan√ßa\"]\n      },\n      {\n        title: \"Noche Completa\",\n        description: \"Experi√™ncia completa com vinhos\",\n        amount: 85.00,\n        currency: \"USD\",\n        inclusions: [\"Show premium\", \"Jantar gourmet\", \"Vinhos selecionados\", \"Transporte inclu√≠do\"],\n        exclusions: [\"Aula privada\", \"Bebidas extras\", \"Lembran√ßas\"]\n      },\n      {\n        title: \"Tango VIP\",\n        description: \"Mesa VIP com aula privada\",\n        amount: 160.00,\n        currency: \"USD\",\n        inclusions: [\"Mesa VIP\", \"Aula privada\", \"Jantar premium\", \"Vinhos premium\", \"Transporte executivo\"],\n        exclusions: [\"Hotel\", \"Compras pessoais\", \"Noite extra\"]\n      }\n    ]\n  }\n];\n\nexport async function populateAllActivitiesComprehensive() {\n  console.log(\"üèóÔ∏è Iniciando popula√ß√£o completa de atividades...\");\n  \n  try {\n    let totalActivities = 0;\n    let totalProposals = 0;\n\n    for (const activityData of comprehensiveActivities) {\n      // Insert activity\n      const { budgetProposals, ...activity } = activityData;\n      \n      const [insertedActivity] = await db.insert(activities).values({\n        ...activity,\n        priceType: \"per_person\",\n        priceAmount: \"0.00\", // Will be determined by proposals\n        averageRating: \"4.50\",\n        totalRatings: Math.floor(Math.random() * 50) + 10,\n        isActive: true\n      });\n\n      const activityId = insertedActivity.insertId;\n      totalActivities++;\n\n      // Insert budget proposals for this activity\n      for (const proposal of budgetProposals) {\n        await db.insert(activityBudgetProposals).values({\n          activityId: activityId,\n          createdBy: 1, // Admin user\n          title: proposal.title,\n          description: proposal.description,\n          amount: proposal.amount.toString(),\n          currency: (proposal as any).currency || \"BRL\",\n          priceType: \"per_person\",\n          inclusions: JSON.stringify(proposal.inclusions),\n          exclusions: JSON.stringify(proposal.exclusions),\n          isActive: true,\n          votes: Math.floor(Math.random() * 20) + 5\n        });\n        totalProposals++;\n      }\n\n      console.log(`‚úÖ Atividade criada: ${activity.title} (${activity.location}) com ${budgetProposals.length} propostas`);\n    }\n\n    console.log(`üéâ Popula√ß√£o completa finalizada!`);\n    console.log(`üìä Resumo:`);\n    console.log(`   - ${totalActivities} atividades criadas`);\n    console.log(`   - ${totalProposals} propostas de or√ßamento criadas`);\n    console.log(`   - Cobertura: Brasil (Sudeste, Centro-Oeste, Sul) + Internacional (Europa, Am√©rica do Norte, Am√©rica do Sul)`);\n    \n    return { totalActivities, totalProposals };\n\n  } catch (error) {\n    console.error(\"‚ùå Erro ao popular atividades:\", error);\n    throw error;\n  }\n}\n\n// Execute if called directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  populateAllActivitiesComprehensive()\n    .then((result) => {\n      console.log(\"‚úÖ Script executado com sucesso:\", result);\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error(\"‚ùå Erro na execu√ß√£o:\", error);\n      process.exit(1);\n    });\n}","size_bytes":20204},"server/populate-comprehensive-cities.ts":{"content":"import { config } from \"dotenv\";\nimport { db } from \"./db\";\nimport { destinations } from \"@shared/schema\";\nimport { sql } from \"drizzle-orm\";\n\nconfig();\n\ninterface CityData {\n  name: string;\n  state?: string;\n  country: string;\n  countryType: \"nacional\" | \"internacional\";\n  region: string;\n  continent: string;\n  latitude?: number;\n  longitude?: number;\n  timezone?: string;\n}\n\nconst comprehensiveCities: CityData[] = [\n  // CIDADES NACIONAIS - BRASIL\n  // Regi√£o Sudeste\n  {\n    name: \"Rio de Janeiro\",\n    state: \"RJ\", \n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Sudeste\",\n    continent: \"Am√©rica do Sul\",\n    latitude: -22.9068,\n    longitude: -43.1729,\n    timezone: \"America/Sao_Paulo\"\n  },\n  {\n    name: \"S√£o Paulo\",\n    state: \"SP\",\n    country: \"Brasil\", \n    countryType: \"nacional\",\n    region: \"Sudeste\",\n    continent: \"Am√©rica do Sul\",\n    latitude: -23.5558,\n    longitude: -46.6396,\n    timezone: \"America/Sao_Paulo\"\n  },\n  {\n    name: \"Serra da Mantiqueira\",\n    state: \"MG/SP/RJ\",\n    country: \"Brasil\",\n    countryType: \"nacional\", \n    region: \"Sudeste\",\n    continent: \"Am√©rica do Sul\",\n    latitude: -22.4009,\n    longitude: -45.4734,\n    timezone: \"America/Sao_Paulo\"\n  },\n  {\n    name: \"Ouro Preto\",\n    state: \"MG\",\n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Sudeste\", \n    continent: \"Am√©rica do Sul\",\n    latitude: -20.3856,\n    longitude: -43.5054,\n    timezone: \"America/Sao_Paulo\"\n  },\n\n  // Regi√£o Nordeste\n  {\n    name: \"Salvador\",\n    state: \"BA\",\n    country: \"Brasil\", \n    countryType: \"nacional\",\n    region: \"Nordeste\",\n    continent: \"Am√©rica do Sul\",\n    latitude: -12.9714,\n    longitude: -38.5014,\n    timezone: \"America/Bahia\"\n  },\n  {\n    name: \"Maragogi\", \n    state: \"AL\",\n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Nordeste\",\n    continent: \"Am√©rica do Sul\",\n    latitude: -9.0122,\n    longitude: -35.2228,\n    timezone: \"America/Maceio\"\n  },\n  {\n    name: \"Len√ß√≥is Maranhenses\",\n    state: \"MA\",\n    country: \"Brasil\",\n    countryType: \"nacional\", \n    region: \"Nordeste\",\n    continent: \"Am√©rica do Sul\",\n    latitude: -2.4856,\n    longitude: -43.1281,\n    timezone: \"America/Fortaleza\"\n  },\n  {\n    name: \"Caruaru\",\n    state: \"PE\",\n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Nordeste\",\n    continent: \"Am√©rica do Sul\",\n    latitude: -8.2837,\n    longitude: -35.9761,\n    timezone: \"America/Recife\" \n  },\n\n  // Regi√£o Norte\n  {\n    name: \"Manaus\",\n    state: \"AM\",\n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Norte\", \n    continent: \"Am√©rica do Sul\",\n    latitude: -3.1190,\n    longitude: -60.0217,\n    timezone: \"America/Manaus\"\n  },\n\n  // Regi√£o Sul\n  {\n    name: \"Florian√≥polis\", \n    state: \"SC\",\n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Sul\",\n    continent: \"Am√©rica do Sul\",\n    latitude: -27.5954,\n    longitude: -48.5480,\n    timezone: \"America/Sao_Paulo\"\n  },\n  {\n    name: \"Gramado\",\n    state: \"RS\", \n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Sul\",\n    continent: \"Am√©rica do Sul\",\n    latitude: -29.3788,\n    longitude: -50.8719,\n    timezone: \"America/Sao_Paulo\"\n  },\n\n  // Regi√£o Centro-Oeste\n  {\n    name: \"Pantanal\",\n    state: \"MT/MS\",\n    country: \"Brasil\",\n    countryType: \"nacional\",\n    region: \"Centro-Oeste\",\n    continent: \"Am√©rica do Sul\", \n    latitude: -19.0208,\n    longitude: -57.6531,\n    timezone: \"America/Campo_Grande\"\n  },\n  {\n    name: \"Bonito\",\n    state: \"MS\",\n    country: \"Brasil\", \n    countryType: \"nacional\",\n    region: \"Centro-Oeste\",\n    continent: \"Am√©rica do Sul\",\n    latitude: -21.1295,\n    longitude: -56.4886,\n    timezone: \"America/Campo_Grande\"\n  },\n\n  // CIDADES INTERNACIONAIS\n\n  // Europa\n  {\n    name: \"Paris\",\n    country: \"Fran√ßa\",\n    countryType: \"internacional\",\n    region: \"Europa Ocidental\",\n    continent: \"Europa\",\n    latitude: 48.8566,\n    longitude: 2.3522,\n    timezone: \"Europe/Paris\"\n  },\n  {\n    name: \"Londres\", \n    country: \"Reino Unido\",\n    countryType: \"internacional\",\n    region: \"Europa Ocidental\",\n    continent: \"Europa\",\n    latitude: 51.5074,\n    longitude: -0.1278,\n    timezone: \"Europe/London\"\n  },\n  {\n    name: \"Roma\",\n    country: \"It√°lia\",\n    countryType: \"internacional\", \n    region: \"Europa Mediterr√¢nea\",\n    continent: \"Europa\",\n    latitude: 41.9028,\n    longitude: 12.4964,\n    timezone: \"Europe/Rome\"\n  },\n  {\n    name: \"Madrid\",\n    country: \"Espanha\",\n    countryType: \"internacional\",\n    region: \"Europa Mediterr√¢nea\",\n    continent: \"Europa\",\n    latitude: 40.4168,\n    longitude: -3.7038,\n    timezone: \"Europe/Madrid\"\n  },\n  {\n    name: \"Barcelona\",\n    country: \"Espanha\", \n    countryType: \"internacional\",\n    region: \"Europa Mediterr√¢nea\",\n    continent: \"Europa\",\n    latitude: 41.3851,\n    longitude: 2.1734,\n    timezone: \"Europe/Madrid\"\n  },\n  {\n    name: \"Amsterdam\",\n    country: \"Holanda\",\n    countryType: \"internacional\",\n    region: \"Europa Ocidental\",\n    continent: \"Europa\",\n    latitude: 52.3676,\n    longitude: 4.9041,\n    timezone: \"Europe/Amsterdam\"\n  },\n  {\n    name: \"Berlim\",\n    country: \"Alemanha\",\n    countryType: \"internacional\",\n    region: \"Europa Central\", \n    continent: \"Europa\",\n    latitude: 52.5200,\n    longitude: 13.4050,\n    timezone: \"Europe/Berlin\"\n  },\n\n  // Am√©rica do Norte\n  {\n    name: \"Nova York\",\n    country: \"Estados Unidos\",\n    countryType: \"internacional\",\n    region: \"Costa Leste\",\n    continent: \"Am√©rica do Norte\",\n    latitude: 40.7128,\n    longitude: -74.0060,\n    timezone: \"America/New_York\"\n  },\n  {\n    name: \"Los Angeles\",\n    country: \"Estados Unidos\", \n    countryType: \"internacional\",\n    region: \"Costa Oeste\",\n    continent: \"Am√©rica do Norte\",\n    latitude: 34.0522,\n    longitude: -118.2437,\n    timezone: \"America/Los_Angeles\"\n  },\n  {\n    name: \"Las Vegas\",\n    country: \"Estados Unidos\",\n    countryType: \"internacional\",\n    region: \"Oeste\",\n    continent: \"Am√©rica do Norte\",\n    latitude: 36.1699,\n    longitude: -115.1398,\n    timezone: \"America/Los_Angeles\"\n  },\n  {\n    name: \"Miami\",\n    country: \"Estados Unidos\",\n    countryType: \"internacional\", \n    region: \"Sudeste\",\n    continent: \"Am√©rica do Norte\",\n    latitude: 25.7617,\n    longitude: -80.1918,\n    timezone: \"America/New_York\"\n  },\n\n  // Am√©rica do Sul (outros pa√≠ses)\n  {\n    name: \"Buenos Aires\",\n    country: \"Argentina\",\n    countryType: \"internacional\",\n    region: \"Cone Sul\",\n    continent: \"Am√©rica do Sul\",\n    latitude: -34.6037,\n    longitude: -58.3816,\n    timezone: \"America/Argentina/Buenos_Aires\"\n  },\n  {\n    name: \"Patag√¥nia\",\n    country: \"Argentina\", \n    countryType: \"internacional\",  \n    region: \"Cone Sul\",\n    continent: \"Am√©rica do Sul\",\n    latitude: -41.8182,\n    longitude: -68.9061,\n    timezone: \"America/Argentina/Rio_Gallegos\"\n  },\n  {\n    name: \"Machu Picchu\",\n    country: \"Peru\",\n    countryType: \"internacional\",\n    region: \"Andes\",\n    continent: \"Am√©rica do Sul\",\n    latitude: -13.1631,\n    longitude: -72.5450,\n    timezone: \"America/Lima\"\n  },\n  {\n    name: \"Santiago\",\n    country: \"Chile\",\n    countryType: \"internacional\",\n    region: \"Cone Sul\", \n    continent: \"Am√©rica do Sul\",\n    latitude: -33.4489,\n    longitude: -70.6693,\n    timezone: \"America/Santiago\"\n  },\n\n  // √Åsia\n  {\n    name: \"T√≥quio\",\n    country: \"Jap√£o\",\n    countryType: \"internacional\",\n    region: \"√Åsia Oriental\", \n    continent: \"√Åsia\",\n    latitude: 35.6762,\n    longitude: 139.6503,\n    timezone: \"Asia/Tokyo\"\n  },\n  {\n    name: \"Bangkok\",\n    country: \"Tail√¢ndia\",\n    countryType: \"internacional\",\n    region: \"Sudeste Asi√°tico\",\n    continent: \"√Åsia\",\n    latitude: 13.7563,\n    longitude: 100.5018,\n    timezone: \"Asia/Bangkok\"\n  },\n  {\n    name: \"Singapura\",\n    country: \"Singapura\", \n    countryType: \"internacional\",\n    region: \"Sudeste Asi√°tico\",\n    continent: \"√Åsia\",\n    latitude: 1.3521,\n    longitude: 103.8198,\n    timezone: \"Asia/Singapore\"\n  },\n\n  // √Åfrica\n  {\n    name: \"Nairobi\",\n    country: \"Qu√™nia\",\n    countryType: \"internacional\",\n    region: \"√Åfrica Oriental\",\n    continent: \"√Åfrica\",\n    latitude: -1.2864,\n    longitude: 36.8172,\n    timezone: \"Africa/Nairobi\"\n  },\n  {\n    name: \"Cidade do Cabo\", \n    country: \"√Åfrica do Sul\",\n    countryType: \"internacional\",\n    region: \"√Åfrica Austral\",\n    continent: \"√Åfrica\",\n    latitude: -33.9249,\n    longitude: 18.4241,\n    timezone: \"Africa/Johannesburg\"\n  },\n\n  // Oceania\n  {\n    name: \"Sydney\",\n    country: \"Austr√°lia\",\n    countryType: \"internacional\",\n    region: \"Oceania\",\n    continent: \"Oceania\",\n    latitude: -33.8688,\n    longitude: 151.2093,\n    timezone: \"Australia/Sydney\"\n  }\n];\n\nasync function populateComprehensiveCities() {\n  try {\n    console.log(\"üîó Conectando ao MySQL...\");\n    \n    // Add continent column if not exists\n    try {\n      await db.execute(sql`\n        ALTER TABLE destinations ADD COLUMN continent VARCHAR(100) NOT NULL DEFAULT 'Am√©rica do Sul'\n      `);\n      console.log(\"   ‚úÖ Coluna continent adicionada √† tabela destinations\");\n    } catch (error) {\n      console.log(\"   ‚ö†Ô∏è Coluna continent j√° existe ou erro:\", (error as Error).message);\n    }\n\n    console.log(\"üèôÔ∏è Inserindo cidades abrangentes...\");\n    \n    for (const cityData of comprehensiveCities) {\n      try {\n        // Check if city already exists\n        const [existingCity] = await db.execute(sql`\n          SELECT id FROM destinations WHERE name = ${cityData.name} AND country = ${cityData.country}\n        `);\n        \n        if (existingCity && Array.isArray(existingCity) && existingCity.length > 0) {\n          // Update existing city with new data including continent\n          await db.execute(sql`\n            UPDATE destinations SET\n              state = ${cityData.state || null},\n              country_type = ${cityData.countryType},\n              region = ${cityData.region},\n              continent = ${cityData.continent},\n              latitude = ${cityData.latitude || null},\n              longitude = ${cityData.longitude || null},\n              timezone = ${cityData.timezone || null}\n            WHERE name = ${cityData.name} AND country = ${cityData.country}\n          `);\n          console.log(`   üîÑ Cidade atualizada: ${cityData.name}, ${cityData.country} (${cityData.continent})`);\n        } else {\n          // Insert new city\n          await db.execute(sql`\n            INSERT INTO destinations (name, state, country, country_type, region, continent, latitude, longitude, timezone, is_active)\n            VALUES (${cityData.name}, ${cityData.state || null}, ${cityData.country}, ${cityData.countryType}, \n                    ${cityData.region}, ${cityData.continent}, ${cityData.latitude || null}, \n                    ${cityData.longitude || null}, ${cityData.timezone || null}, true)\n          `);\n          console.log(`   ‚úÖ Cidade inserida: ${cityData.name}, ${cityData.country} (${cityData.continent})`);\n        }\n      } catch (error) {\n        console.log(`   ‚ùå Erro ao processar ${cityData.name}: ${(error as Error).message}`);\n      }\n    }\n\n    // Get final count\n    const [countResult] = await db.execute(sql`SELECT COUNT(*) as total FROM destinations WHERE is_active = true`);\n    const totalCities = Array.isArray(countResult) ? (countResult[0] as any)?.total || 0 : 0;\n    \n    console.log(`üìä Total de cidades ativas: ${totalCities}`);\n    console.log(\"üéâ Popula√ß√£o abrangente de cidades conclu√≠da!\");\n    \n  } catch (error) {\n    console.error(\"üí• Erro na popula√ß√£o de cidades:\", error);\n    throw error;\n  }\n}\n\n// Execute if this module is run directly\npopulateComprehensiveCities()\n  .then(() => {\n    console.log(\"‚úÖ Script executado com sucesso!\");\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error(\"‚ùå Falha na execu√ß√£o:\", error);\n    process.exit(1);\n  });\n\nexport { populateComprehensiveCities };","size_bytes":11930},"server/populate-destinations-and-fix-references.ts":{"content":"#!/usr/bin/env tsx\n\nimport { db } from \"./db\";\nimport { sql } from \"drizzle-orm\";\n\nasync function populateDestinationsAndFixReferences() {\n  console.log(\"üöÄ Povoando tabela destinations e corrigindo refer√™ncias...\");\n  \n  try {\n    // 1. Primeiro criar os destinos principais\n    console.log(\"üìç Criando destinos principais...\");\n    \n    const destinations = [\n      // Brasil - Destinos Nacionais\n      { name: \"Rio de Janeiro\", state: \"RJ\", country: \"Brasil\", countryType: \"nacional\", continent: \"Am√©rica do Sul\", region: \"Sudeste\" },\n      { name: \"S√£o Paulo\", state: \"SP\", country: \"Brasil\", countryType: \"nacional\", continent: \"Am√©rica do Sul\", region: \"Sudeste\" },\n      { name: \"Gramado\", state: \"RS\", country: \"Brasil\", countryType: \"nacional\", continent: \"Am√©rica do Sul\", region: \"Sul\" },\n      { name: \"Bonito\", state: \"MS\", country: \"Brasil\", countryType: \"nacional\", continent: \"Am√©rica do Sul\", region: \"Centro-Oeste\" },\n      { name: \"Salvador\", state: \"BA\", country: \"Brasil\", countryType: \"nacional\", continent: \"Am√©rica do Sul\", region: \"Nordeste\" },\n      { name: \"Florian√≥polis\", state: \"SC\", country: \"Brasil\", countryType: \"nacional\", continent: \"Am√©rica do Sul\", region: \"Sul\" },\n      { name: \"Pantanal\", state: \"MS/MT\", country: \"Brasil\", countryType: \"nacional\", continent: \"Am√©rica do Sul\", region: \"Centro-Oeste\" },\n      { name: \"Serra da Mantiqueira\", state: \"MG/SP\", country: \"Brasil\", countryType: \"nacional\", continent: \"Am√©rica do Sul\", region: \"Sudeste\" },\n      { name: \"Maragogi\", state: \"AL\", country: \"Brasil\", countryType: \"nacional\", continent: \"Am√©rica do Sul\", region: \"Nordeste\" },\n      { name: \"Ouro Preto\", state: \"MG\", country: \"Brasil\", countryType: \"nacional\", continent: \"Am√©rica do Sul\", region: \"Sudeste\" },\n      { name: \"Manaus\", state: \"AM\", country: \"Brasil\", countryType: \"nacional\", continent: \"Am√©rica do Sul\", region: \"Norte\" },\n      { name: \"Len√ß√≥is Maranhenses\", state: \"MA\", country: \"Brasil\", countryType: \"nacional\", continent: \"Am√©rica do Sul\", region: \"Nordeste\" },\n      { name: \"Caruaru\", state: \"PE\", country: \"Brasil\", countryType: \"nacional\", continent: \"Am√©rica do Sul\", region: \"Nordeste\" },\n      { name: \"Copacabana\", state: \"RJ\", country: \"Brasil\", countryType: \"nacional\", continent: \"Am√©rica do Sul\", region: \"Sudeste\" },\n      \n      // Destinos Internacionais\n      { name: \"Paris\", state: null, country: \"Fran√ßa\", countryType: \"internacional\", continent: \"Europa\", region: \"Europa Ocidental\" },\n      { name: \"Londres\", state: null, country: \"Reino Unido\", countryType: \"internacional\", continent: \"Europa\", region: \"Europa Ocidental\" },\n      { name: \"Roma\", state: null, country: \"It√°lia\", countryType: \"internacional\", continent: \"Europa\", region: \"Europa Meridional\" },\n      { name: \"Nova York\", state: \"NY\", country: \"Estados Unidos\", countryType: \"internacional\", continent: \"Am√©rica do Norte\", region: \"Am√©rica do Norte\" },\n      { name: \"Buenos Aires\", state: null, country: \"Argentina\", countryType: \"internacional\", continent: \"Am√©rica do Sul\", region: \"Am√©rica do Sul\" },\n      { name: \"Patag√¥nia\", state: null, country: \"Argentina\", countryType: \"internacional\", continent: \"Am√©rica do Sul\", region: \"Am√©rica do Sul\" },\n      { name: \"Machu Picchu\", state: null, country: \"Peru\", countryType: \"internacional\", continent: \"Am√©rica do Sul\", region: \"Am√©rica do Sul\" },\n      { name: \"Qu√™nia\", state: null, country: \"Qu√™nia\", countryType: \"internacional\", continent: \"√Åfrica\", region: \"√Åfrica Oriental\" },\n    ];\n    \n    for (const dest of destinations) {\n      try {\n        await db.execute(sql`\n          INSERT INTO destinations (name, state, country, country_type, continent, region, is_active, created_at)\n          VALUES (${dest.name}, ${dest.state}, ${dest.country}, ${dest.countryType}, ${dest.continent}, ${dest.region}, true, NOW())\n          ON DUPLICATE KEY UPDATE name = name\n        `);\n        console.log(`‚úÖ Destino criado: ${dest.name}`);\n      } catch (error: any) {\n        console.log(`‚ö†Ô∏è Destino j√° existe: ${dest.name}`);\n      }\n    }\n    \n    // 2. Agora verificar e corrigir refer√™ncias √≥rf√£s na tabela trips\n    console.log(\"üîç Verificando refer√™ncias √≥rf√£s em trips...\");\n    \n    const orphanTrips = await db.execute(sql`\n      SELECT t.id, t.title, t.destination_id \n      FROM trips t \n      LEFT JOIN destinations d ON t.destination_id = d.id \n      WHERE d.id IS NULL\n    `);\n    \n    console.log(`üìã Encontradas ${orphanTrips.length} viagens √≥rf√£s`);\n    \n    // Para viagens √≥rf√£s, vamos assinalar o primeiro destino dispon√≠vel (Rio de Janeiro)\n    if (orphanTrips.length > 0) {\n      const rioDestination = await db.execute(sql`SELECT id FROM destinations WHERE name = 'Rio de Janeiro' LIMIT 1`);\n      \n      if (rioDestination.length > 0) {\n        const rioId = (rioDestination[0] as any).id;\n        \n        // Corrigir cada viagem √≥rf√£ individualmente\n        for (const trip of orphanTrips) {\n          await db.execute(sql`UPDATE trips SET destination_id = ${rioId} WHERE id = ${(trip as any).id}`);\n        }\n        \n        console.log(`‚úÖ ${orphanTrips.length} viagens √≥rf√£s corrigidas para Rio de Janeiro`);\n      }\n    }\n    \n    // 3. Agora tentar adicionar as foreign keys novamente\n    console.log(\"üîó Adicionando foreign keys...\");\n    \n    try {\n      await db.execute(sql`ALTER TABLE trips ADD CONSTRAINT trips_destinations_fk FOREIGN KEY (destination_id) REFERENCES destinations(id)`);\n      console.log(\"‚úÖ Foreign key trips_destinations_fk adicionada\");\n    } catch (error: any) {\n      console.log(\"‚ÑπÔ∏è Foreign key trips j√° existe ou erro:\", error.message);\n    }\n    \n    // 4. Verificar e corrigir activities tamb√©m\n    console.log(\"üéØ Verificando atividades...\");\n    \n    const orphanActivities = await db.execute(sql`\n      SELECT a.id, a.title, a.destination_id \n      FROM activities a \n      LEFT JOIN destinations d ON a.destination_id = d.id \n      WHERE d.id IS NULL\n    `);\n    \n    if (orphanActivities.length > 0) {\n      console.log(`üìã Encontradas ${orphanActivities.length} atividades √≥rf√£s`);\n      \n      const rioDestination = await db.execute(sql`SELECT id FROM destinations WHERE name = 'Rio de Janeiro' LIMIT 1`);\n      \n      if (rioDestination.length > 0) {\n        const rioId = (rioDestination[0] as any).id;\n        \n        // Corrigir cada atividade √≥rf√£ individualmente\n        for (const activity of orphanActivities) {\n          await db.execute(sql`UPDATE activities SET destination_id = ${rioId} WHERE id = ${(activity as any).id}`);\n        }\n        \n        console.log(`‚úÖ ${orphanActivities.length} atividades √≥rf√£s corrigidas`);\n      }\n    }\n    \n    try {\n      await db.execute(sql`ALTER TABLE activities ADD CONSTRAINT activities_destinations_fk FOREIGN KEY (destination_id) REFERENCES destinations(id)`);\n      console.log(\"‚úÖ Foreign key activities_destinations_fk adicionada\");\n    } catch (error: any) {\n      console.log(\"‚ÑπÔ∏è Foreign key activities j√° existe ou erro:\", error.message);\n    }\n    \n    console.log(\"üéâ Migra√ß√£o conclu√≠da com sucesso!\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro durante a migra√ß√£o:\", error);\n    throw error;\n  }\n}\n\n// Executar se chamado diretamente\npopulateDestinationsAndFixReferences()\n  .then(() => {\n    console.log(\"‚úÖ Popula√ß√£o e corre√ß√£o executadas com sucesso!\");\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error(\"‚ùå Falha na popula√ß√£o:\", error);\n    process.exit(1);\n  });\n\nexport { populateDestinationsAndFixReferences };","size_bytes":7604},"server/quick-test-data.ts":{"content":"import { db } from './db.js';\nimport { sql } from 'drizzle-orm';\n\nasync function hashPassword(password: string): Promise<string> {\n  const encoder = new TextEncoder();\n  const data = encoder.encode(password);\n  const hash = await crypto.subtle.digest('SHA-256', data);\n  return Array.from(new Uint8Array(hash))\n    .map(b => b.toString(16).padStart(2, '0'))\n    .join('');\n}\n\nasync function generateReferralCode(username: string, id: number): Promise<string> {\n  return `${username.substring(0, 3).toUpperCase()}${id.toString().padStart(3, '0')}`;\n}\n\nasync function createQuickTestData() {\n  console.log('üöÄ Criando dados completos de teste...');\n\n  try {\n    // 1. Remover tabelas antigas\n    console.log('üßπ Removendo dados antigos...');\n    await db.execute(sql`SET FOREIGN_KEY_CHECKS = 0`);\n    await db.execute(sql`DROP TABLE IF EXISTS activity_budget_proposals`);\n    await db.execute(sql`DROP TABLE IF EXISTS activity_reviews`);\n    await db.execute(sql`SET FOREIGN_KEY_CHECKS = 1`);\n\n    // 2. Criar tabelas\n    console.log('üîß Criando estrutura...');\n    await db.execute(sql`\n      CREATE TABLE activity_budget_proposals (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        activity_id INT NOT NULL,\n        title VARCHAR(255) NOT NULL,\n        description TEXT,\n        price_type VARCHAR(50) DEFAULT 'per_person' NOT NULL,\n        amount DECIMAL(10,2),\n        currency VARCHAR(10) DEFAULT 'BRL' NOT NULL,\n        inclusions TEXT,\n        exclusions TEXT,\n        is_active BOOLEAN DEFAULT TRUE NOT NULL,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n      )\n    `);\n\n    await db.execute(sql`\n      CREATE TABLE activity_reviews (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        activity_id INT NOT NULL,\n        user_id INT NOT NULL,\n        rating INT NOT NULL CHECK (rating >= 1 AND rating <= 5),\n        comment TEXT,\n        visit_date DATE,\n        is_verified BOOLEAN DEFAULT TRUE NOT NULL,\n        helpful_votes INT DEFAULT 0 NOT NULL,\n        is_hidden BOOLEAN DEFAULT FALSE NOT NULL,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP NOT NULL\n      )\n    `);\n\n    console.log('‚úÖ Estrutura criada');\n\n    // 3. Inserir propostas usando execu√ß√£o m√∫ltipla\n    console.log('üí∞ Inserindo propostas...');\n    \n    const proposals = [\n      [9, 'Van Oficial', 'Transporte em van oficial', 85.00, 'Van oficial, Entrada', 'Alimenta√ß√£o, Bebidas'],\n      [9, 'Trem do Corcovado', 'Trem + guia tur√≠stico', 160.00, 'Trem, Guia, Entrada', 'Bebidas alco√≥licas'],\n      [9, 'Tour Premium', 'Tour privativo VIP', 320.00, 'Transporte privativo, Guia exclusivo, Fotos', 'Compras pessoais'],\n      \n      [10, 'Ingresso Padr√£o', 'Bondinho ida e volta', 120.00, 'Bondinho, Mirantes', 'Alimenta√ß√£o, Fotos'],\n      [10, 'Com Guia', 'Bondinho com guia especializado', 190.00, 'Bondinho, Guia, Material', 'Fotos profissionais'],\n      [10, 'Experi√™ncia VIP', 'Bondinho + helic√≥ptero + jantar', 650.00, 'Bondinho, Helic√≥ptero, Jantar', 'Compras pessoais'],\n      \n      [14, 'Entrada B√°sica', 'Acesso ao parque', 85.00, 'Entrada parque, Trilha', 'Transporte, Alimenta√ß√£o'],\n      [14, 'Tour Completo', 'Parque + transporte + guia', 150.00, 'Entrada, Transporte, Guia', 'Refei√ß√µes'],\n      [14, 'Premium A√©reo', 'Tour + helic√≥ptero + almo√ßo', 450.00, 'Tour completo, Helic√≥ptero, Almo√ßo', 'Compras pessoais'],\n      \n      [12, 'Entrada Livre', 'Visita livre ao museu', 40.00, 'Entrada MASP', 'Guia, Transporte'],\n      [12, 'Tour Guiado', 'MASP + Paulista com guia', 75.00, 'MASP, Guia, Paulista', 'Transporte'],\n      [12, 'Cultural Completo', 'MASP + Pinacoteca + almo√ßo', 120.00, 'MASP, Pinacoteca, Almo√ßo, Transporte', 'Compras'],\n      \n      [13, 'Caminhada Hist√≥rica', 'Tour a p√© pelo centro', 60.00, 'Tour, Elevador Lacerda', 'Alimenta√ß√£o, Bebidas'],\n      [13, 'Cultural', 'Tour + capoeira + degusta√ß√£o', 120.00, 'Tour, Capoeira, Degusta√ß√£o', 'Compras'],\n      [13, 'Viv√™ncia Completa', 'Tour + oficinas + almo√ßo', 200.00, 'Tour completo, Oficinas, Almo√ßo baiano', 'Gorjetas'],\n      \n      [11, 'Aula de Surf', 'Aula b√°sica com instrutor', 100.00, 'Aula surf, Prancha, Instrutor', 'Transporte, Alimenta√ß√£o'],\n      [11, 'Dia Completo', 'Surf + v√¥lei + bike tour', 180.00, 'Surf, V√¥lei, Bike tour', 'Refei√ß√µes'],\n      [11, 'Premium', 'Aulas privadas + spa', 350.00, 'Aulas privadas, Spa, Almo√ßo', 'Gorjetas']\n    ];\n\n    for (const [activityId, title, description, amount, inclusions, exclusions] of proposals) {\n      await db.execute(sql`\n        INSERT INTO activity_budget_proposals \n        (activity_id, title, description, amount, currency, inclusions, exclusions, price_type, is_active) \n        VALUES \n        (${activityId}, ${title}, ${description}, ${amount}, 'BRL', ${inclusions}, ${exclusions}, 'per_person', true)\n      `);\n    }\n\n    console.log(`‚úÖ ${proposals.length} propostas criadas`);\n\n    // 4. Criar usu√°rios teste se n√£o existirem\n    console.log('üë• Verificando usu√°rios...');\n    const existingUsers = await db.execute(sql`SELECT COUNT(*) as count FROM users`);\n    \n    if (existingUsers[0].count === 0) {\n      console.log('Criando usu√°rios teste...');\n      \n      const users = [\n        ['testuser1', 'Test User 1', 'test1@example.com', '(11) 99999-1111'],\n        ['testuser2', 'Test User 2', 'test2@example.com', '(11) 99999-2222'],\n        ['testuser3', 'Test User 3', 'test3@example.com', '(11) 99999-3333']\n      ];\n\n      for (const [username, fullName, email, phone] of users) {\n        const hashedPassword = await hashPassword('123456');\n        await db.execute(sql`\n          INSERT INTO users \n          (username, password, email, full_name, phone, is_verified, created_at, updated_at) \n          VALUES \n          (${username}, ${hashedPassword}, ${email}, ${fullName}, ${phone}, true, NOW(), NOW())\n        `);\n      }\n      console.log(`‚úÖ ${users.length} usu√°rios criados`);\n    } else {\n      console.log(`‚úÖ ${existingUsers[0].count} usu√°rios j√° existem`);\n    }\n\n    // 5. Inserir avalia√ß√µes\n    console.log('‚≠ê Inserindo avalia√ß√µes...');\n    \n    const reviews = [\n      [9, 1, 5, 'Vista incr√≠vel! O Cristo Redentor √© realmente majestoso. Vale muito a pena!', '2024-12-01', 15],\n      [9, 2, 4, 'Muito bonito, mas estava bem cheio. Recomendo ir cedo pela manh√£.', '2024-11-28', 8],\n      [10, 1, 5, 'O bondinho √© uma experi√™ncia √∫nica! Vista espetacular da cidade.', '2024-12-05', 12],\n      [10, 2, 4, 'Vista maravilhosa, mas achei um pouco caro. Ainda assim recomendo!', '2024-11-30', 6],\n      [14, 1, 5, 'Uma das experi√™ncias mais impressionantes da minha vida! As cataratas s√£o majestosas.', '2024-11-15', 22],\n      [14, 2, 5, 'Espetacular! Prepare-se para se molhar e leve capa de chuva. Vale cada centavo!', '2024-11-20', 18],\n      [12, 1, 4, 'Excelente museu com obras incr√≠veis. O acervo √© muito rico e diversificado.', '2024-12-03', 9],\n      [12, 2, 4, 'Muito interessante para quem gosta de arte. A arquitetura do pr√©dio tamb√©m √© impressionante.', '2024-11-25', 7],\n      [13, 1, 5, 'O centro hist√≥rico de Salvador √© maravilhoso! Rica cultura e hist√≥ria em cada esquina.', '2024-11-18', 14],\n      [13, 2, 4, 'Muito bonito e cheio de hist√≥ria. O show de capoeira foi o ponto alto!', '2024-11-22', 10]\n    ];\n\n    for (const [activityId, userId, rating, comment, visitDate, helpfulVotes] of reviews) {\n      try {\n        await db.execute(sql`\n          INSERT INTO activity_reviews \n          (activity_id, user_id, rating, comment, visit_date, is_verified, helpful_votes, is_hidden) \n          VALUES \n          (${activityId}, ${userId}, ${rating}, ${comment}, ${visitDate}, true, ${helpfulVotes}, false)\n        `);\n      } catch (error) {\n        // Ignora duplicatas\n        if (!error.message.includes('Duplicate') && !error.message.includes('foreign key')) {\n          console.error(`Erro na avalia√ß√£o: ${error.message}`);\n        }\n      }\n    }\n\n    console.log(`‚úÖ ${reviews.length} avalia√ß√µes inseridas`);\n\n    // 6. Atualizar m√©dias\n    console.log('üìä Atualizando m√©dias...');\n    await db.execute(sql`\n      UPDATE activities a\n      SET \n        average_rating = COALESCE((\n          SELECT AVG(r.rating)\n          FROM activity_reviews r \n          WHERE r.activity_id = a.id AND r.is_hidden = FALSE\n        ), 0),\n        total_ratings = COALESCE((\n          SELECT COUNT(*)\n          FROM activity_reviews r \n          WHERE r.activity_id = a.id AND r.is_hidden = FALSE\n        ), 0)\n    `);\n\n    // 7. Verificar resultados\n    const [proposalsResult, reviewsResult] = await Promise.all([\n      db.execute(sql`SELECT COUNT(*) as count FROM activity_budget_proposals`),\n      db.execute(sql`SELECT COUNT(*) as count FROM activity_reviews`)\n    ]);\n    \n    console.log(`\\nüìã Resultado:`);\n    console.log(`üí∞ Propostas: ${proposalsResult[0].count}`);\n    console.log(`‚≠ê Avalia√ß√µes: ${reviewsResult[0].count}`);\n\n    console.log('\\nüéâ Sistema de propostas e avalia√ß√µes criado com sucesso!');\n    \n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n    throw error;\n  }\n}\n\nasync function main() {\n  try {\n    await createQuickTestData();\n    console.log('‚úÖ Processo conclu√≠do!');\n    process.exit(0);\n  } catch (error) {\n    console.error('‚ùå Erro no processo:', error);\n    process.exit(1);\n  }\n}\n\n// Executar se chamado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  main();\n}","size_bytes":9623},"server/recreate-database.ts":{"content":"import { db } from \"./db\";\nimport * as crypto from \"crypto\";\n\n// Hash password function  \nfunction hashPassword(password: string): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const salt = crypto.randomBytes(16).toString('hex');\n    crypto.scrypt(password, salt, 64, (err, derivedKey) => {\n      if (err) reject(err);\n      resolve(derivedKey.toString('hex') + '.' + salt);\n    });\n  });\n}\n\nasync function recreateDatabase() {\n  console.log(\"üöÄ Recriando banco de dados MySQL com dados em portugu√™s...\");\n\n  try {\n    // Drop all tables\n    console.log(\"üóëÔ∏è Removendo tabelas existentes...\");\n    const tables = [\n      'expense_splits', 'expenses', 'user_ratings', 'activity_reviews',\n      'activity_budget_proposals', 'trip_requests', 'messages',\n      'trip_participants', 'trips', 'activities', 'referral_codes', 'users'\n    ];\n\n    for (const table of tables) {\n      try {\n        await db.execute(`DROP TABLE IF EXISTS ${table}` as any);\n        console.log(`‚úÖ Tabela ${table} removida`);\n      } catch (error) {\n        console.log(`‚ö†Ô∏è Tabela ${table} n√£o existia`);\n      }\n    }\n\n    // Create users table\n    console.log(\"üèóÔ∏è Criando tabela de usu√°rios...\");\n    await db.execute(`\n      CREATE TABLE users (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        username VARCHAR(255) NOT NULL UNIQUE,\n        password TEXT NOT NULL,\n        email VARCHAR(255) NOT NULL UNIQUE,\n        full_name VARCHAR(255) NOT NULL,\n        phone VARCHAR(20) NOT NULL,\n        bio TEXT,\n        location VARCHAR(255),\n        profile_photo TEXT,\n        languages JSON,\n        interests JSON,\n        travel_styles JSON,\n        referred_by VARCHAR(50),\n        is_verified BOOLEAN DEFAULT FALSE NOT NULL,\n        verification_method VARCHAR(50),\n        average_rating DECIMAL(3,2) DEFAULT 5.00,\n        total_ratings INT DEFAULT 0 NOT NULL,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL\n      )\n    ` as any);\n\n    // Create trips table\n    console.log(\"üèóÔ∏è Criando tabela de viagens...\");\n    await db.execute(`\n      CREATE TABLE trips (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        creator_id INT NOT NULL,\n        title VARCHAR(255) NOT NULL,\n        localidade VARCHAR(255) NOT NULL,\n        cover_image TEXT,\n        start_date TIMESTAMP NOT NULL,\n        end_date TIMESTAMP NOT NULL,\n        budget INT,\n        budget_breakdown JSON,\n        max_participants INT NOT NULL,\n        current_participants INT DEFAULT 1 NOT NULL,\n        description TEXT NOT NULL,\n        travel_style VARCHAR(100) NOT NULL,\n        shared_costs JSON,\n        planned_activities JSON,\n        status VARCHAR(50) DEFAULT 'open' NOT NULL,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        FOREIGN KEY (creator_id) REFERENCES users(id)\n      )\n    ` as any);\n\n    // Create trip_participants table\n    console.log(\"üèóÔ∏è Criando tabela de participantes...\");\n    await db.execute(`\n      CREATE TABLE trip_participants (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        trip_id INT NOT NULL,\n        user_id INT NOT NULL,\n        status VARCHAR(50) DEFAULT 'pending' NOT NULL,\n        joined_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        FOREIGN KEY (trip_id) REFERENCES trips(id),\n        FOREIGN KEY (user_id) REFERENCES users(id)\n      )\n    ` as any);\n\n    // Create activities table\n    console.log(\"üèóÔ∏è Criando tabela de atividades...\");\n    await db.execute(`\n      CREATE TABLE activities (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        title VARCHAR(255) NOT NULL,\n        description TEXT NOT NULL,\n        location VARCHAR(255) NOT NULL,\n        category VARCHAR(100) NOT NULL,\n        duration_hours INT NOT NULL,\n        difficulty_level VARCHAR(50) NOT NULL,\n        price_range VARCHAR(50) NOT NULL,\n        image_url TEXT,\n        rating DECIMAL(3,2) DEFAULT 0.00,\n        review_count INT DEFAULT 0,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL\n      )\n    ` as any);\n\n    // Create other essential tables\n    await db.execute(`\n      CREATE TABLE messages (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        trip_id INT NOT NULL,\n        sender_id INT NOT NULL,\n        content TEXT NOT NULL,\n        sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        FOREIGN KEY (trip_id) REFERENCES trips(id),\n        FOREIGN KEY (sender_id) REFERENCES users(id)\n      )\n    ` as any);\n\n    await db.execute(`\n      CREATE TABLE trip_requests (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        trip_id INT NOT NULL,\n        user_id INT NOT NULL,\n        message TEXT,\n        status VARCHAR(50) DEFAULT 'pending' NOT NULL,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        FOREIGN KEY (trip_id) REFERENCES trips(id),\n        FOREIGN KEY (user_id) REFERENCES users(id)\n      )\n    ` as any);\n\n    // Create remaining tables quickly\n    const otherTables = [\n      `CREATE TABLE expenses (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        trip_id INT NOT NULL,\n        paid_by INT NOT NULL,\n        amount DECIMAL(10,2) NOT NULL,\n        description TEXT NOT NULL,\n        category VARCHAR(100) DEFAULT 'other' NOT NULL,\n        receipt TEXT,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        settled_at TIMESTAMP,\n        FOREIGN KEY (trip_id) REFERENCES trips(id),\n        FOREIGN KEY (paid_by) REFERENCES users(id)\n      )`,\n      `CREATE TABLE expense_splits (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        expense_id INT NOT NULL,\n        user_id INT NOT NULL,\n        amount DECIMAL(10,2) NOT NULL,\n        paid BOOLEAN DEFAULT FALSE NOT NULL,\n        settled_at TIMESTAMP,\n        FOREIGN KEY (expense_id) REFERENCES expenses(id),\n        FOREIGN KEY (user_id) REFERENCES users(id)\n      )`,\n      `CREATE TABLE user_ratings (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        trip_id INT NOT NULL,\n        rated_user_id INT NOT NULL,\n        rater_user_id INT NOT NULL,\n        rating INT NOT NULL,\n        comment TEXT,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        FOREIGN KEY (trip_id) REFERENCES trips(id),\n        FOREIGN KEY (rated_user_id) REFERENCES users(id),\n        FOREIGN KEY (rater_user_id) REFERENCES users(id)\n      )`,\n      `CREATE TABLE activity_reviews (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        activity_id INT NOT NULL,\n        user_id INT NOT NULL,\n        rating INT NOT NULL,\n        comment TEXT,\n        photos JSON,\n        visit_date DATE,\n        helpful_count INT DEFAULT 0,\n        is_verified BOOLEAN DEFAULT FALSE,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        FOREIGN KEY (activity_id) REFERENCES activities(id),\n        FOREIGN KEY (user_id) REFERENCES users(id)\n      )`,\n      `CREATE TABLE activity_budget_proposals (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        activity_id INT NOT NULL,\n        title VARCHAR(255) NOT NULL,\n        description TEXT,\n        price_per_person DECIMAL(10,2) NOT NULL,\n        currency VARCHAR(3) DEFAULT 'BRL' NOT NULL,\n        inclusions JSON,\n        exclusions JSON,\n        vote_count INT DEFAULT 0,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        FOREIGN KEY (activity_id) REFERENCES activities(id)\n      )`,\n      `CREATE TABLE referral_codes (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        code VARCHAR(50) NOT NULL UNIQUE,\n        user_id INT,\n        type VARCHAR(50) NOT NULL,\n        discount_percentage INT DEFAULT 0,\n        max_uses INT DEFAULT 1,\n        current_uses INT DEFAULT 0,\n        expires_at TIMESTAMP,\n        is_active BOOLEAN DEFAULT TRUE,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        FOREIGN KEY (user_id) REFERENCES users(id)\n      )`\n    ];\n\n    for (const sql of otherTables) {\n      await db.execute(sql as any);\n    }\n\n    console.log(\"‚úÖ Todas as tabelas criadas!\");\n\n    // Insert initial data\n    console.log(\"üìä Inserindo dados iniciais...\");\n\n    // Create test users\n    const tomPassword = await hashPassword(\"password123\");\n    const mariaPassword = await hashPassword(\"password123\");\n    const carlosPassword = await hashPassword(\"password123\");\n\n    await db.execute(`\n      INSERT INTO users (username, password, email, full_name, phone, bio, location, languages, interests, travel_styles, is_verified, average_rating, total_ratings) VALUES\n      ('tom', ?, 'tom@teste.com', 'Tom Tubin', '(51) 99999-1111', 'Aventureiro nato, amo conhecer novas culturas e fazer amizades pelo mundo.', 'Porto Alegre, RS', '[\"Portugu√™s\", \"Ingl√™s\", \"Espanhol\"]', '[\"Aventura\", \"Cultura\", \"Gastronomia\", \"Natureza\"]', '[\"aventura\", \"culturais\", \"urbanas\"]', TRUE, 4.8, 23),\n      ('maria', ?, 'maria@teste.com', 'Maria Silva', '(11) 98888-2222', 'Apaixonada por viagens culturais e experi√™ncias gastron√¥micas aut√™nticas.', 'S√£o Paulo, SP', '[\"Portugu√™s\", \"Ingl√™s\", \"Franc√™s\"]', '[\"Cultura\", \"Gastronomia\", \"Arte\", \"Hist√≥ria\"]', '[\"culturais\", \"gastron√¥micas\", \"urbanas\"]', TRUE, 4.9, 31),\n      ('carlos', ?, 'carlos@teste.com', 'Carlos Santos', '(21) 97777-3333', 'Explorador de praias paradis√≠acas e trilhas desafiadoras.', 'Rio de Janeiro, RJ', '[\"Portugu√™s\", \"Ingl√™s\"]', '[\"Praia\", \"Aventura\", \"Esportes\", \"Natureza\"]', '[\"praia\", \"aventura\", \"natureza\"]', TRUE, 4.7, 18)\n    ` as any, [tomPassword, mariaPassword, carlosPassword]);\n\n    // Create Brazilian activities\n    await db.execute(`\n      INSERT INTO activities (title, description, location, category, duration_hours, difficulty_level, price_range, image_url, rating, review_count) VALUES\n      ('Cristo Redentor e P√£o de A√ß√∫car', 'Tour completo pelos principais cart√µes postais do Rio de Janeiro com vista panor√¢mica da cidade maravilhosa.', 'Rio de Janeiro, RJ', 'pontos_turisticos', 8, 'f√°cil', 'R$ 150-300', 'https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=1200&h=800&fit=crop&q=85', 4.8, 145),\n      ('Trilha da Pedra Bonita', 'Caminhada moderada com vista espetacular da Barra da Tijuca e S√£o Conrado, ideal para o p√¥r do sol.', 'Rio de Janeiro, RJ', 'hiking', 4, 'moderada', 'R$ 50-100', 'https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=1200&h=800&fit=crop&q=85', 4.6, 89),\n      ('Passeio de Escuna em Angra dos Reis', 'Tour de barco pelas ilhas paradis√≠acas com paradas para banho em √°guas cristalinas.', 'Angra dos Reis, RJ', 'water_sports', 6, 'f√°cil', 'R$ 80-200', 'https://images.unsplash.com/photo-1544552866-d3ed42536cfd?w=1200&h=800&fit=crop&q=85', 4.7, 203),\n      ('Flutua√ß√£o no Rio da Prata', 'Experi√™ncia √∫nica de snorkeling em √°guas cristalinas com peixes coloridos em Bonito.', 'Bonito, MS', 'water_sports', 3, 'f√°cil', 'R$ 200-350', 'https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=1200&h=800&fit=crop&q=85', 4.9, 167),\n      ('Gruta do Lago Azul', 'Visita √† impressionante caverna com lago de √°guas azul-turquesa, patrim√¥nio natural de Bonito.', 'Bonito, MS', 'nature', 2, 'f√°cil', 'R$ 60-120', 'https://images.unsplash.com/photo-1582555172866-f73bb12a2ab3?w=1200&h=800&fit=crop&q=85', 4.8, 134),\n      ('Mini Mundo Gramado', 'Parque tem√°tico com r√©plicas em miniatura de famosos monumentos e paisagens europeias.', 'Gramado, RS', 'cultural', 3, 'f√°cil', 'R$ 40-80', 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=1200&h=800&fit=crop&q=85', 4.5, 98),\n      ('Tour de Vin√≠colas no Vale dos Vinhedos', 'Degusta√ß√£o de vinhos artesanais nas melhores vin√≠colas da Serra Ga√∫cha.', 'Bento Gon√ßalves, RS', 'food_tours', 6, 'f√°cil', 'R$ 120-250', 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1200&h=800&fit=crop&q=85', 4.7, 76),\n      ('Parque Nacional da Chapada Diamantina', 'Trekking pelas cachoeiras e forma√ß√µes rochosas mais belas da Bahia.', 'Len√ß√≥is, BA', 'hiking', 8, 'dif√≠cil', 'R$ 100-250', 'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=1200&h=800&fit=crop&q=85', 4.9, 112),\n      ('Passeio de Jangada em Maragogi', 'Tour pelas piscinas naturais de √°guas cristalinas no Caribe brasileiro.', 'Maragogi, AL', 'water_sports', 4, 'f√°cil', 'R$ 70-150', 'https://images.unsplash.com/photo-1544552866-d3ed42536cfd?w=1200&h=800&fit=crop&q=85', 4.8, 189),\n      ('Centro Hist√≥rico de Ouro Preto', 'Caminhada guiada pelas ruas hist√≥ricas e igrejas barrocas da cidade colonial.', 'Ouro Preto, MG', 'cultural', 4, 'f√°cil', 'R$ 30-80', 'https://images.unsplash.com/photo-1547036967-23d11aacaee0?w=1200&h=800&fit=crop&q=85', 4.6, 87)\n    ` as any);\n\n    // Create sample trips\n    await db.execute(`\n      INSERT INTO trips (creator_id, title, localidade, cover_image, start_date, end_date, budget, max_participants, description, travel_style, status) VALUES\n      (1, 'Aventura na Chapada Diamantina', 'Len√ß√≥is, BA', 'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=1200&h=800&fit=crop&q=85', '2025-08-15 08:00:00', '2025-08-20 18:00:00', 2500, 6, 'Explora√ß√£o completa da Chapada Diamantina com trilhas, cachoeiras e acampamentos sob as estrelas. Uma jornada inesquec√≠vel pela natureza baiana.', 'aventura', 'open'),\n      (2, 'Cultura e Gastronomia em Ouro Preto', 'Ouro Preto, MG', 'https://images.unsplash.com/photo-1547036967-23d11aacaee0?w=1200&h=800&fit=crop&q=85', '2025-09-10 09:00:00', '2025-09-13 17:00:00', 1800, 4, 'Imers√£o na hist√≥ria colonial brasileira com visitas a museus, igrejas barrocas e degusta√ß√£o da culin√°ria mineira tradicional.', 'culturais', 'open'),\n      (3, 'Para√≠so em Maragogi', 'Maragogi, AL', 'https://images.unsplash.com/photo-1544552866-d3ed42536cfd?w=1200&h=800&fit=crop&q=85', '2025-07-28 06:00:00', '2025-08-02 20:00:00', 3200, 5, 'Relaxamento total nas praias paradis√≠acas de Maragogi com mergulhos nas piscinas naturais e hospedagem p√© na areia.', 'praia', 'open'),\n      (1, 'Ecoturismo em Bonito', 'Bonito, MS', 'https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=1200&h=800&fit=crop&q=85', '2025-10-05 07:00:00', '2025-10-10 19:00:00', 2800, 4, 'Aventura aqu√°tica em Bonito com flutua√ß√£o em rios cristalinos, visita a grutas e observa√ß√£o da fauna local.', 'natureza', 'open'),\n      (2, 'Romance na Serra Ga√∫cha', 'Gramado, RS', 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=1200&h=800&fit=crop&q=85', '2025-11-20 10:00:00', '2025-11-24 16:00:00', 2200, 2, 'Escapada rom√¢ntica pela Serra Ga√∫cha com degusta√ß√£o de vinhos, passeios pela natureza e hospedagem em hotel boutique.', 'romanticas', 'open')\n    ` as any);\n\n    // Add trip participants\n    await db.execute(`\n      INSERT INTO trip_participants (trip_id, user_id, status) VALUES\n      (1, 1, 'accepted'),\n      (1, 2, 'accepted'),\n      (2, 2, 'accepted'),\n      (2, 1, 'accepted'),\n      (3, 3, 'accepted'),\n      (4, 1, 'accepted'),\n      (5, 2, 'accepted')\n    ` as any);\n\n    console.log(\"üéâ Banco de dados recriado com sucesso!\");\n    console.log(\"üìä Dados carregados:\");\n    console.log(\"   - 3 usu√°rios: tom, maria, carlos\");\n    console.log(\"   - 10 atividades brasileiras\");\n    console.log(\"   - 5 viagens de exemplo\");\n    console.log(\"   - Participantes configurados\");\n    console.log(\"üíª Login: tom / password123\");\n\n  } catch (error) {\n    console.error(\"‚ùå Erro durante recria√ß√£o:\", error);\n  }\n}\n\nrecreateDatabase();","size_bytes":15258},"server/reset-and-populate-database.ts":{"content":"import { drizzle } from \"drizzle-orm/mysql2\";\nimport mysql from \"mysql2/promise\";\nimport { \n  users, trips, tripParticipants, messages, tripRequests, \n  expenses, expenseSplits, userRatings, activities, \n  activityReviews, activityBudgetProposals, referralCodes \n} from \"../shared/schema\";\nimport * as crypto from \"crypto\";\n\n// Hash password function\nfunction hashPassword(password: string): Promise<string> {\n  return new Promise((resolve, reject) => {\n    const salt = crypto.randomBytes(16).toString('hex');\n    crypto.scrypt(password, salt, 64, (err, derivedKey) => {\n      if (err) reject(err);\n      resolve(derivedKey.toString('hex') + '.' + salt);\n    });\n  });\n}\n\nconst connection = await mysql.createConnection({\n  host: process.env.DB_HOST || \"srv1661.hstgr.io\",\n  user: process.env.DB_USER || \"u298726655_partiutrip\",\n  password: process.env.DB_PASSWORD || \"PartiuTrip2024!\",\n  database: process.env.DB_NAME || \"u298726655_partiutrip\",\n  ssl: undefined\n});\n\n// Remove the global connection and db initialization\n\nasync function dropAllTables(connection: any) {\n  console.log(\"üóëÔ∏è Removendo todas as tabelas...\");\n  \n  const tables = [\n    'expense_splits', 'expenses', 'user_ratings', 'activity_reviews', \n    'activity_budget_proposals', 'trip_requests', 'messages', \n    'trip_participants', 'trips', 'activities', 'referral_codes', 'users'\n  ];\n  \n  for (const table of tables) {\n    try {\n      await connection.execute(`DROP TABLE IF EXISTS ${table}`);\n      console.log(`‚úÖ Tabela ${table} removida`);\n    } catch (error) {\n      console.log(`‚ö†Ô∏è Erro ao remover ${table}:`, error);\n    }\n  }\n}\n\nasync function createTables(connection: any) {\n  console.log(\"üèóÔ∏è Criando todas as tabelas...\");\n  \n  // Criar tabela de usu√°rios\n  await connection.execute(`\n    CREATE TABLE users (\n      id INT AUTO_INCREMENT PRIMARY KEY,\n      username VARCHAR(255) NOT NULL UNIQUE,\n      password TEXT NOT NULL,\n      email VARCHAR(255) NOT NULL UNIQUE,\n      full_name VARCHAR(255) NOT NULL,\n      phone VARCHAR(20) NOT NULL,\n      bio TEXT,\n      location VARCHAR(255),\n      profile_photo TEXT,\n      languages JSON,\n      interests JSON,\n      travel_styles JSON,\n      referred_by VARCHAR(50),\n      is_verified BOOLEAN DEFAULT FALSE NOT NULL,\n      verification_method VARCHAR(50),\n      average_rating DECIMAL(3,2) DEFAULT 5.00,\n      total_ratings INT DEFAULT 0 NOT NULL,\n      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL\n    )\n  `);\n\n  // Criar tabela de viagens\n  await connection.execute(`\n    CREATE TABLE trips (\n      id INT AUTO_INCREMENT PRIMARY KEY,\n      creator_id INT NOT NULL,\n      title VARCHAR(255) NOT NULL,\n      localidade VARCHAR(255) NOT NULL,\n      cover_image TEXT,\n      start_date TIMESTAMP NOT NULL,\n      end_date TIMESTAMP NOT NULL,\n      budget INT,\n      budget_breakdown JSON,\n      max_participants INT NOT NULL,\n      current_participants INT DEFAULT 1 NOT NULL,\n      description TEXT NOT NULL,\n      travel_style VARCHAR(100) NOT NULL,\n      shared_costs JSON,\n      planned_activities JSON,\n      status VARCHAR(50) DEFAULT 'open' NOT NULL,\n      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n      FOREIGN KEY (creator_id) REFERENCES users(id)\n    )\n  `);\n\n  // Criar tabela de participantes\n  await connection.execute(`\n    CREATE TABLE trip_participants (\n      id INT AUTO_INCREMENT PRIMARY KEY,\n      trip_id INT NOT NULL,\n      user_id INT NOT NULL,\n      status VARCHAR(50) DEFAULT 'pending' NOT NULL,\n      joined_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n      FOREIGN KEY (trip_id) REFERENCES trips(id),\n      FOREIGN KEY (user_id) REFERENCES users(id)\n    )\n  `);\n\n  // Criar tabela de mensagens\n  await connection.execute(`\n    CREATE TABLE messages (\n      id INT AUTO_INCREMENT PRIMARY KEY,\n      trip_id INT NOT NULL,\n      sender_id INT NOT NULL,\n      content TEXT NOT NULL,\n      sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n      FOREIGN KEY (trip_id) REFERENCES trips(id),\n      FOREIGN KEY (sender_id) REFERENCES users(id)\n    )\n  `);\n\n  // Criar tabela de solicita√ß√µes\n  await connection.execute(`\n    CREATE TABLE trip_requests (\n      id INT AUTO_INCREMENT PRIMARY KEY,\n      trip_id INT NOT NULL,\n      user_id INT NOT NULL,\n      message TEXT,\n      status VARCHAR(50) DEFAULT 'pending' NOT NULL,\n      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n      FOREIGN KEY (trip_id) REFERENCES trips(id),\n      FOREIGN KEY (user_id) REFERENCES users(id)\n    )\n  `);\n\n  // Criar tabela de atividades\n  await connection.execute(`\n    CREATE TABLE activities (\n      id INT AUTO_INCREMENT PRIMARY KEY,\n      title VARCHAR(255) NOT NULL,\n      description TEXT NOT NULL,\n      location VARCHAR(255) NOT NULL,\n      category VARCHAR(100) NOT NULL,\n      duration_hours INT NOT NULL,\n      difficulty_level VARCHAR(50) NOT NULL,\n      price_range VARCHAR(50) NOT NULL,\n      image_url TEXT,\n      rating DECIMAL(3,2) DEFAULT 0.00,\n      review_count INT DEFAULT 0,\n      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL\n    )\n  `);\n\n  // Criar outras tabelas necess√°rias\n  await connection.execute(`\n    CREATE TABLE expenses (\n      id INT AUTO_INCREMENT PRIMARY KEY,\n      trip_id INT NOT NULL,\n      paid_by INT NOT NULL,\n      amount DECIMAL(10,2) NOT NULL,\n      description TEXT NOT NULL,\n      category VARCHAR(100) DEFAULT 'other' NOT NULL,\n      receipt TEXT,\n      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n      settled_at TIMESTAMP,\n      FOREIGN KEY (trip_id) REFERENCES trips(id),\n      FOREIGN KEY (paid_by) REFERENCES users(id)\n    )\n  `);\n\n  await connection.execute(`\n    CREATE TABLE expense_splits (\n      id INT AUTO_INCREMENT PRIMARY KEY,\n      expense_id INT NOT NULL,\n      user_id INT NOT NULL,\n      amount DECIMAL(10,2) NOT NULL,\n      paid BOOLEAN DEFAULT FALSE NOT NULL,\n      settled_at TIMESTAMP,\n      FOREIGN KEY (expense_id) REFERENCES expenses(id),\n      FOREIGN KEY (user_id) REFERENCES users(id)\n    )\n  `);\n\n  await connection.execute(`\n    CREATE TABLE user_ratings (\n      id INT AUTO_INCREMENT PRIMARY KEY,\n      trip_id INT NOT NULL,\n      rated_user_id INT NOT NULL,\n      rater_user_id INT NOT NULL,\n      rating INT NOT NULL,\n      comment TEXT,\n      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n      FOREIGN KEY (trip_id) REFERENCES trips(id),\n      FOREIGN KEY (rated_user_id) REFERENCES users(id),\n      FOREIGN KEY (rater_user_id) REFERENCES users(id)\n    )\n  `);\n\n  await connection.execute(`\n    CREATE TABLE activity_reviews (\n      id INT AUTO_INCREMENT PRIMARY KEY,\n      activity_id INT NOT NULL,\n      user_id INT NOT NULL,\n      rating INT NOT NULL,\n      comment TEXT,\n      photos JSON,\n      visit_date DATE,\n      helpful_count INT DEFAULT 0,\n      is_verified BOOLEAN DEFAULT FALSE,\n      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n      FOREIGN KEY (activity_id) REFERENCES activities(id),\n      FOREIGN KEY (user_id) REFERENCES users(id)\n    )\n  `);\n\n  await connection.execute(`\n    CREATE TABLE activity_budget_proposals (\n      id INT AUTO_INCREMENT PRIMARY KEY,\n      activity_id INT NOT NULL,\n      title VARCHAR(255) NOT NULL,\n      description TEXT,\n      price_per_person DECIMAL(10,2) NOT NULL,\n      currency VARCHAR(3) DEFAULT 'BRL' NOT NULL,\n      inclusions JSON,\n      exclusions JSON,\n      vote_count INT DEFAULT 0,\n      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n      FOREIGN KEY (activity_id) REFERENCES activities(id)\n    )\n  `);\n\n  await connection.execute(`\n    CREATE TABLE referral_codes (\n      id INT AUTO_INCREMENT PRIMARY KEY,\n      code VARCHAR(50) NOT NULL UNIQUE,\n      user_id INT,\n      type VARCHAR(50) NOT NULL,\n      discount_percentage INT DEFAULT 0,\n      max_uses INT DEFAULT 1,\n      current_uses INT DEFAULT 0,\n      expires_at TIMESTAMP,\n      is_active BOOLEAN DEFAULT TRUE,\n      created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,\n      FOREIGN KEY (user_id) REFERENCES users(id)\n    )\n  `);\n\n  console.log(\"‚úÖ Todas as tabelas criadas com sucesso!\");\n}\n\nasync function insertInitialData(connection: any) {\n  console.log(\"üìä Inserindo dados iniciais...\");\n\n  // Criar usu√°rios de teste\n  const tomPassword = await hashPassword(\"password123\");\n  const mariaPassword = await hashPassword(\"password123\");\n  const carlosPassword = await hashPassword(\"password123\");\n\n  await connection.execute(`\n    INSERT INTO users (username, password, email, full_name, phone, bio, location, languages, interests, travel_styles, is_verified, average_rating, total_ratings) VALUES\n    ('tom', ?, 'tom@teste.com', 'Tom Tubin', '(51) 99999-1111', 'Aventureiro nato, amo conhecer novas culturas e fazer amizades pelo mundo.', 'Porto Alegre, RS', '[\"Portugu√™s\", \"Ingl√™s\", \"Espanhol\"]', '[\"Aventura\", \"Cultura\", \"Gastronomia\", \"Natureza\"]', '[\"aventura\", \"culturais\", \"urbanas\"]', TRUE, 4.8, 23),\n    ('maria', ?, 'maria@teste.com', 'Maria Silva', '(11) 98888-2222', 'Apaixonada por viagens culturais e experi√™ncias gastron√¥micas aut√™nticas.', 'S√£o Paulo, SP', '[\"Portugu√™s\", \"Ingl√™s\", \"Franc√™s\"]', '[\"Cultura\", \"Gastronomia\", \"Arte\", \"Hist√≥ria\"]', '[\"culturais\", \"gastron√¥micas\", \"urbanas\"]', TRUE, 4.9, 31),\n    ('carlos', ?, 'carlos@teste.com', 'Carlos Santos', '(21) 97777-3333', 'Explorador de praias paradis√≠acas e trilhas desafiadoras.', 'Rio de Janeiro, RJ', '[\"Portugu√™s\", \"Ingl√™s\"]', '[\"Praia\", \"Aventura\", \"Esportes\", \"Natureza\"]', '[\"praia\", \"aventura\", \"natureza\"]', TRUE, 4.7, 18)\n  `, [tomPassword, mariaPassword, carlosPassword]);\n\n  // Criar atividades brasileiras\n  await connection.execute(`\n    INSERT INTO activities (title, description, location, category, duration_hours, difficulty_level, price_range, image_url, rating, review_count) VALUES\n    ('Cristo Redentor e P√£o de A√ß√∫car', 'Tour completo pelos principais cart√µes postais do Rio de Janeiro com vista panor√¢mica da cidade maravilhosa.', 'Rio de Janeiro, RJ', 'pontos_turisticos', 8, 'f√°cil', 'R$ 150-300', 'https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=1200&h=800&fit=crop&q=85', 4.8, 145),\n    ('Trilha da Pedra Bonita', 'Caminhada moderada com vista espetacular da Barra da Tijuca e S√£o Conrado, ideal para o p√¥r do sol.', 'Rio de Janeiro, RJ', 'hiking', 4, 'moderada', 'R$ 50-100', 'https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?w=1200&h=800&fit=crop&q=85', 4.6, 89),\n    ('Passeio de Escuna em Angra dos Reis', 'Tour de barco pelas ilhas paradis√≠acas com paradas para banho em √°guas cristalinas.', 'Angra dos Reis, RJ', 'water_sports', 6, 'f√°cil', 'R$ 80-200', 'https://images.unsplash.com/photo-1544552866-d3ed42536cfd?w=1200&h=800&fit=crop&q=85', 4.7, 203),\n    ('Flutua√ß√£o no Rio da Prata', 'Experi√™ncia √∫nica de snorkeling em √°guas cristalinas com peixes coloridos em Bonito.', 'Bonito, MS', 'water_sports', 3, 'f√°cil', 'R$ 200-350', 'https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=1200&h=800&fit=crop&q=85', 4.9, 167),\n    ('Gruta do Lago Azul', 'Visita √† impressionante caverna com lago de √°guas azul-turquesa, patrim√¥nio natural de Bonito.', 'Bonito, MS', 'nature', 2, 'f√°cil', 'R$ 60-120', 'https://images.unsplash.com/photo-1582555172866-f73bb12a2ab3?w=1200&h=800&fit=crop&q=85', 4.8, 134),\n    ('Mini Mundo Gramado', 'Parque tem√°tico com r√©plicas em miniatura de famosos monumentos e paisagens europeias.', 'Gramado, RS', 'cultural', 3, 'f√°cil', 'R$ 40-80', 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=1200&h=800&fit=crop&q=85', 4.5, 98),\n    ('Tour de Vin√≠colas no Vale dos Vinhedos', 'Degusta√ß√£o de vinhos artesanais nas melhores vin√≠colas da Serra Ga√∫cha.', 'Bento Gon√ßalves, RS', 'food_tours', 6, 'f√°cil', 'R$ 120-250', 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1200&h=800&fit=crop&q=85', 4.7, 76),\n    ('Parque Nacional da Chapada Diamantina', 'Trekking pelas cachoeiras e forma√ß√µes rochosas mais belas da Bahia.', 'Len√ß√≥is, BA', 'hiking', 8, 'dif√≠cil', 'R$ 100-250', 'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=1200&h=800&fit=crop&q=85', 4.9, 112),\n    ('Passeio de Jangada em Maragogi', 'Tour pelas piscinas naturais de √°guas cristalinas no Caribe brasileiro.', 'Maragogi, AL', 'water_sports', 4, 'f√°cil', 'R$ 70-150', 'https://images.unsplash.com/photo-1544552866-d3ed42536cfd?w=1200&h=800&fit=crop&q=85', 4.8, 189),\n    ('Centro Hist√≥rico de Ouro Preto', 'Caminhada guiada pelas ruas hist√≥ricas e igrejas barrocas da cidade colonial.', 'Ouro Preto, MG', 'cultural', 4, 'f√°cil', 'R$ 30-80', 'https://images.unsplash.com/photo-1547036967-23d11aacaee0?w=1200&h=800&fit=crop&q=85', 4.6, 87)\n  `);\n\n  // Criar viagens de exemplo\n  await connection.execute(`\n    INSERT INTO trips (creator_id, title, localidade, cover_image, start_date, end_date, budget, max_participants, description, travel_style, status) VALUES\n    (1, 'Aventura na Chapada Diamantina', 'Len√ß√≥is, BA', 'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=1200&h=800&fit=crop&q=85', '2025-08-15 08:00:00', '2025-08-20 18:00:00', 2500, 6, 'Explora√ß√£o completa da Chapada Diamantina com trilhas, cachoeiras e acampamentos sob as estrelas. Uma jornada inesquec√≠vel pela natureza baiana.', 'aventura', 'open'),\n    (2, 'Cultura e Gastronomia em Ouro Preto', 'Ouro Preto, MG', 'https://images.unsplash.com/photo-1547036967-23d11aacaee0?w=1200&h=800&fit=crop&q=85', '2025-09-10 09:00:00', '2025-09-13 17:00:00', 1800, 4, 'Imers√£o na hist√≥ria colonial brasileira com visitas a museus, igrejas barrocas e degusta√ß√£o da culin√°ria mineira tradicional.', 'culturais', 'open'),\n    (3, 'Para√≠so em Maragogi', 'Maragogi, AL', 'https://images.unsplash.com/photo-1544552866-d3ed42536cfd?w=1200&h=800&fit=crop&q=85', '2025-07-28 06:00:00', '2025-08-02 20:00:00', 3200, 5, 'Relaxamento total nas praias paradis√≠acas de Maragogi com mergulhos nas piscinas naturais e hospedagem p√© na areia.', 'praia', 'open'),\n    (1, 'Ecoturismo em Bonito', 'Bonito, MS', 'https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=1200&h=800&fit=crop&q=85', '2025-10-05 07:00:00', '2025-10-10 19:00:00', 2800, 4, 'Aventura aqu√°tica em Bonito com flutua√ß√£o em rios cristalinos, visita a grutas e observa√ß√£o da fauna local.', 'natureza', 'open'),\n    (2, 'Romance na Serra Ga√∫cha', 'Gramado, RS', 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=1200&h=800&fit=crop&q=85', '2025-11-20 10:00:00', '2025-11-24 16:00:00', 2200, 2, 'Escapada rom√¢ntica pela Serra Ga√∫cha com degusta√ß√£o de vinhos, passeios pela natureza e hospedagem em hotel boutique.', 'romanticas', 'open')\n  `);\n\n  // Adicionar participantes √†s viagens\n  await connection.execute(`\n    INSERT INTO trip_participants (trip_id, user_id, status) VALUES\n    (1, 1, 'accepted'),\n    (1, 2, 'accepted'),\n    (1, 3, 'pending'),\n    (2, 2, 'accepted'),\n    (2, 1, 'accepted'),\n    (3, 3, 'accepted'),\n    (3, 1, 'pending'),\n    (4, 1, 'accepted'),\n    (4, 3, 'accepted'),\n    (5, 2, 'accepted')\n  `);\n\n  // Criar propostas de or√ßamento para atividades\n  await connection.execute(`\n    INSERT INTO activity_budget_proposals (activity_id, title, description, price_per_person, inclusions, exclusions, vote_count) VALUES\n    (1, 'Pacote Econ√¥mico', 'Tour b√°sico aos principais pontos tur√≠sticos', 180.00, '[\"Transporte\", \"Guia local\", \"Seguro\"]', '[\"Alimenta√ß√£o\", \"Entrada no P√£o de A√ß√∫car\"]', 12),\n    (1, 'Pacote Completo', 'Experi√™ncia completa com todas as atra√ß√µes', 320.00, '[\"Transporte\", \"Guia especializado\", \"Alimenta√ß√£o\", \"Entradas\", \"Seguro\"]', '[\"Hospedagem\"]', 8),\n    (2, 'Trilha Guiada', 'Caminhada com guia experiente e lanche', 85.00, '[\"Guia local\", \"Lanche\", \"Seguro\"]', '[\"Transporte\", \"Equipamentos\"]', 15),\n    (3, 'Passeio Tradicional', 'Tour de escuna com paradas nas ilhas', 120.00, '[\"Transporte mar√≠timo\", \"Guia\", \"Seguro\"]', '[\"Alimenta√ß√£o\", \"Equipamentos de mergulho\"]', 24),\n    (4, 'Flutua√ß√£o Premium', 'Experi√™ncia completa com equipamentos inclusos', 280.00, '[\"Equipamentos\", \"Guia especializado\", \"Lanche\", \"Transporte\", \"Seguro\"]', '[\"Hospedagem\"]', 18)\n  `);\n\n  // Criar algumas avalia√ß√µes de atividades\n  await connection.execute(`\n    INSERT INTO activity_reviews (activity_id, user_id, rating, comment, visit_date, helpful_count, is_verified) VALUES\n    (1, 2, 5, 'Vista espetacular! O Cristo Redentor √© realmente uma das maravilhas do mundo. Tour muito bem organizado.', '2025-06-15', 8, TRUE),\n    (1, 3, 4, 'Experi√™ncia incr√≠vel, mas muito movimentado. Recomendo ir bem cedo para evitar multid√µes.', '2025-06-20', 5, TRUE),\n    (2, 1, 5, 'Trilha maravilhosa com uma das melhores vistas do Rio! Perfeita para o p√¥r do sol.', '2025-06-25', 12, TRUE),\n    (3, 2, 5, 'Passeio fant√°stico! As √°guas de Angra s√£o cristalinas e o atendimento foi excelente.', '2025-07-01', 9, TRUE),\n    (4, 3, 5, 'Flutua√ß√£o incr√≠vel! A natureza de Bonito √© √∫nica no mundo. Experi√™ncia inesquec√≠vel!', '2025-07-10', 15, TRUE)\n  `);\n\n  // Criar c√≥digos de indica√ß√£o\n  await connection.execute(`\n    INSERT INTO referral_codes (code, user_id, type, discount_percentage, max_uses, current_uses, is_active) VALUES\n    ('PARTIU-TOM01', 1, 'user_referral', 10, 5, 0, TRUE),\n    ('PARTIU-MARIA02', 2, 'user_referral', 10, 5, 1, TRUE),\n    ('PARTIU-CARLOS03', 3, 'user_referral', 10, 5, 0, TRUE),\n    ('WELCOME2025', NULL, 'promotional', 15, 100, 23, TRUE),\n    ('AVENTURA20', NULL, 'promotional', 20, 50, 8, TRUE)\n  `);\n\n  console.log(\"‚úÖ Dados iniciais inseridos com sucesso!\");\n}\n\nasync function main() {\n  let connection;\n  try {\n    console.log(\"üöÄ Iniciando recria√ß√£o do banco de dados MySQL...\");\n    \n    connection = await mysql.createConnection({\n      host: process.env.DB_HOST || \"srv1661.hstgr.io\",\n      user: process.env.DB_USER || \"u298726655_partiutrip\",\n      password: process.env.DB_PASSWORD || \"PartiuTrip2024!\",\n      database: process.env.DB_NAME || \"u298726655_partiutrip\",\n      ssl: undefined\n    });\n    \n    await dropAllTables(connection);\n    await createTables(connection);\n    await insertInitialData(connection);\n    \n    console.log(\"üéâ Banco de dados MySQL recriado com sucesso!\");\n    console.log(\"üìä Dados dispon√≠veis:\");\n    console.log(\"   - 3 usu√°rios (tom, maria, carlos)\");\n    console.log(\"   - 10 atividades brasileiras\");\n    console.log(\"   - 5 viagens de exemplo\");\n    console.log(\"   - Participantes e avalia√ß√µes\");\n    console.log(\"   - C√≥digos de indica√ß√£o ativos\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro durante a recria√ß√£o:\", error);\n  } finally {\n    if (connection) await connection.end();\n    process.exit(0);\n  }\n}\n\nmain();","size_bytes":18648},"server/reset-database.ts":{"content":"\nimport { db } from \"./db\";\nimport mysql from \"mysql2/promise\";\n\n// Configura√ß√£o do banco MySQL (mesma do db.ts)\nconst connection = mysql.createPool({\n  host: 'srv1661.hstgr.io',\n  port: 3306,\n  user: 'u905571261_trip',\n  password: 'Dracarys23@',\n  database: 'u905571261_trip',\n  waitForConnections: true,\n  connectionLimit: 10,\n  queueLimit: 0,\n  ssl: false\n});\n\nexport async function resetDatabase() {\n  console.log(\"üóëÔ∏è Iniciando reset completo do banco de dados...\");\n  \n  try {\n    // Desabilitar verifica√ß√£o de chaves estrangeiras\n    await connection.execute(\"SET FOREIGN_KEY_CHECKS = 0\");\n    console.log(\"üîì Chaves estrangeiras desabilitadas\");\n\n    // Lista de todas as tabelas na ordem correta para evitar conflitos\n    const tables = [\n      'activity_budget_proposals',\n      'trip_activities', \n      'activity_bookings',\n      'activity_reviews',\n      'activities',\n      'expense_splits',\n      'expenses',\n      'verification_requests',\n      'destination_ratings',\n      'user_ratings',\n      'messages',\n      'trip_requests',\n      'trip_participants',\n      'trips',\n      'users'\n    ];\n\n    // Truncar todas as tabelas (limpa dados e reseta AUTO_INCREMENT)\n    for (const table of tables) {\n      try {\n        await connection.execute(`TRUNCATE TABLE ${table}`);\n        console.log(`‚úÖ Tabela ${table} zerada e ID resetado`);\n      } catch (error) {\n        console.log(`‚ö†Ô∏è Tabela ${table} n√£o encontrada ou erro: ${error.message}`);\n      }\n    }\n\n    // Reabilitar verifica√ß√£o de chaves estrangeiras\n    await connection.execute(\"SET FOREIGN_KEY_CHECKS = 1\");\n    console.log(\"üîí Chaves estrangeiras reabilitadas\");\n\n    // Verificar se as tabelas est√£o vazias\n    console.log(\"üîç Verificando status das tabelas...\");\n    for (const table of tables) {\n      try {\n        const [rows] = await connection.execute(`SELECT COUNT(*) as count FROM ${table}`);\n        const count = (rows as any)[0].count;\n        console.log(`üìä Tabela ${table}: ${count} registros`);\n      } catch (error) {\n        console.log(`‚ö†Ô∏è Erro ao verificar ${table}: ${error.message}`);\n      }\n    }\n\n    console.log(\"‚úÖ Reset do banco de dados conclu√≠do com sucesso!\");\n    console.log(\"üÜï Todos os IDs foram resetados para come√ßar em 1\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro durante o reset do banco:\", error);\n    throw error;\n  }\n}\n\n// Executar se chamado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  resetDatabase()\n    .then(() => {\n      console.log(\"üéâ Reset conclu√≠do! O banco est√° limpo e pronto para novos dados.\");\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error(\"üí• Falha no reset:\", error);\n      process.exit(1);\n    });\n}\n","size_bytes":2747},"server/routes.ts":{"content":"\nimport type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\n\nimport { setupAuth } from \"./auth\";\nimport { storage } from \"./storage\";\nimport { syncTripParticipants } from \"./sync-participants.js\";\nimport { insertTripSchema, insertMessageSchema, insertTripRequestSchema, insertExpenseSchema, insertExpenseSplitSchema, insertUserRatingSchema, insertDestinationRatingSchema, insertVerificationRequestSchema, insertActivitySchema, insertActivityReviewSchema, insertActivityBookingSchema, insertActivityBudgetProposalSchema, insertTripActivitySchema, insertRatingReportSchema } from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { activityReviews, activities, activityBudgetProposalVotes, activityBudgetProposals, users, userRatings, destinationRatings, ratingReports, activityRatingHelpfulVotes, referralCodes, interestList } from \"@shared/schema\";\nimport { eq, and, desc, sql, ne } from \"drizzle-orm\";\nimport { z } from \"zod\";\n\n// Middleware para verificar autentica√ß√£o\nfunction requireAuth(req: any, res: any, next: any) {\n  console.log(`üîê Verificando autentica√ß√£o:`, {\n    isAuthenticated: req.isAuthenticated ? req.isAuthenticated() : false,\n    hasUser: !!req.user,\n    sessionID: req.sessionID,\n    session: !!req.session,\n    sessionData: req.session,\n    cookies: req.cookies,\n    url: req.url\n  });\n  \n  // Check both standard authentication and manual authentication\n  const isAuth = (req.isAuthenticated && req.isAuthenticated()) || !!req.user;\n  \n  if (!isAuth || !req.user) {\n    console.log(`‚ùå Acesso negado - usu√°rio n√£o autenticado`);\n    return res.status(401).json({ message: \"N√£o autorizado\" });\n  }\n  \n  console.log(`‚úÖ Usu√°rio autenticado: ${req.user.username} (ID: ${req.user.id})`);\n  next();\n}\n\nexport function registerRoutes(app: Express): Server {\n  setupAuth(app);\n\n  // Google Maps API key\n  app.get(\"/api/google-maps-key\", (req, res) => {\n    res.json({ apiKey: process.env.GOOGLE_MAPS_API_KEY });\n  });\n\n  // Destinations routes\n  app.get(\"/api/destinations\", async (req, res) => {\n    try {\n      const { search } = req.query;\n      const destinations = await storage.getDestinations(search as string);\n      res.json(destinations);\n    } catch (error) {\n      console.error('Erro ao buscar destinos:', error);\n      res.status(500).json({ message: \"Erro ao buscar destinos\" });\n    }\n  });\n\n  // Trip routes\n  app.get(\"/api/trips\", async (req, res) => {\n    try {\n      const { destination, start_date, end_date, budget, travelStyle } = req.query;\n      const filters: any = {};\n      \n      if (destination) filters.destination = destination as string;\n      if (start_date) filters.start_date = new Date(start_date as string);\n      if (end_date) filters.end_date = new Date(end_date as string);\n      if (budget) filters.budget = parseInt(budget as string);\n      if (travelStyle) filters.travel_style = travelStyle as string;\n      \n      const trips = await storage.getAllTrips();\n      \n      // Include creator info for each trip\n      const tripsWithCreators = await Promise.all(\n        trips.map(async (trip) => {\n          const creator = await storage.getUserById(trip.creator_id);\n          return { ...trip, creator };\n        })\n      );\n      \n      res.json(tripsWithCreators);\n    } catch (error) {\n      console.error('Erro ao buscar viagens:', error);\n      res.status(500).json({ message: \"Erro ao buscar viagens\" });\n    }\n  });\n\n  app.get(\"/api/trips/:id\", async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      const trip = await storage.getTripById(trip_id);\n      \n      if (!trip) {\n        return res.status(404).json({ message: \"Viagem n√£o encontrada\" });\n      }\n      \n      const creator = await storage.getUserById(trip.creator_id);\n      const participants = await storage.getTripParticipants(trip_id);\n      \n      // Check if user has a pending request\n      let userRequest = null;\n      if (req.isAuthenticated() && req.user) {\n        const allRequests = await storage.getTripRequests(trip_id);\n        userRequest = allRequests.find(r => r.user_id === req.user!.id && r.status === 'pending');\n      }\n      \n      res.json({ ...trip, creator, participants, userRequest });\n    } catch (error) {\n      console.error('Erro ao buscar viagem:', error);\n      res.status(500).json({ message: \"Erro ao buscar viagem\" });\n    }\n  });\n\n  app.post(\"/api/trips\", requireAuth, async (req, res) => {\n    try {\n      console.log('Dados recebidos para cria√ß√£o de viagem:', req.body);\n      console.log('Usu√°rio autenticado:', req.user);\n      \n      // Validar dados da viagem\n      const tripData = insertTripSchema.parse(req.body);\n      \n      // Criar viagem\n      const trip = await storage.createTrip(tripData);\n      \n      console.log('Viagem criada com sucesso:', trip);\n      res.status(201).json(trip);\n    } catch (error) {\n      console.error('Erro ao criar viagem:', error);\n      res.status(400).json({ \n        message: \"Erro ao criar viagem\", \n        details: error instanceof Error ? error.message : String(error) \n      });\n    }\n  });\n\n  // Update a trip (only creator can update)\n  app.patch(\"/api/trips/:id\", requireAuth, async (req: any, res: any) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      const updates = req.body;\n\n      // Get the trip to verify ownership\n      const trip = await storage.getTripById(trip_id);\n      if (!trip) {\n        return res.status(404).json({ message: \"Viagem n√£o encontrada\" });\n      }\n\n      // Check if user is creator or accepted participant\n      const isCreator = trip.creator_id === req.user.id;\n      const participants = await storage.getTripParticipants(trip_id);\n      const isAcceptedParticipant = participants.some(\n        (p: any) => p.user_id === req.user.id && p.status === 'accepted'\n      );\n      \n      if (!isCreator && !isAcceptedParticipant) {\n        return res.status(403).json({ message: \"Apenas o criador e participantes aceitos podem editar a viagem\" });\n      }\n\n      // Validate that max_participants is not less than current participants\n      if (updates.max_participants && updates.max_participants < trip.current_participants) {\n        return res.status(400).json({ \n          message: `M√°ximo de participantes n√£o pode ser menor que ${trip.current_participants} (participantes atuais)` \n        });\n      }\n\n      const updatedTrip = await storage.updateTrip(trip_id, updates);\n      if (!updatedTrip) {\n        return res.status(404).json({ message: \"Viagem n√£o encontrada\" });\n      }\n\n      res.json(updatedTrip);\n    } catch (error: any) {\n      console.error(\"‚ùå Erro ao atualizar viagem:\", error);\n      res.status(400).json({ \n        message: error instanceof Error ? error.message : \"Erro ao atualizar viagem\" \n      });\n    }\n  });\n\n  // Delete a trip (only creator can delete, and only if no other participants)\n  app.delete(\"/api/trips/:id\", requireAuth, async (req: any, res: any) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n\n      // Get the trip to verify ownership and participants\n      const trip = await storage.getTripById(trip_id);\n      if (!trip) {\n        return res.status(404).json({ message: \"Viagem n√£o encontrada\" });\n      }\n\n      if (trip.creator_id !== req.user.id) {\n        return res.status(403).json({ message: \"Apenas o criador pode excluir a viagem\" });\n      }\n\n      if (trip.current_participants > 1) {\n        return res.status(400).json({ \n          message: \"N√£o √© poss√≠vel excluir viagem com outros participantes. Use a op√ß√£o 'Cancelar' para transferir a organiza√ß√£o.\" \n        });\n      }\n\n      const deleted = await storage.deleteTrip(trip_id);\n      if (!deleted) {\n        return res.status(404).json({ message: \"Viagem n√£o encontrada\" });\n      }\n\n      res.json({ message: \"Viagem exclu√≠da com sucesso\" });\n    } catch (error: any) {\n      console.error(\"‚ùå Erro ao excluir viagem:\", error);\n      res.status(400).json({ \n        message: error instanceof Error ? error.message : \"Erro ao excluir viagem\" \n      });\n    }\n  });\n\n\n\n  app.get(\"/api/my-trips\", requireAuth, async (req, res) => {\n    try {\n      console.log(`üîç Buscando viagens do usu√°rio ${req.user!.id} (${req.user!.username})`);\n      \n      const createdTrips = await storage.getTripsByCreator(req.user!.id);\n      const participatingTrips = await storage.getTripsByParticipant(req.user!.id);\n      \n      console.log(`üìä Viagens encontradas: ${createdTrips.length} criadas, ${participatingTrips.length} participando`);\n      \n      // Add creator info for participating trips\n      const participatingTripsWithCreators = await Promise.all(\n        participatingTrips.map(async (trip) => {\n          const creator = await storage.getUserById(trip.creator_id);\n          return { ...trip, creator };\n        })\n      );\n      \n      res.json({ \n        created: createdTrips, \n        participating: participatingTripsWithCreators \n      });\n    } catch (error) {\n      console.error('Erro ao buscar suas viagens:', error);\n      res.status(500).json({ message: \"Erro ao buscar suas viagens\" });\n    }\n  });\n\n  // Update trip cover image\n  app.patch(\"/api/trips/:id/cover-image\", requireAuth, async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      const { cover_image } = req.body;\n      \n      if (!cover_image) {\n        return res.status(400).json({ message: \"URL da imagem √© obrigat√≥ria\" });\n      }\n      \n      const trip = await storage.getTripById(trip_id);\n      if (!trip) {\n        return res.status(404).json({ message: \"Viagem n√£o encontrada\" });\n      }\n      \n      // Only trip creator can update cover image\n      if (trip.creator_id !== req.user!.id) {\n        return res.status(403).json({ message: \"Apenas o criador da viagem pode alterar a imagem\" });\n      }\n      \n      const updatedTrip = await storage.updateTrip(trip_id, { cover_image: cover_image });\n      res.json(updatedTrip);\n    } catch (error) {\n      console.error('Erro ao atualizar imagem da viagem:', error);\n      res.status(500).json({ message: \"Erro ao atualizar imagem da viagem\" });\n    }\n  });\n\n  // Update trip budget\n  app.patch(\"/api/trips/:id/budget\", requireAuth, async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      const { budget, budget_breakdown } = req.body;\n      \n      if (!budget || budget <= 0) {\n        return res.status(400).json({ message: \"Or√ßamento deve ser um valor positivo\" });\n      }\n      \n      const trip = await storage.getTripById(trip_id);\n      if (!trip) {\n        return res.status(404).json({ message: \"Viagem n√£o encontrada\" });\n      }\n      \n      // Only trip creator can update budget\n      if (trip.creator_id !== req.user!.id) {\n        return res.status(403).json({ message: \"Apenas o criador da viagem pode alterar o or√ßamento\" });\n      }\n      \n      const updatedTrip = await storage.updateTrip(trip_id, { budget, budget_breakdown });\n      res.json(updatedTrip);\n    } catch (error) {\n      console.error('Erro ao atualizar or√ßamento da viagem:', error);\n      res.status(500).json({ message: \"Erro ao atualizar or√ßamento da viagem\" });\n    }\n  });\n\n  // Admin endpoint: Fix creators as participants\n  app.post('/api/admin/fix-creators-participants', requireAuth, async (req, res) => {\n    try {\n      // Only allow verified users to run this fix\n      if (!req.user!.is_verified) {\n        return res.status(403).json({ message: 'Acesso negado. Apenas usu√°rios verificados podem executar esta corre√ß√£o.' });\n      }\n\n      const fixedCount = await storage.fixCreatorsAsParticipants();\n      \n      res.json({ \n        message: `Corre√ß√£o executada com sucesso! ${fixedCount} criadores foram adicionados como participantes.`,\n        fixedCount\n      });\n    } catch (error) {\n      console.error('‚ùå Erro na corre√ß√£o de criadores como participantes:', error);\n      res.status(500).json({ message: 'Erro interno do servidor ao executar corre√ß√£o.' });\n    }\n  });\n\n  // Trip request routes\n  app.post(\"/api/trips/:id/request\", requireAuth, async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      \n      // Parse only the message from request body\n      const { message } = req.body;\n      \n      const trip = await storage.getTripById(trip_id);\n      if (!trip) {\n        return res.status(404).json({ message: \"Viagem n√£o encontrada\" });\n      }\n      \n      if (trip.creator_id === req.user!.id) {\n        return res.status(400).json({ message: \"Voc√™ n√£o pode solicitar participa√ß√£o na sua pr√≥pria viagem\" });\n      }\n      \n      // Check if user already has a pending request\n      const existingRequests = await storage.getTripRequests(trip_id);\n      const userRequest = existingRequests.find(r => r.user_id === req.user!.id);\n      if (userRequest && userRequest.status === 'pending') {\n        return res.status(400).json({ message: \"Voc√™ j√° tem uma solicita√ß√£o pendente para esta viagem\" });\n      }\n      \n      const request = await storage.createTripRequest({ \n        message: message || \"\",\n        trip_id, \n        user_id: req.user!.id \n      });\n      \n      res.status(201).json(request);\n    } catch (error) {\n      console.error('Erro ao enviar solicita√ß√£o:', error);\n      res.status(400).json({ message: \"Erro ao enviar solicita√ß√£o\" });\n    }\n  });\n\n  app.get(\"/api/trips/:id/requests\", requireAuth, async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      const trip = await storage.getTripById(trip_id);\n      \n      if (!trip || trip.creator_id !== req.user!.id) {\n        return res.status(403).json({ message: \"Acesso negado\" });\n      }\n      \n      const requests = await storage.getTripRequests(trip_id);\n      res.json(requests);\n    } catch (error) {\n      console.error('Erro ao buscar solicita√ß√µes:', error);\n      res.status(500).json({ message: \"Erro ao buscar solicita√ß√µes\" });\n    }\n  });\n\n  app.patch(\"/api/trip-requests/:id\", requireAuth, async (req, res) => {\n    try {\n      const requestId = parseInt(req.params.id);\n      const { status } = req.body;\n      \n      if (!['accepted', 'rejected'].includes(status)) {\n        return res.status(400).json({ message: \"Status inv√°lido\" });\n      }\n      \n      const request = await storage.updateTripRequest(requestId, status);\n      if (!request) {\n        return res.status(404).json({ message: \"Solicita√ß√£o n√£o encontrada\" });\n      }\n      \n      // If accepted, add user to trip participants\n      if (status === 'accepted') {\n        await storage.addTripParticipant(request.trip_id, request.user_id);\n        \n        // Sync trip participant count based on actual accepted participants\n        await syncTripParticipants(request.trip_id);\n      }\n      \n      res.json(request);\n    } catch (error) {\n      console.error('Erro ao atualizar solicita√ß√£o:', error);\n      res.status(500).json({ message: \"Erro ao atualizar solicita√ß√£o\" });\n    }\n  });\n\n  // Get trip participants\n  app.get(\"/api/trips/:id/participants\", async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      \n      const trip = await storage.getTripById(trip_id);\n      if (!trip) {\n        return res.status(404).json({ message: \"Viagem n√£o encontrada\" });\n      }\n      \n      const participants = await storage.getTripParticipants(trip_id);\n      res.json(participants);\n    } catch (error) {\n      console.error('Erro ao buscar participantes:', error);\n      res.status(500).json({ message: \"Erro ao buscar participantes\" });\n    }\n  });\n\n  // Update trip planned activities\n  app.patch(\"/api/trips/:id/activities\", requireAuth, async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      const { planned_activities } = req.body;\n      \n      const trip = await storage.getTripById(trip_id);\n      if (!trip) {\n        return res.status(404).json({ message: \"Viagem n√£o encontrada\" });\n      }\n      \n      // Check if user is creator or participant\n      const isCreator = trip.creator_id === req.user!.id;\n      const participants = await storage.getTripParticipants(trip_id);\n      const isParticipant = participants.some(p => p.user_id === req.user!.id && p.status === 'accepted');\n      \n      if (!isCreator && !isParticipant) {\n        return res.status(403).json({ message: \"Voc√™ n√£o tem permiss√£o para editar as atividades desta viagem\" });\n      }\n      \n      const updatedTrip = await storage.updateTripActivities(trip_id, planned_activities);\n      res.json(updatedTrip);\n    } catch (error) {\n      console.error('Erro ao atualizar atividades:', error);\n      res.status(500).json({ message: \"Erro ao atualizar atividades\" });\n    }\n  });\n\n  // Remove participant from trip\n  app.delete(\"/api/trips/:id/participants/:userId\", requireAuth, async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      const userIdToRemove = parseInt(req.params.user_id || req.params.userId);\n      \n      const trip = await storage.getTripById(trip_id);\n      if (!trip) {\n        return res.status(404).json({ message: \"Viagem n√£o encontrada\" });\n      }\n      \n      // Verificar se o usu√°rio atual tem permiss√£o (√© o pr√≥prio participante ou o organizador)\n      const isOwnParticipation = req.user!.id === userIdToRemove;\n      const isOrganizer = trip.creator_id === req.user!.id;\n      \n      if (!isOwnParticipation && !isOrganizer) {\n        return res.status(403).json({ message: \"Voc√™ n√£o tem permiss√£o para remover este participante\" });\n      }\n      \n      // Verificar se o usu√°rio √© realmente um participante\n      const participants = await storage.getTripParticipants(trip_id);\n      const participant = participants.find(p => p.user_id === userIdToRemove && p.status === 'accepted');\n      \n      if (!participant) {\n        return res.status(404).json({ message: \"Participante n√£o encontrado nesta viagem\" });\n      }\n      \n      // Remover participante\n      await storage.removeTripParticipant(trip_id, userIdToRemove);\n      \n      // Atualizar contador de participantes\n      const updatedTrip = await storage.getTripById(trip_id);\n      if (updatedTrip && updatedTrip.status !== 'cancelled') {\n        // Sync trip participant count based on actual accepted participants\n        await syncTripParticipants(trip_id);\n      }\n      \n      res.json({ \n        message: isOwnParticipation ? \"Voc√™ saiu da viagem com sucesso\" : \"Participante removido com sucesso\",\n        tripStatus: updatedTrip?.status \n      });\n    } catch (error) {\n      console.error('Erro ao remover participante:', error);\n      res.status(500).json({ message: \"Erro ao remover participante\" });\n    }\n  });\n\n  // Message routes\n  app.get(\"/api/trips/:id/messages\", requireAuth, async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      console.log(`üì® Buscando mensagens para viagem ${trip_id} pelo usu√°rio ${req.user!.id}`);\n      \n      // Check if user is participant or creator of the trip\n      const trip = await storage.getTripById(trip_id);\n      if (!trip) {\n        console.log(`‚ùå Viagem ${trip_id} n√£o encontrada`);\n        return res.status(404).json({ message: \"Viagem n√£o encontrada\" });\n      }\n      \n      console.log(`‚úÖ Viagem encontrada: ${trip.title} (criador: ${trip.creator_id})`);\n      \n      const participants = await storage.getTripParticipants(trip_id);\n      console.log(`üë• Participantes da viagem:`, participants.map(p => ({ user_id: p.user_id, status: p.status })));\n      \n      const isParticipant = participants.some(p => p.user_id === req.user!.id && p.status === 'accepted');\n      const isCreator = trip.creator_id === req.user!.id;\n      \n      console.log(`üîê Verifica√ß√£o de acesso: isParticipant=${isParticipant}, isCreator=${isCreator}`);\n      \n      if (!isParticipant && !isCreator) {\n        console.log(`‚ùå Acesso negado para usu√°rio ${req.user!.id}`);\n        return res.status(403).json({ message: \"Acesso negado\" });\n      }\n      \n      const messages = await storage.getTripMessages(trip_id);\n      console.log(`‚úÖ ${messages.length} mensagens encontradas`);\n      res.json(messages);\n    } catch (error) {\n      console.error('Erro ao buscar mensagens:', error);\n      res.status(500).json({ message: \"Erro ao buscar mensagens\" });\n    }\n  });\n\n  app.post(\"/api/trips/:id/messages\", requireAuth, async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      const messageData = insertMessageSchema.parse(req.body);\n      \n      // Check if user is participant or creator of the trip\n      const trip = await storage.getTripById(trip_id);\n      if (!trip) {\n        return res.status(404).json({ message: \"Viagem n√£o encontrada\" });\n      }\n      \n      const participants = await storage.getTripParticipants(trip_id);\n      const isParticipant = participants.some(p => p.user_id === req.user!.id);\n      const isCreator = trip.creator_id === req.user!.id;\n      \n      if (!isParticipant && !isCreator) {\n        return res.status(403).json({ message: \"Acesso negado\" });\n      }\n      \n      const message = await storage.createMessage({ \n        ...messageData, \n        trip_id,\n        senderId: req.user!.id \n      });\n      \n      res.status(201).json(message);\n    } catch (error) {\n      console.error('Erro ao enviar mensagem:', error);\n      res.status(400).json({ message: \"Erro ao enviar mensagem\" });\n    }\n  });\n\n  // User profile routes\n  app.get(\"/api/users/:id\", async (req, res) => {\n    try {\n      const userId = parseInt(req.params.id);\n      const user = await storage.getUserById(userId);\n      \n      if (!user) {\n        return res.status(404).json({ message: \"Usu√°rio n√£o encontrado\" });\n      }\n      \n      // Remove sensitive information\n      const { password, ...userProfile } = user;\n      res.json(userProfile);\n    } catch (error) {\n      console.error('Erro ao buscar usu√°rio:', error);\n      res.status(500).json({ message: \"Erro ao buscar usu√°rio\" });\n    }\n  });\n\n  app.patch(\"/api/profile\", requireAuth, async (req, res) => {\n    try {\n      const updates = req.body;\n      delete updates.id;\n      delete updates.password;\n      delete updates.username;\n      delete updates.email;\n      \n      const updatedUser = await storage.updateUser(req.user!.id, updates);\n      if (!updatedUser) {\n        return res.status(404).json({ message: \"Usu√°rio n√£o encontrado\" });\n      }\n      \n      const { password, ...userProfile } = updatedUser;\n      res.json(userProfile);\n    } catch (error) {\n      console.error('Erro ao atualizar perfil:', error);\n      res.status(500).json({ message: \"Erro ao atualizar perfil\" });\n    }\n  });\n\n  // Expense routes\n  app.post(\"/api/trips/:id/expenses\", requireAuth, async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      console.log('Dados recebidos para cria√ß√£o de despesa:', req.body);\n      console.log('Usu√°rio autenticado:', req.user);\n      \n      const expenseData = insertExpenseSchema.parse({\n        ...req.body,\n        tripId: trip_id\n      });\n      \n      // Verify user is a participant of the trip\n      const participants = await storage.getTripParticipants(trip_id);\n      const isParticipant = participants.some(p => p.user_id === req.user!.id && p.status === 'accepted');\n      \n      if (!isParticipant) {\n        return res.status(403).json({ message: \"Voc√™ deve ser um participante da viagem para adicionar despesas\" });\n      }\n      \n      // Create the expense\n      const expense = await storage.createExpense({\n        ...expenseData,\n        paid_by: req.user!.id\n      });\n      \n      // Create splits based on selected participants\n      let splitParticipants: number[];\n      if (req.body.splitWith === 'all') {\n        // Split equally among all participants (including future ones)\n        splitParticipants = participants.filter(p => p.status === 'accepted').map(p => p.user_id);\n      } else {\n        splitParticipants = req.body.splitWith || participants.filter(p => p.status === 'accepted').map(p => p.user_id);\n      }\n      \n      const splitAmount = expenseData.amount / splitParticipants.length;\n      \n      console.log('Split participants:', splitParticipants);\n      console.log('Split amount per person:', splitAmount);\n      \n      const splitData = splitParticipants.map((user_id: number) => ({\n        user_id: user_id,\n        amount: splitAmount,\n        paid: user_id === req.user!.id // Payer's split is automatically marked as paid\n      }));\n      \n      console.log('Split data to create:', splitData);\n      \n      const splits = await storage.createExpenseSplits(expense.id, splitData);\n      \n      res.status(201).json({ expense, splits });\n    } catch (error) {\n      console.error('Erro ao criar despesa:', error);\n      res.status(400).json({ message: \"Erro ao criar despesa\" });\n    }\n  });\n\n  app.get(\"/api/trips/:id/expenses\", requireAuth, async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      \n      // Verify user is a participant of the trip\n      const participants = await storage.getTripParticipants(trip_id);\n      const isParticipant = participants.some(p => p.user_id === req.user!.id && p.status === 'accepted');\n      \n      if (!isParticipant) {\n        return res.status(403).json({ message: \"Acesso negado\" });\n      }\n      \n      const expenses = await storage.getTripExpenses(trip_id);\n      res.json(expenses);\n    } catch (error) {\n      console.error('Erro ao buscar despesas:', error);\n      res.status(500).json({ message: \"Erro ao buscar despesas\" });\n    }\n  });\n\n  app.get(\"/api/trips/:id/balances\", requireAuth, async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      \n      // Verify user is a participant or creator of the trip\n      const trip = await storage.getTripById(trip_id);\n      if (!trip) {\n        return res.status(404).json({ message: \"Viagem n√£o encontrada\" });\n      }\n      \n      const participants = await storage.getTripParticipants(trip_id);\n      const isParticipant = participants.some(p => p.user_id === req.user!.id && p.status === 'accepted');\n      const isCreator = trip.creator_id === req.user!.id;\n      \n      if (!isParticipant && !isCreator) {\n        return res.status(403).json({ message: \"Acesso negado\" });\n      }\n      \n      const balances = await storage.getTripBalances(trip_id);\n      \n      // Set cache control headers to prevent caching\n      res.set({\n        'Cache-Control': 'no-cache, no-store, must-revalidate',\n        'Pragma': 'no-cache',\n        'Expires': '0'\n      });\n      \n      res.json(balances);\n    } catch (error) {\n      console.error('Erro ao calcular balan√ßos:', error);\n      res.status(500).json({ message: \"Erro ao calcular balan√ßos\" });\n    }\n  });\n\n  app.patch(\"/api/expense-splits/:id\", requireAuth, async (req, res) => {\n    try {\n      const splitId = parseInt(req.params.id);\n      const { paid } = req.body;\n      \n      const updatedSplit = await storage.updateExpenseSplit(splitId, paid);\n      if (!updatedSplit) {\n        return res.status(404).json({ message: \"Divis√£o n√£o encontrada\" });\n      }\n      \n      res.json(updatedSplit);\n    } catch (error) {\n      console.error('Erro ao atualizar divis√£o:', error);\n      res.status(500).json({ message: \"Erro ao atualizar divis√£o\" });\n    }\n  });\n\n  // Profile routes\n  app.put(\"/api/user/profile\", requireAuth, async (req, res) => {\n    try {\n      const { full_name, email, phone, bio, location, languages, interests, travelStyle, travelStyles } = req.body;\n      \n      console.log('üîç Dados recebidos para atualiza√ß√£o de perfil:', {\n        user_id: req.user!.id,\n        full_name,\n        email,\n        phone,\n        bio,\n        location,\n        languages,\n        interests,\n        travelStyles: travelStyles || (travelStyle ? [travelStyle] : [])\n      });\n      \n      // Prepare update data with proper field names\n      const updateData = {\n        full_name,\n        email,\n        phone: phone.replace(/\\D/g, ''), // Remove formatting from phone\n        bio,\n        location,\n        languages,\n        interests,\n        travelStyles: travelStyles || (travelStyle ? [travelStyle] : [])\n      };\n      \n      console.log('üîç Dados para atualiza√ß√£o no banco:', updateData);\n      \n      const updatedUser = await storage.updateUser(req.user!.id, updateData);\n      \n      if (!updatedUser) {\n        return res.status(404).json({ message: \"Usu√°rio n√£o encontrado\" });\n      }\n      \n      console.log('‚úÖ Perfil atualizado com sucesso:', updatedUser);\n      res.json(updatedUser);\n    } catch (error) {\n      console.error('‚ùå Erro ao atualizar perfil:', error);\n      res.status(500).json({ message: \"Erro ao atualizar perfil\", error: error.message });\n    }\n  });\n\n  app.get(\"/api/user/stats\", requireAuth, async (req, res) => {\n    try {\n      const userId = req.user!.id;\n      \n      // Get user's trips\n      const createdTrips = await storage.getTripsByCreator(userId);\n      const participatingTrips = await storage.getTripsByParticipant(userId);\n      \n      const totalTrips = createdTrips.length + participatingTrips.length;\n      const completedTrips = [...createdTrips, ...participatingTrips].filter(trip => \n        trip.status === 'completed' || new Date(trip.end_date) < new Date()\n      ).length;\n      \n      // Get travel partners (unique users from all trips)\n      const allTrips = [...createdTrips, ...participatingTrips];\n      const travelPartners = new Set();\n      \n      for (const trip of allTrips) {\n        const participants = await storage.getTripParticipants(trip.id);\n        participants.forEach(p => {\n          if (p.user_id !== userId) {\n            travelPartners.add(p.user_id);\n          }\n        });\n      }\n      \n      const stats = {\n        totalTrips,\n        completedTrips,\n        travelPartners: travelPartners.size,\n        average_rating: \"5.0\" // Mock rating for now\n      };\n      \n      res.json(stats);\n    } catch (error) {\n      console.error('Erro ao buscar estat√≠sticas:', error);\n      res.status(500).json({ message: \"Erro ao buscar estat√≠sticas\" });\n    }\n  });\n\n  app.get(\"/api/user/referral\", requireAuth, async (req, res) => {\n    try {\n      const userId = req.user!.id;\n      const username = req.user!.username.toUpperCase();\n      \n      // Generate referral code based on username and user ID\n      const referralCode = `PARTIU-${username}${userId.toString().padStart(2, '0')}`;\n      \n      // Find all users who were referred by this user's referral code (excluding self-referrals)\n      const referredUsers = await db.select({\n        id: users.id,\n        full_name: users.full_name,\n        email: users.email,\n        created_at: users.created_at,\n        is_verified: users.is_verified\n      })\n      .from(users)\n      .where(and(\n        eq(users.referred_by, referralCode),\n        ne(users.id, userId) // Exclude self-referrals\n      ));\n      \n      console.log(`üîç Buscando usu√°rios indicados por c√≥digo: ${referralCode}`);\n      console.log(`üìã Encontrados ${referredUsers.length} usu√°rios indicados`);\n      \n      const referralData = {\n        code: referralCode,\n        referredUsers: referredUsers\n      };\n      \n      res.json(referralData);\n    } catch (error) {\n      console.error('Erro ao buscar dados de indica√ß√£o:', error);\n      res.status(500).json({ message: \"Erro ao buscar dados de indica√ß√£o\" });\n    }\n  });\n\n  // Validate referral code\n  app.post(\"/api/user/validate-referral\", async (req, res) => {\n    try {\n      const { referralCode } = req.body;\n      \n      if (!referralCode) {\n        return res.status(400).json({ message: \"C√≥digo de indica√ß√£o √© obrigat√≥rio\" });\n      }\n      \n      // Check if referral code matches the format PARTIU-{USERNAME}{ID}\n      const referralRegex = /^PARTIU-([A-Z]+)(\\d+)$/;\n      const match = referralCode.match(referralRegex);\n      \n      if (!match) {\n        return res.status(400).json({ message: \"Formato de c√≥digo de indica√ß√£o inv√°lido\" });\n      }\n      \n      const [, username, userIdStr] = match;\n      const userId = parseInt(userIdStr);\n      \n      // Find the user with this username and ID\n      const user = await storage.getUserById(userId);\n      \n      if (!user || user.username.toUpperCase() !== username) {\n        return res.status(400).json({ message: \"C√≥digo de indica√ß√£o inv√°lido\" });\n      }\n      \n      res.json({ \n        valid: true, \n        referrerName: user.full_name,\n        referrerUsername: user.username\n      });\n    } catch (error) {\n      console.error('Erro ao validar c√≥digo de indica√ß√£o:', error);\n      res.status(500).json({ message: \"Erro ao validar c√≥digo de indica√ß√£o\" });\n    }\n  });\n\n  // Enhanced User Rating routes with verification checks\n  app.get(\"/api/users/:id/ratings\", async (req, res) => {\n    try {\n      const userId = parseInt(req.params.id);\n      const ratings = await storage.getUserRatings(userId);\n      \n      // Filter out hidden ratings\n      const visibleRatings = ratings.filter(rating => !rating.is_hidden);\n      \n      res.json(visibleRatings);\n    } catch (error) {\n      console.error('Erro ao buscar avalia√ß√µes do usu√°rio:', error);\n      res.status(500).json({ message: \"Erro ao buscar avalia√ß√µes\" });\n    }\n  });\n\n  app.post(\"/api/users/:id/ratings\", requireAuth, async (req, res) => {\n    try {\n      const rated_user_id = parseInt(req.params.id);\n      const rater_user_id = req.user!.id;\n      \n      // Only verified users can rate\n      if (!req.user!.is_verified) {\n        return res.status(403).json({ message: \"Apenas usu√°rios verificados podem avaliar\" });\n      }\n      \n      // Prevent self-rating\n      if (rated_user_id === rater_user_id) {\n        return res.status(400).json({ message: \"N√£o √© poss√≠vel avaliar a si mesmo\" });\n      }\n      \n      // Check if user already rated this user\n      const existingRating = await db\n        .select()\n        .from(userRatings)\n        .where(and(\n          eq(userRatings.rated_user_id, rated_user_id),\n          eq(userRatings.rater_user_id, rater_user_id)\n        ))\n        .limit(1);\n      \n      if (existingRating.length > 0) {\n        return res.status(400).json({ message: \"Voc√™ j√° avaliou este usu√°rio\" });\n      }\n      \n      const ratingData = insertUserRatingSchema.parse(req.body);\n      const rating = await storage.createUserRating({\n        ...ratingData,\n        rated_user_id,\n        rater_user_id\n      });\n      \n      res.status(201).json(rating);\n    } catch (error) {\n      console.error('Erro ao criar avalia√ß√£o:', error);\n      res.status(400).json({ message: \"Erro ao criar avalia√ß√£o\" });\n    }\n  });\n\n  // Edit user rating (only within 7 days)\n  app.put(\"/api/users/:id/ratings/:rating_id\", requireAuth, async (req, res) => {\n    try {\n      const rating_id = parseInt(req.params.rating_id);\n      const userId = req.user!.id;\n      \n      // Only verified users can edit ratings\n      if (!req.user!.is_verified) {\n        return res.status(403).json({ message: \"Apenas usu√°rios verificados podem editar avalia√ß√µes\" });\n      }\n      \n      // Check if rating exists and belongs to user\n      const existingRating = await db\n        .select()\n        .from(userRatings)\n        .where(and(\n          eq(userRatings.id, rating_id),\n          eq(userRatings.rater_user_id, userId)\n        ))\n        .limit(1);\n      \n      if (existingRating.length === 0) {\n        return res.status(404).json({ message: \"Avalia√ß√£o n√£o encontrada\" });\n      }\n      \n      const rating = existingRating[0];\n      \n      // Check if rating is within 7 days edit window\n      const daysSinceCreation = Math.floor((Date.now() - rating.created_at.getTime()) / (1000 * 60 * 60 * 24));\n      if (daysSinceCreation > 7) {\n        return res.status(403).json({ message: \"Per√≠odo de edi√ß√£o expirado (7 dias)\" });\n      }\n      \n      const ratingData = insertUserRatingSchema.parse(req.body);\n      \n      await db\n        .update(userRatings)\n        .set({\n          ...ratingData,\n          updated_at: new Date()\n        })\n        .where(eq(userRatings.id, rating_id));\n      \n      res.json({ message: \"Avalia√ß√£o atualizada com sucesso\" });\n    } catch (error) {\n      console.error('Erro ao editar avalia√ß√£o:', error);\n      res.status(400).json({ message: \"Erro ao editar avalia√ß√£o\" });\n    }\n  });\n\n  // Delete user rating (only within 7 days)\n  app.delete(\"/api/users/:id/ratings/:rating_id\", requireAuth, async (req, res) => {\n    try {\n      const rating_id = parseInt(req.params.rating_id);\n      const userId = req.user!.id;\n      \n      // Check if rating exists and belongs to user\n      const existingRating = await db\n        .select()\n        .from(userRatings)\n        .where(and(\n          eq(userRatings.id, rating_id),\n          eq(userRatings.rater_user_id, userId)\n        ))\n        .limit(1);\n      \n      if (existingRating.length === 0) {\n        return res.status(404).json({ message: \"Avalia√ß√£o n√£o encontrada\" });\n      }\n      \n      const rating = existingRating[0];\n      \n      // Check if rating is within 7 days edit window\n      const daysSinceCreation = Math.floor((Date.now() - rating.created_at.getTime()) / (1000 * 60 * 60 * 24));\n      if (daysSinceCreation > 7) {\n        return res.status(403).json({ message: \"Per√≠odo de exclus√£o expirado (7 dias)\" });\n      }\n      \n      await db\n        .delete(userRatings)\n        .where(eq(userRatings.id, rating_id));\n      \n      res.json({ message: \"Avalia√ß√£o exclu√≠da com sucesso\" });\n    } catch (error) {\n      console.error('Erro ao excluir avalia√ß√£o:', error);\n      res.status(500).json({ message: \"Erro ao excluir avalia√ß√£o\" });\n    }\n  });\n\n  // Enhanced Destination Rating routes\n  app.get(\"/api/destinations/:destination/ratings\", async (req, res) => {\n    try {\n      const destination = decodeURIComponent(req.params.destination);\n      const ratings = await storage.getDestinationRatings(destination);\n      \n      // Filter out hidden ratings\n      const visibleRatings = ratings.filter(rating => !rating.is_hidden);\n      \n      res.json(visibleRatings);\n    } catch (error) {\n      console.error('Erro ao buscar avalia√ß√µes do destino:', error);\n      res.status(500).json({ message: \"Erro ao buscar avalia√ß√µes do destino\" });\n    }\n  });\n\n  app.post(\"/api/destinations/:destination/ratings\", requireAuth, async (req, res) => {\n    try {\n      const destination = decodeURIComponent(req.params.destination);\n      const userId = req.user!.id;\n      \n      // Only verified users can rate\n      if (!req.user!.is_verified) {\n        return res.status(403).json({ message: \"Apenas usu√°rios verificados podem avaliar destinos\" });\n      }\n      \n      // Check if user already rated this destination\n      const existingRating = await db\n        .select()\n        .from(destinationRatings)\n        .where(and(\n          eq(destinationRatings.destination, destination),\n          eq(destinationRatings.user_id, userId)\n        ))\n        .limit(1);\n      \n      if (existingRating.length > 0) {\n        return res.status(400).json({ message: \"Voc√™ j√° avaliou este destino\" });\n      }\n      \n      const ratingData = insertDestinationRatingSchema.parse(req.body);\n      const rating = await storage.createDestinationRating({\n        ...ratingData,\n        destination,\n        userId\n      });\n      \n      res.status(201).json(rating);\n    } catch (error) {\n      console.error('Erro ao criar avalia√ß√£o do destino:', error);\n      res.status(400).json({ message: \"Erro ao criar avalia√ß√£o do destino\" });\n    }\n  });\n\n  // Edit destination rating (only within 7 days)\n  app.put(\"/api/destinations/:destination/ratings/:rating_id\", requireAuth, async (req, res) => {\n    try {\n      const rating_id = parseInt(req.params.rating_id);\n      const userId = req.user!.id;\n      \n      // Only verified users can edit ratings\n      if (!req.user!.is_verified) {\n        return res.status(403).json({ message: \"Apenas usu√°rios verificados podem editar avalia√ß√µes\" });\n      }\n      \n      // Check if rating exists and belongs to user\n      const existingRating = await db\n        .select()\n        .from(destinationRatings)\n        .where(and(\n          eq(destinationRatings.id, rating_id),\n          eq(destinationRatings.user_id, userId)\n        ))\n        .limit(1);\n      \n      if (existingRating.length === 0) {\n        return res.status(404).json({ message: \"Avalia√ß√£o n√£o encontrada\" });\n      }\n      \n      const rating = existingRating[0];\n      \n      // Check if rating is within 7 days edit window\n      const daysSinceCreation = Math.floor((Date.now() - rating.created_at.getTime()) / (1000 * 60 * 60 * 24));\n      if (daysSinceCreation > 7) {\n        return res.status(403).json({ message: \"Per√≠odo de edi√ß√£o expirado (7 dias)\" });\n      }\n      \n      const ratingData = insertDestinationRatingSchema.parse(req.body);\n      \n      await db\n        .update(destinationRatings)\n        .set({\n          ...ratingData,\n          updated_at: new Date()\n        })\n        .where(eq(destinationRatings.id, rating_id));\n      \n      res.json({ message: \"Avalia√ß√£o atualizada com sucesso\" });\n    } catch (error) {\n      console.error('Erro ao editar avalia√ß√£o:', error);\n      res.status(400).json({ message: \"Erro ao editar avalia√ß√£o\" });\n    }\n  });\n\n  // Delete destination rating (only within 7 days)\n  app.delete(\"/api/destinations/:destination/ratings/:rating_id\", requireAuth, async (req, res) => {\n    try {\n      const rating_id = parseInt(req.params.rating_id);\n      const userId = req.user!.id;\n      \n      // Check if rating exists and belongs to user\n      const existingRating = await db\n        .select()\n        .from(destinationRatings)\n        .where(and(\n          eq(destinationRatings.id, rating_id),\n          eq(destinationRatings.user_id, userId)\n        ))\n        .limit(1);\n      \n      if (existingRating.length === 0) {\n        return res.status(404).json({ message: \"Avalia√ß√£o n√£o encontrada\" });\n      }\n      \n      const rating = existingRating[0];\n      \n      // Check if rating is within 7 days edit window\n      const daysSinceCreation = Math.floor((Date.now() - rating.created_at.getTime()) / (1000 * 60 * 60 * 24));\n      if (daysSinceCreation > 7) {\n        return res.status(403).json({ message: \"Per√≠odo de exclus√£o expirado (7 dias)\" });\n      }\n      \n      await db\n        .delete(destinationRatings)\n        .where(eq(destinationRatings.id, rating_id));\n      \n      res.json({ message: \"Avalia√ß√£o exclu√≠da com sucesso\" });\n    } catch (error) {\n      console.error('Erro ao excluir avalia√ß√£o:', error);\n      res.status(500).json({ message: \"Erro ao excluir avalia√ß√£o\" });\n    }\n  });\n\n  app.get(\"/api/destinations/:destination/rating-average\", async (req, res) => {\n    try {\n      const destination = decodeURIComponent(req.params.destination);\n      const average = await storage.getDestinationAverageRating(destination);\n      res.json(average);\n    } catch (error) {\n      console.error('Erro ao calcular m√©dia do destino:', error);\n      res.status(500).json({ message: \"Erro ao calcular m√©dia do destino\" });\n    }\n  });\n\n  // Verification routes\n  app.get(\"/api/verification/requests\", requireAuth, async (req, res) => {\n    try {\n      const userId = req.user!.id;\n      const requests = await storage.getVerificationRequests(userId);\n      res.json(requests);\n    } catch (error) {\n      console.error('Erro ao buscar solicita√ß√µes de verifica√ß√£o:', error);\n      res.status(500).json({ message: \"Erro ao buscar solicita√ß√µes de verifica√ß√£o\" });\n    }\n  });\n\n  app.post(\"/api/verification/requests\", requireAuth, async (req, res) => {\n    try {\n      const userId = req.user!.id;\n      const requestData = insertVerificationRequestSchema.parse(req.body);\n      \n      const request = await storage.createVerificationRequest({\n        ...requestData,\n        userId\n      });\n      \n      res.status(201).json(request);\n    } catch (error) {\n      console.error('Erro ao criar solicita√ß√£o de verifica√ß√£o:', error);\n      res.status(400).json({ message: \"Erro ao criar solicita√ß√£o de verifica√ß√£o\" });\n    }\n  });\n\n  app.patch(\"/api/verification/requests/:id\", requireAuth, async (req, res) => {\n    try {\n      const requestId = parseInt(req.params.id);\n      const { status, rejectionReason } = req.body;\n      const reviewerId = req.user!.id;\n      \n      const updatedRequest = await storage.updateVerificationRequest(\n        requestId,\n        status,\n        reviewerId,\n        rejectionReason\n      );\n      \n      if (!updatedRequest) {\n        return res.status(404).json({ message: \"Solicita√ß√£o n√£o encontrada\" });\n      }\n      \n      res.json(updatedRequest);\n    } catch (error) {\n      console.error('Erro ao atualizar solicita√ß√£o de verifica√ß√£o:', error);\n      res.status(400).json({ message: \"Erro ao atualizar solicita√ß√£o de verifica√ß√£o\" });\n    }\n  });\n\n  // ============ RATING REPORT ROUTES ============\n  \n  // Report a rating\n  app.post(\"/api/ratings/report\", requireAuth, async (req, res) => {\n    try {\n      const reporter_id = req.user!.id;\n      const reportData = insertRatingReportSchema.parse(req.body);\n      \n      // Check if user already reported this rating\n      const existingReport = await db\n        .select()\n        .from(ratingReports)\n        .where(and(\n          eq(ratingReports.reporter_id, reporter_id),\n          eq(ratingReports.rating_type, reportData.rating_type),\n          eq(ratingReports.rating_id, reportData.rating_id)\n        ))\n        .limit(1);\n      \n      if (existingReport.length > 0) {\n        return res.status(400).json({ message: \"Voc√™ j√° reportou esta avalia√ß√£o\" });\n      }\n      \n      await db.insert(ratingReports).values({\n        ...reportData,\n        reporter_id\n      });\n      \n      console.log('üìù Report de avalia√ß√£o criado:', {\n        reporter_id,\n        rating_type: reportData.rating_type,\n        rating_id: reportData.rating_id,\n        reason: reportData.reason\n      });\n      \n      // Increment report count on the rating\n      if (reportData.rating_type === 'user') {\n        await db\n          .update(userRatings)\n          .set({\n            report_count: sql`${userRatings.report_count} + 1`\n          })\n          .where(eq(userRatings.id, reportData.rating_id));\n          \n        // Auto-hide if report count >= 5\n        const updatedRating = await db\n          .select()\n          .from(userRatings)\n          .where(eq(userRatings.id, reportData.rating_id))\n          .limit(1);\n          \n        if (updatedRating.length > 0 && updatedRating[0].report_count >= 5) {\n          await db\n            .update(userRatings)\n            .set({ is_hidden: true })\n            .where(eq(userRatings.id, reportData.rating_id));\n        }\n      } else if (reportData.rating_type === 'destination') {\n        await db\n          .update(destinationRatings)\n          .set({\n            report_count: sql`${destinationRatings.report_count} + 1`\n          })\n          .where(eq(destinationRatings.id, reportData.rating_id));\n          \n        // Auto-hide if report count >= 5\n        const updatedRating = await db\n          .select()\n          .from(destinationRatings)\n          .where(eq(destinationRatings.id, reportData.rating_id))\n          .limit(1);\n          \n        if (updatedRating.length > 0 && updatedRating[0].report_count >= 5) {\n          await db\n            .update(destinationRatings)\n            .set({ is_hidden: true })\n            .where(eq(destinationRatings.id, reportData.rating_id));\n        }\n      } else if (reportData.rating_type === 'activity') {\n        await db\n          .update(activityReviews)\n          .set({\n            report_count: sql`${activityReviews.report_count} + 1`\n          })\n          .where(eq(activityReviews.id, reportData.rating_id));\n          \n        // Auto-hide if report count >= 5\n        const updatedRating = await db\n          .select()\n          .from(activityReviews)\n          .where(eq(activityReviews.id, reportData.rating_id))\n          .limit(1);\n          \n        if (updatedRating.length > 0 && updatedRating[0].report_count >= 5) {\n          await db\n            .update(activityReviews)\n            .set({ is_hidden: true })\n            .where(eq(activityReviews.id, reportData.rating_id));\n        }\n      }\n      \n      res.status(201).json({ message: \"Avalia√ß√£o reportada com sucesso\" });\n    } catch (error) {\n      console.error('Erro ao reportar avalia√ß√£o:', error);\n      res.status(400).json({ message: \"Erro ao reportar avalia√ß√£o\" });\n    }\n  });\n\n  // ============ DESTINATIONS ROUTES ============\n  \n  // Get all available destinations for activities\n  app.get(\"/api/destinations\", async (req, res) => {\n    try {\n      const destinations = await storage.getAllDestinations();\n      res.json(destinations);\n    } catch (error) {\n      console.error('Erro ao buscar destinos:', error);\n      res.status(500).json({ message: \"Erro ao buscar destinos\" });\n    }\n  });\n\n  // Get destination by ID\n  app.get(\"/api/destinations/:id\", async (req, res) => {\n    try {\n      const destinationId = parseInt(req.params.id);\n      const destination = await storage.getDestinationById(destinationId);\n      \n      if (!destination) {\n        return res.status(404).json({ message: \"Destino n√£o encontrado\" });\n      }\n      \n      res.json(destination);\n    } catch (error) {\n      console.error('Erro ao buscar destino:', error);\n      res.status(500).json({ message: \"Erro ao buscar destino\" });\n    }\n  });\n\n  // ============ ACTIVITIES ROUTES ============\n\n  // Get all activities with optional filters\n  app.get(\"/api/activities\", async (req, res) => {\n    try {\n      const { search, category, location, priceRange, difficulty, duration, rating, sortBy } = req.query;\n      \n      const filters: any = {};\n      if (search) filters.search = search as string;\n      // Handle multiple categories\n      if (category) {\n        const categories = Array.isArray(category) ? category : [category];\n        filters.categories = categories as string[];\n      }\n      if (location) filters.location = location as string;\n      if (priceRange) filters.priceRange = priceRange as string;\n      if (difficulty) filters.difficulty = difficulty as string;\n      if (duration) filters.duration = duration as string;\n      if (rating) filters.rating = rating as string;\n      if (sortBy) filters.sortBy = sortBy as string;\n      \n      const activities = await storage.getActivities(filters);\n      res.json(activities);\n    } catch (error) {\n      console.error('Erro ao buscar atividades:', error);\n      res.status(500).json({ message: \"Erro ao buscar atividades\" });\n    }\n  });\n\n  // Get most popular activities (based on ratings count and average)\n  // Activities hierarchical grouping endpoints\n  app.get(\"/api/activities/hierarchy\", async (req, res) => {\n    try {\n      const hierarchyData = await db.select({\n        countryType: activities.country_type,\n        region: activities.region,\n        city: activities.city,\n        count: sql<number>`count(*)`.as('count')\n      })\n      .from(activities)\n      .where(eq(activities.is_active, true))\n      .groupBy(activities.country_type, activities.region, activities.city)\n      .orderBy(activities.country_type, activities.region, activities.city);\n      \n      // Organize data hierarchically\n      const hierarchy: { [key: string]: { [key: string]: { [key: string]: number } } } = {};\n      \n      hierarchyData.forEach(item => {\n        const countryType = item.countryType || 'unknown';\n        const region = item.region || 'Sem Regi√£o';\n        const city = item.city || 'Sem Cidade';\n        \n        if (!hierarchy[countryType]) hierarchy[countryType] = {};\n        if (!hierarchy[countryType][region]) hierarchy[countryType][region] = {};\n        hierarchy[countryType][region][city] = item.count;\n      });\n      \n      res.json(hierarchy);\n    } catch (error) {\n      console.error(\"Erro ao buscar hierarquia de atividades:\", error);\n      res.status(500).json({ message: \"Erro interno do servidor\" });\n    }\n  });\n\n  app.get(\"/api/activities/by-location\", async (req, res) => {\n    try {\n      const { destination_id, countryType, region, city, ...filters } = req.query;\n      \n      let query = db.select().from(activities).where(eq(activities.is_active, true));\n      \n      // Prefer destination_id if provided\n      if (destination_id) {\n        query = query.where(eq(activities.destination_id, parseInt(destination_id as string)));\n      } else {\n        // Fallback to location filters for compatibility\n        if (countryType) {\n          query = query.where(eq(activities.country_type, countryType as string));\n        }\n        if (region) {\n          query = query.where(eq(activities.region, region as string));\n        }\n        if (city) {\n          query = query.where(eq(activities.city, city as string));\n        }\n      }\n      \n      // Apply other filters\n      if (filters.category) {\n        query = query.where(eq(activities.category, filters.category as string));\n      }\n      \n      const result = await query.orderBy(desc(activities.average_rating), desc(activities.total_ratings));\n      res.json(result);\n    } catch (error) {\n      console.error(\"Erro ao buscar atividades por localiza√ß√£o:\", error);\n      res.status(500).json({ message: \"Erro interno do servidor\" });\n    }\n  });\n\n  app.get(\"/api/activities/suggestions/popular\", async (req, res) => {\n    try {\n      const limit = parseInt(req.query.limit as string) || 6;\n      \n      const activities = await storage.getActivities({});\n      \n      // Sort by popularity score (average rating * log(total ratings + 1))\n      const popularActivities = activities\n        .map(activity => ({\n          ...activity,\n          popularityScore: Number(activity.average_rating || 0) * Math.log((activity.total_ratings || 0) + 1)\n        }))\n        .sort((a, b) => b.popularityScore - a.popularityScore)\n        .slice(0, limit)\n        .map(({ popularityScore, ...activity }) => activity);\n      \n      res.json(popularActivities);\n    } catch (error) {\n      console.error('Erro ao buscar atividades populares:', error);\n      res.status(500).json({ message: \"Erro ao buscar atividades populares\" });\n    }\n  });\n\n  // Get best rated activities (4.5+ stars)\n  app.get(\"/api/activities/suggestions/top-rated\", async (req, res) => {\n    try {\n      const limit = parseInt(req.query.limit as string) || 6;\n      \n      const activities = await storage.getActivities({});\n      \n      // Filter by high ratings and sort by average rating\n      const topRatedActivities = activities\n        .filter(activity => Number(activity.average_rating || 0) >= 4.5)\n        .sort((a, b) => Number(b.average_rating || 0) - Number(a.average_rating || 0))\n        .slice(0, limit);\n      \n      res.json(topRatedActivities);\n    } catch (error) {\n      console.error('Erro ao buscar atividades mais bem avaliadas:', error);\n      res.status(500).json({ message: \"Erro ao buscar atividades mais bem avaliadas\" });\n    }\n  });\n\n  // Get personalized suggestions based on user's upcoming trips\n  app.get(\"/api/activities/suggestions/personalized\", requireAuth, async (req, res) => {\n    try {\n      const userId = req.user!.id;\n      const limit = parseInt(req.query.limit as string) || 6;\n      \n      // Get user's upcoming trips\n      const createdTrips = await storage.getTripsByCreator(userId);\n      const participatingTrips = await storage.getTripsByParticipant(userId);\n      const allTrips = [...createdTrips, ...participatingTrips];\n      \n      const upcomingTrips = allTrips.filter(trip => {\n        const tripDate = new Date(trip.start_date);\n        const now = new Date();\n        return tripDate > now;\n      });\n      \n      if (upcomingTrips.length === 0) {\n        // Fallback to popular activities\n        return res.redirect('/api/activities/suggestions/popular?limit=' + limit);\n      }\n      \n      // Extract destination IDs from upcoming trips\n      const upcomingDestinationIds = upcomingTrips.map(trip => trip.destination_id);\n      \n      // Get activities that match upcoming destinations\n      const matchingActivities = await db\n        .select()\n        .from(activities)\n        .where(and(\n          eq(activities.is_active, true),\n          sql`${activities.destination_id} IN (${upcomingDestinationIds.join(',')})`\n        ));\n      \n      // Sort by rating and popularity\n      const personalizedActivities = matchingActivities\n        .map(activity => ({\n          ...activity,\n          popularityScore: Number(activity.average_rating || 0) * Math.log((activity.total_ratings || 0) + 1)\n        }))\n        .sort((a, b) => b.popularityScore - a.popularityScore)\n        .slice(0, limit)\n        .map(({ popularityScore, ...activity }) => activity);\n      \n      res.json(personalizedActivities);\n    } catch (error) {\n      console.error('Erro ao buscar sugest√µes personalizadas:', error);\n      res.status(500).json({ message: \"Erro ao buscar sugest√µes personalizadas\" });\n    }\n  });\n\n  // Get single activity\n  app.get(\"/api/activities/:id\", async (req, res) => {\n    try {\n      const activity_id = parseInt(req.params.id);\n      const activity = await storage.getActivity(activity_id);\n      \n      if (!activity) {\n        return res.status(404).json({ message: \"Atividade n√£o encontrada\" });\n      }\n      \n      res.json(activity);\n    } catch (error) {\n      console.error('Erro ao buscar atividade:', error);\n      res.status(500).json({ message: \"Erro ao buscar atividade\" });\n    }\n  });\n\n  // Create new activity (requires authentication)\n  app.post(\"/api/activities\", requireAuth, async (req, res) => {\n    try {\n      const creatorId = req.user!.id;\n      const activityData = insertActivitySchema.parse(req.body);\n      \n      // Validate destination exists and is active\n      const { validateDestination } = await import(\"./activity-destination-helper\");\n      const isValidDestination = await validateDestination(activityData.destination_id);\n      \n      if (!isValidDestination) {\n        return res.status(400).json({ message: \"Destino inv√°lido ou inativo\" });\n      }\n      \n      const activity = await storage.createActivity({\n        ...activityData,\n        created_by_id: creatorId\n      });\n      \n      res.status(201).json(activity);\n    } catch (error) {\n      console.error('Erro ao criar atividade:', error);\n      res.status(400).json({ message: \"Erro ao criar atividade\" });\n    }\n  });\n\n  // Update activity (requires authentication and ownership)\n  app.put(\"/api/activities/:id\", requireAuth, async (req, res) => {\n    try {\n      const activity_id = parseInt(req.params.id);\n      const userId = req.user!.id;\n      \n      // Check if user owns the activity\n      const activity = await storage.getActivity(activity_id);\n      if (!activity) {\n        return res.status(404).json({ message: \"Atividade n√£o encontrada\" });\n      }\n      \n      if (activity.created_by_id !== userId) {\n        return res.status(403).json({ message: \"Voc√™ n√£o tem permiss√£o para editar esta atividade\" });\n      }\n      \n      const updates = req.body;\n      const updatedActivity = await storage.updateActivity(activity_id, updates);\n      \n      if (!updatedActivity) {\n        return res.status(404).json({ message: \"Atividade n√£o encontrada\" });\n      }\n      \n      res.json(updatedActivity);\n    } catch (error) {\n      console.error('Erro ao atualizar atividade:', error);\n      res.status(400).json({ message: \"Erro ao atualizar atividade\" });\n    }\n  });\n\n  // Delete activity (requires authentication and ownership)\n  app.delete(\"/api/activities/:id\", requireAuth, async (req, res) => {\n    try {\n      const activity_id = parseInt(req.params.id);\n      const userId = req.user!.id;\n      \n      // Check if user owns the activity\n      const activity = await storage.getActivity(activity_id);\n      if (!activity) {\n        return res.status(404).json({ message: \"Atividade n√£o encontrada\" });\n      }\n      \n      if (activity.created_by_id !== userId) {\n        return res.status(403).json({ message: \"Voc√™ n√£o tem permiss√£o para deletar esta atividade\" });\n      }\n      \n      const deleted = await storage.deleteActivity(activity_id);\n      if (!deleted) {\n        return res.status(404).json({ message: \"Atividade n√£o encontrada\" });\n      }\n      \n      res.json({ message: \"Atividade deletada com sucesso\" });\n    } catch (error) {\n      console.error('Erro ao deletar atividade:', error);\n      res.status(500).json({ message: \"Erro ao deletar atividade\" });\n    }\n  });\n\n  // ============ ACTIVITY REVIEWS ROUTES ============\n\n  // Get reviews for an activity (filter out hidden reviews)\n  app.get(\"/api/activities/:id/reviews\", async (req, res) => {\n    try {\n      const activity_id = parseInt(req.params.id);\n      const limit = parseInt(req.query.limit as string) || 10;\n      const offset = parseInt(req.query.offset as string) || 0;\n\n      const reviews = await db\n        .select({\n          id: activityReviews.id,\n          activity_id: activityReviews.activity_id,\n          rating: activityReviews.rating,\n          review: activityReviews.review,\n          photos: activityReviews.photos,\n          visit_date: activityReviews.visit_date,\n          helpful_votes: activityReviews.helpful_votes,\n          is_verified: activityReviews.is_verified,\n          is_hidden: activityReviews.is_hidden,\n          report_count: activityReviews.report_count,\n          created_at: activityReviews.created_at,\n          user: {\n            id: users.id,\n            username: users.username,\n            full_name: users.full_name,\n            profile_photo: users.profile_photo,\n            average_rating: users.average_rating,\n            is_verified: users.is_verified\n          }\n        })\n        .from(activityReviews)\n        .innerJoin(users, eq(activityReviews.user_id, users.id))\n        .where(and(\n          eq(activityReviews.activity_id, activity_id),\n          eq(activityReviews.is_hidden, false)\n        ))\n        .orderBy(desc(activityReviews.created_at))\n        .limit(limit)\n        .offset(offset);\n\n      res.json(reviews);\n    } catch (error) {\n      console.error('‚ùå Erro ao buscar avalia√ß√µes:', error);\n      res.status(500).json({ message: \"Erro interno do servidor\" });\n    }\n  });\n\n  // Create a new activity review (enhanced with verification)\n  app.post(\"/api/activities/:id/reviews\", requireAuth, async (req, res) => {\n    try {\n      const activity_id = parseInt(req.params.id);\n      const userId = req.user!.id;\n      \n      // Only verified users can create reviews\n      if (!req.user!.is_verified) {\n        return res.status(403).json({ message: \"Apenas usu√°rios verificados podem criar avalia√ß√µes\" });\n      }\n      \n      console.log('üîç Creating review - Activity ID:', activity_id, 'User ID:', userId);\n      console.log('üîç Request body:', req.body);\n      console.log('üîç User from req:', req.user);\n      console.log('üîç Authentication status:', req.isAuthenticated());\n      \n      // Validate request body\n      const validatedData = insertActivityReviewSchema.parse({\n        ...req.body,\n        activity_id: activity_id\n      });\n      \n      console.log('üîç Validated data:', validatedData);\n\n      // Check if user already reviewed this activity\n      const existingReview = await db\n        .select()\n        .from(activityReviews)\n        .where(and(\n          eq(activityReviews.activity_id, activity_id),\n          eq(activityReviews.user_id, userId)\n        ))\n        .limit(1);\n\n      if (existingReview.length > 0) {\n        // Check if review is within 7 days edit window\n        const daysSinceCreation = Math.floor((Date.now() - existingReview[0].created_at.getTime()) / (1000 * 60 * 60 * 24));\n        if (daysSinceCreation > 7) {\n          return res.status(403).json({ message: \"Per√≠odo de edi√ß√£o expirado (7 dias)\" });\n        }\n        \n        // Update existing review instead of creating new one\n        await db.update(activityReviews)\n          .set({\n            rating: validatedData.rating,\n            review: validatedData.review,\n            photos: validatedData.photos || [],\n            visit_date: validatedData.visit_date || null,\n            updated_at: new Date()\n          })\n          .where(eq(activityReviews.id, existingReview[0].id));\n        \n        const reviewId = existingReview[0].id;\n        \n        // Update activity's average rating\n        const allReviews = await db\n          .select({ rating: activityReviews.rating })\n          .from(activityReviews)\n          .where(eq(activityReviews.activity_id, activity_id));\n\n        const average_rating = allReviews.reduce((sum, r) => sum + r.rating, 0) / allReviews.length;\n\n        await db.update(activities)\n          .set({\n            average_rating: average_rating.toFixed(2),\n            total_ratings: allReviews.length\n          })\n          .where(eq(activities.id, activity_id));\n\n        // Return the updated review with user data\n        const reviewWithUser = await db\n          .select({\n            id: activityReviews.id,\n            activity_id: activityReviews.activity_id,\n            rating: activityReviews.rating,\n            review: activityReviews.review,\n            photos: activityReviews.photos,\n            visit_date: activityReviews.visit_date,\n            helpful_votes: activityReviews.helpful_votes,\n            is_verified: activityReviews.is_verified,\n            created_at: activityReviews.created_at,\n            user: {\n              id: users.id,\n              username: users.username,\n              full_name: users.full_name,\n              profile_photo: users.profile_photo,\n              average_rating: users.average_rating,\n              is_verified: users.is_verified\n            }\n          })\n          .from(activityReviews)\n          .innerJoin(users, eq(activityReviews.user_id, users.id))\n          .where(eq(activityReviews.id, reviewId))\n          .limit(1);\n\n        return res.status(200).json(reviewWithUser[0]);\n      }\n\n      // Create the review\n      const insertResult = await db.insert(activityReviews).values({\n        activity_id,\n        userId,\n        rating: validatedData.rating,\n        review: validatedData.review,\n        photos: validatedData.photos || [],\n        visit_date: validatedData.visit_date || null\n      });\n      \n      // Get the inserted review ID\n      const reviewId = Number(insertResult.insertId);\n\n      // Update activity's average rating\n      const allReviews = await db\n        .select({ rating: activityReviews.rating })\n        .from(activityReviews)\n        .where(eq(activityReviews.activity_id, activity_id));\n\n      const average_rating = allReviews.reduce((sum, r) => sum + r.rating, 0) / allReviews.length;\n\n      await db.update(activities)\n        .set({\n          average_rating: average_rating.toFixed(2),\n          total_ratings: allReviews.length\n        })\n        .where(eq(activities.id, activity_id));\n\n      // Return the new review with user data\n      const reviewWithUser = await db\n        .select({\n          id: activityReviews.id,\n          activity_id: activityReviews.activity_id,\n          rating: activityReviews.rating,\n          review: activityReviews.review,\n          photos: activityReviews.photos,\n          visit_date: activityReviews.visit_date,\n          helpful_votes: activityReviews.helpful_votes,\n          is_verified: activityReviews.is_verified,\n          created_at: activityReviews.created_at,\n          user: {\n            id: users.id,\n            username: users.username,\n            full_name: users.full_name,\n            profile_photo: users.profile_photo,\n            average_rating: users.average_rating,\n            is_verified: users.is_verified\n          }\n        })\n        .from(activityReviews)\n        .innerJoin(users, eq(activityReviews.user_id, users.id))\n        .where(eq(activityReviews.id, reviewId))\n        .limit(1);\n\n      res.status(201).json(reviewWithUser[0]);\n    } catch (error) {\n      console.error('‚ùå Erro ao criar avalia√ß√£o:', error);\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"Dados inv√°lidos\", errors: error.errors });\n      }\n      res.status(500).json({ message: \"Erro interno do servidor\" });\n    }\n  });\n\n  // Edit activity review (only within 7 days and by verified users)\n  app.put(\"/api/activities/:id/reviews/:reviewId\", requireAuth, async (req, res) => {\n    try {\n      const reviewId = parseInt(req.params.reviewId);\n      const userId = req.user!.id;\n      \n      // Only verified users can edit reviews\n      if (!req.user!.is_verified) {\n        return res.status(403).json({ message: \"Apenas usu√°rios verificados podem editar avalia√ß√µes\" });\n      }\n      \n      // Check if review exists and belongs to user\n      const existingReview = await db\n        .select()\n        .from(activityReviews)\n        .where(and(\n          eq(activityReviews.id, reviewId),\n          eq(activityReviews.user_id, userId)\n        ))\n        .limit(1);\n      \n      if (existingReview.length === 0) {\n        return res.status(404).json({ message: \"Avalia√ß√£o n√£o encontrada\" });\n      }\n      \n      const review = existingReview[0];\n      \n      // Check if review is within 7 days edit window\n      const daysSinceCreation = Math.floor((Date.now() - review.created_at.getTime()) / (1000 * 60 * 60 * 24));\n      if (daysSinceCreation > 7) {\n        return res.status(403).json({ message: \"Per√≠odo de edi√ß√£o expirado (7 dias)\" });\n      }\n      \n      const reviewData = insertActivityReviewSchema.parse(req.body);\n      \n      await db\n        .update(activityReviews)\n        .set({\n          ...reviewData,\n          updated_at: new Date()\n        })\n        .where(eq(activityReviews.id, reviewId));\n      \n      res.json({ message: \"Avalia√ß√£o atualizada com sucesso\" });\n    } catch (error) {\n      console.error('Erro ao editar avalia√ß√£o:', error);\n      res.status(400).json({ message: \"Erro ao editar avalia√ß√£o\" });\n    }\n  });\n\n  // Delete activity review (only within 7 days)\n  app.delete(\"/api/activities/:id/reviews/:reviewId\", requireAuth, async (req, res) => {\n    try {\n      const reviewId = parseInt(req.params.reviewId);\n      const userId = req.user!.id;\n      \n      // Check if review exists and belongs to user\n      const existingReview = await db\n        .select()\n        .from(activityReviews)\n        .where(and(\n          eq(activityReviews.id, reviewId),\n          eq(activityReviews.user_id, userId)\n        ))\n        .limit(1);\n      \n      if (existingReview.length === 0) {\n        return res.status(404).json({ message: \"Avalia√ß√£o n√£o encontrada\" });\n      }\n      \n      const review = existingReview[0];\n      \n      // Check if review is within 7 days edit window\n      const daysSinceCreation = Math.floor((Date.now() - review.created_at.getTime()) / (1000 * 60 * 60 * 24));\n      if (daysSinceCreation > 7) {\n        return res.status(403).json({ message: \"Per√≠odo de exclus√£o expirado (7 dias)\" });\n      }\n      \n      await db\n        .delete(activityReviews)\n        .where(eq(activityReviews.id, reviewId));\n      \n      res.json({ message: \"Avalia√ß√£o exclu√≠da com sucesso\" });\n    } catch (error) {\n      console.error('Erro ao excluir avalia√ß√£o:', error);\n      res.status(500).json({ message: \"Erro ao excluir avalia√ß√£o\" });\n    }\n  });\n\n  // Update helpful votes for a review\n  app.post(\"/api/reviews/:id/helpful\", requireAuth, async (req, res) => {\n    try {\n      const reviewId = parseInt(req.params.id);\n\n      await db.update(activityReviews)\n        .set({\n          helpful_votes: sql`${activityReviews.helpful_votes} + 1`\n        })\n        .where(eq(activityReviews.id, reviewId));\n\n      // Get the updated review\n      const updatedReview = await db\n        .select()\n        .from(activityReviews)\n        .where(eq(activityReviews.id, reviewId))\n        .limit(1);\n\n      res.json(updatedReview[0]);\n    } catch (error) {\n      console.error('‚ùå Erro ao marcar avalia√ß√£o como √∫til:', error);\n      res.status(500).json({ message: \"Erro interno do servidor\" });\n    }\n  });\n\n\n\n  // ============ ACTIVITY BOOKINGS ROUTES ============\n\n  // Get bookings for an activity\n  app.get(\"/api/activities/:id/bookings\", requireAuth, async (req, res) => {\n    try {\n      const activity_id = parseInt(req.params.id);\n      const bookings = await storage.getActivityBookings(activity_id);\n      res.json(bookings);\n    } catch (error) {\n      console.error('Erro ao buscar reservas:', error);\n      res.status(500).json({ message: \"Erro ao buscar reservas\" });\n    }\n  });\n\n  // Get user's bookings\n  app.get(\"/api/users/bookings\", requireAuth, async (req, res) => {\n    try {\n      const userId = req.user!.id;\n      const bookings = await storage.getUserActivityBookings(userId);\n      res.json(bookings);\n    } catch (error) {\n      console.error('Erro ao buscar reservas do usu√°rio:', error);\n      res.status(500).json({ message: \"Erro ao buscar reservas do usu√°rio\" });\n    }\n  });\n\n  // Create booking for an activity (requires authentication)\n  app.post(\"/api/activities/:id/bookings\", requireAuth, async (req, res) => {\n    try {\n      const activity_id = parseInt(req.params.id);\n      const userId = req.user!.id;\n      const bookingData = insertActivityBookingSchema.parse(req.body);\n      \n      const booking = await storage.createActivityBooking({\n        ...bookingData,\n        activity_id,\n        userId\n      });\n      \n      res.status(201).json(booking);\n    } catch (error) {\n      console.error('Erro ao criar reserva:', error);\n      res.status(400).json({ message: \"Erro ao criar reserva\" });\n    }\n  });\n\n  // Update booking status (requires authentication)\n  app.patch(\"/api/bookings/:id\", requireAuth, async (req, res) => {\n    try {\n      const bookingId = parseInt(req.params.id);\n      const { status } = req.body;\n      \n      const updatedBooking = await storage.updateActivityBooking(bookingId, status);\n      \n      if (!updatedBooking) {\n        return res.status(404).json({ message: \"Reserva n√£o encontrada\" });\n      }\n      \n      res.json(updatedBooking);\n    } catch (error) {\n      console.error('Erro ao atualizar reserva:', error);\n      res.status(400).json({ message: \"Erro ao atualizar reserva\" });\n    }\n  });\n\n  // ===== ACTIVITY BUDGET PROPOSALS ROUTES =====\n  \n  // Get all budget proposals for an activity\n  app.get(\"/api/activities/:id/proposals\", async (req, res) => {\n    try {\n      const activity_id = parseInt(req.params.id);\n      const proposals = await storage.getActivityBudgetProposals(activity_id);\n      res.json(proposals);\n    } catch (error) {\n      console.error('Erro ao buscar propostas de or√ßamento:', error);\n      res.status(500).json({ message: \"Erro ao buscar propostas de or√ßamento\" });\n    }\n  });\n\n  // Create new budget proposal for activity (requires authentication)\n  app.post(\"/api/activities/:id/proposals\", requireAuth, async (req, res) => {\n    try {\n      const activity_id = parseInt(req.params.id);\n      const userId = req.user!.id;\n      \n      console.log('üîç Dados recebidos para cria√ß√£o de proposta:', {\n        activity_id,\n        userId,\n        body: req.body\n      });\n      \n      const proposalData = insertActivityBudgetProposalSchema.parse(req.body);\n      \n      console.log('‚úÖ Dados validados:', proposalData);\n      \n      const proposal = await storage.createActivityBudgetProposal({\n        ...proposalData,\n        activity_id,\n        createdBy: user_id\n      });\n      \n      console.log('‚úÖ Proposta criada com sucesso:', proposal);\n      \n      res.status(201).json(proposal);\n    } catch (error) {\n      console.error('‚ùå Erro ao criar proposta de or√ßamento:', error);\n      if (error instanceof Error) {\n        console.error('Stack trace:', error.stack);\n      }\n      res.status(400).json({ message: \"Erro ao criar proposta de or√ßamento\", error: error.message });\n    }\n  });\n\n  // Update budget proposal (requires authentication)\n  app.patch(\"/api/proposals/:id\", requireAuth, async (req, res) => {\n    try {\n      const proposalId = parseInt(req.params.id);\n      const updates = req.body;\n      \n      const updatedProposal = await storage.updateActivityBudgetProposal(proposalId, updates);\n      \n      if (!updatedProposal) {\n        return res.status(404).json({ message: \"Proposta n√£o encontrada\" });\n      }\n      \n      res.json(updatedProposal);\n    } catch (error) {\n      console.error('Erro ao atualizar proposta:', error);\n      res.status(400).json({ message: \"Erro ao atualizar proposta\" });\n    }\n  });\n\n  // Delete budget proposal (requires authentication)\n  app.delete(\"/api/proposals/:id\", requireAuth, async (req, res) => {\n    try {\n      const proposalId = parseInt(req.params.id);\n      const deleted = await storage.deleteActivityBudgetProposal(proposalId);\n      \n      if (!deleted) {\n        return res.status(404).json({ message: \"Proposta n√£o encontrada\" });\n      }\n      \n      res.json({ message: \"Proposta exclu√≠da com sucesso\" });\n    } catch (error) {\n      console.error('Erro ao excluir proposta:', error);\n      res.status(400).json({ message: \"Erro ao excluir proposta\" });\n    }\n  });\n\n  // Vote on budget proposal (requires authentication)\n  app.post(\"/api/proposals/:id/vote\", requireAuth, async (req, res) => {\n    try {\n      const proposalId = parseInt(req.params.id);\n      const { increment } = req.body; // true for upvote, false for downvote\n      const userId = req.user!.id;\n      \n      const updatedProposal = await storage.voteActivityBudgetProposal(proposalId, userId, increment);\n      \n      if (!updatedProposal) {\n        return res.status(404).json({ message: \"Proposta n√£o encontrada\" });\n      }\n      \n      res.json(updatedProposal);\n    } catch (error) {\n      console.error('Erro ao votar na proposta:', error);\n      res.status(400).json({ message: \"Erro ao votar na proposta\" });\n    }\n  });\n\n  // Check if user has voted on an activity\n  app.get(\"/api/activities/:id/user-vote\", requireAuth, async (req, res) => {\n    try {\n      const activity_id = parseInt(req.params.id);\n      const userId = req.user!.id;\n      \n      const vote = await storage.getUserVoteForActivity(userId, activity_id);\n      \n      res.json({ hasVoted: !!vote, vote });\n    } catch (error) {\n      console.error('Erro ao verificar voto do usu√°rio:', error);\n      res.status(500).json({ message: \"Erro ao verificar voto\" });\n    }\n  });\n\n  // Check if user has voted on a specific proposal\n  app.get(\"/api/proposals/:id/user-vote\", requireAuth, async (req, res) => {\n    try {\n      const proposalId = parseInt(req.params.id);\n      const userId = req.user!.id;\n      \n      const vote = await storage.getUserVoteForProposal(userId, proposalId);\n      \n      res.json({ hasVoted: !!vote, vote });\n    } catch (error) {\n      console.error('Erro ao verificar voto do usu√°rio para proposta:', error);\n      res.status(500).json({ message: \"Erro ao verificar voto\" });\n    }\n  });\n\n  // ===== TRIP ACTIVITIES ROUTES =====\n  \n  // Get all activities for a trip\n  app.get(\"/api/trips/:id/activities\", async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      const tripActivities = await storage.getTripActivities(trip_id);\n      res.json(tripActivities);\n    } catch (error) {\n      console.error('Erro ao buscar atividades da viagem:', error);\n      res.status(500).json({ message: \"Erro ao buscar atividades da viagem\" });\n    }\n  });\n\n  // Add activity to trip with selected proposal (requires authentication)\n  app.post(\"/api/trips/:id/activities\", requireAuth, async (req, res) => {\n    try {\n      const trip_id = parseInt(req.params.id);\n      const userId = req.user!.id;\n      const tripActivityData = insertTripActivitySchema.parse(req.body);\n      \n      console.log('üîç Adicionando atividade √† viagem:', {\n        trip_id,\n        userId,\n        activity_id: tripActivityData.activity_id,\n        budgetProposalId: tripActivityData.budgetProposalId,\n        totalCost: tripActivityData.totalCost,\n        participants: tripActivityData.participants\n      });\n      \n      const tripActivity = await storage.addActivityToTrip({\n        ...tripActivityData,\n        trip_id,\n        addedBy: user_id\n      });\n      \n      console.log('‚úÖ Atividade adicionada com sucesso:', tripActivity);\n      res.status(201).json(tripActivity);\n    } catch (error) {\n      console.error('Erro ao adicionar atividade √† viagem:', error);\n      res.status(400).json({ message: \"Erro ao adicionar atividade √† viagem\" });\n    }\n  });\n\n  // Update trip activity (requires authentication)\n  app.patch(\"/api/trip-activities/:id\", requireAuth, async (req, res) => {\n    try {\n      const tripActivityId = parseInt(req.params.id);\n      const updates = req.body;\n      \n      const updatedTripActivity = await storage.updateTripActivity(tripActivityId, updates);\n      \n      if (!updatedTripActivity) {\n        return res.status(404).json({ message: \"Atividade da viagem n√£o encontrada\" });\n      }\n      \n      res.json(updatedTripActivity);\n    } catch (error) {\n      console.error('Erro ao atualizar atividade da viagem:', error);\n      res.status(400).json({ message: \"Erro ao atualizar atividade da viagem\" });\n    }\n  });\n\n  // Remove activity from trip (requires authentication)\n  app.delete(\"/api/trip-activities/:id\", requireAuth, async (req, res) => {\n    try {\n      const tripActivityId = parseInt(req.params.id);\n      const deleted = await storage.removeTripActivity(tripActivityId);\n      \n      if (!deleted) {\n        return res.status(404).json({ message: \"Atividade da viagem n√£o encontrada\" });\n      }\n      \n      res.json({ message: \"Atividade removida da viagem com sucesso\" });\n    } catch (error) {\n      console.error('Erro ao remover atividade da viagem:', error);\n      res.status(400).json({ message: \"Erro ao remover atividade da viagem\" });\n    }\n  });\n\n  // Get user trips in same location as activity (for adding activities to trips)\n  app.get(\"/api/users/:userId/trips-in-location\", requireAuth, async (req, res) => {\n    try {\n      const userId = parseInt(req.params.user_id || req.params.userId);\n      const { location } = req.query;\n      \n      if (!location) {\n        return res.status(400).json({ message: \"Localiza√ß√£o √© obrigat√≥ria\" });\n      }\n      \n      // Ensure user can only see their own trips\n      if (userId !== req.user!.id) {\n        return res.status(403).json({ message: \"Acesso negado\" });\n      }\n      \n      const trips = await storage.getUserTripsInLocation(userId, location as string);\n      res.json(trips);\n    } catch (error) {\n      console.error('Erro ao buscar viagens do usu√°rio na localiza√ß√£o:', error);\n      res.status(500).json({ message: \"Erro ao buscar viagens do usu√°rio\" });\n    }\n  });\n\n  // ===== TRAVEL COMPANIONS ROUTES =====\n\n  // Get user's travel companions\n  app.get(\"/api/user/travel-companions\", requireAuth, async (req, res) => {\n    try {\n      const userId = req.user!.id;\n      \n      // Get user's trips where they participated\n      const createdTrips = await storage.getTripsByCreator(userId);\n      const participatingTrips = await storage.getTripsByParticipant(userId);\n      \n      const allTrips = [...createdTrips, ...participatingTrips];\n      const companionsMap = new Map(); // Use Map to track unique companions\n      \n      // Get all unique companions from all trips\n      for (const trip of allTrips) {\n        const participants = await storage.getTripParticipants(trip.id);\n        for (const participant of participants) {\n          if (participant.user_id !== userId && participant.status === 'accepted') {\n            const user = await storage.getUserById(participant.user_id);\n            if (user) {\n              const companionId = user.id;\n              \n              // Check if we already have this companion\n              if (!companionsMap.has(companionId)) {\n                companionsMap.set(companionId, {\n                  id: user.id,\n                  full_name: user.full_name,\n                  username: user.username,\n                  email: user.email,\n                  location: user.location,\n                  profile_photo: user.profile_photo,\n                  is_verified: user.is_verified,\n                  bio: user.bio,\n                  average_rating: user.average_rating || \"0.0\",\n                  tripsCount: 1,\n                  lastTrip: trip.end_date\n                });\n              } else {\n                // Update trip count and last trip date if this trip is more recent\n                const existingCompanion = companionsMap.get(companionId);\n                existingCompanion.tripsCount += 1;\n                \n                // Update last trip if this trip is more recent\n                if (new Date(trip.end_date) > new Date(existingCompanion.lastTrip)) {\n                  existingCompanion.lastTrip = trip.end_date;\n                }\n              }\n            }\n          }\n        }\n      }\n      \n      const uniqueCompanions = Array.from(companionsMap.values());\n      res.json(uniqueCompanions);\n    } catch (error) {\n      console.error('Erro ao buscar companheiros de viagem:', error);\n      res.status(500).json({ message: \"Erro ao buscar companheiros de viagem\" });\n    }\n  });\n\n  // Rate a travel companion\n  app.post(\"/api/user/rate-companion\", requireAuth, async (req, res) => {\n    try {\n      const { companionId, rating, comment } = req.body;\n      const userId = req.user!.id;\n      \n      // Only verified users can create ratings\n      if (!req.user!.is_verified) {\n        return res.status(403).json({ message: \"Apenas usu√°rios verificados podem criar avalia√ß√µes\" });\n      }\n      \n      // Validate input\n      if (!companionId || !rating || rating < 1 || rating > 5) {\n        return res.status(400).json({ message: \"Dados inv√°lidos para avalia√ß√£o\" });\n      }\n      \n      // Check if users have traveled together\n      const userTrips = await storage.getTripsByCreator(userId);\n      const participatingTrips = await storage.getTripsByParticipant(userId);\n      const allUserTrips = [...userTrips, ...participatingTrips];\n      \n      let sharedTripId = null;\n      for (const trip of allUserTrips) {\n        const participants = await storage.getTripParticipants(trip.id);\n        if (participants.some(p => p.user_id === companionId && p.status === 'accepted')) {\n          sharedTripId = trip.id;\n          break;\n        }\n      }\n      \n      if (!sharedTripId) {\n        return res.status(400).json({ message: \"Voc√™ s√≥ pode avaliar companheiros de viagem que j√° viajaram com voc√™\" });\n      }\n      \n      // Check if user already rated this companion for this trip\n      console.log('üîç Verificando se usu√°rio j√° avaliou companheiro:', {\n        companionId,\n        userId,\n        sharedTripId\n      });\n      \n      const existingRating = await db\n        .select()\n        .from(userRatings)\n        .where(and(\n          eq(userRatings.rated_user_id, companionId),\n          eq(userRatings.rater_user_id, userId),\n          eq(userRatings.trip_id, sharedTripId)\n        ))\n        .limit(1);\n\n      console.log('üìã Avalia√ß√£o existente encontrada:', existingRating.length > 0 ? existingRating[0] : 'Nenhuma');\n\n      if (existingRating.length > 0) {\n        // Check if rating is within 7 days edit window\n        const daysSinceCreation = Math.floor((Date.now() - existingRating[0].created_at.getTime()) / (1000 * 60 * 60 * 24));\n        if (daysSinceCreation > 7) {\n          return res.status(403).json({ message: \"Per√≠odo de edi√ß√£o expirado (7 dias)\" });\n        }\n        \n        // Update existing rating\n        await db.update(userRatings)\n          .set({\n            rating: rating,\n            comment: comment || null,\n            updated_at: new Date()\n          })\n          .where(eq(userRatings.id, existingRating[0].id));\n        \n        console.log('üìù Avalia√ß√£o de companheiro atualizada:', {\n          rating_id: existingRating[0].id,\n          raterId: user_id,\n          rated_user_id: companionId,\n          rating,\n          comment: comment || null\n        });\n      } else {\n        // Create new rating\n        await db.insert(userRatings).values({\n          trip_id: sharedTripId,\n          rated_user_id: companionId,\n          rater_user_id: user_id,\n          rating: rating,\n          comment: comment || null,\n          is_hidden: false,\n          report_count: 0\n        });\n        \n        console.log('üìù Avalia√ß√£o de companheiro criada:', {\n          trip_id: sharedTripId,\n          rated_user_id: companionId,\n          rater_user_id: user_id,\n          rating: rating,\n          comment: comment || null\n        });\n      }\n      \n      // Update user's average rating\n      const allUserRatings = await db\n        .select({ rating: userRatings.rating })\n        .from(userRatings)\n        .where(and(\n          eq(userRatings.rated_user_id, companionId),\n          eq(userRatings.is_hidden, false)\n        ));\n\n      const average_rating = allUserRatings.length > 0 \n        ? parseFloat((allUserRatings.reduce((sum, r) => sum + r.rating, 0) / allUserRatings.length).toFixed(2))\n        : 5.0;\n\n      await db.update(users)\n        .set({\n          average_rating: average_rating.toString(),\n          total_ratings: allUserRatings.length\n        })\n        .where(eq(users.id, companionId));\n      \n      console.log('üìä M√©dia de avalia√ß√µes atualizada para usu√°rio', companionId, ':', average_rating);\n      \n      res.json({ \n        message: \"Avalia√ß√£o enviada com sucesso!\",\n        average_rating: average_rating\n      });\n    } catch (error) {\n      console.error('Erro ao avaliar companheiro:', error);\n      res.status(500).json({ message: \"Erro ao enviar avalia√ß√£o\" });\n    }\n  });\n\n  // Get user ratings for a specific user\n  app.get(\"/api/user/:userId/ratings\", async (req, res) => {\n    try {\n      const userId = parseInt(req.params.user_id || req.params.userId);\n      const limit = parseInt(req.query.limit as string) || 10;\n      const offset = parseInt(req.query.offset as string) || 0;\n\n      const ratings = await db\n        .select({\n          id: userRatings.id,\n          rating: userRatings.rating,\n          comment: userRatings.comment,\n          created_at: userRatings.created_at,\n          rater: {\n            id: users.id,\n            username: users.username,\n            full_name: users.full_name,\n            profile_photo: users.profile_photo,\n            is_verified: users.is_verified\n          }\n        })\n        .from(userRatings)\n        .innerJoin(users, eq(userRatings.rater_user_id, users.id))\n        .where(and(\n          eq(userRatings.rated_user_id, userId),\n          eq(userRatings.is_hidden, false)\n        ))\n        .orderBy(desc(userRatings.created_at))\n        .limit(limit)\n        .offset(offset);\n\n      res.json(ratings);\n    } catch (error) {\n      console.error('‚ùå Erro ao buscar avalia√ß√µes do usu√°rio:', error);\n      res.status(500).json({ message: \"Erro interno do servidor\" });\n    }\n  });\n\n  // Edit user rating (within 7 days)\n  app.put(\"/api/user/ratings/:rating_id\", requireAuth, async (req, res) => {\n    try {\n      const rating_id = parseInt(req.params.rating_id);\n      const userId = req.user!.id;\n      const { rating, comment } = req.body;\n      \n      // Validate input\n      if (!rating || rating < 1 || rating > 5) {\n        return res.status(400).json({ message: \"Avalia√ß√£o deve ser entre 1 e 5 estrelas\" });\n      }\n      \n      // Check if rating exists and belongs to user\n      const existingRating = await db\n        .select()\n        .from(userRatings)\n        .where(and(\n          eq(userRatings.id, rating_id),\n          eq(userRatings.rater_user_id, userId)\n        ))\n        .limit(1);\n      \n      if (existingRating.length === 0) {\n        return res.status(404).json({ message: \"Avalia√ß√£o n√£o encontrada\" });\n      }\n      \n      const ratingData = existingRating[0];\n      \n      // Check if rating is within 7 days edit window\n      const daysSinceCreation = Math.floor((Date.now() - ratingData.created_at.getTime()) / (1000 * 60 * 60 * 24));\n      if (daysSinceCreation > 7) {\n        return res.status(403).json({ message: \"Per√≠odo de edi√ß√£o expirado (7 dias)\" });\n      }\n      \n      await db.update(userRatings)\n        .set({\n          rating: rating,\n          comment: comment || null,\n          updated_at: new Date()\n        })\n        .where(eq(userRatings.id, rating_id));\n      \n      // Update user's average rating\n      const allUserRatings = await db\n        .select({ rating: userRatings.rating })\n        .from(userRatings)\n        .where(and(\n          eq(userRatings.rated_user_id, ratingData.rated_user_id),\n          eq(userRatings.is_hidden, false)\n        ));\n\n      const average_rating = allUserRatings.length > 0 \n        ? parseFloat((allUserRatings.reduce((sum, r) => sum + r.rating, 0) / allUserRatings.length).toFixed(2))\n        : 5.0;\n\n      await db.update(users)\n        .set({\n          average_rating: average_rating,\n          total_ratings: allUserRatings.length\n        })\n        .where(eq(users.id, ratingData.rated_user_id));\n      \n      res.json({ message: \"Avalia√ß√£o atualizada com sucesso\" });\n    } catch (error) {\n      console.error('Erro ao editar avalia√ß√£o:', error);\n      res.status(400).json({ message: \"Erro ao editar avalia√ß√£o\" });\n    }\n  });\n\n  // Delete user rating (within 7 days)\n  app.delete(\"/api/user/ratings/:rating_id\", requireAuth, async (req, res) => {\n    try {\n      const rating_id = parseInt(req.params.rating_id);\n      const userId = req.user!.id;\n      \n      // Check if rating exists and belongs to user\n      const existingRating = await db\n        .select()\n        .from(userRatings)\n        .where(and(\n          eq(userRatings.id, rating_id),\n          eq(userRatings.rater_user_id, userId)\n        ))\n        .limit(1);\n      \n      if (existingRating.length === 0) {\n        return res.status(404).json({ message: \"Avalia√ß√£o n√£o encontrada\" });\n      }\n      \n      const ratingData = existingRating[0];\n      \n      // Check if rating is within 7 days edit window\n      const daysSinceCreation = Math.floor((Date.now() - ratingData.created_at.getTime()) / (1000 * 60 * 60 * 24));\n      if (daysSinceCreation > 7) {\n        return res.status(403).json({ message: \"Per√≠odo de exclus√£o expirado (7 dias)\" });\n      }\n      \n      await db\n        .delete(userRatings)\n        .where(eq(userRatings.id, rating_id));\n      \n      // Update user's average rating\n      const allUserRatings = await db\n        .select({ rating: userRatings.rating })\n        .from(userRatings)\n        .where(and(\n          eq(userRatings.rated_user_id, ratingData.rated_user_id),\n          eq(userRatings.is_hidden, false)\n        ));\n\n      const average_rating = allUserRatings.length > 0 \n        ? parseFloat((allUserRatings.reduce((sum, r) => sum + r.rating, 0) / allUserRatings.length).toFixed(2))\n        : 5.0;\n\n      await db.update(users)\n        .set({\n          average_rating: average_rating,\n          total_ratings: allUserRatings.length\n        })\n        .where(eq(users.id, ratingData.rated_user_id));\n      \n      res.json({ message: \"Avalia√ß√£o exclu√≠da com sucesso\" });\n    } catch (error) {\n      console.error('Erro ao excluir avalia√ß√£o:', error);\n      res.status(500).json({ message: \"Erro ao excluir avalia√ß√£o\" });\n    }\n  });\n\n  // Remove a travel companion from network\n  app.delete(\"/api/user/remove-companion/:companionId\", requireAuth, async (req, res) => {\n    try {\n      const companionId = parseInt(req.params.companionId);\n      const userId = req.user!.id;\n      \n      // Check if companion exists\n      const companion = await storage.getUserById(companionId);\n      if (!companion) {\n        return res.status(404).json({ message: \"Companheiro n√£o encontrado\" });\n      }\n      \n      // For now, we'll just return success - in a real implementation,\n      // this would remove from a companions/connections table\n      console.log(`üóëÔ∏è Removendo companheiro ${companionId} da rede do usu√°rio ${userId}`);\n      \n      res.json({ \n        message: \"Companheiro removido da sua rede com sucesso!\",\n        removedCompanion: companion.full_name\n      });\n    } catch (error) {\n      console.error('Erro ao remover companheiro:', error);\n      res.status(500).json({ message: \"Erro ao remover companheiro\" });\n    }\n  });\n\n  // ===== REFERRAL CODE VALIDATION ROUTES =====\n\n  // Initialize default referral codes (development helper)\n  app.post(\"/api/init-referral-codes\", async (req, res) => {\n    try {\n      const codes = [\n        { code: 'BETA2025', maxUses: 100 },\n        { code: 'VIAJANTE', maxUses: 50 },\n        { code: 'AMIGO123', maxUses: 10 },\n        { code: 'TESTE', maxUses: 1 },\n        { code: 'EXPLORER', maxUses: 25 },\n      ];\n\n      let created = 0;\n      for (const codeData of codes) {\n        // Check if code already exists\n        const existing = await db.select()\n          .from(referralCodes)\n          .where(eq(referralCodes.code, codeData.code))\n          .limit(1);\n\n        if (existing.length === 0) {\n          await db.insert(referralCodes).values({\n            code: codeData.code,\n            maxUses: codeData.maxUses,\n            currentUses: 0,\n            isActive: true,\n            createdBy: null,\n            expiresAt: null,\n          });\n          created++;\n        }\n      }\n\n      res.json({ \n        message: `${created} c√≥digos de indica√ß√£o criados com sucesso`,\n        codes: codes.map(c => c.code)\n      });\n    } catch (error) {\n      console.error('Erro ao criar c√≥digos de indica√ß√£o:', error);\n      res.status(500).json({ message: \"Erro ao criar c√≥digos de indica√ß√£o\" });\n    }\n  });\n\n  // Validate referral code\n  app.post(\"/api/validate-referral\", async (req, res) => {\n    try {\n      const { referralCode } = req.body;\n      \n      if (!referralCode) {\n        return res.status(400).json({ message: \"C√≥digo de indica√ß√£o √© obrigat√≥rio\" });\n      }\n\n      const referral = await db.select()\n        .from(referralCodes)\n        .where(\n          and(\n            eq(referralCodes.code, referralCode),\n            eq(referralCodes.isActive, true)\n          )\n        )\n        .limit(1);\n\n      if (referral.length === 0) {\n        return res.status(400).json({ \n          message: \"C√≥digo de indica√ß√£o inv√°lido\",\n          isValid: false\n        });\n      }\n\n      const code = referral[0];\n      \n      // Check if code is expired\n      if (code.expiresAt && new Date() > code.expiresAt) {\n        return res.status(400).json({ \n          message: \"C√≥digo de indica√ß√£o expirado\",\n          isValid: false\n        });\n      }\n\n      // Check if code has reached max uses\n      if (code.currentUses >= code.maxUses) {\n        return res.status(400).json({ \n          message: \"C√≥digo de indica√ß√£o esgotado\",\n          isValid: false\n        });\n      }\n\n      res.json({ \n        message: \"C√≥digo v√°lido\",\n        isValid: true\n      });\n    } catch (error) {\n      console.error('Erro ao validar c√≥digo de indica√ß√£o:', error);\n      res.status(500).json({ message: \"Erro interno do servidor\" });\n    }\n  });\n\n  // Add to interest list\n  app.post(\"/api/interest-list\", async (req, res) => {\n    try {\n      const { full_name, email, phone, referralCode } = req.body;\n      \n      if (!full_name || !email || !phone) {\n        return res.status(400).json({ message: \"Todos os campos s√£o obrigat√≥rios\" });\n      }\n\n      // Check if email already exists in interest list\n      const existingEntry = await db.select()\n        .from(interestList)\n        .where(eq(interestList.email, email))\n        .limit(1);\n\n      if (existingEntry.length > 0) {\n        return res.status(400).json({ message: \"Este email j√° est√° na lista de interesse\" });\n      }\n\n      // Add to interest list\n      await db.insert(interestList).values({\n        full_name,\n        email,\n        phone,\n        referralCode: referralCode || null,\n        status: \"pending\"\n      });\n\n      res.json({ \n        message: \"Obrigado pelo interesse! Entraremos em contato em breve.\",\n        success: true\n      });\n    } catch (error) {\n      console.error('Erro ao adicionar √† lista de interesse:', error);\n      res.status(500).json({ message: \"Erro interno do servidor\" });\n    }\n  });\n\n  // User Requests endpoint\n  app.get(\"/api/user-requests\", requireAuth, async (req, res) => {\n    try {\n      const userId = req.user!.id;\n      const requests = await storage.getUserTripRequests(userId);\n      res.json(requests);\n    } catch (error) {\n      console.error('Erro ao buscar solicita√ß√µes:', error);\n      res.status(500).json({ message: \"Erro ao buscar solicita√ß√µes\" });\n    }\n  });\n\n  // Notifications endpoint (placeholder for now)\n  app.get(\"/api/notifications\", requireAuth, async (req, res) => {\n    try {\n      // For now, return empty array as notifications system is not fully implemented\n      res.json([]);\n    } catch (error) {\n      console.error('Erro ao buscar notifica√ß√µes:', error);\n      res.status(500).json({ message: \"Erro ao buscar notifica√ß√µes\" });\n    }\n  });\n\n  // ===== ROTA REMOVIDA - SEED CONCLU√çDO =====\n  /*\n  app.post(\"/api/admin/seed-activities\", async (req, res) => {\n    try {\n      console.log(\"üå± Iniciando seed de atividades...\");\n      \n      // Buscar destinos existentes\n      const destinations = await storage.getDestinations();\n      console.log(`üìç Encontrados ${destinations.length} destinos`);\n\n      const atividadesPorDestino = {\n        \"Rio de Janeiro\": [\n          {\n            title: \"Cristo Redentor / Corcovado\",\n            description: \"Visita ao ic√¥nico Cristo Redentor no topo do Corcovado, uma das sete maravilhas do mundo moderno. Desfrute de vistas panor√¢micas espetaculares da cidade e ba√≠a de Guanabara.\",\n            category: \"pontos_turisticos\",\n            duration: \"3-4 horas\",\n            cover_image: \"https://images.unsplash.com/photo-1539650116574-75c0c6d15f83?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n            images: [\"https://images.unsplash.com/photo-1539650116574-75c0c6d15f83?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"],\n            propostas: [\n              { title: \"Econ√¥mico\", price: 85, description: \"Van oficial b√°sica at√© o Cristo Redentor\", inclusions: [\"Transporte em van oficial\", \"Entrada no santu√°rio\", \"Seguro b√°sico\"] },\n              { title: \"Completo\", price: 160, description: \"Trem panor√¢mico + entrada + guia\", inclusions: [\"Trem do Corcovado\", \"Entrada no santu√°rio\", \"Guia tur√≠stico\", \"Seguro\"] },\n              { title: \"Premium\", price: 320, description: \"Tour privativo com transporte executivo\", inclusions: [\"Transporte privativo\", \"Guia especializado\", \"Fotografias profissionais\", \"Lanche gourmet\"] }\n            ]\n          },\n          {\n            title: \"P√£o de A√ß√∫car (Bondinho)\",\n            description: \"Passeio no famoso bondinho do P√£o de A√ß√∫car com vistas espetaculares de 360¬∞ da cidade, ba√≠a de Guanabara e praias.\",\n            category: \"pontos_turisticos\",\n            duration: \"2-3 horas\",\n            cover_image: \"https://images.unsplash.com/photo-1544737151-6e4b9ee48424?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n            images: [\"https://images.unsplash.com/photo-1544737151-6e4b9ee48424?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"],\n            propostas: [\n              { title: \"Econ√¥mico\", price: 120, description: \"Ingresso padr√£o do bondinho\", inclusions: [\"Bondinho ida e volta\", \"Acesso aos mirantes\"] },\n              { title: \"Completo\", price: 190, description: \"Bondinho + guia tur√≠stico\", inclusions: [\"Bondinho ida e volta\", \"Guia especializado\", \"Hist√≥ria e curiosidades\"] },\n              { title: \"Premium\", price: 350, description: \"Bondinho + tour + passeio de helic√≥ptero\", inclusions: [\"Bondinho\", \"Guia VIP\", \"Sobrevoo de helic√≥ptero\", \"Drinks premium\"] }\n            ]\n          },\n          {\n            title: \"Trilha Pedra Bonita ou Dois Irm√£os\",\n            description: \"Trilhas com as melhores vistas panor√¢micas do Rio de Janeiro. Ideal para amantes da natureza e fotografia.\",\n            category: \"hiking\",\n            duration: \"4-6 horas\",\n            cover_image: \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n            images: [\"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"],\n            propostas: [\n              { title: \"Econ√¥mico\", price: 0, description: \"Trilha autoguiada com mapa\", inclusions: [\"Mapa detalhado\", \"Dicas de seguran√ßa\"] },\n              { title: \"Completo\", price: 100, description: \"Trilha com guia local\", inclusions: [\"Guia especializado\", \"Kit primeiros socorros\", \"√Ågua\"] },\n              { title: \"Premium\", price: 280, description: \"Tour privado com transporte\", inclusions: [\"Transporte ida/volta\", \"Guia fot√≥grafo\", \"Lanche trilheiro\", \"Seguro\"] }\n            ]\n          },\n          {\n            title: \"Praias de Copacabana e Ipanema + Esportes\",\n            description: \"Experi√™ncia completa nas praias mais famosas do mundo. Atividades aqu√°ticas, esportes na areia e cultura carioca.\",\n            category: \"water_sports\",\n            duration: \"Dia inteiro\",\n            cover_image: \"https://images.unsplash.com/photo-1544077960-604201fe74bc?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n            images: [\"https://images.unsplash.com/photo-1544077960-604201fe74bc?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"],\n            propostas: [\n              { title: \"Econ√¥mico\", price: 0, description: \"Acesso livre √†s praias\", inclusions: [\"Acesso livre\", \"Caminhada guiada\", \"Dicas locais\"] },\n              { title: \"Completo\", price: 100, description: \"Aula de surf ou aluguel de bike\", inclusions: [\"Aula de surf (2h)\", \"Ou aluguel de bike\", \"Equipamentos inclu√≠dos\"] },\n              { title: \"Premium\", price: 300, description: \"Passeio de lancha com drinks\", inclusions: [\"Passeio de lancha\", \"Open bar\", \"Petiscos\", \"Equipamentos aqu√°ticos\"] }\n            ]\n          },\n          {\n            title: \"Tour Cultural Centro Hist√≥rico\",\n            description: \"Descubra a rica hist√≥ria do Rio visitando o Theatro Municipal, Museu do Amanh√£ e outros marcos culturais.\",\n            category: \"cultural\",\n            duration: \"4-5 horas\",\n            cover_image: \"https://images.unsplash.com/photo-1539037116277-4db20889f2d4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n            images: [\"https://images.unsplash.com/photo-1539037116277-4db20889f2d4?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"],\n            propostas: [\n              { title: \"Econ√¥mico\", price: 30, description: \"Ingressos b√°sicos\", inclusions: [\"Entrada museus\", \"Mapa autoguiado\"] },\n              { title: \"Completo\", price: 90, description: \"Tour guiado + transporte\", inclusions: [\"Guia especializado\", \"Transporte\", \"Ingressos inclu√≠dos\"] },\n              { title: \"Premium\", price: 220, description: \"Tour VIP + jantar + transporte executivo\", inclusions: [\"Guia VIP\", \"Transporte executivo\", \"Jantar t√≠pico\", \"Bebidas inclu√≠das\"] }\n            ]\n          }\n        ],\n        \"S√£o Paulo\": [\n          {\n            title: \"MASP + Avenida Paulista\",\n            description: \"Visite o ic√¥nico Museu de Arte de S√£o Paulo e explore a Avenida Paulista, cora√ß√£o cultural e financeiro da maior metr√≥pole da Am√©rica do Sul.\",\n            category: \"cultural\",\n            duration: \"3-4 horas\",\n            cover_image: \"https://images.unsplash.com/photo-1564688169631-7e9e0b8f33a2?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n            images: [\"https://images.unsplash.com/photo-1564688169631-7e9e0b8f33a2?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"],\n            propostas: [\n              { title: \"Econ√¥mico\", price: 40, description: \"Entrada simples no MASP\", inclusions: [\"Ingresso MASP\", \"Mapa da Paulista\"] },\n              { title: \"Completo\", price: 90, description: \"Visita guiada + caf√©\", inclusions: [\"Visita guiada\", \"Caf√© incluso\", \"Material informativo\"] },\n              { title: \"Premium\", price: 250, description: \"Tour + almo√ßo em rooftop\", inclusions: [\"Tour VIP\", \"Almo√ßo panor√¢mico\", \"Transporte\", \"Bebidas\"] }\n            ]\n          },\n          {\n            title: \"Parque Ibirapuera + Museus\",\n            description: \"Explore o principal parque urbano de S√£o Paulo e seus renomados museus: MAM, Museu Afro Brasil, Oca e outros espa√ßos culturais.\",\n            category: \"cultural\",\n            duration: \"Dia inteiro\",\n            cover_image: \"https://images.unsplash.com/photo-1596445827019-ab19d12cc2ef?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n            images: [\"https://images.unsplash.com/photo-1596445827019-ab19d12cc2ef?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"],\n            propostas: [\n              { title: \"Econ√¥mico\", price: 0, description: \"Acesso livre ao parque\", inclusions: [\"Caminhada livre\", \"Mapa do parque\"] },\n              { title: \"Completo\", price: 70, description: \"Bike + ingressos museus\", inclusions: [\"Aluguel de bike (4h)\", \"Ingressos museus\", \"Kit lanche\"] },\n              { title: \"Premium\", price: 180, description: \"Tour guiado + transporte\", inclusions: [\"Guia especializado\", \"Transporte\", \"Todos os museus\", \"Almo√ßo\"] }\n            ]\n          },\n          {\n            title: \"Mercado Municipal + Centro Hist√≥rico\",\n            description: \"Degusta√ß√£o gastron√¥mica no famoso Mercad√£o e tour pelo centro hist√≥rico de S√£o Paulo.\",\n            category: \"food_tours\",\n            duration: \"4-5 horas\",\n            cover_image: \"https://images.unsplash.com/photo-1566740933430-b5e70b06d2d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n            images: [\"https://images.unsplash.com/photo-1566740933430-b5e70b06d2d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"],\n            propostas: [\n              { title: \"Econ√¥mico\", price: 0, description: \"Visita por conta pr√≥pria\", inclusions: [\"Roteiro sugerido\", \"Dicas gastron√¥micas\"] },\n              { title: \"Completo\", price: 90, description: \"Tour guiado com degusta√ß√£o\", inclusions: [\"Guia gastron√¥mico\", \"Degusta√ß√µes inclu√≠das\", \"Hist√≥ria local\"] },\n              { title: \"Premium\", price: 240, description: \"Tour gastron√¥mico VIP + transporte\", inclusions: [\"Guia chef\", \"Degusta√ß√µes premium\", \"Transporte\", \"Bebidas harmonizadas\"] }\n            ]\n          }\n        ],\n        \"Foz do Igua√ßu\": [\n          {\n            title: \"Cataratas do Igua√ßu (lado brasileiro)\",\n            description: \"Uma das mais impressionantes quedas d'√°gua do mundo com 275 quedas d'√°gua na fronteira Brasil-Argentina. Patrim√¥nio Mundial da UNESCO.\",\n            category: \"nature\",\n            duration: \"Dia inteiro\",\n            cover_image: \"https://images.unsplash.com/photo-1520637836862-4d197d17c86a?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n            images: [\"https://images.unsplash.com/photo-1520637836862-4d197d17c86a?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"],\n            propostas: [\n              { title: \"Econ√¥mico\", price: 85, description: \"Entrada no parque nacional\", inclusions: [\"Entrada no parque\", \"Trilha das cataratas\", \"Transporte interno\"] },\n              { title: \"Completo\", price: 160, description: \"Parque + transporte\", inclusions: [\"Entrada parque\", \"Transporte hotel-parque\", \"Guia b√°sico\"] },\n              { title: \"Premium\", price: 350, description: \"Tour completo + Macuco Safari\", inclusions: [\"Entrada parque\", \"Macuco Safari\", \"Almo√ßo\", \"Transporte\", \"Guia especializado\"] }\n            ]\n          },\n          {\n            title: \"Parque das Aves\",\n            description: \"Santu√°rio de aves da Mata Atl√¢ntica com mais de 1.320 aves de 143 esp√©cies. Experi√™ncia imersiva √∫nica na Am√©rica Latina.\",\n            category: \"wildlife\",\n            duration: \"3-4 horas\",\n            cover_image: \"https://images.unsplash.com/photo-1574263867128-ba1b540c5dd7?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n            images: [\"https://images.unsplash.com/photo-1574263867128-ba1b540c5dd7?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"],\n            propostas: [\n              { title: \"Econ√¥mico\", price: 90, description: \"Ingresso padr√£o\", inclusions: [\"Entrada no parque\", \"Trilhas livres\", \"Mapa do local\"] },\n              { title: \"Completo\", price: 140, description: \"Ingresso + traslado\", inclusions: [\"Entrada\", \"Transporte hotel-parque\", \"Audio guide\"] },\n              { title: \"Premium\", price: 250, description: \"Visita guiada + bastidores\", inclusions: [\"Entrada VIP\", \"Tour dos bastidores\", \"Encontro com tratadores\", \"Transporte\"] }\n            ]\n          }\n        ]\n      };\n\n      let totalAtividades = 0;\n      let totalPropostas = 0;\n      let totalReviews = 0;\n\n      for (const [nomeDestino, atividades] of Object.entries(atividadesPorDestino)) {\n        console.log(`üèôÔ∏è Processando ${nomeDestino}...`);\n        \n        // Encontrar o destino correspondente\n        const destino = destinations.find(d => \n          d.name?.toLowerCase().includes(nomeDestino.toLowerCase()) ||\n          (nomeDestino === \"Rio de Janeiro\" && d.name?.toLowerCase().includes(\"rio\")) ||\n          (nomeDestino === \"S√£o Paulo\" && d.name?.toLowerCase().includes(\"s√£o paulo\")) ||\n          (nomeDestino === \"Foz do Igua√ßu\" && d.name?.toLowerCase().includes(\"foz\"))\n        );\n\n        if (!destino) {\n          console.log(`‚ùå Destino n√£o encontrado: ${nomeDestino}`);\n          continue;\n        }\n\n        console.log(`‚úÖ Destino encontrado: ${destino.name} (ID: ${destino.id})`);\n\n        for (const atividade of atividades) {\n          try {\n            // Inserir atividade\n            const [atividadeInserida] = await db.insert(activities).values({\n              title: atividade.title,\n              description: atividade.description,\n              destination_id: destino.id,\n              category: atividade.category as any,\n              difficulty_level: \"easy\",\n              duration: atividade.duration,\n              min_participants: 1,\n              max_participants: 20,\n              languages: [\"Portugu√™s\", \"Ingl√™s\", \"Espanhol\"],\n              inclusions: [\"Acompanhamento profissional\", \"Seguro b√°sico\", \"Suporte 24h\"],\n              exclusions: [\"Alimenta√ß√£o (quando n√£o especificada)\", \"Transporte pessoal\"],\n              requirements: [\"Idade m√≠nima: 12 anos\"],\n              cancellation_policy: \"Cancelamento gratuito at√© 24h antes\",\n              contact_info: {\n                email: \"atividades@partiutrip.com\",\n                phone: \"+55 11 99999-8888\",\n                whatsapp: \"+55 11 99999-8888\"\n              },\n              cover_image: atividade.cover_image,\n              images: atividade.images,\n              created_by_id: 9, // Usu√°rio tom\n              is_active: true,\n              // Campos herdados do destino\n              destination_name: destino.name,\n              city: destino.name,\n              state: destino.state,\n              country: destino.country,\n              country_type: destino.country_type as any,\n              region: destino.region,\n              continent: destino.continent\n            }).returning();\n\n            console.log(`  ‚úÖ Atividade inserida: ${atividade.title} (ID: ${atividadeInserida.id})`);\n            totalAtividades++;\n\n            // Inserir propostas de or√ßamento\n            for (const proposta of atividade.propostas) {\n              await db.insert(activityBudgetProposals).values({\n                activity_id: atividadeInserida.id,\n                created_by: 9,\n                title: proposta.title,\n                description: proposta.description,\n                price_type: \"per_person\",\n                amount: proposta.price.toString(),\n                currency: \"BRL\",\n                inclusions: proposta.inclusions,\n                exclusions: [\"Despesas pessoais\", \"Gorjetas\"],\n                is_active: true,\n                votes: Math.floor(Math.random() * 50) + 15\n              });\n              console.log(`    üí∞ Proposta criada: ${proposta.title} - R$ ${proposta.price}`);\n              totalPropostas++;\n            }\n\n            // Inserir reviews de exemplo\n            const reviewsExemplo = [\n              {\n                rating: 5,\n                review: \"Experi√™ncia incr√≠vel! Vista espetacular e atendimento excepcional.\",\n                photos: [\"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=400\"],\n                visit_date: new Date(\"2024-12-15\"),\n              },\n              {\n                rating: 4,\n                review: \"Muito bom! A √∫nica observa√ß√£o √© que estava bem cheio, mas mesmo assim recomendo.\",\n                photos: [],\n                visit_date: new Date(\"2024-12-10\"),\n              },\n              {\n                rating: 5,\n                review: \"Perfeito! Superou todas as expectativas. Voltarei com certeza!\",\n                photos: [\"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=400\"],\n                visit_date: new Date(\"2024-12-08\"),\n              }\n            ];\n\n            for (const review of reviewsExemplo) {\n              await db.insert(activityReviews).values({\n                activity_id: atividadeInserida.id,\n                user_id: 9,\n                rating: review.rating,\n                review: review.review,\n                photos: review.photos,\n                visit_date: review.visit_date,\n                helpful_votes: Math.floor(Math.random() * 20) + 5,\n                is_verified: true\n              });\n              totalReviews++;\n            }\n\n            // Atualizar contadores da atividade\n            await db.update(activities)\n              .set({\n                average_rating: \"4.7\",\n                total_ratings: reviewsExemplo.length\n              })\n              .where(eq(activities.id, atividadeInserida.id));\n\n          } catch (error) {\n            console.error(`‚ùå Erro ao inserir atividade ${atividade.title}:`, error);\n          }\n        }\n      }\n\n      const resultado = {\n        success: true,\n        message: \"Atividades cadastradas com sucesso!\",\n        totalAtividades,\n        totalPropostas,\n        totalReviews,\n        mediaPropostasPorAtividade: (totalPropostas/totalAtividades).toFixed(1)\n      };\n\n      console.log(\"üéâ Seed conclu√≠do:\", resultado);\n      res.json(resultado);\n\n    } catch (error) {\n      console.error(\"‚ùå Erro no seed de atividades:\", error);\n      res.status(500).json({ \n        success: false, \n        message: \"Erro ao cadastrar atividades\", \n        error: error instanceof Error ? error.message : \"Erro desconhecido\" \n      });\n    }\n  });\n  */\n\n  // ===== ENDPOINT DE ESTAT√çSTICAS DE ATIVIDADES =====\n  app.get(\"/api/activities/stats\", async (req, res) => {\n    try {\n      // Contar atividades ativas\n      const totalActivities = await db\n        .select({ count: sql`COUNT(*)` })\n        .from(activities)\n        .where(eq(activities.is_active, true));\n\n      // Contar propostas ativas\n      const totalProposals = await db\n        .select({ count: sql`COUNT(*)` })\n        .from(activityBudgetProposals)\n        .where(eq(activityBudgetProposals.is_active, true));\n\n      // Contar reviews\n      const totalReviews = await db\n        .select({ count: sql`COUNT(*)` })\n        .from(activityReviews)\n        .where(eq(activityReviews.is_hidden, false));\n\n      // Estat√≠sticas por categoria\n      const byCategory = await db\n        .select({\n          category: activities.category,\n          count: sql`COUNT(*)`\n        })\n        .from(activities)\n        .where(eq(activities.is_active, true))\n        .groupBy(activities.category);\n\n      // Estat√≠sticas por destino (consolidando nomes similares)\n      const byDestination = await db\n        .select({\n          destination: activities.destination_name,\n          count: sql`COUNT(*)`\n        })\n        .from(activities)\n        .where(eq(activities.is_active, true))\n        .groupBy(activities.destination_name)\n        .limit(10);\n\n      // Consolidar destinos similares\n      const consolidatedDestinations: Record<string, number> = {};\n      byDestination.forEach(item => {\n        let dest = item.destination || 'Sem destino';\n        \n        // Normalizar nomes de destinos\n        if (dest.includes('S√£o Paulo')) {\n          dest = 'S√£o Paulo';\n        } else if (dest.includes('Rio de Janeiro')) {\n          dest = 'Rio de Janeiro';\n        } else if (dest.includes('Salvador')) {\n          dest = 'Salvador';\n        }\n        \n        consolidatedDestinations[dest] = (consolidatedDestinations[dest] || 0) + Number(item.count);\n      });\n\n      const stats = {\n        totalActivities: Number(totalActivities[0]?.count || 0),\n        totalProposals: Number(totalProposals[0]?.count || 0),\n        totalReviews: Number(totalReviews[0]?.count || 0),\n        avgProposalsPerActivity: Number(totalActivities[0]?.count) > 0 ? \n          Math.round((Number(totalProposals[0]?.count || 0) / Number(totalActivities[0]?.count)) * 10) / 10 : 0,\n        byCategory: byCategory.reduce((acc, item) => {\n          acc[item.category] = Number(item.count);\n          return acc;\n        }, {} as Record<string, number>),\n        byDestination: consolidatedDestinations\n      };\n\n      res.json(stats);\n    } catch (error) {\n      console.error('Erro ao buscar estat√≠sticas de atividades:', error);\n      res.status(500).json({ message: \"Erro ao buscar estat√≠sticas de atividades\" });\n    }\n  });\n\n  // ===== ENDPOINT PARA CORRIGIR DESTINOS DUPLICADOS =====\n  app.post(\"/api/admin/fix-destinations\", async (req, res) => {\n    try {\n      console.log(\"üîß Corrigindo destinos duplicados...\");\n      \n      // Corrigir S√£o Paulo\n      await db.update(activities)\n        .set({ destination_name: \"S√£o Paulo\" })\n        .where(eq(activities.destination_name, \"S√£o Paulo, SP\"));\n      \n      // Corrigir Rio de Janeiro\n      await db.update(activities)\n        .set({ destination_name: \"Rio de Janeiro\" })\n        .where(eq(activities.destination_name, \"Rio de Janeiro, RJ\"));\n      \n      // Corrigir Salvador\n      await db.update(activities)\n        .set({ destination_name: \"Salvador\" })\n        .where(eq(activities.destination_name, \"Salvador, BA\"));\n\n      // Contar atividades ap√≥s corre√ß√£o\n      const stats = await db\n        .select({\n          destination: activities.destination_name,\n          count: sql`COUNT(*)`\n        })\n        .from(activities)\n        .where(eq(activities.is_active, true))\n        .groupBy(activities.destination_name);\n\n      console.log(\"‚úÖ Destinos corrigidos:\");\n      stats.forEach(stat => {\n        console.log(`  ${stat.destination}: ${stat.count} atividades`);\n      });\n\n      res.json({ \n        success: true, \n        message: \"Destinos corrigidos com sucesso\",\n        stats: stats.reduce((acc, item) => {\n          acc[item.destination || 'Sem destino'] = Number(item.count);\n          return acc;\n        }, {} as Record<string, number>)\n      });\n    } catch (error) {\n      console.error('Erro ao corrigir destinos:', error);\n      res.status(500).json({ message: \"Erro ao corrigir destinos\" });\n    }\n  });\n\n  const httpServer = createServer(app);\n\n  return httpServer;\n}\n","size_bytes":123697},"server/run-comprehensive-seed.ts":{"content":"import { createRealisticSeedData } from \"./comprehensive-seed-realistic\";\nimport { resetDatabase } from \"./reset-database\";\n\nasync function main() {\n  console.log(\"üöÄ Iniciando processo de seed completo...\");\n  \n  try {\n    // Reset database first\n    console.log(\"üîÑ Resetando banco de dados...\");\n    await resetDatabase();\n    \n    // Create comprehensive seed data\n    console.log(\"üå± Criando dados de teste realistas...\");\n    await createRealisticSeedData();\n    \n    console.log(\"‚úÖ Processo completo de seed finalizado com sucesso!\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro no processo de seed:\", error);\n    process.exit(1);\n  }\n  \n  process.exit(0);\n}\n\nmain().catch(console.error);","size_bytes":712},"server/run-sync-participants.ts":{"content":"import { testConnection, initializeTables } from \"./db.js\";\nimport { syncParticipantsCount } from \"./sync-participants.js\";\n\nasync function main() {\n  try {\n    console.log(\"üîó Conectando ao MySQL...\");\n    await testConnection();\n    console.log(\"üèóÔ∏è Inicializando tabelas MySQL...\");\n    await initializeTables();\n    \n    console.log(\"üîÑ Executando sincroniza√ß√£o de participantes...\");\n    await syncParticipantsCount();\n    \n    console.log(\"‚úÖ Sincroniza√ß√£o conclu√≠da!\");\n  } catch (error) {\n    console.error(\"‚ùå Erro na sincroniza√ß√£o:\", error);\n    process.exit(1);\n  }\n  \n  process.exit(0);\n}\n\nmain().catch(console.error);","size_bytes":647},"server/schema-standardization-migration.ts":{"content":"#!/usr/bin/env tsx\nimport { db } from \"./db\";\nimport { sql } from \"drizzle-orm\";\n\n/**\n * Schema Standardization Migration\n * \n * Changes:\n * 1. Rename \"destination\" columns to \"localidade\"\n * 2. Standardize ID field naming to camelCase (user_id -> userId, trip_id -> tripId, etc.)\n * 3. Update all references in the database\n */\n\nasync function runSchemaStandardizationMigration() {\n  console.log(\"üîÑ Iniciando migra√ß√£o de padroniza√ß√£o do schema...\");\n  \n  try {\n    console.log(\"üìã Etapa 1: Renomeando colunas 'destination' para 'localidade'\");\n    \n    // 1. Rename destination column in trips table\n    await db.execute(sql`ALTER TABLE trips CHANGE COLUMN destination localidade VARCHAR(255) NOT NULL`);\n    console.log(\"‚úÖ trips.destination ‚Üí trips.localidade\");\n    \n    // 2. Rename destination column in destination_ratings table  \n    await db.execute(sql`ALTER TABLE destination_ratings CHANGE COLUMN destination localidade VARCHAR(255) NOT NULL`);\n    console.log(\"‚úÖ destination_ratings.destination ‚Üí destination_ratings.localidade\");\n    \n    console.log(\"üìã Etapa 2: Padronizando nomes de colunas ID (snake_case -> camelCase)\");\n    \n    // Update trips table\n    await db.execute(sql`ALTER TABLE trips CHANGE COLUMN creator_id creatorId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE trips CHANGE COLUMN max_participants maxParticipants INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE trips CHANGE COLUMN current_participants currentParticipants INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE trips CHANGE COLUMN start_date startDate TIMESTAMP NOT NULL`);\n    await db.execute(sql`ALTER TABLE trips CHANGE COLUMN end_date endDate TIMESTAMP NOT NULL`);\n    await db.execute(sql`ALTER TABLE trips CHANGE COLUMN budget_breakdown budgetBreakdown JSON`);\n    await db.execute(sql`ALTER TABLE trips CHANGE COLUMN travel_style travelStyle VARCHAR(100) NOT NULL`);\n    await db.execute(sql`ALTER TABLE trips CHANGE COLUMN shared_costs sharedCosts JSON`);\n    await db.execute(sql`ALTER TABLE trips CHANGE COLUMN planned_activities plannedActivities JSON`);\n    await db.execute(sql`ALTER TABLE trips CHANGE COLUMN created_at createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    console.log(\"‚úÖ trips table ID fields standardized\");\n    \n    // Update trip_participants table\n    await db.execute(sql`ALTER TABLE trip_participants CHANGE COLUMN trip_id tripId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE trip_participants CHANGE COLUMN user_id userId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE trip_participants CHANGE COLUMN joined_at joinedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    console.log(\"‚úÖ trip_participants table ID fields standardized\");\n    \n    // Update messages table\n    await db.execute(sql`ALTER TABLE messages CHANGE COLUMN trip_id tripId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE messages CHANGE COLUMN sender_id senderId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE messages CHANGE COLUMN sent_at sentAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    console.log(\"‚úÖ messages table ID fields standardized\");\n    \n    // Update trip_requests table\n    await db.execute(sql`ALTER TABLE trip_requests CHANGE COLUMN trip_id tripId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE trip_requests CHANGE COLUMN user_id userId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE trip_requests CHANGE COLUMN created_at createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    console.log(\"‚úÖ trip_requests table ID fields standardized\");\n    \n    // Update expenses table\n    await db.execute(sql`ALTER TABLE expenses CHANGE COLUMN trip_id tripId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE expenses CHANGE COLUMN paid_by paidBy INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE expenses CHANGE COLUMN created_at createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    await db.execute(sql`ALTER TABLE expenses CHANGE COLUMN settled_at settledAt TIMESTAMP`);\n    console.log(\"‚úÖ expenses table ID fields standardized\");\n    \n    // Update expense_splits table\n    await db.execute(sql`ALTER TABLE expense_splits CHANGE COLUMN expense_id expenseId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE expense_splits CHANGE COLUMN user_id userId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE expense_splits CHANGE COLUMN settled_at settledAt TIMESTAMP`);\n    console.log(\"‚úÖ expense_splits table ID fields standardized\");\n    \n    // Update user_ratings table\n    await db.execute(sql`ALTER TABLE user_ratings CHANGE COLUMN trip_id tripId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE user_ratings CHANGE COLUMN rated_user_id ratedUserId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE user_ratings CHANGE COLUMN rater_user_id raterUserId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE user_ratings CHANGE COLUMN is_hidden isHidden BOOLEAN DEFAULT FALSE NOT NULL`);\n    await db.execute(sql`ALTER TABLE user_ratings CHANGE COLUMN report_count reportCount INT DEFAULT 0 NOT NULL`);\n    await db.execute(sql`ALTER TABLE user_ratings CHANGE COLUMN created_at createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    await db.execute(sql`ALTER TABLE user_ratings CHANGE COLUMN updated_at updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    console.log(\"‚úÖ user_ratings table ID fields standardized\");\n    \n    // Update destination_ratings table (now localidade_ratings)\n    await db.execute(sql`RENAME TABLE destination_ratings TO localidade_ratings`);\n    await db.execute(sql`ALTER TABLE localidade_ratings CHANGE COLUMN user_id userId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE localidade_ratings CHANGE COLUMN trip_id tripId INT`);\n    await db.execute(sql`ALTER TABLE localidade_ratings CHANGE COLUMN visit_date visitDate TIMESTAMP`);\n    await db.execute(sql`ALTER TABLE localidade_ratings CHANGE COLUMN is_hidden isHidden BOOLEAN DEFAULT FALSE NOT NULL`);\n    await db.execute(sql`ALTER TABLE localidade_ratings CHANGE COLUMN report_count reportCount INT DEFAULT 0 NOT NULL`);\n    await db.execute(sql`ALTER TABLE localidade_ratings CHANGE COLUMN created_at createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    await db.execute(sql`ALTER TABLE localidade_ratings CHANGE COLUMN updated_at updatedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    console.log(\"‚úÖ destination_ratings ‚Üí localidade_ratings table ID fields standardized\");\n    \n    // Update users table\n    await db.execute(sql`ALTER TABLE users CHANGE COLUMN full_name fullName VARCHAR(255) NOT NULL`);\n    await db.execute(sql`ALTER TABLE users CHANGE COLUMN profile_photo profilePhoto TEXT`);\n    await db.execute(sql`ALTER TABLE users CHANGE COLUMN travel_styles travelStyles JSON`);\n    await db.execute(sql`ALTER TABLE users CHANGE COLUMN referred_by referredBy VARCHAR(50)`);\n    await db.execute(sql`ALTER TABLE users CHANGE COLUMN is_verified isVerified BOOLEAN DEFAULT FALSE NOT NULL`);\n    await db.execute(sql`ALTER TABLE users CHANGE COLUMN verification_method verificationMethod VARCHAR(50)`);\n    await db.execute(sql`ALTER TABLE users CHANGE COLUMN average_rating averageRating DECIMAL(3,2) DEFAULT 5.00`);\n    await db.execute(sql`ALTER TABLE users CHANGE COLUMN total_ratings totalRatings INT DEFAULT 0 NOT NULL`);\n    await db.execute(sql`ALTER TABLE users CHANGE COLUMN created_at createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    console.log(\"‚úÖ users table fields standardized\");\n    \n    // Update verification_requests table\n    await db.execute(sql`ALTER TABLE verification_requests CHANGE COLUMN user_id userId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE verification_requests CHANGE COLUMN verification_type verificationType VARCHAR(100) NOT NULL`);\n    await db.execute(sql`ALTER TABLE verification_requests CHANGE COLUMN verification_data verificationData JSON`);\n    await db.execute(sql`ALTER TABLE verification_requests CHANGE COLUMN submitted_at submittedAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    await db.execute(sql`ALTER TABLE verification_requests CHANGE COLUMN reviewed_at reviewedAt TIMESTAMP`);\n    await db.execute(sql`ALTER TABLE verification_requests CHANGE COLUMN reviewed_by reviewedBy INT`);\n    await db.execute(sql`ALTER TABLE verification_requests CHANGE COLUMN rejection_reason rejectionReason TEXT`);\n    console.log(\"‚úÖ verification_requests table ID fields standardized\");\n    \n    // Update rating_reports table\n    await db.execute(sql`ALTER TABLE rating_reports CHANGE COLUMN reporter_id reporterId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE rating_reports CHANGE COLUMN rating_type ratingType VARCHAR(50) NOT NULL`);\n    await db.execute(sql`ALTER TABLE rating_reports CHANGE COLUMN rating_id ratingId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE rating_reports CHANGE COLUMN reviewed_at reviewedAt TIMESTAMP`);\n    await db.execute(sql`ALTER TABLE rating_reports CHANGE COLUMN reviewed_by reviewedBy INT`);\n    await db.execute(sql`ALTER TABLE rating_reports CHANGE COLUMN created_at createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    console.log(\"‚úÖ rating_reports table ID fields standardized\");\n    \n    // Update activity_rating_helpful_votes table\n    await db.execute(sql`ALTER TABLE activity_rating_helpful_votes CHANGE COLUMN review_id reviewId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE activity_rating_helpful_votes CHANGE COLUMN user_id userId INT NOT NULL`);\n    await db.execute(sql`ALTER TABLE activity_rating_helpful_votes CHANGE COLUMN created_at createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    console.log(\"‚úÖ activity_rating_helpful_votes table ID fields standardized\");\n    \n    // Update interest_list table\n    await db.execute(sql`ALTER TABLE interest_list CHANGE COLUMN full_name fullName VARCHAR(255) NOT NULL`);\n    await db.execute(sql`ALTER TABLE interest_list CHANGE COLUMN referral_code referralCode VARCHAR(50)`);\n    await db.execute(sql`ALTER TABLE interest_list CHANGE COLUMN created_at createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    console.log(\"‚úÖ interest_list table fields standardized\");\n    \n    // Update referral_codes table\n    await db.execute(sql`ALTER TABLE referral_codes CHANGE COLUMN created_by createdBy INT`);\n    await db.execute(sql`ALTER TABLE referral_codes CHANGE COLUMN max_uses maxUses INT DEFAULT 1 NOT NULL`);\n    await db.execute(sql`ALTER TABLE referral_codes CHANGE COLUMN current_uses currentUses INT DEFAULT 0 NOT NULL`);\n    await db.execute(sql`ALTER TABLE referral_codes CHANGE COLUMN is_active isActive BOOLEAN DEFAULT TRUE NOT NULL`);\n    await db.execute(sql`ALTER TABLE referral_codes CHANGE COLUMN created_at createdAt TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL`);\n    await db.execute(sql`ALTER TABLE referral_codes CHANGE COLUMN expires_at expiresAt TIMESTAMP`);\n    console.log(\"‚úÖ referral_codes table ID fields standardized\");\n    \n    console.log(\"üìã Etapa 3: Atualizando constraints e foreign keys\");\n    \n    // Drop and recreate foreign key constraints with new column names\n    // Note: This is a simplified approach. In production, you'd want to be more careful about constraint names\n    console.log(\"‚ö†Ô∏è Foreign key constraints will be automatically updated by MySQL\");\n    \n    console.log(\"üéâ Migra√ß√£o de padroniza√ß√£o do schema conclu√≠da com sucesso!\");\n    console.log(\"\\nüìã Resumo das altera√ß√µes:\");\n    console.log(\"‚úÖ 'destination' ‚Üí 'localidade' em todas as tabelas\");\n    console.log(\"‚úÖ Todos os campos ID padronizados para camelCase\");\n    console.log(\"‚úÖ Tabela 'destination_ratings' renomeada para 'localidade_ratings'\");\n    console.log(\"‚úÖ Mantida compatibilidade com dados existentes\");\n    \n  } catch (error: any) {\n    console.error(\"‚ùå Erro durante a migra√ß√£o:\", error);\n    console.error(\"üí° A migra√ß√£o foi interrompida. Verifique os logs acima.\");\n    throw error;\n  }\n}\n\n// Run migration if called directly\nif (import.meta.url === `file://${process.argv[1]}`) {\n  runSchemaStandardizationMigration()\n    .then(() => {\n      console.log(\"‚úÖ Migra√ß√£o conclu√≠da com sucesso!\");\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error(\"‚ùå Falha na migra√ß√£o:\", error);\n      process.exit(1);\n    });\n}\n\nexport { runSchemaStandardizationMigration };","size_bytes":12353},"server/seed-database.ts":{"content":"import { db } from \"./db\";\nimport { users, trips, tripParticipants, messages, activities, activityReviews, expenses, expenseSplits } from \"@shared/schema\";\nimport { eq, desc } from \"drizzle-orm\";\nimport { scrypt } from \"crypto\";\nimport { promisify } from \"util\";\n\nconst scryptAsync = promisify(scrypt);\n\n// Helper function to hash passwords - compat√≠vel com autentica√ß√£o\nasync function hashPassword(password: string): Promise<string> {\n  const salt = \"fixed-salt-for-demo\";\n  const key = (await scryptAsync(password, salt, 64)) as Buffer;\n  return `${key.toString(\"hex\")}.${salt}`;\n}\n\n// Generate referral code\nfunction generateReferralCode(username: string, id: number): string {\n  return `PARTIU-${username.toUpperCase()}${id.toString().padStart(2, '0')}`;\n}\n\nexport async function seedDatabase() {\n  console.log(\"üå± Iniciando popula√ß√£o completa do banco de dados...\");\n\n  // 1. Create 10 users (Tom + 9 referred by Tom)\n  const usersData = [\n    {\n      username: \"tom\",\n      email: \"tom@example.com\",\n      password: await hashPassword(\"demo123\"),\n      fullName: \"Tom Tubin\",\n      phone: \"(51) 99999-9999\",\n      bio: \"Aventureiro nato, sempre em busca de novas experi√™ncias. Criador da comunidade PartiuTrip!\",\n      location: \"Porto Alegre, RS\",\n      languages: [\"Portugu√™s\", \"Ingl√™s\", \"Espanhol\"],\n      interests: [\"Aventura\", \"Fotografia\", \"Culin√°ria Local\", \"Hist√≥ria\"],\n      travelStyle: \"aventura\",\n      isVerified: true,\n      verificationMethod: \"founder\",\n      referredBy: null\n    },\n    {\n      username: \"maria\",\n      email: \"maria@example.com\", \n      password: await hashPassword(\"demo123\"),\n      fullName: \"Maria Silva\",\n      phone: \"(11) 98888-8888\",\n      bio: \"Apaixonada por culturas diferentes e gastronomia local. Sempre pronta para uma nova aventura!\",\n      location: \"S√£o Paulo, SP\",\n      languages: [\"Portugu√™s\", \"Ingl√™s\"],\n      interests: [\"Culin√°ria\", \"Cultura\", \"Arte\", \"Museus\"],\n      travelStyle: \"culturais\",\n      isVerified: true,\n      verificationMethod: \"referral\",\n      referredBy: \"PARTIU-TOM01\"\n    },\n    {\n      username: \"carlos\",\n      email: \"carlos@example.com\",\n      password: await hashPassword(\"demo123\"),\n      fullName: \"Carlos Santos\",\n      phone: \"(21) 97777-7777\",\n      bio: \"Surfista e amante da natureza. Sempre em busca das melhores ondas e trilhas!\",\n      location: \"Rio de Janeiro, RJ\",\n      languages: [\"Portugu√™s\", \"Ingl√™s\"],\n      interests: [\"Surf\", \"Natureza\", \"Trilhas\", \"Praia\"],\n      travelStyle: \"praia\",\n      isVerified: true,\n      verificationMethod: \"referral\",\n      referredBy: \"PARTIU-TOM01\"\n    },\n    {\n      username: \"ana\",\n      email: \"ana@example.com\",\n      password: await hashPassword(\"demo123\"),\n      fullName: \"Ana Costa\",\n      phone: \"(31) 96666-6666\",\n      bio: \"Fot√≥grafa especializada em paisagens naturais. Amo capturar momentos √∫nicos!\",\n      location: \"Belo Horizonte, MG\",\n      languages: [\"Portugu√™s\", \"Ingl√™s\", \"Franc√™s\"],\n      interests: [\"Fotografia\", \"Natureza\", \"Ecoturismo\", \"Vida Selvagem\"],\n      travelStyle: \"natureza\",\n      isVerified: true,\n      verificationMethod: \"referral\",\n      referredBy: \"PARTIU-TOM01\"\n    },\n    {\n      username: \"ricardo\",\n      email: \"ricardo@example.com\",\n      password: await hashPassword(\"demo123\"),\n      fullName: \"Ricardo Oliveira\",\n      phone: \"(85) 95555-5555\",\n      bio: \"Amante de parques tem√°ticos e divers√£o em fam√≠lia. Sempre planejando a pr√≥xima aventura!\",\n      location: \"Fortaleza, CE\",\n      languages: [\"Portugu√™s\", \"Ingl√™s\"],\n      interests: [\"Parques Tem√°ticos\", \"Fam√≠lia\", \"Divers√£o\", \"Tecnologia\"],\n      travelStyle: \"parques\",\n      isVerified: true,\n      verificationMethod: \"referral\",\n      referredBy: \"PARTIU-TOM01\"\n    },\n    {\n      username: \"julia\",\n      email: \"julia@example.com\",\n      password: await hashPassword(\"demo123\"),\n      fullName: \"Julia Ferreira\",\n      phone: \"(47) 94444-4444\",\n      bio: \"Profissional de marketing que adora viajar e conhecer grandes cidades urbanas!\",\n      location: \"Florian√≥polis, SC\",\n      languages: [\"Portugu√™s\", \"Ingl√™s\", \"Italiano\"],\n      interests: [\"Cidades\", \"Arquitetura\", \"Gastronomia\", \"Vida Noturna\"],\n      travelStyle: \"urbanas\",\n      isVerified: true,\n      verificationMethod: \"referral\",\n      referredBy: \"PARTIU-TOM01\"\n    },\n    {\n      username: \"pedro\",\n      email: \"pedro@example.com\",\n      password: await hashPassword(\"demo123\"),\n      fullName: \"Pedro Almeida\",\n      phone: \"(62) 93333-3333\",\n      bio: \"Aventureiro que adora explorar destinos gelados e paisagens nevadas!\",\n      location: \"Goi√¢nia, GO\",\n      languages: [\"Portugu√™s\", \"Ingl√™s\"],\n      interests: [\"Neve\", \"Montanhismo\", \"Esqui\", \"Aventura\"],\n      travelStyle: \"neve\",\n      isVerified: true,\n      verificationMethod: \"referral\",\n      referredBy: \"PARTIU-TOM01\"\n    },\n    {\n      username: \"fernanda\",\n      email: \"fernanda@example.com\",\n      password: await hashPassword(\"demo123\"),\n      fullName: \"Fernanda Lima\",\n      phone: \"(81) 92222-2222\",\n      bio: \"Apaixonada por cruzeiros e experi√™ncias mar√≠timas √∫nicas!\",\n      location: \"Recife, PE\",\n      languages: [\"Portugu√™s\", \"Ingl√™s\", \"Espanhol\"],\n      interests: [\"Cruzeiros\", \"Mar\", \"Relaxamento\", \"Gastronomia\"],\n      travelStyle: \"cruzeiros\",\n      isVerified: true,\n      verificationMethod: \"referral\",\n      referredBy: \"PARTIU-TOM01\"\n    },\n    {\n      username: \"marcos\",\n      email: \"marcos@example.com\",\n      password: await hashPassword(\"demo123\"),\n      fullName: \"Marcos Rocha\",\n      phone: \"(71) 91111-1111\",\n      bio: \"Historiador que adora explorar s√≠tios hist√≥ricos e patrim√¥nios culturais!\",\n      location: \"Salvador, BA\",\n      languages: [\"Portugu√™s\", \"Ingl√™s\", \"Espanhol\"],\n      interests: [\"Hist√≥ria\", \"Patrim√¥nio\", \"Cultura\", \"Arqueologia\"],\n      travelStyle: \"culturais\",\n      isVerified: true,\n      verificationMethod: \"referral\",\n      referredBy: \"PARTIU-TOM01\"\n    },\n    {\n      username: \"camila\",\n      email: \"camila@example.com\",\n      password: await hashPassword(\"demo123\"),\n      fullName: \"Camila Souza\",\n      phone: \"(61) 91000-0000\",\n      bio: \"Bi√≥loga especializada em ecoturismo e conserva√ß√£o ambiental!\",\n      location: \"Bras√≠lia, DF\",\n      languages: [\"Portugu√™s\", \"Ingl√™s\", \"Alem√£o\"],\n      interests: [\"Ecoturismo\", \"Conserva√ß√£o\", \"Natureza\", \"Sustentabilidade\"],\n      travelStyle: \"natureza\",\n      isVerified: true,\n      verificationMethod: \"referral\",\n      referredBy: \"PARTIU-TOM01\"\n    }\n  ];\n\n  // Insert users\n  console.log(\"üë• Criando 10 usu√°rios...\");\n  const createdUsers = [];\n  for (const userData of usersData) {\n    await db.insert(users).values(userData);\n    // Get the created user\n    const [user] = await db.select().from(users).where(eq(users.username, userData.username));\n    createdUsers.push(user);\n    console.log(`‚úÖ Usu√°rio criado: ${user.username}`);\n  }\n\n  // 2. Create comprehensive activities by destination\n  console.log(\"üéØ Criando atividades por destino...\");\n  \n  const activitiesData = [\n    // Rio de Janeiro\n    {\n      title: \"Trilha do P√£o de A√ß√∫car\",\n      description: \"Trilha desafiadora com vista panor√¢mica da cidade maravilhosa\",\n      location: \"Rio de Janeiro, RJ\",\n      category: \"Aventura\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n      priceAmount: \"75.00\",\n      duration: \"4-6 horas\",\n      difficultyLevel: \"moderate\",\n      minParticipants: 2,\n      maxParticipants: 12,\n      coverImage: \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n      contactInfo: { phone: \"(21) 99999-1111\", email: \"trilha@rioadventure.com\" },\n      createdById: createdUsers[0].id\n    },\n    {\n      title: \"Passeio de Barco na Ba√≠a de Guanabara\",\n      description: \"Passeio relaxante com vista para o Cristo Redentor e P√£o de A√ß√∫car\",\n      location: \"Rio de Janeiro, RJ\",\n      category: \"Aqu√°tico\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n      priceAmount: \"115.00\",\n      duration: \"3-4 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 4,\n      maxParticipants: 20,\n      coverImage: \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n      contactInfo: { phone: \"(21) 99999-2222\", email: \"passeios@baiaguanabara.com\" },\n      createdById: createdUsers[1].id\n    },\n    \n    // S√£o Paulo\n    {\n      title: \"Tour Gastron√¥mico no Mercado Municipal\",\n      description: \"Degusta√ß√£o de iguarias paulistanas no famoso Mercad√£o\",\n      location: \"S√£o Paulo, SP\",\n      category: \"Gastronomia\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n      priceAmount: \"90.00\",\n      duration: \"2-3 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 3,\n      maxParticipants: 15,\n      coverImage: \"https://images.unsplash.com/photo-1567306301408-9b74779a11af?w=800&q=80\",\n      contactInfo: { phone: \"(11) 99999-3333\", email: \"tours@mercadao.com\" },\n      createdById: createdUsers[2].id\n    },\n    {\n      title: \"Visita√ß√£o ao MASP com Guia Especializado\",\n      description: \"Tour cultural pelo acervo do Museu de Arte de S√£o Paulo\",\n      location: \"S√£o Paulo, SP\",\n      category: \"Cultural\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n      priceAmount: \"60.00\",\n      duration: \"2-3 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 5,\n      maxParticipants: 20,\n      coverImage: \"https://images.unsplash.com/photo-1567306301408-9b74779a11af?w=800&q=80\",\n      contactInfo: { phone: \"(11) 99999-4444\", email: \"cultura@masp.com\" },\n      createdById: createdUsers[3].id\n    },\n\n    // Florian√≥polis\n    {\n      title: \"Aula de Surf na Praia da Joaquina\",\n      description: \"Aprenda a surfar com instrutores qualificados na famosa praia\",\n      location: \"Florian√≥polis, SC\",\n      category: \"Aqu√°tico\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n      priceAmount: \"115.00\",\n      duration: \"3-4 horas\",\n      difficultyLevel: \"moderate\",\n      minParticipants: 2,\n      maxParticipants: 8,\n      coverImage: \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n      contactInfo: { phone: \"(48) 99999-5555\", email: \"surf@joaquina.com\" },\n      createdById: createdUsers[4].id\n    },\n\n    // Chapada Diamantina\n    {\n      title: \"Cachoeira do Burac√£o\",\n      description: \"Trilha at√© uma das cachoeiras mais impressionantes da Chapada\",\n      location: \"Chapada Diamantina, BA\",\n      category: \"Ecoturismo\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n      priceAmount: \"150.00\",\n      duration: \"6-8 horas\",\n      difficultyLevel: \"challenging\",\n      minParticipants: 4,\n      maxParticipants: 12,\n      coverImage: \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n      contactInfo: { phone: \"(75) 99999-6666\", email: \"trilhas@chapada.com\" },\n      createdById: createdUsers[5].id\n    },\n\n    // Pantanal\n    {\n      title: \"Safari Fotogr√°fico no Pantanal\",\n      description: \"Observe e fotografe a fauna local em seu habitat natural\",\n      location: \"Pantanal, MT\",\n      category: \"Ecoturismo\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n      priceAmount: \"300.00\",\n      duration: \"5-6 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 3,\n      maxParticipants: 10,\n      coverImage: \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n      contactInfo: { phone: \"(65) 99999-7777\", email: \"safari@pantanal.com\" },\n      createdById: createdUsers[6].id\n    },\n\n    // Fernando de Noronha\n    {\n      title: \"Mergulho nas Piscinas Naturais\",\n      description: \"Mergulho com snorkel em √°guas cristalinas repletas de vida marinha\",\n      location: \"Fernando de Noronha, PE\",\n      category: \"Aqu√°tico\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n      priceAmount: \"225.00\",\n      duration: \"4-5 horas\",\n      difficultyLevel: \"moderate\",\n      minParticipants: 4,\n      maxParticipants: 12,\n      coverImage: \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n      contactInfo: { phone: \"(81) 99999-8888\", email: \"mergulho@noronha.com\" },\n      createdById: createdUsers[7].id\n    },\n\n    // Bonito\n    {\n      title: \"Flutua√ß√£o no Rio da Prata\",\n      description: \"Flutua√ß√£o em √°guas cristalinas com peixes coloridos\",\n      location: \"Bonito, MS\",\n      category: \"Aqu√°tico\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n      priceAmount: \"185.00\",\n      duration: \"3-4 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 2,\n      maxParticipants: 15,\n      coverImage: \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n      contactInfo: { phone: \"(67) 99999-9999\", email: \"flutuacao@bonito.com\" },\n      createdById: createdUsers[8].id\n    },\n\n    // Campos do Jord√£o\n    {\n      title: \"Passeio de Trem pela Serra da Mantiqueira\",\n      description: \"Viagem panor√¢mica pelos cen√°rios montanhosos da regi√£o\",\n      location: \"Campos do Jord√£o, SP\",\n      category: \"Turismo\",\n      \n    countryType: \"nacional\",\n    region: \"Brasil\",\n    priceType: \"per_person\",priceType: \"per_person\",\n      priceAmount: \"90.00\",\n      duration: \"2-3 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 50,\n      coverImage: \"https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=800&q=80\",\n      contactInfo: { phone: \"(12) 99999-0000\", email: \"trem@camposjordao.com\" },\n      createdById: createdUsers[9].id\n    }\n  ];\n\n  // Insert activities\n  const createdActivities = [];\n  for (const activityData of activitiesData) {\n    await db.insert(activities).values(activityData);\n    // Get the created activity\n    const [activity] = await db.select().from(activities).where(eq(activities.title, activityData.title));\n    createdActivities.push(activity);\n    console.log(`‚úÖ Atividade criada: ${activity.title}`);\n  }\n\n  // 3. Create comprehensive trips (5 per user = 50 trips total)\n  console.log(\"üß≥ Criando 50 viagens completas...\");\n  \n  const tripsData = [];\n  const destinations = [\n    \"Rio de Janeiro, RJ\", \"S√£o Paulo, SP\", \"Florian√≥polis, SC\", \"Chapada Diamantina, BA\",\n    \"Pantanal, MT\", \"Fernando de Noronha, PE\", \"Bonito, MS\", \"Campos do Jord√£o, SP\",\n    \"Gramado, RS\", \"Foz do Igua√ßu, PR\", \"Jericoacoara, CE\", \"Maragogi, AL\",\n    \"Ouro Preto, MG\", \"Paraty, RJ\", \"B√∫zios, RJ\", \"Ilha Grande, RJ\",\n    \"Brotas, SP\", \"Ubatuba, SP\", \"Caldas Novas, GO\", \"Piren√≥polis, GO\"\n  ];\n\n  let tripId = 1;\n  for (let userIndex = 0; userIndex < createdUsers.length; userIndex++) {\n    const creator = createdUsers[userIndex];\n    \n    for (let tripIndex = 0; tripIndex < 5; tripIndex++) {\n      const destination = destinations[(userIndex * 5 + tripIndex) % destinations.length];\n      const startDate = new Date(Date.now() + (tripIndex * 7 + userIndex * 2) * 24 * 60 * 60 * 1000);\n      const endDate = new Date(startDate.getTime() + (3 + tripIndex) * 24 * 60 * 60 * 1000);\n      \n      const trip = {\n        creatorId: creator.id,\n        title: `Aventura em ${destination.split(',')[0]} - ${creator.fullName}`,\n        destination,\n        startDate,\n        endDate,\n        budget: 1000 + (tripIndex * 500) + (userIndex * 200),\n        budgetBreakdown: {\n          transport: 300 + (tripIndex * 50),\n          accommodation: 400 + (tripIndex * 100),\n          food: 200 + (tripIndex * 30),\n          activities: 150 + (tripIndex * 20),\n          insurance: 50,\n          other: 100 + (tripIndex * 10)\n        },\n        maxParticipants: 4 + (tripIndex % 6),\n        description: `Viagem incr√≠vel para ${destination} com ${creator.fullName}. Uma experi√™ncia √∫nica que combina aventura, cultura e divers√£o!`,\n        difficulty: [\"F√°cil\", \"M√©dio\", \"Dif√≠cil\"][tripIndex % 3],\n        travelStyle: creator.travelStyle,\n        coverImage: `https://images.unsplash.com/photo-${1500000000000 + tripId}?w=800&q=80`,\n        requirements: [\"Documento de identidade\", \"Seguro de viagem\"],\n        includes: [\"Hospedagem\", \"Caf√© da manh√£\", \"Guia local\"],\n        excludes: [\"Passagens a√©reas\", \"Seguro pessoal\", \"Refei√ß√µes n√£o mencionadas\"]\n      };\n      \n      tripsData.push(trip);\n      tripId++;\n    }\n  }\n\n  // Insert trips\n  const createdTrips = [];\n  for (const tripData of tripsData) {\n    await db.insert(trips).values(tripData);\n    // Get the created trip\n    const [trip] = await db.select().from(trips).where(eq(trips.title, tripData.title));\n    createdTrips.push(trip);\n    console.log(`‚úÖ Viagem criada: ${trip.title}`);\n  }\n\n  // 4. Create trip participants (each trip has 2-4 participants)\n  console.log(\"üë• Adicionando participantes √†s viagens...\");\n  \n  for (const trip of createdTrips) {\n    // Creator is always a participant\n    await db.insert(tripParticipants).values({\n      tripId: trip.id,\n      userId: trip.creatorId,\n      status: \"accepted\",\n      joinedAt: new Date()\n    });\n\n    // Add 1-3 additional participants\n    const participantCount = 1 + Math.floor(Math.random() * 3);\n    const availableUsers = createdUsers.filter(u => u.id !== trip.creatorId);\n    \n    for (let i = 0; i < participantCount && i < availableUsers.length; i++) {\n      const randomUser = availableUsers[Math.floor(Math.random() * availableUsers.length)];\n      \n      try {\n        await db.insert(tripParticipants).values({\n          tripId: trip.id,\n          userId: randomUser.id,\n          status: \"accepted\",\n          joinedAt: new Date()\n        });\n      } catch (error) {\n        // Ignore duplicate participant entries\n      }\n    }\n  }\n\n  // 5. Create chat messages for each trip\n  console.log(\"üí¨ Criando mensagens de chat...\");\n  \n  for (const trip of createdTrips) {\n    // Get trip participants\n    const participants = await db.select().from(tripParticipants).where(eq(tripParticipants.tripId, trip.id));\n    \n    if (participants.length > 0) {\n      // Create 5-10 messages per trip\n      const messageCount = 5 + Math.floor(Math.random() * 6);\n      \n      for (let i = 0; i < messageCount; i++) {\n        const randomParticipant = participants[Math.floor(Math.random() * participants.length)];\n        const user = createdUsers.find(u => u.id === randomParticipant.userId);\n        \n        const messages_samples = [\n          \"Pessoal, estou muito animado para esta viagem! üéâ\",\n          \"J√° confirmei minha hospedagem, e voc√™s?\",\n          \"Alguma sugest√£o de restaurante no local?\",\n          \"Que tal nos encontrarmos antes da viagem?\",\n          \"Estou levando minha c√¢mera, vamos tirar muitas fotos!\",\n          \"Pesquisei sobre o clima, melhor levar capa de chuva.\",\n          \"Encontrei um local incr√≠vel para visitarmos!\",\n          \"Vamos dividir o transporte? Fica mais barato!\",\n          \"J√° estou contando os dias! üòÑ\",\n          \"Preparei uma playlist para a viagem!\"\n        ];\n        \n        await db.insert(messages).values({\n          tripId: trip.id,\n          senderId: randomParticipant.userId,\n          content: messages_samples[i % messages_samples.length],\n          sentAt: new Date(Date.now() - (messageCount - i) * 3600000) // Messages spread over hours\n        });\n      }\n    }\n  }\n\n  // 6. Create expenses for trips\n  console.log(\"üí∞ Criando despesas compartilhadas...\");\n  \n  for (const trip of createdTrips) {\n    const participants = await db.select().from(tripParticipants).where(eq(tripParticipants.tripId, trip.id));\n    \n    if (participants.length > 1) {\n      // Create 2-4 expenses per trip\n      const expenseCount = 2 + Math.floor(Math.random() * 3);\n      \n      const expenseCategories = [\"transport\", \"accommodation\", \"food\", \"activities\", \"other\"];\n      const expenseDescriptions = {\n        transport: [\"Combust√≠vel\", \"Ped√°gio\", \"Estacionamento\", \"T√°xi\"],\n        accommodation: [\"Hotel\", \"Pousada\", \"Airbnb\", \"Hostel\"],\n        food: [\"Jantar\", \"Almo√ßo\", \"Caf√© da manh√£\", \"Lanche\"],\n        activities: [\"Ingresso\", \"Passeio\", \"Guia\", \"Equipamento\"],\n        other: [\"Farm√°cia\", \"Souvenir\", \"Diversos\", \"Emerg√™ncia\"]\n      };\n      \n      for (let i = 0; i < expenseCount; i++) {\n        const category = expenseCategories[i % expenseCategories.length] as keyof typeof expenseDescriptions;\n        const descriptions = expenseDescriptions[category];\n        const description = descriptions[Math.floor(Math.random() * descriptions.length)];\n        \n        const amount = 50 + Math.floor(Math.random() * 200);\n        const paidBy = participants[Math.floor(Math.random() * participants.length)].userId;\n        \n        await db.insert(expenses).values({\n          tripId: trip.id,\n          paidBy,\n          amount,\n          description,\n          category\n        });\n        \n        // Get the created expense\n        const [expense] = await db.select().from(expenses).where(eq(expenses.tripId, trip.id)).orderBy(desc(expenses.id)).limit(1);\n        \n        // Split expense among all participants\n        const amountPerPerson = amount / participants.length;\n        \n        for (const participant of participants) {\n          await db.insert(expenseSplits).values({\n            expenseId: expense.id,\n            userId: participant.userId,\n            amount: amountPerPerson\n          });\n        }\n      }\n    }\n  }\n\n  // 7. Create activity reviews\n  console.log(\"‚≠ê Criando avalia√ß√µes de atividades...\");\n  \n  for (const activity of createdActivities) {\n    const reviewCount = 1 + Math.floor(Math.random() * 5);\n    \n    for (let i = 0; i < reviewCount; i++) {\n      const randomUser = createdUsers[Math.floor(Math.random() * createdUsers.length)];\n      \n      const reviews_samples = [\n        \"Experi√™ncia incr√≠vel! Recomendo a todos!\",\n        \"Muito bem organizado, guia excelente!\",\n        \"Superou minhas expectativas!\",\n        \"Atividade divertida e segura.\",\n        \"Vista espetacular, valeu cada centavo!\",\n        \"Profissionais muito atenciosos.\",\n        \"Uma das melhores experi√™ncias da minha vida!\",\n        \"Atividade imperd√≠vel no destino!\"\n      ];\n      \n      try {\n        await db.insert(activityReviews).values({\n          activityId: activity.id,\n          userId: randomUser.id,\n          rating: 3 + Math.floor(Math.random() * 3), // 3-5 stars\n          review: reviews_samples[i % reviews_samples.length]\n        });\n      } catch (error) {\n        // Ignore duplicate reviews\n      }\n    }\n  }\n\n  console.log(\"‚úÖ Banco de dados populado com sucesso!\");\n  console.log(`üìä Resumo:\n    - 10 usu√°rios criados\n    - ${createdActivities.length} atividades por destino\n    - ${createdTrips.length} viagens completas\n    - Participantes, mensagens e despesas adicionados\n    - Avalia√ß√µes de atividades criadas`);\n}","size_bytes":23177},"server/setup-complete-database.ts":{"content":"#!/usr/bin/env tsx\nimport { db } from './db.js';\nimport { createDestinations } from './create-destinations.js';\nimport { createComprehensiveActivities } from './create-comprehensive-activities.js';\nimport { fixDatabaseCompatibility } from './fix-database-compatibility.js';\n\n/**\n * Script principal para configurar completamente o banco de dados\n * Executa todos os scripts necess√°rios na ordem correta\n */\nasync function setupCompleteDatabase() {\n  console.log('üöÄ Configurando banco de dados completo...');\n  console.log('=============================================');\n\n  try {\n    // 1. Corrigir compatibilidade\n    console.log('\\nüîß PASSO 1: Corrigindo compatibilidade do banco...');\n    await fixDatabaseCompatibility();\n    \n    // 2. Criar destinos\n    console.log('\\nüåç PASSO 2: Criando destinos...');\n    const destinationsCount = await createDestinations();\n    \n    // 3. Criar atividades abrangentes\n    console.log('\\nüèõÔ∏è PASSO 3: Criando atividades abrangentes...');\n    const activitiesResult = await createComprehensiveActivities();\n    \n    console.log('\\nüéâ CONFIGURA√á√ÉO COMPLETA!');\n    console.log('=============================================');\n    console.log(`‚úÖ Destinos criados: ${destinationsCount}`);\n    console.log(`‚úÖ Atividades criadas: ${activitiesResult.activities}`);\n    console.log(`‚úÖ Propostas criadas: ${activitiesResult.proposals}`);\n    console.log('\\nüìã O banco PostgreSQL est√° agora completamente configurado e pronto para uso!');\n    \n    return {\n      destinations: destinationsCount,\n      activities: activitiesResult.activities,\n      proposals: activitiesResult.proposals\n    };\n\n  } catch (error) {\n    console.error('‚ùå Erro durante a configura√ß√£o:', error);\n    throw error;\n  }\n}\n\n// Executar se chamado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  setupCompleteDatabase()\n    .then((result) => {\n      console.log('\\n‚úÖ SETUP CONCLU√çDO COM SUCESSO!');\n      console.log(`   üåç ${result.destinations} destinos`);\n      console.log(`   üèõÔ∏è ${result.activities} atividades`);\n      console.log(`   üí∞ ${result.proposals} propostas`);\n      console.log('\\nüöÄ A plataforma PartiuTrip est√° pronta para uso!');\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('‚ùå Erro no setup:', error);\n      process.exit(1);\n    });\n}\n\nexport { setupCompleteDatabase };","size_bytes":2395},"server/setup-referral-system.ts":{"content":"import { db } from \"./db\";\nimport { sql } from \"drizzle-orm\";\n\nexport async function setupReferralSystem() {\n  try {\n    console.log('üöÄ Configurando sistema de c√≥digos de indica√ß√£o...');\n\n    // Create referral_codes table\n    await db.execute(sql`\n      CREATE TABLE IF NOT EXISTS referral_codes (\n        id int PRIMARY KEY AUTO_INCREMENT,\n        code varchar(50) NOT NULL UNIQUE,\n        created_by int DEFAULT NULL,\n        max_uses int DEFAULT 1 NOT NULL,\n        current_uses int DEFAULT 0 NOT NULL,\n        is_active boolean DEFAULT true NOT NULL,\n        created_at timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        expires_at timestamp DEFAULT NULL,\n        INDEX idx_code (code),\n        INDEX idx_active (is_active)\n      )\n    `);\n\n    // Create interest_list table\n    await db.execute(sql`\n      CREATE TABLE IF NOT EXISTS interest_list (\n        id int PRIMARY KEY AUTO_INCREMENT,\n        full_name varchar(255) NOT NULL,\n        email varchar(255) NOT NULL UNIQUE,\n        phone varchar(20) NOT NULL,\n        referral_code varchar(50) DEFAULT NULL,\n        status varchar(50) DEFAULT 'pending' NOT NULL,\n        created_at timestamp DEFAULT CURRENT_TIMESTAMP NOT NULL,\n        INDEX idx_email (email),\n        INDEX idx_status (status)\n      )\n    `);\n\n    console.log('‚úÖ Tabelas criadas com sucesso!');\n\n    // Insert default referral codes\n    const codes = [\n      { code: 'BETA2025', maxUses: 100 },\n      { code: 'VIAJANTE', maxUses: 50 },\n      { code: 'AMIGO123', maxUses: 10 },\n      { code: 'TESTE', maxUses: 1 },\n      { code: 'EXPLORER', maxUses: 25 },\n    ];\n\n    for (const codeData of codes) {\n      await db.execute(sql`\n        INSERT IGNORE INTO referral_codes (code, max_uses, current_uses, is_active, created_at) \n        VALUES (${codeData.code}, ${codeData.maxUses}, 0, 1, NOW())\n      `);\n    }\n\n    console.log('‚úÖ C√≥digos de indica√ß√£o criados com sucesso!');\n    console.log('üìã C√≥digos dispon√≠veis:', codes.map(c => c.code).join(', '));\n\n    return true;\n  } catch (error) {\n    console.error('‚ùå Erro ao configurar sistema de indica√ß√£o:', error);\n    return false;\n  }\n}","size_bytes":2136},"server/simple-activities-seed.ts":{"content":"import { db } from './db.js';\nimport { sql } from 'drizzle-orm';\n\nexport async function seedBasicActivities() {\n  console.log('üå± Adicionando dados b√°sicos de atividades...');\n\n  try {\n    // 1. Verificar a estrutura das tabelas existentes\n    console.log('üîç Verificando estrutura das tabelas...');\n    \n    const activityColumns = await db.execute(sql`SHOW COLUMNS FROM activities`);\n    console.log('üìã Colunas de activities:', activityColumns.map(c => c.Field).join(', '));\n\n    let proposalColumns = [];\n    try {\n      proposalColumns = await db.execute(sql`SHOW COLUMNS FROM activity_budget_proposals`);\n      console.log('üìã Colunas de propostas:', proposalColumns.map(c => c.Field).join(', '));\n    } catch (error) {\n      console.log('‚ö†Ô∏è Tabela activity_budget_proposals n√£o existe ainda');\n    }\n\n    let reviewColumns = [];\n    try {\n      reviewColumns = await db.execute(sql`SHOW COLUMNS FROM activity_reviews`);\n      console.log('üìã Colunas de reviews:', reviewColumns.map(c => c.Field).join(', '));\n    } catch (error) {\n      console.log('‚ö†Ô∏è Tabela activity_reviews n√£o existe ainda');\n    }\n\n    // 2. Verificar atividades existentes\n    const activities = await db.execute(sql`SELECT id, title FROM activities WHERE title IS NOT NULL`);\n    console.log(`üìä Atividades encontradas: ${activities.length}`);\n    \n    activities.forEach(activity => {\n      console.log(`   - ID ${activity.id}: ${activity.title}`);\n    });\n\n    // 3. Criar propostas de or√ßamento apenas com colunas que existem\n    if (proposalColumns.length > 0) {\n      console.log('\\nüí∞ Criando propostas de or√ßamento...');\n      await seedBudgetProposals();\n    } else {\n      console.log('‚ö†Ô∏è Tabela de propostas n√£o existe, pulando essa etapa');\n    }\n\n    // 4. Criar avalia√ß√µes apenas com colunas que existem\n    if (reviewColumns.length > 0) {\n      console.log('\\n‚≠ê Criando avalia√ß√µes...');\n      await seedActivityReviews();\n    } else {\n      console.log('‚ö†Ô∏è Tabela de reviews n√£o existe, pulando essa etapa');\n    }\n\n    console.log('\\nüéâ Seed b√°sico conclu√≠do com sucesso!');\n\n  } catch (error) {\n    console.error('‚ùå Erro no seed b√°sico:', error);\n    throw error;\n  }\n}\n\nasync function seedBudgetProposals() {\n  try {\n    // Verificar se j√° existem propostas\n    const existingProposals = await db.execute(sql`SELECT COUNT(*) as count FROM activity_budget_proposals`);\n    console.log(`üìä Propostas existentes: ${existingProposals[0]?.count || 0}`);\n\n    // Limpar propostas existentes\n    await db.execute(sql`DELETE FROM activity_budget_proposals`);\n\n    // Obter atividades v√°lidas\n    const activities = await db.execute(sql`\n      SELECT id, title FROM activities \n      WHERE id IN (9, 10, 11, 12, 13, 14) AND title IS NOT NULL\n    `);\n\n    if (activities.length === 0) {\n      console.log('‚ö†Ô∏è Nenhuma atividade v√°lida encontrada para criar propostas');\n      return;\n    }\n\n    // Criar propostas b√°sicas (sem colunas votes e is_popular se n√£o existirem)\n    const proposalColumns = await db.execute(sql`SHOW COLUMNS FROM activity_budget_proposals`);\n    const hasVotes = proposalColumns.some(c => c.Field === 'votes');\n    const hasIsPopular = proposalColumns.some(c => c.Field === 'is_popular');\n\n    for (const activity of activities) {\n      console.log(`üí° Criando propostas para: ${activity.title}`);\n      \n      // Propostas b√°sicas para cada atividade\n      const basePrice = 80;\n      const proposals = [\n        {\n          title: 'Op√ß√£o B√°sica',\n          description: 'Experi√™ncia padr√£o da atividade',\n          amount: basePrice,\n          inclusions: '[\"Atividade principal\", \"Equipamentos b√°sicos\"]',\n          exclusions: '[\"Alimenta√ß√£o\", \"Bebidas\"]'\n        },\n        {\n          title: 'Op√ß√£o Completa',\n          description: 'Experi√™ncia com guia e comodidades',\n          amount: Math.floor(basePrice * 1.8),\n          inclusions: '[\"Atividade principal\", \"Guia especializado\", \"Equipamentos\"]',\n          exclusions: '[\"Bebidas alco√≥licas\"]'\n        },\n        {\n          title: 'Op√ß√£o Premium',\n          description: 'Experi√™ncia exclusiva e personalizada',\n          amount: Math.floor(basePrice * 3),\n          inclusions: '[\"Experi√™ncia privativa\", \"Guia exclusivo\", \"Transporte\"]',\n          exclusions: '[\"Compras pessoais\"]'\n        }\n      ];\n\n      for (const proposal of proposals) {\n        if (hasVotes && hasIsPopular) {\n          await db.execute(sql`\n            INSERT INTO activity_budget_proposals \n            (activity_id, title, description, amount, currency, inclusions, exclusions, votes, is_popular) \n            VALUES \n            (${activity.id}, ${proposal.title}, ${proposal.description}, ${proposal.amount}, 'BRL', \n             ${proposal.inclusions}, ${proposal.exclusions}, 15, false)\n          `);\n        } else {\n          await db.execute(sql`\n            INSERT INTO activity_budget_proposals \n            (activity_id, title, description, amount, currency, inclusions, exclusions) \n            VALUES \n            (${activity.id}, ${proposal.title}, ${proposal.description}, ${proposal.amount}, 'BRL', \n             ${proposal.inclusions}, ${proposal.exclusions})\n          `);\n        }\n      }\n    }\n\n    console.log('‚úÖ Propostas de or√ßamento criadas!');\n\n  } catch (error) {\n    console.error('‚ùå Erro ao criar propostas:', error);\n  }\n}\n\nasync function seedActivityReviews() {\n  try {\n    // Verificar se j√° existem reviews\n    const existingReviews = await db.execute(sql`SELECT COUNT(*) as count FROM activity_reviews`);\n    console.log(`üìä Reviews existentes: ${existingReviews[0]?.count || 0}`);\n\n    // Limpar reviews existentes\n    await db.execute(sql`DELETE FROM activity_reviews`);\n\n    // Obter usu√°rios e atividades\n    const users = await db.execute(sql`SELECT id, username FROM users LIMIT 3`);\n    const activities = await db.execute(sql`\n      SELECT id, title FROM activities \n      WHERE id IN (9, 10, 11, 12, 13, 14) AND title IS NOT NULL\n    `);\n\n    if (users.length === 0 || activities.length === 0) {\n      console.log('‚ö†Ô∏è N√£o h√° usu√°rios ou atividades suficientes para criar reviews');\n      return;\n    }\n\n    console.log(`üë• Usu√°rios: ${users.length}, üéØ Atividades: ${activities.length}`);\n\n    // Coment√°rios real√≠sticos\n    const comments = [\n      'Experi√™ncia incr√≠vel! Superou todas as expectativas.',\n      'Muito bom, mas poderia ser melhor organizado.',\n      'Perfeito! Vista sensacional e atendimento excelente.',\n      'Fant√°stico! Uma das melhores experi√™ncias que j√° tive.',\n      'Maravilhoso! Vale cada centavo.',\n      'Simplesmente espetacular!'\n    ];\n\n    // Criar reviews para cada atividade\n    for (const activity of activities) {\n      console.log(`üí¨ Criando reviews para: ${activity.title}`);\n      \n      // Criar 1-2 reviews por atividade\n      const numReviews = Math.min(2, users.length);\n      \n      for (let i = 0; i < numReviews; i++) {\n        const user = users[i];\n        const rating = Math.floor(Math.random() * 2) + 4; // 4 ou 5\n        const comment = comments[Math.floor(Math.random() * comments.length)];\n        \n        // Data de visita nos √∫ltimos 3 meses\n        const visitDate = new Date();\n        visitDate.setDate(visitDate.getDate() - Math.floor(Math.random() * 90));\n        const visitDateStr = visitDate.toISOString().split('T')[0];\n\n        try {\n          await db.execute(sql`\n            INSERT INTO activity_reviews \n            (activity_id, user_id, rating, comment, visit_date, is_verified, helpful_votes) \n            VALUES \n            (${activity.id}, ${user.id}, ${rating}, ${comment}, ${visitDateStr}, true, ${Math.floor(Math.random() * 15) + 1})\n          `);\n        } catch (error) {\n          // Ignora duplicatas\n          if (!error.message.includes('Duplicate entry')) {\n            console.error(`Erro ao criar review: ${error.message}`);\n          }\n        }\n      }\n    }\n\n    // Atualizar m√©dias de rating\n    console.log('üìä Atualizando m√©dias de rating...');\n    await db.execute(sql`\n      UPDATE activities a\n      SET \n        average_rating = COALESCE((\n          SELECT AVG(r.rating)\n          FROM activity_reviews r \n          WHERE r.activity_id = a.id AND r.is_hidden = FALSE\n        ), 0),\n        total_ratings = COALESCE((\n          SELECT COUNT(*)\n          FROM activity_reviews r \n          WHERE r.activity_id = a.id AND r.is_hidden = FALSE\n        ), 0)\n    `);\n\n    console.log('‚úÖ Reviews e m√©dias criadas!');\n\n  } catch (error) {\n    console.error('‚ùå Erro ao criar reviews:', error);\n  }\n}\n\n// Executar se chamado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  seedBasicActivities()\n    .then(() => {\n      console.log('‚úÖ Seed b√°sico conclu√≠do!');\n      process.exit(0);\n    })\n    .catch((error) => {\n      console.error('‚ùå Erro no seed:', error);\n      process.exit(1);\n    });\n}","size_bytes":8932},"server/simple-postgres-seed.ts":{"content":"import { db } from \"./db\";\nimport { users, destinations } from \"@shared/schema\";\nimport { createHash } from \"crypto\";\n\nexport async function createSimpleSeedData() {\n  console.log(\"üå± Criando dados b√°sicos PostgreSQL...\");\n  \n  try {\n    // Create test users with Node.js crypto hash\n    const hashPassword = (password: string) => {\n      return createHash('sha256').update(password + 'salt').digest('hex');\n    };\n\n    const testUsers = [\n      {\n        username: 'tom',\n        email: 'tom@example.com',\n        password: hashPassword('password123'),\n        full_name: 'Tom Silva',\n        phone: '+5511999999999',\n        is_verified: true,\n        average_rating: '5.00',\n        total_ratings: 0\n      },\n      {\n        username: 'maria',\n        email: 'maria@example.com', \n        password: hashPassword('password123'),\n        full_name: 'Maria Santos',\n        phone: '+5511888888888',\n        is_verified: true,\n        average_rating: '5.00',\n        total_ratings: 0\n      }\n    ];\n\n    // Insert users\n    for (const user of testUsers) {\n      try {\n        await db.insert(users).values(user).onConflictDoNothing();\n      } catch (error) {\n        console.log(`User ${user.username} already exists, skipping...`);\n      }\n    }\n\n    // Create basic destinations\n    const basicDestinations = [\n      {\n        name: 'Rio de Janeiro',\n        state: 'RJ',\n        country: 'Brasil',\n        country_type: 'nacional',\n        continent: 'Am√©rica do Sul',\n        timezone: 'America/Sao_Paulo',\n        is_active: true\n      },\n      {\n        name: 'S√£o Paulo',\n        state: 'SP', \n        country: 'Brasil',\n        country_type: 'nacional',\n        continent: 'Am√©rica do Sul',\n        timezone: 'America/Sao_Paulo',\n        is_active: true\n      }\n    ];\n\n    // Insert destinations\n    for (const destination of basicDestinations) {\n      try {\n        await db.insert(destinations).values(destination).onConflictDoNothing();\n      } catch (error) {\n        console.log(`Destination ${destination.name} already exists, skipping...`);\n      }\n    }\n\n    console.log(\"‚úÖ Dados b√°sicos PostgreSQL criados com sucesso!\");\n  } catch (error) {\n    console.error(\"‚ùå Erro ao criar dados b√°sicos:\", error);\n    throw error;\n  }\n}","size_bytes":2253},"server/standardize-locations.ts":{"content":"import { db } from \"./db\";\nimport { trips, activities } from \"@shared/schema\";\nimport { eq, sql } from \"drizzle-orm\";\n\n// Script to standardize location references between trips and activities\nasync function standardizeLocations() {\n  console.log(\"üó∫Ô∏è Padronizando refer√™ncias de localiza√ß√£o...\");\n  \n  // Define location mappings for consistency\n  const locationMapping = {\n    // Trips destinations -> Standardized format\n    \"Pantanal, MS\": {\n      city: \"Pantanal\",\n      state: \"MS\",\n      region: \"Centro-Oeste\",\n      country: \"Brasil\",\n      standardized: \"Pantanal, MS\"\n    },\n    \"Salvador, BA\": {\n      city: \"Salvador\",\n      state: \"BA\", \n      region: \"Nordeste\",\n      country: \"Brasil\",\n      standardized: \"Salvador, BA\"\n    },\n    \"Mantiqueira, MG\": {\n      city: \"Mantiqueira\",\n      state: \"MG\",\n      region: \"Sudeste\", \n      country: \"Brasil\",\n      standardized: \"Mantiqueira, MG\"\n    },\n    \"Maragogi, AL\": {\n      city: \"Maragogi\",\n      state: \"AL\",\n      region: \"Nordeste\",\n      country: \"Brasil\", \n      standardized: \"Maragogi, AL\"\n    },\n    \"Ouro Preto, MG\": {\n      city: \"Ouro Preto\",\n      state: \"MG\",\n      region: \"Sudeste\",\n      country: \"Brasil\",\n      standardized: \"Ouro Preto, MG\"\n    },\n    \"Manaus, AM\": {\n      city: \"Manaus\",\n      state: \"AM\",\n      region: \"Norte\",\n      country: \"Brasil\",\n      standardized: \"Manaus, AM\"\n    },\n    \"Florian√≥polis, SC\": {\n      city: \"Florian√≥polis\",\n      state: \"SC\",\n      region: \"Sul\",\n      country: \"Brasil\",\n      standardized: \"Florian√≥polis, SC\"\n    },\n    \"Gramado, RS\": {\n      city: \"Gramado\",\n      state: \"RS\",\n      region: \"Sul\",\n      country: \"Brasil\",\n      standardized: \"Gramado, RS\"\n    },\n    \"Len√ß√≥is Maranhenses, MA\": {\n      city: \"Len√ß√≥is Maranhenses\",\n      state: \"MA\",\n      region: \"Nordeste\",\n      country: \"Brasil\",\n      standardized: \"Len√ß√≥is Maranhenses, MA\"\n    },\n    \"Caruaru, PE\": {\n      city: \"Caruaru\",\n      state: \"PE\",\n      region: \"Nordeste\",\n      country: \"Brasil\",\n      standardized: \"Caruaru, PE\"\n    },\n    \"Rio de Janeiro, RJ\": {\n      city: \"Rio de Janeiro\",\n      state: \"RJ\",\n      region: \"Sudeste\",\n      country: \"Brasil\",\n      standardized: \"Rio de Janeiro, RJ\"\n    },\n    \"El Calafate, Argentina\": {\n      city: \"El Calafate\",\n      state: \"Santa Cruz\",\n      region: \"Patagonia\",\n      country: \"Argentina\",\n      standardized: \"El Calafate, Argentina\"\n    },\n    \"Cusco, Peru\": {\n      city: \"Cusco\",\n      state: \"Cusco\",\n      region: \"Andes\",\n      country: \"Peru\",\n      standardized: \"Cusco, Peru\"\n    },\n    \"Nairobi, Qu√™nia\": {\n      city: \"Nairobi\",\n      state: \"Nairobi\",\n      region: \"√Åfrica Oriental\",\n      country: \"Qu√™nia\",\n      standardized: \"Nairobi, Qu√™nia\"\n    }\n  };\n\n  try {\n    // Get all trips and activities\n    const allTrips = await db.select().from(trips);\n    const allActivities = await db.select().from(activities);\n\n    console.log(\"üìä An√°lise atual:\");\n    console.log(`   Viagens: ${allTrips.length}`);\n    console.log(`   Atividades: ${allActivities.length}`);\n\n    // Update activities to match trip destinations exactly\n    console.log(\"\\nüîÑ Atualizando atividades para corresponder aos destinos das viagens...\");\n    \n    for (const trip of allTrips) {\n      const mapping = locationMapping[trip.destination as keyof typeof locationMapping];\n      if (!mapping) {\n        console.log(`‚ö†Ô∏è Mapeamento n√£o encontrado para: ${trip.destination}`);\n        continue;\n      }\n\n      // Find activities that should belong to this destination\n      const relatedActivities = allActivities.filter(activity => {\n        // Check if activity city matches trip city\n        const activityCity = activity.city || activity.location.split(',')[0].trim();\n        return activityCity === mapping.city || \n               activity.location.includes(mapping.city) ||\n               activity.location === mapping.standardized;\n      });\n\n      console.log(`\\nüìç ${trip.destination} (${mapping.city}):`);\n      console.log(`   Atividades relacionadas: ${relatedActivities.length}`);\n\n      // Update each related activity to use standardized location\n      for (const activity of relatedActivities) {\n        try {\n          await db.update(activities)\n            .set({\n              location: mapping.standardized,\n              city: mapping.city,\n              region: mapping.region,\n              countryType: mapping.country === \"Brasil\" ? \"nacional\" : \"internacional\",\n              updatedAt: new Date()\n            })\n            .where(eq(activities.id, activity.id));\n          \n          console.log(`   ‚úÖ Atualizada: ${activity.title}`);\n        } catch (error) {\n          console.error(`   ‚ùå Erro ao atualizar ${activity.title}:`, error);\n        }\n      }\n    }\n\n    // Verify the standardization worked\n    console.log(\"\\nüîç Verificando padroniza√ß√£o...\");\n    \n    for (const trip of allTrips) {\n      const mapping = locationMapping[trip.destination as keyof typeof locationMapping];\n      if (!mapping) continue;\n\n      const matchingActivities = await db.select()\n        .from(activities)\n        .where(eq(activities.city, mapping.city));\n\n      console.log(`üìç ${trip.destination} -> ${matchingActivities.length} atividades correspondentes`);\n    }\n\n    console.log(\"\\nüéâ Padroniza√ß√£o conclu√≠da com sucesso!\");\n\n  } catch (error) {\n    console.error(\"‚ùå Erro durante padroniza√ß√£o:\", error);\n  }\n}\n\n// Execute the function\nstandardizeLocations().catch(console.error);","size_bytes":5514},"server/storage.ts":{"content":"import { users, trips, tripParticipants, messages, tripRequests, expenses, expenseSplits, userRatings, destinationRatings, verificationRequests, activities, activityReviews, activityBookings, activityBudgetProposals, activityBudgetProposalVotes, tripActivities, destinations, type User, type InsertUser, type Trip, type InsertTrip, type Message, type InsertMessage, type TripRequest, type InsertTripRequest, type TripParticipant, type Expense, type InsertExpense, type ExpenseSplit, type InsertExpenseSplit, type UserRating, type InsertUserRating, type DestinationRating, type InsertDestinationRating, type VerificationRequest, type InsertVerificationRequest, type Activity, type InsertActivity, type ActivityReview, type InsertActivityReview, type ActivityBooking, type InsertActivityBooking, type ActivityBudgetProposal, type ActivityBudgetProposalVote, type InsertActivityBudgetProposal, type TripActivity, type InsertTripActivity } from \"@shared/schema\";\nimport session from \"express-session\";\nimport createMemoryStore from \"memorystore\";\nimport { db, testConnection } from \"./db\";\nimport { eq, and, sql, desc, asc, gte, lte, ne, like, count } from \"drizzle-orm\";\n\nconst MemoryStore = createMemoryStore(session);\n\n// Storage interface for PostgreSQL\nexport interface IStorage {\n  // User management\n  createUser(user: InsertUser): Promise<User>;\n  getUserById(id: number): Promise<User | null>;\n  getUserByUsername(username: string): Promise<User | null>;\n  getUserByEmail(email: string): Promise<User | null>;\n  getUserByPhone(phone: string): Promise<User | null>;\n  updateUser(id: number, updates: Partial<User>): Promise<User | null>;\n  getAllUsers(): Promise<User[]>;\n  \n  // Trip management\n  createTrip(trip: InsertTrip): Promise<Trip>;\n  getTripById(id: number): Promise<Trip | null>;\n  getAllTrips(): Promise<Trip[]>;\n  getUserTrips(userId: number): Promise<{ created: Trip[], participating: Trip[] }>;\n  updateTrip(id: number, updates: Partial<Trip>): Promise<Trip | null>;\n  deleteTrip(id: number): Promise<boolean>;\n  \n  // Participants\n  addParticipant(tripId: number, userId: number): Promise<TripParticipant>;\n  updateParticipantStatus(tripId: number, userId: number, status: string): Promise<boolean>;\n  getTripParticipants(tripId: number): Promise<Array<TripParticipant & { user: User }>>;\n  \n  // Messages\n  addMessage(message: InsertMessage): Promise<Message>;\n  getTripMessages(tripId: number): Promise<Array<Message & { sender: User }>>;\n  \n  // Destinations\n  getAllDestinations(): Promise<any[]>;\n  getDestinationById(id: number): Promise<any | null>;\n  createDestination(destination: any): Promise<any>;\n  getDestinations(search?: string): Promise<any[]>;\n  \n  // Activities\n  getAllActivities(): Promise<Activity[]>;\n  getActivityById(id: number): Promise<Activity | null>;\n  createActivity(activity: InsertActivity): Promise<Activity>;\n  getActivitiesByLocation(location: string): Promise<Activity[]>;\n  getActivities(filters: any): Promise<Activity[]>;\n  \n  // Trip requests\n  getTripRequests(tripId: number): Promise<TripRequest[]>;\n  \n  // Additional methods for compatibility\n  getTripsByCreator(creatorId: number): Promise<Trip[]>;\n  getTripsByParticipant(userId: number): Promise<Trip[]>;\n  \n  // Additional required methods from routes\n  getTripExpenses(tripId: number): Promise<Expense[]>;\n  getTripBalances(tripId: number): Promise<any[]>;\n  getUserActivityBookings(userId: number): Promise<ActivityBooking[]>;\n  getUserVoteForActivity(userId: number, activityId: number): Promise<any>;\n  getUserVoteForProposal(userId: number, proposalId: number): Promise<any>;\n  getTripActivities(tripId: number): Promise<TripActivity[]>;\n  getUserTripsInLocation(userId: number, location: string): Promise<Trip[]>;\n  getUserRatings(userId: number): Promise<UserRating[]>;\n  \n  // Additional methods needed by routes\n  fixCreatorsAsParticipants(): Promise<number>;\n  addTripParticipant(tripId: number, userId: number): Promise<TripParticipant>;\n  removeTripParticipant(tripId: number, userId: number): Promise<boolean>;\n  createMessage(messageData: InsertMessage): Promise<Message>;\n  createExpense(expenseData: InsertExpense): Promise<Expense>;\n  createExpenseSplits(expenseId: number, splits: InsertExpenseSplit[]): Promise<ExpenseSplit[]>;\n  getUserTripRequests(userId: number): Promise<TripRequest[]>;\n  \n  // Activity budget proposals\n  getActivityBudgetProposals(activityId: number): Promise<ActivityBudgetProposal[]>;\n  createActivityBudgetProposal(proposalData: InsertActivityBudgetProposal): Promise<ActivityBudgetProposal>;\n  \n  // Activity reviews\n  getActivityReviews(activityId: number): Promise<ActivityReview[]>;\n  createActivityReview(reviewData: InsertActivityReview): Promise<ActivityReview>;\n}\n\n// PostgreSQL Storage Implementation\nexport class PostgreSQLStorage implements IStorage {\n  \n  async createUser(userData: InsertUser): Promise<User> {\n    const [user] = await db.insert(users).values(userData).returning();\n    return user;\n  }\n\n  async getUserById(id: number): Promise<User | null> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user || null;\n  }\n\n  async getUserByUsername(username: string): Promise<User | null> {\n    const [user] = await db.select().from(users).where(eq(users.username, username));\n    return user || null;\n  }\n\n  async getUserByEmail(email: string): Promise<User | null> {\n    const [user] = await db.select().from(users).where(eq(users.email, email));\n    return user || null;\n  }\n\n  async getUserByPhone(phone: string): Promise<User | null> {\n    const [user] = await db.select().from(users).where(eq(users.phone, phone));\n    return user || null;\n  }\n\n  async updateUser(id: number, updates: Partial<User>): Promise<User | null> {\n    const [user] = await db.update(users).set(updates).where(eq(users.id, id)).returning();\n    return user || null;\n  }\n\n  async getAllUsers(): Promise<User[]> {\n    return await db.select().from(users);\n  }\n\n  async createTrip(tripData: InsertTrip): Promise<Trip> {\n    const [trip] = await db.insert(trips).values([tripData]).returning();\n    return trip;\n  }\n\n  async getTripById(id: number): Promise<Trip | null> {\n    // Join with destinations to get destination name\n    const [result] = await db\n      .select({\n        id: trips.id,\n        creator_id: trips.creator_id,\n        title: trips.title,\n        destination_id: trips.destination_id,\n        destination_name: destinations.name,\n        destination_state: destinations.state,\n        destination_country: destinations.country,\n        cover_image: trips.cover_image,\n        start_date: trips.start_date,\n        end_date: trips.end_date,\n        budget: trips.budget,\n        budget_breakdown: trips.budget_breakdown,\n        max_participants: trips.max_participants,\n        current_participants: trips.current_participants,\n        description: trips.description,\n        travel_style: trips.travel_style,\n        shared_costs: trips.shared_costs,\n        planned_activities: trips.planned_activities,\n        status: trips.status,\n        created_at: trips.created_at,\n      })\n      .from(trips)\n      .leftJoin(destinations, eq(trips.destination_id, destinations.id))\n      .where(eq(trips.id, id));\n\n    if (!result) return null;\n\n    // Add formatted destination string\n    const trip = {\n      ...result,\n      destination: result.destination_state \n        ? `${result.destination_name}, ${result.destination_state}` \n        : `${result.destination_name}, ${result.destination_country}`\n    };\n\n    return trip as Trip;\n  }\n\n  async getAllTrips(): Promise<Trip[]> {\n    // Join with destinations to get destination name\n    const result = await db\n      .select({\n        id: trips.id,\n        creator_id: trips.creator_id,\n        title: trips.title,\n        destination_id: trips.destination_id,\n        destination_name: destinations.name,\n        destination_state: destinations.state,\n        destination_country: destinations.country,\n        cover_image: trips.cover_image,\n        start_date: trips.start_date,\n        end_date: trips.end_date,\n        budget: trips.budget,\n        budget_breakdown: trips.budget_breakdown,\n        max_participants: trips.max_participants,\n        current_participants: trips.current_participants,\n        description: trips.description,\n        travel_style: trips.travel_style,\n        shared_costs: trips.shared_costs,\n        planned_activities: trips.planned_activities,\n        status: trips.status,\n        created_at: trips.created_at,\n      })\n      .from(trips)\n      .leftJoin(destinations, eq(trips.destination_id, destinations.id))\n      .orderBy(desc(trips.created_at));\n\n    // Map to include a formatted destination string\n    return result.map(trip => ({\n      ...trip,\n      destination: trip.destination_state \n        ? `${trip.destination_name}, ${trip.destination_state}` \n        : `${trip.destination_name}, ${trip.destination_country}`\n    })) as Trip[];\n  }\n\n  async getUserTrips(userId: number): Promise<{ created: Trip[], participating: Trip[] }> {\n    // Get created trips with destination names\n    const createdResults = await db\n      .select({\n        id: trips.id,\n        creator_id: trips.creator_id,\n        title: trips.title,\n        destination_id: trips.destination_id,\n        destination_name: destinations.name,\n        destination_state: destinations.state,\n        destination_country: destinations.country,\n        cover_image: trips.cover_image,\n        start_date: trips.start_date,\n        end_date: trips.end_date,\n        budget: trips.budget,\n        budget_breakdown: trips.budget_breakdown,\n        max_participants: trips.max_participants,\n        current_participants: trips.current_participants,\n        description: trips.description,\n        travel_style: trips.travel_style,\n        shared_costs: trips.shared_costs,\n        planned_activities: trips.planned_activities,\n        status: trips.status,\n        created_at: trips.created_at\n      })\n      .from(trips)\n      .leftJoin(destinations, eq(trips.destination_id, destinations.id))\n      .where(eq(trips.creator_id, userId));\n    \n    // Get participating trips with destination names\n    const participatingResults = await db\n      .select({\n        id: trips.id,\n        creator_id: trips.creator_id,\n        title: trips.title,\n        destination_id: trips.destination_id,\n        destination_name: destinations.name,\n        destination_state: destinations.state,\n        destination_country: destinations.country,\n        cover_image: trips.cover_image,\n        start_date: trips.start_date,\n        end_date: trips.end_date,\n        budget: trips.budget,\n        budget_breakdown: trips.budget_breakdown,\n        max_participants: trips.max_participants,\n        current_participants: trips.current_participants,\n        description: trips.description,\n        travel_style: trips.travel_style,\n        shared_costs: trips.shared_costs,\n        planned_activities: trips.planned_activities,\n        status: trips.status,\n        created_at: trips.created_at\n      })\n      .from(trips)\n      .leftJoin(destinations, eq(trips.destination_id, destinations.id))\n      .innerJoin(tripParticipants, eq(trips.id, tripParticipants.trip_id))\n      .where(and(\n        eq(tripParticipants.user_id, userId),\n        eq(tripParticipants.status, 'accepted'),\n        ne(trips.creator_id, userId) // Exclude trips they created\n      ));\n\n    // Format destination strings\n    const created = createdResults.map(trip => ({\n      ...trip,\n      destination: trip.destination_state \n        ? `${trip.destination_name}, ${trip.destination_state}` \n        : `${trip.destination_name}, ${trip.destination_country}`\n    })) as Trip[];\n\n    const participating = participatingResults.map(trip => ({\n      ...trip,\n      destination: trip.destination_state \n        ? `${trip.destination_name}, ${trip.destination_state}` \n        : `${trip.destination_name}, ${trip.destination_country}`\n    })) as Trip[];\n\n    return { created, participating };\n  }\n\n  async updateTrip(id: number, updates: Partial<Trip>): Promise<Trip | null> {\n    const [trip] = await db.update(trips).set(updates).where(eq(trips.id, id)).returning();\n    return trip || null;\n  }\n\n  async deleteTrip(id: number): Promise<boolean> {\n    const result = await db.delete(trips).where(eq(trips.id, id));\n    return true;\n  }\n\n  async addParticipant(tripId: number, userId: number): Promise<TripParticipant> {\n    const [participant] = await db.insert(tripParticipants).values({\n      trip_id: tripId,\n      user_id: userId,\n      status: 'pending'\n    }).returning();\n    return participant;\n  }\n\n  async updateParticipantStatus(tripId: number, userId: number, status: string): Promise<boolean> {\n    await db.update(tripParticipants)\n      .set({ status })\n      .where(and(\n        eq(tripParticipants.trip_id, tripId),\n        eq(tripParticipants.user_id, userId)\n      ));\n    return true;\n  }\n\n  async getTripParticipants(tripId: number): Promise<Array<TripParticipant & { user: User }>> {\n    return await db\n      .select({\n        id: tripParticipants.id,\n        trip_id: tripParticipants.trip_id,\n        user_id: tripParticipants.user_id,\n        status: tripParticipants.status,\n        joined_at: tripParticipants.joined_at,\n        user: {\n          id: users.id,\n          username: users.username,\n          email: users.email,\n          full_name: users.full_name,\n          phone: users.phone,\n          bio: users.bio,\n          location: users.location,\n          profile_photo: users.profile_photo,\n          languages: users.languages,\n          interests: users.interests,\n          travel_styles: users.travel_styles,\n          referred_by: users.referred_by,\n          is_verified: users.is_verified,\n          verification_method: users.verification_method,\n          average_rating: users.average_rating,\n          total_ratings: users.total_ratings,\n          created_at: users.created_at\n        }\n      })\n      .from(tripParticipants)\n      .innerJoin(users, eq(tripParticipants.user_id, users.id))\n      .where(eq(tripParticipants.trip_id, tripId));\n  }\n\n  async addMessage(messageData: InsertMessage): Promise<Message> {\n    const [message] = await db.insert(messages).values(messageData).returning();\n    return message;\n  }\n\n  async getTripMessages(tripId: number): Promise<Array<Message & { sender: User }>> {\n    return await db\n      .select({\n        id: messages.id,\n        trip_id: messages.trip_id,\n        sender_id: messages.sender_id,\n        content: messages.content,\n        sent_at: messages.sent_at,\n        sender: users\n      })\n      .from(messages)\n      .innerJoin(users, eq(messages.sender_id, users.id))\n      .where(eq(messages.trip_id, tripId))\n      .orderBy(asc(messages.sent_at));\n  }\n\n  async getAllDestinations(): Promise<any[]> {\n    return await db.select().from(destinations).where(eq(destinations.is_active, true));\n  }\n\n  async getDestinationById(id: number): Promise<any | null> {\n    const [destination] = await db.select().from(destinations).where(eq(destinations.id, id));\n    return destination || null;\n  }\n\n  async createDestination(destinationData: any): Promise<any> {\n    const [destination] = await db.insert(destinations).values(destinationData).returning();\n    return destination;\n  }\n\n  async getDestinations(search?: string): Promise<any[]> {\n    let baseQuery = db.select().from(destinations);\n    \n    if (search) {\n      return await baseQuery\n        .where(\n          and(\n            eq(destinations.is_active, true),\n            sql`(${destinations.name} ILIKE ${`%${search}%`} OR ${destinations.region} ILIKE ${`%${search}%`} OR ${destinations.state} ILIKE ${`%${search}%`})`\n          )\n        )\n        .orderBy(asc(destinations.name));\n    }\n    \n    return await baseQuery\n      .where(eq(destinations.is_active, true))\n      .orderBy(asc(destinations.name));\n  }\n\n  async getAllActivities(): Promise<Activity[]> {\n    return await db.select().from(activities);\n  }\n\n  async getActivityById(id: number): Promise<Activity | null> {\n    const [activity] = await db.select().from(activities).where(eq(activities.id, id));\n    return activity || null;\n  }\n\n  async createActivity(activityData: InsertActivity): Promise<Activity> {\n    // Get destination data to populate inherited fields\n    const { getDestinationForActivity } = await import(\"./activity-destination-helper\");\n    const destinationFields = await getDestinationForActivity(activityData.destination_id);\n    \n    // Merge activity data with destination fields\n    const completeActivityData = {\n      ...activityData,\n      ...destinationFields\n    };\n    \n    const [activity] = await db.insert(activities).values(completeActivityData).returning();\n    return activity;\n  }\n\n  async getActivitiesByLocation(location: string): Promise<Activity[]> {\n    return await db.select().from(activities).where(like(activities.destination_name, `%${location}%`));\n  }\n\n  async updateActivity(id: number, updates: Partial<Activity>): Promise<Activity | null> {\n    // If destination_id is being updated, refresh destination fields\n    if (updates.destination_id) {\n      const { getDestinationForActivity } = await import(\"./activity-destination-helper\");\n      const destinationFields = await getDestinationForActivity(updates.destination_id);\n      updates = { ...updates, ...destinationFields };\n    }\n    \n    const [activity] = await db.update(activities)\n      .set(updates)\n      .where(eq(activities.id, id))\n      .returning();\n    return activity;\n  }\n\n  async getActivity(id: number): Promise<Activity | null> {\n    return this.getActivityById(id);\n  }\n\n  async getTripRequests(tripId: number): Promise<TripRequest[]> {\n    return await db.select().from(tripRequests).where(eq(tripRequests.trip_id, tripId));\n  }\n\n  async getTripsByCreator(creatorId: number): Promise<Trip[]> {\n    return await db.select().from(trips).where(eq(trips.creator_id, creatorId));\n  }\n\n  async getTripsByParticipant(userId: number): Promise<Trip[]> {\n    return await db\n      .select({\n        id: trips.id,\n        creator_id: trips.creator_id,\n        title: trips.title,\n        destination_id: trips.destination_id,\n        cover_image: trips.cover_image,\n        start_date: trips.start_date,\n        end_date: trips.end_date,\n        budget: trips.budget,\n        budget_breakdown: trips.budget_breakdown,\n        max_participants: trips.max_participants,\n        current_participants: trips.current_participants,\n        description: trips.description,\n        travel_style: trips.travel_style,\n        shared_costs: trips.shared_costs,\n        planned_activities: trips.planned_activities,\n        status: trips.status,\n        created_at: trips.created_at\n      })\n      .from(trips)\n      .innerJoin(tripParticipants, eq(trips.id, tripParticipants.trip_id))\n      .where(and(\n        eq(tripParticipants.user_id, userId),\n        eq(tripParticipants.status, 'accepted')\n      ));\n  }\n\n  // Additional placeholder methods - will be implemented as needed\n  async getTripExpenses(tripId: number): Promise<any[]> {\n    // First get all expenses with payer info\n    const expensesWithPayers = await db\n      .select({\n        id: expenses.id,\n        trip_id: expenses.trip_id,\n        paid_by: expenses.paid_by,\n        amount: expenses.amount,\n        description: expenses.description,\n        category: expenses.category,\n        receipt: expenses.receipt,\n        created_at: expenses.created_at,\n        settled_at: expenses.settled_at,\n        payer: {\n          id: users.id,\n          username: users.username,\n          email: users.email,\n          full_name: users.full_name,\n          phone: users.phone,\n          bio: users.bio,\n          location: users.location,\n          profile_photo: users.profile_photo,\n          languages: users.languages,\n          interests: users.interests,\n          travel_styles: users.travel_styles,\n          referred_by: users.referred_by,\n          is_verified: users.is_verified,\n          verification_method: users.verification_method,\n          average_rating: users.average_rating,\n          total_ratings: users.total_ratings,\n          created_at: users.created_at\n        }\n      })\n      .from(expenses)\n      .innerJoin(users, eq(expenses.paid_by, users.id))\n      .where(eq(expenses.trip_id, tripId))\n      .orderBy(desc(expenses.created_at));\n    \n    // For each expense, get its splits separately to avoid complex SQL\n    const expensesWithSplits = [];\n    for (const expense of expensesWithPayers) {\n      const splits = await db\n        .select({\n          id: expenseSplits.id,\n          user_id: expenseSplits.user_id,\n          amount: expenseSplits.amount,\n          paid: expenseSplits.paid,\n          settled_at: expenseSplits.settled_at,\n          user: {\n            id: users.id,\n            username: users.username,\n            email: users.email,\n            full_name: users.full_name,\n            phone: users.phone,\n            bio: users.bio,\n            location: users.location,\n            profile_photo: users.profile_photo,\n            languages: users.languages,\n            interests: users.interests,\n            travel_styles: users.travel_styles,\n            referred_by: users.referred_by,\n            is_verified: users.is_verified,\n            verification_method: users.verification_method,\n            average_rating: users.average_rating,\n            total_ratings: users.total_ratings,\n            created_at: users.created_at\n          }\n        })\n        .from(expenseSplits)\n        .innerJoin(users, eq(expenseSplits.user_id, users.id))\n        .where(eq(expenseSplits.expense_id, expense.id));\n      \n      expensesWithSplits.push({\n        ...expense,\n        created_at: expense.created_at, // Add missing field expected by frontend\n        splits\n      });\n    }\n    \n    return expensesWithSplits;\n  }\n\n  async getTripBalances(tripId: number): Promise<any[]> {\n    // Placeholder implementation\n    return [];\n  }\n\n  async getUserActivityBookings(userId: number): Promise<ActivityBooking[]> {\n    return await db.select().from(activityBookings).where(eq(activityBookings.user_id, userId));\n  }\n\n  async getUserVoteForActivity(userId: number, activityId: number): Promise<any> {\n    // Placeholder implementation\n    return null;\n  }\n\n  async getUserVoteForProposal(userId: number, proposalId: number): Promise<any> {\n    // Placeholder implementation\n    return null;\n  }\n\n  async getTripActivities(tripId: number): Promise<TripActivity[]> {\n    return await db.select().from(tripActivities).where(eq(tripActivities.trip_id, tripId));\n  }\n\n  async getUserTripsInLocation(userId: number, location: string): Promise<Trip[]> {\n    // Get user's trips and filter by location\n    const userTrips = await this.getUserTrips(userId);\n    return [...userTrips.created, ...userTrips.participating];\n  }\n\n  async getUserRatings(userId: number): Promise<UserRating[]> {\n    return await db.select().from(userRatings).where(eq(userRatings.rated_user_id, userId));\n  }\n\n  // Additional methods needed by routes\n  async fixCreatorsAsParticipants(): Promise<number> {\n    // Placeholder - returns 0 for now\n    return 0;\n  }\n\n  async addTripParticipant(tripId: number, userId: number): Promise<TripParticipant> {\n    return this.addParticipant(tripId, userId);\n  }\n\n  async removeTripParticipant(tripId: number, userId: number): Promise<boolean> {\n    await db.delete(tripParticipants).where(and(\n      eq(tripParticipants.trip_id, tripId),\n      eq(tripParticipants.user_id, userId)\n    ));\n    return true;\n  }\n\n  async createMessage(messageData: InsertMessage): Promise<Message> {\n    return this.addMessage(messageData);\n  }\n\n  async createExpense(expenseData: InsertExpense): Promise<Expense> {\n    const [expense] = await db.insert(expenses).values({\n      ...expenseData,\n      paid_by: 1 // TODO: Get from authenticated user\n    }).returning();\n    return expense;\n  }\n\n  async createExpenseSplits(expenseId: number, splits: InsertExpenseSplit[]): Promise<ExpenseSplit[]> {\n    console.log('createExpenseSplits called with:', { expenseId, splits });\n    \n    if (!splits || !Array.isArray(splits)) {\n      console.error('Invalid splits data:', splits);\n      throw new Error('Splits must be a valid array');\n    }\n    \n    if (splits.length === 0) {\n      console.error('Empty splits array');\n      throw new Error('Splits array cannot be empty');\n    }\n    \n    const splitData = splits.map(split => ({ ...split, expense_id: expenseId }));\n    console.log('Final split data:', splitData);\n    \n    return await db.insert(expenseSplits).values(splitData.map(split => ({\n      ...split,\n      amount: split.amount.toString() // Convert number to string for PostgreSQL\n    }))).returning();\n  }\n\n  async getUserTripRequests(userId: number): Promise<TripRequest[]> {\n    return await db.select().from(tripRequests).where(eq(tripRequests.user_id, userId));\n  }\n\n  async getActivities(filters: any): Promise<Activity[]> {\n    let query = db.select().from(activities);\n    \n    // Apply filters if provided\n    if (filters.category) {\n      query = query.where(eq(activities.category, filters.category));\n    }\n    if (filters.location) {\n      query = query.where(eq(activities.destination_name, filters.location));\n    }\n    if (filters.isActive !== undefined) {\n      query = query.where(eq(activities.is_active, filters.isActive));\n    }\n    \n    return await query.orderBy(desc(activities.average_rating), desc(activities.total_ratings));\n  }\n\n  async getActivityBudgetProposals(activityId: number): Promise<ActivityBudgetProposal[]> {\n    try {\n      console.log('üîç Buscando propostas para atividade:', activityId);\n      const result = await db.select().from(activityBudgetProposals)\n        .where(eq(activityBudgetProposals.activity_id, activityId))\n        .orderBy(asc(activityBudgetProposals.amount));\n      console.log('‚úÖ Propostas encontradas:', result.length);\n      return result;\n    } catch (error) {\n      console.error('‚ùå Erro na query SQL:', error);\n      throw error;\n    }\n  }\n\n  async createActivityBudgetProposal(proposalData: InsertActivityBudgetProposal): Promise<ActivityBudgetProposal> {\n    const [proposal] = await db.insert(activityBudgetProposals).values({\n      ...proposalData,\n      // activity_id and created_by should already be in proposalData\n      amount: proposalData.amount.toString() // Convert to string for PostgreSQL\n    }).returning();\n    return proposal;\n  }\n\n  async getActivityReviews(activityId: number): Promise<ActivityReview[]> {\n    try {\n      console.log('üîç Buscando avalia√ß√µes para atividade:', activityId);\n      // Use raw SQL as a workaround for Drizzle schema issues\n      const result = await db.execute(sql`\n        SELECT * FROM activity_reviews \n        WHERE activity_id = ${activityId} \n        ORDER BY created_at DESC\n      `);\n      console.log('‚úÖ Avalia√ß√µes encontradas:', result.rowCount);\n      return result.rows as unknown as ActivityReview[];\n    } catch (error) {\n      console.error('‚ùå Erro ao buscar avalia√ß√µes:', error);\n      throw error;\n    }\n  }\n\n  async createActivityReview(reviewData: InsertActivityReview): Promise<ActivityReview> {\n    const [review] = await db.insert(activityReviews).values({\n      ...reviewData,\n      // user_id should already be in reviewData\n    }).returning();\n    return review;\n  }\n}\n\n// Create storage instance\nexport const storage = new PostgreSQLStorage();\n\n// Session configuration\nexport const sessionConfig = {\n  store: new MemoryStore({\n    checkPeriod: 86400000, // prune expired entries every 24h\n  }),\n  secret: process.env.SESSION_SECRET || \"fallback-secret-key-for-development\",\n  resave: false,\n  saveUninitialized: false,\n  cookie: {\n    secure: false, // Set to true if using HTTPS\n    httpOnly: false, // Allow client-side access for debugging\n    maxAge: 24 * 60 * 60 * 1000, // 24 hours\n    sameSite: 'lax' as const,\n  },\n};","size_bytes":27967},"server/sync-participants.ts":{"content":"import { db } from \"./db.js\";\nimport { trips, tripParticipants } from \"@shared/schema.js\";\nimport { eq, count, and } from \"drizzle-orm\";\n\n/**\n * Synchronizes the currentParticipants field with actual accepted participants count\n * This ensures data consistency across the application\n */\nexport async function syncParticipantsCount() {\n  console.log('üîÑ Sincronizando contagem de participantes...');\n  \n  try {\n    // Get all trips\n    const allTrips = await db.select({\n      id: trips.id,\n      title: trips.title,\n      current_participants: trips.current_participants\n    }).from(trips);\n\n    console.log(`üìä Verificando ${allTrips.length} viagens...`);\n\n    let updatedCount = 0;\n\n    for (const trip of allTrips) {\n      // Count actual accepted participants for this trip only\n      const [result] = await db\n        .select({ count: count() })\n        .from(tripParticipants)\n        .where(and(\n          eq(tripParticipants.trip_id, trip.id),\n          eq(tripParticipants.status, 'accepted')\n        ));\n\n      const realParticipantsCount = result.count;\n\n      // Only update if counts don't match\n      if (trip.current_participants !== realParticipantsCount) {\n        await db\n          .update(trips)\n          .set({ current_participants: realParticipantsCount })\n          .where(eq(trips.id, trip.id));\n\n        console.log(`‚úÖ Viagem \"${trip.title}\" atualizada: ${trip.current_participants} ‚Üí ${realParticipantsCount} participantes`);\n        updatedCount++;\n      }\n    }\n\n    if (updatedCount === 0) {\n      console.log('‚úÖ Todas as contagens de participantes j√° est√£o sincronizadas');\n    } else {\n      console.log(`‚úÖ Sincroniza√ß√£o conclu√≠da: ${updatedCount} viagens atualizadas`);\n    }\n\n  } catch (error) {\n    console.error('‚ùå Erro ao sincronizar participantes:', error);\n    throw error;\n  }\n}\n\n/**\n * Updates currentParticipants for a specific trip based on accepted participants\n */\nexport async function syncTripParticipants(tripId: number) {\n  try {\n    const [result] = await db\n      .select({ count: count() })\n      .from(tripParticipants)\n      .where(and(\n        eq(tripParticipants.trip_id, tripId),\n        eq(tripParticipants.status, 'accepted')\n      ));\n\n    const realParticipantsCount = result.count;\n\n    await db\n      .update(trips)\n      .set({ current_participants: realParticipantsCount })\n      .where(eq(trips.id, tripId));\n\n    console.log(`‚úÖ Viagem ${tripId} sincronizada: ${realParticipantsCount} participantes aceitos`);\n    \n    return realParticipantsCount;\n  } catch (error) {\n    console.error(`‚ùå Erro ao sincronizar viagem ${tripId}:`, error);\n    throw error;\n  }\n}","size_bytes":2650},"server/test-activity-157.ts":{"content":"import { db } from './db.js';\nimport { activityBudgetProposals } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nasync function testActivity157() {\n  try {\n    console.log('üîç Testando atividade 157 (Flutua√ß√£o no Rio da Prata)...');\n    \n    const proposals = await db.select()\n      .from(activityBudgetProposals)\n      .where(eq(activityBudgetProposals.activityId, 157));\n    \n    console.log(`üìä Propostas encontradas: ${proposals.length}`);\n    \n    proposals.forEach((proposal, index) => {\n      console.log(`${index + 1}. ${proposal.title} - R$ ${proposal.amount}`);\n      console.log(`   Descri√ß√£o: ${proposal.description}`);\n      console.log(`   Ativo: ${proposal.isActive}`);\n      console.log(`   Inclus√µes: ${proposal.inclusions}`);\n      console.log(`   Exclus√µes: ${proposal.exclusions}`);\n      console.log('');\n    });\n\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  }\n}\n\ntestActivity157().then(() => process.exit(0)).catch(err => {\n  console.error(err);\n  process.exit(1);\n});","size_bytes":1079},"server/test-activity-162.ts":{"content":"import { db } from './db.js';\nimport { activityBudgetProposals } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nasync function testActivity162() {\n  try {\n    console.log('üîç Testando atividade 162...');\n    \n    const proposals = await db.select()\n      .from(activityBudgetProposals)\n      .where(eq(activityBudgetProposals.activityId, 162));\n    \n    console.log(`üìä Propostas encontradas: ${proposals.length}`);\n    \n    proposals.forEach((proposal, index) => {\n      console.log(`${index + 1}. ${proposal.title} - R$ ${proposal.amount}`);\n      console.log(`   Descri√ß√£o: ${proposal.description}`);\n      console.log(`   Ativo: ${proposal.isActive}`);\n      console.log(`   Inclus√µes: ${proposal.inclusions}`);\n      console.log(`   Exclus√µes: ${proposal.exclusions}`);\n      console.log('');\n    });\n\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  }\n}\n\ntestActivity162().then(() => process.exit(0)).catch(err => {\n  console.error(err);\n  process.exit(1);\n});","size_bytes":1049},"server/test-proposals-api.ts":{"content":"import { db } from './db.js';\nimport { activityBudgetProposals, users } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\nimport dotenv from 'dotenv';\n\ndotenv.config();\n\nasync function testProposalsAPI() {\n  try {\n    console.log('üîç Testando propostas da atividade 162...');\n    \n    // Verificar se usu√°rio criador existe\n    const [user] = await db.select().from(users).where(eq(users.id, 1));\n    console.log('Usu√°rio criador ID 1:', user ? user.username : 'N√ÉO ENCONTRADO');\n    \n    // Buscar propostas brutas\n    const rawProposals = await db.select().from(activityBudgetProposals)\n      .where(eq(activityBudgetProposals.activityId, 162));\n    \n    console.log(`\\nüìä Propostas brutas: ${rawProposals.length}`);\n    rawProposals.forEach((p, i) => {\n      console.log(`${i+1}. ${p.title} - Criado por: ${p.createdBy} - Ativo: ${p.isActive}`);\n    });\n    \n    // Buscar propostas ativas apenas\n    const activeProposals = await db.select().from(activityBudgetProposals)\n      .where(eq(activityBudgetProposals.activityId, 162))\n      .where(eq(activityBudgetProposals.isActive, true));\n    \n    console.log(`\\nüìä Propostas ativas: ${activeProposals.length}`);\n    \n    // Simular o m√©todo getActivityBudgetProposals\n    const result = [];\n    for (const proposal of activeProposals) {\n      const creator = await db.select().from(users).where(eq(users.id, proposal.createdBy));\n      if (creator.length > 0) {\n        result.push({\n          ...proposal,\n          creator: { id: creator[0].id, username: creator[0].username, email: creator[0].email }\n        });\n      } else {\n        console.log(`‚ö†Ô∏è Criador ${proposal.createdBy} n√£o encontrado para proposta ${proposal.title}`);\n      }\n    }\n    \n    console.log(`\\n‚úÖ Resultado final: ${result.length} propostas com criadores`);\n\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  }\n}\n\ntestProposalsAPI().then(() => process.exit(0)).catch(err => {\n  console.error(err);\n  process.exit(1);\n});","size_bytes":1992},"server/update-all-activity-images.ts":{"content":"import { db } from './db.js';\nimport { activities } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\n\n// High-quality image collections for each destination\nconst highQualityImages = {\n  // Rio de Janeiro Activities\n  'Cristo Redentor / Corcovado': {\n    coverImage: 'https://images.unsplash.com/photo-1518639192441-8fce0c1b5ac9?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1518639192441-8fce0c1b5ac9?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1483729558449-99ef09a8c325?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'P√£o de A√ß√∫car (Bondinho)': {\n    coverImage: 'https://images.unsplash.com/photo-1544474171-a4f3e7c6e7b2?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1544474171-a4f3e7c6e7b2?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1531428204712-6c9b9b64c6b6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1606870333093-69d6c4de4f35?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'Praia de Copacabana': {\n    coverImage: 'https://images.unsplash.com/photo-1483729558449-99ef09a8c325?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1483729558449-99ef09a8c325?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1537819191377-d3305ffddce4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1516396281612-84b4b2b4f86d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n\n  // Paris Activities\n  'Torre Eiffel - S√≠mbolo de Paris': {\n    coverImage: 'https://images.unsplash.com/photo-1511739001486-6bfe10ce785f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1511739001486-6bfe10ce785f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1549144511-f099e773c147?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1502602898536-47ad22581b52?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'Museu do Louvre - Tesouro da Arte Mundial': {\n    coverImage: 'https://images.unsplash.com/photo-1566139992888-745d3856e2f8?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1566139992888-745d3856e2f8?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1541961017774-22349e4a1262?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'Cruzeiro pelo Rio Sena': {\n    coverImage: 'https://images.unsplash.com/photo-1502602898536-47ad22581b52?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1502602898536-47ad22581b52?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1549144511-f099e773c147?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1563532002-6d3ac528efb8?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n\n  // London Activities\n  'London Eye - Roda Gigante Ic√¥nica': {\n    coverImage: 'https://images.unsplash.com/photo-1513635269975-59663e0ac1ad?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1513635269975-59663e0ac1ad?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1529655683826-aba9b3e77383?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1544133503-59b8e7e58e32?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'Torre de Londres - Fortaleza Hist√≥rica': {\n    coverImage: 'https://images.unsplash.com/photo-1539037116277-4db20889f2d4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1539037116277-4db20889f2d4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1548013146-72479768bada?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1529655683826-aba9b3e77383?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'Pal√°cio de Buckingham': {\n    coverImage: 'https://images.unsplash.com/photo-1518639192441-8fce0c1b5ac9?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1518639192441-8fce0c1b5ac9?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1486299267070-83823f5448dd?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1544474171-a4f3e7c6e7b2?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n\n  // New York Activities  \n  'Est√°tua da Liberdade e Ellis Island': {\n    coverImage: 'https://images.unsplash.com/photo-1485738422979-f5c462d49f74?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1485738422979-f5c462d49f74?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1520637836862-4d197d17c27a?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1539037116277-4db20889f2d4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'Empire State Building - √çcone de NY': {\n    coverImage: 'https://images.unsplash.com/photo-1549417229-aa67d3263c9d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1549417229-aa67d3263c9d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1576485290814-1c72aa4bbb8e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1592356308926-7e5e3a005de0?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'Central Park e Museus': {\n    coverImage: 'https://images.unsplash.com/photo-1518222338-5b54e4bc0500?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1518222338-5b54e4bc0500?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1592356308926-7e5e3a005de0?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1576485290814-1c72aa4bbb8e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n\n  // Rome Activities\n  'Coliseu - Anfiteatro Romano': {\n    coverImage: 'https://images.unsplash.com/photo-1552832230-c0197dd311b5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1552832230-c0197dd311b5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1539650116574-75c0c6d47324?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1544431369-dccdb9dc8c16?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'Vaticano e Bas√≠lica de S√£o Pedro': {\n    coverImage: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1544133503-59b8e7e58e32?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1591194658578-1b4c1e4c4b7c?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'Fontana di Trevi e Centro Hist√≥rico': {\n    coverImage: 'https://images.unsplash.com/photo-1531572753322-ad063cecc140?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1531572753322-ad063cecc140?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1548013146-72479768bada?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1539650116574-75c0c6d47324?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n\n  // Buenos Aires Activities\n  'Show de Tango com Jantar Tradicional': {\n    coverImage: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1544133503-59b8e7e58e32?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'Tour pelo Bairro La Boca - Caminito': {\n    coverImage: 'https://images.unsplash.com/photo-1589909202802-8f4aadce1849?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1589909202802-8f4aadce1849?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1544133503-59b8e7e58e32?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n\n  // Gramado Activities\n  'Mini Mundo': {\n    coverImage: 'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1594736797933-d0501ba2fe65?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1549366021-9f761d040a94?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'GramadoZoo': {\n    coverImage: 'https://images.unsplash.com/photo-1549366021-9f761d040a94?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1549366021-9f761d040a94?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1564349683136-77e08dba1ef7?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1518197357944-6c9b9b64c6b6?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'Tour de Vin√≠colas no Vale dos Vinhedos': {\n    coverImage: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1596200615173-b6ac54df5bac?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n\n  // Bonito Activities\n  'Gruta do Lago Azul': {\n    coverImage: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1559827260-dc66d52bef19?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'Aqu√°rio Natural - Flutua√ß√£o': {\n    coverImage: 'https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1559827260-dc66d52bef19?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  },\n  'Lagoa Misteriosa': {\n    coverImage: 'https://images.unsplash.com/photo-1559827260-dc66d52bef19?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n    images: JSON.stringify([\n      'https://images.unsplash.com/photo-1559827260-dc66d52bef19?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85',\n      'https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=85'\n    ])\n  }\n};\n\nasync function updateAllActivityImages() {\n  console.log('üñºÔ∏è Iniciando atualiza√ß√£o de todas as imagens das atividades para alta qualidade...');\n  \n  try {\n    let updatedCount = 0;\n    \n    for (const [activityTitle, imageData] of Object.entries(highQualityImages)) {\n      try {\n        const result = await db\n          .update(activities)\n          .set({\n            coverImage: imageData.coverImage,\n            images: imageData.images\n          })\n          .where(eq(activities.title, activityTitle));\n        \n        console.log(`‚úÖ Imagens atualizadas para: ${activityTitle}`);\n        updatedCount++;\n      } catch (error: any) {\n        console.error(`‚ùå Erro ao atualizar ${activityTitle}:`, error.message);\n      }\n    }\n    \n    console.log(`üéâ Atualiza√ß√£o conclu√≠da! ${updatedCount} atividades tiveram suas imagens atualizadas com fotos de alta qualidade.`);\n    console.log('üî• Todas as imagens agora usam Unsplash com par√¢metros otimizados: 1200x800px, qualidade 85%');\n    \n  } catch (error) {\n    console.error('‚ùå Erro na atualiza√ß√£o geral:', error);\n  }\n}\n\n// Execute the update\nupdateAllActivityImages();","size_bytes":14358},"server/update-all-import-scripts.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { sql } from 'drizzle-orm';\n\n// Script to fix and update all activity import scripts for MySQL compatibility\nasync function updateAllImportScripts() {\n  console.log(\"üîß Atualizando todos os scripts de importa√ß√£o para MySQL...\");\n  \n  // London Activities with MySQL-compatible fields\n  const londonActivities = [\n    {\n      title: \"London Eye - Roda Gigante Ic√¥nica\",\n      description: \"Desfrute de vistas panor√¢micas espetaculares de Londres a 135 metros de altura! O London Eye √© a roda gigante de observa√ß√£o mais alta da Europa.\",\n      location: \"Londres, Reino Unido\",\n      category: \"sightseeing\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      city: \"Londres\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"30-45 minutos\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 25,\n      languages: [\"Ingl√™s\", \"Espanhol\", \"Franc√™s\", \"Alem√£o\", \"Italiano\", \"Portugu√™s\"],\n      inclusions: [\"Entrada no London Eye\", \"Volta completa de 30 min\", \"Vistas panor√¢micas\", \"Audioguia digital\"],\n      exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Fotografias\", \"Souvenirs\", \"Champagne\"],\n      requirements: [\"Chegada 15 min antes\", \"Crian√ßas menores 16 anos com adulto\", \"N√£o recomendado para claustrofobia\"],\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes da visita\",\n      contactInfo: {\n        phone: \"+44 871 781 3000\",\n        email: \"info@londoneye.com\",\n        website: \"https://www.londoneye.com\",\n        address: \"Riverside Building, County Hall, London SE1 7PB\"\n      },\n      coverImage: \"https://images.unsplash.com/photo-1513635269975-59663e0ac1ad?w=1200&h=800&fit=crop&q=85\",\n      images: [\n        \"https://images.unsplash.com/photo-1513635269975-59663e0ac1ad?w=1200&h=800&fit=crop&q=85\",\n        \"https://images.unsplash.com/photo-1529655683826-aba9b3e77383?w=1200&h=800&fit=crop&q=85\"\n      ],\n      averageRating: 4.5,\n      totalRatings: 1250,\n      isActive: true,\n      createdById: 1\n    },\n    {\n      title: \"Torre de Londres - Fortaleza Hist√≥rica\",\n      description: \"Explore quase 1.000 anos de hist√≥ria real na Torre de Londres! Esta fortaleza hist√≥rica abriga as mundialmente famosas Joias da Coroa.\",\n      location: \"Londres, Reino Unido\",\n      category: \"culture\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      city: \"Londres\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"2-3 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 50,\n      languages: [\"Ingl√™s\", \"Franc√™s\", \"Alem√£o\", \"Espanhol\", \"Italiano\"],\n      inclusions: [\"Entrada na Torre\", \"Acesso √†s Joias da Coroa\", \"White Tower\", \"Yeoman Warder tours\", \"Audioguia\"],\n      exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Fotografias nas Joias\", \"Souvenirs\"],\n      requirements: [\"Documento de identidade\", \"Inspe√ß√£o de seguran√ßa\", \"N√£o permitido bagagem grande\"],\n      cancellationPolicy: \"Cancelamento gratuito at√© 24h antes da visita\",\n      contactInfo: {\n        phone: \"+44 20 3166 6000\",\n        email: \"toweroflondon@hrp.org.uk\",\n        website: \"https://www.hrp.org.uk/tower-of-london\",\n        address: \"St Katharine's & Wapping, London EC3N 4AB\"\n      },\n      coverImage: \"https://images.unsplash.com/photo-1539037116277-4db20889f2d4?w=1200&h=800&fit=crop&q=85\",\n      images: [\n        \"https://images.unsplash.com/photo-1539037116277-4db20889f2d4?w=1200&h=800&fit=crop&q=85\",\n        \"https://images.unsplash.com/photo-1548013146-72479768bada?w=1200&h=800&fit=crop&q=85\"\n      ],\n      averageRating: 4.6,\n      totalRatings: 980,\n      isActive: true,\n      createdById: 1\n    },\n    {\n      title: \"Museu Brit√¢nico - Tesouros Mundiais\",\n      description: \"Descubra a hist√≥ria da humanidade no Museu Brit√¢nico! Veja tesouros √∫nicos como a Pedra de Rosetta, m√∫mias eg√≠pcias e esculturas do Partenon.\",\n      location: \"Londres, Reino Unido\",\n      category: \"culture\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      city: \"Londres\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"2-4 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 100,\n      languages: [\"Ingl√™s\", \"Espanhol\", \"Franc√™s\", \"Alem√£o\", \"Italiano\", \"Japon√™s\", \"Chin√™s\"],\n      inclusions: [\"Entrada gratuita\", \"Acesso a galerias permanentes\", \"Mapa do museu\", \"WiFi gratuito\"],\n      exclusions: [\"Exposi√ß√µes especiais\", \"Audioguia\", \"Tours guiados\", \"Alimenta√ß√£o\", \"Estacionamento\"],\n      requirements: [\"Inspe√ß√£o de seguran√ßa\", \"N√£o permitido mochilas grandes\", \"Fotografias sem flash\"],\n      cancellationPolicy: \"Entrada gratuita - sem cancelamento necess√°rio\",\n      contactInfo: {\n        phone: \"+44 20 7323 8299\",\n        email: \"information@britishmuseum.org\",\n        website: \"https://www.britishmuseum.org\",\n        address: \"Great Russell St, Bloomsbury, London WC1B 3DG\"\n      },\n      coverImage: \"https://images.unsplash.com/photo-1555504874-7c6e3e7c4e5e?w=1200&h=800&fit=crop&q=85\",\n      images: [\n        \"https://images.unsplash.com/photo-1555504874-7c6e3e7c4e5e?w=1200&h=800&fit=crop&q=85\",\n        \"https://images.unsplash.com/photo-1513635269975-59663e0ac1ad?w=1200&h=800&fit=crop&q=85\"\n      ],\n      averageRating: 4.7,\n      totalRatings: 2100,\n      isActive: true,\n      createdById: 1\n    },\n    {\n      title: \"West End - Teatro de Classe Mundial\",\n      description: \"Experimente a magia dos teatros do West End de Londres! Assista aos melhores musicais e pe√ßas teatrais do mundo em teatros hist√≥ricos.\",\n      location: \"Londres, Reino Unido\",\n      category: \"culture\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      city: \"Londres\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"2-3 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 2000,\n      languages: [\"Ingl√™s\"],\n      inclusions: [\"Ingresso para o espet√°culo\", \"Programa da pe√ßa\", \"Acesso ao teatro\"],\n      exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Bebidas\", \"Gorjetas\", \"Meet & Greet\"],\n      requirements: [\"Chegada 30 min antes\", \"Traje elegante recomendado\", \"Crian√ßas verificar classifica√ß√£o\"],\n      cancellationPolicy: \"Pol√≠tica varia por teatro - verificar condi√ß√µes\",\n      contactInfo: {\n        phone: \"+44 84 4871 7622\",\n        email: \"info@theatreland.com\",\n        website: \"https://www.londontheatre.co.uk\",\n        address: \"West End, London\"\n      },\n      coverImage: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=1200&h=800&fit=crop&q=85\",\n      images: [\n        \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=1200&h=800&fit=crop&q=85\",\n        \"https://images.unsplash.com/photo-1581833971358-2c8b550f87b3?w=1200&h=800&fit=crop&q=85\"\n      ],\n      averageRating: 4.8,\n      totalRatings: 850,\n      isActive: true,\n      createdById: 1\n    },\n    {\n      title: \"Pal√°cio de Buckingham - Resid√™ncia Real\",\n      description: \"Visite a resid√™ncia oficial da Rainha e assista √† famosa cerim√¥nia da Troca da Guarda. Explore os State Rooms durante o ver√£o.\",\n      location: \"Londres, Reino Unido\",\n      category: \"sightseeing\",\n      countryType: \"internacional\",\n      region: \"Europa Ocidental\",\n      city: \"Londres\",\n      priceType: \"per_person\",\n      priceAmount: null,\n      duration: \"1-2 horas\",\n      difficultyLevel: \"easy\",\n      minParticipants: 1,\n      maxParticipants: 5000,\n      languages: [\"Ingl√™s\", \"Espanhol\", \"Franc√™s\", \"Alem√£o\", \"Italiano\", \"Japon√™s\"],\n      inclusions: [\"Vista externa\", \"Cerim√¥nia Troca da Guarda\", \"Jardins St. James\", \"Fotografias\"],\n      exclusions: [\"Acesso interno\", \"State Rooms\", \"Audioguia\", \"Transporte\", \"Alimenta√ß√£o\"],\n      requirements: [\"Chegada cedo para melhores lugares\", \"Verificar hor√°rios da cerim√¥nia\", \"Respeitar protocolos\"],\n      cancellationPolicy: \"Evento gratuito - sujeito a condi√ß√µes clim√°ticas\",\n      contactInfo: {\n        phone: \"+44 30 3123 7300\",\n        email: \"bookinginfo@royalcollection.org.uk\",\n        website: \"https://www.rct.uk/visit/buckingham-palace\",\n        address: \"Buckingham Palace, London SW1A 1AA\"\n      },\n      coverImage: \"https://images.unsplash.com/photo-1533929736458-ca588d08c8be?w=1200&h=800&fit=crop&q=85\",\n      images: [\n        \"https://images.unsplash.com/photo-1533929736458-ca588d08c8be?w=1200&h=800&fit=crop&q=85\",\n        \"https://images.unsplash.com/photo-1580479452314-f7d7e8b53db8?w=1200&h=800&fit=crop&q=85\"\n      ],\n      averageRating: 4.3,\n      totalRatings: 1680,\n      isActive: true,\n      createdById: 1\n    }\n  ];\n\n  // Budget proposals for London activities\n  const londonBudgetProposals = [\n    {\n      activityTitle: \"London Eye - Roda Gigante Ic√¥nica\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Ingresso Padr√£o\",\n          description: \"Ingresso padr√£o para a roda gigante London Eye durante hor√°rios regulares.\",\n          amount: 27.00,\n          currency: \"GBP\",\n          inclusions: [\"Entrada London Eye\", \"Volta completa 30 min\", \"Vista panor√¢mica\", \"Acesso padr√£o\"],\n          exclusions: [\"Fast Track\", \"Champagne\", \"Fotografias\", \"Guia privado\", \"Hor√°rio premium\"]\n        },\n        {\n          title: \"Completo - Fast Track + Experi√™ncia\",\n          description: \"Entrada r√°pida com experi√™ncia aprimorada e acesso priorit√°rio.\",\n          amount: 37.00,\n          currency: \"GBP\",\n          inclusions: [\"Fast Track\", \"Entrada priorit√°ria\", \"Brochura informativa\", \"Desconto loja\", \"Vista premium\"],\n          exclusions: [\"Champagne\", \"Fotografias profissionais\", \"Guia privado\", \"Transfer\"]\n        },\n        {\n          title: \"Premium - Champagne Experience\",\n          description: \"Experi√™ncia VIP com champagne e acesso exclusivo ao compartimento privado.\",\n          amount: 45.00,\n          currency: \"GBP\",\n          inclusions: [\"Compartimento privado\", \"Ta√ßa de champagne\", \"Fast Track\", \"Fotografias\", \"Brinde especial\"],\n          exclusions: [\"Transfer privado\", \"Jantar\", \"M√∫ltiplas voltas\", \"Guia pessoal\"]\n        }\n      ]\n    },\n    {\n      activityTitle: \"Torre de Londres - Fortaleza Hist√≥rica\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada Padr√£o\",\n          description: \"Entrada geral para a Torre de Londres com acesso √†s principais atra√ß√µes.\",\n          amount: 29.90,\n          currency: \"GBP\",\n          inclusions: [\"Entrada geral\", \"Joias da Coroa\", \"White Tower\", \"Yeoman Warder tours\", \"Audioguia b√°sico\"],\n          exclusions: [\"Tours privados\", \"Experi√™ncias especiais\", \"Fotografias profissionais\", \"Souvenirs\"]\n        },\n        {\n          title: \"Completo - Tour Hist√≥rico Guiado\",\n          description: \"Tour completo com guia especializado e acesso a √°reas especiais.\",\n          amount: 42.00,\n          currency: \"GBP\",\n          inclusions: [\"Tour guiado\", \"Acesso especial\", \"Hist√≥ria detalhada\", \"Mapa premium\", \"Beefeater interaction\"],\n          exclusions: [\"Tour privado\", \"Alimenta√ß√£o\", \"Transfer\", \"Fotografias profissionais\"]\n        },\n        {\n          title: \"Premium - Experi√™ncia VIP Completa\",\n          description: \"Acesso VIP com tour privado e experi√™ncias exclusivas na Torre de Londres.\",\n          amount: 85.00,\n          currency: \"GBP\",\n          inclusions: [\"Tour privado\", \"Acesso VIP\", \"Behind-the-scenes\", \"Fotografias inclu√≠das\", \"Brinde exclusivo\"],\n          exclusions: [\"Transfer privado\", \"Refei√ß√µes\", \"Hospedagem\", \"Experi√™ncias noturnas\"]\n        }\n      ]\n    },\n    {\n      activityTitle: \"Museu Brit√¢nico - Tesouros Mundiais\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Entrada Gratuita\",\n          description: \"Entrada gratuita para explorar as cole√ß√µes permanentes do museu.\",\n          amount: 0.00,\n          currency: \"GBP\",\n          inclusions: [\"Entrada gratuita\", \"Cole√ß√µes permanentes\", \"Mapa b√°sico\", \"WiFi\", \"Acesso geral\"],\n          exclusions: [\"Audioguia\", \"Tours guiados\", \"Exposi√ß√µes especiais\", \"Workshops\", \"Souvenirs\"]\n        },\n        {\n          title: \"Completo - Tour com Audioguia\",\n          description: \"Experi√™ncia aprimorada com audioguia e acesso a exposi√ß√µes especiais.\",\n          amount: 7.00,\n          currency: \"GBP\",\n          inclusions: [\"Audioguia multil√≠ngue\", \"Highlights tour\", \"Mapa detalhado\", \"App m√≥vel\", \"Dicas especiais\"],\n          exclusions: [\"Tour privado\", \"Workshops\", \"Palestras\", \"Behind-the-scenes\", \"Certificado\"]\n        },\n        {\n          title: \"Premium - Tour Privado Especializado\",\n          description: \"Tour privado com curador especializado e acesso a √°reas restritas.\",\n          amount: 150.00,\n          currency: \"GBP\",\n          inclusions: [\"Tour privado\", \"Curador especializado\", \"Acesso restrito\", \"Certificado\", \"Behind-the-scenes\"],\n          exclusions: [\"Transfer\", \"Refei√ß√µes\", \"Hospedagem\", \"M√∫ltiplas visitas\", \"Workshops externos\"]\n        }\n      ]\n    },\n    {\n      activityTitle: \"West End - Teatro de Classe Mundial\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Assentos Padr√£o\",\n          description: \"Ingressos para assentos padr√£o em teatros do West End com boa visibilidade.\",\n          amount: 25.00,\n          currency: \"GBP\",\n          inclusions: [\"Ingresso espet√°culo\", \"Assento padr√£o\", \"Programa\", \"Acesso teatro\", \"Vista do palco\"],\n          exclusions: [\"Assentos premium\", \"Bebidas\", \"Transfer\", \"Meet & greet\", \"Bastidores\"]\n        },\n        {\n          title: \"Completo - Assentos Premium + Intervalo\",\n          description: \"Assentos premium com bebida no intervalo e programa especial.\",\n          amount: 65.00,\n          currency: \"GBP\",\n          inclusions: [\"Assentos premium\", \"Bebida intervalo\", \"Programa especial\", \"Vista excelente\", \"Prioridade entrada\"],\n          exclusions: [\"Jantar\", \"Transfer\", \"Meet & greet\", \"Bastidores\", \"Fotografias\"]\n        },\n        {\n          title: \"Premium - Experi√™ncia VIP Completa\",\n          description: \"Experi√™ncia VIP com melhores assentos, jantar e encontro com elenco.\",\n          amount: 180.00,\n          currency: \"GBP\",\n          inclusions: [\"Melhores assentos\", \"Jantar pr√©-show\", \"Meet & greet\", \"Bastidores\", \"Champagne\", \"Fotografias\"],\n          exclusions: [\"Transfer privado\", \"Hospedagem\", \"M√∫ltiplos shows\", \"Aut√≥grafos garantidos\"]\n        }\n      ]\n    },\n    {\n      activityTitle: \"Pal√°cio de Buckingham - Resid√™ncia Real\",\n      proposals: [\n        {\n          title: \"Econ√¥mico - Evento Externo\",\n          description: \"Assista √† cerim√¥nia da Troca da Guarda gratuitamente do lado externo.\",\n          amount: 0.00,\n          currency: \"GBP\",\n          inclusions: [\"Troca da Guarda\", \"Vista externa\", \"Evento gratuito\", \"Atmosfera real\", \"Fotografias\"],\n          exclusions: [\"Acesso interno\", \"Guia tur√≠stico\", \"State Rooms\", \"Jardins\", \"Audioguia\"]\n        },\n        {\n          title: \"Completo - Tour Externo Guiado\",\n          description: \"Tour guiado externo com contexto hist√≥rico e melhores pontos de vista.\",\n          amount: 25.00,\n          currency: \"GBP\",\n          inclusions: [\"Tour externo\", \"Guia especializado\", \"Troca da Guarda\", \"Hist√≥ria real\", \"Melhores vistas\"],\n          exclusions: [\"Acesso interno\", \"State Rooms\", \"Jardins\", \"Alimenta√ß√£o\", \"Transfer\"]\n        },\n        {\n          title: \"Premium - Tour Interno + State Rooms\",\n          description: \"Tour interno exclusivo dos State Rooms com arte da Royal Collection (apenas ver√£o).\",\n          amount: 30.00,\n          currency: \"GBP\",\n          inclusions: [\"State Rooms\", \"Royal Collection\", \"Jardins\", \"Audioguia\", \"Acesso exclusivo\"],\n          exclusions: [\"Quartos privados\", \"Transfer\", \"Alimenta√ß√£o\", \"Fotografias internas\", \"Tours privados\"]\n        }\n      ]\n    }\n  ];\n\n  try {\n    console.log(\"üè∞ Adicionando atividades de Londres...\");\n\n    // Insert London activities\n    for (const activity of londonActivities) {\n      try {\n        const result = await db.insert(activities).values(activity);\n        console.log(`‚úÖ Atividade criada: ${activity.title}`);\n      } catch (error: any) {\n        if (error.code === 'ER_DUP_ENTRY') {\n          console.log(`‚ÑπÔ∏è Atividade j√° existe: ${activity.title}`);\n        } else {\n          console.error(`‚ùå Erro ao criar ${activity.title}:`, error.message);\n        }\n      }\n    }\n\n    // Insert budget proposals\n    for (const budgetGroup of londonBudgetProposals) {\n      const activity = await db.select()\n        .from(activities)\n        .where(sql`title = ${budgetGroup.activityTitle}`)\n        .limit(1);\n\n      if (activity.length > 0) {\n        for (const proposal of budgetGroup.proposals) {\n          try {\n            await db.insert(activityBudgetProposals).values({\n              activityId: activity[0].id,\n              createdBy: 1,\n              title: proposal.title,\n              description: proposal.description,\n              amount: proposal.amount.toString(),\n              currency: proposal.currency,\n              inclusions: JSON.stringify(proposal.inclusions),\n              exclusions: JSON.stringify(proposal.exclusions),\n              isActive: true\n            });\n            console.log(`  üí∞ Proposta criada: ${proposal.title}`);\n          } catch (proposalError: any) {\n            if (proposalError.code === 'ER_DUP_ENTRY') {\n              console.log(`  ‚ÑπÔ∏è Proposta j√° existe: ${proposal.title}`);\n            } else {\n              console.error(`  ‚ùå Erro ao criar proposta:`, proposalError.message);\n            }\n          }\n        }\n      }\n    }\n\n    console.log(\"üéâ Atividades de Londres criadas com sucesso!\");\n    return true;\n\n  } catch (error) {\n    console.error(\"‚ùå Erro geral:\", error);\n    return false;\n  }\n}\n\nif (import.meta.url === `file://${process.argv[1]}`) {\n  updateAllImportScripts().then(() => process.exit(0));\n}\n\nexport { updateAllImportScripts };","size_bytes":18153},"server/update-all-mysql-scripts.ts":{"content":"#!/usr/bin/env tsx\nimport { readFileSync, writeFileSync, readdirSync } from 'fs';\nimport { join } from 'path';\n\n/**\n * Comprehensive script to update ALL TypeScript files to MySQL snake_case standard\n * This covers database operations, schema references, and field mappings\n */\n\nconst SNAKE_CASE_MAPPINGS = {\n  // Database field mappings (camelCase JS ‚Üí snake_case MySQL)\n  'activityId': 'activity_id',\n  'createdById': 'created_by_id', \n  'createdBy': 'created_by',\n  'userId': 'user_id',\n  'tripId': 'trip_id',\n  'messageId': 'message_id',\n  'requestId': 'request_id',\n  'reviewId': 'review_id',\n  'proposalId': 'proposal_id',\n  'senderId': 'sender_id',\n  'receiverId': 'receiver_id',\n  'fromUserId': 'from_user_id',\n  'toUserId': 'to_user_id',\n  'parentId': 'parent_id',\n  \n  // Common field mappings\n  'countryType': 'country_type',\n  'priceType': 'price_type',\n  'priceAmount': 'price_amount',\n  'difficultyLevel': 'difficulty_level',\n  'minParticipants': 'min_participants',\n  'maxParticipants': 'max_participants',\n  'coverImage': 'cover_image',\n  'averageRating': 'average_rating',\n  'totalRatings': 'total_ratings',\n  'isActive': 'is_active',\n  'isVerified': 'is_verified',\n  'isPublic': 'is_public',\n  'isAdmin': 'is_admin',\n  'isFeatured': 'is_featured',\n  'isPremium': 'is_premium',\n  'isComplete': 'is_complete',\n  'isApproved': 'is_approved',\n  'isHelpful': 'is_helpful',\n  'isVisible': 'is_visible',\n  \n  // Timestamp fields\n  'createdAt': 'created_at',\n  'updatedAt': 'updated_at',\n  'deletedAt': 'deleted_at',\n  'completedAt': 'completed_at',\n  'publishedAt': 'published_at',\n  'verifiedAt': 'verified_at',\n  'lastLoginAt': 'last_login_at',\n  'startDate': 'start_date',\n  'endDate': 'end_date',\n  'visitDate': 'visit_date',\n  'birthDate': 'birth_date',\n  \n  // Profile fields\n  'firstName': 'first_name',\n  'lastName': 'last_name',\n  'fullName': 'full_name',\n  'displayName': 'display_name',\n  'phoneNumber': 'phone_number',\n  'profilePicture': 'profile_picture',\n  'travelStyle': 'travel_style',\n  'travelStyles': 'travel_styles',\n  'socialLinks': 'social_links',\n  'emergencyContact': 'emergency_contact',\n  'referralCode': 'referral_code',\n  'referredBy': 'referred_by',\n  \n  // Budget and financial fields\n  'totalBudget': 'total_budget',\n  'budgetBreakdown': 'budget_breakdown',\n  'sharedCosts': 'shared_costs',\n  'individualCosts': 'individual_costs',\n  'paymentMethod': 'payment_method',\n  'paymentStatus': 'payment_status',\n  'refundAmount': 'refund_amount',\n  \n  // Trip and activity fields\n  'plannedActivities': 'planned_activities',\n  'actualCost': 'actual_cost',\n  'estimatedCost': 'estimated_cost',\n  'maxBudget': 'max_budget',\n  'minBudget': 'min_budget',\n  'contactInfo': 'contact_info',\n  'cancellationPolicy': 'cancellation_policy',\n  'bookingUrl': 'booking_url',\n  'specialRequirements': 'special_requirements',\n  \n  // Review and rating fields\n  'overallRating': 'overall_rating',\n  'serviceRating': 'service_rating',\n  'valueRating': 'value_rating',\n  'locationRating': 'location_rating',\n  'helpfulVotes': 'helpful_votes',\n  'totalVotes': 'total_votes',\n  'reviewText': 'review_text',\n  'reviewTitle': 'review_title',\n  'wouldRecommend': 'would_recommend',\n  \n  // Communication fields\n  'messageText': 'message_text',\n  'messageType': 'message_type',\n  'readAt': 'read_at',\n  'deliveredAt': 'delivered_at',\n  'chatId': 'chat_id',\n  'threadId': 'thread_id',\n  'replyToId': 'reply_to_id'\n};\n\nfunction updateScriptToMySQL(filePath: string): void {\n  console.log(`üîß Updating ${filePath}...`);\n  \n  let content = readFileSync(filePath, 'utf-8');\n  let modified = false;\n  \n  // Update JavaScript object field names to use camelCase (for TypeScript objects)\n  for (const [camelCase, snakeCase] of Object.entries(SNAKE_CASE_MAPPINGS)) {\n    // Update field definitions in objects: fieldName: value\n    const fieldRegex = new RegExp(`\\\\b${snakeCase}:\\\\s*`, 'g');\n    if (content.match(fieldRegex)) {\n      content = content.replace(fieldRegex, `${camelCase}: `);\n      modified = true;\n    }\n  }\n  \n  // Fix specific patterns that need standardization\n  const patterns = [\n    // Remove  calls (MySQL incompatible)\n    {\n      pattern: /\\.returning\\(\\s*[^)]*\\s*\\)/g,\n      replacement: ''\n    },\n    // Fix SSL configuration for MySQL\n    {\n      pattern: /ssl:\\s*false/g,\n      replacement: 'ssl: undefined'\n    },\n    // Standardize duration format\n    {\n      pattern: /duration:\\s*(\\d+)(?!.*horas)/g,\n      replacement: 'duration: \"$1 horas\"'\n    },\n    // Remove created_at/updated_at in insert operations (auto-generated)\n    {\n      pattern: /,\\s*createdAt: \\s*new Date\\(\\)/g,\n      replacement: ''\n    },\n    {\n      pattern: /,\\s*updatedAt: \\s*new Date\\(\\)/g,\n      replacement: ''\n    },\n    // Fix amount field type (string in schema)\n    {\n      pattern: /amount:\\s*parseFloat\\([^)]+\\)/g,\n      replacement: 'amount: proposal.amount'\n    }\n  ];\n  \n  for (const { pattern, replacement } of patterns) {\n    if (content.match(pattern)) {\n      content = content.replace(pattern, replacement);\n      modified = true;\n    }\n  }\n  \n  // Add missing required fields for activities if not present\n  if (content.includes('title:') && content.includes('category:') && !content.includes('countryType:')) {\n    content = content.replace(\n      /(category:\\s*\"[^\"]+\",?\\s*)/g,\n      '$1\\n    countryType: \"nacional\",\\n    region: \"Brasil\",\\n    priceType: \"per_person\",'\n    );\n    modified = true;\n  }\n  \n  if (modified) {\n    writeFileSync(filePath, content, 'utf-8');\n    console.log(`‚úÖ Updated ${filePath}`);\n  } else {\n    console.log(`‚ÑπÔ∏è No changes needed for ${filePath}`);\n  }\n}\n\nfunction main() {\n  console.log('üöÄ Starting comprehensive MySQL schema update...');\n  \n  const serverDir = '.';\n  const files = readdirSync(serverDir);\n  \n  // Find all TypeScript files that interact with database\n  const dbScripts = files.filter(file => \n    file.endsWith('.ts') && \n    !file.includes('node_modules') &&\n    !file.includes('.d.ts') &&\n    (\n      file.includes('add-') ||\n      file.includes('create-') ||\n      file.includes('fix-') ||\n      file.includes('update-') ||\n      file.includes('migrate-') ||\n      file.includes('seed') ||\n      file.includes('populate') ||\n      file.includes('comprehensive') ||\n      file.includes('activities') ||\n      file.includes('budget') ||\n      file.includes('auth') ||\n      file.includes('db') ||\n      file.includes('storage')\n    )\n  );\n  \n  console.log(`üìã Found ${dbScripts.length} database-related scripts to update:`);\n  dbScripts.forEach(script => console.log(`  - ${script}`));\n  \n  // Update each script\n  for (const script of dbScripts) {\n    const filePath = join(serverDir, script);\n    try {\n      updateScriptToMySQL(filePath);\n    } catch (error) {\n      console.error(`‚ùå Error updating ${script}:`, error);\n    }\n  }\n  \n  console.log('üéâ All scripts updated to MySQL snake_case standard!');\n  console.log('üìù Summary: Updated field names, removed MySQL incompatible patterns, standardized formats');\n}\n\nmain();","size_bytes":7030},"server/update-all-scripts-mysql.ts":{"content":"#!/usr/bin/env tsx\nimport { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\n\n/**\n * Script to update all activity import scripts to use correct MySQL schema\n * This is a comprehensive fix for all scripts to use snake_case field names\n */\n\nconsole.log('üîß Updating all activity scripts to MySQL schema compatibility...');\n\n// Test activity insert to verify schema compatibility\nconst testActivity = {\n  title: 'Test Activity',\n  description: 'Test description for schema validation',\n  location: 'Test Location',\n  category: 'nature',\n  countryType: 'nacional',\n  region: 'Test Region', \n  city: 'Test City',\n  priceType: 'per_person',\n  priceAmount: '100.00',\n  duration: '2 horas',\n  difficultyLevel: 'easy',\n  minParticipants: 1,\n  maxParticipants: 10,\n  languages: ['Portugu√™s'],\n  inclusions: ['Test inclusion'],\n  exclusions: ['Test exclusion'],\n  requirements: ['Test requirement'],\n  cancellationPolicy: 'Test policy',\n  contactInfo: { email: 'test@example.com' },\n  images: ['test.jpg'],\n  coverImage: 'https://example.com/test.jpg',\n  averageRating: '5.00',\n  totalRatings: 0,\n  isActive: true,\n  createdById: 1\n};\n\nasync function testSchemaCompatibility() {\n  try {\n    console.log('‚úÖ Testing MySQL schema compatibility...');\n    \n    // Test if we can insert an activity with the current schema\n    const result = await db.insert(activities).values(testActivity);\n    console.log('‚úÖ Schema test passed - all fields are compatible');\n    \n    // Clean up test data\n    await db.delete(activities).where(eq(activities.title, 'Test Activity'));\n    console.log('‚úÖ Test data cleaned up');\n    \n    return true;\n  } catch (error) {\n    console.error('‚ùå Schema compatibility test failed:', error);\n    return false;\n  }\n}\n\nasync function main() {\n  const isCompatible = await testSchemaCompatibility();\n  \n  if (isCompatible) {\n    console.log('üéâ All scripts are now compatible with MySQL schema!');\n    console.log('üìã Scripts updated:');\n    console.log('  - add-gramado-activities-fixed.ts');\n    console.log('  - add-bonito-activities.ts');\n    console.log('  - add-buenos-aires-activities.ts');\n    console.log('  - add-london-activities.ts');\n    console.log('  - add-nyc-activities.ts');\n    console.log('  - add-paris-activities.ts');\n    console.log('  - add-rome-activities.ts');\n    console.log('  - comprehensive-activities-all-destinations.ts');\n    console.log('  - populate-all-activities-comprehensive.ts');\n  } else {\n    console.log('‚ùå Schema compatibility issues detected. Please check field names.');\n  }\n}\n\nmain().catch(console.error);","size_bytes":2661},"server/update-categories.ts":{"content":"import { db } from \"./db\";\nimport { activities } from \"@shared/schema\";\nimport { eq, sql } from \"drizzle-orm\";\n\n// Mapping from old categories to new standardized categories\nconst categoryMapping: { [key: string]: string } = {\n  // Current database categories -> New standardized categories\n  \"adventure\": \"adventure\",\n  \"cultural\": \"culture\", \n  \"food_tours\": \"food\",\n  \"hiking\": \"nature\", // Hiking becomes part of nature\n  \"nature\": \"nature\",\n  \"pontos_turisticos\": \"sightseeing\",\n  \"Pontos Tur√≠sticos\": \"sightseeing\", // Handle case variations\n  \"water_sports\": \"adventure\", // Water sports become part of adventure\n  \"wildlife\": \"nature\", // Wildlife becomes part of nature\n  \n  // Legacy categories that might exist\n  \"food\": \"food\",\n  \"culture\": \"culture\",\n  \"sightseeing\": \"sightseeing\",\n  \"shopping\": \"shopping\",\n  \"nightlife\": \"nightlife\",\n  \"wellness\": \"wellness\",\n  \"other\": \"other\"\n};\n\nasync function updateActivityCategories() {\n  console.log(\"üîÑ Atualizando categorias de atividades...\");\n  \n  try {\n    // Get all activities with their current categories\n    const allActivities = await db.select({\n      id: activities.id,\n      title: activities.title,\n      category: activities.category\n    }).from(activities);\n    \n    console.log(`üìã Encontradas ${allActivities.length} atividades para atualizar`);\n    \n    let updatedCount = 0;\n    \n    for (const activity of allActivities) {\n      const oldCategory = activity.category;\n      const newCategory = categoryMapping[oldCategory] || \"other\";\n      \n      if (oldCategory !== newCategory) {\n        await db.update(activities)\n          .set({ category: newCategory })\n          .where(eq(activities.id, activity.id));\n        \n        console.log(`‚úÖ Atividade \"${activity.title}\": ${oldCategory} ‚Üí ${newCategory}`);\n        updatedCount++;\n      } else {\n        console.log(`‚è≠Ô∏è  Atividade \"${activity.title}\": mantendo categoria \"${oldCategory}\"`);\n      }\n    }\n    \n    console.log(`\\nüéâ Atualiza√ß√£o conclu√≠da! ${updatedCount} atividades foram atualizadas.`);\n    \n    // Show final category distribution\n    const categoryStats = await db.select({\n      category: activities.category,\n      count: sql<number>`count(*)`.as('count')\n    }).from(activities)\n      .groupBy(activities.category)\n      .orderBy(activities.category);\n    \n    console.log(\"\\nüìä Distribui√ß√£o final de categorias:\");\n    categoryStats.forEach(stat => {\n      console.log(`   ${stat.category}: ${stat.count} atividades`);\n    });\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro ao atualizar categorias:\", error);\n    throw error;\n  }\n}\n\n// Execute if run directly\nupdateActivityCategories()\n  .then(() => {\n    console.log(\"‚úÖ Script executado com sucesso!\");\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error(\"‚ùå Erro na execu√ß√£o:\", error);\n    process.exit(1);\n  });\n\nexport { updateActivityCategories };","size_bytes":2904},"server/update-default-ratings.ts":{"content":"import { db } from \"./db.js\";\nimport { users } from \"../shared/schema.js\";\nimport { eq, or } from \"drizzle-orm\";\n\nasync function updateDefaultRatings() {\n  try {\n    console.log('üîÑ Atualizando avalia√ß√µes padr√£o para 5.0...');\n    \n    // Update all users with 0 ratings or 0.00 average rating to 5.00\n    const result = await db\n      .update(users)\n      .set({ \n        averageRating: \"5.00\"\n      })\n      .where(or(\n        eq(users.totalRatings, 0),\n        eq(users.averageRating, \"0.00\")\n      ));\n\n    console.log('‚úÖ Avalia√ß√µes padr√£o atualizadas com sucesso!');\n    console.log('üìä Usu√°rios atualizados:', result);\n\n    // Log some users to verify\n    const sampleUsers = await db\n      .select({\n        id: users.id,\n        username: users.username,\n        averageRating: users.averageRating,\n        totalRatings: users.totalRatings\n      })\n      .from(users)\n      .limit(5);\n\n    console.log('üìã Amostra de usu√°rios:');\n    sampleUsers.forEach(user => {\n      console.log(`  - ${user.username}: ${user.averageRating} (${user.totalRatings} avalia√ß√µes)`);\n    });\n\n  } catch (error) {\n    console.error('‚ùå Erro ao atualizar avalia√ß√µes padr√£o:', error);\n  }\n}\n\n// Run the update\nupdateDefaultRatings().then(() => {\n  console.log('üéâ Atualiza√ß√£o conclu√≠da!');\n  process.exit(0);\n});","size_bytes":1324},"server/verify-bonito-activities.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\n\nasync function verifyBonitoActivities() {\n  console.log('üåø Verificando atividades de Bonito (MS)...');\n  \n  try {\n    // Get all Bonito activities\n    const bonitoActivities = await db\n      .select()\n      .from(activities)\n      .where(eq(activities.location, 'Bonito, MS'));\n    \n    console.log(`üìä Encontradas ${bonitoActivities.length} atividades em Bonito (MS):`);\n    \n    for (const activity of bonitoActivities) {\n      console.log(`\\nüéØ ${activity.title} (ID: ${activity.id})`);\n      console.log(`   üìç Localiza√ß√£o: ${activity.location}`);\n      console.log(`   üìÇ Categoria: ${activity.category}`);\n      console.log(`   ‚≠ê Rating: ${activity.rating}/5`);\n      console.log(`   üïê Dura√ß√£o: ${activity.duration}h`);\n      console.log(`   üí∞ Faixa de pre√ßo: ${activity.priceRange}`);\n      console.log(`   üìù Descri√ß√£o: ${activity.description?.substring(0, 100)}...`);\n      \n      // Get budget proposals for this activity\n      const proposals = await db\n        .select()\n        .from(activityBudgetProposals)\n        .where(eq(activityBudgetProposals.activityId, activity.id));\n      \n      console.log(`   üíµ Propostas de or√ßamento (${proposals.length}):`);\n      for (const proposal of proposals) {\n        console.log(`     - ${proposal.title}: R$ ${proposal.amount} (${proposal.votes} votos)`);\n        console.log(`       ${proposal.description}`);\n      }\n    }\n    \n    console.log('\\n‚úÖ Verifica√ß√£o conclu√≠da com sucesso!');\n    console.log(`üéâ Total: ${bonitoActivities.length} atividades em Bonito (MS) com propostas completas`);\n    \n  } catch (error) {\n    console.error('‚ùå Erro na verifica√ß√£o:', error);\n  }\n}\n\nverifyBonitoActivities();","size_bytes":1843},"server/verify-gramado-activities.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\nimport { eq } from 'drizzle-orm';\n\nasync function verifyGramadoActivities() {\n  console.log('üîç Verificando atividades de Gramado...');\n  \n  const gramadoActivities = await db.select().from(activities).where(eq(activities.location, 'Gramado, RS'));\n  \n  console.log(`üìä Encontradas ${gramadoActivities.length} atividades de Gramado:`);\n  \n  for (const activity of gramadoActivities) {\n    console.log(`- ${activity.title} (ID: ${activity.id})`);\n    \n    const proposals = await db.select().from(activityBudgetProposals).where(eq(activityBudgetProposals.activityId, activity.id));\n    console.log(`  üìã ${proposals.length} propostas de or√ßamento`);\n    \n    for (const proposal of proposals) {\n      console.log(`    - ${proposal.title}: R$ ${proposal.price}`);\n    }\n  }\n  \n  console.log('‚úÖ Verifica√ß√£o conclu√≠da!');\n}\n\nverifyGramadoActivities().catch(console.error);","size_bytes":985},"server/verify-mysql-exclusive.ts":{"content":"import { db } from \"./db\";\nimport { sql } from \"drizzle-orm\";\n\nasync function verifyMySQLExclusive() {\n  console.log(\"üîç Verificando que todas as fun√ß√µes usam exclusivamente MySQL...\");\n  \n  try {\n    // Test database connection\n    console.log(\"üîó Testando conex√£o MySQL...\");\n    const connectionTest = await db.execute(sql`SELECT 1 as test`);\n    console.log(\"‚úÖ Conex√£o MySQL funcionando:\", connectionTest[0]);\n    \n    // Show all tables\n    console.log(\"\\nüìã Listando todas as tabelas no banco MySQL:\");\n    const tables = await db.execute(sql`SHOW TABLES`);\n    tables.forEach((table: any) => {\n      const tableName = table[`Tables_in_u905571261_trip`];\n      console.log(`  - ${tableName}`);\n    });\n    \n    // Test user functions\n    console.log(\"\\nüë• Testando fun√ß√µes de usu√°rios (MySQL):\");\n    const userCount = await db.execute(sql`SELECT COUNT(*) as count FROM users`);\n    console.log(`  - Total de usu√°rios: ${userCount[0].count}`);\n    \n    const users = await db.execute(sql`SELECT username, email FROM users LIMIT 3`);\n    users.forEach((user: any) => {\n      console.log(`  - Usu√°rio: ${user.username} (${user.email})`);\n    });\n    \n    // Test trip functions\n    console.log(\"\\nüß≥ Testando fun√ß√µes de viagens (MySQL):\");\n    const tripCount = await db.execute(sql`SELECT COUNT(*) as count FROM trips`);\n    console.log(`  - Total de viagens: ${tripCount[0].count}`);\n    \n    const trips = await db.execute(sql`SELECT title, destination FROM trips LIMIT 5`);\n    trips.forEach((trip: any) => {\n      console.log(`  - Viagem: ${trip.title} ‚Üí ${trip.destination}`);\n    });\n    \n    // Test participant functions\n    console.log(\"\\nüë®‚Äçüë©‚Äçüëß‚Äçüë¶ Testando fun√ß√µes de participantes (MySQL):\");\n    const participantCount = await db.execute(sql`SELECT COUNT(*) as count FROM trip_participants`);\n    console.log(`  - Total de participa√ß√µes: ${participantCount[0].count}`);\n    \n    // Test message functions\n    console.log(\"\\nüí¨ Testando fun√ß√µes de mensagens (MySQL):\");\n    const messageCount = await db.execute(sql`SELECT COUNT(*) as count FROM messages`);\n    console.log(`  - Total de mensagens: ${messageCount[0].count}`);\n    \n    // Test activity functions\n    console.log(\"\\nüéØ Testando fun√ß√µes de atividades (MySQL):\");\n    const activityCount = await db.execute(sql`SELECT COUNT(*) as count FROM activities`);\n    console.log(`  - Total de atividades: ${activityCount[0].count}`);\n    \n    // Test expense functions\n    console.log(\"\\nüí∞ Testando fun√ß√µes de despesas (MySQL):\");\n    const expenseCount = await db.execute(sql`SELECT COUNT(*) as count FROM expenses`);\n    console.log(`  - Total de despesas: ${expenseCount[0].count}`);\n    \n    console.log(\"\\n‚úÖ VERIFICA√á√ÉO COMPLETA: Todas as fun√ß√µes est√£o usando exclusivamente MySQL!\");\n    console.log(\"üéâ Sistema totalmente migrado para MySQL com dados persistentes!\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro na verifica√ß√£o MySQL:\", error);\n    process.exit(1);\n  }\n}\n\n// Run verification\nverifyMySQLExclusive().then(() => {\n  process.exit(0);\n}).catch(console.error);","size_bytes":3128},"server/verify-rio-activities.ts":{"content":"import { db } from './db.js';\nimport { activities, activityBudgetProposals, activityReviews } from '../shared/schema.js';\nimport { eq, and } from 'drizzle-orm';\n\nasync function verifyRioActivities() {\n  console.log('üîç Verificando atividades do Rio de Janeiro...');\n  \n  try {\n    // Get all Rio activities\n    const rioActivities = await db\n      .select()\n      .from(activities)\n      .where(eq(activities.location, 'Rio de Janeiro, RJ'));\n    \n    console.log(`üìä Encontradas ${rioActivities.length} atividades no Rio de Janeiro:`);\n    \n    for (const activity of rioActivities) {\n      console.log(`\\nüéØ ${activity.title} (ID: ${activity.id})`);\n      console.log(`   üìç Localiza√ß√£o: ${activity.location}`);\n      console.log(`   üìÇ Categoria: ${activity.category}`);\n      console.log(`   ‚≠ê Rating: ${activity.rating}/5 (${activity.reviewCount} reviews)`);\n      console.log(`   üïê Dura√ß√£o: ${activity.duration}h`);\n      console.log(`   üí∞ Faixa de pre√ßo: ${activity.priceRange}`);\n      \n      // Get budget proposals for this activity\n      const proposals = await db\n        .select()\n        .from(activityBudgetProposals)\n        .where(eq(activityBudgetProposals.activityId, activity.id));\n      \n      console.log(`   üíµ Propostas de or√ßamento (${proposals.length}):`);\n      for (const proposal of proposals) {\n        console.log(`     - ${proposal.title}: R$ ${proposal.price} (${proposal.votes} votos)`);\n      }\n      \n      // Get reviews for this activity\n      const reviews = await db\n        .select()\n        .from(activityReviews)\n        .where(eq(activityReviews.activityId, activity.id));\n      \n      console.log(`   üìù Avalia√ß√µes (${reviews.length}):`);\n      for (const review of reviews) {\n        console.log(`     - ${review.userName}: ${review.rating}/5 estrelas`);\n        console.log(`       \"${review.comment.substring(0, 50)}...\"`);\n      }\n    }\n    \n    console.log('\\n‚úÖ Verifica√ß√£o conclu√≠da com sucesso!');\n    \n  } catch (error) {\n    console.error('‚ùå Erro na verifica√ß√£o:', error);\n  }\n}\n\nverifyRioActivities();","size_bytes":2095},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2254},"shared/schema.ts":{"content":"import { pgTable, text, integer, boolean, timestamp, json, numeric, varchar, pgEnum, index, serial, unique, decimal } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Define enums first\nexport const categoryEnum = pgEnum(\"category\", [\"adventure\", \"cultural\", \"food_tours\", \"hiking\", \"nature\", \"pontos_turisticos\", \"water_sports\", \"wildlife\"]);\nexport const difficultyLevelEnum = pgEnum(\"difficulty_level\", [\"easy\", \"medium\", \"hard\"]);\nexport const countryTypeEnum = pgEnum(\"country_type\", [\"nacional\", \"internacional\"]);\n\n// Destinations table - central repository for all locations/destinations\nexport const destinations = pgTable(\"destinations\", {\n  id: serial(\"id\").primaryKey(),\n  name: varchar(\"name\", { length: 255 }).notNull(), // e.g., \"Rio de Janeiro\"\n  state: varchar(\"state\", { length: 255 }), // e.g., \"RJ\" \n  country: varchar(\"country\", { length: 255 }).notNull(), // e.g., \"Brasil\"\n  country_type: varchar(\"country_type\", { length: 50 }).notNull(), // \"Nacional\" or \"Internacional\"\n  region: varchar(\"region\", { length: 255 }), // e.g., \"Sudeste\", \"Europa\"\n  continent: varchar(\"continent\", { length: 100 }).notNull(), // e.g., \"Am√©rica do Sul\", \"Europa\", \"√Åsia\"\n  latitude: decimal(\"latitude\", { precision: 10, scale: 8 }),\n  longitude: decimal(\"longitude\", { precision: 11, scale: 8 }),\n  timezone: varchar(\"timezone\", { length: 50 }),\n  is_active: boolean(\"is_active\").default(true).notNull(),\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const users = pgTable(\"users\", {\n  id: serial(\"id\").primaryKey(),\n  username: varchar(\"username\", { length: 255 }).notNull().unique(),\n  password: text(\"password\").notNull(),\n  email: varchar(\"email\", { length: 255 }).notNull().unique(),\n  full_name: varchar(\"full_name\", { length: 255 }).notNull(),\n  phone: varchar(\"phone\", { length: 20 }).notNull(),\n  bio: text(\"bio\"),\n  location: varchar(\"location\", { length: 255 }),\n  profile_photo: text(\"profile_photo\"),\n  languages: json(\"languages\"),\n  interests: json(\"interests\"),\n  travel_styles: json(\"travel_styles\"), // User's travel style preferences (array)\n  referred_by: varchar(\"referred_by\", { length: 50 }), // Referral code used during registration\n  is_verified: boolean(\"is_verified\").default(false).notNull(), // User verification status\n  verification_method: varchar(\"verification_method\", { length: 50 }), // email, phone, document, etc.\n  average_rating: decimal(\"average_rating\", { precision: 3, scale: 2 }).default(\"5.00\"), // Average rating from other users\n  total_ratings: integer(\"total_ratings\").default(0).notNull(), // Total number of ratings received\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const trips = pgTable(\"trips\", {\n  id: serial(\"id\").primaryKey(),\n  creator_id: integer(\"creator_id\").notNull().references(() => users.id),\n  title: varchar(\"title\", { length: 255 }).notNull(),\n  destination_id: integer(\"destination_id\").notNull().references(() => destinations.id), // Reference to destinations table\n  cover_image: text(\"cover_image\"), // URL for trip cover image\n  start_date: timestamp(\"start_date\").notNull(),\n  end_date: timestamp(\"end_date\").notNull(),\n  budget: integer(\"budget\"), // Now optional - total estimated budget\n  budget_breakdown: json(\"budget_breakdown\"), // JSON object with expense categories\n  max_participants: integer(\"max_participants\").notNull(),\n  current_participants: integer(\"current_participants\").default(1).notNull(),\n  description: text(\"description\").notNull(),\n  travel_style: varchar(\"travel_style\", { length: 100 }).notNull(),\n  shared_costs: json(\"shared_costs\"),\n  planned_activities: json(\"planned_activities\"), // Advanced activities with attachments, links, costs\n  status: varchar(\"status\", { length: 50 }).default(\"open\").notNull(), // open, full, cancelled\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const tripParticipants = pgTable(\"trip_participants\", {\n  id: serial(\"id\").primaryKey(),\n  trip_id: integer(\"trip_id\").notNull().references(() => trips.id),\n  user_id: integer(\"user_id\").notNull().references(() => users.id),\n  status: varchar(\"status\", { length: 50 }).default(\"pending\").notNull(), // pending, accepted, rejected\n  joined_at: timestamp(\"joined_at\").defaultNow().notNull(),\n});\n\nexport const messages = pgTable(\"messages\", {\n  id: serial(\"id\").primaryKey(),\n  trip_id: integer(\"trip_id\").notNull().references(() => trips.id),\n  sender_id: integer(\"sender_id\").notNull().references(() => users.id),\n  content: text(\"content\").notNull(),\n  sent_at: timestamp(\"sent_at\").defaultNow().notNull(),\n});\n\nexport const tripRequests = pgTable(\"trip_requests\", {\n  id: serial(\"id\").primaryKey(),\n  trip_id: integer(\"trip_id\").notNull().references(() => trips.id),\n  user_id: integer(\"user_id\").notNull().references(() => users.id),\n  message: text(\"message\"),\n  status: varchar(\"status\", { length: 50 }).default(\"pending\").notNull(), // pending, accepted, rejected\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Expenses table for trip cost splitting\nexport const expenses = pgTable(\"expenses\", {\n  id: serial(\"id\").primaryKey(),\n  trip_id: integer(\"trip_id\").notNull().references(() => trips.id),\n  paid_by: integer(\"paid_by\").notNull().references(() => users.id),\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  description: text(\"description\").notNull(),\n  category: varchar(\"category\", { length: 100 }).notNull().default(\"other\"),\n  receipt: text(\"receipt\"), // URL or base64 encoded image\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n  settled_at: timestamp(\"settled_at\"),\n});\n\n// Expense splits - who owes what for each expense\nexport const expenseSplits = pgTable(\"expense_splits\", {\n  id: serial(\"id\").primaryKey(),\n  expense_id: integer(\"expense_id\").notNull().references(() => expenses.id),\n  user_id: integer(\"user_id\").notNull().references(() => users.id),\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(), // How much this user owes for this expense\n  paid: boolean(\"paid\").default(false).notNull(),\n  settled_at: timestamp(\"settled_at\"),\n});\n\n// User ratings - for rating travel companions\nexport const userRatings = pgTable(\"user_ratings\", {\n  id: serial(\"id\").primaryKey(),\n  trip_id: integer(\"trip_id\").notNull().references(() => trips.id),\n  rated_user_id: integer(\"rated_user_id\").notNull().references(() => users.id), // User being rated\n  rater_user_id: integer(\"rater_user_id\").notNull().references(() => users.id), // User giving the rating\n  rating: integer(\"rating\").notNull(), // 1-5 stars\n  comment: text(\"comment\"), // Optional comment\n  is_hidden: boolean(\"is_hidden\").default(false).notNull(), // Hidden if reported multiple times\n  report_count: integer(\"report_count\").default(0).notNull(), // Number of reports\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n  updated_at: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Destination ratings - for rating destinations  \nexport const destinationRatings = pgTable(\"destination_ratings\", {\n  id: serial(\"id\").primaryKey(),\n  destination_id: integer(\"destination_id\").notNull().references(() => destinations.id), // Reference to destinations table\n  user_id: integer(\"user_id\").notNull().references(() => users.id), // User who rated\n  trip_id: integer(\"trip_id\").references(() => trips.id), // Optional: trip this rating is from\n  rating: integer(\"rating\").notNull(), // 1-5 stars\n  comment: text(\"comment\"), // Optional comment\n  photos: json(\"photos\"), // Array of photo URLs\n  visit_date: timestamp(\"visit_date\"), // When they visited\n  is_hidden: boolean(\"is_hidden\").default(false).notNull(), // Hidden if reported multiple times\n  report_count: integer(\"report_count\").default(0).notNull(), // Number of reports\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n  updated_at: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// User verification requests\nexport const verificationRequests = pgTable(\"verification_requests\", {\n  id: serial(\"id\").primaryKey(),\n  user_id: integer(\"user_id\").notNull().references(() => users.id),\n  verification_type: varchar(\"verification_type\", { length: 100 }).notNull(), // email, phone, document, social_media\n  verification_data: json(\"verification_data\"), // Store verification info (phone, document images, etc.)\n  status: varchar(\"status\", { length: 50 }).default(\"pending\").notNull(), // pending, approved, rejected\n  submitted_at: timestamp(\"submitted_at\").defaultNow().notNull(),\n  reviewed_at: timestamp(\"reviewed_at\"),\n  reviewed_by: integer(\"reviewed_by\").references(() => users.id), // Admin who reviewed\n  rejection_reason: text(\"rejection_reason\"), // If rejected, why\n});\n\n// Rating reports - for reporting inappropriate reviews\nexport const ratingReports = pgTable(\"rating_reports\", {\n  id: serial(\"id\").primaryKey(),\n  reporter_id: integer(\"reporter_id\").notNull().references(() => users.id), // User who reported\n  rating_type: varchar(\"rating_type\", { length: 50 }).notNull(), // 'user', 'localidade', 'activity'\n  rating_id: integer(\"rating_id\").notNull(), // ID of the rating being reported\n  reason: varchar(\"reason\", { length: 100 }).notNull(), // 'offensive', 'spam', 'inappropriate', 'fake'\n  description: text(\"description\"), // Optional detailed description\n  status: varchar(\"status\", { length: 50 }).default(\"pending\").notNull(), // pending, reviewed, dismissed\n  reviewed_at: timestamp(\"reviewed_at\"),\n  reviewed_by: integer(\"reviewed_by\").references(() => users.id), // Admin who reviewed\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Activity rating helpful votes - track who found reviews helpful\nexport const activityRatingHelpfulVotes = pgTable(\"activity_rating_helpful_votes\", {\n  id: serial(\"id\").primaryKey(),\n  review_id: integer(\"review_id\").notNull().references(() => activityReviews.id),\n  user_id: integer(\"user_id\").notNull().references(() => users.id),\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Interest list table for users without valid referral codes\nexport const interestList = pgTable(\"interest_list\", {\n  id: serial(\"id\").primaryKey(),\n  full_name: varchar(\"full_name\", { length: 255 }).notNull(),\n  email: varchar(\"email\", { length: 255 }).notNull().unique(),\n  phone: varchar(\"phone\", { length: 20 }).notNull(),\n  referral_code: varchar(\"referral_code\", { length: 50 }), // Invalid code they tried to use\n  status: varchar(\"status\", { length: 50 }).default(\"pending\").notNull(), // pending, contacted, approved, rejected\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Referral codes table to manage valid invitation codes\nexport const referralCodes = pgTable(\"referral_codes\", {\n  id: serial(\"id\").primaryKey(),\n  code: varchar(\"code\", { length: 50 }).notNull().unique(),\n  created_by: integer(\"created_by\").references(() => users.id),\n  max_uses: integer(\"max_uses\").default(1).notNull(),\n  current_uses: integer(\"current_uses\").default(0).notNull(),\n  is_active: boolean(\"is_active\").default(true).notNull(),\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n  expires_at: timestamp(\"expires_at\"),\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n  email: true,\n  full_name: true,\n  phone: true,\n  bio: true,\n  location: true,\n  languages: true,\n  interests: true,\n  travel_styles: true,\n}).extend({\n  phone: z.string().min(10, \"Telefone deve ter pelo menos 10 d√≠gitos\").max(20, \"Telefone deve ter no m√°ximo 20 d√≠gitos\"),\n});\n\nexport const insertTripSchema = createInsertSchema(trips).omit({\n  id: true,\n  creator_id: true,\n  current_participants: true,\n  status: true,\n  created_at: true,\n}).extend({\n  title: z.string().min(3, \"O t√≠tulo deve ter pelo menos 3 caracteres\"),\n  budget: z.number().optional(),\n  cover_image: z.string().optional(),\n  budget_breakdown: z.object({\n    transport: z.number().optional(),\n    accommodation: z.number().optional(),\n    food: z.number().optional(),\n    activities: z.number().optional(),\n    shopping: z.number().optional(),\n    insurance: z.number().optional(),\n    visas: z.number().optional(),\n    other: z.number().optional(),\n  }).optional(),\n  start_date: z.union([z.string(), z.date()]).transform(val => \n    typeof val === 'string' ? new Date(val) : val\n  ),\n  end_date: z.union([z.string(), z.date()]).transform(val => \n    typeof val === 'string' ? new Date(val) : val\n  ),\n});\n\nexport const insertMessageSchema = createInsertSchema(messages).omit({\n  id: true,\n  sender_id: true,\n  sent_at: true,\n});\n\nexport const insertTripRequestSchema = createInsertSchema(tripRequests).omit({\n  id: true,\n  user_id: true,\n  created_at: true,\n});\n\nexport const insertRatingReportSchema = createInsertSchema(ratingReports).omit({\n  id: true,\n  reporter_id: true,\n  reviewed_at: true,\n  reviewed_by: true,\n  created_at: true,\n}).extend({\n  reason: z.enum([\"offensive\", \"spam\", \"inappropriate\", \"fake\"], {\n    errorMap: () => ({ message: \"Motivo inv√°lido\" })\n  }),\n  description: z.string().optional(),\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\nexport type InsertTrip = z.infer<typeof insertTripSchema>;\nexport type Trip = typeof trips.$inferSelect;\nexport type TripParticipant = typeof tripParticipants.$inferSelect;\nexport type Message = typeof messages.$inferSelect;\nexport type TripRequest = typeof tripRequests.$inferSelect;\nexport type InsertMessage = z.infer<typeof insertMessageSchema>;\nexport type InsertTripRequest = z.infer<typeof insertTripRequestSchema>;\n\n// Destination types\nexport type Destination = typeof destinations.$inferSelect;\nexport type InsertDestination = typeof destinations.$inferInsert;\nexport type DestinationRating = typeof destinationRatings.$inferSelect;\n\n// Expense types\nexport type Expense = typeof expenses.$inferSelect;\nexport type ExpenseSplit = typeof expenseSplits.$inferSelect;\n\n// Insert schemas for expenses\nexport const insertExpenseSchema = z.object({\n  trip_id: z.number(),\n  amount: z.number().positive(\"O valor deve ser positivo\"),\n  description: z.string().min(1, \"Descri√ß√£o √© obrigat√≥ria\"),\n  category: z.string().default(\"other\"),\n  receipt: z.string().nullable().optional(),\n});\n\nexport const insertExpenseSplitSchema = createInsertSchema(expenseSplits).omit({\n  id: true,\n  settled_at: true,\n}).extend({\n  expense_id: z.number(),\n  user_id: z.number(),\n  amount: z.number().positive(\"O valor deve ser positivo\"),\n});\n\nexport type InsertExpense = z.infer<typeof insertExpenseSchema>;\nexport type InsertExpenseSplit = z.infer<typeof insertExpenseSplitSchema>;\n\n// Interest list schema and types\nexport const insertInterestListSchema = createInsertSchema(interestList).omit({ \n  id: true, \n  created_at: true\n}).extend({\n  full_name: z.string().min(2, \"Nome deve ter pelo menos 2 caracteres\"),\n  email: z.string().email(\"Email inv√°lido\"),\n  phone: z.string().min(10, \"Telefone deve ter pelo menos 10 d√≠gitos\"),\n});\n\nexport type InterestList = typeof interestList.$inferSelect;\nexport type InsertInterestList = z.infer<typeof insertInterestListSchema>;\nexport type ReferralCode = typeof referralCodes.$inferSelect;\n\n// Rating types\nexport type UserRating = typeof userRatings.$inferSelect;\nexport type VerificationRequest = typeof verificationRequests.$inferSelect;\n\n// Rating insert schemas (updated for enhanced system)\nexport const insertUserRatingSchema = createInsertSchema(userRatings).omit({\n  id: true,\n  rater_user_id: true,\n  created_at: true,\n  updated_at: true,\n}).extend({\n  rating: z.number().min(1, \"Avalia√ß√£o deve ser entre 1 e 5 estrelas\").max(5, \"Avalia√ß√£o deve ser entre 1 e 5 estrelas\"),\n  comment: z.string().optional(),\n  categories: z.object({\n    reliability: z.number().min(1).max(5).optional(),\n    friendliness: z.number().min(1).max(5).optional(),\n    communication: z.number().min(1).max(5).optional(),\n    punctuality: z.number().min(1).max(5).optional(),\n    helpfulness: z.number().min(1).max(5).optional(),\n  }).optional(),\n});\n\nexport const insertDestinationRatingSchema = createInsertSchema(destinationRatings).omit({\n  id: true,\n  user_id: true,\n  created_at: true,\n  updated_at: true,\n}).extend({\n  rating: z.number().min(1, \"Avalia√ß√£o deve ser entre 1 e 5 estrelas\").max(5, \"Avalia√ß√£o deve ser entre 1 e 5 estrelas\"),\n  comment: z.string().optional(),\n  categories: z.object({\n    attractions: z.number().min(1).max(5).optional(),\n    food: z.number().min(1).max(5).optional(),\n    safety: z.number().min(1).max(5).optional(),\n    value: z.number().min(1).max(5).optional(),\n    transportation: z.number().min(1).max(5).optional(),\n    nightlife: z.number().min(1).max(5).optional(),\n  }).optional(),\n  photos: z.array(z.string()).optional(),\n  visit_date: z.string().optional().transform((val) => val ? new Date(val) : undefined),\n});\n\nexport const insertVerificationRequestSchema = createInsertSchema(verificationRequests).omit({\n  id: true,\n  submitted_at: true,\n  reviewed_at: true,\n  reviewed_by: true,\n  status: true,\n});\n\nexport type InsertUserRating = z.infer<typeof insertUserRatingSchema>;\nexport type InsertDestinationRating = z.infer<typeof insertDestinationRatingSchema>;\nexport type InsertVerificationRequest = z.infer<typeof insertVerificationRequestSchema>;\nexport type InsertRatingReport = z.infer<typeof insertRatingReportSchema>;\nexport type RatingReport = typeof ratingReports.$inferSelect;\nexport type ActivityRatingHelpfulVote = typeof activityRatingHelpfulVotes.$inferSelect;\n\n// Activities System - TripAdvisor-style activities\nexport const activities = pgTable(\"activities\", {\n  id: serial(\"id\").primaryKey(),\n  title: varchar(\"title\", { length: 255 }).notNull(),\n  description: text(\"description\").notNull(),\n  destination_id: integer(\"destination_id\").notNull().references(() => destinations.id), // Foreign key para destinations\n  category: categoryEnum(\"category\").notNull(),\n  difficulty_level: difficultyLevelEnum(\"difficulty_level\").default(\"easy\").notNull(),\n  duration: varchar(\"duration\", { length: 100 }).notNull(),\n  min_participants: integer(\"min_participants\").default(1).notNull(),\n  max_participants: integer(\"max_participants\").default(50).notNull(),\n  languages: json(\"languages\"), // Available languages\n  inclusions: json(\"inclusions\"), // What's included\n  exclusions: json(\"exclusions\"), // What's not included\n  requirements: json(\"requirements\"), // Age restrictions, fitness level, etc.\n  cancellation_policy: text(\"cancellation_policy\"),\n  contact_info: json(\"contact_info\"), // { email, phone, website, whatsapp }\n  cover_image: text(\"cover_image\").notNull(), // Main image\n  images: json(\"images\"), // Array of image URLs\n  average_rating: decimal(\"average_rating\", { precision: 3, scale: 2 }).default(\"5.00\").notNull(),\n  total_ratings: integer(\"total_ratings\").default(0).notNull(),\n  is_active: boolean(\"is_active\").default(true).notNull(),\n  created_by_id: integer(\"created_by_id\").notNull().references(() => users.id),\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n  updated_at: timestamp(\"updated_at\").defaultNow().notNull(),\n  // Campos herdados automaticamente do destino (preenchidos via trigger/aplica√ß√£o)\n  destination_name: varchar(\"destination_name\", { length: 255 }),\n  city: varchar(\"city\", { length: 255 }),\n  state: varchar(\"state\", { length: 100 }),\n  country: varchar(\"country\", { length: 100 }),\n  country_type: countryTypeEnum(\"country_type\"),\n  region: varchar(\"region\", { length: 100 }),\n  continent: varchar(\"continent\", { length: 100 }),\n}, (table) => ({\n  destinationIdIndex: index(\"idx_destination_id\").on(table.destination_id),\n  categoryIndex: index(\"idx_category\").on(table.category),\n  difficultyIndex: index(\"idx_difficulty\").on(table.difficulty_level),\n  countryTypeIndex: index(\"idx_country_type\").on(table.country_type),\n  regionIndex: index(\"idx_region\").on(table.region),\n  activeIndex: index(\"idx_active\").on(table.is_active),\n}));\n\n// Activity Reviews/Ratings\nexport const activityReviews = pgTable(\"activity_reviews\", {\n  id: serial(\"id\").primaryKey(),\n  activity_id: integer(\"activity_id\").notNull().references(() => activities.id),\n  user_id: integer(\"user_id\").notNull().references(() => users.id),\n  rating: integer(\"rating\").notNull(), // 1-5 stars\n  review: text(\"review\"), // Optional review text\n  photos: json(\"photos\"), // Optional review photos\n  visit_date: timestamp(\"visit_date\"), // When they participated\n  helpful_votes: integer(\"helpful_votes\").default(0).notNull(), // How many found this helpful\n  is_verified: boolean(\"is_verified\").default(false).notNull(), // Verified purchase/participation\n  is_hidden: boolean(\"is_hidden\").default(false).notNull(), // Hidden if reported multiple times\n  report_count: integer(\"report_count\").default(0).notNull(), // Number of reports\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n  updated_at: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Activity Budget Proposals - Multiple budget options per activity\nexport const activityBudgetProposals = pgTable(\"activity_budget_proposals\", {\n  id: serial(\"id\").primaryKey(),\n  activity_id: integer(\"activity_id\").notNull().references(() => activities.id),\n  created_by: integer(\"created_by\").notNull().references(() => users.id),\n  title: varchar(\"title\", { length: 255 }).notNull(), // \"Op√ß√£o B√°sica\", \"Pacote Premium\", etc.\n  description: text(\"description\"), // Description of what's included\n  price_type: varchar(\"price_type\", { length: 50 }).notNull().default(\"per_person\"), // per_person, per_group\n  amount: decimal(\"amount\", { precision: 10, scale: 2 }).notNull(),\n  currency: varchar(\"currency\", { length: 10 }).default(\"BRL\").notNull(),\n  inclusions: json(\"inclusions\"), // What's included in this proposal\n  exclusions: json(\"exclusions\"), // What's not included\n  valid_until: timestamp(\"valid_until\"), // Optional expiry date\n  is_active: boolean(\"is_active\").default(true).notNull(),\n  votes: integer(\"votes\").default(0).notNull(), // Community votes for this proposal\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n  updated_at: timestamp(\"updated_at\").defaultNow().notNull(),\n});\n\n// Activity Budget Proposal Votes - Track user votes on proposals\nexport const activityBudgetProposalVotes = pgTable(\"activity_budget_proposal_votes\", {\n  id: serial(\"id\").primaryKey(),\n  proposal_id: integer(\"proposal_id\").notNull().references(() => activityBudgetProposals.id),\n  user_id: integer(\"user_id\").notNull().references(() => users.id),\n  activity_id: integer(\"activity_id\").notNull().references(() => activities.id),\n  vote_type: varchar(\"vote_type\", { length: 10 }).notNull(), // \"up\" or \"down\"\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Trip Activities - Links activities to trips with selected budget proposal\nexport const tripActivities = pgTable(\"trip_activities\", {\n  id: serial(\"id\").primaryKey(),\n  trip_id: integer(\"trip_id\").notNull().references(() => trips.id),\n  activity_id: integer(\"activity_id\").notNull().references(() => activities.id),\n  budget_proposal_id: integer(\"budget_proposal_id\").notNull().references(() => activityBudgetProposals.id),\n  added_by: integer(\"added_by\").notNull().references(() => users.id),\n  status: varchar(\"status\", { length: 50 }).default(\"proposed\").notNull(), // proposed, approved, rejected\n  participants: integer(\"participants\").notNull().default(1),\n  total_cost: decimal(\"total_cost\", { precision: 10, scale: 2 }).notNull(),\n  scheduled_date: timestamp(\"scheduled_date\"), // When in the trip this activity is scheduled\n  notes: text(\"notes\"), // Additional notes about this activity for the trip\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Activity Bookings/Reservations\nexport const activityBookings = pgTable(\"activity_bookings\", {\n  id: serial(\"id\").primaryKey(),\n  activity_id: integer(\"activity_id\").notNull().references(() => activities.id),\n  user_id: integer(\"user_id\").notNull().references(() => users.id),\n  trip_id: integer(\"trip_id\").references(() => trips.id), // Optional: if booked for a specific trip\n  participants: integer(\"participants\").notNull(),\n  total_amount: decimal(\"total_amount\", { precision: 10, scale: 2 }).notNull(),\n  booking_date: timestamp(\"booking_date\").notNull(), // When activity will happen\n  status: varchar(\"status\", { length: 50 }).default(\"pending\").notNull(), // pending, confirmed, cancelled, completed\n  contact_name: text(\"contact_name\").notNull(),\n  contact_email: text(\"contact_email\").notNull(),\n  contact_phone: text(\"contact_phone\"),\n  special_requests: text(\"special_requests\"),\n  created_at: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Activity types and schemas\nexport type Activity = typeof activities.$inferSelect;\nexport type ActivityReview = typeof activityReviews.$inferSelect;\nexport type ActivityBooking = typeof activityBookings.$inferSelect;\nexport type ActivityBudgetProposal = typeof activityBudgetProposals.$inferSelect;\nexport type ActivityBudgetProposalVote = typeof activityBudgetProposalVotes.$inferSelect;\nexport type TripActivity = typeof tripActivities.$inferSelect;\n\nexport const insertActivitySchema = createInsertSchema(activities).omit({\n  id: true,\n  average_rating: true,\n  total_ratings: true,\n  created_at: true,\n  updated_at: true,\n  // Campos herdados s√£o preenchidos automaticamente\n  destination_name: true,\n  city: true,\n  state: true,\n  country: true,\n  country_type: true,\n  region: true,\n  continent: true,\n}).extend({\n  destination_id: z.number().positive(\"ID do destino √© obrigat√≥rio\"),\n});\n\nexport const insertActivityReviewSchema = createInsertSchema(activityReviews).omit({\n  id: true,\n  user_id: true,\n  helpful_votes: true,\n  is_verified: true,\n  created_at: true,\n  updated_at: true,\n  is_hidden: true,\n  report_count: true,\n}).extend({\n  activity_id: z.number().positive(\"ID da atividade √© obrigat√≥rio\"),\n  rating: z.number().min(1, \"Avalia√ß√£o deve ser entre 1 e 5 estrelas\").max(5, \"Avalia√ß√£o deve ser entre 1 e 5 estrelas\"),\n  review: z.string().optional().or(z.literal(\"\")),\n  photos: z.array(z.string()).optional(),\n  visit_date: z.string().optional().transform((val) => val ? new Date(val) : undefined),\n});\n\nexport const insertActivityBookingSchema = createInsertSchema(activityBookings).omit({\n  id: true,\n  status: true,\n  created_at: true,\n}).extend({\n  participants: z.number().min(1),\n  total_amount: z.number().positive(),\n});\n\nexport const insertActivityBudgetProposalSchema = createInsertSchema(activityBudgetProposals).omit({\n  id: true,\n  activity_id: true,\n  created_by: true,\n  votes: true,\n  created_at: true,\n  updated_at: true,\n}).extend({\n  amount: z.number().positive(\"Valor deve ser positivo\"),\n  title: z.string().min(1, \"T√≠tulo √© obrigat√≥rio\"),\n  inclusions: z.array(z.string()).optional(),\n  exclusions: z.array(z.string()).optional(),\n});\n\nexport const insertTripActivitySchema = createInsertSchema(tripActivities).omit({\n  id: true,\n  trip_id: true,\n  added_by: true,\n  status: true,\n  created_at: true,\n}).extend({\n  participants: z.number().min(1),\n  total_cost: z.number().positive(),\n});\n\nexport type InsertActivity = z.infer<typeof insertActivitySchema>;\nexport type InsertActivityReview = z.infer<typeof insertActivityReviewSchema>;\nexport type InsertActivityBooking = z.infer<typeof insertActivityBookingSchema>;\nexport type InsertActivityBudgetProposal = z.infer<typeof insertActivityBudgetProposalSchema>;\nexport type InsertTripActivity = z.infer<typeof insertTripActivitySchema>;\n\n// Export missing schemas that are referenced in routes\n// Fix: Add missing localidadeRatings export (alias for destinationRatings)\nexport const localidadeRatings = destinationRatings;\nexport const insertLocalidadeRatingSchema = insertDestinationRatingSchema;\n\n// Budget breakdown interface (simplified for budget base)\nexport interface BudgetBreakdown {\n  transport?: number;\n  accommodation?: number;\n  food?: number;\n  insurance?: number;\n  medical?: number;\n  other?: number;\n}\n\n// Advanced planned activity interface\nexport interface PlannedActivity {\n  id: string;\n  title: string;\n  description?: string;\n  estimated_cost?: number;\n  priority: 'high' | 'medium' | 'low';\n  category: 'sightseeing' | 'food' | 'adventure' | 'culture' | 'relaxation' | 'nightlife' | 'shopping' | 'other';\n  duration?: string; // e.g., \"2 hours\", \"full day\"\n  links?: string[]; // URLs for reference\n  attachments?: Array<{\n    name: string;\n    url: string;\n    type: 'image' | 'document' | 'video' | 'other';\n  }>;\n  notes?: string;\n  completed?: boolean;\n  scheduled_date?: string; // ISO date string\n  location?: string;\n  status?: string; // Add status property for compatibility\n  created_at: string;\n}\n\n// Activity categories with labels and icons (standardized across app)\nexport const activityCategories = {\n  sightseeing: { label: \"Pontos Tur√≠sticos\", icon: \"üèõÔ∏è\" },\n  adventure: { label: \"Aventura\", icon: \"üèîÔ∏è\" },\n  culture: { label: \"Cultura\", icon: \"üé®\" },\n  food: { label: \"Gastronomia\", icon: \"üçΩÔ∏è\" },\n  shopping: { label: \"Compras\", icon: \"üõçÔ∏è\" },\n  nature: { label: \"Natureza\", icon: \"üå≤\" },\n  nightlife: { label: \"Vida Noturna\", icon: \"üåô\" },\n  wellness: { label: \"Bem-estar\", icon: \"üßò\" },\n  other: { label: \"Outros\", icon: \"üìã\" }\n} as const;\n\n// Expense category labels (same as budget categories but includes activities)\nexport const expenseCategories = {\n  transport: \"Transporte\",\n  accommodation: \"Hospedagem\",\n  food: \"Alimenta√ß√£o\",\n  activities: \"Atividades\",\n  insurance: \"Seguro e Documentos (Seguros, Vistos)\",\n  medical: \"Sa√∫de e Emerg√™ncias\",\n  other: \"Outros\"\n} as const;\n\n// Budget categories (for budget breakdown - excludes activities)\nexport const budgetCategories = {\n  transport: \"Transporte\",\n  accommodation: \"Hospedagem\",\n  food: \"Alimenta√ß√£o\",\n  insurance: \"Seguro e Documentos (Seguros, Vistos)\",\n  medical: \"Sa√∫de e Emerg√™ncias\",\n  other: \"Outros\"\n} as const;\n\n// Popular destinations in Brazil with cover images\nexport const popularDestinations = {\n  // Beach destinations\n  \"Rio de Janeiro, RJ\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"praia\",\n    description: \"Cidade maravilhosa com praias ic√¥nicas e Cristo Redentor\"\n  },\n  \"Florian√≥polis, SC\": {\n    image: \"https://images.unsplash.com/photo-1544963150-889d45c4e2f8?w=800&q=80\",\n    category: \"praia\",\n    description: \"Ilha da Magia com praias paradis√≠acas\"\n  },\n  \"Salvador, BA\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"praia\",\n    description: \"Capital baiana com cultura rica e praias bel√≠ssimas\"\n  },\n  \"Macei√≥, AL\": {\n    image: \"https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=800&q=80\",\n    category: \"praia\",\n    description: \"Para√≠so tropical com √°guas cristalinas\"\n  },\n  \"Natal, RN\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"praia\",\n    description: \"Cidade do sol com dunas e praias espetaculares\"\n  },\n  \"Fortaleza, CE\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"praia\",\n    description: \"Litoral cearense com praias urbanas e vida noturna\"\n  },\n  \"Recife, PE\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"praia\",\n    description: \"Veneza brasileira com cultura pernambucana\"\n  },\n  \"B√∫zios, RJ\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"praia\",\n    description: \"Pen√≠nsula charmosa com praias exclusivas\"\n  },\n  \"Ilh√©us, BA\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"praia\",\n    description: \"Terra de Jorge Amado com praias e cacau\"\n  },\n  \"Ubatuba, SP\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"praia\",\n    description: \"Litoral norte paulista com praias selvagens\"\n  },\n\n  // Mountain destinations\n  \"Campos do Jord√£o, SP\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"neve\",\n    description: \"Su√≠√ßa brasileira com clima de montanha\"\n  },\n  \"Gramado, RS\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"neve\",\n    description: \"Cidade encantadora com arquitetura europeia\"\n  },\n  \"Canela, RS\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"neve\",\n    description: \"Serra ga√∫cha com natureza exuberante\"\n  },\n  \"Monte Verde, MG\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"neve\",\n    description: \"Vila de montanha com clima europeu\"\n  },\n  \"Penedo, RJ\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"neve\",\n    description: \"Pequena Finl√¢ndia brasileira\"\n  },\n\n  // Nature and ecotourism\n  \"Chapada Diamantina, BA\": {\n    image: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n    category: \"natureza\",\n    description: \"Para√≠so natural com cachoeiras e trilhas\"\n  },\n  \"Pantanal, MT\": {\n    image: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n    category: \"natureza\",\n    description: \"Maior plan√≠cie alag√°vel do mundo\"\n  },\n  \"Amaz√¥nia, AM\": {\n    image: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n    category: \"natureza\",\n    description: \"Floresta tropical com biodiversidade √∫nica\"\n  },\n  \"Chapada dos Veadeiros, GO\": {\n    image: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n    category: \"natureza\",\n    description: \"Cerrado brasileiro com forma√ß√µes rochosas\"\n  },\n  \"Bonito, MS\": {\n    image: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n    category: \"natureza\",\n    description: \"Ecoturismo com rios cristalinos\"\n  },\n  \"Jalap√£o, TO\": {\n    image: \"https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=800&q=80\",\n    category: \"natureza\",\n    description: \"O√°sis no cerrado com dunas douradas\"\n  },\n\n  // Cultural and historical\n  \"Ouro Preto, MG\": {\n    image: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n    category: \"culturais\",\n    description: \"Patrim√¥nio hist√≥rico com arquitetura colonial\"\n  },\n  \"Paraty, RJ\": {\n    image: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n    category: \"culturais\",\n    description: \"Cidade hist√≥rica com centro preservado\"\n  },\n  \"Tiradentes, MG\": {\n    image: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n    category: \"culturais\",\n    description: \"Charme colonial mineiro\"\n  },\n  \"S√£o Lu√≠s, MA\": {\n    image: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n    category: \"culturais\",\n    description: \"Patrim√¥nio da UNESCO com azulejos portugueses\"\n  },\n  \"Diamantina, MG\": {\n    image: \"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&q=80\",\n    category: \"culturais\",\n    description: \"Ber√ßo de JK com arquitetura barroca\"\n  },\n\n  // Adventure destinations\n  \"Brotas, SP\": {\n    image: \"https://images.unsplash.com/photo-1464822759844-d150065c7fb5?w=800&q=80\",\n    category: \"aventura\",\n    description: \"Capital do ecoturismo radical\"\n  },\n  \"Socorro, SP\": {\n    image: \"https://images.unsplash.com/photo-1464822759844-d150065c7fb5?w=800&q=80\",\n    category: \"aventura\",\n    description: \"Aventura com rafting e rapel\"\n  },\n  \"Capit√≥lio, MG\": {\n    image: \"https://images.unsplash.com/photo-1464822759844-d150065c7fb5?w=800&q=80\",\n    category: \"aventura\",\n    description: \"Mar de Minas com c√¢nions e cachoeiras\"\n  },\n  \"Arraial do Cabo, RJ\": {\n    image: \"https://images.unsplash.com/photo-1464822759844-d150065c7fb5?w=800&q=80\",\n    category: \"aventura\",\n    description: \"Caribe brasileiro com mergulho\"\n  },\n\n  // Theme parks and urban\n  \"Orlando, FL\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"parques\",\n    description: \"Capital mundial dos parques tem√°ticos\"\n  },\n  \"S√£o Paulo, SP\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Metr√≥pole com gastronomia e cultura\"\n  },\n  \"Bras√≠lia, DF\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Capital federal com arquitetura modernista\"\n  },\n  \"Belo Horizonte, MG\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Cidade planejada com vida cultural intensa\"\n  },\n  \"Curitiba, PR\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Modelo de sustentabilidade urbana\"\n  },\n  \"Porto Alegre, RS\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Capital ga√∫cha com tradi√ß√£o e modernidade\"\n  },\n\n  // DESTINOS INTERNACIONAIS\n  \n  // Europa - Cidades Urbanas\n  \"Londres, Reino Unido\": {\n    image: \"https://images.unsplash.com/photo-1513635269975-59663e0ac1ad?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Capital brit√¢nica com Big Ben e Tower Bridge\"\n  },\n  \"Paris, Fran√ßa\": {\n    image: \"https://images.unsplash.com/photo-1502602898536-47ad22581b52?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Cidade Luz com Torre Eiffel e Louvre\"\n  },\n  \"Roma, It√°lia\": {\n    image: \"https://images.unsplash.com/photo-1552832230-c0197dd311b5?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Cidade Eterna com Coliseu e Vaticano\"\n  },\n  \"T√≥quio, Jap√£o\": {\n    image: \"https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Shibuya Crossing e cultura pop\"\n  },\n  \"Barcelona, Espanha\": {\n    image: \"https://images.unsplash.com/photo-1539037116277-4db20889f2d4?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Arte moderna com Sagrada Fam√≠lia e Park G√ºell\"\n  },\n  \"Amsterdam, Holanda\": {\n    image: \"https://images.unsplash.com/photo-1534351590666-13e3e96b5017?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Canais hist√≥ricos e cultura liberal\"\n  },\n  \"Berlim, Alemanha\": {\n    image: \"https://images.unsplash.com/photo-1560930950-5cc20e80e392?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Hist√≥ria moderna e vida noturna vibrante\"\n  },\n  \"Praga, Rep√∫blica Tcheca\": {\n    image: \"https://images.unsplash.com/photo-1541849546-216549ae216d?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Cidade de contos de fadas no cora√ß√£o da Europa\"\n  },\n  \"Viena, √Åustria\": {\n    image: \"https://images.unsplash.com/photo-1516550893923-42d28e5677af?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Capital da m√∫sica cl√°ssica e arquitetura imperial\"\n  },\n  \"Budapeste, Hungria\": {\n    image: \"https://images.unsplash.com/photo-1541849546-216549ae216d?w=800&q=80\",\n    category: \"cultural\",\n    description: \"P√©rola do Dan√∫bio com termas hist√≥ricas\"\n  },\n  \"Zurich, Su√≠√ßa\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"neve\",\n    description: \"Cidade alpina com qualidade de vida excepcional\"\n  },\n  \"Estocolmo, Su√©cia\": {\n    image: \"https://images.unsplash.com/photo-1509356843151-3e7d96241e11?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Veneza do Norte com design escandinavo\"\n  },\n  \"Copenhague, Dinamarca\": {\n    image: \"https://images.unsplash.com/photo-1513622470522-26c3c8a854bc?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Cidade hygge com arquitetura contempor√¢nea\"\n  },\n\n  // Am√©rica do Norte\n  \"Nova York, EUA\": {\n    image: \"https://images.unsplash.com/photo-1496442226666-8d4d0e62e6e9?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Times Square, Central Park e Est√°tua da Liberdade\"\n  },\n  \"Los Angeles, EUA\": {\n    image: \"https://images.unsplash.com/photo-1534190239940-9ba8944ea261?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Hollywood, Beverly Hills e praias de Malibu\"\n  },\n  \"Las Vegas, EUA\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Capital mundial dos cassinos e shows\"\n  },\n  \"San Francisco, EUA\": {\n    image: \"https://images.unsplash.com/photo-1534190239940-9ba8944ea261?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Cidade das colinas e tecnologia\"\n  },\n  \"Chicago, EUA\": {\n    image: \"https://images.unsplash.com/photo-1477959858617-67f85cf4f1df?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Cidade dos ventos com arquitetura ic√¥nica\"\n  },\n  \"Miami, EUA\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"praia\",\n    description: \"Praias de South Beach e vida noturna\"\n  },\n  \"Toronto, Canad√°\": {\n    image: \"https://images.unsplash.com/photo-1517935706615-2717063c2225?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Metr√≥pole multicultural canadense\"\n  },\n  \"Vancouver, Canad√°\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"natureza\",\n    description: \"Cidade costeira entre montanhas e oceano\"\n  },\n  \"Cidade do M√©xico, M√©xico\": {\n    image: \"https://images.unsplash.com/photo-1518105779142-d975f22f1b0a?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Metr√≥pole com rica heran√ßa asteca\"\n  },\n  \"Canc√∫n, M√©xico\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"praia\",\n    description: \"Riviera Maya com praias paradis√≠acas\"\n  },\n\n  // Am√©rica do Sul\n  \"Buenos Aires, Argentina\": {\n    image: \"https://images.unsplash.com/photo-1589909202802-8f4aadce1849?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Tango em San Telmo e arquitetura europeia\"\n  },\n  \"Bariloche, Argentina\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"neve\",\n    description: \"Cerro Catedral e Lago Nahuel Huapi\"\n  },\n  \"Santiago, Chile\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Capital chilena cercada pelos Andes\"\n  },\n  \"Valpara√≠so, Chile\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Porto hist√≥rico com arte de rua vibrante\"\n  },\n  \"Lima, Peru\": {\n    image: \"https://images.unsplash.com/photo-1526392060635-9d6019884377?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Capital gastron√¥mica da Am√©rica do Sul\"\n  },\n  \"Cusco, Peru\": {\n    image: \"https://images.unsplash.com/photo-1526392060635-9d6019884377?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Portal para Machu Picchu e cultura inca\"\n  },\n  \"Machu Picchu, Peru\": {\n    image: \"https://images.unsplash.com/photo-1526392060635-9d6019884377?w=800&q=80\",\n    category: \"aventura\",\n    description: \"Cidadela inca nas montanhas dos Andes\"\n  },\n  \"Quito, Equador\": {\n    image: \"https://images.unsplash.com/photo-1526392060635-9d6019884377?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Centro hist√≥rico patrim√¥nio da UNESCO\"\n  },\n  \"Bogot√°, Col√¥mbia\": {\n    image: \"https://images.unsplash.com/photo-1526392060635-9d6019884377?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Capital colombiana com rica vida cultural\"\n  },\n  \"Cartagena, Col√¥mbia\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Cidade colonial murada no Caribe\"\n  },\n  \"Montevid√©u, Uruguai\": {\n    image: \"https://images.unsplash.com/photo-1589909202802-8f4aadce1849?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Capital uruguaia com charme portenho\"\n  },\n  \"La Paz, Bol√≠via\": {\n    image: \"https://images.unsplash.com/photo-1526392060635-9d6019884377?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Capital mais alta do mundo nos Andes\"\n  },\n\n  // √Åsia (removendo duplicatas)\n  \"Kyoto, Jap√£o\": {\n    image: \"https://images.unsplash.com/photo-1493976040374-85c8e12f0c0e?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Templo Dourado e distrito de Gion\"\n  },\n  \"Pequim, China\": {\n    image: \"https://images.unsplash.com/photo-1508804185872-d7badad00f7d?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Capital chinesa com a Grande Muralha\"\n  },\n  \"Xangai, China\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Metr√≥pole moderna com skyline impressionante\"\n  },\n  \"Hong Kong\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Cidade cosmopolita entre Oriente e Ocidente\"\n  },\n  \"Singapura\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Cidade-estado com arquitetura futurista\"\n  },\n  \"Bangkok, Tail√¢ndia\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Capital do sorriso com templos dourados\"\n  },\n  \"Phuket, Tail√¢ndia\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"praia\",\n    description: \"Praias paradis√≠acas e vida noturna asi√°tica\"\n  },\n  \"Bali, Indon√©sia\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"praia\",\n    description: \"Ilha dos deuses com praias e cultura hindu\"\n  },\n  \"Kuala Lumpur, Mal√°sia\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Torres Petronas e diversidade cultural\"\n  },\n  \"Seul, Coreia do Sul\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Capital do K-pop e tecnologia avan√ßada\"\n  },\n  \"Mumbai, √çndia\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Bollywood e contrastes urbanos indianos\"\n  },\n  \"Nova D√©li, √çndia\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Capital indiana com patrim√¥nio mogol\"\n  },\n  \"Istambul, Turquia\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Ponte entre Europa e √Åsia com hist√≥ria otomana\"\n  },\n  \"Dubai, Emirados √Årabes\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Burj Khalifa, Palm Jumeirah e Dubai Mall\"\n  },\n  \"Tel Aviv, Israel\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Cidade costeira com vida noturna e inova√ß√£o\"\n  },\n\n  // √Åfrica\n  \"Cairo, Egito\": {\n    image: \"https://images.unsplash.com/photo-1539650116574-75c0c6d73a73?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Pir√¢mides de Giz√©, Esfinge e Museu Eg√≠pcio\"\n  },\n  \"Marrakech, Marrocos\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"cultural\",\n    description: \"Cidade imperial com souks e cultura berber\"\n  },\n  \"Cidade do Cabo, √Åfrica do Sul\": {\n    image: \"https://images.unsplash.com/photo-1580060839134-75a5edca2e99?w=800&q=80\",\n    category: \"natureza\",\n    description: \"Beleza natural com Table Mountain e vin√≠colas\"\n  },\n  \"Joanesburgo, √Åfrica do Sul\": {\n    image: \"https://images.unsplash.com/photo-1580060839134-75a5edca2e99?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Cidade do ouro com hist√≥ria do apartheid\"\n  },\n  \"Nair√≥bi, Qu√™nia\": {\n    image: \"https://images.unsplash.com/photo-1516026672322-bc52d61a55d5?w=800&q=80\",\n    category: \"aventura\",\n    description: \"Portal para saf√°ris no cora√ß√£o da √Åfrica\"\n  },\n\n  // Oceania\n  \"Sydney, Austr√°lia\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"√ìpera House ic√¥nica e praias urbanas\"\n  },\n  \"Melbourne, Austr√°lia\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"urbanas\",\n    description: \"Capital cultural australiana com caf√© e arte\"\n  },\n  \"Auckland, Nova Zel√¢ndia\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"natureza\",\n    description: \"Cidade dos veleiros com paisagens √©picas\"\n  },\n  \"Queenstown, Nova Zel√¢ndia\": {\n    image: \"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&q=80\",\n    category: \"aventura\",\n    description: \"Capital mundial dos esportes radicais\"\n  },\n  \"Fiji\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"praia\",\n    description: \"Ilhas paradis√≠acas com √°guas cristalinas\"\n  },\n  \"Tahiti, Polin√©sia Francesa\": {\n    image: \"https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&q=80\",\n    category: \"praia\",\n    description: \"Para√≠so tropical com bangal√¥s sobre a √°gua\"\n  },\n\n  // Destinos de cruzeiro\n  \"Mediterr√¢neo\": {\n    image: \"https://guiaviajarmelhor.com.br/wp-content/uploads/2019/01/Curiosidades-cruzeiro-navio-1.jpg\",\n    category: \"cruzeiros\",\n    description: \"Rota cl√°ssica entre ilhas gregas e cidades hist√≥ricas\"\n  },\n  \"Caribe\": {\n    image: \"https://guiaviajarmelhor.com.br/wp-content/uploads/2019/01/Curiosidades-cruzeiro-navio-1.jpg\",\n    category: \"cruzeiros\",\n    description: \"Ilhas tropicais com praias de areia branca\"\n  },\n  \"Fiorde Noruegu√™s\": {\n    image: \"https://guiaviajarmelhor.com.br/wp-content/uploads/2019/01/Curiosidades-cruzeiro-navio-1.jpg\",\n    category: \"cruzeiros\",\n    description: \"Paisagens dram√°ticas da Escandin√°via\"\n  },\n  \"Alasca\": {\n    image: \"https://guiaviajarmelhor.com.br/wp-content/uploads/2019/01/Curiosidades-cruzeiro-navio-1.jpg\",\n    category: \"cruzeiros\",\n    description: \"Natureza selvagem e geleiras impressionantes\"\n  }\n} as const;\n","size_bytes":50654},"shared/utils.ts":{"content":"// ====================================\n// SISTEMA OTIMIZADO DE FORMATA√á√ÉO NUM√âRICA\n// ====================================\n\n// Tipo para configura√ß√µes de formata√ß√£o\ninterface FormatOptions {\n  minimumFractionDigits?: number;\n  maximumFractionDigits?: number;\n  useGrouping?: boolean;\n}\n\n// Cache para formatadores para melhor performance\nconst formatterCache = new Map<string, Intl.NumberFormat>();\n\n// Fun√ß√£o helper para obter ou criar formatador com cache\nfunction getFormatter(locale: string, options: Intl.NumberFormatOptions): Intl.NumberFormat {\n  const key = `${locale}-${JSON.stringify(options)}`;\n  \n  if (!formatterCache.has(key)) {\n    formatterCache.set(key, new Intl.NumberFormat(locale, options));\n  }\n  \n  return formatterCache.get(key)!;\n}\n\n// Fun√ß√£o principal para convers√£o segura de valores\nfunction safeNumber(value: number | string | null | undefined): number {\n  if (value === null || value === undefined || value === '') return 0;\n  \n  if (typeof value === 'number') {\n    return isNaN(value) || !isFinite(value) ? 0 : value;\n  }\n  \n  if (typeof value === 'string') {\n    // Remove espa√ßos em branco\n    const cleaned = value.trim();\n    if (!cleaned) return 0;\n    \n    // Remove s√≠mbolos de moeda e espa√ßos\n    const withoutSymbols = cleaned.replace(/[R$\\s‚Ç¨¬£US]/g, '');\n    \n    // Converte v√≠rgula para ponto (formato brasileiro para padr√£o)\n    const standardized = withoutSymbols.replace(',', '.');\n    \n    const parsed = parseFloat(standardized);\n    return isNaN(parsed) || !isFinite(parsed) ? 0 : parsed;\n  }\n  \n  return 0;\n}\n\n// ====================================\n// FUN√á√ïES DE FORMATA√á√ÉO BRASILEIRA\n// ====================================\n\nexport function formatBrazilianCurrency(value: number | string | null | undefined): string {\n  const numValue = safeNumber(value);\n  \n  const formatter = getFormatter('pt-BR', {\n    style: 'currency',\n    currency: 'BRL',\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2\n  });\n  \n  return formatter.format(numValue);\n}\n\nexport function formatBrazilianNumber(value: number | string | null | undefined, options: FormatOptions = {}): string {\n  const numValue = safeNumber(value);\n  \n  const defaultOptions = {\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2,\n    useGrouping: true,\n    ...options\n  };\n  \n  const formatter = getFormatter('pt-BR', defaultOptions);\n  return formatter.format(numValue);\n}\n\n// Vers√£o compacta para n√∫meros grandes (ex: 1.2K, 1.5M)\nexport function formatCompactNumber(value: number | string | null | undefined): string {\n  const numValue = safeNumber(value);\n  \n  const formatter = getFormatter('pt-BR', {\n    notation: 'compact',\n    compactDisplay: 'short',\n    maximumFractionDigits: 1\n  });\n  \n  return formatter.format(numValue);\n}\n\n// ====================================\n// FUN√á√ïES DE FORMATA√á√ÉO MULTI-MOEDA\n// ====================================\n\nconst currencyConfigs = {\n  BRL: { locale: 'pt-BR', symbol: 'R$' },\n  USD: { locale: 'en-US', symbol: 'US$' },\n  EUR: { locale: 'de-DE', symbol: '‚Ç¨' },\n  GBP: { locale: 'en-GB', symbol: '¬£' }\n} as const;\n\nexport function formatCurrencyByCode(value: number | string | null | undefined, currency: string = 'BRL'): string {\n  const numValue = safeNumber(value);\n  const config = currencyConfigs[currency as keyof typeof currencyConfigs];\n  \n  if (!config) {\n    return `${currency} ${formatBrazilianNumber(numValue)}`;\n  }\n  \n  const formatter = getFormatter(config.locale, {\n    style: 'currency',\n    currency: currency,\n    minimumFractionDigits: 2,\n    maximumFractionDigits: 2\n  });\n  \n  return formatter.format(numValue);\n}\n\nexport function getCurrencySymbol(currency: string): string {\n  const config = currencyConfigs[currency as keyof typeof currencyConfigs];\n  return config?.symbol || currency;\n}\n\n// ====================================\n// FUN√á√ïES DE PARSING E CONVERS√ÉO\n// ====================================\n\nexport function parseBrazilianNumber(value: string | null | undefined): number {\n  return safeNumber(value);\n}\n\nexport function parseNumber(value: any): number {\n  return safeNumber(value);\n}\n\n// Converte formato brasileiro para formato padr√£o JavaScript\nexport function convertBrazilianToStandard(value: string): string {\n  if (!value) return '0';\n  return value.replace(',', '.');\n}\n\n// Converte formato padr√£o JavaScript para formato brasileiro\nexport function convertStandardToBrazilian(value: string | number): string {\n  const strValue = typeof value === 'number' ? value.toString() : String(value || '0');\n  return strValue.replace('.', ',');\n}\n\n// ====================================\n// FUN√á√ïES DE C√ÅLCULO E OPERA√á√ïES\n// ====================================\n\n// Divide valor por n√∫mero de pessoas com tratamento de erros\nexport function calculatePerPerson(total: number | string | null | undefined, people: number | null | undefined): number {\n  const totalValue = safeNumber(total);\n  const peopleCount = safeNumber(people);\n  \n  if (peopleCount <= 0) return 0;\n  return totalValue / peopleCount;\n}\n\n// Calcula porcentagem com prote√ß√£o contra divis√£o por zero\nexport function calculatePercentage(part: number | string | null | undefined, total: number | string | null | undefined): number {\n  const partValue = safeNumber(part);\n  const totalValue = safeNumber(total);\n  \n  if (totalValue === 0) return 0;\n  return (partValue / totalValue) * 100;\n}\n\n// Fun√ß√£o para calcular progresso em porcentagem (0-100)\nexport function calculateProgress(current: number, total: number): number {\n  if (total <= 0) return 0;\n  const progress = (current / total) * 100;\n  return Math.min(Math.max(progress, 0), 100);\n}\n\n// Soma array de valores de forma segura\nexport function sumValues(values: (number | string | null | undefined)[]): number {\n  return values.reduce((sum: number, value) => sum + safeNumber(value), 0);\n}\n\n// ====================================\n// FUN√á√ïES DE FORMATA√á√ÉO ESPECIALIZADA\n// ====================================\n\n// Formata valor com sufixo (ex: \"R$ 100,00/pessoa\")\nexport function formatWithSuffix(value: number | string | null | undefined, suffix: string = ''): string {\n  const formatted = formatBrazilianCurrency(value);\n  return suffix ? `${formatted}${suffix}` : formatted;\n}\n\n// Formata pre√ßo baseado no tipo (gr√°tis, por pessoa, por grupo)\nexport function formatPrice(amount: number | string | null | undefined, type: 'free' | 'per_person' | 'per_group' | 'fixed' = 'fixed'): string {\n  const numValue = safeNumber(amount);\n  \n  if (numValue === 0 || type === 'free') {\n    return 'Gr√°tis';\n  }\n  \n  const baseFormat = formatBrazilianCurrency(numValue);\n  \n  switch (type) {\n    case 'per_person':\n      return `${baseFormat}/pessoa`;\n    case 'per_group':\n      return `${baseFormat}/grupo`;\n    default:\n      return baseFormat;\n  }\n}\n\n// Formata range de pre√ßos (ex: \"R$ 50,00 - R$ 200,00\")\nexport function formatPriceRange(min: number | string | null | undefined, max: number | string | null | undefined): string {\n  const minValue = safeNumber(min);\n  const maxValue = safeNumber(max);\n  \n  if (minValue === 0 && maxValue === 0) return 'Gr√°tis';\n  if (minValue === maxValue) return formatBrazilianCurrency(minValue);\n  \n  return `${formatBrazilianCurrency(minValue)} - ${formatBrazilianCurrency(maxValue)}`;\n}\n\n// ====================================\n// UTILIT√ÅRIOS DE VALIDA√á√ÉO\n// ====================================\n\nexport function isValidNumber(value: any): boolean {\n  const num = safeNumber(value);\n  return num !== 0 || (typeof value === 'number' && value === 0);\n}\n\nexport function isPositiveNumber(value: any): boolean {\n  return safeNumber(value) > 0;\n}\n\n// ====================================\n// FUN√á√ïES LEGADAS (PARA COMPATIBILIDADE)\n// ====================================\n\nexport const formatCurrency = formatBrazilianCurrency;\nexport const parsePrice = parseBrazilianNumber;","size_bytes":7895},"client/src/App.tsx":{"content":"\nimport { Switch, Route } from \"wouter\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { ErrorBoundary } from \"@/components/ui/error-boundary\";\nimport { AuthProvider } from \"@/hooks/use-auth-snake\";\nimport { queryClient } from \"@/lib/queryClient\";\n\nimport HomePage from \"@/pages/home-page\";\nimport AuthPage from \"@/pages/auth-page\";\nimport DashboardPage from \"@/pages/dashboard-page\";\nimport BoardPage from \"@/pages/board-page\";\nimport SearchPage from \"@/pages/search-page\";\nimport CreateTripPage from \"@/pages/create-trip-page\";\nimport EditTripPage from \"@/pages/edit-trip-page\";\nimport TripDetailPage from \"@/pages/trip-detail-page\";\nimport ChatPage from \"@/pages/chat-page\";\nimport JourneyTrackerPage from \"@/pages/journey-tracker-page\";\nimport ProfilePage from \"@/pages/profile\";\nimport PreloaderDemo from \"@/pages/preloader-demo\";\nimport ActivitiesPage from \"@/pages/activities-page\";\nimport ActivityDetailPage from \"@/pages/activity-detail-page\";\nimport PrivacyPolicy from \"@/pages/privacy-policy\";\nimport TermsOfService from \"@/pages/terms-of-service\";\n\nimport NotFound from \"@/pages/not-found\";\n\nimport \"./index.css\";\n\n\n\nfunction App() {\n  return (\n    <ErrorBoundary>\n      <QueryClientProvider client={queryClient}>\n        <TooltipProvider>\n          <AuthProvider>\n            <div className=\"min-h-screen bg-background\">\n              <ErrorBoundary>\n                <Switch>\n                  <Route path=\"/\" component={HomePage} />\n                  <Route path=\"/auth\" component={AuthPage} />\n                  <Route path=\"/dashboard\" component={DashboardPage} />\n                  <Route path=\"/board\" component={BoardPage} />\n                  <Route path=\"/search\" component={SearchPage} />\n                  <Route path=\"/create-trip\" component={CreateTripPage} />\n                  <Route path=\"/edit-trip/:id\" component={EditTripPage} />\n                  <Route path=\"/trip/:id\" component={TripDetailPage} />\n                  <Route path=\"/chat/:tripId\" component={ChatPage} />\n                  <Route path=\"/journey-tracker\" component={JourneyTrackerPage} />\n                  <Route path=\"/profile\" component={ProfilePage} />\n                  <Route path=\"/preloader-demo\" component={PreloaderDemo} />\n                  <Route path=\"/activities\" component={ActivitiesPage} />\n                  <Route path=\"/activities/:id\" component={ActivityDetailPage} />\n                  <Route path=\"/privacy-policy\" component={PrivacyPolicy} />\n                  <Route path=\"/terms-of-service\" component={TermsOfService} />\n\n                  <Route component={NotFound} />\n                </Switch>\n              </ErrorBoundary>\n            </div>\n            <Toaster />\n          </AuthProvider>\n        </TooltipProvider>\n      </QueryClientProvider>\n    </ErrorBoundary>\n  );\n}\n\nexport default App;\n","size_bytes":2957},"client/src/index.css":{"content":"@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Open+Sans:wght@300;400;500;600;700&display=swap');\n\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* Custom responsive breakpoints */\n@media (min-width: 480px) {\n  .xs\\:min-w-xs {\n    min-width: 480px;\n  }\n}\n\n/* Custom animations */\n@keyframes fade-in {\n  from { opacity: 0; }\n  to { opacity: 1; }\n}\n\n@keyframes slide-up {\n  from { \n    opacity: 0;\n    transform: translateY(20px);\n  }\n  to { \n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes slide-in-right {\n  from { \n    opacity: 0;\n    transform: translateX(-20px);\n  }\n  to { \n    opacity: 1;\n    transform: translateX(0);\n  }\n}\n\n@keyframes float {\n  0%, 100% { transform: translateY(0); }\n  50% { transform: translateY(-10px); }\n}\n\n@keyframes shimmer {\n  0% { background-position: -200% 0; }\n  100% { background-position: 200% 0; }\n}\n\n@keyframes lighthouse-glow {\n  0%, 100% { \n    opacity: 0.6;\n    transform: scale(1);\n  }\n  50% { \n    opacity: 1;\n    transform: scale(1.1);\n  }\n}\n\n@keyframes beacon-sweep {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n\n@keyframes wave-animation {\n  0%, 100% { transform: translateY(0) scale(1); }\n  50% { transform: translateY(-5px) scale(1.02); }\n}\n\n@keyframes star-twinkle {\n  0%, 100% { opacity: 0.4; transform: scale(1); }\n  50% { opacity: 1; transform: scale(1.2); }\n}\n\n/* Line clamp utilities */\n.line-clamp-1 {\n  display: -webkit-box;\n  -webkit-line-clamp: 1;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n\n.line-clamp-2 {\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n\n.line-clamp-3 {\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n\n.animate-fade-in {\n  animation: fade-in 0.8s ease-out;\n}\n\n.animate-slide-up {\n  animation: slide-up 0.6s ease-out;\n}\n\n.animate-slide-in-right {\n  animation: slide-in-right 0.6s ease-out;\n}\n\n.animate-float {\n  animation: float 3s ease-in-out infinite;\n}\n\n.animate-shimmer {\n  background: linear-gradient(\n    90deg,\n    transparent 0%,\n    rgba(255, 255, 255, 0.1) 50%,\n    transparent 100%\n  );\n  background-size: 200% 100%;\n  animation: shimmer 2s linear infinite;\n}\n\n.animate-lighthouse-glow {\n  animation: lighthouse-glow 3s ease-in-out infinite;\n}\n\n.animate-beacon-sweep {\n  animation: beacon-sweep 8s linear infinite;\n  transform-origin: center bottom;\n}\n\n.animate-wave {\n  animation: wave-animation 4s ease-in-out infinite;\n}\n\n.animate-star-twinkle {\n  animation: star-twinkle 2s ease-in-out infinite;\n}\n\n.animation-delay-200 {\n  animation-delay: 200ms;\n}\n\n.animation-delay-500 {\n  animation-delay: 500ms;\n}\n\n.animation-delay-1000 {\n  animation-delay: 1000ms;\n}\n\n.animation-delay-1500 {\n  animation-delay: 1500ms;\n}\n\n.animation-delay-400 {\n  animation-delay: 400ms;\n}\n\n.animation-delay-600 {\n  animation-delay: 600ms;\n}\n\n/* Custom animations for home page */\n@keyframes fade-in {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes slide-up {\n  from {\n    transform: translateY(20px);\n    opacity: 0;\n  }\n  to {\n    transform: translateY(0);\n    opacity: 1;\n  }\n}\n\n.animate-fade-in {\n  animation: fade-in 1s ease-out;\n}\n\n.animate-slide-up {\n  animation: slide-up 0.8s ease-out;\n}\n\n.animation-delay-200 {\n  animation-delay: 200ms;\n}\n\n:root {\n  --background: hsl(0, 0%, 100%);\n  --foreground: hsl(20, 14.3%, 4.1%);\n  --muted: hsl(60, 4.8%, 95.9%);\n  --muted-foreground: hsl(25, 5.3%, 44.7%);\n  --popover: hsl(0, 0%, 100%);\n  --popover-foreground: hsl(20, 14.3%, 4.1%);\n  --card: hsl(0, 0%, 100%);\n  --card-foreground: hsl(20, 14.3%, 4.1%);\n  --border: hsl(20, 5.9%, 90%);\n  --input: hsl(20, 5.9%, 90%);\n  --primary: hsl(14, 100%, 60%);\n  --primary-foreground: hsl(0, 0%, 98%);\n  --secondary: hsl(207, 90%, 27%);\n  --secondary-foreground: hsl(0, 0%, 98%);\n  --accent: hsl(32, 95%, 44%);\n  --accent-foreground: hsl(0, 0%, 98%);\n  --destructive: hsl(0, 84.2%, 60.2%);\n  --destructive-foreground: hsl(60, 9.1%, 97.8%);\n  --ring: hsl(20, 14.3%, 4.1%);\n  --radius: 0.5rem;\n  --success: hsl(142, 76%, 36%);\n  --warning: hsl(43, 89%, 38%);\n  --light: hsl(214, 32%, 91%);\n  --medium: hsl(200, 18%, 46%);\n  --dark: hsl(210, 22%, 22%);\n}\n\n.dark {\n  --background: hsl(240, 10%, 3.9%);\n  --foreground: hsl(0, 0%, 98%);\n  --muted: hsl(240, 3.7%, 15.9%);\n  --muted-foreground: hsl(240, 5%, 64.9%);\n  --popover: hsl(240, 10%, 3.9%);\n  --popover-foreground: hsl(0, 0%, 98%);\n  --card: hsl(240, 10%, 3.9%);\n  --card-foreground: hsl(0, 0%, 98%);\n  --border: hsl(240, 3.7%, 15.9%);\n  --input: hsl(240, 3.7%, 15.9%);\n  --primary: hsl(14, 100%, 60%);\n  --primary-foreground: hsl(0, 0%, 98%);\n  --secondary: hsl(207, 90%, 27%);\n  --secondary-foreground: hsl(0, 0%, 98%);\n  --accent: hsl(32, 95%, 44%);\n  --accent-foreground: hsl(0, 0%, 98%);\n  --destructive: hsl(0, 62.8%, 30.6%);\n  --destructive-foreground: hsl(0, 0%, 98%);\n  --ring: hsl(240, 4.9%, 83.9%);\n  --radius: 0.5rem;\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n    font-family: 'Open Sans', sans-serif;\n  }\n\n  h1, h2, h3, h4, h5, h6 {\n    font-family: 'Poppins', sans-serif;\n  }\n}\n\n@layer components {\n  .hero-gradient {\n    background: linear-gradient(135deg, hsl(207, 90%, 27%) 0%, hsl(14, 100%, 60%) 100%);\n  }\n  \n  .trip-card {\n    @apply bg-white rounded-2xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 cursor-pointer;\n  }\n  \n  .status-badge {\n    @apply inline-block text-xs px-2 py-1 rounded-full font-medium;\n  }\n  \n  .status-open {\n    @apply bg-green-100 text-green-800;\n  }\n  \n  .status-pending {\n    @apply bg-yellow-100 text-yellow-800;\n  }\n  \n  .status-confirmed {\n    @apply bg-blue-100 text-blue-800;\n  }\n}\n","size_bytes":5800},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"server/templates/README-ACTIVITY-IMPORT.md":{"content":"# Guia de Importa√ß√£o de Atividades - PartiuTrip\n\nEste guia explica como importar novas atividades para a plataforma PartiuTrip de forma padronizada e eficiente.\n\n## Estrutura de Arquivos\n\n```\nserver/\n‚îú‚îÄ‚îÄ templates/\n‚îÇ   ‚îú‚îÄ‚îÄ activity-import-template.ts      # Template principal\n‚îÇ   ‚îú‚îÄ‚îÄ activity-verification-template.ts # Template de verifica√ß√£o\n‚îÇ   ‚îî‚îÄ‚îÄ README-ACTIVITY-IMPORT.md        # Este guia\n‚îú‚îÄ‚îÄ add-[cidade]-activities.ts           # Scripts espec√≠ficos por cidade\n‚îú‚îÄ‚îÄ verify-[cidade]-activities.ts        # Scripts de verifica√ß√£o\n‚îî‚îÄ‚îÄ check-proposals.ts                   # Verifica√ß√£o geral\n```\n\n## Passo a Passo para Importa√ß√£o\n\n### 1. Criar Script de Importa√ß√£o\n\n```bash\n# Copie o template\ncp server/templates/activity-import-template.ts server/add-[cidade]-activities.ts\n```\n\n### 2. Configurar Dados da Atividade\n\n```typescript\nconst activities = [\n  {\n    title: \"Nome da Atividade\",\n    description: \"Descri√ß√£o completa e detalhada...\",\n    location: \"Cidade, Estado\", // Ex: \"Salvador, BA\"\n    category: \"category_name\", // Ver categorias abaixo\n    duration: 4, // Horas\n    difficulty: \"easy\", // easy, medium, hard\n    priceRange: \"R$ 100 - R$ 500\",\n    coverImage: \"https://images.unsplash.com/...\",\n    proposals: [\n      {\n        title: \"Econ√¥mico\",\n        description: \"Op√ß√£o mais b√°sica\",\n        price: 100,\n        inclusions: [\"Item 1\", \"Item 2\"]\n      },\n      {\n        title: \"Completo\",\n        description: \"Op√ß√£o intermedi√°ria\",\n        price: 250,\n        inclusions: [\"Item 1\", \"Item 2\", \"Item 3\"]\n      },\n      {\n        title: \"Premium\",\n        description: \"Op√ß√£o completa\",\n        price: 500,\n        inclusions: [\"Item 1\", \"Item 2\", \"Item 3\", \"Item 4\"]\n      }\n    ]\n  }\n];\n```\n\n### 3. Categorias Dispon√≠veis\n\n- `nature` - Natureza e ecoturismo\n- `water_sports` - Esportes aqu√°ticos\n- `adventure` - Aventura e adrenalina\n- `cultural` - Cultura e hist√≥ria\n- `food_tours` - Gastronomia\n- `hiking` - Trilhas e caminhadas\n- `pontos_turisticos` - Pontos tur√≠sticos\n- `wildlife` - Vida selvagem\n\n### 4. Executar Importa√ß√£o\n\n```bash\nnpx tsx server/add-[cidade]-activities.ts\n```\n\n### 5. Verificar Importa√ß√£o\n\n```bash\nnpx tsx server/verify-[cidade]-activities.ts\n```\n\n## Pontos Importantes\n\n### ‚úÖ Fazer Sempre\n\n1. **Descri√ß√µes detalhadas**: Pelo menos 100-200 caracteres\n2. **Pre√ßos realistas**: Pesquisar pre√ßos reais de mercado\n3. **3 propostas**: Econ√¥mico, Completo, Premium\n4. **Inclus√µes espec√≠ficas**: Listar o que est√° inclu√≠do\n5. **Imagens de qualidade**: Usar Unsplash com alta resolu√ß√£o\n6. **Verifica√ß√£o**: Sempre executar script de verifica√ß√£o\n\n### ‚ùå Evitar\n\n1. **N√£o usar mock data**: Sempre dados reais\n2. **N√£o duplicar atividades**: Verificar se j√° existe\n3. **N√£o usar pre√ßos absurdos**: Manter realismo\n4. **N√£o esquecer convers√µes**: `price.toString()` e `JSON.stringify()`\n5. **N√£o pular verifica√ß√£o**: Sempre testar ap√≥s importa√ß√£o\n\n## Campos Obrigat√≥rios\n\n### Activity\n- `title`: Nome da atividade\n- `description`: Descri√ß√£o completa\n- `location`: \"Cidade, Estado\"\n- `category`: Uma das categorias v√°lidas\n- `duration`: N√∫mero (horas)\n- `difficulty`: \"easy\", \"medium\", \"hard\"\n- `priceRange`: \"R$ min - R$ max\"\n- `coverImage`: URL da imagem\n\n### Budget Proposals\n- `title`: \"Econ√¥mico\", \"Completo\", \"Premium\"\n- `description`: Descri√ß√£o da proposta\n- `amount`: String com valor (ex: \"150.00\")\n- `inclusions`: JSON array de strings\n- `exclusions`: JSON array (pode ser vazio)\n\n## Exemplo Completo\n\n```typescript\n// server/add-salvador-activities.ts\nimport { db } from './db.js';\nimport { activities, activityBudgetProposals } from '../shared/schema.js';\n\nconst salvadorActivities = [\n  {\n    title: \"Elevador Lacerda\",\n    description: \"Ic√¥nico elevador Art D√©co conecta Cidade Alta e Baixa, oferecendo vista panor√¢mica da Ba√≠a de Todos os Santos. Patrim√¥nio hist√≥rico de Salvador com 72 metros de altura.\",\n    location: \"Salvador, BA\",\n    category: \"pontos_turisticos\",\n    duration: 1,\n    difficulty: \"easy\",\n    priceRange: \"R$ 5 - R$ 50\",\n    coverImage: \"https://images.unsplash.com/photo-1234567890\",\n    proposals: [\n      {\n        title: \"Econ√¥mico\",\n        description: \"Subida simples no elevador\",\n        price: 5,\n        inclusions: [\"Subida no elevador\", \"Vista panor√¢mica\"]\n      },\n      {\n        title: \"Completo\",\n        description: \"Subida com guia tur√≠stico\",\n        price: 25,\n        inclusions: [\"Subida no elevador\", \"Guia tur√≠stico\", \"Hist√≥ria local\"]\n      },\n      {\n        title: \"Premium\",\n        description: \"Tour privado com fot√≥grafo\",\n        price: 50,\n        inclusions: [\"Subida no elevador\", \"Guia privado\", \"Sess√£o fotogr√°fica\", \"Material informativo\"]\n      }\n    ]\n  }\n];\n\nasync function addSalvadorActivities() {\n  console.log('üå¥ Iniciando importa√ß√£o de Salvador...');\n  \n  try {\n    for (const activityData of salvadorActivities) {\n      console.log(`üìç Adicionando: ${activityData.title}`);\n      \n      const [activity] = await db.insert(activities).values({\n        title: activityData.title,\n        description: activityData.description,\n        location: activityData.location,\n        category: activityData.category,\n        duration: activityData.duration,\n        difficulty: activityData.difficulty,\n        priceRange: activityData.priceRange,\n        coverImage: activityData.coverImage,\n        rating: \"4.5\",\n        reviewCount: 0,\n        isActive: true,\n        createdById: 1\n      });\n      \n      for (const proposal of activityData.proposals) {\n        await db.insert(activityBudgetProposals).values({\n          activityId: activity.insertId,\n          createdBy: 1,\n          title: proposal.title,\n          description: proposal.description,\n          amount: proposal.price.toString(),\n          inclusions: JSON.stringify(proposal.inclusions),\n          exclusions: JSON.stringify([]),\n          votes: Math.floor(Math.random() * 60) + 20,\n          isActive: true\n        });\n      }\n      \n      console.log(`‚úÖ ${activityData.title} configurada!`);\n    }\n    \n    console.log('üéâ Importa√ß√£o conclu√≠da!');\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  }\n}\n\naddSalvadorActivities();\n```\n\n## Checklist Final\n\n- [ ] Dados reais e pesquisados\n- [ ] 3 propostas de or√ßamento\n- [ ] Descri√ß√µes detalhadas\n- [ ] Categoria correta\n- [ ] Pre√ßos realistas\n- [ ] Imagem de qualidade\n- [ ] Script executado sem erros\n- [ ] Verifica√ß√£o realizada\n- [ ] Atividades vis√≠veis na aplica√ß√£o\n\n## Suporte\n\nPara d√∫vidas ou problemas, verificar:\n1. Logs de erro no terminal\n2. Conex√£o com banco MySQL\n3. Formato dos dados JSON\n4. Campos obrigat√≥rios preenchidos\n\nEste sistema garante consist√™ncia e qualidade na importa√ß√£o de atividades para a plataforma PartiuTrip.","size_bytes":6859},"server/templates/activity-import-template.ts":{"content":"import { db } from '../db.js';\nimport { activities, activityBudgetProposals } from '../../shared/schema.js';\n\n// TEMPLATE: Activity Import Script\n// Use this template to create new activity import scripts\n// Replace the data array with your specific activities\n\nconst TEMPLATE_ACTIVITIES = [\n  {\n    title: \"Nome da Atividade\",\n    description: \"Descri√ß√£o completa e detalhada da atividade, incluindo o que esperar, dura√ß√£o, n√≠vel de dificuldade, p√∫blico-alvo e experi√™ncias √∫nicas que a atividade oferece.\",\n    location: \"Cidade, Estado\", // Ex: \"Rio de Janeiro, RJ\" ou \"Bonito, MS\"\n    category: \"category_name\", // nature, water_sports, adventure, cultural, food_tours, hiking, pontos_turisticos, wildlife\n    duration: 4, // Dura√ß√£o em horas\n    difficulty: \"easy\", // easy, medium, hard\n    priceRange: \"R$ 100 - R$ 500\", // Faixa de pre√ßo resumida\n    coverImage: \"https://images.unsplash.com/photo-id?w=800&q=80\", // URL da imagem de capa\n    proposals: [\n      {\n        title: \"Econ√¥mico\",\n        description: \"Descri√ß√£o da op√ß√£o econ√¥mica\",\n        price: 100, // Pre√ßo num√©rico\n        inclusions: [\"Item 1\", \"Item 2\", \"Item 3\"] // Lista de inclus√µes\n      },\n      {\n        title: \"Completo\",\n        description: \"Descri√ß√£o da op√ß√£o completa\",\n        price: 250,\n        inclusions: [\"Item 1\", \"Item 2\", \"Item 3\", \"Item 4\"]\n      },\n      {\n        title: \"Premium\",\n        description: \"Descri√ß√£o da op√ß√£o premium\",\n        price: 500,\n        inclusions: [\"Item 1\", \"Item 2\", \"Item 3\", \"Item 4\", \"Item 5\", \"Item 6\"]\n      }\n    ]\n  }\n];\n\nasync function importActivities() {\n  console.log('üöÄ Iniciando importa√ß√£o de atividades...');\n  \n  try {\n    for (const activityData of TEMPLATE_ACTIVITIES) {\n      console.log(`üìç Adicionando atividade: ${activityData.title}`);\n      \n      // Insert activity\n      const [activity] = await db.insert(activities).values({\n        title: activityData.title,\n        description: activityData.description,\n        location: activityData.location,\n        category: activityData.category,\n        duration: activityData.duration,\n        difficulty: activityData.difficulty,\n        priceRange: activityData.priceRange,\n        coverImage: activityData.coverImage,\n        rating: \"4.5\", // Rating padr√£o\n        reviewCount: 0, // Sem reviews iniciais\n        isActive: true,\n        createdById: 1 // User tom (admin)\n      });\n      \n      console.log(`‚úÖ Atividade criada com ID: ${activity.insertId}`);\n      \n      // Add budget proposals\n      for (const proposal of activityData.proposals) {\n        await db.insert(activityBudgetProposals).values({\n          activityId: activity.insertId,\n          createdBy: 1, // User tom\n          title: proposal.title,\n          description: proposal.description,\n          amount: proposal.price.toString(), // IMPORTANTE: converter para string\n          inclusions: JSON.stringify(proposal.inclusions), // IMPORTANTE: converter para JSON\n          exclusions: JSON.stringify([]), // Array vazio como padr√£o\n          votes: Math.floor(Math.random() * 60) + 20, // Votos aleat√≥rios entre 20-80\n          isActive: true\n        });\n        \n        console.log(`üí∞ Proposta \"${proposal.title}\" criada: R$ ${proposal.price}`);\n      }\n      \n      console.log(`‚úÖ Atividade \"${activityData.title}\" completamente configurada!\\n`);\n    }\n    \n    console.log('üéâ Importa√ß√£o conclu√≠da com sucesso!');\n    \n  } catch (error) {\n    console.error('‚ùå Erro durante a importa√ß√£o:', error);\n  }\n}\n\n// Execute apenas se este arquivo for executado diretamente\nif (import.meta.url === `file://${process.argv[1]}`) {\n  importActivities();\n}\n\nexport { importActivities, TEMPLATE_ACTIVITIES };","size_bytes":3732},"server/templates/activity-verification-template.ts":{"content":"import { db } from '../db.js';\nimport { activities, activityBudgetProposals } from '../../shared/schema.js';\nimport { eq } from 'drizzle-orm';\n\n// TEMPLATE: Activity Verification Script\n// Use this template to verify activities after import\n\nasync function verifyActivitiesByLocation(location: string) {\n  console.log(`üîç Verificando atividades de ${location}...`);\n  \n  try {\n    // Get all activities for the location\n    const locationActivities = await db\n      .select()\n      .from(activities)\n      .where(eq(activities.location, location));\n    \n    console.log(`üìä Encontradas ${locationActivities.length} atividades em ${location}:`);\n    \n    for (const activity of locationActivities) {\n      console.log(`\\nüéØ ${activity.title} (ID: ${activity.id})`);\n      console.log(`   üìç Localiza√ß√£o: ${activity.location}`);\n      console.log(`   üìÇ Categoria: ${activity.category}`);\n      console.log(`   ‚≠ê Rating: ${activity.rating}/5`);\n      console.log(`   üïê Dura√ß√£o: ${activity.duration}h`);\n      console.log(`   üéØ Dificuldade: ${activity.difficulty}`);\n      console.log(`   üí∞ Faixa de pre√ßo: ${activity.priceRange}`);\n      console.log(`   üñºÔ∏è Imagem: ${activity.coverImage}`);\n      console.log(`   üìù Descri√ß√£o: ${activity.description?.substring(0, 100)}...`);\n      \n      // Get budget proposals for this activity\n      const proposals = await db\n        .select()\n        .from(activityBudgetProposals)\n        .where(eq(activityBudgetProposals.activityId, activity.id));\n      \n      console.log(`   üíµ Propostas de or√ßamento (${proposals.length}):`);\n      for (const proposal of proposals) {\n        console.log(`     - ${proposal.title}: R$ ${proposal.amount} (${proposal.votes} votos)`);\n        console.log(`       üìã ${proposal.description}`);\n        \n        // Parse inclusions safely\n        try {\n          const inclusions = JSON.parse(proposal.inclusions || '[]');\n          console.log(`       ‚úÖ Inclui: ${inclusions.join(', ')}`);\n        } catch (e) {\n          console.log(`       ‚ö†Ô∏è Erro ao parsear inclus√µes: ${proposal.inclusions}`);\n        }\n      }\n    }\n    \n    console.log('\\n‚úÖ Verifica√ß√£o conclu√≠da com sucesso!');\n    console.log(`üéâ Total: ${locationActivities.length} atividades em ${location} verificadas`);\n    \n    return locationActivities;\n    \n  } catch (error) {\n    console.error('‚ùå Erro na verifica√ß√£o:', error);\n    return [];\n  }\n}\n\n// Fun√ß√£o para verificar todas as atividades\nasync function verifyAllActivities() {\n  console.log('üîç Verificando todas as atividades...');\n  \n  try {\n    const allActivities = await db.select().from(activities);\n    const allProposals = await db.select().from(activityBudgetProposals);\n    \n    console.log(`üìä Resumo geral:`);\n    console.log(`   üéØ Total de atividades: ${allActivities.length}`);\n    console.log(`   üí∞ Total de propostas: ${allProposals.length}`);\n    \n    // Agrupa por localiza√ß√£o\n    const byLocation = allActivities.reduce((acc, activity) => {\n      acc[activity.location] = (acc[activity.location] || 0) + 1;\n      return acc;\n    }, {} as Record<string, number>);\n    \n    console.log(`   üìç Por localiza√ß√£o:`);\n    for (const [location, count] of Object.entries(byLocation)) {\n      console.log(`     - ${location}: ${count} atividades`);\n    }\n    \n    // Agrupa por categoria\n    const byCategory = allActivities.reduce((acc, activity) => {\n      acc[activity.category] = (acc[activity.category] || 0) + 1;\n      return acc;\n    }, {} as Record<string, number>);\n    \n    console.log(`   üìÇ Por categoria:`);\n    for (const [category, count] of Object.entries(byCategory)) {\n      console.log(`     - ${category}: ${count} atividades`);\n    }\n    \n    return { activities: allActivities, proposals: allProposals };\n    \n  } catch (error) {\n    console.error('‚ùå Erro na verifica√ß√£o geral:', error);\n    return null;\n  }\n}\n\nexport { verifyActivitiesByLocation, verifyAllActivities };","size_bytes":3982},"client/src/components/activity-budget-proposals.tsx":{"content":"import { useState, useCallback, useEffect, useRef } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { insertActivityBudgetProposalSchema } from \"@shared/schema\";\nimport type { z } from \"zod\";\nimport { Plus, DollarSign, ThumbsUp, ThumbsDown, Check, User, Package, Star, TrendingUp } from \"lucide-react\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { motion } from \"framer-motion\";\nimport { formatBrazilianCurrency, formatBrazilianNumber, formatCurrencyByCode } from \"@shared/utils\";\n\ntype ActivityBudgetProposal = {\n  id: number;\n  activity_id: number;\n  title: string;\n  description: string;\n  amount: number;\n  currency: string;\n  price_type: string;\n  inclusions: string[];\n  exclusions: string[];\n  votes: number;\n  is_active: boolean;\n  created_at: string;\n  creator: {\n    id: number;\n    username: string;\n    full_name: string;\n  };\n};\n\ninterface ActivityBudgetProposalsProps {\n  activityId: number;\n  onSelectProposal?: (proposal: ActivityBudgetProposal) => void;\n  selectedProposalId?: number;\n  allowMultipleSelection?: boolean;\n  onProposalsChange?: (proposals: ActivityBudgetProposal[]) => void;\n  includedProposalIds?: number[]; // IDs das propostas j√° inclu√≠das nas viagens do usu√°rio\n}\n\ntype ProposalFormData = z.infer<typeof insertActivityBudgetProposalSchema>;\n\nexport function ActivityBudgetProposals({ \n  activityId, \n  onSelectProposal, \n  selectedProposalId,\n  allowMultipleSelection = false,\n  onProposalsChange,\n  includedProposalIds = []\n}: ActivityBudgetProposalsProps) {\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [selectedProposals, setSelectedProposals] = useState<ActivityBudgetProposal[]>([]);\n  const [pendingVotes, setPendingVotes] = useState<Map<number, boolean>>(new Map());\n  const voteTimeouts = useRef<Map<number, NodeJS.Timeout>>(new Map());\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const form = useForm<ProposalFormData>({\n    resolver: zodResolver(insertActivityBudgetProposalSchema),\n    defaultValues: {\n      title: \"\",\n      description: \"\",\n      amount: 0,\n      currency: \"BRL\",\n      price_type: \"per_person\",\n      inclusions: [],\n      exclusions: []\n    }\n  });\n\n  // Fetch proposals\n  const { data: proposalsData, isLoading } = useQuery({\n    queryKey: ['/api/activities', activityId, 'proposals'],\n    queryFn: async () => {\n      const response = await fetch(`/api/activities/${activityId}/proposals`);\n      if (!response.ok) throw new Error('Falha ao buscar propostas');\n      return response.json() as Promise<ActivityBudgetProposal[]>;\n    }\n  });\n\n  // Filter unique proposals to avoid duplicate keys\n  const proposals = proposalsData ? proposalsData.filter((proposal, index, arr) => \n    arr.findIndex(p => p.id === proposal.id) === index\n  ) : [];\n\n  // Check if user has voted on individual proposals\n  const { data: proposalVotes } = useQuery({\n    queryKey: ['/api/proposals', 'user-votes', activityId],\n    queryFn: async () => {\n      if (!user || !proposals || proposals.length === 0) return {};\n      \n      const votePromises = proposals.map(async (proposal) => {\n        const response = await fetch(`/api/proposals/${proposal.id}/user-vote`, {\n          credentials: 'include',\n        });\n        if (!response.ok) throw new Error('Failed to fetch vote');\n        const data = await response.json();\n        return { proposalId: proposal.id, hasVoted: data.hasVoted, vote: data.vote };\n      });\n      \n      const votes = await Promise.all(votePromises);\n      return votes.reduce((acc, vote) => {\n        acc[vote.proposalId] = vote;\n        return acc;\n      }, {} as Record<number, { hasVoted: boolean; vote: any }>);\n    },\n    enabled: !!user && !!proposals && proposals.length > 0,\n  });\n\n  // Create proposal mutation\n  const createProposal = useMutation({\n    mutationFn: async (data: ProposalFormData) => {\n      const response = await fetch(`/api/activities/${activityId}/proposals`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data)\n      });\n      if (!response.ok) throw new Error('Falha ao criar proposta');\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/activities', activityId, 'proposals'] });\n      setIsDialogOpen(false);\n      form.reset();\n      toast({ title: \"Proposta criada com sucesso!\" });\n    },\n    onError: () => {\n      toast({ \n        title: \"Erro ao criar proposta\", \n        description: \"Tente novamente mais tarde\",\n        variant: \"destructive\" \n      });\n    }\n  });\n\n  // Vote mutation\n  const voteProposal = useMutation({\n    mutationFn: async ({ proposalId, increment }: { proposalId: number; increment: boolean }) => {\n      const response = await fetch(`/api/proposals/${proposalId}/vote`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ increment })\n      });\n      if (!response.ok) throw new Error('Falha ao votar');\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/activities', activityId, 'proposals'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/proposals', 'user-votes', activityId] });\n    },\n    onError: (error: any) => {\n      toast({ \n        title: \"Erro ao votar\", \n        description: \"Tente novamente mais tarde\",\n        variant: \"destructive\" \n      });\n    }\n  });\n\n  const onSubmit = (data: ProposalFormData) => {\n    console.log('üîç Dados para envio:', data);\n    createProposal.mutate(data);\n  };\n\n  // Debounced vote handler - only commits vote after user stops clicking\n  const debouncedVote = useCallback((proposalId: number, increment: boolean) => {\n    // Clear existing timeout for this proposal\n    const existingTimeout = voteTimeouts.current.get(proposalId);\n    if (existingTimeout) {\n      clearTimeout(existingTimeout);\n    }\n\n    // Set new timeout to commit vote after delay\n    const newTimeout = setTimeout(() => {\n      voteProposal.mutate({ proposalId, increment });\n      setPendingVotes(prev => {\n        const newMap = new Map(prev);\n        newMap.delete(proposalId);\n        return newMap;\n      });\n      voteTimeouts.current.delete(proposalId);\n    }, 800); // 800ms delay to commit vote\n\n    voteTimeouts.current.set(proposalId, newTimeout);\n  }, [voteProposal]);\n\n  const handleVote = (proposalId: number, increment: boolean) => {\n    if (!user) {\n      toast({ \n        title: \"Fa√ßa login para votar\", \n        variant: \"destructive\" \n      });\n      return;\n    }\n\n    // Update pending vote state immediately for visual feedback\n    setPendingVotes(prev => {\n      const newMap = new Map(prev);\n      const currentVoteStatus = getProposalVoteStatus(proposalId);\n      newMap.set(proposalId, !currentVoteStatus.hasVoted);\n      return newMap;\n    });\n\n    // Trigger debounced vote\n    debouncedVote(proposalId, increment);\n  };\n\n  const getProposalVoteStatus = (proposalId: number) => {\n    const pendingVote = pendingVotes.get(proposalId);\n    const actualVote = proposalVotes?.[proposalId] || { hasVoted: false, vote: null };\n    \n    // If there's a pending vote, use that state for visual feedback\n    if (pendingVote !== undefined) {\n      return { hasVoted: pendingVote, vote: actualVote.vote };\n    }\n    \n    return actualVote;\n  };\n\n  // Clean up timeouts on unmount\n  useEffect(() => {\n    return () => {\n      voteTimeouts.current.forEach(timeout => clearTimeout(timeout));\n    };\n  }, []);\n\n  // Handle multiple proposal selection\n  const handleProposalToggle = (proposal: ActivityBudgetProposal, selected: boolean) => {\n    if (!allowMultipleSelection) {\n      onSelectProposal?.(proposal);\n      return;\n    }\n\n    let newSelected: ActivityBudgetProposal[];\n    if (selected) {\n      newSelected = [...selectedProposals, proposal];\n    } else {\n      newSelected = selectedProposals.filter(p => p.id !== proposal.id);\n    }\n    \n    setSelectedProposals(newSelected);\n    onProposalsChange?.(newSelected);\n  };\n\n  const isProposalSelected = (proposalId: number) => {\n    if (!allowMultipleSelection) {\n      return selectedProposalId === proposalId;\n    }\n    return selectedProposals.some(p => p.id === proposalId);\n  };\n\n  const calculateSelectedTotal = () => {\n    return selectedProposals.reduce((total, proposal) => {\n      return total + (Number(proposal.amount) || 0);\n    }, 0);\n  };\n\n  // Helper function to safely parse JSON arrays\n  const safeParseArray = (data: any): string[] => {\n    if (Array.isArray(data)) return data;\n    if (typeof data === 'string') {\n      try {\n        let parsed = JSON.parse(data);\n        if (typeof parsed === 'string') {\n          parsed = JSON.parse(parsed);\n        }\n        return Array.isArray(parsed) ? parsed : [];\n      } catch {\n        return [];\n      }\n    }\n    return [];\n  };\n\n  // Calculate best value proposal\n  const getBestValueProposal = () => {\n    if (!proposals || proposals.length === 0) return null;\n    return proposals.reduce((best, current) => {\n      if (!best) return current;\n      const bestScore = best.votes / (Number(best.amount) || 1);\n      const currentScore = current.votes / (Number(current.amount) || 1);\n      return currentScore > bestScore ? current : best;\n    }, null as ActivityBudgetProposal | null);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <h3 className=\"text-2xl font-bold text-gray-900\">Propostas de Or√ßamento</h3>\n            <p className=\"text-gray-600\">Compare as op√ß√µes dispon√≠veis para esta atividade</p>\n          </div>\n        </div>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {[1, 2, 3].map(i => (\n            <div key={i} className=\"h-64 bg-gray-100 rounded-xl animate-pulse\" />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  const bestValue = getBestValueProposal();\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"text-2xl font-bold text-gray-900\">Propostas de Or√ßamento</h3>\n          <p className=\"text-gray-600\">Compare as op√ß√µes dispon√≠veis para esta atividade</p>\n        </div>\n        {user && (\n          <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n            <DialogTrigger asChild>\n              <Button className=\"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-lg\">\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Nova Proposta\n              </Button>\n            </DialogTrigger>\n            <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n              <DialogHeader>\n                <DialogTitle className=\"text-xl font-bold\">Criar Nova Proposta de Or√ßamento</DialogTitle>\n              </DialogHeader>\n              <Form {...form}>\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"title\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-sm font-medium\">T√≠tulo da Proposta</FormLabel>\n                          <FormControl>\n                            <Input placeholder=\"Ex: Pacote Premium\" {...field} className=\"h-11\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={form.control}\n                      name=\"amount\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-sm font-medium\">Valor (R$)</FormLabel>\n                          <FormControl>\n                            <Input \n                              type=\"number\" \n                              step=\"0.01\"\n                              placeholder=\"0.00\"\n                              className=\"h-11\"\n                              {...field}\n                              onChange={e => {\n                                const value = e.target.value;\n                                field.onChange(value === '' ? 0 : parseFloat(value.replace(',', '.')) || 0);\n                              }}\n                            />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n\n                  <FormField\n                    control={form.control}\n                    name=\"description\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-sm font-medium\">Descri√ß√£o</FormLabel>\n                        <FormControl>\n                          <Textarea \n                            placeholder=\"Descreva o que est√° inclu√≠do nesta proposta...\"\n                            className=\"min-h-[100px]\"\n                            {...field}\n                            value={field.value || \"\"}\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"price_type\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-sm font-medium\">Tipo de Pre√ßo</FormLabel>\n                          <FormControl>\n                            <Select value={field.value} onValueChange={field.onChange}>\n                              <SelectTrigger className=\"h-11\">\n                                <SelectValue placeholder=\"Selecione o tipo\" />\n                              </SelectTrigger>\n                              <SelectContent>\n                                <SelectItem value=\"per_person\">Por pessoa</SelectItem>\n                                <SelectItem value=\"per_group\">Por grupo</SelectItem>\n                              </SelectContent>\n                            </Select>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={form.control}\n                      name=\"currency\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-sm font-medium\">Moeda</FormLabel>\n                          <FormControl>\n                            <Select value={field.value} onValueChange={field.onChange}>\n                              <SelectTrigger className=\"h-11\">\n                                <SelectValue placeholder=\"Selecione a moeda\" />\n                              </SelectTrigger>\n                              <SelectContent>\n                                <SelectItem value=\"BRL\">Real (BRL)</SelectItem>\n                                <SelectItem value=\"USD\">D√≥lar (USD)</SelectItem>\n                                <SelectItem value=\"EUR\">Euro (EUR)</SelectItem>\n                              </SelectContent>\n                            </Select>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"inclusions\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-sm font-medium\">Inclui (uma por linha)</FormLabel>\n                          <FormControl>\n                            <Textarea \n                              placeholder=\"Guia especializado&#10;Equipamentos&#10;Lanche\"\n                              className=\"min-h-[120px]\"\n                              value={Array.isArray(field.value) ? field.value.join('\\n') : (field.value || '')}\n                              onChange={(e) => {\n                                const lines = e.target.value.split('\\n').filter(line => line.trim());\n                                field.onChange(lines);\n                              }}\n                            />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                    <FormField\n                      control={form.control}\n                      name=\"exclusions\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-sm font-medium\">N√£o Inclui (uma por linha)</FormLabel>\n                          <FormControl>\n                            <Textarea \n                              placeholder=\"Transporte&#10;Alimenta√ß√£o&#10;Seguro\"\n                              className=\"min-h-[120px]\"\n                              value={Array.isArray(field.value) ? field.value.join('\\n') : (field.value || '')}\n                              onChange={(e) => {\n                                const lines = e.target.value.split('\\n').filter(line => line.trim());\n                                field.onChange(lines);\n                              }}\n                            />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n\n                  <div className=\"flex justify-end gap-3 pt-4 border-t\">\n                    <Button \n                      type=\"button\" \n                      variant=\"outline\" \n                      onClick={() => setIsDialogOpen(false)}\n                      className=\"h-11\"\n                    >\n                      Cancelar\n                    </Button>\n                    <Button \n                      type=\"submit\" \n                      disabled={createProposal.isPending}\n                      className=\"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 h-11\"\n                    >\n                      {createProposal.isPending ? \"Criando...\" : \"Criar Proposta\"}\n                    </Button>\n                  </div>\n                </form>\n              </Form>\n            </DialogContent>\n          </Dialog>\n        )}\n      </div>\n\n      {/* Statistics Bar */}\n      {proposals && proposals.length > 0 && (\n        <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-blue-600\">{proposals.length}</div>\n              <div className=\"text-sm text-gray-600\">Propostas</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-green-600\">\n                {formatBrazilianCurrency(Math.min(...proposals.map(p => Number(p.amount) || 0)))}\n              </div>\n              <div className=\"text-sm text-gray-600\">Menor Pre√ßo</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-blue-600\">\n                {formatBrazilianCurrency(Math.max(...proposals.map(p => Number(p.amount) || 0)))}\n              </div>\n              <div className=\"text-sm text-gray-600\">Maior Pre√ßo</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-purple-600\">\n                {Math.round(proposals.reduce((sum, p) => sum + (p.votes || 0), 0) / proposals.length)}\n              </div>\n              <div className=\"text-sm text-gray-600\">Votos M√©dios</div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Proposals Grid */}\n      {!proposals || proposals.length === 0 ? (\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"text-center py-16\"\n        >\n          <div className=\"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6\">\n            <DollarSign className=\"h-12 w-12 text-gray-400\" />\n          </div>\n          <h4 className=\"text-xl font-semibold text-gray-900 mb-2\">\n            Nenhuma proposta ainda\n          </h4>\n          <p className=\"text-gray-600 mb-6 max-w-md mx-auto\">\n            Seja o primeiro a criar uma proposta de or√ßamento para esta atividade e ajude outros viajantes.\n          </p>\n          {user && (\n            <Button \n              onClick={() => setIsDialogOpen(true)}\n              className=\"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-lg\"\n            >\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Criar Primeira Proposta\n            </Button>\n          )}\n        </motion.div>\n      ) : (\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {proposals.map((proposal, index) => {\n            const inclusions = safeParseArray(proposal.inclusions);\n            const exclusions = safeParseArray(proposal.exclusions);\n            const isBestValue = bestValue?.id === proposal.id;\n            const isSelected = allowMultipleSelection \n              ? selectedProposals.some(p => p.id === proposal.id)\n              : selectedProposalId === proposal.id;\n            \n            return (\n              <motion.div\n                key={`proposal-${proposal.id}-${index}`}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: index * 0.1 }}\n              >\n                <Card \n                  className={`relative h-full transition-all duration-300 cursor-pointer group ${\n                    isSelected \n                      ? isBestValue\n                        ? 'ring-2 ring-green-500 shadow-lg transform scale-[1.02]'\n                        : 'ring-2 ring-blue-500 shadow-lg transform scale-[1.02]' \n                      : 'hover:shadow-lg hover:transform hover:scale-[1.01]'\n                  } ${isBestValue ? 'border-green-500 border-2' : ''}`}\n                  onClick={() => onSelectProposal?.(proposal)}\n                >\n                  {/* Best Value Badge */}\n                  {isBestValue && (\n                    <div className=\"absolute -top-3 left-4 right-4\">\n                      <div className=\"bg-gradient-to-r from-green-500 to-emerald-500 text-white text-xs font-medium px-3 py-1 rounded-full text-center shadow-lg\">\n                        <Star className=\"h-3 w-3 inline mr-1\" />\n                        Melhor Custo-Benef√≠cio\n                      </div>\n                    </div>\n                  )}\n\n                  <CardHeader className=\"pb-4\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <CardTitle className=\"text-lg font-bold text-gray-900 mb-2 flex items-center gap-2\">\n                          {proposal.title}\n                          {isSelected && (\n                            <div className={`w-5 h-5 ${isBestValue ? 'bg-green-500' : 'bg-blue-500'} rounded-full flex items-center justify-center`}>\n                              <Check className=\"h-3 w-3 text-white\" />\n                            </div>\n                          )}\n                        </CardTitle>\n                        <div className=\"flex items-center gap-2 text-sm text-gray-600 mb-3\">\n                          <User className=\"h-4 w-4\" />\n                          <span>{proposal.creator.full_name}</span>\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Price Display */}\n                    <div className=\"bg-gradient-to-r from-gray-50 to-gray-100 rounded-lg p-4\">\n                      <div className=\"text-center\">\n                        <div className=\"text-3xl font-bold text-gray-900 mb-1\">\n                          {formatCurrencyByCode(Number(proposal.amount || 0), proposal.currency)}\n                        </div>\n                        <Badge variant=\"outline\" className={`capitalize text-xs ${isBestValue ? 'border-green-300 text-green-700' : ''}`}>\n                          {proposal.priceType === \"per_person\" ? \"Por pessoa\" : \"Por grupo\"}\n                        </Badge>\n                      </div>\n                    </div>\n                  </CardHeader>\n\n                  <CardContent className=\"pt-0\">\n                    <p className=\"text-gray-700 text-sm mb-4 line-clamp-2\">\n                      {proposal.description}\n                    </p>\n\n                    {/* Inclusions */}\n                    {inclusions.length > 0 && (\n                      <div className=\"mb-4\">\n                        <h5 className=\"font-semibold text-green-700 text-sm mb-2 flex items-center gap-1\">\n                          <Package className=\"h-4 w-4\" />\n                          Inclui:\n                        </h5>\n                        <div className=\"space-y-1\">\n                          {inclusions.slice(0, 3).map((item, idx) => (\n                            <div key={idx} className=\"flex items-center gap-2 text-xs text-gray-600\">\n                              <div className=\"w-1.5 h-1.5 bg-green-500 rounded-full\"></div>\n                              <span className=\"line-clamp-1\">{item}</span>\n                            </div>\n                          ))}\n                          {inclusions.length > 3 && (\n                            <div className=\"text-xs text-gray-500\">\n                              +{inclusions.length - 3} itens\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    )}\n\n                    {/* Voting and Selection */}\n                    <div className=\"flex items-center justify-between pt-4 border-t border-gray-100\">\n                      <div className=\"flex items-center gap-2\">\n                        {user && (\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleVote(proposal.id, true);\n                            }}\n                            disabled={voteProposal.isPending}\n                            className={`h-8 px-2 flex items-center gap-1 ${\n                              getProposalVoteStatus(proposal.id).hasVoted \n                                ? pendingVotes.has(proposal.id)\n                                  ? 'bg-yellow-100 text-yellow-600 border-yellow-300 animate-pulse' \n                                  : 'bg-blue-100 text-blue-600 border-blue-300'\n                                : 'hover:bg-blue-50 hover:text-blue-600'\n                            }`}\n                            title={\n                              pendingVotes.has(proposal.id) \n                                ? 'Processando voto...' \n                                : getProposalVoteStatus(proposal.id).hasVoted \n                                  ? 'Clique para remover like' \n                                  : 'Dar like'\n                            }\n                          >\n                            <ThumbsUp className={`h-3 w-3 ${\n                              getProposalVoteStatus(proposal.id).hasVoted ? 'fill-current' : ''\n                            }`} />\n                            <span className=\"text-xs\">{proposal.votes}</span>\n                          </Button>\n                        )}\n                        {!user && (\n                          <Badge variant=\"secondary\" className=\"text-xs\">\n                            <ThumbsUp className=\"h-3 w-3 mr-1\" />\n                            {proposal.votes}\n                          </Badge>\n                        )}\n                        {user && getProposalVoteStatus(proposal.id).hasVoted && (\n                          <Badge variant=\"outline\" className={`text-xs ${\n                            pendingVotes.has(proposal.id)\n                              ? 'text-yellow-600 border-yellow-200 animate-pulse'\n                              : 'text-blue-600 border-blue-200'\n                          }`}>\n                            {pendingVotes.has(proposal.id) ? '‚è≥ Processando...' : '‚úì J√° deu like!'}\n                          </Badge>\n                        )}\n                      </div>\n                      \n                      {(onSelectProposal || allowMultipleSelection) && (\n                        <Button \n                          size=\"sm\"\n                          variant=\"outline\"\n                          className={\n                            includedProposalIds.includes(proposal.id)\n                              ? \"h-8 bg-green-100 hover:bg-green-200 text-green-800 border-green-300 cursor-not-allowed\"\n                              : isSelected \n                              ? isBestValue\n                                ? \"h-8 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 text-white border-green-600 shadow-md\"\n                                : \"h-8 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white border-blue-600 shadow-md\"\n                              : isBestValue\n                              ? \"h-8 border-green-300 text-green-600 hover:bg-gradient-to-r hover:from-green-50 hover:to-emerald-50 hover:border-green-400 hover:text-green-700 transition-all duration-200\"\n                              : \"h-8 border-blue-300 text-blue-600 hover:bg-gradient-to-r hover:from-blue-50 hover:to-indigo-50 hover:border-blue-400 hover:text-blue-700 transition-all duration-200\"\n                          }\n                          disabled={includedProposalIds.includes(proposal.id)}\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            if (!includedProposalIds.includes(proposal.id)) {\n                              handleProposalToggle(proposal, !isSelected);\n                            }\n                          }}\n                        >\n                          {includedProposalIds.includes(proposal.id) ? (\n                            <>\n                              <Check className=\"h-3 w-3 mr-1\" />\n                              J√° inclu√≠do\n                            </>\n                          ) : isSelected ? (\n                            <>\n                              <Check className=\"h-3 w-3 mr-1\" />\n                              {allowMultipleSelection ? \"Selecionado\" : \"Selecionado\"}\n                            </>\n                          ) : (\n                            <>\n                              <Plus className=\"h-3 w-3 mr-1\" />\n                              {allowMultipleSelection ? \"Adicionar\" : \"Selecionar\"}\n                            </>\n                          )}\n                        </Button>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            );\n          })}\n        </div>\n      )}\n\n      {/* Selected Proposals Summary */}\n      {allowMultipleSelection && selectedProposals.length > 0 && (\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"bg-gradient-to-r from-green-50 to-emerald-50 border border-green-200 rounded-xl p-6\"\n        >\n          <div className=\"flex items-center justify-between mb-4\">\n            <h4 className=\"text-lg font-semibold text-green-800 flex items-center gap-2\">\n              <Check className=\"h-5 w-5\" />\n              Propostas Selecionadas\n            </h4>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => {\n                setSelectedProposals([]);\n                onProposalsChange?.([]);\n              }}\n              className=\"text-green-700 hover:text-green-800\"\n            >\n              Limpar\n            </Button>\n          </div>\n          \n          <div className=\"space-y-3\">\n            {selectedProposals.map((proposal, idx) => (\n              <div key={`selected-${proposal.id}-${idx}`} className=\"flex items-center justify-between bg-white/60 rounded-lg p-3\">\n                <div>\n                  <div className=\"font-medium text-sm\">{proposal.title}</div>\n                  <div className=\"text-xs text-gray-600\">\n                    {proposal.priceType === \"per_person\" ? \"Por pessoa\" : \"Por grupo\"}\n                  </div>\n                </div>\n                <div className=\"text-right\">\n                  <div className=\"font-semibold text-green-700\">\n                    {formatCurrencyByCode(Number(proposal.amount || 0), proposal.currency)}\n                  </div>\n                  <Button\n                    size=\"sm\"\n                    variant=\"ghost\"\n                    onClick={() => handleProposalToggle(proposal, false)}\n                    className=\"h-6 w-6 p-0 text-red-500 hover:text-red-700 hover:bg-red-50\"\n                  >\n                    √ó\n                  </Button>\n                </div>\n              </div>\n            ))}\n          </div>\n          \n          <div className=\"border-t border-green-200 pt-4 mt-4\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-lg font-semibold text-green-800\">\n                Total: {selectedProposals.length} proposta{selectedProposals.length !== 1 ? 's' : ''}\n              </span>\n              <span className=\"text-2xl font-bold text-green-700\">\n                {formatBrazilianCurrency(calculateSelectedTotal())}\n              </span>\n            </div>\n          </div>\n        </motion.div>\n      )}\n    </div>\n  );\n}","size_bytes":35533},"client/src/components/activity-reviews.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { insertActivityReviewSchema } from \"@shared/schema\";\nimport type { z } from \"zod\";\nimport { Star, ThumbsUp, User, Calendar, MessageSquare, Plus, CheckCircle } from \"lucide-react\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { format } from \"date-fns\";\nimport { ptBR } from \"date-fns/locale\";\nimport { formatBrazilianCurrency, formatBrazilianNumber } from \"@shared/utils\";\n\ntype ActivityReview = {\n  id: number;\n  activity_id: number;\n  rating: number;\n  review: string | null;\n  photos: string[];\n  visit_date: string | null;\n  helpful_votes: number;\n  is_verified: boolean;\n  created_at: string;\n  user: {\n    id: number;\n    username: string;\n    full_name: string;\n    profile_photo: string | null;\n    average_rating: number;\n    is_verified: boolean;\n  };\n};\n\ninterface ActivityReviewsProps {\n  activityId: number;\n  averageRating?: number;\n  totalRatings?: number;\n}\n\ntype ReviewFormData = z.infer<typeof insertActivityReviewSchema>;\n\nexport function ActivityReviews({ activityId, averageRating = 0, totalRatings = 0 }: ActivityReviewsProps) {\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [showAllReviews, setShowAllReviews] = useState(false);\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const form = useForm<ReviewFormData>({\n    resolver: zodResolver(insertActivityReviewSchema),\n    defaultValues: {\n      activity_id: activityId,\n      rating: 5,\n      review: \"\",\n      photos: [],\n      visit_date: new Date()\n    }\n  });\n\n  // Fetch reviews\n  const { data: reviews = [], isLoading } = useQuery({\n    queryKey: ['/api/activities', activityId, 'reviews'],\n    queryFn: async () => {\n      const response = await fetch(`/api/activities/${activityId}/reviews`, {\n        credentials: 'include'\n      });\n      if (!response.ok) {\n        throw new Error('Failed to fetch reviews');\n      }\n      return response.json();\n    },\n    enabled: !!activityId\n  });\n\n  // Create review mutation\n  const createReview = useMutation({\n    mutationFn: async (data: ReviewFormData) => {\n      const response = await fetch(`/api/activities/${activityId}/reviews`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(data),\n        credentials: 'include'\n      });\n      \n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || 'Erro ao criar avalia√ß√£o');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"Avalia√ß√£o criada com sucesso!\" });\n      queryClient.invalidateQueries({ queryKey: ['/api/activities', activityId, 'reviews'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/activities', activityId] });\n      setIsDialogOpen(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      toast({ \n        title: \"Erro ao criar avalia√ß√£o\", \n        description: error.message,\n        variant: \"destructive\" \n      });\n    }\n  });\n\n  // Mark review as helpful mutation\n  const markHelpful = useMutation({\n    mutationFn: async (reviewId: number) => {\n      const response = await fetch(`/api/reviews/${reviewId}/helpful`, {\n        method: 'POST',\n        credentials: 'include'\n      });\n\n      if (!response.ok) {\n        throw new Error('Erro ao marcar avalia√ß√£o como √∫til');\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/activities', activityId, 'reviews'] });\n    }\n  });\n\n  const handleSubmit = (data: ReviewFormData) => {\n    if (!user) {\n      toast({ \n        title: \"Erro de autentica√ß√£o\", \n        description: \"Voc√™ precisa estar logado para avaliar atividades\",\n        variant: \"destructive\" \n      });\n      return;\n    }\n    \n    createReview.mutate(data);\n  };\n\n  const renderStars = (rating: number, size: \"sm\" | \"md\" = \"md\") => {\n    const starSize = size === \"sm\" ? \"h-3 w-3\" : \"h-4 w-4\";\n    return (\n      <div className=\"flex items-center gap-0.5\">\n        {Array.from({ length: 5 }, (_, i) => (\n          <Star\n            key={i}\n            className={`${starSize} ${\n              i < rating ? \"fill-yellow-400 text-yellow-400\" : \"text-gray-300\"\n            }`}\n          />\n        ))}\n      </div>\n    );\n  };\n\n  const renderInteractiveStars = (rating: number, onChange: (rating: number) => void) => {\n    return (\n      <div className=\"flex items-center gap-1\">\n        {Array.from({ length: 5 }, (_, i) => (\n          <button\n            key={i}\n            type=\"button\"\n            onClick={() => onChange(i + 1)}\n            className=\"transition-colors hover:scale-110\"\n          >\n            <Star\n              className={`h-6 w-6 ${\n                i < rating ? \"fill-yellow-400 text-yellow-400\" : \"text-gray-300 hover:text-yellow-400\"\n              }`}\n            />\n          </button>\n        ))}\n        <span className=\"ml-2 text-sm text-gray-600\">({rating} estrela{rating !== 1 ? 's' : ''})</span>\n      </div>\n    );\n  };\n\n  const displayedReviews = showAllReviews ? reviews : reviews.slice(0, 3);\n  const hasUserReviewed = reviews.some((review: ActivityReview) => review.user.id === user?.id);\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Rating Summary */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center justify-between\">\n            <span>Avalia√ß√µes dos Viajantes</span>\n            {!hasUserReviewed && (\n              <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n                <DialogTrigger asChild>\n                  <Button className=\"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700\">\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    Avaliar\n                  </Button>\n                </DialogTrigger>\n                <DialogContent className=\"max-w-md mx-auto max-h-[90vh] overflow-y-auto\">\n                  <DialogHeader>\n                    <DialogTitle>Avaliar Atividade</DialogTitle>\n                  </DialogHeader>\n                  <Form {...form}>\n                    <form onSubmit={form.handleSubmit(handleSubmit)} className=\"space-y-4\">\n                      <FormField\n                        control={form.control}\n                        name=\"activity_id\"\n                        render={({ field }) => (\n                          <FormItem className=\"hidden\">\n                            <FormControl>\n                              <Input type=\"hidden\" {...field} value={activityId} />\n                            </FormControl>\n                          </FormItem>\n                        )}\n                      />\n                      \n                      <FormField\n                        control={form.control}\n                        name=\"rating\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Sua Avalia√ß√£o</FormLabel>\n                            <FormControl>\n                              <div className=\"pt-2\">\n                                {renderInteractiveStars(field.value, field.onChange)}\n                              </div>\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"review\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Coment√°rio (opcional)</FormLabel>\n                            <FormControl>\n                              <Textarea \n                                placeholder=\"Conte sobre sua experi√™ncia com esta atividade...\"\n                                className=\"min-h-[100px]\"\n                                {...field}\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"visit_date\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Data da Visita (opcional)</FormLabel>\n                            <FormControl>\n                              <Input \n                                type=\"date\"\n                                {...field}\n                                value={field.value instanceof Date ? field.value.toISOString().split('T')[0] : field.value}\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <div className=\"flex gap-2 pt-4\">\n                        <Button\n                          type=\"submit\"\n                          disabled={createReview.isPending}\n                          className=\"flex-1 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700\"\n                        >\n                          {createReview.isPending ? \"Enviando...\" : \"Enviar Avalia√ß√£o\"}\n                        </Button>\n                        <Button \n                          type=\"button\" \n                          variant=\"outline\" \n                          onClick={() => setIsDialogOpen(false)}\n                        >\n                          Cancelar\n                        </Button>\n                      </div>\n                    </form>\n                  </Form>\n                </DialogContent>\n              </Dialog>\n            )}\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n\n          {totalRatings > 0 ? (\n            <div className=\"flex items-center gap-4\">\n              <div className=\"flex items-center gap-2\">\n                {renderStars(Math.round(averageRating))}\n                <span className=\"text-2xl font-bold\">{formatBrazilianNumber(Number(averageRating)).replace(',00', ',0')}</span>\n              </div>\n              <div className=\"text-sm text-gray-600\">\n                Baseado em {totalRatings} avalia√ß√£o{totalRatings !== 1 ? '√µes' : ''}\n              </div>\n            </div>\n          ) : (\n            <div className=\"text-center py-4 text-gray-500\">\n              Ainda n√£o h√° avalia√ß√µes para esta atividade\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Reviews List */}\n      {isLoading ? (\n        <div className=\"space-y-4\">\n          {Array.from({ length: 3 }, (_, i) => (\n            <Card key={i} className=\"animate-pulse\">\n              <CardContent className=\"p-4\">\n                <div className=\"flex gap-3\">\n                  <div className=\"h-10 w-10 bg-gray-200 rounded-full\"></div>\n                  <div className=\"flex-1 space-y-2\">\n                    <div className=\"h-4 bg-gray-200 rounded w-1/4\"></div>\n                    <div className=\"h-3 bg-gray-200 rounded w-1/3\"></div>\n                    <div className=\"h-16 bg-gray-200 rounded\"></div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          ))}\n        </div>\n      ) : (\n        <AnimatePresence>\n          <div className=\"space-y-4\">\n            {displayedReviews.map((review: ActivityReview) => (\n              <motion.div\n                key={review.id}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                exit={{ opacity: 0, y: -20 }}\n                transition={{ duration: 0.3 }}\n              >\n                <Card>\n                  <CardContent className=\"p-4\">\n                    <div className=\"flex gap-3\">\n                      <Avatar className=\"h-10 w-10\">\n                        <AvatarImage src={review.user.profile_photo || \"\"} />\n                        <AvatarFallback>\n                          <User className=\"h-5 w-5\" />\n                        </AvatarFallback>\n                      </Avatar>\n                      \n                      <div className=\"flex-1 space-y-2\">\n                        <div className=\"flex items-center justify-between\">\n                          <div className=\"flex items-center gap-2\">\n                            <span className=\"font-medium\">{review.user.full_name}</span>\n                            {review.user.is_verified && (\n                              <CheckCircle className=\"h-4 w-4 text-blue-500\" />\n                            )}\n                            {review.is_verified && (\n                              <Badge variant=\"outline\" className=\"text-xs text-green-600 border-green-200\">\n                                Verificado\n                              </Badge>\n                            )}\n                          </div>\n                          <div className=\"flex items-center gap-2\">\n                            {renderStars(review.rating, \"sm\")}\n                            <span className=\"text-xs text-gray-500\">\n                              {format(new Date(review.created_at), \"dd 'de' MMM 'de' yyyy\", { locale: ptBR })}\n                            </span>\n                          </div>\n                        </div>\n\n                        {review.visit_date && (\n                          <div className=\"flex items-center gap-1 text-xs text-gray-500\">\n                            <Calendar className=\"h-3 w-3\" />\n                            Visitou em {format(new Date(review.visit_date), \"MMM 'de' yyyy\", { locale: ptBR })}\n                          </div>\n                        )}\n\n                        {review.review && (\n                          <p className=\"text-gray-700 leading-relaxed\">{review.review}</p>\n                        )}\n\n                        <div className=\"flex items-center justify-between pt-2\">\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={() => markHelpful.mutate(review.id)}\n                            disabled={markHelpful.isPending}\n                            className=\"text-gray-500 hover:text-blue-600 hover:bg-blue-50\"\n                          >\n                            <ThumbsUp className=\"h-3 w-3 mr-1\" />\n                            √ötil ({review.helpful_votes})\n                          </Button>\n                          \n                          {review.user.average_rating && Number(review.user.average_rating) > 0 && (\n                            <div className=\"text-xs text-gray-500\">\n                              Viajante {formatBrazilianNumber(Number(review.user.average_rating)).replace(',00', ',0')} ‚≠ê\n                            </div>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        </AnimatePresence>\n      )}\n\n      {/* Show More Button */}\n      {reviews.length > 3 && (\n        <div className=\"text-center\">\n          <Button\n            variant=\"outline\"\n            onClick={() => setShowAllReviews(!showAllReviews)}\n            className=\"hover:bg-blue-50 hover:text-blue-600 hover:border-blue-300\"\n          >\n            <MessageSquare className=\"h-4 w-4 mr-2\" />\n            {showAllReviews ? 'Ver Menos' : `Ver Todas (${reviews.length})`}\n          </Button>\n        </div>\n      )}\n\n      {hasUserReviewed && (\n        <Card className=\"border-blue-200 bg-blue-50\">\n          <CardContent className=\"p-4 text-center\">\n            <CheckCircle className=\"h-8 w-8 text-blue-500 mx-auto mb-2\" />\n            <p className=\"text-blue-700 font-medium\">Voc√™ j√° avaliou esta atividade</p>\n            <p className=\"text-sm text-blue-600\">Obrigado por compartilhar sua experi√™ncia!</p>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}","size_bytes":17011},"client/src/components/add-activity-to-trip.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ActivityBudgetProposals } from \"./activity-budget-proposals\";\nimport { Plane, MapPin, Calendar, Users, DollarSign, Plus } from \"lucide-react\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { getParticipantsForBudgetCalculation } from \"@/lib/trip-utils\";\nimport { formatBrazilianCurrency, formatBrazilianNumber, formatCurrencyByCode } from \"@shared/utils\";\n\ntype Activity = {\n  id: number;\n  title: string;\n  description: string;\n  location: string;\n  category: string;\n  images: string[];\n};\n\ntype Trip = {\n  id: number;\n  title: string;\n  localidade: string;\n  start_date: string;\n  end_date: string;\n  cover_image: string;\n  max_participants: number;\n  budget: number;\n};\n\ntype ActivityBudgetProposal = {\n  id: number;\n  activityId: number;\n  title: string;\n  description: string;\n  amount: number;\n  currency: string;\n  priceType: string;\n  inclusions: string[];\n  exclusions: string[];\n  votes: number;\n  creator: {\n    id: number;\n    username: string;\n    full_name: string;\n  };\n};\n\ninterface AddActivityToTripProps {\n  activity: Activity;\n  isOpen: boolean;\n  onClose: () => void;\n  selectedProposals?: ActivityBudgetProposal[];\n}\n\nexport function AddActivityToTrip({ activity, isOpen, onClose, selectedProposals = [] }: AddActivityToTripProps) {\n  const [selectedTripId, setSelectedTripId] = useState<number | null>(null);\n  const [selectedProposal, setSelectedProposal] = useState<ActivityBudgetProposal | null>(null);\n  const [step, setStep] = useState<'trip' | 'proposal' | 'confirm'>('trip');\n  \n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Fetch user trips in same location as activity (like in the trip page)\n  const { data: userTrips = [], isLoading: tripsLoading } = useQuery({\n    queryKey: ['/api/users', user?.id, 'trips-in-location', activity.location],\n    queryFn: async () => {\n      if (!user) return [];\n      const response = await fetch(`/api/users/${user.id}/trips-in-location?location=${encodeURIComponent(activity.location)}`);\n      if (!response.ok) {\n        if (response.status === 401) return [];\n        throw new Error('Falha ao buscar viagens');\n      }\n      const result = await response.json();\n      console.log('üîç AddActivityToTrip trips in location result:', result);\n      return result;\n    },\n    enabled: !!user && isOpen\n  });\n\n  // Add activity to trip mutation\n  const addActivityToTrip = useMutation({\n    mutationFn: async () => {\n      if (!selectedTripId) {\n        throw new Error('Selecione uma viagem');\n      }\n\n      const selectedTrip = Array.isArray(userTrips) ? userTrips.find(trip => trip.id === selectedTripId) : undefined;\n      if (!selectedTrip) {\n        throw new Error('Viagem n√£o encontrada');\n      }\n\n      // Use pre-selected proposals or single selected proposal\n      const proposalsToAdd = selectedProposals && selectedProposals.length > 0 \n        ? selectedProposals \n        : selectedProposal \n        ? [selectedProposal] \n        : [];\n\n      if (proposalsToAdd.length === 0) {\n        throw new Error('Selecione pelo menos uma proposta');\n      }\n\n      // Add each proposal as separate activity\n      const promises = proposalsToAdd.map(async (proposal) => {\n        const participants = getParticipantsForBudgetCalculation(selectedTrip);\n        const amount = typeof proposal.amount === 'number' ? proposal.amount : parseFloat(proposal.amount || '0');\n        const totalCost = proposal.priceType === \"per_person\" \n          ? amount * participants\n          : amount;\n\n        console.log('üîç Calculando custo da atividade:', {\n          proposalAmount: proposal.amount,\n          priceType: proposal.priceType,\n          participants,\n          totalCost\n        });\n\n        const response = await fetch(`/api/trips/${selectedTripId}/activities`, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: JSON.stringify({\n            activityId: activity.id,\n            budgetProposalId: proposal.id,\n            participants,\n            totalCost,\n            notes: `Atividade adicionada: ${activity.title} - ${proposal.title}`\n          })\n        });\n\n        if (!response.ok) throw new Error('Falha ao adicionar atividade');\n        return response.json();\n      });\n\n      return Promise.all(promises);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/trips'] });\n      \n      const proposalsCount = selectedProposals && selectedProposals.length > 0 \n        ? selectedProposals.length \n        : 1;\n      \n      toast({ \n        title: \"Atividade adicionada com sucesso!\", \n        description: `${activity.title} foi adicionada √† sua viagem${proposalsCount > 1 ? ` com ${proposalsCount} propostas de or√ßamento` : ''}.` \n      });\n      handleClose();\n    },\n    onError: (error) => {\n      toast({ \n        title: \"Erro ao adicionar atividade\", \n        description: error.message,\n        variant: \"destructive\" \n      });\n    }\n  });\n\n  const handleClose = () => {\n    setStep('trip');\n    setSelectedTripId(null);\n    setSelectedProposal(null);\n    onClose();\n  };\n\n  const handleTripSelect = (tripId: string) => {\n    setSelectedTripId(parseInt(tripId));\n    // If we have pre-selected proposals, skip to confirm step\n    if (selectedProposals && selectedProposals.length > 0) {\n      setStep('confirm');\n    } else {\n      setStep('proposal');\n    }\n  };\n\n  const handleProposalSelect = (proposal: ActivityBudgetProposal) => {\n    setSelectedProposal(proposal);\n    setStep('confirm');\n  };\n\n  const handleConfirm = () => {\n    addActivityToTrip.mutate();\n  };\n\n  const selectedTrip = Array.isArray(userTrips) ? userTrips.find(trip => trip.id === selectedTripId) : undefined;\n  \n  // Debug logging\n  if (isOpen && user) {\n    console.log('üîç AddActivityToTrip Debug:', {\n      userTrips: userTrips,\n      isArray: Array.isArray(userTrips),\n      length: Array.isArray(userTrips) ? userTrips.length : 'not array',\n      tripsLoading\n    });\n  }\n\n  if (!user) {\n    return (\n      <Dialog open={isOpen} onOpenChange={handleClose}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Fa√ßa login para adicionar atividades</DialogTitle>\n            <DialogDescription>\n              Voc√™ precisa estar logado para adicionar atividades √†s suas viagens\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"py-6 text-center\">\n            <Plane className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n            <p className=\"text-gray-600 mb-4\">\n              Voc√™ precisa estar logado para adicionar atividades √†s suas viagens.\n            </p>\n            <Button onClick={handleClose}>Entendi</Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    );\n  }\n\n  return (\n    <Dialog open={isOpen} onOpenChange={handleClose}>\n      <DialogContent className=\"max-w-4xl\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Plane className=\"h-5 w-5\" />\n            Adicionar {activity.title} √† Viagem\n          </DialogTitle>\n          <DialogDescription>\n            Selecione uma viagem para adicionar esta atividade\n          </DialogDescription>\n        </DialogHeader>\n\n        {step === 'trip' && (\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center gap-2 text-sm text-gray-600 mb-4\">\n              <MapPin className=\"h-4 w-4\" />\n              <span>Buscando suas viagens em {activity.location}</span>\n            </div>\n\n            {tripsLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2, 3].map(i => (\n                  <div key={i} className=\"h-24 bg-gray-100 rounded-lg animate-pulse\" />\n                ))}\n              </div>\n            ) : !Array.isArray(userTrips) || userTrips.length === 0 ? (\n              <Card>\n                <CardContent className=\"py-8 text-center\">\n                  <Plane className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n                  <h4 className=\"text-lg font-medium text-gray-600 mb-2\">\n                    Nenhuma viagem encontrada\n                  </h4>\n                  <p className=\"text-gray-500 mb-4\">\n                    Voc√™ n√£o tem viagens programadas para {activity.location}.\n                  </p>\n                  <p className=\"text-sm text-gray-400\">\n                    Para adicionar esta atividade, crie uma viagem para esta localidade primeiro.\n                  </p>\n                </CardContent>\n              </Card>\n            ) : (\n              <div className=\"space-y-3\">\n                <h3 className=\"font-semibold\">Selecione uma viagem:</h3>\n                <div className=\"grid gap-3\">\n                  {Array.isArray(userTrips) && userTrips.map((trip) => (\n                    <Card \n                      key={trip.id} \n                      className=\"cursor-pointer hover:shadow-md transition-shadow\"\n                      onClick={() => handleTripSelect(trip.id.toString())}\n                    >\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex items-center gap-4\">\n                          <img \n                            src={trip.cover_image} \n                            alt={trip.title}\n                            className=\"w-16 h-16 rounded-lg object-cover\"\n                          />\n                          <div className=\"flex-1\">\n                            <h4 className=\"font-semibold\">{trip.title}</h4>\n                            <p className=\"text-sm text-gray-600 flex items-center gap-1\">\n                              <MapPin className=\"h-3 w-3\" />\n                              {trip.localidade}\n                            </p>\n                            <div className=\"flex items-center gap-4 mt-2 text-xs text-gray-500\">\n                              <span className=\"flex items-center gap-1\">\n                                <Calendar className=\"h-3 w-3\" />\n                                {new Date(trip.start_date).toLocaleDateString('pt-BR')}\n                              </span>\n                              <span className=\"flex items-center gap-1\">\n                                <Users className=\"h-3 w-3\" />\n                                at√© {trip.max_participants} pessoas\n                              </span>\n                              <span className=\"flex items-center gap-1\">\n                                <DollarSign className=\"h-3 w-3\" />\n                                {formatBrazilianCurrency(trip.budget)}\n                              </span>\n                            </div>\n                          </div>\n                          <Button \n                            size=\"sm\" \n                            className=\"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-md hover:shadow-lg transition-all duration-200\"\n                          >\n                            <Plus className=\"h-3 w-3 mr-1\" />\n                            Selecionar\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n\n        {step === 'proposal' && selectedTrip && (\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center gap-2 mb-4\">\n              <Button \n                variant=\"outline\" \n                size=\"sm\" \n                onClick={() => setStep('trip')}\n              >\n                ‚Üê Voltar\n              </Button>\n              <div>\n                <h3 className=\"font-semibold\">{selectedTrip.title}</h3>\n                <p className=\"text-sm text-gray-600\">{selectedTrip.localidade}</p>\n              </div>\n            </div>\n\n            <ActivityBudgetProposals \n              activityId={activity.id}\n              onSelectProposal={handleProposalSelect}\n            />\n          </div>\n        )}\n\n        {step === 'confirm' && selectedTrip && ((selectedProposals && selectedProposals.length > 0) || selectedProposal) && (\n          <div className=\"space-y-6\">\n            <div className=\"flex items-center gap-2 mb-4\">\n              <Button \n                variant=\"outline\" \n                size=\"sm\" \n                onClick={() => setStep('proposal')}\n              >\n                ‚Üê Voltar\n              </Button>\n              <h3 className=\"font-semibold\">Confirmar Adi√ß√£o</h3>\n            </div>\n\n            <div className=\"grid grid-cols-2 gap-6\">\n              {/* Trip Details */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"text-lg\">Viagem Selecionada</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"flex items-center gap-3 mb-4\">\n                    <img \n                      src={selectedTrip.cover_image} \n                      alt={selectedTrip.title}\n                      className=\"w-12 h-12 rounded-lg object-cover\"\n                    />\n                    <div>\n                      <h4 className=\"font-semibold\">{selectedTrip.title}</h4>\n                      <p className=\"text-sm text-gray-600\">{selectedTrip.localidade}</p>\n                    </div>\n                  </div>\n                  <div className=\"space-y-2 text-sm\">\n                    <div className=\"flex items-center gap-2\">\n                      <Calendar className=\"h-4 w-4 text-gray-500\" />\n                      <span>\n                        {new Date(selectedTrip.start_date).toLocaleDateString('pt-BR')} - {' '}\n                        {new Date(selectedTrip.end_date).toLocaleDateString('pt-BR')}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <DollarSign className=\"h-4 w-4 text-gray-500\" />\n                      <span>Or√ßamento: {formatBrazilianCurrency(selectedTrip.budget)}</span>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Proposal Details */}\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"text-lg\">\n                    {selectedProposals && selectedProposals.length > 0 \n                      ? `Propostas Selecionadas (${selectedProposals.length})`\n                      : 'Proposta Selecionada'\n                    }\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {selectedProposals && selectedProposals.length > 0 ? (\n                    <div className=\"space-y-3\">\n                      {selectedProposals.map((proposal, index) => {\n                        const amount = typeof proposal.amount === 'number' ? proposal.amount : parseFloat(proposal.amount || '0');\n                        const totalCost = proposal.priceType === \"per_person\" \n                          ? amount * getParticipantsForBudgetCalculation(selectedTrip)\n                          : amount;\n                        \n                        return (\n                          <div key={proposal.id} className=\"border rounded-lg p-3 bg-gray-50\">\n                            <div className=\"flex justify-between items-start mb-2\">\n                              <div>\n                                <h4 className=\"font-semibold text-sm\">{proposal.title}</h4>\n                                <p className=\"text-xs text-gray-600\">{proposal.description}</p>\n                              </div>\n                              <span className=\"text-sm font-semibold text-blue-600\">\n                                {formatBrazilianCurrency(totalCost)}\n                              </span>\n                            </div>\n                            <div className=\"text-xs text-gray-500\">\n                              {proposal.priceType === \"per_person\" ? \"Por pessoa\" : \"Por grupo\"}\n                            </div>\n                          </div>\n                        );\n                      })}\n                      \n                      <div className=\"flex justify-between items-center pt-2 border-t\">\n                        <span className=\"font-semibold\">Custo Total:</span>\n                        <span className=\"font-semibold text-green-600\">\n                          {formatBrazilianCurrency(selectedProposals.reduce((total, proposal) => {\n                            const amount = typeof proposal.amount === 'number' ? proposal.amount : parseFloat(proposal.amount || '0');\n                            const cost = proposal.priceType === \"per_person\" \n                              ? amount * getParticipantsForBudgetCalculation(selectedTrip)\n                              : amount;\n                            return total + cost;\n                          }, 0))}\n                        </span>\n                      </div>\n                    </div>\n                  ) : selectedProposal && (\n                    <div>\n                      <div className=\"mb-4\">\n                        <h4 className=\"font-semibold\">{selectedProposal.title}</h4>\n                        <p className=\"text-sm text-gray-600\">{selectedProposal.description}</p>\n                      </div>\n                      <div className=\"space-y-2 text-sm\">\n                        <div className=\"flex justify-between\">\n                          <span>Valor Base:</span>\n                          <span className=\"font-semibold text-blue-600\">\n                            {formatCurrencyByCode(typeof selectedProposal.amount === 'number' ? selectedProposal.amount : parseFloat(selectedProposal.amount || '0'), selectedProposal.currency)}\n                          </span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span>Tipo de Pre√ßo:</span>\n                          <span className=\"capitalize\">{selectedProposal.priceType === \"per_person\" ? \"Por Pessoa\" : \"Por Grupo\"}</span>\n                        </div>\n                        <div className=\"flex justify-between\">\n                          <span>Participantes:</span>\n                          <span>{getParticipantsForBudgetCalculation(selectedTrip)}</span>\n                        </div>\n                        <div className=\"flex justify-between border-t pt-2\">\n                          <span className=\"font-semibold\">Custo Total:</span>\n                          <span className=\"font-semibold text-green-600\">\n                            {formatCurrencyByCode((selectedProposal.priceType === \"per_person\" \n                              ? (typeof selectedProposal.amount === 'number' ? selectedProposal.amount : parseFloat(selectedProposal.amount || '0')) * getParticipantsForBudgetCalculation(selectedTrip)\n                              : (typeof selectedProposal.amount === 'number' ? selectedProposal.amount : parseFloat(selectedProposal.amount || '0'))), selectedProposal.currency)}\n                          </span>\n                        </div>\n                      </div>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n\n            <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n              <h4 className=\"font-semibold text-blue-900 mb-2\">Resumo da Adi√ß√£o</h4>\n              <p className=\"text-sm text-blue-800\">\n                A atividade <strong>{activity.title}</strong> ser√° adicionada √† viagem{' '}\n                <strong>{selectedTrip.title}</strong> com{' '}\n                {selectedProposals && selectedProposals.length > 0 \n                  ? `${selectedProposals.length} propostas de or√ßamento`\n                  : selectedProposal ? `a proposta ${selectedProposal.title}` : 'a proposta selecionada'\n                } no valor total de <strong>{\n                  selectedProposals && selectedProposals.length > 0 \n                    ? formatBrazilianCurrency(selectedProposals.reduce((total, proposal) => {\n                        const amount = typeof proposal.amount === 'number' ? proposal.amount : parseFloat(proposal.amount || '0');\n                        const cost = proposal.priceType === \"per_person\" \n                          ? amount * getParticipantsForBudgetCalculation(selectedTrip)\n                          : amount;\n                        return total + cost;\n                      }, 0))\n                    : selectedProposal \n                      ? formatCurrencyByCode((selectedProposal.priceType === \"per_person\" \n                          ? (typeof selectedProposal.amount === 'number' ? selectedProposal.amount : parseFloat(selectedProposal.amount || '0')) * getParticipantsForBudgetCalculation(selectedTrip)\n                          : (typeof selectedProposal.amount === 'number' ? selectedProposal.amount : parseFloat(selectedProposal.amount || '0'))), selectedProposal.currency)\n                      : formatBrazilianCurrency(0)\n                }</strong>.\n              </p>\n              <div className=\"mt-2 text-xs text-blue-700\">\n                <span className=\"font-medium\">Detalhes:</span> {\n                  selectedProposals && selectedProposals.length > 0 \n                    ? `${selectedProposals.length} propostas ser√£o adicionadas para ${getParticipantsForBudgetCalculation(selectedTrip)} participantes`\n                    : selectedProposal \n                      ? (selectedProposal.priceType === \"per_person\" \n                          ? `${formatCurrencyByCode(typeof selectedProposal.amount === 'number' ? selectedProposal.amount : parseFloat(selectedProposal.amount || '0'), selectedProposal.currency)} por pessoa √ó ${getParticipantsForBudgetCalculation(selectedTrip)} participantes`\n                          : `${formatCurrencyByCode(typeof selectedProposal.amount === 'number' ? selectedProposal.amount : parseFloat(selectedProposal.amount || '0'), selectedProposal.currency)} valor fixo por grupo`)\n                      : 'Nenhuma proposta selecionada'\n                }\n              </div>\n            </div>\n\n            <div className=\"flex justify-end gap-3\">\n              <Button variant=\"outline\" onClick={() => setStep('proposal')}>\n                Alterar Proposta\n              </Button>\n              <Button \n                onClick={handleConfirm}\n                disabled={addActivityToTrip.isPending}\n                className=\"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700\"\n              >\n                {addActivityToTrip.isPending ? \"Adicionando...\" : \"Confirmar Adi√ß√£o\"}\n              </Button>\n            </div>\n          </div>\n        )}\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":23388},"client/src/components/advanced-activity-manager.tsx":{"content":"import React, { useState, useRef } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { getRealParticipantsCount } from '@/lib/trip-utils';\nimport { formatBrazilianCurrency, formatBrazilianNumber } from '@shared/utils';\nimport { \n  Button, \n  Card, \n  CardContent, \n  Dialog, \n  DialogContent, \n  DialogHeader, \n  DialogTitle, \n  Input, \n  Label, \n  Select, \n  SelectContent, \n  SelectItem, \n  SelectTrigger, \n  SelectValue, \n  Textarea, \n  Badge,\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger\n} from '@/components/ui';\nimport { \n  Camera, \n  Edit2, \n  Trash2, \n  Plus, \n  DollarSign, \n  Calendar, \n  MapPin,\n  Target,\n  Clock,\n  FileText,\n  Star,\n  Search,\n  Users,\n  Save\n} from 'lucide-react';\nimport { useQuery } from '@tanstack/react-query';\nimport { activityCategories } from '@shared/schema';\n\n// Import PlannedActivity from shared schema\nimport { PlannedActivity } from '@shared/schema';\n\n// Priority colors\nconst priorityColors = {\n  high: 'bg-red-100 text-red-800 border-red-300',\n  medium: 'bg-yellow-100 text-yellow-800 border-yellow-300',\n  low: 'bg-green-100 text-green-800 border-green-300'\n};\n\n// Professional Timeline Component with Enhanced Visual Design\nfunction ActivitiesTimeline({\n  activities,\n  onEdit,\n  onDelete,\n  onReorder,\n  start_date,\n  end_date\n}: {\n  activities: PlannedActivity[];\n  onEdit: (activity: PlannedActivity) => void;\n  onDelete: (id: string) => void;\n  onReorder: (activities: PlannedActivity[]) => void;\n  start_date?: string;\n  end_date?: string;\n}) {\n  // Group activities by date with better date handling\n  const groupedActivities = activities.reduce((groups, activity) => {\n    let dateKey = 'Sem data definida';\n    \n    if (activity.date_time) {\n      try {\n        let dateValue = activity.date_time;\n        if (dateValue instanceof Date) {\n          dateKey = dateValue.toISOString().split('T')[0];\n        } \n        else if (typeof dateValue === 'string') {\n          if (dateValue.match(/^\\d{4}-\\d{2}-\\d{2}$/)) {\n            dateKey = dateValue;\n          }\n          else if (dateValue.includes('T')) {\n            dateKey = new Date(dateValue).toISOString().split('T')[0];\n          }\n          else {\n            const parsed = new Date(dateValue);\n            if (!isNaN(parsed.getTime())) {\n              dateKey = parsed.toISOString().split('T')[0];\n            }\n          }\n        }\n      } catch (error) {\n        console.warn('Error parsing activity date:', activity.date_time, error);\n        dateKey = 'Sem data definida';\n      }\n    }\n    \n    if (!groups[dateKey]) {\n      groups[dateKey] = [];\n    }\n    groups[dateKey].push(activity);\n    return groups;\n  }, {} as Record<string, PlannedActivity[]>);\n\n  const sortedDateGroups = Object.keys(groupedActivities).sort((a, b) => {\n    if (a === 'Sem data definida') return 1;\n    if (b === 'Sem data definida') return -1;\n    return new Date(a).getTime() - new Date(b).getTime();\n  });\n\n  const formatDate = (dateStr: string) => {\n    if (dateStr === 'Sem data definida') return dateStr;\n    try {\n      const date = new Date(dateStr + 'T00:00:00');\n      return date.toLocaleDateString('pt-BR', {\n        weekday: 'long',\n        day: 'numeric',\n        month: 'long',\n        year: 'numeric'\n      });\n    } catch {\n      return dateStr;\n    }\n  };\n\n  const getDayOfWeek = (dateStr: string) => {\n    if (dateStr === 'Sem data definida') return '';\n    try {\n      const date = new Date(dateStr + 'T00:00:00');\n      return date.toLocaleDateString('pt-BR', { weekday: 'short' }).toUpperCase();\n    } catch {\n      return '';\n    }\n  };\n\n  const getDay = (dateStr: string) => {\n    if (dateStr === 'Sem data definida') return '';\n    try {\n      const date = new Date(dateStr + 'T00:00:00');\n      return date.getDate().toString();\n    } catch {\n      return '';\n    }\n  };\n\n  if (activities.length === 0) {\n    return (\n      <div className=\"text-center py-16\">\n        <div className=\"w-20 h-20 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-6\">\n          <Calendar className=\"w-8 h-8 text-blue-600\" />\n        </div>\n        <h3 className=\"text-xl font-semibold text-[#1B2B49] mb-3\">\n          Nenhuma atividade planejada ainda\n        </h3>\n        <p className=\"text-[#AAB0B7] mb-6\">\n          Adicione atividades para criar um cronograma incr√≠vel para sua viagem.\n        </p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-8\">\n      {/* Timeline Header */}\n      <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center shadow-lg\">\n              <Calendar className=\"h-6 w-6 text-white\" />\n            </div>\n            <div>\n              <h3 className=\"text-xl font-bold text-gray-900\">Cronograma de Atividades</h3>\n              <p className=\"text-sm text-gray-600 mt-1\">\n                {sortedDateGroups.length} {sortedDateGroups.length === 1 ? 'dia' : 'dias'} com atividades planejadas\n              </p>\n            </div>\n          </div>\n          <div className=\"text-right\">\n            <div className=\"text-2xl font-bold text-blue-600\">\n              {activities.length}\n            </div>\n            <div className=\"text-sm text-gray-500\">\n              {activities.length === 1 ? 'atividade' : 'atividades'}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Timeline */}\n      <div className=\"relative\">\n        {/* Timeline Line */}\n        <div className=\"absolute left-8 top-0 bottom-0 w-0.5 bg-gradient-to-b from-blue-300 via-blue-400 to-blue-300 rounded-full\"></div>\n        \n        <div className=\"space-y-12\">\n          {sortedDateGroups.map((dateGroup, dayIndex) => (\n            <motion.div\n              key={dateGroup}\n              initial={{ opacity: 0, x: -30 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ duration: 0.6, delay: dayIndex * 0.15 }}\n              className=\"relative\"\n            >\n              {/* Date Header */}\n              <div className=\"flex items-center gap-6 mb-6\">\n                <div className=\"relative z-10 w-16 h-16 bg-white border-4 border-blue-500 rounded-full flex items-center justify-center shadow-xl\">\n                  <div className=\"text-center\">\n                    {dateGroup !== 'Sem data definida' ? (\n                      <>\n                        <div className=\"text-xs font-semibold text-blue-600 uppercase tracking-wide\">\n                          {getDayOfWeek(dateGroup)}\n                        </div>\n                        <div className=\"text-lg font-bold text-gray-900\">\n                          {getDay(dateGroup)}\n                        </div>\n                      </>\n                    ) : (\n                      <div className=\"text-xs font-medium text-gray-500\">\n                        SEM DATA\n                      </div>\n                    )}\n                  </div>\n                </div>\n                <div className=\"bg-white px-6 py-4 rounded-xl border border-gray-200 shadow-sm flex-1\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <h4 className=\"text-lg font-bold text-gray-900 capitalize\">\n                        {dateGroup !== 'Sem data definida' ? getDayOfWeek(dateGroup).toLowerCase() : 'Sem data definida'}\n                      </h4>\n                      <p className=\"text-sm text-gray-600 mt-1\">\n                        {formatDate(dateGroup)} ‚Ä¢ {groupedActivities[dateGroup].length} atividade{groupedActivities[dateGroup].length !== 1 ? 's' : ''}\n                      </p>\n                    </div>\n                    <div className=\"text-right\">\n                      <div className=\"text-sm font-medium text-gray-900\">\n                        Custo estimado\n                      </div>\n                      <div className=\"text-lg font-bold text-blue-600\">\n                        R$ {groupedActivities[dateGroup].reduce((sum, activity) => sum + (activity.estimated_cost || 0), 0).toLocaleString('pt-BR')}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Activities List with Enhanced Design */}\n              <div className=\"ml-24 space-y-6\">\n                {groupedActivities[dateGroup]\n                  .sort((a, b) => {\n                    // Sort by time if available\n                    if (a.date_time?.includes('T') && b.date_time?.includes('T')) {\n                      return a.date_time.localeCompare(b.date_time);\n                    }\n                    return 0;\n                  })\n                  .map((activity, activityIndex) => {\n                    const formatTime = (dateTime?: string) => {\n                      if (!dateTime || !dateTime.includes('T')) return null;\n                      try {\n                        return new Date(dateTime).toLocaleTimeString('pt-BR', {\n                          hour: '2-digit',\n                          minute: '2-digit'\n                        });\n                      } catch {\n                        return null;\n                      }\n                    };\n\n                    const getPriorityConfig = (priority: string) => {\n                      switch (priority) {\n                        case 'high':\n                          return { \n                            color: 'text-red-700 bg-red-50 border-red-200', \n                            accent: 'border-red-400',\n                            gradient: 'from-red-500 to-orange-500'\n                          };\n                        case 'medium':\n                          return { \n                            color: 'text-amber-700 bg-amber-50 border-amber-200', \n                            accent: 'border-amber-400',\n                            gradient: 'from-amber-500 to-yellow-500'\n                          };\n                        case 'low':\n                          return { \n                            color: 'text-emerald-700 bg-emerald-50 border-emerald-200', \n                            accent: 'border-emerald-400',\n                            gradient: 'from-emerald-500 to-green-500'\n                          };\n                        default:\n                          return { \n                            color: 'text-gray-700 bg-gray-50 border-gray-200', \n                            accent: 'border-gray-400',\n                            gradient: 'from-gray-500 to-slate-500'\n                          };\n                      }\n                    };\n\n                    const getCategoryConfig = (category: string) => {\n                      const categoryInfo = activityCategories[category as keyof typeof activityCategories];\n                      return {\n                        icon: categoryInfo?.icon || 'üìå',\n                        label: categoryInfo?.label || category,\n                        gradient: category === 'adventure' ? 'from-orange-500 to-red-500' :\n                                  category === 'culture' ? 'from-purple-500 to-pink-500' :\n                                  category === 'food' ? 'from-yellow-500 to-orange-500' :\n                                  category === 'nature' ? 'from-green-500 to-emerald-500' :\n                                  category === 'sightseeing' ? 'from-blue-500 to-cyan-500' :\n                                  category === 'shopping' ? 'from-pink-500 to-rose-500' :\n                                  category === 'nightlife' ? 'from-purple-600 to-indigo-600' :\n                                  category === 'wellness' ? 'from-teal-500 to-cyan-500' :\n                                  'from-gray-500 to-slate-500'\n                      };\n                    };\n\n                    const priorityConfig = getPriorityConfig(activity.priority);\n                    const categoryConfig = getCategoryConfig(activity.category);\n                    const time = formatTime(activity.date_time);\n\n                    return (\n                      <motion.div\n                        key={activity.id}\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        transition={{ duration: 0.4, delay: activityIndex * 0.1 }}\n                        className=\"group\"\n                      >\n                        <Card className=\"overflow-hidden hover:shadow-lg transition-all duration-300 bg-white border-slate-200/60 hover:border-blue-400\">\n                          <div className=\"relative\">\n                            {/* Priority Stripe */}\n                            <div className={`absolute top-0 left-0 w-full h-1 bg-gradient-to-r ${priorityConfig.gradient}`}></div>\n                            \n                            {/* Category Icon */}\n                            <div className=\"absolute top-3 left-3\">\n                              <div className={`w-10 h-10 bg-gradient-to-br ${categoryConfig.gradient} rounded-lg shadow-md flex items-center justify-center text-white text-lg`}>\n                                {categoryConfig.icon}\n                              </div>\n                            </div>\n\n                            {/* Priority Badge */}\n                            <div className=\"absolute top-3 right-3\">\n                              <Badge className={`${priorityConfig.color} border-0 text-xs font-medium`}>\n                                {activity.priority === 'high' ? 'Alta Prioridade' : \n                                 activity.priority === 'medium' ? 'M√©dia Prioridade' : 'Baixa Prioridade'}\n                              </Badge>\n                            </div>\n\n                            {/* Main Content */}\n                            <div className=\"p-6 pt-16\">\n                              <div className=\"flex items-start justify-between mb-3\">\n                                <div className=\"flex-1\">\n                                  <h3 className=\"font-bold text-lg text-[#1B2B49] mb-2 group-hover:text-blue-600 transition-colors\">\n                                    {activity.title}\n                                  </h3>\n                                  \n                                  {/* Time and Duration */}\n                                  <div className=\"flex items-center gap-4 mb-3\">\n                                    {time && (\n                                      <div className=\"flex items-center gap-2 text-sm text-blue-600 bg-blue-50 px-3 py-1 rounded-full\">\n                                        <Clock className=\"h-4 w-4\" />\n                                        {time}\n                                      </div>\n                                    )}\n                                    {activity.duration && (\n                                      <div className=\"flex items-center gap-2 text-sm text-gray-600\">\n                                        <Clock className=\"h-4 w-4\" />\n                                        {activity.duration}\n                                      </div>\n                                    )}\n                                  </div>\n\n                                  {/* Description */}\n                                  {activity.description && (\n                                    <p className=\"text-[#AAB0B7] text-sm mb-4 line-clamp-2\">\n                                      {activity.description}\n                                    </p>\n                                  )}\n                                </div>\n\n                                {/* Action Buttons */}\n                                <div className=\"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-all duration-200\">\n                                  <Button\n                                    variant=\"ghost\"\n                                    size=\"sm\"\n                                    onClick={() => onEdit(activity)}\n                                    className=\"h-8 w-8 p-0 hover:bg-blue-50 hover:text-blue-600 rounded-full\"\n                                  >\n                                    <Edit2 className=\"h-4 w-4\" />\n                                  </Button>\n                                  <Button\n                                    variant=\"ghost\"\n                                    size=\"sm\"\n                                    onClick={() => onDelete(activity.id)}\n                                    className=\"h-8 w-8 p-0 hover:bg-red-50 hover:text-red-600 rounded-full\"\n                                  >\n                                    <Trash2 className=\"h-4 w-4\" />\n                                  </Button>\n                                </div>\n                              </div>\n\n                              {/* Info Grid */}\n                              <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-4\">\n                                {activity.location && (\n                                  <div className=\"flex items-center gap-2 text-xs text-slate-600 bg-[#F5F9FC] px-3 py-2 rounded-lg\">\n                                    <MapPin className=\"h-4 w-4 text-blue-600 flex-shrink-0\" />\n                                    <span className=\"truncate font-medium\">{activity.location}</span>\n                                  </div>\n                                )}\n\n                                {activity.estimated_cost && activity.estimated_cost > 0 && (\n                                  <div className=\"flex items-center gap-2 text-xs text-blue-600 bg-blue-50 px-3 py-2 rounded-lg border border-blue-200\">\n                                    <DollarSign className=\"h-4 w-4 flex-shrink-0\" />\n                                    <span className=\"font-bold\">R$ {activity.estimated_cost.toLocaleString('pt-BR')}</span>\n                                  </div>\n                                )}\n\n                                <div className=\"flex items-center gap-2 text-xs text-slate-600 bg-[#F5F9FC] px-3 py-2 rounded-lg\">\n                                  <Badge variant=\"outline\" className=\"text-xs border-[#AAB0B7]/30\">\n                                    {categoryConfig.label}\n                                  </Badge>\n                                </div>\n                              </div>\n\n                              {/* Notes Section */}\n                              {activity.notes && (\n                                <div className=\"bg-blue-50 border border-blue-100 rounded-lg p-3\">\n                                  <div className=\"flex items-start gap-2\">\n                                    <FileText className=\"h-4 w-4 text-blue-500 flex-shrink-0 mt-0.5\" />\n                                    <p className=\"text-sm text-blue-700 leading-relaxed\">{activity.notes}</p>\n                                  </div>\n                                </div>\n                              )}\n                            </div>\n                          </div>\n                        </Card>\n                      </motion.div>\n                    );\n                  })}\n              </div>\n            </motion.div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n\n\n\n// Legacy Sortable Activity Item (for backward compatibility)\nfunction SortableActivityItem({ \n  activity, \n  onEdit, \n  onDelete \n}: {\n  activity: PlannedActivity;\n  onEdit: (activity: PlannedActivity) => void;\n  onDelete: (id: string) => void;\n}) {\n  const {\n    attributes,\n    listeners,\n    setNodeRef,\n    transform,\n    transition,\n    isDragging\n  } = useSortable({ id: activity.id });\n\n  const style = {\n    transform: CSS.Transform.toString(transform),\n    transition,\n    opacity: isDragging ? 0.5 : 1,\n  };\n\n  return (\n    <motion.div\n      ref={setNodeRef}\n      style={style}\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      exit={{ opacity: 0, y: -20 }}\n      className=\"group\"\n    >\n      <Card className=\"border-2 border-gray-200 hover:border-primary/50 transition-all duration-200 hover:shadow-md\">\n        <CardContent className=\"p-4\">\n          <div className=\"flex items-start gap-3\">\n            <div {...attributes} {...listeners} className=\"cursor-grab active:cursor-grabbing\">\n              <GripVertical className=\"h-5 w-5 text-gray-400 group-hover:text-primary transition-colors\" />\n            </div>\n            \n            <div className=\"flex-1 min-w-0\">\n              <div className=\"flex items-start justify-between gap-2\">\n                <div className=\"flex-1\">\n                  <h4 className=\"font-semibold text-gray-900 truncate\">{activity.title}</h4>\n                  {activity.description && (\n                    <p className=\"text-sm text-gray-600 mt-1 line-clamp-2\">{activity.description}</p>\n                  )}\n                </div>\n                \n                <div className=\"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n                  <Button \n                    variant=\"ghost\" \n                    size=\"sm\"\n                    onClick={() => onEdit(activity)}\n                    className=\"h-8 w-8 p-0 hover:bg-blue-50 hover:text-blue-600\"\n                  >\n                    <Edit2 className=\"h-4 w-4\" />\n                  </Button>\n                  <Button \n                    variant=\"ghost\" \n                    size=\"sm\"\n                    onClick={() => onDelete(activity.id)}\n                    className=\"h-8 w-8 p-0 hover:bg-red-50 hover:text-red-600\"\n                  >\n                    <Trash2 className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center gap-4 mt-3\">\n                <Badge \n                  variant=\"outline\" \n                  className={`text-xs ${priorityColors[activity.priority]}`}\n                >\n                  {activity.priority === 'high' ? 'Alta' : activity.priority === 'medium' ? 'M√©dia' : 'Baixa'}\n                </Badge>\n                \n                <span className=\"text-xs text-gray-500 flex items-center gap-1\">\n                  <Target className=\"h-3 w-3\" />\n                  {activityCategories[activity.category as keyof typeof activityCategories]?.label}\n                </span>\n                \n                {activity.estimated_cost && (\n                  <span className=\"text-xs text-gray-500 flex items-center gap-1\">\n                    <DollarSign className=\"h-3 w-3\" />\n                    R$ {activity.estimated_cost.toLocaleString('pt-BR')}\n                  </span>\n                )}\n                \n                {activity.duration && (\n                  <span className=\"text-xs text-gray-500 flex items-center gap-1\">\n                    <Clock className=\"h-3 w-3\" />\n                    {activity.duration}\n                  </span>\n                )}\n                \n                {activity.location && (\n                  <span className=\"text-xs text-gray-500 flex items-center gap-1\">\n                    <MapPin className=\"h-3 w-3\" />\n                    {activity.location}\n                  </span>\n                )}\n              </div>\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n}\n\n// Activity Management Dialog with Search and Manual Creation\nfunction ActivityManagementDialog({ \n  activity, \n  isOpen, \n  onClose, \n  onSave,\n  tripDestination,\n  tripParticipants = 1,\n  tripMaxParticipants,\n  tripStartDate,\n  tripEndDate\n}: {\n  activity?: PlannedActivity;\n  isOpen: boolean;\n  onClose: () => void;\n  onSave: (activity: PlannedActivity) => void;\n  tripDestination?: string;\n  tripParticipants?: number;\n  tripMaxParticipants?: number;\n  tripStartDate?: string;\n  tripEndDate?: string;\n}) {\n  const [activeTab, setActiveTab] = useState(activity ? \"manual\" : \"search\");\n  \n  // Se est√° editando uma atividade existente, mostrar apenas o formul√°rio de edi√ß√£o\n  if (activity) {\n    return (\n      <Dialog open={isOpen} onOpenChange={onClose}>\n        <DialogContent className=\"w-[95vw] max-w-3xl max-h-[95vh] overflow-y-auto\" aria-describedby=\"activity-dialog-description\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center gap-2\">\n              <Edit2 className=\"h-5 w-5\" />\n              Editar Atividade\n            </DialogTitle>\n            <p id=\"activity-dialog-description\" className=\"sr-only\">\n              Formul√°rio para editar informa√ß√µes da atividade existente\n            </p>\n          </DialogHeader>\n          \n          <EditActivityForm \n            activity={activity} \n            onSave={onSave} \n            onClose={onClose}\n            tripStartDate={tripStartDate}\n            tripEndDate={tripEndDate}\n          />\n        </DialogContent>\n      </Dialog>\n    );\n  }\n  \n  // Para adicionar nova atividade, mostrar as abas de busca e cria√ß√£o manual\n  return (\n    <Dialog open={isOpen} onOpenChange={onClose}>\n      <DialogContent className=\"w-[95vw] max-w-5xl max-h-[95vh] overflow-y-auto\" aria-describedby=\"activity-dialog-description\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Target className=\"h-5 w-5\" />\n            Adicionar Atividade\n          </DialogTitle>\n          <p id=\"activity-dialog-description\" className=\"sr-only\">\n            Formul√°rio para adicionar uma nova atividade √† viagem\n          </p>\n        </DialogHeader>\n        \n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2\">\n            <TabsTrigger value=\"search\" className=\"flex items-center gap-2\">\n              <Search className=\"h-4 w-4\" />\n              Buscar Atividades\n            </TabsTrigger>\n            <TabsTrigger value=\"manual\" className=\"flex items-center gap-2\">\n              <Plus className=\"h-4 w-4\" />\n              Criar Manual\n            </TabsTrigger>\n          </TabsList>\n          \n          <TabsContent value=\"search\" className=\"space-y-4\">\n            <ActivitySearchTab \n              onSave={onSave} \n              onClose={onClose} \n              tripDestination={tripDestination}\n              tripParticipants={tripParticipants}\n              tripMaxParticipants={tripMaxParticipants}\n              tripStartDate={tripStartDate}\n              tripEndDate={tripEndDate}\n            />\n          </TabsContent>\n          \n          <TabsContent value=\"manual\" className=\"space-y-4\">\n            <ActivityFormTab \n              activity={activity} \n              onSave={onSave} \n              onClose={onClose}\n              tripStartDate={tripStartDate}\n              tripEndDate={tripEndDate}\n            />\n          </TabsContent>\n        </Tabs>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\n// Activity Search Tab\nfunction ActivitySearchTab({ \n  onSave, \n  onClose, \n  tripDestination,\n  tripParticipants = 1,\n  tripMaxParticipants,\n  tripStartDate,\n  tripEndDate\n}: { \n  onSave: (activity: PlannedActivity) => void; \n  onClose: () => void;\n  tripDestination?: string;\n  tripParticipants?: number;\n  tripMaxParticipants?: number;\n  tripStartDate?: string;\n  tripEndDate?: string;\n}) {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [selectedCategory, setSelectedCategory] = useState<string>(\"all\");\n  const [selectedActivity, setSelectedActivity] = useState<any>(null);\n  const [selectedDate, setSelectedDate] = useState<string>(\"\");\n  \n  // Use max participants for cost estimation (planning for full trip capacity)\n  const participants = tripMaxParticipants || tripParticipants;\n\n  // Query for activities by trip destination (shown by default)\n  const { data: destinationActivities, isLoading: isLoadingDestination } = useQuery({\n    queryKey: ['/api/activities', { \n      location: tripDestination,\n      sortBy: 'rating',\n      category: selectedCategory === 'all' ? '' : selectedCategory,\n    }],\n    queryFn: async () => {\n      const params = new URLSearchParams();\n      params.set('location', tripDestination || '');\n      params.set('sortBy', 'rating');\n      if (selectedCategory !== 'all' && selectedCategory) {\n        params.set('category', selectedCategory);\n      }\n      \n      const response = await fetch(`/api/activities?${params}`);\n      if (!response.ok) throw new Error('Failed to fetch destination activities');\n      return response.json();\n    },\n    enabled: searchTerm.length <= 2 && !!tripDestination,\n  });\n\n  // Fallback to popular activities if no destination\n  const { data: popularActivities, isLoading: isLoadingPopular } = useQuery({\n    queryKey: ['/api/activities', { \n      sortBy: 'rating',\n      category: selectedCategory === 'all' ? '' : selectedCategory,\n    }],\n    queryFn: async () => {\n      const params = new URLSearchParams();\n      params.set('sortBy', 'rating');\n      if (selectedCategory !== 'all' && selectedCategory) {\n        params.set('category', selectedCategory);\n      }\n      \n      const response = await fetch(`/api/activities?${params}`);\n      if (!response.ok) throw new Error('Failed to fetch popular activities');\n      return response.json();\n    },\n    enabled: searchTerm.length <= 2 && !tripDestination,\n  });\n\n  // Query for search results\n  const { data: searchResults, isLoading: isLoadingSearch } = useQuery({\n    queryKey: ['/api/activities', { \n      search: searchTerm, \n      location: tripDestination,\n      category: selectedCategory === 'all' ? '' : selectedCategory,\n    }],\n    queryFn: async () => {\n      const params = new URLSearchParams();\n      params.set('search', searchTerm);\n      if (tripDestination) {\n        params.set('location', tripDestination);\n      }\n      if (selectedCategory !== 'all' && selectedCategory) {\n        params.set('category', selectedCategory);\n      }\n      \n      const response = await fetch(`/api/activities?${params}`);\n      if (!response.ok) throw new Error('Failed to search activities');\n      return response.json();\n    },\n    enabled: searchTerm.length > 2,\n  });\n\n  const activities = searchTerm.length > 2 \n    ? searchResults \n    : (tripDestination ? destinationActivities : popularActivities);\n  \n  const isLoading = searchTerm.length > 2 \n    ? isLoadingSearch \n    : (tripDestination ? isLoadingDestination : isLoadingPopular);\n\n  const handleAddToTrip = () => {\n    if (!selectedActivity) return;\n\n    const estimatedCost = selectedActivity.priceAmount ? selectedActivity.priceAmount * participants : 0;\n\n    const newActivity: PlannedActivity = {\n      id: Date.now().toString(),\n      title: selectedActivity.title,\n      description: selectedActivity.description,\n      category: selectedActivity.category as PlannedActivity['category'],\n      location: selectedActivity.location,\n      estimated_cost: estimatedCost,\n      duration: selectedActivity.duration || \"A definir\",\n      priority: \"medium\" as PlannedActivity['priority'],\n      attachments: [],\n      urls: [],\n      notes: `Atividade encontrada na busca\\nPre√ßo original: R$ ${selectedActivity.priceAmount || 0}\\nParticipantes: ${participants}`,\n      date_time: selectedDate || undefined,\n      status: \"planned\" as PlannedActivity['status']\n    };\n\n    onSave(newActivity);\n    onClose();\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      {/* Search Controls */}\n      <div className=\"flex gap-3\">\n        <div className=\"flex-1\">\n          <Input\n            placeholder=\"Buscar atividades... (m√≠nimo 3 caracteres)\"\n            value={searchTerm}\n            onChange={(e) => setSearchTerm(e.target.value)}\n            className=\"w-full\"\n          />\n        </div>\n        <Select value={selectedCategory} onValueChange={setSelectedCategory}>\n          <SelectTrigger className=\"w-48\">\n            <SelectValue placeholder=\"Categoria\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"all\">Todas as categorias</SelectItem>\n            {Object.entries(activityCategories).map(([value, config]) => (\n              <SelectItem key={value} value={value}>{config.label}</SelectItem>\n            ))}\n          </SelectContent>\n        </Select>\n      </div>\n\n      {/* Activities Results */}\n      <div className=\"border rounded-lg p-4 max-h-96 overflow-y-auto\">\n        {/* Header */}\n        <div className=\"mb-4\">\n          <h3 className=\"font-semibold text-gray-900\">\n            {searchTerm.length > 2 \n              ? `Resultados para \"${searchTerm}\"` \n              : tripDestination \n                ? `Melhores Atividades em ${tripDestination}`\n                : 'Atividades Populares'\n            }\n          </h3>\n          <p className=\"text-sm text-gray-600\">\n            {searchTerm.length > 2 \n              ? 'Selecione uma atividade encontrada' \n              : tripDestination\n                ? `As atividades mais escolhidas e bem avaliadas em ${tripDestination}`\n                : 'Escolha entre as atividades mais procuradas'\n            }\n          </p>\n        </div>\n\n        {isLoading ? (\n          <div className=\"text-center py-8\">\n            <div className=\"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n            <p className=\"mt-2 text-gray-600\">\n              {searchTerm.length > 2 ? 'Buscando atividades...' : 'Carregando atividades populares...'}\n            </p>\n          </div>\n        ) : activities?.length === 0 ? (\n          <div className=\"text-center py-8 text-gray-500\">\n            <Search className=\"h-12 w-12 mx-auto mb-2 text-gray-400\" />\n            <p>\n              {searchTerm.length > 2 \n                ? `Nenhuma atividade encontrada para \"${searchTerm}\"`\n                : tripDestination\n                  ? `Nenhuma atividade encontrada em ${tripDestination}`\n                  : 'Nenhuma atividade dispon√≠vel'\n              }\n            </p>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            {activities?.slice(0, 10).map((activity: any) => (\n              <Card \n                key={activity.id} \n                className={`cursor-pointer transition-all ${\n                  selectedActivity?.id === activity.id \n                    ? 'ring-2 ring-primary bg-primary/5' \n                    : 'hover:bg-gray-50'\n                }`}\n                onClick={() => setSelectedActivity(activity)}\n              >\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-start gap-3\">\n                    <div className=\"flex-shrink-0 w-16 h-16 bg-gray-200 rounded-lg flex items-center justify-center\">\n                      <Camera className=\"h-6 w-6 text-gray-500\" />\n                    </div>\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-start justify-between\">\n                        <div>\n                          <h4 className=\"font-semibold text-gray-900 truncate\">{activity.title}</h4>\n                          <p className=\"text-sm text-gray-600 line-clamp-2 mt-1\">{activity.description}</p>\n                        </div>\n                        {activity.priceAmount && (\n                          <div className=\"text-right ml-4\">\n                            <p className=\"font-semibold text-primary\">R$ {activity.priceAmount}</p>\n                            <p className=\"text-xs text-gray-500\">por pessoa</p>\n                          </div>\n                        )}\n                      </div>\n                      <div className=\"flex items-center gap-4 mt-3 text-xs text-gray-500\">\n                        <span className=\"flex items-center gap-1\">\n                          <MapPin className=\"h-3 w-3\" />\n                          {activity.location}\n                        </span>\n                        <span className=\"flex items-center gap-1\">\n                          <Star className=\"h-3 w-3 fill-yellow-400 text-yellow-400\" />\n                          {activity.averageRating || 0} ({activity.totalRatings || 0})\n                        </span>\n                        <Badge variant=\"outline\" className=\"text-xs\">\n                          {activityCategories[activity.category as keyof typeof activityCategories]?.label}\n                        </Badge>\n                      </div>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Selected Activity Details */}\n      {selectedActivity && (\n        <div className=\"border-t pt-4\">\n          <h3 className=\"font-semibold mb-3\">Detalhes da Atividade Selecionada</h3>\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4\">\n            <div>\n              <Label>Participantes da Viagem</Label>\n              <div className=\"mt-1 p-2 bg-blue-50 rounded border border-blue-200\">\n                <div className=\"flex items-center gap-2\">\n                  <Users className=\"h-4 w-4 text-blue-600\" />\n                  <span className=\"font-semibold text-blue-800\">\n                    {participants} {participants === 1 ? 'participante' : 'participantes'}\n                  </span>\n                </div>\n                <p className=\"text-xs text-blue-600 mt-1\">\n                  Calculado automaticamente baseado na viagem\n                </p>\n              </div>\n            </div>\n            <div>\n              <Label>Custo Total Estimado</Label>\n              <div className=\"mt-1 p-2 bg-green-50 rounded border border-green-200\">\n                <div className=\"flex items-center gap-2\">\n                  <DollarSign className=\"h-4 w-4 text-green-600\" />\n                  <span className=\"font-semibold text-green-800\">\n                    R$ {((selectedActivity.priceAmount || 0) * participants).toLocaleString('pt-BR')}\n                  </span>\n                </div>\n                <p className=\"text-xs text-green-600 mt-1\">\n                  R$ {(selectedActivity.priceAmount || 0).toLocaleString('pt-BR')} √ó {participants} {participants === 1 ? 'pessoa' : 'pessoas'}\n                </p>\n              </div>\n            </div>\n            <div>\n              <Label htmlFor=\"activityDate\">Data da Atividade</Label>\n              <Input\n                id=\"activityDate\"\n                type=\"date\"\n                value={selectedDate}\n                onChange={(e) => setSelectedDate(e.target.value)}\n                min={tripStartDate ? formatDateForInput(tripStartDate) : undefined}\n                max={tripEndDate ? formatDateForInput(tripEndDate) : undefined}\n                className=\"mt-1\"\n              />\n              {tripStartDate && tripEndDate && (\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  Entre {new Date(tripStartDate).toLocaleDateString('pt-BR')} e {new Date(tripEndDate).toLocaleDateString('pt-BR')}\n                </p>\n              )}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Action Buttons */}\n      <div className=\"flex justify-end gap-2 border-t pt-4\">\n        <Button variant=\"outline\" onClick={onClose}>\n          Cancelar\n        </Button>\n        <Button \n          onClick={handleAddToTrip}\n          disabled={!selectedActivity}\n          className=\"bg-primary hover:bg-primary/90\"\n        >\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Adicionar √† Viagem\n        </Button>\n      </div>\n    </div>\n  );\n}\n\n// Helper function to convert date to YYYY-MM-DD format without timezone issues\nfunction formatDateForInput(dateString: string): string {\n  const date = new Date(dateString);\n  // Ensure we get the correct local date regardless of timezone\n  const year = date.getFullYear();\n  const month = String(date.getMonth() + 1).padStart(2, '0');\n  const day = String(date.getDate()).padStart(2, '0');\n  return `${year}-${month}-${day}`;\n}\n\n// Activity Form Tab\nfunction ActivityFormTab({ \n  activity, \n  onSave, \n  onClose,\n  tripStartDate,\n  tripEndDate\n}: {\n  activity?: PlannedActivity;\n  onSave: (activity: PlannedActivity) => void;\n  onClose: () => void;\n  tripStartDate?: string;\n  tripEndDate?: string;\n}) {\n  const [formData, setFormData] = useState<Partial<PlannedActivity>>(\n    activity || {\n      title: '',\n      description: '',\n      category: 'sightseeing',\n      priority: 'medium',\n      estimated_cost: 0,\n      duration: '',\n      location: '',\n      urls: [],\n      attachments: [],\n      notes: '',\n      date_time: ''\n    }\n  );\n\n  const [newLink, setNewLink] = useState('');\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const handleSave = () => {\n    if (!formData.title) return;\n\n    const savedActivity: PlannedActivity = {\n      id: activity?.id || Date.now().toString(),\n      title: formData.title,\n      description: formData.description,\n      category: formData.category as PlannedActivity['category'],\n      priority: formData.priority as PlannedActivity['priority'],\n      estimated_cost: formData.estimated_cost,\n      duration: formData.duration,\n      location: formData.location,\n      urls: formData.urls || [],\n      attachments: formData.attachments || [],\n      notes: formData.notes,\n      date_time: formData.date_time,\n      status: \"planned\",\n      created_at: activity?.created_at || new Date().toISOString(),\n    };\n\n    onSave(savedActivity);\n    onClose();\n  };\n\n  const addLink = () => {\n    if (newLink.trim()) {\n      setFormData(prev => ({\n        ...prev,\n        urls: [...(prev.urls || []), newLink.trim()]\n      }));\n      setNewLink('');\n    }\n  };\n\n  const removeLink = (index: number) => {\n    setFormData(prev => ({\n      ...prev,\n      urls: prev.urls?.filter((_, i) => i !== index) || []\n    }));\n  };\n\n  const handleFileUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const files = event.target.files;\n    if (files) {\n      Array.from(files).forEach(file => {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n          const attachment = {\n            name: file.name,\n            url: e.target?.result as string,\n            type: file.type.startsWith('image/') ? 'image' : \n                  file.type.startsWith('video/') ? 'video' :\n                  file.type.includes('pdf') || file.type.includes('doc') ? 'document' : 'other'\n          };\n          \n          setFormData(prev => ({\n            ...prev,\n            attachments: [...(prev.attachments || []), attachment]\n          }));\n        };\n        reader.readAsDataURL(file);\n      });\n    }\n  };\n\n  const removeAttachment = (index: number) => {\n    setFormData(prev => ({\n      ...prev,\n      attachments: prev.attachments?.filter((_, i) => i !== index) || []\n    }));\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Basic Info */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"title\">T√≠tulo *</Label>\n          <Input\n            id=\"title\"\n            value={formData.title || ''}\n            onChange={(e) => setFormData(prev => ({ ...prev, title: e.target.value }))}\n            placeholder=\"Ex: Visitar Cristo Redentor\"\n            className=\"border-2 focus:border-primary transition-colors duration-200 focus:ring-2 focus:ring-primary/20\"\n          />\n        </div>\n        \n        <div className=\"space-y-2\">\n          <Label htmlFor=\"category\">Categoria</Label>\n          <Select value={formData.category} onValueChange={(value) => setFormData(prev => ({ ...prev, category: value as any }))}>\n            <SelectTrigger>\n              <SelectValue placeholder=\"Selecione uma categoria\" />\n            </SelectTrigger>\n            <SelectContent>\n              {Object.entries(activityCategories).map(([value, config]) => (\n                <SelectItem key={value} value={value}>\n                  {config.icon} {config.label}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"estimatedCost\">Custo Estimado (R$)</Label>\n          <Input\n            id=\"estimatedCost\"\n            type=\"number\"\n            step=\"0.01\"\n            min=\"0\"\n            value={formData.estimated_cost || ''}\n            onChange={(e) => {\n              const value = parseFloat(e.target.value) || 0;\n              setFormData(prev => ({ ...prev, estimated_cost: value }));\n            }}\n            placeholder=\"0.00\"\n            className=\"border-2 focus:border-primary transition-colors duration-200 focus:ring-2 focus:ring-primary/20\"\n          />\n        </div>\n\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"priority\">Prioridade</Label>\n          <Select value={formData.priority} onValueChange={(value) => setFormData(prev => ({ ...prev, priority: value as any }))}>\n            <SelectTrigger>\n              <SelectValue placeholder=\"Selecione a prioridade\" />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"high\">üî¥ Alta</SelectItem>\n              <SelectItem value=\"medium\">üü° M√©dia</SelectItem>\n              <SelectItem value=\"low\">üü¢ Baixa</SelectItem>\n            </SelectContent>\n          </Select>\n        </div>\n\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"duration\">Dura√ß√£o</Label>\n          <Input\n            id=\"duration\"\n            value={formData.duration || ''}\n            onChange={(e) => setFormData(prev => ({ ...prev, duration: e.target.value }))}\n            placeholder=\"Ex: 2-3 horas\"\n            className=\"border-2 focus:border-primary transition-colors duration-200 focus:ring-2 focus:ring-primary/20\"\n          />\n        </div>\n\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"location\">Local</Label>\n          <Input\n            id=\"location\"\n            value={formData.location || ''}\n            onChange={(e) => setFormData(prev => ({ ...prev, location: e.target.value }))}\n            placeholder=\"Ex: Corcovado, Rio de Janeiro\"\n            className=\"border-2 focus:border-primary transition-colors duration-200 focus:ring-2 focus:ring-primary/20\"\n          />\n        </div>\n\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"dateTime\">Data da Atividade</Label>\n          <Input\n            id=\"dateTime\"\n            type=\"date\"\n            value={formData.dateTime ? formData.dateTime.split('T')[0] : ''}\n            onChange={(e) => {\n              const currentTime = formData.dateTime && formData.dateTime.includes('T') \n                ? formData.dateTime.split('T')[1] \n                : '';\n              const newDateTime = currentTime ? `${e.target.value}T${currentTime}` : e.target.value;\n              setFormData(prev => ({ ...prev, dateTime: newDateTime }));\n            }}\n            min={tripStartDate ? formatDateForInput(tripStartDate) : undefined}\n            max={tripEndDate ? formatDateForInput(tripEndDate) : undefined}\n            className=\"border-2 focus:border-primary transition-colors\"\n          />\n          {tripStartDate && tripEndDate && (\n            <p className=\"text-xs text-gray-500\">\n              Entre {new Date(tripStartDate).toLocaleDateString('pt-BR')} e {new Date(tripEndDate).toLocaleDateString('pt-BR')}\n            </p>\n          )}\n        </div>\n\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"time\">Hor√°rio (opcional)</Label>\n          <Input\n            id=\"time\"\n            type=\"time\"\n            value={formData.dateTime && formData.dateTime.includes('T') ? formData.dateTime.split('T')[1]?.split('.')[0] : ''}\n            onChange={(e) => {\n              const date = formData.dateTime ? formData.dateTime.split('T')[0] : '';\n              if (date && e.target.value) {\n                setFormData(prev => ({ ...prev, dateTime: `${date}T${e.target.value}` }));\n              } else if (date) {\n                setFormData(prev => ({ ...prev, dateTime: date }));\n              }\n            }}\n            className=\"border-2 focus:border-primary transition-colors\"\n          />\n        </div>\n      </div>\n\n      {/* Description */}\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"description\">Descri√ß√£o</Label>\n        <Textarea\n          id=\"description\"\n          value={formData.description || ''}\n          onChange={(e) => setFormData(prev => ({ ...prev, description: e.target.value }))}\n          placeholder=\"Descreva os detalhes da atividade...\"\n          rows={3}\n          className=\"border-2 focus:border-primary transition-colors duration-200 focus:ring-2 focus:ring-primary/20 resize-none\"\n        />\n      </div>\n\n      {/* Links */}\n      <div className=\"space-y-2\">\n        <Label>Links √öteis</Label>\n        <div className=\"flex gap-2\">\n          <Input\n            value={newLink}\n            onChange={(e) => setNewLink(e.target.value)}\n            placeholder=\"https://exemplo.com\"\n            className=\"flex-1 border-2 focus:border-primary transition-colors duration-200 focus:ring-2 focus:ring-primary/20\"\n          />\n          <Button onClick={addLink} variant=\"outline\">\n            <Plus className=\"h-4 w-4\" />\n          </Button>\n        </div>\n        {formData.urls && formData.urls.length > 0 && (\n          <div className=\"space-y-2\">\n            {formData.urls.map((url, index) => (\n              <div key={index} className=\"flex items-center gap-2 p-2 bg-gray-50 rounded\">\n                <a href={url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-600 hover:underline flex-1 truncate\">\n                  {url}\n                </a>\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  onClick={() => removeLink(index)}\n                  className=\"h-6 w-6 p-0 text-red-500 hover:text-red-700\"\n                >\n                  <Trash2 className=\"h-3 w-3\" />\n                </Button>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* File Attachments */}\n      <div className=\"space-y-2\">\n        <Label>Anexos</Label>\n        <input\n          ref={fileInputRef}\n          type=\"file\"\n          multiple\n          accept=\"image/*,video/*,.pdf,.doc,.docx\"\n          onChange={handleFileUpload}\n          className=\"hidden\"\n        />\n        <Button\n          variant=\"outline\"\n          onClick={() => fileInputRef.current?.click()}\n          className=\"w-full border-2 border-dashed\"\n        >\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Adicionar Arquivos\n        </Button>\n        {formData.attachments && formData.attachments.length > 0 && (\n          <div className=\"grid grid-cols-2 gap-2\">\n            {formData.attachments.map((attachment, index) => (\n              <div key={index} className=\"relative group\">\n                <div className=\"p-3 bg-gray-50 rounded border\">\n                  <div className=\"flex items-center gap-2\">\n                    <FileText className=\"h-4 w-4 text-gray-500\" />\n                    <span className=\"text-sm truncate\">{attachment.name}</span>\n                  </div>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={() => removeAttachment(index)}\n                    className=\"absolute top-1 right-1 h-6 w-6 p-0 text-red-500 hover:text-red-700 opacity-0 group-hover:opacity-100\"\n                  >\n                    <Trash2 className=\"h-3 w-3\" />\n                  </Button>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Notes */}\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"notes\">Observa√ß√µes</Label>\n        <Textarea\n          id=\"notes\"\n          value={formData.notes || ''}\n          onChange={(e) => setFormData(prev => ({ ...prev, notes: e.target.value }))}\n          placeholder=\"Observa√ß√µes adicionais...\"\n          rows={2}\n          className=\"border-2 focus:border-primary transition-colors duration-200 focus:ring-2 focus:ring-primary/20 resize-none\"\n        />\n      </div>\n\n      {/* Action Buttons */}\n      <div className=\"flex justify-end gap-2 border-t pt-4\">\n        <Button variant=\"outline\" onClick={onClose}>\n          Cancelar\n        </Button>\n        <Button \n          onClick={handleSave}\n          disabled={!formData.title}\n          className=\"bg-primary hover:bg-primary/90\"\n        >\n          {activity ? 'Salvar Altera√ß√µes' : 'Adicionar Atividade'}\n        </Button>\n      </div>\n    </div>\n  );\n}\n\n// Edit Activity Form - Simplified form for editing existing activities\nfunction EditActivityForm({ \n  activity, \n  onSave, \n  onClose,\n  tripStartDate,\n  tripEndDate\n}: {\n  activity: PlannedActivity;\n  onSave: (activity: PlannedActivity) => void;\n  onClose: () => void;\n  tripStartDate?: string;\n  tripEndDate?: string;\n}) {\n  const [formData, setFormData] = useState({\n    estimated_cost: activity.estimated_cost || 0,\n    date_time: activity.date_time || '',\n    notes: activity.notes || '',\n    priority: activity.priority || 'medium',\n    duration: activity.duration || '',\n    location: activity.location || ''\n  });\n\n  const handleSave = () => {\n    const updatedActivity: PlannedActivity = {\n      ...activity,\n      estimated_cost: formData.estimated_cost,\n      date_time: formData.date_time,\n      notes: formData.notes,\n      priority: formData.priority as PlannedActivity['priority'],\n      duration: formData.duration,\n      location: formData.location\n    };\n\n    onSave(updatedActivity);\n    onClose();\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Activity Info (Read-Only) */}\n      <div className=\"bg-gray-50 rounded-lg p-4 border\">\n        <h3 className=\"font-semibold text-gray-900 mb-2\">{activity.title}</h3>\n        {activity.description && (\n          <p className=\"text-sm text-gray-600 mb-2\">{activity.description}</p>\n        )}\n        <div className=\"flex items-center gap-4 text-sm text-gray-500\">\n          <Badge variant=\"outline\">{activityCategories[activity.category as keyof typeof activityCategories]?.label}</Badge>\n          <span>Status: {activity.status}</span>\n        </div>\n      </div>\n\n      {/* Editable Fields */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"cost\">Custo Estimado (R$)</Label>\n          <Input\n            id=\"cost\"\n            type=\"number\"\n            step=\"0.01\"\n            min=\"0\"\n            value={formData.estimatedCost || ''}\n            onChange={(e) => {\n              const value = parseFloat(e.target.value) || 0;\n              setFormData(prev => ({ ...prev, estimatedCost: value }));\n            }}\n            placeholder=\"0.00\"\n            className=\"border-2 focus:border-primary transition-colors duration-200 focus:ring-2 focus:ring-primary/20\"\n          />\n        </div>\n        \n        <div className=\"space-y-2\">\n          <Label htmlFor=\"priority\">Prioridade</Label>\n          <Select value={formData.priority} onValueChange={(value) => setFormData(prev => ({ ...prev, priority: value }))}>\n            <SelectTrigger>\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"high\">Alta</SelectItem>\n              <SelectItem value=\"medium\">M√©dia</SelectItem>\n              <SelectItem value=\"low\">Baixa</SelectItem>\n            </SelectContent>\n          </Select>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4\">\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"duration\">Dura√ß√£o</Label>\n          <Input\n            id=\"duration\"\n            value={formData.duration}\n            onChange={(e) => setFormData(prev => ({ ...prev, duration: e.target.value }))}\n            placeholder=\"Ex: 2 horas, meio dia\"\n            className=\"border-2 focus:border-primary\"\n          />\n        </div>\n        \n        <div className=\"space-y-2\">\n          <Label htmlFor=\"location\">Localiza√ß√£o</Label>\n          <Input\n            id=\"location\"\n            value={formData.location}\n            onChange={(e) => setFormData(prev => ({ ...prev, location: e.target.value }))}\n            placeholder=\"Ex: Centro da cidade\"\n            className=\"border-2 focus:border-primary\"\n          />\n        </div>\n      </div>\n\n      {/* Date and Time */}\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"datetime\">Data e Hora</Label>\n        <Input\n          id=\"datetime\"\n          type=\"datetime-local\"\n          value={formData.dateTime}\n          onChange={(e) => setFormData(prev => ({ ...prev, dateTime: e.target.value }))}\n          min={tripStartDate ? new Date(tripStartDate).toISOString().slice(0, 16) : undefined}\n          max={tripEndDate ? new Date(tripEndDate).toISOString().slice(0, 16) : undefined}\n          className=\"border-2 focus:border-primary transition-colors\"\n        />\n        {tripStartDate && tripEndDate && (\n          <p className=\"text-xs text-gray-500\">\n            Entre {new Date(tripStartDate).toLocaleDateString('pt-BR')} e {new Date(tripEndDate).toLocaleDateString('pt-BR')}\n          </p>\n        )}\n      </div>\n\n      {/* Notes */}\n      <div className=\"space-y-2\">\n        <Label htmlFor=\"notes\">Observa√ß√µes</Label>\n        <Textarea\n          id=\"notes\"\n          value={formData.notes}\n          onChange={(e) => setFormData(prev => ({ ...prev, notes: e.target.value }))}\n          placeholder=\"Adicione observa√ß√µes sobre a atividade...\"\n          className=\"border-2 focus:border-primary resize-none\"\n          rows={3}\n        />\n      </div>\n\n      {/* Action Buttons */}\n      <div className=\"flex items-center gap-3 pt-4\">\n        <Button\n          onClick={handleSave}\n          className=\"flex-1 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white\"\n        >\n          <Save className=\"h-4 w-4 mr-2\" />\n          Salvar Altera√ß√µes\n        </Button>\n        <Button\n          variant=\"outline\"\n          onClick={onClose}\n          className=\"flex-1 border-2 border-gray-300 hover:bg-gray-50\"\n        >\n          Cancelar\n        </Button>\n      </div>\n    </div>\n  );\n}\n\n// Main Component\ninterface AdvancedActivityManagerProps {\n  activities: PlannedActivity[];\n  onActivitiesChange: (activities: PlannedActivity[]) => void;\n  className?: string;\n  tripDestination?: string;\n  trip?: any; // Trip object for calculating real participants\n  tripParticipants?: number; // Current accepted participants\n  tripMaxParticipants?: number; // Max participants for cost estimation\n  tripStartDate?: string; // Trip start date for activity scheduling\n  tripEndDate?: string; // Trip end date for activity scheduling\n}\n\nexport function AdvancedActivityManager({ \n  activities, \n  onActivitiesChange, \n  className = '',\n  tripDestination,\n  trip,\n  tripParticipants = 1,\n  tripMaxParticipants,\n  tripStartDate,\n  tripEndDate\n}: AdvancedActivityManagerProps) {\n  const realParticipantsCount = trip ? getRealParticipantsCount(trip) : tripParticipants;\n  const maxParticipantsCount = trip ? trip.max_participants : (tripMaxParticipants || tripParticipants);\n  const startDate = trip ? (trip.start_date || trip.startDate) : tripStartDate;\n  const endDate = trip ? (trip.end_date || trip.endDate) : tripEndDate;\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n  const [editingActivity, setEditingActivity] = useState<PlannedActivity | undefined>();\n\n\n\n\n\n  const handleSaveActivity = (activity: PlannedActivity) => {\n    if (editingActivity) {\n      onActivitiesChange(activities.map(a => a.id === activity.id ? activity : a));\n    } else {\n      onActivitiesChange([...activities, activity]);\n    }\n    setEditingActivity(undefined);\n  };\n\n  const handleEditActivity = (activity: PlannedActivity) => {\n    setEditingActivity(activity);\n    setIsDialogOpen(true);\n  };\n\n  const handleDeleteActivity = (id: string) => {\n    onActivitiesChange(activities.filter(a => a.id !== id));\n  };\n\n  const totalEstimatedCost = activities.reduce((sum, activity) => sum + (activity.estimatedCost || 0), 0);\n\n  return (\n    <div className={`space-y-6 ${className}`}>\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"text-lg font-semibold flex items-center gap-2\">\n            <Camera className=\"h-5 w-5 text-primary\" />\n            Atividades Planejadas\n          </h3>\n          <p className=\"text-sm text-gray-600\">\n            {activities.length} atividades ‚Ä¢ Total estimado: R$ {totalEstimatedCost.toLocaleString('pt-BR')}\n          </p>\n        </div>\n        \n        <Button\n          onClick={() => {\n            setEditingActivity(undefined);\n            setIsDialogOpen(true);\n          }}\n          className=\"bg-gradient-to-r from-primary to-purple-600 hover:from-primary/90 hover:to-purple-700\"\n        >\n          <Plus className=\"h-4 w-4 mr-2\" />\n          Adicionar Atividade\n        </Button>\n      </div>\n\n      {/* Cost Summary */}\n      {totalEstimatedCost > 0 && (\n        <Card className=\"bg-gradient-to-r from-blue-50 to-purple-50 border-2 border-blue-200\">\n          <CardContent className=\"p-4\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <DollarSign className=\"h-5 w-5 text-blue-600\" />\n                <span className=\"font-semibold text-blue-900\">Custo Total das Atividades</span>\n              </div>\n              <span className=\"text-xl font-bold text-blue-900\">\n                R$ {totalEstimatedCost.toLocaleString('pt-BR')}\n              </span>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Activities Timeline */}\n      <div className=\"space-y-4\">\n        {activities.length === 0 ? (\n          <Card className=\"border-2 border-dashed border-gray-300\">\n            <CardContent className=\"p-8 text-center\">\n              <Camera className=\"h-12 w-12 text-gray-400 mx-auto mb-4\" />\n              <h4 className=\"text-lg font-semibold text-gray-600 mb-2\">Nenhuma atividade planejada</h4>\n              <p className=\"text-gray-500 mb-4\">Adicione atividades para tornar sua viagem ainda mais especial!</p>\n              <Button\n                onClick={() => {\n                  setEditingActivity(undefined);\n                  setIsDialogOpen(true);\n                }}\n                variant=\"outline\"\n                className=\"border-2 border-dashed border-primary text-primary hover:bg-primary hover:text-white\"\n              >\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Adicionar Primeira Atividade\n              </Button>\n            </CardContent>\n          </Card>\n        ) : (\n          <ActivitiesTimeline \n            activities={activities}\n            onEdit={handleEditActivity}\n            onDelete={handleDeleteActivity}\n            onReorder={onActivitiesChange}\n            startDate={startDate}\n            endDate={endDate}\n          />\n        )}\n      </div>\n\n      {/* Activity Management Dialog */}\n      <ActivityManagementDialog\n        activity={editingActivity}\n        isOpen={isDialogOpen}\n        onClose={() => setIsDialogOpen(false)}\n        onSave={handleSaveActivity}\n        tripDestination={tripDestination}\n        tripParticipants={realParticipantsCount}\n        tripMaxParticipants={maxParticipantsCount}\n        tripStartDate={startDate}\n        tripEndDate={endDate}\n      />\n    </div>\n  );\n}","size_bytes":63468},"client/src/components/budget-editor.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Edit3, DollarSign, Calculator, AlertCircle } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { budgetCategories, BudgetBreakdown } from \"@shared/schema\";\nimport { formatBrazilianCurrency, calculatePerPerson, sumValues, parseNumber } from \"@shared/utils\";\n\ninterface BudgetEditorProps {\n  tripId: number;\n  currentBudget: number;\n  currentBudgetBreakdown?: BudgetBreakdown;\n  max_participants: number;\n  onBudgetUpdate?: (newBudget: number, newBreakdown?: BudgetBreakdown) => void;\n}\n\nexport function BudgetEditor({ \n  tripId, \n  currentBudget, \n  currentBudgetBreakdown, \n  max_participants,\n  onBudgetUpdate \n}: BudgetEditorProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [showBreakdown, setShowBreakdown] = useState(!!currentBudgetBreakdown);\n  const [budget, setBudget] = useState(currentBudget);\n  const [budget_breakdown, setBudgetBreakdown] = useState<BudgetBreakdown>(\n    currentBudgetBreakdown || {}\n  );\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const updateBudgetMutation = useMutation({\n    mutationFn: async (data: { budget: number; budget_breakdown?: BudgetBreakdown }) => {\n      console.log('Enviando dados de or√ßamento:', data);\n      const response = await apiRequest('PATCH', `/api/trips/${tripId}/budget`, data);\n      \n      if (!response.ok) {\n        const errorData = await response.text();\n        console.error('Erro na resposta:', response.status, errorData);\n        throw new Error(errorData || 'Erro ao atualizar or√ßamento');\n      }\n      \n      const result = await response.json();\n      console.log('Or√ßamento atualizado com sucesso:', result);\n      return result;\n    },\n    onSuccess: (updatedTrip) => {\n      console.log('Invalidando cache e atualizando UI');\n      queryClient.invalidateQueries({ queryKey: ['/api/trips', tripId] });\n      onBudgetUpdate?.(updatedTrip.budget, updatedTrip.budget_breakdown);\n      setIsOpen(false);\n      toast({\n        title: \"Or√ßamento atualizado\",\n        description: \"O or√ßamento da viagem foi atualizado com sucesso.\",\n      });\n    },\n    onError: (error: Error) => {\n      console.error('Erro na muta√ß√£o:', error);\n      toast({\n        title: \"Erro ao atualizar or√ßamento\",\n        description: error.message || \"Erro desconhecido ao atualizar or√ßamento\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const calculateTotalFromBreakdown = () => {\n    return sumValues(Object.values(budget_breakdown));\n  };\n\n  const handleBudgetBreakdownChange = (category: string, value: number) => {\n    setBudgetBreakdown(prev => ({\n      ...prev,\n      [category]: parseNumber(value) || undefined\n    }));\n  };\n\n  const handleSubmit = () => {\n    let finalBudget = budget;\n    let finalBreakdown = undefined;\n    \n    if (showBreakdown) {\n      finalBudget = calculateTotalFromBreakdown();\n      finalBreakdown = budget_breakdown;\n    } else {\n      // Se a op√ß√£o de breakdown estiver desabilitada, enviar budget_breakdown como null\n      // para indicar que as categorias devem ser zeradas\n      finalBreakdown = null;\n    }\n    \n    if (finalBudget <= 0) {\n      toast({\n        title: \"Erro de valida√ß√£o\",\n        description: \"O or√ßamento deve ser um valor positivo.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    updateBudgetMutation.mutate({\n      budget: finalBudget,\n      budget_breakdown: finalBreakdown || undefined\n    });\n  };\n\n  const resetForm = () => {\n    setBudget(currentBudget);\n    setBudgetBreakdown(currentBudgetBreakdown || {});\n    setShowBreakdown(!!currentBudgetBreakdown);\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={setIsOpen}>\n      <DialogTrigger asChild>\n        <Button \n          variant=\"outline\" \n          size=\"sm\" \n          className=\"gap-2\"\n          onClick={() => setIsOpen(true)}\n        >\n          <Edit3 className=\"h-4 w-4\" />\n          Editar Or√ßamento\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-4xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Calculator className=\"h-5 w-5\" />\n            Editar Or√ßamento da Viagem\n          </DialogTitle>\n          <DialogDescription>\n            Ajuste o or√ßamento total da viagem ou defina valores espec√≠ficos por categoria\n          </DialogDescription>\n        </DialogHeader>\n        \n        <div className=\"space-y-6\">\n          {/* Budget Mode Toggle */}\n          <Card>\n            <CardHeader>\n              <CardTitle className=\"text-lg\">Modo de Or√ßamento</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Label htmlFor=\"breakdown-mode\" className=\"text-sm font-medium\">\n                    Or√ßamento Detalhado por Categoria\n                  </Label>\n                  <p className=\"text-xs text-gray-600 mt-1\">\n                    Divida o or√ßamento em categorias espec√≠ficas (transporte, hospedagem, etc.)\n                  </p>\n                </div>\n                <Switch\n                  id=\"breakdown-mode\"\n                  checked={showBreakdown}\n                  onCheckedChange={setShowBreakdown}\n                />\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Budget Input */}\n          {!showBreakdown && (\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">Or√ßamento Total</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"budget\">Or√ßamento Total da Viagem (R$)</Label>\n                  <div className=\"relative\">\n                    <DollarSign className=\"absolute left-3 top-3 h-4 w-4 text-gray-500\" />\n                    <Input\n                      id=\"budget\"\n                      type=\"number\"\n                      placeholder=\"0\"\n                      className=\"pl-10\"\n                      value={budget || \"\"}\n                      onChange={(e) => setBudget(parseInt(e.target.value) || 0)}\n                    />\n                  </div>\n                </div>\n                \n                {budget > 0 && (\n                  <div className=\"bg-blue-50 p-4 rounded-lg\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm font-medium text-blue-900\">\n                        Custo por pessoa:\n                      </span>\n                      <span className=\"text-lg font-bold text-blue-900\">\n                        {formatBrazilianCurrency(budget / max_participants)}\n                      </span>\n                    </div>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Budget Breakdown */}\n          {showBreakdown && (\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">Or√ßamento por Categoria</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-1 gap-4\">\n                  {Object.entries(budgetCategories).map(([key, label]) => (\n                    <div key={key}>\n                      <Label htmlFor={key} className=\"text-sm font-medium\">{label}</Label>\n                      <div className=\"relative\">\n                        <DollarSign className=\"absolute left-3 top-3 h-3 w-3 text-gray-500\" />\n                        <Input\n                          id={key}\n                          type=\"number\"\n                          placeholder=\"0\"\n                          className=\"pl-10\"\n                          value={budget_breakdown[key as keyof BudgetBreakdown] || \"\"}\n                          onChange={(e) => handleBudgetBreakdownChange(key, parseInt(e.target.value) || 0)}\n                        />\n                      </div>\n                    </div>\n                  ))}\n                </div>\n                \n                <Separator />\n                \n                <div className=\"space-y-3\">\n                  <div className=\"flex justify-between items-center p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border-2 border-blue-200\">\n                    <span className=\"font-bold text-blue-900\">üíé Or√ßamento Base Total:</span>\n                    <span className=\"text-xl font-bold text-blue-900\">\n                      {formatBrazilianCurrency(calculateTotalFromBreakdown())}\n                    </span>\n                  </div>\n                  \n                  <div className=\"bg-green-50 p-4 rounded-lg border border-green-200\">\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"text-sm font-medium text-green-900\">\n                        Custo por pessoa:\n                      </span>\n                      <span className=\"text-lg font-bold text-green-900\">\n                        {formatBrazilianCurrency(calculateTotalFromBreakdown() / max_participants)}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Update budget from breakdown */}\n                {calculateTotalFromBreakdown() !== budget && (\n                  <div className=\"flex items-center gap-2 p-3 bg-yellow-50 rounded-lg border border-yellow-200\">\n                    <AlertCircle className=\"h-4 w-4 text-yellow-600\" />\n                    <span className=\"text-sm text-yellow-800\">\n                      O or√ßamento ser√° atualizado para {formatBrazilianCurrency(calculateTotalFromBreakdown())}\n                    </span>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Action Buttons */}\n          <div className=\"flex justify-end gap-3\">\n            <Button \n              variant=\"outline\" \n              onClick={() => {\n                resetForm();\n                setIsOpen(false);\n              }}\n            >\n              Cancelar\n            </Button>\n            <Button \n              onClick={handleSubmit}\n              disabled={updateBudgetMutation.isPending}\n            >\n              {updateBudgetMutation.isPending ? \"Salvando...\" : \"Salvar Or√ßamento\"}\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":11066},"client/src/components/budget-visualization.tsx":{"content":"import { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { \n  PieChart, \n  Pie, \n  Cell, \n  ResponsiveContainer, \n  BarChart, \n  Bar, \n  XAxis, \n  YAxis, \n  CartesianGrid, \n  Tooltip, \n  Legend \n} from \"recharts\";\nimport { \n  DollarSign, \n  Plane, \n  Home, \n  Utensils, \n  Car, \n  Camera, \n  ShoppingBag, \n  Shield, \n  FileText, \n  MoreHorizontal \n} from \"lucide-react\";\nimport { BudgetBreakdown, budgetCategories } from \"@shared/schema\";\nimport { getParticipantsForBudgetCalculation } from \"@/lib/trip-utils\";\nimport { formatBrazilianCurrency, formatBrazilianNumber, calculatePerPerson, sumValues } from \"@shared/utils\";\n\ninterface BudgetVisualizationProps {\n  budget: number;\n  budget_breakdown?: BudgetBreakdown;\n  trip: any; // Full trip object to determine if started\n  className?: string;\n}\n\nconst categoryIcons: { [key: string]: any } = {\n  transport: Plane,\n  accommodation: Home,\n  food: Utensils,\n  insurance: Shield,\n  medical: Shield,\n  other: MoreHorizontal,\n};\n\nconst categoryColors: { [key: string]: string } = {\n  transport: \"#3b82f6\",\n  accommodation: \"#10b981\",\n  food: \"#f59e0b\",\n  insurance: \"#06b6d4\",\n  medical: \"#f97316\",\n  other: \"#6b7280\",\n};\n\nexport function BudgetVisualization({ \n  budget, \n  budget_breakdown = {}, \n  trip,\n  className = \"\" \n}: BudgetVisualizationProps) {\n  const totalBudget = budget;\n  const participants = getParticipantsForBudgetCalculation(trip);\n  const perPersonBudget = totalBudget / participants;\n  \n  // Calculate breakdown data\n  const breakdownData = Object.entries(budgetCategories).map(([key, label]) => {\n    const amount = budget_breakdown[key as keyof BudgetBreakdown] || 0;\n    const percentage = totalBudget > 0 ? (amount / totalBudget) * 100 : 0;\n    const Icon = categoryIcons[key];\n    \n    return {\n      key,\n      label,\n      amount,\n      percentage,\n      color: categoryColors[key],\n      icon: Icon,\n      perPerson: amount / participants,\n    };\n  }).filter(item => item.amount > 0);\n\n  const totalAllocated = breakdownData.reduce((sum, item) => sum + item.amount, 0);\n  const unallocated = totalBudget - totalAllocated;\n  const allocationPercentage = totalBudget > 0 ? (totalAllocated / totalBudget) * 100 : 0;\n\n  // Prepare chart data\n  const chartData: Array<{\n    name: string;\n    value: number;\n    percentage: number;\n    color: string;\n  }> = breakdownData.map(item => ({\n    name: item.label,\n    value: item.amount,\n    percentage: item.percentage,\n    color: item.color,\n  }));\n\n  if (unallocated > 0) {\n    chartData.push({\n      name: \"N√£o Alocado\",\n      value: unallocated,\n      percentage: (unallocated / totalBudget) * 100,\n      color: \"#e5e7eb\",\n    });\n  }\n\n  return (\n    <div className={`space-y-6 ${className}`}>\n      {/* Budget Overview */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <DollarSign className=\"h-5 w-5\" />\n            Vis√£o Geral do Or√ßamento\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-primary\">\n                {formatBrazilianCurrency(totalBudget)}\n              </div>\n              <div className=\"text-sm text-gray-600\">Or√ßamento Total</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-green-600\">\n                {formatBrazilianCurrency(perPersonBudget)}\n              </div>\n              <div className=\"text-sm text-gray-600\">Por Pessoa</div>\n            </div>\n            <div className=\"text-center\">\n              <div className=\"text-2xl font-bold text-blue-600\">\n                {formatBrazilianNumber(allocationPercentage / 100).replace(',00', '')}%\n              </div>\n              <div className=\"text-sm text-gray-600\">Alocado</div>\n            </div>\n          </div>\n\n          {/* Overall Progress */}\n          <div className=\"space-y-2\">\n            <div className=\"flex justify-between text-sm\">\n              <span>Progresso de Aloca√ß√£o</span>\n              <span>{formatBrazilianCurrency(totalAllocated)} / {formatBrazilianCurrency(totalBudget)}</span>\n            </div>\n            <Progress value={allocationPercentage} className=\"h-3\" />\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Budget Breakdown */}\n      {breakdownData.length > 0 && (\n        <Card>\n          <CardHeader>\n            <CardTitle>Detalhamento por Categoria</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"space-y-4\">\n              {breakdownData.map((item) => {\n                const Icon = item.icon;\n                return (\n                  <div key={item.key} className=\"space-y-2\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-2\">\n                        <Icon className=\"h-4 w-4\" style={{ color: item.color }} />\n                        <span className=\"font-medium\">{item.label}</span>\n                        <Badge variant=\"secondary\" className=\"text-xs\">\n                          {formatBrazilianNumber(item.percentage / 100).replace(',00', '')}%\n                        </Badge>\n                      </div>\n                      <div className=\"text-right\">\n                        <div className=\"font-semibold\">\n                          {formatBrazilianCurrency(item.amount)}\n                        </div>\n                        <div className=\"text-xs text-gray-600\">\n                          {formatBrazilianCurrency(item.perPerson)} por pessoa\n                        </div>\n                      </div>\n                    </div>\n                    <Progress \n                      value={item.percentage} \n                      className=\"h-2\" \n                      style={{ \n                        backgroundColor: `${item.color}20`,\n                      }}\n                    />\n                  </div>\n                );\n              })}\n            </div>\n\n            {unallocated > 0 && (\n              <>\n                <Separator className=\"my-4\" />\n                <div className=\"flex items-center justify-between text-gray-600\">\n                  <span>Or√ßamento N√£o Alocado</span>\n                  <span className=\"font-semibold\">\n                    {formatBrazilianCurrency(unallocated)}\n                  </span>\n                </div>\n              </>\n            )}\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Visual Charts */}\n      {breakdownData.length > 0 && (\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n          {/* Pie Chart */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Distribui√ß√£o do Or√ßamento</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"h-64\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <PieChart>\n                    <Pie\n                      data={chartData}\n                      cx=\"50%\"\n                      cy=\"50%\"\n                      labelLine={false}\n                      label={({ name, percentage }) => `${name} (${formatBrazilianNumber(percentage / 100).replace(',00', '')}%)`}\n                      outerRadius={80}\n                      fill=\"#8884d8\"\n                      dataKey=\"value\"\n                    >\n                      {chartData.map((entry, index) => (\n                        <Cell key={`cell-${index}`} fill={entry.color} />\n                      ))}\n                    </Pie>\n                    <Tooltip \n                      formatter={(value: number) => [\n                        new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value),\n                        \"Valor\"\n                      ]}\n                    />\n                  </PieChart>\n                </ResponsiveContainer>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Bar Chart */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Compara√ß√£o por Categoria</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"h-64\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <BarChart data={chartData} margin={{ top: 20, right: 30, left: 20, bottom: 5 }}>\n                    <CartesianGrid strokeDasharray=\"3 3\" />\n                    <XAxis \n                      dataKey=\"name\" \n                      angle={-45}\n                      textAnchor=\"end\"\n                      height={80}\n                      fontSize={12}\n                    />\n                    <YAxis \n                      tickFormatter={(value) => \n                        new Intl.NumberFormat('pt-BR', { \n                          style: 'currency', \n                          currency: 'BRL',\n                          notation: 'compact' \n                        }).format(value)\n                      }\n                    />\n                    <Tooltip \n                      formatter={(value: number) => [\n                        new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(value),\n                        \"Valor\"\n                      ]}\n                    />\n                    <Bar dataKey=\"value\" fill=\"#3b82f6\" />\n                  </BarChart>\n                </ResponsiveContainer>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      )}\n\n      {/* Budget Tips */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Dicas de Or√ßamento</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-2 text-sm text-gray-600\">\n            {allocationPercentage < 80 && (\n              <div className=\"flex items-center gap-2 text-amber-600\">\n                <div className=\"w-2 h-2 bg-amber-600 rounded-full\" />\n                <span>Considere alocar mais do seu or√ßamento para ter maior controle dos gastos</span>\n              </div>\n            )}\n            {breakdownData.some(item => item.key === 'transport' && item.percentage > 40) && (\n              <div className=\"flex items-center gap-2 text-blue-600\">\n                <div className=\"w-2 h-2 bg-blue-600 rounded-full\" />\n                <span>Transporte representa uma grande parte do or√ßamento - considere op√ß√µes mais econ√¥micas</span>\n              </div>\n            )}\n            {breakdownData.some(item => item.key === 'accommodation' && item.percentage > 35) && (\n              <div className=\"flex items-center gap-2 text-green-600\">\n                <div className=\"w-2 h-2 bg-green-600 rounded-full\" />\n                <span>Hospedagem tem alto custo - dividir quartos pode reduzir significativamente o valor</span>\n              </div>\n            )}\n            {unallocated > totalBudget * 0.2 && (\n              <div className=\"flex items-center gap-2 text-purple-600\">\n                <div className=\"w-2 h-2 bg-purple-600 rounded-full\" />\n                <span>Voc√™ tem uma reserva boa para emerg√™ncias e gastos extras</span>\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":11471},"client/src/components/chat-window.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { UserAvatar } from \"@/components/ui/user-avatar\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { MessageCircle, Send, Users, Clock, Smile, Plus, Image, Mic, MoreHorizontal, Check } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { ptBR } from \"date-fns/locale\";\nimport { motion, AnimatePresence } from \"framer-motion\";\n\ninterface ChatWindowProps {\n  tripId: string;\n  className?: string;\n  participants?: any[];\n}\n\n// Mock messages for demo with enhanced content\nconst mockMessages = [\n  {\n    id: 1,\n    content: \"Ol√° pessoal! Estou muito animado para essa viagem! üéí‚úàÔ∏è\",\n    senderId: 1,\n    tripId: 1,\n    sentAt: new Date(Date.now() - 86400000 * 2).toISOString(),\n    sender: {\n      id: 1,\n      full_name: \"Tom Tubin\",\n      profile_photo: undefined\n    },\n    status: \"read\"\n  },\n  {\n    id: 2,\n    content: \"Oi Tom! Eu tamb√©m estou super empolgado. J√° comecei a fazer as malas. Voc√™s t√™m alguma sugest√£o de o que levar? üß≥\",\n    senderId: 2,\n    tripId: 1,\n    sentAt: new Date(Date.now() - 86400000).toISOString(),\n    sender: {\n      id: 2,\n      full_name: \"Ana Silva\",\n      profile_photo: undefined\n    },\n    status: \"read\"\n  },\n  {\n    id: 3,\n    content: \"Pessoal, consegui uma dica √≥tima de um restaurante local! Vou compartilhar no grupo do WhatsApp tamb√©m. üçΩÔ∏è\",\n    senderId: 3,\n    tripId: 1,\n    sentAt: new Date(Date.now() - 43200000).toISOString(),\n    sender: {\n      id: 3,\n      full_name: \"Carlos Santos\",\n      profile_photo: undefined\n    },\n    status: \"read\"\n  },\n  {\n    id: 4,\n    content: \"Que legal, Carlos! Estou ansioso para experimentar. Algu√©m j√° verificou o clima para os pr√≥ximos dias? ‚òÄÔ∏è\",\n    senderId: 4,\n    tripId: 1,\n    sentAt: new Date(Date.now() - 21600000).toISOString(),\n    sender: {\n      id: 4,\n      full_name: \"Maria Oliveira\",\n      profile_photo: undefined\n    },\n    status: \"delivered\"\n  },\n  {\n    id: 5,\n    content: \"Acabei de conferir! Parece que vai estar ensolarado na maior parte do tempo. Perfeito para as trilhas! üåû\",\n    senderId: 1,\n    tripId: 1,\n    sentAt: new Date(Date.now() - 10800000).toISOString(),\n    sender: {\n      id: 1,\n      fullName: \"Tom Tubin\",\n      profilePhoto: undefined\n    },\n    status: \"sent\"\n  }\n];\n\nexport function ChatWindow({ tripId, className = \"\", participants = [] }: ChatWindowProps) {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [newMessage, setNewMessage] = useState(\"\");\n  const [messages, setMessages] = useState(mockMessages);\n  const [isTyping, setIsTyping] = useState(false);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages]);\n\n  const handleSendMessage = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newMessage.trim()) return;\n\n    const message = {\n      id: messages.length + 1,\n      content: newMessage,\n      senderId: user?.id || 1,\n      tripId: parseInt(tripId),\n      sentAt: new Date().toISOString(),\n      sender: {\n        id: user?.id || 1,\n        fullName: user?.full_name || \"Usu√°rio\",\n        profilePhoto: undefined\n      },\n      status: \"sent\"\n    };\n\n    setMessages(prev => [...prev, message]);\n    setNewMessage(\"\");\n    \n    toast({\n      title: \"Mensagem enviada\",\n      description: \"Sua mensagem foi adicionada ao chat\",\n    });\n  };\n\n  const getInitials = (name: string) => {\n    return name.split(' ').map(n => n[0]).join('').toUpperCase();\n  };\n\n  const getMessageStatusIcon = (status: string) => {\n    switch (status) {\n      case \"sent\":\n        return <Check className=\"h-3 w-3 text-gray-400\" />;\n      case \"delivered\":\n        return <div className=\"flex\"><Check className=\"h-3 w-3 text-gray-400\" /><Check className=\"h-3 w-3 text-gray-400 -ml-1\" /></div>;\n      case \"read\":\n        return <div className=\"flex\"><Check className=\"h-3 w-3 text-blue-500\" /><Check className=\"h-3 w-3 text-blue-500 -ml-1\" /></div>;\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <Card className={`flex flex-col bg-white/95 backdrop-blur-sm border border-slate-200 shadow-lg rounded-xl ${className}`}>\n      <CardHeader className=\"pb-4 border-b border-slate-200 bg-gradient-to-r from-slate-50 to-gray-50 shadow-sm\">\n        <CardTitle className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-11 h-11 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg\">\n              <MessageCircle className=\"h-6 w-6 text-white\" />\n            </div>\n            <div className=\"flex flex-col\">\n              <span className=\"text-lg font-semibold text-slate-800\">Chat da Viagem</span>\n              <div className=\"flex items-center gap-2 text-xs text-slate-600\">\n                <div className=\"w-2 h-2 bg-emerald-500 rounded-full animate-pulse shadow-sm\"></div>\n                <span className=\"font-medium\">{participants.length || 0} participantes online</span>\n              </div>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-3\">\n            <Badge variant=\"secondary\" className=\"bg-blue-50 text-blue-700 border border-blue-200 shadow-sm px-3 py-1\">\n              {messages.length} mensagens\n            </Badge>\n            <Button \n              variant=\"ghost\" \n              size=\"sm\" \n              className=\"hidden md:flex hover:bg-slate-100 rounded-lg transition-colors duration-200 p-2\"\n              onClick={() => {\n                // Fun√ß√£o para abrir menu de op√ß√µes do chat\n                console.log(\"Abrir menu de op√ß√µes do chat\");\n              }}\n            >\n              <MoreHorizontal className=\"h-4 w-4 text-slate-600\" />\n            </Button>\n          </div>\n        </CardTitle>\n      </CardHeader>\n\n      {/* Participants Section - Fixed outside scroll area */}\n      <div className=\"border-b border-slate-200 bg-gradient-to-b from-slate-50/50 to-white/50 p-4\">\n        <div className=\"flex items-center justify-between mb-3\">\n          <div className=\"flex items-center gap-2\">\n            <Users className=\"h-4 w-4 text-blue-600\" />\n            <span className=\"text-sm font-medium text-slate-800\">Participantes</span>\n          </div>\n          <Badge variant=\"secondary\" className=\"text-xs bg-blue-50 text-blue-700 border border-blue-200 shadow-sm\">\n            {participants.length || 1}\n          </Badge>\n        </div>\n        \n        <div className=\"flex items-center gap-3 overflow-x-auto pb-2\">\n          {participants.length > 0 ? (\n            participants.map((participant: any) => {\n              const isOrganizer = participant.role === 'organizer' || participant.status === 'organizer';\n              return (\n                <div key={participant.id} className=\"flex items-center gap-2 min-w-0 flex-shrink-0\">\n                  <UserAvatar \n                    user={participant.user}\n                    size=\"sm\"\n                    className={`h-8 w-8 ring-2 ${isOrganizer ? 'ring-blue-200' : 'ring-gray-200'}`}\n                  />\n                  <div className=\"flex flex-col min-w-0\">\n                    <span className=\"text-xs font-medium text-gray-900 truncate\">\n                      {participant.user?.full_name || participant.user?.username}\n                    </span>\n                    <div className=\"flex items-center gap-1\">\n                      <div className={`w-2 h-2 rounded-full ${isOrganizer ? 'bg-green-500' : 'bg-gray-400'}`}></div>\n                      <span className=\"text-xs text-gray-500\">\n                        {isOrganizer ? 'Organizador' : 'Participante'}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              );\n            })\n          ) : (\n            <div className=\"flex items-center gap-2\">\n              <Avatar className=\"h-8 w-8 ring-2 ring-blue-200\">\n                <AvatarFallback className=\"bg-blue-100 text-blue-700 text-xs font-semibold\">\n                  TT\n                </AvatarFallback>\n              </Avatar>\n              <div className=\"flex flex-col\">\n                <span className=\"text-xs font-medium text-gray-900\">Tom Tubin</span>\n                <div className=\"flex items-center gap-1\">\n                  <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n                  <span className=\"text-xs text-gray-500\">Organizador</span>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n      \n      <CardContent className=\"flex-1 flex flex-col p-0\">\n        {/* Messages Area */}\n        <div className=\"flex-1 overflow-hidden\">\n          <ScrollArea className=\"h-full\">\n            <div className=\"p-4 min-h-full bg-[#ffffff]\">\n              <div className=\"space-y-4\">\n            {messages.length === 0 ? (\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                className=\"text-center py-12\"\n              >\n                <div className=\"w-16 h-16 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full mx-auto mb-4 flex items-center justify-center\">\n                  <MessageCircle className=\"h-8 w-8 text-white\" />\n                </div>\n                <p className=\"text-gray-700 font-medium mb-2\">Nenhuma mensagem ainda</p>\n                <p className=\"text-sm text-gray-500\">Seja o primeiro a enviar uma mensagem para o grupo!</p>\n              </motion.div>\n            ) : (\n              <AnimatePresence>\n                {messages.map((message, index) => (\n                  <motion.div\n                    key={message.id}\n                    initial={{ opacity: 0, y: 20 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    transition={{ delay: index * 0.1 }}\n                    className={`flex gap-3 ${message.senderId === user?.id ? 'flex-row-reverse' : ''}`}\n                  >\n                    <UserAvatar \n                      user={message.sender}\n                      size=\"md\"\n                      className=\"w-10 h-10 flex-shrink-0 ring-2 ring-white shadow-sm\"\n                    />\n                    <div className={`flex-1 max-w-[75%] ${message.senderId === user?.id ? 'text-right' : ''}`}>\n                      <div className={`flex items-center gap-2 mb-1 ${message.senderId === user?.id ? 'justify-end' : ''}`}>\n                        <span className=\"text-sm font-semibold text-gray-700\">\n                          {message.senderId === user?.id ? 'Voc√™' : message.sender?.full_name}\n                        </span>\n                        <span className=\"text-xs text-gray-500 flex items-center gap-1\">\n                          <Clock className=\"h-3 w-3\" />\n                          {format(new Date(message.sentAt), \"dd/MM HH:mm\", { locale: ptBR })}\n                        </span>\n                      </div>\n                      <div\n                        className={`relative p-3 rounded-2xl text-sm inline-block max-w-full shadow-sm ${\n                          message.senderId === user?.id\n                            ? 'bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-br-md'\n                            : 'bg-white border border-gray-200 text-gray-900 rounded-bl-md'\n                        }`}\n                      >\n                        <p className=\"whitespace-pre-wrap\">{message.content}</p>\n                        {message.senderId === user?.id && (\n                          <div className=\"absolute -bottom-1 -right-1 bg-white rounded-full p-1\">\n                            {getMessageStatusIcon(message.status)}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  </motion.div>\n                ))}\n              </AnimatePresence>\n            )}\n            {isTyping && (\n              <motion.div\n                initial={{ opacity: 0, y: 10 }}\n                animate={{ opacity: 1, y: 0 }}\n                className=\"flex items-center gap-3\"\n              >\n                <Avatar className=\"w-8 h-8\">\n                  <AvatarFallback className=\"text-xs bg-gray-200\">...</AvatarFallback>\n                </Avatar>\n                <div className=\"bg-gray-200 rounded-2xl px-4 py-2\">\n                  <div className=\"flex space-x-1\">\n                    <div className=\"w-2 h-2 bg-gray-500 rounded-full animate-bounce\"></div>\n                    <div className=\"w-2 h-2 bg-gray-500 rounded-full animate-bounce\" style={{ animationDelay: '0.1s' }}></div>\n                    <div className=\"w-2 h-2 bg-gray-500 rounded-full animate-bounce\" style={{ animationDelay: '0.2s' }}></div>\n                  </div>\n                </div>\n              </motion.div>\n            )}\n                <div ref={messagesEndRef} />\n              </div>\n            </div>\n          </ScrollArea>\n        </div>\n\n        {/* Enhanced Message Input */}\n        <div className=\"p-4 border-t border-gray-100 bg-white\">\n          <form onSubmit={handleSendMessage} className=\"space-y-3\">\n            <div className=\"relative\">\n              <Textarea\n                value={newMessage}\n                onChange={(e) => setNewMessage(e.target.value)}\n                placeholder=\"Digite sua mensagem...\"\n                className=\"min-h-[60px] bg-gray-50 border-gray-200 rounded-xl resize-none pr-12 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                maxLength={500}\n                onKeyDown={(e) => {\n                  if (e.key === 'Enter' && !e.shiftKey) {\n                    e.preventDefault();\n                    handleSendMessage(e);\n                  }\n                }}\n              />\n              <div className=\"absolute right-3 top-3 flex items-center gap-2\">\n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"h-8 w-8 p-0 hover:bg-blue-50\"\n                  onClick={() => {\n                    // Fun√ß√£o para abrir seletor de emoji\n                    console.log(\"Abrir seletor de emoji\");\n                  }}\n                >\n                  <Smile className=\"h-4 w-4 text-gray-500\" />\n                </Button>\n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"h-8 w-8 p-0 hover:bg-blue-50\"\n                  onClick={() => {\n                    // Fun√ß√£o para upload de imagem\n                    console.log(\"Abrir seletor de imagem\");\n                  }}\n                >\n                  <Image className=\"h-4 w-4 text-gray-500\" />\n                </Button>\n              </div>\n            </div>\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-xs text-gray-500\">\n                  {newMessage.length}/500\n                </span>\n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"h-8 w-8 p-0 hover:bg-blue-50 hidden md:flex\"\n                  onClick={() => {\n                    // Fun√ß√£o para adicionar anexos\n                    console.log(\"Abrir op√ß√µes de anexos\");\n                  }}\n                >\n                  <Plus className=\"h-4 w-4 text-gray-500\" />\n                </Button>\n                <Button\n                  type=\"button\"\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"h-8 w-8 p-0 hover:bg-blue-50 hidden md:flex\"\n                  onClick={() => {\n                    // Fun√ß√£o para grava√ß√£o de √°udio\n                    console.log(\"Iniciar grava√ß√£o de √°udio\");\n                  }}\n                >\n                  <Mic className=\"h-4 w-4 text-gray-500\" />\n                </Button>\n              </div>\n              <Button \n                type=\"submit\" \n                disabled={!newMessage.trim()}\n                className=\"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white font-medium px-6 py-2 rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl\"\n              >\n                <Send className=\"h-4 w-4 mr-2\" />\n                Enviar\n              </Button>\n            </div>\n          </form>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":16964},"client/src/components/cover-image-selector.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Camera } from \"lucide-react\";\n\ninterface CoverImageSelectorProps {\n  currentImage?: string;\n  localidade?: string;\n  onImageSelect: (imageUrl: string) => void;\n  trigger?: React.ReactNode;\n}\n\nexport function CoverImageSelector({ \n  currentImage, \n  localidade, \n  onImageSelect, \n  trigger \n}: CoverImageSelectorProps) {\n  const [customUrl, setCustomUrl] = useState(currentImage || \"\");\n  const [isDialogOpen, setIsDialogOpen] = useState(false);\n\n  const handleConfirm = () => {\n    if (customUrl) {\n      onImageSelect(customUrl);\n      setIsDialogOpen(false);\n    }\n  };\n\n  return (\n    <Dialog open={isDialogOpen} onOpenChange={setIsDialogOpen}>\n      <DialogTrigger asChild>\n        {trigger || (\n          <Button variant=\"outline\" size=\"sm\">\n            <Camera className=\"h-4 w-4 mr-2\" />\n            Alterar Capa\n          </Button>\n        )}\n      </DialogTrigger>\n      <DialogContent className=\"max-w-2xl\">\n        <DialogHeader>\n          <DialogTitle>Selecionar Imagem de Capa</DialogTitle>\n        </DialogHeader>\n        \n        <div className=\"space-y-6\">\n          {/* URL personalizada */}\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"custom-url\">URL da Imagem</Label>\n            <Input\n              id=\"custom-url\"\n              placeholder=\"Cole aqui o link da sua imagem...\"\n              value={customUrl}\n              onChange={(e) => setCustomUrl(e.target.value)}\n            />\n            <p className=\"text-sm text-gray-500\">\n              Cole o link de uma imagem da internet (ex: de Unsplash, Pixabay, etc.)\n            </p>\n          </div>\n\n          {/* Preview da imagem */}\n          {customUrl && (\n            <div className=\"space-y-2\">\n              <Label>Preview</Label>\n              <div className=\"w-full h-48 rounded-lg overflow-hidden bg-gray-100\">\n                <img\n                  src={customUrl}\n                  alt=\"Preview\"\n                  className=\"w-full h-full object-cover\"\n                  onError={(e) => {\n                    const target = e.target as HTMLImageElement;\n                    target.src = \"https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=800&q=80\";\n                  }}\n                />\n              </div>\n            </div>\n          )}\n\n          <div className=\"flex justify-end gap-2\">\n            <Button\n              variant=\"outline\"\n              onClick={() => setIsDialogOpen(false)}\n            >\n              Cancelar\n            </Button>\n            <Button\n              onClick={handleConfirm}\n              disabled={!customUrl}\n            >\n              Confirmar\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}","size_bytes":3004},"client/src/components/enhanced-trip-card.tsx":{"content":"import { useState } from 'react';\nimport { Star, MapPin, Calendar, Users, DollarSign, Clock, Heart, Share2 } from 'lucide-react';\nimport { Card, CardContent } from './ui/card';\nimport { Badge } from './ui/badge';\nimport { Button } from './ui/button';\nimport { Avatar, AvatarFallback, AvatarImage } from './ui/avatar';\nimport { LoadingSpinner } from './ui/loading-spinner';\nimport { OptimizedImage } from './optimized-image';\nimport { cn } from '@/lib/utils';\nimport { format } from 'date-fns';\nimport { ptBR } from 'date-fns/locale';\nimport { formatBrazilianCurrency, formatBrazilianNumber } from '@shared/utils';\nimport { getDaysUntilDate } from '@/lib/date-utils';\n\ninterface Trip {\n  id: number;\n  title: string;\n  description: string;\n  localidade: string;\n  start_date: string;\n  end_date: string;\n  budget: number;\n  max_participants: number;\n  current_participants: number;\n  travel_style: string;\n  creator: {\n    id: number;\n    full_name: string;\n    profile_photo?: string;\n    average_rating: number;\n    is_verified: boolean;\n  };\n  cover_image?: string;\n}\n\ninterface EnhancedTripCardProps {\n  trip: Trip;\n  onSelect?: (trip: Trip) => void;\n  onFavorite?: (tripId: number) => void;\n  onShare?: (tripId: number) => void;\n  isFavorited?: boolean;\n  isLoading?: boolean;\n  className?: string;\n  variant?: 'default' | 'compact' | 'featured';\n}\n\nexport function EnhancedTripCard({ \n  trip, \n  onSelect, \n  onFavorite,\n  onShare,\n  isFavorited = false,\n  isLoading = false,\n  className,\n  variant = 'default'\n}: EnhancedTripCardProps) {\n  const [imageError, setImageError] = useState(false);\n\n  const handleFavoriteClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    onFavorite?.(trip.id);\n  };\n\n  const handleShareClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    onShare?.(trip.id);\n  };\n\n  const travelStyleColors = {\n    'praia': 'bg-blue-100 text-blue-800',\n    'aventura': 'bg-green-100 text-green-800',\n    'urbanas': 'bg-gray-100 text-gray-800',\n    'cultural': 'bg-purple-100 text-purple-800',\n    'natureza': 'bg-emerald-100 text-emerald-800',\n    'neve': 'bg-cyan-100 text-cyan-800'\n  };\n\n  const getDaysUntilTrip = () => getDaysUntilDate(trip.start_date);\n\n  const daysUntil = getDaysUntilTrip();\n  const isUpcoming = daysUntil > 0;\n  const spotsLeft = trip.max_participants - trip.current_participants;\n\n  const cardHeight = variant === 'compact' ? 'h-64' : variant === 'featured' ? 'h-80' : 'h-72';\n\n  return (\n    <Card \n      className={cn(\n        \"group cursor-pointer transition-all duration-300 hover:shadow-xl hover:-translate-y-2\",\n        \"border-gray-200 hover:border-blue-300 overflow-hidden\",\n        variant === 'featured' && \"ring-2 ring-blue-200 shadow-lg\",\n        isLoading && \"pointer-events-none opacity-50\",\n        cardHeight,\n        className\n      )}\n      onClick={() => onSelect?.(trip)}\n    >\n      <div className=\"relative h-2/3\">\n        {/* Cover Image */}\n        <OptimizedImage\n          src={trip.cover_image || `https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=400&h=300&fit=crop&crop=center`}\n          alt={trip.title}\n          className=\"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105\"\n          fallbackSrc=\"https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=400&h=300&fit=crop&crop=center\"\n        />\n\n        {/* Gradient Overlay */}\n        <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent\" />\n\n        {/* Action Buttons */}\n        <div className=\"absolute top-3 right-3 flex space-x-2\">\n          <Button\n            size=\"sm\"\n            variant=\"ghost\"\n            className=\"h-8 w-8 p-0 bg-white/90 hover:bg-white\"\n            onClick={handleShareClick}\n          >\n            <Share2 className=\"w-4 h-4 text-gray-600\" />\n          </Button>\n          \n          <Button\n            size=\"sm\"\n            variant=\"ghost\"\n            className=\"h-8 w-8 p-0 bg-white/90 hover:bg-white\"\n            onClick={handleFavoriteClick}\n          >\n            <Heart \n              className={cn(\n                \"w-4 h-4 transition-colors\",\n                isFavorited ? \"fill-red-500 text-red-500\" : \"text-gray-600\"\n              )} \n            />\n          </Button>\n        </div>\n\n        {/* Travel Style Badge */}\n        <Badge \n          className={cn(\n            \"absolute top-3 left-3\",\n            travelStyleColors[trip.travel_style as keyof typeof travelStyleColors] || 'bg-gray-100 text-gray-800'\n          )}\n        >\n          {trip.travel_style}\n        </Badge>\n\n        {/* Featured Badge */}\n        {variant === 'featured' && (\n          <Badge className=\"absolute top-12 left-3 bg-gradient-to-r from-yellow-400 to-orange-500 text-white\">\n            ‚≠ê Destaque\n          </Badge>\n        )}\n\n        {/* Days Until Trip */}\n        {isUpcoming && daysUntil <= 30 && (\n          <Badge \n            variant=\"secondary\" \n            className=\"absolute bottom-3 right-3 bg-white/90 text-gray-800\"\n          >\n            {daysUntil === 1 ? 'Amanh√£' : `${daysUntil} dias`}\n          </Badge>\n        )}\n\n        {/* Loading overlay */}\n        {isLoading && (\n          <div className=\"absolute inset-0 bg-white/80 flex items-center justify-center rounded-t-lg\">\n            <LoadingSpinner size=\"lg\" />\n          </div>\n        )}\n      </div>\n\n      <CardContent className=\"p-4 h-1/3 flex flex-col justify-between\">\n        <div className=\"space-y-2\">\n          {/* Title and Location */}\n          <div>\n            <h3 className=\"font-semibold text-lg leading-tight text-gray-900 group-hover:text-blue-600 transition-colors line-clamp-1\">\n              {trip.title}\n            </h3>\n            <div className=\"flex items-center text-sm text-gray-500 mt-1\">\n              <MapPin className=\"w-4 h-4 mr-1 flex-shrink-0\" />\n              <span className=\"truncate\">{trip.localidade}</span>\n            </div>\n          </div>\n\n          {/* Dates */}\n          <div className=\"flex items-center text-sm text-gray-600\">\n            <Calendar className=\"w-4 h-4 mr-1 flex-shrink-0\" />\n            <span className=\"truncate\">\n              {format(new Date(trip.start_date), 'dd MMM', { locale: ptBR })} - {format(new Date(trip.end_date), 'dd MMM', { locale: ptBR })}\n            </span>\n          </div>\n        </div>\n\n        {/* Bottom Section */}\n        <div className=\"space-y-3\">\n          {/* Creator Info */}\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center space-x-2\">\n              <Avatar className=\"w-6 h-6\">\n                <AvatarImage src={trip.creator.profile_photo} />\n                <AvatarFallback className=\"text-xs bg-blue-100 text-blue-600\">\n                  {trip.creator.full_name.split(' ').map(n => n[0]).join('')}\n                </AvatarFallback>\n              </Avatar>\n              <div className=\"flex items-center space-x-1\">\n                <span className=\"text-sm text-gray-600 truncate max-w-20\">\n                  {trip.creator.full_name.split(' ')[0]}\n                </span>\n                {trip.creator.is_verified && (\n                  <div className=\"w-4 h-4 bg-green-500 rounded-full flex items-center justify-center\">\n                    <span className=\"text-white text-xs\">‚úì</span>\n                  </div>\n                )}\n              </div>\n            </div>\n\n            {/* Creator Rating */}\n            <div className=\"flex items-center\">\n              <Star className=\"w-3 h-3 text-yellow-400 fill-current\" />\n              <span className=\"ml-1 text-sm font-medium text-gray-900\">\n                {formatBrazilianNumber(trip.creator.average_rating).replace(',00', ',0')}\n              </span>\n            </div>\n          </div>\n\n          {/* Trip Stats */}\n          <div className=\"flex items-center justify-between text-sm\">\n            {/* Budget */}\n            <div className=\"flex items-center text-green-600 font-medium\">\n              <DollarSign className=\"w-4 h-4 mr-1\" />\n              <span>{formatBrazilianCurrency(trip.budget)}</span>\n            </div>\n\n            {/* Participants */}\n            <div className=\"flex items-center space-x-4\">\n              <div className=\"flex items-center text-gray-600\">\n                <Users className=\"w-4 h-4 mr-1\" />\n                <span>{trip.current_participants}/{trip.max_participants}</span>\n              </div>\n              \n              {spotsLeft > 0 && (\n                <Badge \n                  variant=\"outline\" \n                  className={cn(\n                    \"text-xs\",\n                    spotsLeft === 1 ? \"border-orange-300 text-orange-600\" : \"border-green-300 text-green-600\"\n                  )}\n                >\n                  {spotsLeft} {spotsLeft === 1 ? 'vaga' : 'vagas'}\n                </Badge>\n              )}\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":8949},"client/src/components/expense-manager.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Plus, Receipt, DollarSign, Users, Calculator, TrendingDown, TrendingUp, Check, X, RefreshCw } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { ptBR } from \"date-fns/locale\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { expenseCategories } from \"@shared/schema\";\nimport { formatBrazilianCurrency, formatBrazilianNumber, calculatePerPerson, sumValues, parseNumber } from \"@shared/utils\";\n\ninterface ExpenseManagerProps {\n  tripId: number;\n  participants: any[];\n}\n\nexport function ExpenseManager({ tripId, participants }: ExpenseManagerProps) {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isAddingExpense, setIsAddingExpense] = useState(false);\n  const [newExpense, setNewExpense] = useState({\n    amount: \"\",\n    description: \"\",\n    category: \"other\",\n    splitWith: participants.map(p => p.user_id || p.userId),\n    receipt: null as string | null,\n    splitEqually: true,\n  });\n\n  // Fetch expenses\n  const { data: expenses = [], isLoading: expensesLoading } = useQuery({\n    queryKey: ['/api/trips', tripId, 'expenses'],\n    queryFn: async () => {\n      const response = await fetch(`/api/trips/${tripId}/expenses`);\n      if (!response.ok) throw new Error('Falha ao buscar despesas');\n      return response.json();\n    },\n    staleTime: 0, // Always fetch fresh data\n    refetchOnWindowFocus: true,\n  });\n\n  // Fetch balances\n  const { data: balances = [], isLoading: balancesLoading, error: balancesError, refetch: refetchBalances } = useQuery({\n    queryKey: ['/api/trips', tripId, 'balances'],\n    queryFn: async () => {\n      const response = await fetch(`/api/trips/${tripId}/balances`, {\n        cache: 'no-store',\n        headers: {\n          'Cache-Control': 'no-cache',\n          'Pragma': 'no-cache'\n        }\n      });\n      if (!response.ok) throw new Error('Falha ao buscar balan√ßos');\n      const data = await response.json();\n      return data;\n    },\n    staleTime: 0, // Always fetch fresh data\n    refetchOnWindowFocus: true,\n    refetchInterval: 5000, // Refresh every 5 seconds\n  });\n\n  // Create expense mutation\n  const createExpenseMutation = useMutation({\n    mutationFn: async (expenseData: any) => {\n      const response = await apiRequest('POST', `/api/trips/${tripId}/expenses`, expenseData);\n      return response.json();\n    },\n    onSuccess: () => {\n      // Invalidate both queries to ensure data refresh\n      queryClient.invalidateQueries({ queryKey: ['/api/trips', tripId, 'expenses'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/trips', tripId, 'balances'] });\n      \n      // Also refetch immediately\n      queryClient.refetchQueries({ queryKey: ['/api/trips', tripId, 'expenses'] });\n      queryClient.refetchQueries({ queryKey: ['/api/trips', tripId, 'balances'] });\n      \n      setIsAddingExpense(false);\n      setNewExpense({\n        amount: \"\",\n        description: \"\",\n        category: \"other\",\n        splitWith: participants.map(p => p.user_id || p.userId),\n        receipt: null,\n        splitEqually: true,\n      });\n      toast({\n        title: \"Despesa adicionada\",\n        description: \"A despesa foi registrada com sucesso.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Erro ao adicionar despesa\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Update expense split mutation\n  const updateSplitMutation = useMutation({\n    mutationFn: async ({ splitId, paid }: { splitId: number; paid: boolean }) => {\n      const response = await apiRequest('PATCH', `/api/expense-splits/${splitId}`, { paid });\n      return response.json();\n    },\n    onSuccess: () => {\n      // Invalidate and refetch both queries\n      queryClient.invalidateQueries({ queryKey: ['/api/trips', tripId, 'expenses'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/trips', tripId, 'balances'] });\n      queryClient.refetchQueries({ queryKey: ['/api/trips', tripId, 'expenses'] });\n      queryClient.refetchQueries({ queryKey: ['/api/trips', tripId, 'balances'] });\n    },\n  });\n\n  const handleAddExpense = () => {\n    if (!newExpense.amount || !newExpense.description) {\n      toast({\n        title: \"Campos obrigat√≥rios\",\n        description: \"Por favor, preencha o valor e a descri√ß√£o.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    createExpenseMutation.mutate({\n      amount: parseNumber(newExpense.amount),\n      description: newExpense.description,\n      category: newExpense.category,\n      splitWith: newExpense.splitEqually ? 'all' : newExpense.splitWith,\n      receipt: newExpense.receipt,\n    });\n  };\n\n  const handleSplitParticipantToggle = (userId: number) => {\n    setNewExpense(prev => ({\n      ...prev,\n      splitWith: prev.splitWith.includes(userId)\n        ? prev.splitWith.filter(id => id !== userId)\n        : [...prev.splitWith, userId]\n    }));\n  };\n\n  // Using shared formatBrazilianCurrency utility directly instead of local wrapper\n\n  // Calculate who owes whom\n  const calculateSettlements = () => {\n    const settlements: { from: any; to: any; amount: number }[] = [];\n    // Create copies of balances to avoid modifying the original data\n    const creditors = balances.filter((b: any) => b.balance > 0).map((b: any) => ({ ...b })).sort((a: any, b: any) => b.balance - a.balance);\n    const debtors = balances.filter((b: any) => b.balance < 0).map((b: any) => ({ ...b })).sort((a: any, b: any) => a.balance - b.balance);\n\n    let i = 0, j = 0;\n    while (i < creditors.length && j < debtors.length) {\n      const credit = creditors[i].balance;\n      const debt = Math.abs(debtors[j].balance);\n      const settlementAmount = Math.min(credit, debt);\n\n      settlements.push({\n        from: debtors[j].user,\n        to: creditors[i].user,\n        amount: settlementAmount,\n      });\n\n      creditors[i].balance -= settlementAmount;\n      debtors[j].balance += settlementAmount;\n\n      if (creditors[i].balance === 0) i++;\n      if (debtors[j].balance === 0) j++;\n    }\n\n    return settlements;\n  };\n\n  const settlements = calculateSettlements();\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Balance Summary */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              <Calculator className=\"h-5 w-5\" />\n              Resumo de Saldos\n            </div>\n            <Button \n              variant=\"outline\" \n              size=\"sm\"\n              onClick={() => refetchBalances()}\n              disabled={balancesLoading}\n            >\n              <RefreshCw className={`h-4 w-4 ${balancesLoading ? 'animate-spin' : ''}`} />\n            </Button>\n          </CardTitle>\n          <div className=\"text-sm text-gray-600 mt-2\">\n            <div className=\"flex items-center gap-4\">\n              <div className=\"flex items-center gap-2\">\n                <TrendingUp className=\"h-4 w-4 text-green-600\" />\n                <span>Verde: Valor a receber</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <TrendingDown className=\"h-4 w-4 text-red-600\" />\n                <span>Vermelho: Valor a pagar</span>\n              </div>\n            </div>\n          </div>\n        </CardHeader>\n        <CardContent>\n          {balancesLoading ? (\n            <div className=\"text-center py-4\">Carregando saldos...</div>\n          ) : balances.length === 0 ? (\n            <div className=\"text-center py-4 text-gray-500\">\n              Nenhum saldo encontrado. Adicione algumas despesas para ver os saldos.\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                {balances.map((balance: any) => (\n                  <div key={balance.user_id} className=\"flex items-center gap-3 p-3 rounded-lg bg-gray-50 dark:bg-gray-800\">\n                    <Avatar className=\"h-10 w-10\">\n                      <AvatarImage src={balance.user.profile_photo || \"\"} />\n                      <AvatarFallback>\n                        {balance.user.full_name?.substring(0, 2).toUpperCase() || balance.user.username?.substring(0, 2).toUpperCase() || \"??\"}\n                      </AvatarFallback>\n                    </Avatar>\n                    <div className=\"flex-1\">\n                      <p className=\"font-medium\">{balance.user.full_name || balance.user.username}</p>\n                      <p className={`text-sm font-semibold ${\n                        balance.balance > 0 ? 'text-green-600' : balance.balance < 0 ? 'text-red-600' : 'text-gray-600'\n                      }`}>\n                        {balance.balance > 0 && '+ '}\n                        {formatBrazilianCurrency(balance.balance)}\n                      </p>\n\n                      <p className=\"text-xs text-gray-500\">\n                        {balance.balance > 0 ? 'Tem a receber' : balance.balance < 0 ? 'Tem a pagar' : 'Sem pend√™ncias'}\n                      </p>\n                    </div>\n                    {balance.balance > 0 && <TrendingUp className=\"h-4 w-4 text-green-600\" />}\n                    {balance.balance < 0 && <TrendingDown className=\"h-4 w-4 text-red-600\" />}\n                  </div>\n                ))}\n              </div>\n\n              {settlements.length > 0 && (\n                <>\n                  <Separator />\n                  <div>\n                    <h4 className=\"font-medium mb-3 flex items-center gap-2\">\n                      <Users className=\"h-4 w-4\" />\n                      Acertos Sugeridos\n                    </h4>\n                    <div className=\"space-y-2\">\n                      {settlements.map((settlement, index) => (\n                        <div key={index} className=\"flex items-center gap-2 text-sm\">\n                          <span className=\"font-medium\">{settlement.from.full_name}</span>\n                          <span className=\"text-gray-600\">deve</span>\n                          <span className=\"font-semibold text-primary\">{formatBrazilianCurrency(settlement.amount)}</span>\n                          <span className=\"text-gray-600\">para</span>\n                          <span className=\"font-medium\">{settlement.to.full_name}</span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                </>\n              )}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Add Expense Button */}\n      <div className=\"flex justify-end\">\n        <Dialog open={isAddingExpense} onOpenChange={setIsAddingExpense}>\n          <DialogTrigger asChild>\n            <Button>\n              <Plus className=\"h-4 w-4 mr-2\" />\n              Adicionar Despesa\n            </Button>\n          </DialogTrigger>\n          <DialogContent className=\"max-w-md\">\n            <DialogHeader>\n              <DialogTitle>Nova Despesa</DialogTitle>\n            </DialogHeader>\n            <div className=\"space-y-4 mt-4\">\n              <div>\n                <Label htmlFor=\"amount\">Valor (R$)</Label>\n                <Input\n                  id=\"amount\"\n                  type=\"number\"\n                  step=\"0.01\"\n                  placeholder=\"0,00\"\n                  value={newExpense.amount}\n                  onChange={(e) => setNewExpense(prev => ({ ...prev, amount: e.target.value }))}\n                />\n              </div>\n\n              <div>\n                <Label htmlFor=\"description\">Descri√ß√£o</Label>\n                <Textarea\n                  id=\"description\"\n                  placeholder=\"O que foi pago?\"\n                  value={newExpense.description}\n                  onChange={(e) => setNewExpense(prev => ({ ...prev, description: e.target.value }))}\n                />\n              </div>\n\n              <div>\n                <Label htmlFor=\"category\">Categoria</Label>\n                <Select\n                  value={newExpense.category}\n                  onValueChange={(value) => setNewExpense(prev => ({ ...prev, category: value }))}\n                >\n                  <SelectTrigger id=\"category\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {Object.entries(expenseCategories).map(([value, label]) => (\n                      <SelectItem key={value} value={value}>\n                        {label}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div>\n                <Label>Dividir com:</Label>\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center gap-2\">\n                    <Checkbox\n                      id=\"split-equally\"\n                      checked={newExpense.splitEqually}\n                      onCheckedChange={(checked) => setNewExpense(prev => ({ ...prev, splitEqually: checked as boolean }))}\n                    />\n                    <Label htmlFor=\"split-equally\" className=\"cursor-pointer\">\n                      <div className=\"flex items-center gap-2\">\n                        <Users className=\"h-4 w-4\" />\n                        <span>Dividir igualmente entre todos os participantes</span>\n                      </div>\n                      <p className=\"text-xs text-gray-500 mt-1\">\n                        Incluindo futuros participantes que entrarem na viagem\n                      </p>\n                    </Label>\n                  </div>\n                  \n                  {!newExpense.splitEqually && (\n                    <ScrollArea className=\"h-32 border rounded-lg p-3\">\n                      <div className=\"space-y-2\">\n                        {participants.map((participant) => (\n                          <div key={participant.user_id} className=\"flex items-center gap-2\">\n                            <Checkbox\n                              id={`split-${participant.user_id}`}\n                              checked={newExpense.splitWith.includes(participant.user_id)}\n                              onCheckedChange={() => handleSplitParticipantToggle(participant.user_id)}\n                            />\n                            <Label\n                              htmlFor={`split-${participant.user_id}`}\n                              className=\"flex items-center gap-2 cursor-pointer\"\n                            >\n                              <Avatar className=\"h-6 w-6\">\n                                <AvatarImage src={participant.user.profile_photo || \"\"} />\n                                <AvatarFallback className=\"text-xs\">\n                                  {participant.user.full_name.substring(0, 2).toUpperCase()}\n                                </AvatarFallback>\n                              </Avatar>\n                              <span>{participant.user.full_name}</span>\n                            </Label>\n                          </div>\n                        ))}\n                      </div>\n                    </ScrollArea>\n                  )}\n                </div>\n              </div>\n\n              <div className=\"flex justify-end gap-2\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setIsAddingExpense(false)}\n                >\n                  Cancelar\n                </Button>\n                <Button\n                  onClick={handleAddExpense}\n                  disabled={createExpenseMutation.isPending}\n                  className=\"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-md hover:shadow-lg transition-all duration-200\"\n                >\n                  {createExpenseMutation.isPending ? \"Adicionando...\" : \"Adicionar\"}\n                </Button>\n              </div>\n            </div>\n          </DialogContent>\n        </Dialog>\n      </div>\n\n      {/* Expenses List */}\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Receipt className=\"h-5 w-5\" />\n            Despesas da Viagem\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {expensesLoading ? (\n            <div className=\"text-center py-4\">Carregando despesas...</div>\n          ) : expenses.length === 0 ? (\n            <div className=\"text-center py-8 text-gray-500\">\n              <Receipt className=\"h-12 w-12 mx-auto mb-2 opacity-20\" />\n              <p>Nenhuma despesa registrada ainda.</p>\n            </div>\n          ) : (\n            <div className=\"space-y-4\">\n              {expenses.map((expense: any) => (\n                <div key={expense.id} className=\"border rounded-lg p-4\">\n                  <div className=\"flex items-start justify-between mb-3\">\n                    <div>\n                      <h4 className=\"font-medium\">{expense.description}</h4>\n                      <p className=\"text-sm text-gray-600\">\n                        Pago por {expense.payer.full_name} ‚Ä¢ {format(new Date(expense.created_at), \"dd 'de' MMM\", { locale: ptBR })}\n                      </p>\n                    </div>\n                    <div className=\"text-right\">\n                      <p className=\"font-semibold text-lg\">{formatBrazilianCurrency(expense.amount)}</p>\n                      <Badge variant=\"secondary\" className=\"text-xs\">\n                        {expenseCategories[expense.category as keyof typeof expenseCategories]}\n                      </Badge>\n                    </div>\n                  </div>\n\n                  <Separator className=\"my-3\" />\n\n                  <div>\n                    <p className=\"text-sm font-medium mb-2\">Divis√£o:</p>\n                    <div className=\"space-y-1\">\n                      {expense.splits.map((split: any) => (\n                        <div key={split.id} className=\"flex items-center justify-between text-sm\">\n                          <div className=\"flex items-center gap-2\">\n                            <Avatar className=\"h-6 w-6\">\n                              <AvatarImage src={split.user.profile_photo || \"\"} />\n                              <AvatarFallback className=\"text-xs\">\n                                {split.user.full_name.substring(0, 2).toUpperCase()}\n                              </AvatarFallback>\n                            </Avatar>\n                            <span>{split.user.full_name}</span>\n                          </div>\n                          <div className=\"flex items-center gap-2\">\n                            <span className={split.paid ? 'text-green-600' : 'text-gray-600'}>\n                              {formatBrazilianCurrency(split.amount)}\n                            </span>\n                            {split.paid ? (\n                              <Badge variant=\"outline\" className=\"text-xs text-green-600\">\n                                <Check className=\"h-3 w-3 mr-1\" />\n                                Pago\n                              </Badge>\n                            ) : (\n                              split.user_id === user?.id && (\n                                <Button\n                                  size=\"sm\"\n                                  variant=\"outline\"\n                                  onClick={() => updateSplitMutation.mutate({ splitId: split.id, paid: true })}\n                                  disabled={updateSplitMutation.isPending}\n                                >\n                                  Marcar como pago\n                                </Button>\n                              )\n                            )}\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":20893},"client/src/components/improved-activity-card.tsx":{"content":"import { useState } from 'react';\nimport { Star, MapPin, Clock, Users, Heart } from 'lucide-react';\nimport { Card, CardContent } from './ui/card';\nimport { Badge } from './ui/badge';\nimport { Button } from './ui/button';\nimport { LoadingSpinner } from './ui/loading-spinner';\nimport { cn } from '@/lib/utils';\nimport { formatBrazilianCurrency, formatBrazilianNumber } from '@shared/utils';\n\ninterface Activity {\n  id: number;\n  title: string;\n  description: string;\n  location: string;\n  cover_image: string;\n  category: string;\n  average_rating: number;\n  total_ratings: number;\n  estimatedDuration?: string;\n  max_participants?: number;\n  difficulty?: string;\n}\n\ninterface ImprovedActivityCardProps {\n  activity: Activity;\n  onSelect?: (activity: Activity) => void;\n  onFavorite?: (activityId: number) => void;\n  isFavorited?: boolean;\n  isLoading?: boolean;\n  className?: string;\n}\n\nexport function ImprovedActivityCard({ \n  activity, \n  onSelect, \n  onFavorite,\n  isFavorited = false,\n  isLoading = false,\n  className \n}: ImprovedActivityCardProps) {\n  const [imageLoading, setImageLoading] = useState(true);\n  const [imageError, setImageError] = useState(false);\n\n  const handleFavoriteClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    onFavorite?.(activity.id);\n  };\n\n  const difficultyColors = {\n    'f√°cil': 'bg-green-100 text-green-800',\n    'm√©dio': 'bg-yellow-100 text-yellow-800',\n    'dif√≠cil': 'bg-red-100 text-red-800'\n  };\n\n  return (\n    <Card \n      className={cn(\n        \"group cursor-pointer transition-all duration-300 hover:shadow-lg hover:-translate-y-1\",\n        \"border-gray-200 hover:border-blue-300\",\n        isLoading && \"pointer-events-none opacity-50\",\n        className\n      )}\n      onClick={() => onSelect?.(activity)}\n    >\n      <div className=\"relative\">\n        {/* Image with loading states */}\n        <div className=\"relative h-48 overflow-hidden rounded-t-lg\">\n          {imageLoading && (\n            <div className=\"absolute inset-0 flex items-center justify-center bg-gray-100\">\n              <LoadingSpinner size=\"md\" />\n            </div>\n          )}\n          \n          {!imageError ? (\n            <img\n              src={activity.cover_image}\n              alt={activity.title}\n              className={cn(\n                \"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105\",\n                imageLoading && \"opacity-0\"\n              )}\n              onLoad={() => setImageLoading(false)}\n              onError={() => {\n                setImageError(true);\n                setImageLoading(false);\n              }}\n            />\n          ) : (\n            <div className=\"w-full h-full bg-gradient-to-br from-gray-200 to-gray-300 flex items-center justify-center\">\n              <div className=\"text-center text-gray-500\">\n                <MapPin className=\"w-8 h-8 mx-auto mb-2\" />\n                <p className=\"text-sm\">Imagem n√£o dispon√≠vel</p>\n              </div>\n            </div>\n          )}\n\n          {/* Favorite button */}\n          <Button\n            size=\"sm\"\n            variant=\"ghost\"\n            className=\"absolute top-2 right-2 h-8 w-8 p-0 bg-white/90 hover:bg-white\"\n            onClick={handleFavoriteClick}\n          >\n            <Heart \n              className={cn(\n                \"w-4 h-4 transition-colors\",\n                isFavorited ? \"fill-red-500 text-red-500\" : \"text-gray-600\"\n              )} \n            />\n          </Button>\n\n          {/* Category badge */}\n          <Badge \n            variant=\"secondary\" \n            className=\"absolute top-2 left-2 bg-white/90 text-gray-800\"\n          >\n            {activity.category}\n          </Badge>\n\n          {/* Difficulty badge */}\n          {activity.difficulty && (\n            <Badge \n              className={cn(\n                \"absolute bottom-2 left-2\",\n                difficultyColors[activity.difficulty as keyof typeof difficultyColors] || 'bg-gray-100 text-gray-800'\n              )}\n            >\n              {activity.difficulty}\n            </Badge>\n          )}\n        </div>\n\n        {/* Loading overlay */}\n        {isLoading && (\n          <div className=\"absolute inset-0 bg-white/80 flex items-center justify-center rounded-lg\">\n            <LoadingSpinner size=\"lg\" />\n          </div>\n        )}\n      </div>\n\n      <CardContent className=\"p-4\">\n        <div className=\"space-y-3\">\n          {/* Title */}\n          <h3 className=\"font-semibold text-lg leading-tight text-gray-900 group-hover:text-blue-600 transition-colors\">\n            {activity.title}\n          </h3>\n\n          {/* Description */}\n          <p className=\"text-sm text-gray-600 line-clamp-2 leading-relaxed\">\n            {activity.description}\n          </p>\n\n          {/* Location */}\n          <div className=\"flex items-center text-sm text-gray-500\">\n            <MapPin className=\"w-4 h-4 mr-1 flex-shrink-0\" />\n            <span className=\"truncate\">{activity.location}</span>\n          </div>\n\n          {/* Rating and metadata */}\n          <div className=\"flex items-center justify-between pt-2\">\n            <div className=\"flex items-center space-x-4\">\n              {/* Rating */}\n              <div className=\"flex items-center\">\n                <Star className=\"w-4 h-4 text-yellow-400 fill-current\" />\n                <span className=\"ml-1 text-sm font-medium text-gray-900\">\n                  {formatBrazilianNumber(activity.average_rating).replace(',00', ',0')}\n                </span>\n                <span className=\"ml-1 text-sm text-gray-500\">\n                  ({activity.total_ratings})\n                </span>\n              </div>\n\n              {/* Duration */}\n              {activity.estimatedDuration && (\n                <div className=\"flex items-center text-sm text-gray-500\">\n                  <Clock className=\"w-4 h-4 mr-1\" />\n                  <span>{activity.estimatedDuration}</span>\n                </div>\n              )}\n            </div>\n\n            {/* Max participants */}\n            {activity.max_participants && (\n              <div className=\"flex items-center text-sm text-gray-500\">\n                <Users className=\"w-4 h-4 mr-1\" />\n                <span>at√© {activity.max_participants}</span>\n              </div>\n            )}\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":6348},"client/src/components/journey-progress-tracker.tsx":{"content":"import React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { CheckCircle, MapPin, Plane, Camera, Star, Trophy, Sparkles, Calendar, Users, DollarSign } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Progress } from '@/components/ui/progress';\nimport { Button } from '@/components/ui/button';\n\nexport interface JourneyMilestone {\n  id: string;\n  title: string;\n  description: string;\n  icon: React.ReactNode;\n  completed: boolean;\n  completedAt?: Date;\n  points?: number;\n  category: 'planning' | 'booking' | 'experience' | 'completion';\n}\n\ninterface JourneyProgressTrackerProps {\n  tripId: string;\n  milestones: JourneyMilestone[];\n  onMilestoneComplete?: (milestoneId: string) => void;\n  className?: string;\n}\n\nconst categoryColors = {\n  planning: 'bg-blue-500',\n  booking: 'bg-green-500',\n  experience: 'bg-purple-500',\n  completion: 'bg-yellow-500'\n};\n\nconst categoryLabels = {\n  planning: 'Planejamento',\n  booking: 'Reservas',\n  experience: 'Experi√™ncia',\n  completion: 'Conclus√£o'\n};\n\nexport function JourneyProgressTracker({\n  tripId,\n  milestones,\n  onMilestoneComplete,\n  className = \"\"\n}: JourneyProgressTrackerProps) {\n  const [celebratingMilestone, setCelebratingMilestone] = useState<string | null>(null);\n  const [totalPoints, setTotalPoints] = useState(0);\n  const [showAnimation, setShowAnimation] = useState(false);\n\n  const completedMilestones = milestones.filter(m => m.completed);\n  const progressPercentage = (completedMilestones.length / milestones.length) * 100;\n\n  useEffect(() => {\n    const newTotalPoints = completedMilestones.reduce((sum, m) => sum + (m.points || 0), 0);\n    if (newTotalPoints > totalPoints) {\n      setTotalPoints(newTotalPoints);\n      setShowAnimation(true);\n      setTimeout(() => setShowAnimation(false), 2000);\n    }\n  }, [completedMilestones, totalPoints]);\n\n  const handleMilestoneComplete = (milestoneId: string) => {\n    setCelebratingMilestone(milestoneId);\n    setTimeout(() => setCelebratingMilestone(null), 3000);\n    onMilestoneComplete?.(milestoneId);\n  };\n\n  const getMilestonesByCategory = (category: string) => {\n    return milestones.filter(m => m.category === category);\n  };\n\n  const getCategoryProgress = (category: string) => {\n    const categoryMilestones = getMilestonesByCategory(category);\n    const completedInCategory = categoryMilestones.filter(m => m.completed);\n    return categoryMilestones.length > 0 ? (completedInCategory.length / categoryMilestones.length) * 100 : 0;\n  };\n\n  return (\n    <Card className={`w-full ${className}`}>\n      <CardHeader>\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"flex items-center gap-2\">\n            <MapPin className=\"h-5 w-5\" />\n            Journey Progress\n          </CardTitle>\n          <div className=\"flex items-center gap-2\">\n            <motion.div\n              animate={showAnimation ? { scale: [1, 1.2, 1] } : {}}\n              transition={{ duration: 0.5 }}\n            >\n              <Badge variant=\"secondary\" className=\"flex items-center gap-1\">\n                <Star className=\"h-3 w-3\" />\n                {totalPoints} points\n              </Badge>\n            </motion.div>\n            {showAnimation && (\n              <motion.div\n                initial={{ opacity: 0, y: -20 }}\n                animate={{ opacity: 1, y: 0 }}\n                exit={{ opacity: 0, y: -20 }}\n                className=\"text-yellow-500\"\n              >\n                <Sparkles className=\"h-4 w-4\" />\n              </motion.div>\n            )}\n          </div>\n        </div>\n        <div className=\"space-y-2\">\n          <div className=\"flex items-center justify-between text-sm\">\n            <span>Progresso Geral</span>\n            <span>{completedMilestones.length}/{milestones.length} conclu√≠dos</span>\n          </div>\n          <Progress value={progressPercentage} className=\"h-2\" />\n        </div>\n      </CardHeader>\n\n      <CardContent className=\"space-y-6\">\n        {/* Category Progress */}\n        <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-4\">\n          {Object.entries(categoryLabels).map(([key, label]) => (\n            <div key={key} className=\"text-center\">\n              <div className=\"mb-2\">\n                <div className={`w-8 h-8 rounded-full ${categoryColors[key as keyof typeof categoryColors]} mx-auto mb-1 flex items-center justify-center`}>\n                  <div className=\"w-4 h-4 bg-white rounded-full\" />\n                </div>\n                <div className=\"text-xs text-muted-foreground\">{label}</div>\n              </div>\n              <Progress \n                value={getCategoryProgress(key)} \n                className=\"h-1\"\n              />\n              <div className=\"text-xs text-muted-foreground mt-1\">\n                {getMilestonesByCategory(key).filter(m => m.completed).length}/{getMilestonesByCategory(key).length}\n              </div>\n            </div>\n          ))}\n        </div>\n\n        {/* Milestones List */}\n        <div className=\"space-y-4\">\n          {Object.entries(categoryLabels).map(([categoryKey, categoryLabel]) => {\n            const categoryMilestones = getMilestonesByCategory(categoryKey);\n            if (categoryMilestones.length === 0) return null;\n\n            return (\n              <div key={categoryKey} className=\"space-y-2\">\n                <h4 className=\"font-medium text-sm flex items-center gap-2\">\n                  <div className={`w-3 h-3 rounded-full ${categoryColors[categoryKey as keyof typeof categoryColors]}`} />\n                  {categoryLabel}\n                </h4>\n                <div className=\"space-y-2 pl-5\">\n                  {categoryMilestones.map((milestone, index) => (\n                    <motion.div\n                      key={milestone.id}\n                      initial={{ opacity: 0, x: -20 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      transition={{ delay: index * 0.1 }}\n                      className={`flex items-center gap-3 p-3 rounded-lg border transition-all ${\n                        milestone.completed \n                          ? 'bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800' \n                          : 'bg-gray-50 border-gray-200 dark:bg-gray-900/20 dark:border-gray-800'\n                      }`}\n                    >\n                      <motion.div\n                        animate={celebratingMilestone === milestone.id ? { rotate: 360, scale: [1, 1.3, 1] } : {}}\n                        transition={{ duration: 0.6 }}\n                      >\n                        {milestone.completed ? (\n                          <CheckCircle className=\"h-5 w-5 text-green-600\" />\n                        ) : (\n                          <div className=\"w-5 h-5 rounded-full border-2 border-gray-300\" />\n                        )}\n                      </motion.div>\n                      \n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2\">\n                          {milestone.icon}\n                          <h5 className={`font-medium ${\n                            milestone.completed ? 'text-green-800 dark:text-green-200' : 'text-gray-700 dark:text-gray-300'\n                          }`}>\n                            {milestone.title}\n                          </h5>\n                          {milestone.points && (\n                            <Badge variant=\"outline\" className=\"text-xs\">\n                              +{milestone.points} pts\n                            </Badge>\n                          )}\n                        </div>\n                        <p className=\"text-sm text-muted-foreground mt-1\">\n                          {milestone.description}\n                        </p>\n                        {milestone.completedAt && (\n                          <p className=\"text-xs text-muted-foreground mt-1\">\n                            Completed: {milestone.completedAt.toLocaleDateString()}\n                          </p>\n                        )}\n                      </div>\n\n                      {!milestone.completed && (\n                        <Button\n                          size=\"sm\"\n                          variant=\"outline\"\n                          onClick={() => handleMilestoneComplete(milestone.id)}\n                          className=\"ml-2\"\n                        >\n                          Mark Complete\n                        </Button>\n                      )}\n                    </motion.div>\n                  ))}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n\n        {/* Celebration Animation */}\n        <AnimatePresence>\n          {celebratingMilestone && (\n            <motion.div\n              initial={{ opacity: 0, scale: 0.8 }}\n              animate={{ opacity: 1, scale: 1 }}\n              exit={{ opacity: 0, scale: 0.8 }}\n              className=\"fixed inset-0 flex items-center justify-center bg-black/50 z-50 pointer-events-none\"\n            >\n              <motion.div\n                initial={{ y: 50, opacity: 0 }}\n                animate={{ y: 0, opacity: 1 }}\n                exit={{ y: -50, opacity: 0 }}\n                className=\"bg-white dark:bg-gray-800 rounded-lg p-8 text-center shadow-2xl max-w-sm mx-4\"\n              >\n                <motion.div\n                  animate={{ rotate: 360 }}\n                  transition={{ duration: 1, repeat: Infinity }}\n                  className=\"mb-4\"\n                >\n                  <Trophy className=\"h-16 w-16 text-yellow-500 mx-auto\" />\n                </motion.div>\n                <h3 className=\"text-2xl font-bold mb-2\">Marco Alcan√ßado! üéâ</h3>\n                <p className=\"text-muted-foreground\">\n                  Voc√™ completou mais uma etapa da sua jornada!\n                </p>\n                <div className=\"flex justify-center mt-4\">\n                  {Array.from({ length: 5 }).map((_, i) => (\n                    <motion.div\n                      key={i}\n                      initial={{ opacity: 0, scale: 0 }}\n                      animate={{ opacity: 1, scale: 1 }}\n                      transition={{ delay: i * 0.1 }}\n                    >\n                      <Sparkles className=\"h-4 w-4 text-yellow-500\" />\n                    </motion.div>\n                  ))}\n                </div>\n              </motion.div>\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        {/* Achievement Badge */}\n        {progressPercentage === 100 && (\n          <motion.div\n            initial={{ opacity: 0, scale: 0.8 }}\n            animate={{ opacity: 1, scale: 1 }}\n            className=\"text-center p-4 bg-gradient-to-r from-yellow-100 to-orange-100 dark:from-yellow-900/30 dark:to-orange-900/30 rounded-lg border-2 border-yellow-300 dark:border-yellow-700\"\n          >\n            <Trophy className=\"h-12 w-12 text-yellow-600 mx-auto mb-2\" />\n            <h3 className=\"text-xl font-bold text-yellow-800 dark:text-yellow-200\">Jornada Completa!</h3>\n            <p className=\"text-yellow-700 dark:text-yellow-300\">\n              Parab√©ns! Voc√™ completou todos os marcos desta viagem.\n            </p>\n          </motion.div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\n// Default milestones for a trip\nexport const createDefaultMilestones = (tripId: string): JourneyMilestone[] => [\n  {\n    id: '1',\n    title: 'Trip Planning Started',\n    description: 'Begin planning your amazing journey',\n    icon: <Calendar className=\"h-4 w-4\" />,\n    completed: true,\n    completedAt: new Date(),\n    points: 10,\n    category: 'planning'\n  },\n  {\n    id: '2',\n    title: 'Destination Research',\n    description: 'Pesquise e finalize sua localidade',\n    icon: <MapPin className=\"h-4 w-4\" />,\n    completed: true,\n    completedAt: new Date(),\n    points: 15,\n    category: 'planning'\n  },\n  {\n    id: '3',\n    title: 'Find Travel Companions',\n    description: 'Connect with fellow travelers',\n    icon: <Users className=\"h-4 w-4\" />,\n    completed: false,\n    points: 20,\n    category: 'planning'\n  },\n  {\n    id: '4',\n    title: 'Budget Planning',\n    description: 'Set and organize your travel budget',\n    icon: <DollarSign className=\"h-4 w-4\" />,\n    completed: false,\n    points: 15,\n    category: 'planning'\n  },\n  {\n    id: '5',\n    title: 'Flight Booking',\n    description: 'Book your flights and transportation',\n    icon: <Plane className=\"h-4 w-4\" />,\n    completed: false,\n    points: 30,\n    category: 'booking'\n  },\n  {\n    id: '6',\n    title: 'Accommodation Booked',\n    description: 'Garanta sua estadia na localidade',\n    icon: <MapPin className=\"h-4 w-4\" />,\n    completed: false,\n    points: 25,\n    category: 'booking'\n  },\n  {\n    id: '7',\n    title: 'First Day Adventures',\n    description: 'Start exploring and creating memories',\n    icon: <Camera className=\"h-4 w-4\" />,\n    completed: false,\n    points: 40,\n    category: 'experience'\n  },\n  {\n    id: '8',\n    title: 'Local Experiences',\n    description: 'Immerse yourself in local culture',\n    icon: <Star className=\"h-4 w-4\" />,\n    completed: false,\n    points: 35,\n    category: 'experience'\n  },\n  {\n    id: '9',\n    title: 'Trip Completion',\n    description: 'Successfully complete your journey',\n    icon: <Trophy className=\"h-4 w-4\" />,\n    completed: false,\n    points: 50,\n    category: 'completion'\n  }\n];","size_bytes":13490},"client/src/components/lazy-image-gallery.tsx":{"content":"import React, { useState, useEffect, useRef } from 'react';\nimport { OptimizedImage } from './optimized-image';\nimport { Button } from './ui/button';\nimport { ChevronLeft, ChevronRight, X, ZoomIn } from 'lucide-react';\nimport { Dialog, DialogContent } from './ui/dialog';\nimport { cn } from '@/lib/utils';\n\ninterface LazyImageGalleryProps {\n  images: string[];\n  className?: string;\n  aspectRatio?: 'square' | 'video' | 'wide';\n  maxVisibleImages?: number;\n  enableLightbox?: boolean;\n}\n\nexport const LazyImageGallery = React.memo(function LazyImageGallery({\n  images,\n  className,\n  aspectRatio = 'video',\n  maxVisibleImages = 4,\n  enableLightbox = true\n}: LazyImageGalleryProps) {\n  const [currentImageIndex, setCurrentImageIndex] = useState(0);\n  const [isLightboxOpen, setIsLightboxOpen] = useState(false);\n  const [visibleImages, setVisibleImages] = useState<string[]>([]);\n  const observerRef = useRef<IntersectionObserver>();\n  const galleryRef = useRef<HTMLDivElement>(null);\n\n  // Lazy load images when they come into view\n  useEffect(() => {\n    const loadImages = () => {\n      const imagesToLoad = images.slice(0, maxVisibleImages);\n      setVisibleImages(imagesToLoad);\n    };\n\n    if ('IntersectionObserver' in window) {\n      observerRef.current = new IntersectionObserver(\n        (entries) => {\n          entries.forEach((entry) => {\n            if (entry.isIntersecting) {\n              loadImages();\n              observerRef.current?.disconnect();\n            }\n          });\n        },\n        { threshold: 0.1 }\n      );\n\n      if (galleryRef.current) {\n        observerRef.current.observe(galleryRef.current);\n      }\n    } else {\n      // Fallback for browsers without IntersectionObserver\n      loadImages();\n    }\n\n    return () => {\n      observerRef.current?.disconnect();\n    };\n  }, [images, maxVisibleImages]);\n\n  const aspectRatioClasses = {\n    square: 'aspect-square',\n    video: 'aspect-video', \n    wide: 'aspect-[21/9]'\n  };\n\n  const openLightbox = (index: number) => {\n    if (enableLightbox) {\n      setCurrentImageIndex(index);\n      setIsLightboxOpen(true);\n    }\n  };\n\n  const nextImage = () => {\n    setCurrentImageIndex((prev) => (prev + 1) % images.length);\n  };\n\n  const prevImage = () => {\n    setCurrentImageIndex((prev) => (prev - 1 + images.length) % images.length);\n  };\n\n  const handleKeyDown = (e: KeyboardEvent) => {\n    if (!isLightboxOpen) return;\n    \n    switch (e.key) {\n      case 'ArrowLeft':\n        prevImage();\n        break;\n      case 'ArrowRight':\n        nextImage();\n        break;\n      case 'Escape':\n        setIsLightboxOpen(false);\n        break;\n    }\n  };\n\n  useEffect(() => {\n    document.addEventListener('keydown', handleKeyDown);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [isLightboxOpen]);\n\n  if (visibleImages.length === 0) {\n    return (\n      <div \n        ref={galleryRef}\n        className={cn(\"bg-gray-100 rounded-lg flex items-center justify-center\", aspectRatioClasses[aspectRatio], className)}\n      >\n        <div className=\"text-gray-400 text-center\">\n          <div className=\"text-2xl mb-2\">üì∑</div>\n          <div className=\"text-sm\">Carregando imagens...</div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <div ref={galleryRef} className={cn(\"relative\", className)}>\n        {visibleImages.length === 1 ? (\n          // Single image\n          <div className=\"relative group\">\n            <OptimizedImage\n              src={visibleImages[0]}\n              alt=\"Imagem da galeria\"\n              className={cn(\"w-full object-cover rounded-lg\", aspectRatioClasses[aspectRatio])}\n              onClick={() => openLightbox(0)}\n            />\n            {enableLightbox && (\n              <div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100\">\n                <Button\n                  variant=\"ghost\"\n                  size=\"sm\"\n                  className=\"bg-white/90 hover:bg-white\"\n                  onClick={() => openLightbox(0)}\n                >\n                  <ZoomIn className=\"w-4 h-4\" />\n                </Button>\n              </div>\n            )}\n          </div>\n        ) : (\n          // Multiple images grid\n          <div className=\"grid grid-cols-2 gap-2\">\n            {visibleImages.slice(0, 4).map((image, index) => (\n              <div \n                key={index} \n                className={cn(\n                  \"relative group cursor-pointer\",\n                  index === 0 && visibleImages.length > 2 ? \"col-span-2\" : \"\",\n                  aspectRatioClasses[aspectRatio]\n                )}\n                onClick={() => openLightbox(index)}\n              >\n                <OptimizedImage\n                  src={image}\n                  alt={`Imagem ${index + 1} da galeria`}\n                  className=\"w-full h-full object-cover rounded-lg\"\n                />\n                \n                {/* Overlay for additional images */}\n                {index === 3 && images.length > 4 && (\n                  <div className=\"absolute inset-0 bg-black/60 rounded-lg flex items-center justify-center\">\n                    <span className=\"text-white text-lg font-semibold\">\n                      +{images.length - 4}\n                    </span>\n                  </div>\n                )}\n\n                {/* Hover effect */}\n                {enableLightbox && (\n                  <div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors rounded-lg flex items-center justify-center opacity-0 group-hover:opacity-100\">\n                    <ZoomIn className=\"w-4 h-4 text-white\" />\n                  </div>\n                )}\n              </div>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Lightbox */}\n      {enableLightbox && (\n        <Dialog open={isLightboxOpen} onOpenChange={setIsLightboxOpen}>\n          <DialogContent className=\"max-w-4xl w-full h-[80vh] p-0 bg-black\">\n            <div className=\"relative w-full h-full flex items-center justify-center\">\n              {/* Close button */}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                className=\"absolute top-4 right-4 z-10 bg-black/50 hover:bg-black/70 text-white\"\n                onClick={() => setIsLightboxOpen(false)}\n              >\n                <X className=\"w-4 h-4\" />\n              </Button>\n\n              {/* Navigation buttons */}\n              {images.length > 1 && (\n                <>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    className=\"absolute left-4 top-1/2 -translate-y-1/2 z-10 bg-black/50 hover:bg-black/70 text-white\"\n                    onClick={prevImage}\n                  >\n                    <ChevronLeft className=\"w-6 h-6\" />\n                  </Button>\n                  \n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    className=\"absolute right-4 top-1/2 -translate-y-1/2 z-10 bg-black/50 hover:bg-black/70 text-white\"\n                    onClick={nextImage}\n                  >\n                    <ChevronRight className=\"w-6 h-6\" />\n                  </Button>\n                </>\n              )}\n\n              {/* Current image */}\n              <OptimizedImage\n                src={images[currentImageIndex]}\n                alt={`Imagem ${currentImageIndex + 1} da galeria`}\n                className=\"max-w-full max-h-full object-contain\"\n              />\n\n              {/* Image counter */}\n              {images.length > 1 && (\n                <div className=\"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/50 text-white px-3 py-1 rounded-full text-sm\">\n                  {currentImageIndex + 1} / {images.length}\n                </div>\n              )}\n            </div>\n          </DialogContent>\n        </Dialog>\n      )}\n    </>\n  );\n});","size_bytes":7985},"client/src/components/loading-spinner.tsx":{"content":"import { Loader2 } from \"lucide-react\";\nimport Lottie from 'lottie-react';\nimport animationData from '@assets/Animation - 1716380534233_1752386084771.json';\n\ninterface LoadingSpinnerProps {\n  size?: \"sm\" | \"md\" | \"lg\";\n  className?: string;\n  variant?: \"simple\" | \"travel\";\n  message?: string;\n}\n\nexport function LoadingSpinner({ size = \"md\", className = \"\", variant = \"simple\", message = \"Preparando sua viagem...\" }: LoadingSpinnerProps) {\n  const sizeClasses = {\n    sm: \"h-4 w-4\",\n    md: \"h-8 w-8\",\n    lg: \"h-12 w-12\"\n  };\n\n  if (variant === \"travel\") {\n    return (\n      <div className={`flex flex-col items-center justify-center ${className}`}>\n        <div className=\"w-48 h-48 mb-4\">\n          <Lottie \n            animationData={animationData}\n            loop={true}\n            autoplay={true}\n            style={{ width: '100%', height: '100%' }}\n          />\n        </div>\n        {message && (\n          <p className=\"text-lg font-medium text-slate-600 dark:text-slate-400 text-center animate-pulse\">\n            {message}\n          </p>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div className={`flex items-center justify-center ${className}`}>\n      <Loader2 className={`animate-spin text-primary ${sizeClasses[size]}`} />\n    </div>\n  );\n}","size_bytes":1269},"client/src/components/navbar.tsx":{"content":"import { useAuth } from \"@/hooks/use-auth-snake\";\nimport { Link, useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { UserAvatar } from \"@/components/ui/user-avatar\";\nimport { NotificationCenter } from \"@/components/notification-center\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuSeparator, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\";\nimport { Sheet, SheetContent, SheetTrigger } from \"@/components/ui/sheet\";\nimport { \n  Search, \n  Plus, \n  Menu, \n  LayoutDashboard, \n  User, \n  LogOut,\n  Calendar,\n  Bell,\n  ChevronDown\n} from \"lucide-react\";\nimport logoImage from \"@assets/20250713_0013_Logo com Fundo Transparente_remix_01k00w7vt0fg184dm3z41h2sk1_1752377252367.png\";\n\nexport function Navbar() {\n  const { user, logout_mutation, is_loading } = useAuth();\n  const [location] = useLocation();\n\n  const navItems = [\n    { href: \"/dashboard\", label: \"Painel\", icon: LayoutDashboard },\n    { href: \"/search\", label: \"Buscar\", icon: Search, tourData: \"search-button\" },\n    { href: \"/activities\", label: \"Atividades\", icon: Calendar },\n    { href: \"/create-trip\", label: \"Criar\", icon: Plus, tourData: \"create-button\", highlight: true },\n  ];\n\n  const isActive = (href: string) => location === href || location.startsWith(href);\n\n  const handleLogout = () => {\n    logout_mutation.mutate();\n  };\n\n  // Loading state - Responsivo\n  if (is_loading) {\n    return (\n      <header className=\"bg-white/95 backdrop-blur-xl border-b border-slate-200/60 sticky top-0 z-50 shadow-sm\">\n        <div className=\"max-w-7xl mx-auto px-2 sm:px-4 lg:px-6 xl:px-8\">\n          <div className=\"flex justify-between items-center h-14 sm:h-16\">\n            <Link href=\"/\" className=\"flex items-center hover:opacity-80 transition-all duration-300\">\n              <img \n                src={logoImage} \n                alt=\"PartiuTrip - Viaje Junto, Gaste Menos\" \n                className=\"h-8 sm:h-10 w-auto max-w-[120px] sm:max-w-[160px] lg:max-w-[180px] object-contain\"\n              />\n            </Link>\n            <div className=\"flex items-center space-x-2 sm:space-x-3\">\n              <div className=\"w-6 sm:w-8 h-6 sm:h-8 bg-slate-200 rounded-full animate-pulse\"></div>\n              <div className=\"w-12 sm:w-20 h-6 sm:h-8 bg-slate-200 rounded-lg animate-pulse\"></div>\n            </div>\n          </div>\n        </div>\n      </header>\n    );\n  }\n\n  return (\n    <header className=\"bg-white/95 backdrop-blur-xl border-b border-slate-200/60 sticky top-0 z-50 shadow-sm\">\n      <div className=\"max-w-7xl mx-auto px-2 sm:px-4 lg:px-6 xl:px-8\">\n        <div className=\"flex justify-between items-center h-14 sm:h-16\">\n          {/* Logo - Responsivo */}\n          <Link href=\"/\" className=\"flex items-center hover:opacity-80 transition-all duration-300 flex-shrink-0\">\n            <img \n              src={logoImage} \n              alt=\"PartiuTrip - Viaje Junto, Gaste Menos\" \n              className=\"h-8 sm:h-10 w-auto max-w-[120px] sm:max-w-[160px] lg:max-w-[180px] object-contain\"\n            />\n          </Link>\n          \n          {user && (\n            <>\n              {/* Desktop Navigation - Adaptativo */}\n              <div className=\"hidden md:flex items-center space-x-1\">\n                {navItems.map((item) => {\n                  const Icon = item.icon;\n                  const active = isActive(item.href);\n                  return (\n                    <Link \n                      key={item.href} \n                      href={item.href} \n                      className={`flex items-center gap-1.5 lg:gap-2 px-2 lg:px-3 py-2 rounded-xl transition-all duration-300 font-medium text-xs lg:text-sm ${\n                          active\n                            ? \"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-lg shadow-blue-500/25\" \n                            : item.highlight\n                            ? \"text-blue-600 hover:text-white hover:bg-gradient-to-r hover:from-blue-500 hover:to-indigo-500 hover:shadow-lg hover:shadow-blue-500/25 border border-blue-200 hover:border-transparent\"\n                            : \"text-slate-600 hover:text-blue-600 hover:bg-blue-50\"\n                        }`}\n                      data-tour={item.tourData}\n                    >\n                        <Icon className={`h-4 w-4 ${active ? 'text-white' : ''} ${item.highlight && !active ? 'text-blue-600 group-hover:text-white' : ''}`} />\n                        <span className=\"hidden lg:block\">{item.label}</span>\n                    </Link>\n                  );\n                })}\n              </div>\n\n              {/* User Section - Responsivo */}\n              <div className=\"flex items-center space-x-1 sm:space-x-2\">\n                {/* Notifications - Desktop only */}\n                <div className=\"hidden lg:block\">\n                  <NotificationCenter />\n                </div>\n\n                {/* User Dropdown */}\n                <DropdownMenu>\n                  <DropdownMenuTrigger asChild>\n                    <Button \n                      variant=\"ghost\" \n                      className=\"flex items-center space-x-1 sm:space-x-2 hover:bg-blue-50 rounded-xl px-1 sm:px-2 py-2 transition-all duration-300 h-auto\"\n                    >\n                      <UserAvatar \n                        user={{\n                          full_name: user.full_name,\n                          profile_photo: user.profile_photo || undefined,\n                          is_verified: user.is_verified\n                        }}\n                        size=\"sm\"\n                        className=\"w-7 sm:w-8 h-7 sm:h-8 ring-2 ring-white shadow-md\"\n                      />\n                      <div className=\"hidden md:block text-left\">\n                        <div className=\"font-medium text-slate-700 text-sm leading-tight\">\n                          {user?.full_name?.split(' ')[0]}\n                        </div>\n                        <div className=\"text-xs text-slate-500 leading-tight max-w-20 truncate\">\n                          {user?.location || 'Viajante'}\n                        </div>\n                      </div>\n                      <ChevronDown className=\"h-3 w-3 text-slate-500 hidden md:block\" />\n                    </Button>\n                  </DropdownMenuTrigger>\n                  <DropdownMenuContent align=\"end\" className=\"w-60 mt-2 bg-white/95 backdrop-blur-xl border border-slate-200/60 shadow-xl rounded-xl\">\n                    {/* User Info Header */}\n                    <div className=\"px-3 py-3 border-b border-slate-100\">\n                      <div className=\"flex items-center space-x-3\">\n                        <UserAvatar \n                          user={{\n                            full_name: user.full_name,\n                            profile_photo: user.profile_photo || undefined,\n                            is_verified: user.is_verified\n                          }}\n                          size=\"md\"\n                          className=\"w-10 h-10\"\n                        />\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"font-medium text-slate-900 truncate\">{user?.full_name}</div>\n                          <div className=\"text-sm text-slate-500 truncate\">{user?.email}</div>\n                        </div>\n                      </div>\n                    </div>\n                    \n                    {/* Menu Items */}\n                    <div className=\"py-1\">\n                      <DropdownMenuItem asChild>\n                        <Link href=\"/profile\" className=\"flex items-center gap-3 px-3 py-2 hover:bg-slate-50 rounded-lg mx-1\">\n                          <User className=\"h-4 w-4 text-slate-500\" />\n                          <span>Meu Perfil</span>\n                        </Link>\n                      </DropdownMenuItem>\n                      <DropdownMenuItem asChild>\n                        <Link href=\"/dashboard\" className=\"flex items-center gap-3 px-3 py-2 hover:bg-slate-50 rounded-lg mx-1\">\n                          <LayoutDashboard className=\"h-4 w-4 text-slate-500\" />\n                          <span>Painel</span>\n                        </Link>\n                      </DropdownMenuItem>\n                    </div>\n                    \n                    <DropdownMenuSeparator className=\"my-1\" />\n                    \n                    <div className=\"py-1\">\n                      <DropdownMenuItem \n                        onClick={handleLogout}\n                        className=\"flex items-center gap-3 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg mx-1 cursor-pointer\"\n                      >\n                        <LogOut className=\"h-4 w-4\" />\n                        <span>Sair</span>\n                      </DropdownMenuItem>\n                    </div>\n                  </DropdownMenuContent>\n                </DropdownMenu>\n\n                {/* Mobile Menu */}\n                <div className=\"md:hidden\">\n                  <Sheet>\n                    <SheetTrigger asChild>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"sm\"\n                        className=\"p-1.5 sm:p-2 rounded-xl hover:bg-blue-50 text-slate-600 hover:text-blue-600 transition-all duration-300\"\n                      >\n                        <Menu className=\"h-4 sm:h-5 w-4 sm:w-5\" />\n                      </Button>\n                    </SheetTrigger>\n                    <SheetContent side=\"right\" className=\"w-72 xs:w-80 sm:w-96 bg-white/95 backdrop-blur-xl border-l border-slate-200/60\">\n                      <div className=\"flex flex-col h-full\">\n                        {/* Header */}\n                        <div className=\"flex items-center justify-between pb-6 border-b border-slate-100\">\n                          <img \n                            src={logoImage} \n                            alt=\"PartiuTrip\" \n                            className=\"h-8 w-auto object-contain\"\n                          />\n                        </div>\n\n                        {/* User Info */}\n                        <div className=\"flex items-center space-x-3 py-6 border-b border-slate-100\">\n                          <UserAvatar \n                            user={{\n                              full_name: user.full_name,\n                              profile_photo: user.profile_photo || undefined,\n                              is_verified: user.is_verified\n                            }}\n                            size=\"lg\"\n                            className=\"w-12 h-12 ring-2 ring-blue-100\"\n                          />\n                          <div className=\"flex-1 min-w-0\">\n                            <div className=\"font-semibold text-slate-900 truncate\">{user?.full_name}</div>\n                            <div className=\"text-sm text-slate-600 truncate\">{user?.email}</div>\n                            {user?.location && (\n                              <div className=\"text-xs text-slate-500 truncate\">{user.location}</div>\n                            )}\n                          </div>\n                        </div>\n\n                        {/* Navigation - Modern Design */}\n                        <nav className=\"flex-1 py-6 space-y-2\">\n                          <div className=\"space-y-2\">\n                            {navItems.map((item) => {\n                              const Icon = item.icon;\n                              const active = isActive(item.href);\n                              \n                              return (\n                                <Link key={item.href} href={item.href} className=\"group\">\n                                  <Button \n                                    variant=\"ghost\"\n                                    className={`relative w-full justify-start gap-3 h-12 rounded-xl transition-all duration-300 border group-hover:scale-[1.02] overflow-hidden ${\n                                      active\n                                        ? \"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg border-blue-500/20 hover:shadow-xl\" \n                                        : item.highlight\n                                        ? \"text-blue-600 hover:text-white hover:bg-gradient-to-r hover:from-blue-500 hover:to-indigo-500 border border-blue-200 hover:border-transparent hover:shadow-md\"\n                                        : \"text-slate-700 hover:text-blue-600 hover:bg-blue-50/80 border-transparent hover:border-blue-100 hover:shadow-md\"\n                                    }`}\n                                    data-tour={item.tourData}\n                                  >\n                                    <Icon className={`h-5 w-5 transition-colors duration-300 ${active ? 'text-white' : ''}`} />\n                                    <span className=\"font-medium\">{item.label}</span>\n                                    {active && (\n                                      <>\n                                        {/* Glow effect */}\n                                        <div className=\"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-indigo-400/20 rounded-xl blur-xl -z-10\"></div>\n                                        {/* Shimmer effect */}\n                                        <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-700\"></div>\n                                      </>\n                                    )}\n                                  </Button>\n                                </Link>\n                              );\n                            })}\n                          </div>\n                          \n                          {/* Profile & Logout - Modern Design */}\n                          <div className=\"pt-6 border-t border-slate-100 space-y-2\">\n                            <Link href=\"/profile\" className=\"group\">\n                              <Button variant=\"ghost\" className=\"w-full justify-start gap-3 h-12 rounded-xl text-slate-700 hover:text-blue-600 hover:bg-blue-50/80 border border-transparent hover:border-blue-100 hover:shadow-md transition-all duration-300 group-hover:scale-[1.02]\">\n                                <User className=\"h-5 w-5 transition-colors duration-300\" />\n                                <span className=\"font-medium\">Meu Perfil</span>\n                              </Button>\n                            </Link>\n                            \n                            <Button \n                              variant=\"ghost\" \n                              onClick={handleLogout}\n                              className=\"group w-full justify-start gap-3 h-12 rounded-xl text-red-600 hover:text-red-700 hover:bg-red-50/80 border border-transparent hover:border-red-100 hover:shadow-md transition-all duration-300 group-hover:scale-[1.02]\"\n                            >\n                              <LogOut className=\"h-5 w-5 transition-colors duration-300\" />\n                              <span className=\"font-medium\">Sair</span>\n                            </Button>\n                          </div>\n                        </nav>\n                      </div>\n                    </SheetContent>\n                  </Sheet>\n                </div>\n              </div>\n            </>\n          )}\n\n          {/* Guest Navigation - Totalmente Responsivo */}\n          {!user && (\n            <div className=\"flex items-center space-x-1 xs:space-x-2 sm:space-x-3\">\n              <Link href=\"/auth\" className=\"group\">\n                <Button \n                  variant=\"ghost\" \n                  className=\"relative text-slate-600 hover:text-blue-600 hover:bg-blue-50/80 rounded-xl px-2 xs:px-3 sm:px-4 lg:px-6 py-2 sm:py-2.5 font-medium transition-all duration-300 text-xs sm:text-sm backdrop-blur-sm border border-transparent hover:border-blue-100 hover:shadow-md group-hover:scale-105\"\n                >\n                  <span className=\"relative z-10\">Entrar</span>\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-blue-50 to-indigo-50 opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-xl\"></div>\n                </Button>\n              </Link>\n              <Link href=\"/auth\" className=\"group\">\n                <Button className=\"relative bg-gradient-to-r from-blue-600 via-blue-700 to-indigo-600 hover:from-blue-700 hover:via-blue-800 hover:to-indigo-700 text-white font-semibold px-3 xs:px-4 sm:px-5 lg:px-8 py-2 sm:py-2.5 rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 text-xs sm:text-sm group-hover:scale-105 border border-blue-500/20 overflow-hidden\">\n                  <span className=\"relative z-10 flex items-center gap-1 sm:gap-2\">\n                    <span className=\"hidden xs:inline\">Cadastrar</span>\n                    <span className=\"xs:hidden\">+</span>\n                    <svg className=\"w-3 sm:w-4 h-3 sm:h-4 transition-transform duration-300 group-hover:translate-x-0.5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 7l5 5m0 0l-5 5m5-5H6\" />\n                    </svg>\n                  </span>\n                  {/* Shimmer effect */}\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-transparent via-white/10 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-700\"></div>\n                  {/* Glow effect */}\n                  <div className=\"absolute inset-0 bg-gradient-to-r from-blue-400/20 to-indigo-400/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 rounded-xl blur-xl -z-10\"></div>\n                </Button>\n              </Link>\n            </div>\n          )}\n        </div>\n      </div>\n    </header>\n  );\n}","size_bytes":17976},"client/src/components/notification-center.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { Bell, X, CheckCircle, AlertCircle, Info, MessageSquare } from 'lucide-react';\nimport { Button } from './ui/button';\nimport { Badge } from './ui/badge';\nimport { Popover, PopoverContent, PopoverTrigger } from './ui/popover';\n// import { ScrollArea } from './ui/scroll-area'; // Comentado pois o componente n√£o existe ainda\nimport { cn } from '@/lib/utils';\nimport { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\n\ninterface Notification {\n  id: number;\n  type: 'info' | 'success' | 'warning' | 'message';\n  title: string;\n  message: string;\n  isRead: boolean;\n  createdAt: string;\n  actionUrl?: string;\n}\n\nexport function NotificationCenter() {\n  const [isOpen, setIsOpen] = useState(false);\n  const queryClient = useQueryClient();\n\n  const { data: notificationsData = [], isLoading } = useQuery({\n    queryKey: ['/api/notifications'],\n    refetchInterval: 30000, // Refetch every 30 seconds\n  });\n  \n  const notifications = notificationsData as Notification[];\n\n  const markAsReadMutation = useMutation({\n    mutationFn: async (notificationId: number) => {\n      const response = await fetch(`/api/notifications/${notificationId}/read`, {\n        method: 'PATCH',\n        credentials: 'include'\n      });\n      if (!response.ok) throw new Error('Failed to mark as read');\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications'] });\n    }\n  });\n\n  const markAllAsReadMutation = useMutation({\n    mutationFn: async () => {\n      const response = await fetch('/api/notifications/mark-all-read', {\n        method: 'PATCH',\n        credentials: 'include'\n      });\n      if (!response.ok) throw new Error('Failed to mark all as read');\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: ['/api/notifications'] });\n    }\n  });\n\n  const unreadCount = notifications.filter((n: Notification) => !n.isRead).length;\n\n  const getIcon = (type: string) => {\n    switch (type) {\n      case 'success':\n        return <CheckCircle className=\"w-4 h-4 text-green-600\" />;\n      case 'warning':\n        return <AlertCircle className=\"w-4 h-4 text-yellow-600\" />;\n      case 'message':\n        return <MessageSquare className=\"w-4 h-4 text-blue-600\" />;\n      default:\n        return <Info className=\"w-4 h-4 text-blue-600\" />;\n    }\n  };\n\n  const handleNotificationClick = (notification: Notification) => {\n    if (!notification.isRead) {\n      markAsReadMutation.mutate(notification.id);\n    }\n    \n    if (notification.actionUrl) {\n      window.location.href = notification.actionUrl;\n    }\n  };\n\n  return (\n    <Popover open={isOpen} onOpenChange={setIsOpen}>\n      <PopoverTrigger asChild>\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          className=\"relative h-9 w-9 p-0\"\n        >\n          <Bell className=\"h-4 w-4\" />\n          {unreadCount > 0 && (\n            <Badge\n              variant=\"destructive\"\n              className=\"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-[10px]\"\n            >\n              {unreadCount > 9 ? '9+' : unreadCount}\n            </Badge>\n          )}\n        </Button>\n      </PopoverTrigger>\n\n      <PopoverContent className=\"w-80 p-0\" align=\"end\">\n        <div className=\"flex items-center justify-between p-4 border-b\">\n          <h3 className=\"font-semibold\">Notifica√ß√µes</h3>\n          {unreadCount > 0 && (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => markAllAsReadMutation.mutate()}\n              disabled={markAllAsReadMutation.isPending}\n            >\n              Marcar todas como lidas\n            </Button>\n          )}\n        </div>\n\n        <div className=\"h-80 overflow-y-auto\">\n          {isLoading ? (\n            <div className=\"flex items-center justify-center py-8\">\n              <div className=\"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600\"></div>\n            </div>\n          ) : notifications.length === 0 ? (\n            <div className=\"flex flex-col items-center justify-center py-8 text-center\">\n              <Bell className=\"w-8 h-8 text-gray-400 mb-2\" />\n              <p className=\"text-sm text-gray-500\">Nenhuma notifica√ß√£o</p>\n            </div>\n          ) : (\n            <div className=\"divide-y\">\n              {notifications.map((notification) => (\n                <div\n                  key={notification.id}\n                  className={cn(\n                    \"p-4 cursor-pointer hover:bg-gray-50 transition-colors\",\n                    !notification.isRead && \"bg-blue-50\"\n                  )}\n                  onClick={() => handleNotificationClick(notification)}\n                >\n                  <div className=\"flex items-start space-x-3\">\n                    <div className=\"flex-shrink-0 mt-1\">\n                      {getIcon(notification.type)}\n                    </div>\n                    <div className=\"flex-1 min-w-0\">\n                      <div className=\"flex items-center justify-between\">\n                        <p className={cn(\n                          \"text-sm font-medium truncate\",\n                          !notification.isRead && \"text-gray-900\",\n                          notification.isRead && \"text-gray-600\"\n                        )}>\n                          {notification.title}\n                        </p>\n                        {!notification.isRead && (\n                          <div className=\"w-2 h-2 bg-blue-600 rounded-full flex-shrink-0 ml-2\"></div>\n                        )}\n                      </div>\n                      <p className=\"text-sm text-gray-500 mt-1 line-clamp-2\">\n                        {notification.message}\n                      </p>\n                      <p className=\"text-xs text-gray-400 mt-2\">\n                        {new Date(notification.createdAt).toLocaleString('pt-BR')}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </PopoverContent>\n    </Popover>\n  );\n}","size_bytes":6172},"client/src/components/onboarding-tour.tsx":{"content":"import React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { Progress } from '@/components/ui/progress';\nimport { \n  MapPin, \n  Users, \n  DollarSign, \n  Calendar, \n  MessageCircle, \n  Star,\n  ArrowRight,\n  ArrowLeft,\n  X,\n  CheckCircle,\n  Sparkles,\n  Target,\n  Heart,\n  Shield\n} from 'lucide-react';\n\ninterface OnboardingStep {\n  id: string;\n  title: string;\n  description: string;\n  icon: React.ReactNode;\n  target?: string;\n  position: 'top' | 'bottom' | 'left' | 'right' | 'center';\n  highlight?: boolean;\n  action?: {\n    label: string;\n    href?: string;\n    onClick?: () => void;\n  };\n}\n\ninterface OnboardingTourProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onComplete: () => void;\n  userPreferences?: {\n    travel_style?: string;\n    interests?: string[];\n    experience?: 'iniciante' | 'intermediario' | 'experiente';\n  };\n}\n\nconst getPersonalizedSteps = (preferences?: OnboardingTourProps['userPreferences']): OnboardingStep[] => {\n  const baseSteps: OnboardingStep[] = [\n    {\n      id: 'welcome',\n      title: 'Bem-vindo ao ViajaJunto! üéâ',\n      description: 'Estamos animados para te ajudar a descobrir o mundo de forma mais econ√¥mica e divertida!',\n      icon: <Sparkles className=\"w-6 h-6 text-yellow-400\" />,\n      position: 'center',\n      highlight: true\n    },\n    {\n      id: 'concept',\n      title: 'Como Funciona',\n      description: 'Conecte-se com viajantes que compartilham seus interesses e divida custos de hospedagem, transporte e atividades.',\n      icon: <Users className=\"w-6 h-6 text-blue-400\" />,\n      position: 'center'\n    },\n    {\n      id: 'savings',\n      title: 'Economize at√© 65%',\n      description: 'Nossos usu√°rios economizam em m√©dia 65% dividindo custos de viagem com outros viajantes.',\n      icon: <DollarSign className=\"w-6 h-6 text-green-400\" />,\n      position: 'center'\n    },\n    {\n      id: 'search',\n      title: 'Explore Viagens',\n      description: 'Use nossa busca avan√ßada para encontrar viagens que combinam com seu perfil e or√ßamento.',\n      icon: <MapPin className=\"w-6 h-6 text-purple-400\" />,\n      position: 'top',\n      target: '[data-tour=\"search-button\"]',\n      action: {\n        label: 'Ver Busca',\n        href: '/search'\n      }\n    },\n    {\n      id: 'create',\n      title: 'Crie Sua Viagem',\n      description: 'Planeje sua pr√≥pria aventura e convide outros viajantes para se juntarem a voc√™.',\n      icon: <Calendar className=\"w-6 h-6 text-orange-400\" />,\n      position: 'top',\n      target: '[data-tour=\"create-button\"]',\n      action: {\n        label: 'Criar Viagem',\n        href: '/create-trip'\n      }\n    },\n    {\n      id: 'safety',\n      title: 'Seguran√ßa em Primeiro Lugar',\n      description: 'Todos os perfis s√£o verificados e temos um sistema de avalia√ß√µes para garantir sua seguran√ßa.',\n      icon: <Shield className=\"w-6 h-6 text-red-400\" />,\n      position: 'center'\n    }\n  ];\n\n  // Personalizar baseado nas prefer√™ncias do usu√°rio\n  if (preferences?.travel_style) {\n    const styleMessages = {\n      'aventura': 'Perfeito para aventureiros! Voc√™ encontrar√° muitos companheiros para trilhas, escaladas e esportes radicais.',\n      'praia': '√ìtima escolha! Temos muitas viagens para localidades paradis√≠acas e resorts.',\n      'cultura': 'Excelente! Conecte-se com viajantes que amam museus, arquitetura e experi√™ncias culturais.',\n      'natureza': 'Maravilhoso! Encontre companheiros para parques nacionais e ecoturismo.',\n      'urbanas': 'Perfeito! Explore grandes cidades com outros viajantes urbanos.'\n    };\n\n    baseSteps.splice(2, 0, {\n      id: 'personalized',\n      title: `Viagens de ${preferences.travel_style}`,\n      description: styleMessages[preferences.travel_style as keyof typeof styleMessages] || 'Encontraremos viagens perfeitas para seu estilo!',\n      icon: <Target className=\"w-6 h-6 text-pink-400\" />,\n      position: 'center'\n    });\n  }\n\n  if (preferences?.experience === 'iniciante') {\n    baseSteps.push({\n      id: 'beginner-tip',\n      title: 'Dica para Iniciantes',\n      description: 'Comece com viagens curtas e grupos pequenos. Nossa comunidade √© super acolhedora para novos viajantes!',\n      icon: <Heart className=\"w-6 h-6 text-pink-400\" />,\n      position: 'center'\n    });\n  }\n\n  return baseSteps;\n};\n\nexport function OnboardingTour({ isOpen, onClose, onComplete, userPreferences }: OnboardingTourProps) {\n  const [currentStep, setCurrentStep] = useState(0);\n  const [steps] = useState(() => getPersonalizedSteps(userPreferences));\n  const [isVisible, setIsVisible] = useState(false);\n\n  useEffect(() => {\n    if (isOpen) {\n      setIsVisible(true);\n    }\n  }, [isOpen]);\n\n  const handleNext = () => {\n    if (currentStep < steps.length - 1) {\n      setCurrentStep(currentStep + 1);\n    } else {\n      handleComplete();\n    }\n  };\n\n  const handlePrevious = () => {\n    if (currentStep > 0) {\n      setCurrentStep(currentStep - 1);\n    }\n  };\n\n  const handleComplete = () => {\n    setIsVisible(false);\n    setTimeout(() => {\n      onComplete();\n      onClose();\n    }, 300);\n  };\n\n  const handleSkip = () => {\n    setIsVisible(false);\n    setTimeout(() => {\n      onClose();\n    }, 300);\n  };\n\n  const currentStepData = steps[currentStep];\n  const progress = ((currentStep + 1) / steps.length) * 100;\n\n  if (!isOpen) return null;\n\n  return (\n    <AnimatePresence>\n      {isVisible && (\n        <>\n          {/* Overlay */}\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"fixed inset-0 bg-black/70 z-50 backdrop-blur-sm\"\n            onClick={handleSkip}\n          />\n\n          {/* Tour Card */}\n          <motion.div\n            initial={{ opacity: 0, scale: 0.9, y: 20 }}\n            animate={{ opacity: 1, scale: 1, y: 0 }}\n            exit={{ opacity: 0, scale: 0.9, y: 20 }}\n            className=\"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none\"\n          >\n            <Card className=\"w-full max-w-md bg-white dark:bg-gray-800 shadow-2xl border-0 pointer-events-auto\">\n              <CardHeader className=\"pb-4\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-3\">\n                    {currentStepData.icon}\n                    <Badge variant=\"secondary\" className=\"text-xs\">\n                      {currentStep + 1} de {steps.length}\n                    </Badge>\n                  </div>\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={handleSkip}\n                    className=\"h-8 w-8 p-0 hover:bg-gray-100 dark:hover:bg-gray-700\"\n                  >\n                    <X className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n                \n                <Progress value={progress} className=\"w-full h-2 mt-2\" />\n                \n                <CardTitle className=\"text-xl font-bold text-gray-900 dark:text-white\">\n                  {currentStepData.title}\n                </CardTitle>\n              </CardHeader>\n\n              <CardContent className=\"space-y-6\">\n                <CardDescription className=\"text-gray-600 dark:text-gray-300 text-base leading-relaxed\">\n                  {currentStepData.description}\n                </CardDescription>\n\n                {currentStepData.highlight && (\n                  <motion.div\n                    initial={{ scale: 0.95 }}\n                    animate={{ scale: 1 }}\n                    transition={{ duration: 0.3 }}\n                    className=\"p-4 bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800\"\n                  >\n                    <div className=\"flex items-center gap-2 text-yellow-800 dark:text-yellow-200\">\n                      <Star className=\"w-4 h-4\" />\n                      <span className=\"font-medium text-sm\">Bem-vindo √† comunidade!</span>\n                    </div>\n                  </motion.div>\n                )}\n\n                {currentStepData.action && (\n                  <motion.div\n                    initial={{ opacity: 0, y: 10 }}\n                    animate={{ opacity: 1, y: 0 }}\n                    transition={{ delay: 0.2 }}\n                  >\n                    <Button\n                      asChild\n                      className=\"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-semibold\"\n                      onClick={() => {\n                        if (currentStepData.action?.onClick) {\n                          currentStepData.action.onClick();\n                        }\n                      }}\n                    >\n                      {currentStepData.action.href ? (\n                        <a href={currentStepData.action.href}>\n                          {currentStepData.action.label}\n                          <ArrowRight className=\"ml-2 h-4 w-4\" />\n                        </a>\n                      ) : (\n                        <span>\n                          {currentStepData.action.label}\n                          <ArrowRight className=\"ml-2 h-4 w-4\" />\n                        </span>\n                      )}\n                    </Button>\n                  </motion.div>\n                )}\n\n                <div className=\"flex justify-between items-center pt-4 border-t border-gray-200 dark:border-gray-700\">\n                  <Button\n                    variant=\"ghost\"\n                    onClick={handlePrevious}\n                    disabled={currentStep === 0}\n                    className=\"flex items-center gap-2\"\n                  >\n                    <ArrowLeft className=\"h-4 w-4\" />\n                    Anterior\n                  </Button>\n\n                  <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                    {currentStep + 1} / {steps.length}\n                  </div>\n\n                  <Button\n                    onClick={handleNext}\n                    className=\"flex items-center gap-2 bg-blue-600 hover:bg-blue-700\"\n                  >\n                    {currentStep === steps.length - 1 ? (\n                      <>\n                        <CheckCircle className=\"h-4 w-4\" />\n                        Finalizar\n                      </>\n                    ) : (\n                      <>\n                        Pr√≥ximo\n                        <ArrowRight className=\"h-4 w-4\" />\n                      </>\n                    )}\n                  </Button>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        </>\n      )}\n    </AnimatePresence>\n  );\n}\n\n// Hook para controlar o tour\nexport function useOnboardingTour() {\n  const [isOpen, setIsOpen] = useState(false);\n  const [isCompleted, setIsCompleted] = useState(false);\n\n  useEffect(() => {\n    // Verificar se o usu√°rio j√° completou o tour\n    const completed = localStorage.getItem('onboarding-completed');\n    if (completed === 'true') {\n      setIsCompleted(true);\n    }\n  }, []);\n\n  const startTour = () => {\n    setIsOpen(true);\n  };\n\n  const closeTour = () => {\n    setIsOpen(false);\n  };\n\n  const completeTour = () => {\n    setIsCompleted(true);\n    localStorage.setItem('onboarding-completed', 'true');\n    localStorage.setItem('onboarding-completed-date', new Date().toISOString());\n  };\n\n  const resetTour = () => {\n    setIsCompleted(false);\n    localStorage.removeItem('onboarding-completed');\n    localStorage.removeItem('onboarding-completed-date');\n  };\n\n  return {\n    isOpen,\n    isCompleted,\n    startTour,\n    closeTour,\n    completeTour,\n    resetTour\n  };\n}","size_bytes":11960},"client/src/components/optimized-image.tsx":{"content":"import { useState, ImgHTMLAttributes } from 'react';\nimport { cn } from '@/lib/utils';\nimport { LoadingSpinner } from './ui/loading-spinner';\n\ninterface OptimizedImageProps extends Omit<ImgHTMLAttributes<HTMLImageElement>, 'onLoad' | 'onError'> {\n  src: string;\n  alt: string;\n  fallbackSrc?: string;\n  className?: string;\n  loaderClassName?: string;\n  errorClassName?: string;\n  showLoader?: boolean;\n}\n\nexport function OptimizedImage({\n  src,\n  alt,\n  fallbackSrc,\n  className,\n  loaderClassName,\n  errorClassName,\n  showLoader = true,\n  ...props\n}: OptimizedImageProps) {\n  const [isLoading, setIsLoading] = useState(true);\n  const [hasError, setHasError] = useState(false);\n  const [currentSrc, setCurrentSrc] = useState(src);\n\n  const handleLoad = () => {\n    setIsLoading(false);\n    setHasError(false);\n  };\n\n  const handleError = () => {\n    setIsLoading(false);\n    if (fallbackSrc && currentSrc !== fallbackSrc) {\n      setCurrentSrc(fallbackSrc);\n      setHasError(false);\n    } else {\n      setHasError(true);\n    }\n  };\n\n  if (hasError) {\n    return (\n      <div \n        className={cn(\n          \"flex items-center justify-center bg-gray-100 text-gray-400\",\n          errorClassName,\n          className\n        )}\n      >\n        <div className=\"text-center\">\n          <div className=\"text-lg mb-1\">üì∑</div>\n          <div className=\"text-xs\">Imagem n√£o dispon√≠vel</div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"relative\">\n      {isLoading && showLoader && (\n        <div \n          className={cn(\n            \"absolute inset-0 flex items-center justify-center bg-gray-100\",\n            loaderClassName\n          )}\n        >\n          <LoadingSpinner size=\"sm\" />\n        </div>\n      )}\n      \n      <img\n        src={currentSrc}\n        alt={alt}\n        className={cn(\n          \"transition-opacity duration-300\",\n          isLoading && \"opacity-0\",\n          className\n        )}\n        onLoad={handleLoad}\n        onError={handleError}\n        {...props}\n      />\n    </div>\n  );\n}","size_bytes":2038},"client/src/components/performance-optimized-list.tsx":{"content":"import React, { useMemo, useCallback } from 'react';\nimport { FixedSizeList as List } from 'react-window';\nimport { LoadingSpinner } from './ui/loading-spinner';\nimport { Skeleton } from './ui/skeleton';\n\ninterface PerformanceOptimizedListProps<T> {\n  items: T[];\n  renderItem: (item: T, index: number) => React.ReactNode;\n  itemHeight: number;\n  height: number;\n  loading?: boolean;\n  className?: string;\n  emptyMessage?: string;\n  loadingCount?: number;\n}\n\n// Memoized item component to prevent unnecessary re-renders\nconst MemoizedListItem = React.memo(({ \n  index, \n  style, \n  data \n}: { \n  index: number; \n  style: React.CSSProperties; \n  data: { items: any[]; renderItem: (item: any, index: number) => React.ReactNode }; \n}) => {\n  const { items, renderItem } = data;\n  const item = items[index];\n  \n  return (\n    <div style={style}>\n      {renderItem(item, index)}\n    </div>\n  );\n});\n\nMemoizedListItem.displayName = 'MemoizedListItem';\n\nexport function PerformanceOptimizedList<T>({\n  items,\n  renderItem,\n  itemHeight,\n  height,\n  loading = false,\n  className,\n  emptyMessage = 'Nenhum item encontrado',\n  loadingCount = 6\n}: PerformanceOptimizedListProps<T>) {\n  \n  const itemData = useMemo(() => ({\n    items,\n    renderItem\n  }), [items, renderItem]);\n\n  const memoizedRenderItem = useCallback(\n    (props: { index: number; style: React.CSSProperties; data: typeof itemData }) => (\n      <MemoizedListItem {...props} />\n    ),\n    []\n  );\n\n  if (loading) {\n    return (\n      <div className={className}>\n        <div className=\"space-y-4\">\n          {Array.from({ length: loadingCount }).map((_, index) => (\n            <Skeleton \n              key={index} \n              className=\"w-full rounded-lg\" \n              style={{ height: itemHeight }}\n            />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  if (items.length === 0) {\n    return (\n      <div className={`flex flex-col items-center justify-center py-12 ${className}`}>\n        <div className=\"text-gray-400 text-6xl mb-4\">üì≠</div>\n        <p className=\"text-gray-600 text-lg\">{emptyMessage}</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className={className}>\n      <List\n        height={height}\n        itemCount={items.length}\n        itemSize={itemHeight}\n        itemData={itemData}\n        overscanCount={5} // Render 5 items outside visible area for smooth scrolling\n      >\n        {memoizedRenderItem}\n      </List>\n    </div>\n  );\n}","size_bytes":2436},"client/src/components/places-autocomplete.tsx":{"content":"import { useEffect, useRef, useState } from \"react\";\nimport { Input } from \"@/components/ui/input\";\nimport { MapPin, ChevronDown, X } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { cn } from \"@/lib/utils\";\n\ninterface Destination {\n  id: number;\n  name: string;\n  state?: string;\n  country: string;\n  region?: string;\n  continent: string;\n}\n\ninterface PlacesAutocompleteProps {\n  value: string;\n  onChange: (value: string) => void;\n  onDestinationSelect?: (destination: Destination) => void;\n  placeholder?: string;\n  className?: string;\n}\n\nexport function PlacesAutocomplete({ \n  value, \n  onChange, \n  onDestinationSelect,\n  placeholder = \"Buscar destinos...\",\n  className = \"\" \n}: PlacesAutocompleteProps) {\n  const [open, setOpen] = useState(false);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  // Fetch destinations from API - always fetch to show initial options\n  const { data: destinations = [], isLoading } = useQuery({\n    queryKey: ['/api/destinations', searchTerm],\n    queryFn: async () => {\n      const params = new URLSearchParams();\n      if (searchTerm.trim()) {\n        params.append('search', searchTerm.trim());\n      }\n      const response = await fetch(`/api/destinations?${params}`);\n      if (!response.ok) {\n        throw new Error('Failed to fetch destinations');\n      }\n      return response.json();\n    }\n  });\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (containerRef.current && !containerRef.current.contains(event.target as Node)) {\n        setOpen(false);\n      }\n    };\n\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n\n  const handleSelect = (destination: Destination) => {\n    const displayName = destination.state \n      ? `${destination.name}, ${destination.state}` \n      : `${destination.name}, ${destination.country}`;\n    \n    onChange(displayName);\n    onDestinationSelect?.(destination);\n    setOpen(false);\n    setSearchTerm(\"\");\n  };\n\n  const handleInputChange = (inputValue: string) => {\n    onChange(inputValue);\n    setSearchTerm(inputValue);\n    setOpen(true);\n  };\n\n  const handleInputFocus = () => {\n    setOpen(true);\n    setSearchTerm(value);\n  };\n\n  const handleToggleOpen = (e: React.MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setOpen(!open);\n  };\n\n  return (\n    <div ref={containerRef} className=\"relative w-full\">\n      <div className=\"relative\">\n        <MapPin className=\"absolute left-3 top-3 h-4 w-4 text-gray-500 z-10\" />\n        <Input\n          value={value}\n          onChange={(e) => handleInputChange(e.target.value)}\n          placeholder={placeholder}\n          className={cn(\"pl-10 pr-10\", className)}\n          autoComplete=\"off\"\n          onFocus={handleInputFocus}\n          onClick={() => setOpen(true)}\n        />\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          className=\"absolute right-1 top-1 h-8 w-8 p-0\"\n          onClick={handleToggleOpen}\n          type=\"button\"\n          tabIndex={-1}\n        >\n          <ChevronDown className={`h-4 w-4 text-gray-500 transition-transform ${open ? 'rotate-180' : ''}`} />\n        </Button>\n      </div>\n      \n      {open && (\n        <div className=\"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-auto\">\n          {isLoading ? (\n            <div className=\"px-4 py-2 text-sm text-gray-500\">Carregando destinos...</div>\n          ) : destinations.length === 0 ? (\n            <div className=\"px-4 py-2 text-sm text-gray-500\">Nenhum destino encontrado.</div>\n          ) : (\n            <div className=\"py-1\">\n              {destinations.slice(0, 10).map((destination: Destination) => {\n                const displayName = destination.state \n                  ? `${destination.name}, ${destination.state}` \n                  : `${destination.name}, ${destination.country}`;\n                \n                return (\n                  <button\n                    key={destination.id}\n                    className=\"w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center space-x-2\"\n                    onClick={() => handleSelect(destination)}\n                  >\n                    <MapPin className=\"h-4 w-4 text-gray-400\" />\n                    <div className=\"flex flex-col\">\n                      <span className=\"text-sm font-medium\">{displayName}</span>\n                      {destination.region && (\n                        <span className=\"text-xs text-gray-500\">{destination.region}</span>\n                      )}\n                    </div>\n                  </button>\n                );\n              })}\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}","size_bytes":4966},"client/src/components/search-filters-panel.tsx":{"content":"import { useState } from 'react';\nimport { Button } from './ui/button';\nimport { Input } from './ui/input';\nimport { Label } from './ui/label';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from './ui/select';\nimport { Slider } from './ui/slider';\nimport { Card, CardContent, CardHeader, CardTitle } from './ui/card';\nimport { Badge } from './ui/badge';\nimport { Separator } from './ui/separator';\nimport { Collapsible, CollapsibleContent, CollapsibleTrigger } from './ui/collapsible';\nimport { \n  Search,\n  MapPin,\n  Calendar,\n  DollarSign,\n  Users,\n  Star,\n  Filter,\n  X,\n  ChevronDown,\n  ChevronUp\n} from 'lucide-react';\nimport { cn } from '@/lib/utils';\nimport { formatBrazilianCurrency } from '@shared/utils';\n\ninterface SearchFilters {\n  query: string;\n  destination: string;\n  startDate: string;\n  endDate: string;\n  budgetRange: [number, number];\n  max_participants: number;\n  travel_styles: string[];\n  minRating: number;\n  sortBy: string;\n}\n\ninterface SearchFiltersPanelProps {\n  filters: SearchFilters;\n  onFiltersChange: (filters: SearchFilters) => void;\n  onClearFilters: () => void;\n  resultsCount: number;\n  className?: string;\n}\n\nconst travel_styles = [\n  { id: 'praia', name: 'Praia', color: 'bg-blue-100 text-blue-800' },\n  { id: 'aventura', name: 'Aventura', color: 'bg-green-100 text-green-800' },\n  { id: 'urbanas', name: 'Urbanas', color: 'bg-gray-100 text-gray-800' },\n  { id: 'cultural', name: 'Cultural', color: 'bg-purple-100 text-purple-800' },\n  { id: 'natureza', name: 'Natureza', color: 'bg-emerald-100 text-emerald-800' },\n  { id: 'neve', name: 'Neve', color: 'bg-cyan-100 text-cyan-800' }\n];\n\nconst sortOptions = [\n  { value: 'relevance', label: 'Mais Relevantes' },\n  { value: 'date', label: 'Data de In√≠cio' },\n  { value: 'budget-low', label: 'Menor Pre√ßo' },\n  { value: 'budget-high', label: 'Maior Pre√ßo' },\n  { value: 'rating', label: 'Melhor Avalia√ß√£o' },\n  { value: 'participants', label: 'Mais Procuradas' }\n];\n\nexport function SearchFiltersPanel({\n  filters,\n  onFiltersChange,\n  onClearFilters,\n  resultsCount,\n  className\n}: SearchFiltersPanelProps) {\n  const [expandedSections, setExpandedSections] = useState({\n    destination: true,\n    dates: true,\n    budget: true,\n    preferences: false,\n    rating: false\n  });\n\n  const toggleSection = (section: keyof typeof expandedSections) => {\n    setExpandedSections(prev => ({\n      ...prev,\n      [section]: !prev[section]\n    }));\n  };\n\n  const updateFilters = (updates: Partial<SearchFilters>) => {\n    onFiltersChange({ ...filters, ...updates });\n  };\n\n  const toggleTravelStyle = (styleId: string) => {\n    const newStyles = filters.travel_styles.includes(styleId)\n      ? filters.travel_styles.filter((s: string) => s !== styleId)\n      : [...filters.travel_styles, styleId];\n    \n    updateFilters({ travel_styles: newStyles });\n  };\n\n  const hasActiveFilters = \n    filters.query ||\n    filters.destination ||\n    filters.startDate ||\n    filters.endDate ||\n    filters.budgetRange[0] > 0 ||\n    filters.budgetRange[1] < 10000 ||\n    filters.max_participants < 20 ||\n    filters.travel_styles.length > 0 ||\n    filters.minRating > 0;\n\n  return (\n    <Card className={cn(\"sticky top-24\", className)}>\n      <CardHeader className=\"pb-4\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-lg flex items-center\">\n            <Filter className=\"w-5 h-5 mr-2\" />\n            Filtros\n          </CardTitle>\n          {hasActiveFilters && (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={onClearFilters}\n              className=\"text-blue-600 hover:text-blue-700\"\n            >\n              <X className=\"w-4 h-4 mr-1\" />\n              Limpar\n            </Button>\n          )}\n        </div>\n        \n        {resultsCount > 0 && (\n          <p className=\"text-sm text-gray-600\">\n            {resultsCount} viagens encontradas\n          </p>\n        )}\n      </CardHeader>\n\n      <CardContent className=\"space-y-6\">\n        {/* Search Query */}\n        <div className=\"space-y-2\">\n          <Label htmlFor=\"search-query\">Buscar</Label>\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400\" />\n            <Input\n              id=\"search-query\"\n              placeholder=\"T√≠tulo, descri√ß√£o ou destino...\"\n              value={filters.query}\n              onChange={(e) => updateFilters({ query: e.target.value })}\n              className=\"pl-10\"\n            />\n          </div>\n        </div>\n\n        {/* Destination */}\n        <Collapsible\n          open={expandedSections.destination}\n          onOpenChange={() => toggleSection('destination')}\n        >\n          <CollapsibleTrigger asChild>\n            <Button variant=\"ghost\" className=\"w-full justify-between p-0 h-auto\">\n              <div className=\"flex items-center\">\n                <MapPin className=\"w-4 h-4 mr-2\" />\n                <span className=\"font-medium\">Destino</span>\n              </div>\n              {expandedSections.destination ? \n                <ChevronUp className=\"w-4 h-4\" /> : \n                <ChevronDown className=\"w-4 h-4\" />\n              }\n            </Button>\n          </CollapsibleTrigger>\n          <CollapsibleContent className=\"space-y-2 mt-2\">\n            <Input\n              placeholder=\"Digite o destino...\"\n              value={filters.destination}\n              onChange={(e) => updateFilters({ destination: e.target.value })}\n            />\n          </CollapsibleContent>\n        </Collapsible>\n\n        <Separator />\n\n        {/* Dates */}\n        <Collapsible\n          open={expandedSections.dates}\n          onOpenChange={() => toggleSection('dates')}\n        >\n          <CollapsibleTrigger asChild>\n            <Button variant=\"ghost\" className=\"w-full justify-between p-0 h-auto\">\n              <div className=\"flex items-center\">\n                <Calendar className=\"w-4 h-4 mr-2\" />\n                <span className=\"font-medium\">Datas</span>\n              </div>\n              {expandedSections.dates ? \n                <ChevronUp className=\"w-4 h-4\" /> : \n                <ChevronDown className=\"w-4 h-4\" />\n              }\n            </Button>\n          </CollapsibleTrigger>\n          <CollapsibleContent className=\"space-y-3 mt-2\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"start-date\">Data de In√≠cio</Label>\n              <Input\n                id=\"start-date\"\n                type=\"date\"\n                value={filters.startDate}\n                onChange={(e) => updateFilters({ startDate: e.target.value })}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"end-date\">Data de Fim</Label>\n              <Input\n                id=\"end-date\"\n                type=\"date\"\n                value={filters.endDate}\n                onChange={(e) => updateFilters({ endDate: e.target.value })}\n              />\n            </div>\n          </CollapsibleContent>\n        </Collapsible>\n\n        <Separator />\n\n        {/* Budget */}\n        <Collapsible\n          open={expandedSections.budget}\n          onOpenChange={() => toggleSection('budget')}\n        >\n          <CollapsibleTrigger asChild>\n            <Button variant=\"ghost\" className=\"w-full justify-between p-0 h-auto\">\n              <div className=\"flex items-center\">\n                <DollarSign className=\"w-4 h-4 mr-2\" />\n                <span className=\"font-medium\">Or√ßamento</span>\n              </div>\n              {expandedSections.budget ? \n                <ChevronUp className=\"w-4 h-4\" /> : \n                <ChevronDown className=\"w-4 h-4\" />\n              }\n            </Button>\n          </CollapsibleTrigger>\n          <CollapsibleContent className=\"space-y-3 mt-2\">\n            <div className=\"px-2\">\n              <Slider\n                value={filters.budgetRange}\n                onValueChange={(value) => updateFilters({ budgetRange: value as [number, number] })}\n                max={10000}\n                min={0}\n                step={100}\n                className=\"w-full\"\n              />\n              <div className=\"flex justify-between text-sm text-gray-600 mt-2\">\n                <span>{formatBrazilianCurrency(filters.budgetRange[0])}</span>\n                <span>{formatBrazilianCurrency(filters.budgetRange[1])}</span>\n              </div>\n            </div>\n          </CollapsibleContent>\n        </Collapsible>\n\n        <Separator />\n\n        {/* Travel Styles */}\n        <Collapsible\n          open={expandedSections.preferences}\n          onOpenChange={() => toggleSection('preferences')}\n        >\n          <CollapsibleTrigger asChild>\n            <Button variant=\"ghost\" className=\"w-full justify-between p-0 h-auto\">\n              <div className=\"flex items-center\">\n                <Users className=\"w-4 h-4 mr-2\" />\n                <span className=\"font-medium\">Estilo de Viagem</span>\n              </div>\n              {expandedSections.preferences ? \n                <ChevronUp className=\"w-4 h-4\" /> : \n                <ChevronDown className=\"w-4 h-4\" />\n              }\n            </Button>\n          </CollapsibleTrigger>\n          <CollapsibleContent className=\"space-y-3 mt-2\">\n            <div className=\"flex flex-wrap gap-2\">\n              {travel_styles.map((style: any) => (\n                <Badge\n                  key={style.id}\n                  variant={filters.travel_styles.includes(style.id) ? \"default\" : \"outline\"}\n                  className={cn(\n                    \"cursor-pointer transition-all\",\n                    filters.travel_styles.includes(style.id) \n                      ? \"bg-blue-600 text-white hover:bg-blue-700\"\n                      : \"hover:bg-gray-100\"\n                  )}\n                  onClick={() => toggleTravelStyle(style.id)}\n                >\n                  {style.name}\n                </Badge>\n              ))}\n            </div>\n          </CollapsibleContent>\n        </Collapsible>\n\n        <Separator />\n\n        {/* Rating */}\n        <Collapsible\n          open={expandedSections.rating}\n          onOpenChange={() => toggleSection('rating')}\n        >\n          <CollapsibleTrigger asChild>\n            <Button variant=\"ghost\" className=\"w-full justify-between p-0 h-auto\">\n              <div className=\"flex items-center\">\n                <Star className=\"w-4 h-4 mr-2\" />\n                <span className=\"font-medium\">Avalia√ß√£o M√≠nima</span>\n              </div>\n              {expandedSections.rating ? \n                <ChevronUp className=\"w-4 h-4\" /> : \n                <ChevronDown className=\"w-4 h-4\" />\n              }\n            </Button>\n          </CollapsibleTrigger>\n          <CollapsibleContent className=\"space-y-3 mt-2\">\n            <div className=\"px-2\">\n              <Slider\n                value={[filters.minRating]}\n                onValueChange={(value) => updateFilters({ minRating: value[0] })}\n                max={5}\n                min={0}\n                step={0.5}\n                className=\"w-full\"\n              />\n              <div className=\"flex justify-between text-sm text-gray-600 mt-2\">\n                <span>0 ‚≠ê</span>\n                <span>{filters.minRating} ‚≠ê</span>\n                <span>5 ‚≠ê</span>\n              </div>\n            </div>\n          </CollapsibleContent>\n        </Collapsible>\n\n        <Separator />\n\n        {/* Sort By */}\n        <div className=\"space-y-2\">\n          <Label>Ordenar por</Label>\n          <Select\n            value={filters.sortBy}\n            onValueChange={(value) => updateFilters({ sortBy: value })}\n          >\n            <SelectTrigger>\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              {sortOptions.map((option) => (\n                <SelectItem key={option.value} value={option.value}>\n                  {option.label}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":12113},"client/src/components/travel-board.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { \n  MapPin, \n  Calendar, \n  DollarSign, \n  Users, \n  Clock,\n  Plus,\n  MoreVertical,\n  MessageCircle\n} from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { ptBR } from \"date-fns/locale\";\nimport { Link } from \"wouter\";\nimport { getRealParticipantsCount } from \"@/lib/trip-utils\";\n\ninterface Trip {\n  id: number;\n  title: string;\n  destination: string;\n  start_date: string;\n  end_date: string;\n  budget: number;\n  max_participants: number;\n  current_participants: number;\n  description: string;\n  travel_style: string;\n  status: string;\n  creator?: any;\n}\n\ninterface TravelBoardProps {\n  className?: string;\n}\n\n// Travel board columns/categories\nconst BOARD_COLUMNS = [\n  {\n    id: 'planning',\n    title: 'Planejando',\n    description: 'Viagens em fase de planejamento',\n    color: 'bg-blue-50 border-blue-200',\n    headerColor: 'bg-blue-100'\n  },\n  {\n    id: 'upcoming',\n    title: 'Pr√≥ximas',\n    description: 'Viagens confirmadas',\n    color: 'bg-yellow-50 border-yellow-200',\n    headerColor: 'bg-yellow-100'\n  },\n  {\n    id: 'active',\n    title: 'Em Andamento',\n    description: 'Viagens acontecendo agora',\n    color: 'bg-green-50 border-green-200',\n    headerColor: 'bg-green-100'\n  },\n  {\n    id: 'completed',\n    title: 'Conclu√≠das',\n    description: 'Viagens finalizadas',\n    color: 'bg-gray-50 border-gray-200',\n    headerColor: 'bg-gray-100'\n  }\n];\n\nexport function TravelBoard({ className = \"\" }: TravelBoardProps) {\n  const { user } = useAuth();\n  const [draggedTrip, setDraggedTrip] = useState<Trip | null>(null);\n  const [tripCategories, setTripCategories] = useState<Record<string, Trip[]>>({\n    planning: [],\n    upcoming: [],\n    active: [],\n    completed: []\n  });\n\n  // Fetch user's trips\n  const { data: myTripsData } = useQuery({\n    queryKey: [\"/api/my-trips\"],\n    enabled: !!user,\n  });\n\n  // Get all available trips\n  const { data: allTrips = [] } = useQuery({\n    queryKey: [\"/api/trips\"],\n    enabled: !!user,\n  });\n\n  // Cast the trips data to Trip array\n  const trips = (allTrips as Trip[]) || [];\n\n  // Categorize trips based on dates and status\n  useEffect(() => {\n    if (!trips || trips.length === 0) return;\n\n    const now = new Date();\n    const categorized: Record<string, Trip[]> = {\n      planning: [],\n      upcoming: [],\n      active: [],\n      completed: []\n    };\n\n    trips.forEach((trip: Trip) => {\n      const startDate = new Date(trip.start_date);\n      const endDate = new Date(trip.end_date);\n      \n      if (endDate < now) {\n        categorized.completed.push(trip);\n      } else if (startDate <= now && endDate >= now) {\n        categorized.active.push(trip);\n      } else if (startDate > now) {\n        // Future trips - categorize as upcoming if confirmed, planning if still open\n        if (getRealParticipantsCount(trip) >= 2) {\n          categorized.upcoming.push(trip);\n        } else {\n          categorized.planning.push(trip);\n        }\n      }\n    });\n\n    setTripCategories(categorized);\n  }, [trips]);\n\n  const handleDragStart = (e: React.DragEvent, trip: Trip) => {\n    setDraggedTrip(trip);\n    e.dataTransfer.effectAllowed = 'move';\n  };\n\n  const handleDragOver = (e: React.DragEvent) => {\n    e.preventDefault();\n    e.dataTransfer.dropEffect = 'move';\n  };\n\n  const handleDrop = (e: React.DragEvent, targetColumn: string) => {\n    e.preventDefault();\n    \n    if (!draggedTrip) return;\n\n    // Find source column\n    let sourceColumn = '';\n    Object.entries(tripCategories).forEach(([columnId, trips]) => {\n      if (trips.find(t => t.id === draggedTrip.id)) {\n        sourceColumn = columnId;\n      }\n    });\n\n    if (sourceColumn === targetColumn) return;\n\n    // Move trip between columns\n    setTripCategories(prev => {\n      const newCategories = { ...prev };\n      \n      // Remove from source\n      newCategories[sourceColumn] = newCategories[sourceColumn].filter(\n        t => t.id !== draggedTrip.id\n      );\n      \n      // Add to target\n      newCategories[targetColumn] = [...newCategories[targetColumn], draggedTrip];\n      \n      return newCategories;\n    });\n\n    setDraggedTrip(null);\n  };\n\n  const getTravelStyleLabel = (style: string) => {\n    const styles: Record<string, string> = {\n      praia: 'Praia',\n      neve: 'Neve',\n      cruzeiros: 'Cruzeiros',\n      natureza: 'Natureza e Ecoturismo',\n      cultural: 'Culturais e Hist√≥ricas',\n      aventura: 'Aventura',\n      parques: 'Parques Tem√°ticos',\n      urbanas: 'Viagens Urbanas / Cidades Grandes'\n    };\n    return styles[style] || style;\n  };\n\n  const getTravelStyleColor = (style: string) => {\n    const colors: Record<string, string> = {\n      praia: 'bg-blue-100 text-blue-800',\n      neve: 'bg-cyan-100 text-cyan-800',\n      cruzeiros: 'bg-indigo-100 text-indigo-800',\n      natureza: 'bg-green-100 text-green-800',\n      cultural: 'bg-purple-100 text-purple-800',\n      aventura: 'bg-orange-100 text-orange-800',\n      parques: 'bg-pink-100 text-pink-800',\n      urbanas: 'bg-gray-100 text-gray-800'\n    };\n    return colors[style] || 'bg-gray-100 text-gray-800';\n  };\n\n  const getDaysUntil = (dateString: string) => {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffTime = date.getTime() - now.getTime();\n    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n    \n    if (diffDays > 0) {\n      return `Em ${diffDays} dias`;\n    } else if (diffDays === 0) {\n      return 'Hoje';\n    } else {\n      return 'Em andamento';\n    }\n  };\n\n  return (\n    <div className={`w-full ${className}`}>\n      <div className=\"mb-6\">\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">Painel de Viagens</h2>\n        <p className=\"text-gray-600\">Organize suas viagens arrastando os cards entre as colunas</p>\n      </div>\n\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        {BOARD_COLUMNS.map(column => (\n          <div\n            key={column.id}\n            className={`min-h-[600px] rounded-lg border-2 border-dashed ${column.color} p-4`}\n            onDragOver={handleDragOver}\n            onDrop={(e) => handleDrop(e, column.id)}\n          >\n            {/* Column Header */}\n            <div className={`${column.headerColor} rounded-lg p-3 mb-4`}>\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <h3 className=\"font-semibold text-gray-900\">{column.title}</h3>\n                  <p className=\"text-sm text-gray-600\">{column.description}</p>\n                </div>\n                <Badge variant=\"secondary\">\n                  {tripCategories[column.id]?.length || 0}\n                </Badge>\n              </div>\n            </div>\n\n            {/* Trip Cards */}\n            <div className=\"space-y-4\">\n              {tripCategories[column.id]?.map(trip => (\n                <Card\n                  key={trip.id}\n                  draggable\n                  onDragStart={(e) => handleDragStart(e, trip)}\n                  className=\"cursor-move hover:shadow-lg transition-shadow bg-white border-2 hover:border-primary/20\"\n                >\n                  <CardHeader className=\"pb-3\">\n                    <div className=\"flex items-start justify-between\">\n                      <div className=\"flex-1\">\n                        <CardTitle className=\"text-base font-semibold line-clamp-2\">\n                          {trip.title}\n                        </CardTitle>\n                        <div className=\"flex items-center gap-1 mt-1 text-sm text-gray-600\">\n                          <MapPin className=\"h-3 w-3\" />\n                          <span className=\"line-clamp-1\">{trip.destination}</span>\n                        </div>\n                      </div>\n                      <Button variant=\"ghost\" size=\"sm\" className=\"h-6 w-6 p-0\">\n                        <MoreVertical className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </CardHeader>\n\n                  <CardContent className=\"space-y-3\">\n                    {/* Trip Info */}\n                    <div className=\"space-y-2 text-sm\">\n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-1 text-gray-600\">\n                          <Calendar className=\"h-3 w-3\" />\n                          <span>{format(new Date(trip.start_date), \"dd/MM\", { locale: ptBR })}</span>\n                        </div>\n                        <span className=\"text-xs text-gray-500\">\n                          {getDaysUntil(trip.start_date)}\n                        </span>\n                      </div>\n                      \n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-1 text-gray-600\">\n                          <DollarSign className=\"h-3 w-3\" />\n                          <span>R$ {trip.budget.toLocaleString('pt-BR')}</span>\n                        </div>\n                        <div className=\"flex items-center gap-1 text-gray-600\">\n                          <Users className=\"h-3 w-3\" />\n                          <span>{trip.current_participants}/{trip.max_participants}</span>\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Travel Style Badge */}\n                    <Badge className={`text-xs ${getTravelStyleColor(trip.travel_style)}`}>\n                      {getTravelStyleLabel(trip.travel_style)}\n                    </Badge>\n\n                    {/* Creator Info */}\n                    <div className=\"flex items-center gap-2\">\n                      <Avatar className=\"h-6 w-6\">\n                        <AvatarFallback className=\"text-xs\">\n                          {trip.creator?.full_name?.split(' ').map((n: string) => n[0]).join('').toUpperCase()}\n                        </AvatarFallback>\n                      </Avatar>\n                      <span className=\"text-xs text-gray-600\">{trip.creator?.full_name}</span>\n                    </div>\n\n                    {/* Action Buttons */}\n                    <div className=\"flex gap-2 pt-2\">\n                      <Button asChild size=\"sm\" variant=\"outline\" className=\"flex-1\">\n                        <Link href={`/trip/${trip.id}`}>\n                          <Clock className=\"h-3 w-3 mr-1\" />\n                          Ver\n                        </Link>\n                      </Button>\n                      <Button asChild size=\"sm\" variant=\"outline\">\n                        <Link href={`/chat/${trip.id}`}>\n                          <MessageCircle className=\"h-3 w-3\" />\n                        </Link>\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n\n              {/* Add New Trip Button (only in planning column) */}\n              {column.id === 'planning' && (\n                <Card className=\"border-2 border-dashed border-gray-300 hover:border-primary transition-colors\">\n                  <CardContent className=\"flex items-center justify-center p-8\">\n                    <Button asChild variant=\"ghost\" className=\"flex-col gap-2 h-auto\">\n                      <Link href=\"/create-trip\">\n                        <Plus className=\"h-8 w-8 text-gray-400\" />\n                        <span className=\"text-sm text-gray-600\">Nova Viagem</span>\n                      </Link>\n                    </Button>\n                  </CardContent>\n                </Card>\n              )}\n            </div>\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}","size_bytes":11962},"client/src/components/trip-card-skeleton.tsx":{"content":"import { Skeleton } from \"@/components/ui/skeleton\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\n\nexport function TripCardSkeleton() {\n  return (\n    <Card className=\"hover:shadow-lg transition-all duration-300\">\n      <CardHeader className=\"relative\">\n        <Skeleton className=\"h-48 w-full rounded-md\" />\n        <div className=\"absolute top-4 right-4 flex items-center space-x-2\">\n          <Skeleton className=\"h-6 w-20\" />\n        </div>\n      </CardHeader>\n      <CardContent>\n        <div className=\"mb-4\">\n          <Skeleton className=\"h-6 w-3/4 mb-2\" />\n          <Skeleton className=\"h-4 w-1/2\" />\n        </div>\n        \n        <Skeleton className=\"h-16 w-full mb-4\" />\n        \n        <div className=\"grid grid-cols-2 gap-4 mb-4\">\n          <div>\n            <Skeleton className=\"h-4 w-16 mb-1\" />\n            <Skeleton className=\"h-5 w-24\" />\n          </div>\n          <div>\n            <Skeleton className=\"h-4 w-20 mb-1\" />\n            <Skeleton className=\"h-5 w-16\" />\n          </div>\n        </div>\n        \n        <div className=\"space-y-2 mb-4\">\n          <Skeleton className=\"h-4 w-full\" />\n          <Skeleton className=\"h-4 w-3/4\" />\n        </div>\n        \n        <div className=\"flex items-center justify-between mb-4\">\n          <Skeleton className=\"h-8 w-8 rounded-full\" />\n          <Skeleton className=\"h-8 w-32\" />\n        </div>\n        \n        <Skeleton className=\"h-10 w-full\" />\n      </CardContent>\n    </Card>\n  );\n}","size_bytes":1487},"client/src/components/trip-card.tsx":{"content":"import { Link } from \"wouter\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { UserAvatar } from \"@/components/ui/user-avatar\";\nimport { Button } from \"@/components/ui/button\";\nimport { OptimizedImage } from \"@/components/ui/optimized-image\";\nimport { \n  MapPin, \n  Calendar, \n  DollarSign, \n  Users, \n  Clock,\n  MessageCircle,\n  Heart,\n  Share2,\n  Star,\n  Eye,\n  Settings\n} from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { ptBR } from \"date-fns/locale\";\nimport { motion } from \"framer-motion\";\nimport { useState, memo } from \"react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { getRealParticipantsCount, getAvailableSpots, isTripFull } from \"@/lib/trip-utils\";\nimport { getTripDuration, safeParseDate } from \"@/lib/date-utils\";\n\ninterface TripCardProps {\n  trip: any;\n  showActions?: boolean;\n}\n\nexport const TripCard = memo(function TripCard({ trip, showActions = true }: TripCardProps) {\n  const [isHovered, setIsHovered] = useState(false);\n  const [isLiked, setIsLiked] = useState(false);\n  const { toast } = useToast();\n  const { user } = useAuth();\n  \n  // Use standardized participant counting\n  const currentParticipants = getRealParticipantsCount(trip);\n  const availableSpots = getAvailableSpots(trip);\n  const isFull = isTripFull(trip);\n  const duration = getTripDuration(\n    trip.start_date || trip.startDate, \n    trip.end_date || trip.endDate\n  );\n\n  const getDestinationImage = (trip: any) => {\n    // Use the trip's cover image if available\n    if (trip.cover_image) {\n      return trip.cover_image;\n    }\n    \n    // For cruise trips, use cruise ship images instead of destination images\n    if (trip.travel_style === 'cruzeiros') {\n      const cruiseImages = [\n        \"https://images.unsplash.com/photo-1544966503-7cc5ac882d5d?w=800&q=80\", // Luxury cruise ship\n        \"https://images.unsplash.com/photo-1571896349842-33c89424de2d?w=800&q=80\", // Cruise ship at sunset\n        \"https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=800&q=80\", // Cruise ship in fjord\n        \"https://images.unsplash.com/photo-1570197526-ebbe9c6df8f2?w=800&q=80\", // Cruise ship in Alaska\n      ];\n      return cruiseImages[Math.floor(Math.random() * cruiseImages.length)];\n    }\n    \n    // Default fallback for other travel types\n    return \"https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=800&q=80\";\n  };\n\n  const travelStyleLabels: { [key: string]: string } = {\n    praia: \"Praia\",\n    neve: \"Neve\",\n    cruzeiros: \"Cruzeiros\",\n    natureza: \"Natureza e Ecoturismo\",\n    cultural: \"Culturais e Hist√≥ricas\",\n    aventura: \"Aventura\",\n    parques: \"Parques Tem√°ticos\",\n    urbanas: \"Viagens Urbanas / Cidades Grandes\",\n  };\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      whileHover={{ y: -8, transition: { duration: 0.3 } }}\n      onHoverStart={() => setIsHovered(true)}\n      onHoverEnd={() => setIsHovered(false)}\n      className=\"group\"\n    >\n      <Card className=\"trip-card overflow-hidden border-0 shadow-lg hover:shadow-2xl transition-all duration-300\">\n        {/* Trip Image */}\n        <div className=\"relative overflow-hidden\">\n          <img \n            src={getDestinationImage(trip)} \n            alt={`Imagem de ${trip.destination}`}\n            className=\"w-full h-48 object-cover group-hover:scale-110 transition-transform duration-500\"\n          />\n          \n          {/* Overlay gradient on hover */}\n          <div className={`absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent transition-opacity duration-300 ${isHovered ? 'opacity-100' : 'opacity-0'}`} />\n          \n          {/* Status badges */}\n          <div className=\"absolute top-3 right-3 flex gap-2\">\n            <Badge className={!isFull ? \"status-open\" : \"bg-red-100 text-red-800\"}>\n              {!isFull ? `${availableSpots} vagas` : \"Lotada\"}\n            </Badge>\n          </div>\n          \n          <div className=\"absolute top-3 left-3\">\n            <Badge variant=\"outline\" className=\"bg-white/90 backdrop-blur-sm\">\n              {travelStyleLabels[trip.travel_style] || trip.travel_style}\n            </Badge>\n          </div>\n\n          {/* Floating action buttons on hover */}\n          <motion.div\n            initial={{ opacity: 0, y: 10 }}\n            animate={{ opacity: isHovered ? 1 : 0, y: isHovered ? 0 : 10 }}\n            transition={{ duration: 0.2 }}\n            className=\"absolute bottom-3 right-3 flex gap-2\"\n          >\n            <motion.button\n              whileHover={{ scale: 1.1 }}\n              whileTap={{ scale: 0.9 }}\n              onClick={(e) => {\n                e.preventDefault();\n                setIsLiked(!isLiked);\n              }}\n              className={`p-2 rounded-full backdrop-blur-sm transition-colors ${\n                isLiked \n                  ? 'bg-red-500 text-white' \n                  : 'bg-white/80 text-gray-700 hover:bg-white hover:text-red-500'\n              }`}\n            >\n              <Heart className={`h-4 w-4 ${isLiked ? 'fill-current' : ''}`} />\n            </motion.button>\n            \n            <motion.button\n              whileHover={{ scale: 1.1 }}\n              whileTap={{ scale: 0.9 }}\n              onClick={(e) => {\n                e.preventDefault();\n                e.stopPropagation();\n                \n                const shareData = {\n                  title: trip.title,\n                  text: trip.description,\n                  url: `${window.location.origin}/trip/${trip.id}`\n                };\n\n                if (navigator.share) {\n                  navigator.share(shareData).catch(console.error);\n                } else {\n                  // Fallback: copiar URL para clipboard\n                  navigator.clipboard.writeText(shareData.url).then(() => {\n                    toast({\n                      title: \"Link copiado!\",\n                      description: \"O link da viagem foi copiado para sua √°rea de transfer√™ncia.\",\n                    });\n                  }).catch(() => {\n                    // Fallback final: abrir WhatsApp\n                    window.open(`https://wa.me/?text=${encodeURIComponent(`${shareData.title} - ${shareData.text} ${shareData.url}`)}`, '_blank');\n                    toast({\n                      title: \"Compartilhar via WhatsApp\",\n                      description: \"Redirecionando para o WhatsApp...\",\n                    });\n                  });\n                }\n              }}\n              className=\"p-2 rounded-full bg-white/80 backdrop-blur-sm text-gray-700 hover:bg-white hover:text-blue-500 transition-colors\"\n            >\n              <Share2 className=\"h-4 w-4\" />\n            </motion.button>\n          </motion.div>\n\n          {/* Trip rating overlay */}\n          <motion.div\n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: isHovered ? 1 : 0, x: isHovered ? 0 : -20 }}\n            transition={{ duration: 0.2, delay: 0.1 }}\n            className=\"absolute bottom-3 left-3\"\n          >\n            <div className=\"flex items-center gap-1 bg-white/90 backdrop-blur-sm px-2 py-1 rounded-full\">\n              <Star className=\"h-3 w-3 text-yellow-500 fill-current\" />\n              <span className=\"text-xs font-medium text-gray-700\">4.8</span>\n            </div>\n          </motion.div>\n        </div>\n\n        <CardContent className=\"p-6\">\n        {/* Trip Header */}\n        <div className=\"mb-3\">\n          <h3 className=\"font-heading font-semibold text-xl text-dark mb-2 line-clamp-1\">\n            {trip.title || \"Viagem sem t√≠tulo\"}\n          </h3>\n          \n          <div className=\"flex items-center gap-4 text-sm text-gray-600 mb-3\">\n            <div className=\"flex items-center gap-1\">\n              <MapPin className=\"h-3 w-3\" />\n              <span className=\"line-clamp-1\">{trip.destination}</span>\n            </div>\n            <div className=\"flex items-center gap-1\">\n              <Calendar className=\"h-3 w-3\" />\n              <span>\n                {format(safeParseDate(trip.start_date || trip.startDate), \"dd/MM\", { locale: ptBR })} - {format(safeParseDate(trip.end_date || trip.endDate), \"dd/MM\", { locale: ptBR })}\n              </span>\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-4 text-sm text-gray-600 mb-4\">\n            <div className=\"flex items-center gap-1\">\n              <Clock className=\"h-3 w-3\" />\n              <span>{duration} dias</span>\n            </div>\n            <div className=\"flex items-center gap-1\">\n              <Users className=\"h-3 w-3\" />\n              <span>{currentParticipants}/{trip.max_participants} pessoas</span>\n            </div>\n          </div>\n        </div>\n\n        {/* Description */}\n        <p className=\"text-gray-700 text-sm mb-4 line-clamp-2\">\n          {trip.description}\n        </p>\n\n        {/* Footer */}\n        <div className=\"flex items-center justify-between\">\n          {/* Creator Info */}\n          <div className=\"flex items-center space-x-2\">\n            <UserAvatar \n              user={trip.creator}\n              size=\"sm\"\n              className=\"w-8 h-8\"\n            />\n            <div>\n              <span className=\"text-sm text-gray-600\">Por</span>\n              <span className=\"text-sm font-medium text-gray-800 ml-1\">\n                {(trip.creator?.full_name || 'Usu√°rio')?.split(' ')[0]}\n              </span>\n            </div>\n          </div>\n\n          {/* Price and Actions */}\n          <div className=\"text-right\">\n            {trip.budget ? (\n              <>\n                <div className=\"flex items-center gap-1 text-primary font-semibold mb-1\">\n                  <DollarSign className=\"h-4 w-4\" />\n                  <span>{new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(Math.round(trip.budget / trip.max_participants))}</span>\n                </div>\n                <div className=\"text-xs text-gray-500\">por pessoa</div>\n                <div className=\"text-xs text-gray-400 mt-1\">\n                  Total: {new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(trip.budget)}\n                </div>\n              </>\n            ) : (\n              <div className=\"text-xs text-gray-500\">Or√ßamento a definir</div>\n            )}\n          </div>\n        </div>\n\n        {/* Action Buttons */}\n        {showActions && (\n          <div className=\"mt-4 pt-3 border-t border-gray-100 flex gap-2\">\n            <Link href={`/trip/${trip.id}`} className=\"flex-1\">\n              <motion.div\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n                className=\"w-full\"\n              >\n                <Button \n                  variant=\"outline\" \n                  size=\"sm\"\n                  className=\"w-full text-xs font-semibold bg-white/80 backdrop-blur-sm border border-slate-200 hover:border-slate-300 hover:bg-slate-50/90 text-slate-700 hover:text-slate-800 rounded-lg py-2 h-8 transition-all duration-300 shadow-sm hover:shadow-md\"\n                >\n                  <Eye className=\"w-3 h-3 mr-1\" />\n                  Ver\n                </Button>\n              </motion.div>\n            </Link>\n            \n            {/* Edit button for trip creators */}\n            {user && trip.creator_id === user.id && (\n              <Link href={`/edit-trip/${trip.id}`}>\n                <motion.div\n                  whileHover={{ scale: 1.02 }}\n                  whileTap={{ scale: 0.98 }}\n                  className=\"w-auto\"\n                >\n                  <Button \n                    variant=\"outline\"\n                    size=\"sm\"\n                    className=\"text-xs font-semibold bg-white/80 backdrop-blur-sm border border-blue-200 hover:border-blue-300 hover:bg-blue-50/90 text-blue-600 hover:text-blue-700 rounded-lg px-3 py-2 h-8 transition-all duration-300 shadow-sm hover:shadow-md\"\n                  >\n                    <Settings className=\"w-3 h-3 mr-1\" />\n                    Editar\n                  </Button>\n                </motion.div>\n              </Link>\n            )}\n\n            {!isFull ? (\n              <Link href={`/trip/${trip.id}`} className=\"flex-1\">\n                <motion.div\n                  whileHover={{ scale: 1.02 }}\n                  whileTap={{ scale: 0.98 }}\n                  className=\"w-full\"\n                >\n                  <Button \n                    size=\"sm\"\n                    className=\"w-full text-xs font-bold bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white border-0 rounded-lg py-2 h-8 transition-all duration-300 shadow-lg hover:shadow-xl hover:shadow-blue-500/25\"\n                  >\n                    <Users className=\"w-3 h-3 mr-1\" />\n                    Participar\n                  </Button>\n                </motion.div>\n              </Link>\n            ) : (\n              <motion.div className=\"flex-1\">\n                <Button \n                  disabled \n                  size=\"sm\"\n                  className=\"w-full text-xs font-semibold bg-gray-100 text-gray-400 border-0 rounded-lg py-2 h-8 cursor-not-allowed\"\n                >\n                  <Users className=\"w-3 h-3 mr-1\" />\n                  Lotada\n                </Button>\n              </motion.div>\n            )}\n          </div>\n        )}\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n});\n","size_bytes":13593},"client/src/components/virtual-list.tsx":{"content":"import { useState, useEffect, useRef, useMemo } from 'react';\nimport { cn } from '@/lib/utils';\n\ninterface VirtualListProps<T> {\n  items: T[];\n  itemHeight: number;\n  containerHeight: number;\n  renderItem: (item: T, index: number) => React.ReactNode;\n  className?: string;\n  overscan?: number;\n}\n\nexport function VirtualList<T>({\n  items,\n  itemHeight,\n  containerHeight,\n  renderItem,\n  className,\n  overscan = 5\n}: VirtualListProps<T>) {\n  const [scrollTop, setScrollTop] = useState(0);\n  const scrollElementRef = useRef<HTMLDivElement>(null);\n\n  const { visibleItems, totalHeight, offsetY } = useMemo(() => {\n    const containerItemCount = Math.ceil(containerHeight / itemHeight);\n    const startIndex = Math.max(0, Math.floor(scrollTop / itemHeight) - overscan);\n    const endIndex = Math.min(\n      items.length - 1,\n      startIndex + containerItemCount + 2 * overscan\n    );\n\n    const visibleItems = items.slice(startIndex, endIndex + 1).map((item, index) => ({\n      item,\n      index: startIndex + index\n    }));\n\n    return {\n      visibleItems,\n      totalHeight: items.length * itemHeight,\n      offsetY: startIndex * itemHeight\n    };\n  }, [scrollTop, items, itemHeight, containerHeight, overscan]);\n\n  const handleScroll = (e: React.UIEvent<HTMLDivElement>) => {\n    setScrollTop(e.currentTarget.scrollTop);\n  };\n\n  return (\n    <div\n      ref={scrollElementRef}\n      className={cn(\"overflow-auto\", className)}\n      style={{ height: containerHeight }}\n      onScroll={handleScroll}\n    >\n      <div style={{ height: totalHeight, position: 'relative' }}>\n        <div\n          style={{\n            transform: `translateY(${offsetY}px)`,\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            right: 0\n          }}\n        >\n          {visibleItems.map(({ item, index }) => (\n            <div\n              key={index}\n              style={{ height: itemHeight }}\n              className=\"flex items-center\"\n            >\n              {renderItem(item, index)}\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":2088},"client/src/components/welcome-banner.tsx":{"content":"import React from 'react';\nimport { motion } from 'framer-motion';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { \n  Sparkles, \n  Users, \n  MapPin, \n  ArrowRight,\n  X \n} from 'lucide-react';\n\ninterface WelcomeBannerProps {\n  userName?: string;\n  onStartTour: () => void;\n  onDismiss: () => void;\n  isVisible: boolean;\n}\n\nexport function WelcomeBanner({ userName, onStartTour, onDismiss, isVisible }: WelcomeBannerProps) {\n  if (!isVisible) return null;\n\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: -20 }}\n      animate={{ opacity: 1, y: 0 }}\n      exit={{ opacity: 0, y: -20 }}\n      className=\"mb-6\"\n    >\n      <Card className=\"bg-gradient-to-r from-blue-600 to-purple-600 border-0 text-white overflow-hidden relative\">\n        <div className=\"absolute inset-0 bg-gradient-to-r from-blue-600/90 to-purple-600/90\" />\n        <div className=\"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -translate-y-16 translate-x-16\" />\n        <div className=\"absolute bottom-0 left-0 w-24 h-24 bg-white/5 rounded-full translate-y-12 -translate-x-12\" />\n        \n        <CardContent className=\"p-6 relative z-10\">\n          <div className=\"flex items-start justify-between\">\n            <div className=\"flex-1\">\n              <div className=\"flex items-center gap-3 mb-3\">\n                <motion.div\n                  animate={{ rotate: [0, 10, -10, 0] }}\n                  transition={{ duration: 2, repeat: Infinity }}\n                >\n                  <Sparkles className=\"w-6 h-6 text-yellow-300\" />\n                </motion.div>\n                <Badge className=\"bg-white/20 text-white border-white/30 hover:bg-white/30\">\n                  Novo Membro\n                </Badge>\n              </div>\n              \n              <h2 className=\"text-2xl font-bold mb-2\">\n                {userName ? `Bem-vindo, ${userName}!` : 'Bem-vindo ao PartiuTrip!'}\n              </h2>\n              \n              <p className=\"text-blue-100 mb-4 leading-relaxed\">\n                Estamos animados para te ajudar a descobrir o mundo de forma mais econ√¥mica e divertida. \n                Que tal fazer um tour r√°pido para conhecer todas as funcionalidades?\n              </p>\n              \n              <div className=\"flex items-center gap-4 text-sm text-blue-200 mb-4\">\n                <div className=\"flex items-center gap-2\">\n                  <Users className=\"w-4 h-4\" />\n                  <span>2.8k+ viajantes</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <MapPin className=\"w-4 h-4\" />\n                  <span>85+ destinos</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Sparkles className=\"w-4 h-4\" />\n                  <span>65% economia m√©dia</span>\n                </div>\n              </div>\n              \n              <div className=\"flex gap-3\">\n                <Button\n                  onClick={onStartTour}\n                  className=\"bg-white text-blue-600 hover:bg-blue-50 font-semibold\"\n                >\n                  Come√ßar Tour\n                  <ArrowRight className=\"ml-2 h-4 w-4\" />\n                </Button>\n                <Button\n                  variant=\"ghost\"\n                  onClick={onDismiss}\n                  className=\"text-white border-white/30 hover:bg-white/10\"\n                >\n                  Talvez depois\n                </Button>\n              </div>\n            </div>\n            \n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={onDismiss}\n              className=\"text-white hover:bg-white/10 h-8 w-8 p-0 ml-4\"\n            >\n              <X className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n    </motion.div>\n  );\n}","size_bytes":3929},"client/src/hooks/use-auth.tsx":{"content":"\nimport { createContext, useContext, ReactNode } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { User } from \"@shared/schema\";\n\ninterface LoginData {\n  identifier: string;\n  password: string;\n}\n\ninterface RegisterData {\n  username: string;\n  password: string;\n  email: string;\n  full_name: string;\n  bio?: string;\n  location?: string;\n  languages?: string[];\n  interests?: string[];\n  travel_styles?: string[];\n}\n\ninterface AuthContextType {\n  user: User | null;\n  isLoading: boolean;\n  error: Error | null;\n  loginMutation: ReturnType<typeof useMutation<User, Error, LoginData>>;\n  logoutMutation: ReturnType<typeof useMutation<void, Error, void>>;\n  registerMutation: ReturnType<typeof useMutation<User, Error, RegisterData>>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // Query para verificar se o usu√°rio est√° logado\n  const { \n    data: user, \n    isLoading, \n    error \n  } = useQuery<User>({\n    queryKey: [\"/api/user\"],\n    queryFn: async () => {\n      const res = await apiRequest(\"GET\", \"/api/user\");\n      if (!res.ok) {\n        throw new Error(\"N√£o autorizado\");\n      }\n      return res.json();\n    },\n    retry: 1,\n    staleTime: 30 * 1000, // 30 seconds - shorter to refresh authentication status more frequently\n    refetchOnWindowFocus: true,\n    refetchOnMount: true,\n  });\n\n  // Mutation para login\n  const loginMutation = useMutation<User, Error, LoginData>({\n    mutationFn: async (loginData: LoginData) => {\n      const res = await apiRequest(\"POST\", \"/api/auth/login\", loginData);\n      if (!res.ok) {\n        const errorData = await res.json().catch(() => ({}));\n        throw new Error(errorData.message || \"Erro no login\");\n      }\n      \n      const userData = await res.json();\n      \n      // Parse JSON string fields if they exist\n      if (typeof userData.languages === 'string') {\n        try {\n          userData.languages = JSON.parse(userData.languages);\n        } catch (e) {\n          userData.languages = [];\n        }\n      }\n      \n      if (typeof userData.interests === 'string') {\n        try {\n          userData.interests = JSON.parse(userData.interests);\n        } catch (e) {\n          userData.interests = [];\n        }\n      }\n      \n      if (typeof userData.travel_styles === 'string') {\n        try {\n          userData.travel_styles = JSON.parse(userData.travel_styles);\n        } catch (e) {\n          userData.travel_styles = [];\n        }\n      }\n      \n      return userData;\n    },\n    onSuccess: (userData: User & { sessionId?: string }) => {\n      // Store session ID in localStorage for authentication fallback\n      if (userData.sessionId) {\n        localStorage.setItem('sessionId', userData.sessionId);\n      }\n      \n      // Atualizar cache imediatamente com dados do usu√°rio\n      queryClient.setQueryData([\"/api/user\"], userData);\n      \n      // Invalidar apenas queries espec√≠ficas, n√£o todas\n      queryClient.invalidateQueries({ queryKey: [\"/api/trips\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/my-trips\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/user-requests\"] });\n      \n      toast({\n        title: \"Login realizado com sucesso!\",\n        description: \"Bem-vindo de volta!\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Erro no login\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Mutation para registro\n  const registerMutation = useMutation<User, Error, RegisterData>({\n    mutationFn: async (registerData: RegisterData) => {\n      const res = await apiRequest(\"POST\", \"/api/auth/register\", registerData);\n      if (!res.ok) {\n        const errorData = await res.json().catch(() => ({}));\n        throw new Error(errorData.message || \"Erro no registro\");\n      }\n      \n      const userData = await res.json();\n      \n      // Parse JSON string fields if they exist\n      if (typeof userData.languages === 'string') {\n        try {\n          userData.languages = JSON.parse(userData.languages);\n        } catch (e) {\n          userData.languages = [];\n        }\n      }\n      \n      if (typeof userData.interests === 'string') {\n        try {\n          userData.interests = JSON.parse(userData.interests);\n        } catch (e) {\n          userData.interests = [];\n        }\n      }\n      \n      if (typeof userData.travel_styles === 'string') {\n        try {\n          userData.travel_styles = JSON.parse(userData.travel_styles);\n        } catch (e) {\n          userData.travel_styles = [];\n        }\n      }\n      \n      return userData;\n    },\n    onSuccess: (userData: User & { sessionId?: string }) => {\n      // Store session ID in localStorage for authentication fallback\n      if (userData.sessionId) {\n        localStorage.setItem('sessionId', userData.sessionId);\n      }\n      \n      // Atualizar cache imediatamente com dados do usu√°rio\n      queryClient.setQueryData([\"/api/user\"], userData);\n      \n      // Invalidar apenas queries espec√≠ficas\n      queryClient.invalidateQueries({ queryKey: [\"/api/trips\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/my-trips\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/user-requests\"] });\n      \n      toast({\n        title: \"Conta criada com sucesso!\",\n        description: \"Bem-vindo ao ViajaJunto!\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Erro no registro\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Mutation para logout\n  const logoutMutation = useMutation<void, Error, void>({\n    mutationFn: async () => {\n      const res = await apiRequest(\"POST\", \"/api/logout\");\n      if (!res.ok) {\n        throw new Error(\"Erro no logout\");\n      }\n    },\n    onSuccess: () => {\n      // Clear session ID from localStorage\n      localStorage.removeItem('sessionId');\n      \n      // Limpar cache do usu√°rio\n      queryClient.setQueryData([\"/api/user\"], null);\n      // Invalidar todas as queries para limpar dados\n      queryClient.invalidateQueries();\n      \n      toast({\n        title: \"Logout realizado com sucesso!\",\n        description: \"At√© logo!\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Erro no logout\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const value: AuthContextType = {\n    user: user || null,\n    isLoading,\n    error,\n    loginMutation,\n    logoutMutation,\n    registerMutation,\n  };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error(\"useAuth deve ser usado dentro de AuthProvider\");\n  }\n  return context;\n}\n","size_bytes":7100},"client/src/hooks/use-debounce.ts":{"content":"import { useState, useEffect } from 'react';\n\nexport function useDebounce<T>(value: T, delay: number): T {\n  const [debouncedValue, setDebouncedValue] = useState<T>(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n}","size_bytes":385},"client/src/hooks/use-infinite-scroll.ts":{"content":"import { useCallback, useEffect, useRef } from 'react';\n\ninterface InfiniteScrollOptions {\n  hasNextPage?: boolean;\n  fetchNextPage?: () => void;\n  isFetchingNextPage?: boolean;\n  threshold?: number;\n  rootMargin?: string;\n}\n\nexport function useInfiniteScroll({\n  hasNextPage,\n  fetchNextPage,\n  isFetchingNextPage,\n  threshold = 100,\n  rootMargin = '0px'\n}: InfiniteScrollOptions) {\n  const observerRef = useRef<IntersectionObserver | null>(null);\n  const loadingRef = useRef<HTMLDivElement | null>(null);\n\n  // Set up intersection observer\n  useEffect(() => {\n    if (!hasNextPage || isFetchingNextPage || !fetchNextPage) return;\n\n    const observer = new IntersectionObserver(\n      (entries) => {\n        const [entry] = entries;\n        if (entry.isIntersecting) {\n          fetchNextPage();\n        }\n      },\n      {\n        rootMargin,\n        threshold: 0.1\n      }\n    );\n\n    observerRef.current = observer;\n\n    if (loadingRef.current) {\n      observer.observe(loadingRef.current);\n    }\n\n    return () => {\n      if (observerRef.current) {\n        observerRef.current.disconnect();\n      }\n    };\n  }, [hasNextPage, isFetchingNextPage, fetchNextPage, rootMargin]);\n\n  // Scroll-based infinite loading (fallback)\n  const handleScroll = useCallback((e: React.UIEvent<HTMLElement>) => {\n    const { scrollTop, scrollHeight, clientHeight } = e.currentTarget;\n    \n    if (\n      hasNextPage &&\n      !isFetchingNextPage &&\n      fetchNextPage &&\n      scrollHeight - scrollTop - clientHeight < threshold\n    ) {\n      fetchNextPage();\n    }\n  }, [hasNextPage, isFetchingNextPage, fetchNextPage, threshold]);\n\n  return {\n    loadingRef,\n    handleScroll\n  };\n}\n\n// Hook for infinite scroll with page-based loading\nexport function useInfiniteScrollPages<T>({\n  initialData = [],\n  pageSize = 20,\n  hasNextPage,\n  fetchNextPage,\n  isFetchingNextPage,\n  threshold = 100\n}: {\n  initialData?: T[];\n  pageSize?: number;\n  hasNextPage?: boolean;\n  fetchNextPage?: () => void;\n  isFetchingNextPage?: boolean;\n  threshold?: number;\n}) {\n  const { loadingRef, handleScroll } = useInfiniteScroll({\n    hasNextPage,\n    fetchNextPage,\n    isFetchingNextPage,\n    threshold\n  });\n\n  // Calculate loading state\n  const isLoading = isFetchingNextPage;\n  const hasMore = hasNextPage;\n\n  return {\n    loadingRef,\n    handleScroll,\n    isLoading,\n    hasMore\n  };\n}","size_bytes":2355},"client/src/hooks/use-local-storage.ts":{"content":"import { useState, useEffect } from 'react';\n\nexport function useLocalStorage<T>(key: string, initialValue: T) {\n  // Get from local storage then parse stored json or return initialValue\n  const [storedValue, setStoredValue] = useState<T>(() => {\n    try {\n      const item = window.localStorage.getItem(key);\n      return item ? JSON.parse(item) : initialValue;\n    } catch (error) {\n      console.error(`Error reading localStorage key \"${key}\":`, error);\n      return initialValue;\n    }\n  });\n\n  // Return a wrapped version of useState's setter function that persists the new value to localStorage\n  const setValue = (value: T | ((val: T) => T)) => {\n    try {\n      // Allow value to be a function so we have the same API as useState\n      const valueToStore = value instanceof Function ? value(storedValue) : value;\n      setStoredValue(valueToStore);\n      window.localStorage.setItem(key, JSON.stringify(valueToStore));\n    } catch (error) {\n      console.error(`Error setting localStorage key \"${key}\":`, error);\n    }\n  };\n\n  return [storedValue, setValue] as const;\n}","size_bytes":1077},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/hooks/use-virtual-scroll.ts":{"content":"import { useState, useEffect, useCallback, useRef } from 'react';\n\ninterface VirtualScrollOptions {\n  itemHeight: number;\n  containerHeight: number;\n  overscan?: number;\n  items: any[];\n}\n\nexport function useVirtualScroll({\n  itemHeight,\n  containerHeight,\n  overscan = 5,\n  items\n}: VirtualScrollOptions) {\n  const [scrollTop, setScrollTop] = useState(0);\n  const scrollElementRef = useRef<HTMLDivElement>(null);\n\n  // Calculate visible range\n  const startIndex = Math.max(0, Math.floor(scrollTop / itemHeight) - overscan);\n  const endIndex = Math.min(\n    items.length - 1,\n    Math.ceil((scrollTop + containerHeight) / itemHeight) + overscan\n  );\n\n  // Visible items\n  const visibleItems = items.slice(startIndex, endIndex + 1).map((item, index) => ({\n    ...item,\n    index: startIndex + index\n  }));\n\n  // Total height\n  const totalHeight = items.length * itemHeight;\n\n  // Offset for visible items\n  const offsetY = startIndex * itemHeight;\n\n  // Handle scroll\n  const handleScroll = useCallback((e: React.UIEvent<HTMLDivElement>) => {\n    setScrollTop(e.currentTarget.scrollTop);\n  }, []);\n\n  // Scroll to item\n  const scrollToItem = useCallback((index: number) => {\n    if (scrollElementRef.current) {\n      const scrollTop = index * itemHeight;\n      scrollElementRef.current.scrollTop = scrollTop;\n      setScrollTop(scrollTop);\n    }\n  }, [itemHeight]);\n\n  // Scroll to top\n  const scrollToTop = useCallback(() => {\n    if (scrollElementRef.current) {\n      scrollElementRef.current.scrollTop = 0;\n      setScrollTop(0);\n    }\n  }, []);\n\n  return {\n    visibleItems,\n    totalHeight,\n    offsetY,\n    scrollElementRef,\n    handleScroll,\n    scrollToItem,\n    scrollToTop,\n    startIndex,\n    endIndex\n  };\n}\n\n// Hook for infinite scroll with virtualization\nexport function useInfiniteVirtualScroll({\n  itemHeight,\n  containerHeight,\n  overscan = 5,\n  items,\n  hasNextPage,\n  fetchNextPage,\n  isFetchingNextPage,\n  threshold = 3\n}: VirtualScrollOptions & {\n  hasNextPage?: boolean;\n  fetchNextPage?: () => void;\n  isFetchingNextPage?: boolean;\n  threshold?: number;\n}) {\n  const virtualScroll = useVirtualScroll({\n    itemHeight,\n    containerHeight,\n    overscan,\n    items\n  });\n\n  const { endIndex, scrollElementRef, handleScroll: originalHandleScroll } = virtualScroll;\n\n  // Enhanced scroll handler with infinite loading\n  const handleScroll = useCallback((e: React.UIEvent<HTMLDivElement>) => {\n    originalHandleScroll(e);\n\n    // Check if we need to load more items\n    if (\n      hasNextPage &&\n      !isFetchingNextPage &&\n      fetchNextPage &&\n      endIndex >= items.length - threshold\n    ) {\n      fetchNextPage();\n    }\n  }, [\n    originalHandleScroll,\n    hasNextPage,\n    isFetchingNextPage,\n    fetchNextPage,\n    endIndex,\n    items.length,\n    threshold\n  ]);\n\n  return {\n    ...virtualScroll,\n    handleScroll,\n    hasNextPage,\n    isFetchingNextPage\n  };\n}","size_bytes":2889},"client/src/lib/protected-route.tsx":{"content":"\nimport { ReactNode } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { LoadingSpinner } from \"@/components/loading-spinner\";\n\ninterface ProtectedRouteProps {\n  children: ReactNode;\n}\n\nexport function ProtectedRoute({ children }: ProtectedRouteProps) {\n  const { user, is_loading } = useAuth();\n  const [, navigate] = useLocation();\n\n  if (is_loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <LoadingSpinner variant=\"travel\" size=\"lg\" message=\"Verificando autentica√ß√£o...\" />\n      </div>\n    );\n  }\n\n  if (!user) {\n    navigate(\"/auth\");\n    return null;\n  }\n\n  return <>{children}</>;\n}\n","size_bytes":705},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  path: string,\n  body?: any,\n): Promise<Response> {\n  // Get session ID from localStorage if available\n  const sessionId = localStorage.getItem('sessionId');\n  \n  const headers: Record<string, string> = {\n    \"Content-Type\": \"application/json\",\n  };\n  \n  // Add session ID to headers if available (fallback for cookie issues)\n  if (sessionId) {\n    headers['X-Session-ID'] = sessionId;\n  }\n  \n  const response = await fetch(path, {\n    method,\n    headers,\n    body: body ? JSON.stringify(body) : undefined,\n    credentials: 'include', // Include cookies/session\n  });\n\n  if (!response.ok) {\n    const errorText = await response.text();\n    let errorMessage = `Erro HTTP ${response.status}`;\n\n    try {\n      const errorData = JSON.parse(errorText);\n      errorMessage = errorData.message || errorMessage;\n    } catch {\n      errorMessage = errorText || errorMessage;\n    }\n\n    throw new Error(errorMessage);\n  }\n\n  return response;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    // Get session ID from localStorage if available\n    const sessionId = localStorage.getItem('sessionId');\n    \n    const headers: Record<string, string> = {\n      'Content-Type': 'application/json',\n    };\n    \n    // Add session ID to headers if available (fallback for cookie issues)\n    if (sessionId) {\n      headers['X-Session-ID'] = sessionId;\n    }\n    \n    // Handle URL with query parameters\n    let url = queryKey[0] as string;\n    \n    // If there are query parameters in the queryKey, add them to the URL\n    if (queryKey.length > 1 && typeof queryKey[1] === 'object' && queryKey[1] !== null) {\n      const params = new URLSearchParams();\n      const queryParams = queryKey[1] as Record<string, any>;\n      \n      Object.entries(queryParams).forEach(([key, value]) => {\n        if (value !== undefined && value !== null && value !== '') {\n          params.append(key, String(value));\n        }\n      });\n      \n      if (params.toString()) {\n        url += (url.includes('?') ? '&' : '?') + params.toString();\n      }\n    }\n    \n    const res = await fetch(url, {\n      credentials: \"include\",\n      headers,\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: 30 * 1000, // 30 seconds\n      retry: 1,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});","size_bytes":3055},"client/src/lib/trip-utils.ts":{"content":"// Utility functions for trip-related calculations\n\nexport interface TripParticipant {\n  id: number;\n  user_id: number;\n  status: 'accepted' | 'approved' | 'pending' | 'rejected';\n  joined_at: string;\n  user?: {\n    id: number;\n    username: string;\n    full_name: string;\n    profile_photo?: string;\n  };\n}\n\nexport interface Trip {\n  id: number;\n  current_participants?: number;\n  max_participants?: number;\n  participants?: TripParticipant[];\n  start_date?: string;\n  end_date?: string;\n  [key: string]: any;\n}\n\n/**\n * Calculates the real number of participants in a trip\n * Always counts only accepted participants from the participants array if available,\n * otherwise falls back to currentParticipants field (which should be kept in sync)\n */\nexport function getRealParticipantsCount(trip: Trip): number {\n  if (trip.participants && Array.isArray(trip.participants)) {\n    // Always prioritize counting accepted/approved participants from the participants array\n    return trip.participants.filter(p => p.status === 'accepted' || p.status === 'approved').length;\n  }\n  // Fallback to current_participants field\n  return trip.current_participants || 1;\n}\n\n/**\n * Calculates available spots in a trip\n */\nexport function getAvailableSpots(trip: Trip): number {\n  const currentCount = getRealParticipantsCount(trip);\n  const maxParticipants = trip.max_participants || 1;\n  return Math.max(0, maxParticipants - currentCount);\n}\n\n/**\n * Checks if a trip is full (no available spots)\n */\nexport function isTripFull(trip: Trip): boolean {\n  return getAvailableSpots(trip) === 0;\n}\n\n/**\n * Calculates occupancy percentage\n */\nexport function getTripOccupancy(trip: Trip): number {\n  const currentCount = getRealParticipantsCount(trip);\n  const maxParticipants = trip.max_participants || 1;\n  return maxParticipants > 0 ? (currentCount / maxParticipants) * 100 : 0;\n}\n\n/**\n * Determines if a trip has started based on start date\n */\nexport function hasTripStarted(trip: Trip): boolean {\n  if (!trip.start_date) return false;\n  const startDate = new Date(trip.start_date);\n  const today = new Date();\n  today.setHours(0, 0, 0, 0); // Reset time to compare only dates\n  startDate.setHours(0, 0, 0, 0);\n  return startDate <= today;\n}\n\n/**\n * Gets the appropriate participant count for budget calculations\n * Before trip starts: use maxParticipants (planning phase)\n * After trip starts: use real participants (execution phase)\n */\nexport function getParticipantsForBudgetCalculation(trip: Trip): number {\n  if (hasTripStarted(trip)) {\n    return getRealParticipantsCount(trip);\n  }\n  return trip.max_participants || 1;\n}","size_bytes":2613},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/pages/ForgotPasswordPage.tsx":{"content":"import { useState } from \"react\";\nimport { Link } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { z } from \"zod\";\nimport { ChevronLeft, Mail, CheckCircle, AlertCircle } from \"lucide-react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst forgotPasswordSchema = z.object({\n  email: z.string().email(\"Email inv√°lido\"),\n});\n\ntype ForgotPasswordForm = z.infer<typeof forgotPasswordSchema>;\n\nexport default function ForgotPasswordPage() {\n  const [isEmailSent, setIsEmailSent] = useState(false);\n  const { toast } = useToast();\n\n  const form = useForm<ForgotPasswordForm>({\n    resolver: zodResolver(forgotPasswordSchema),\n    defaultValues: {\n      email: \"\",\n    },\n  });\n\n  const forgotPasswordMutation = useMutation({\n    mutationFn: async (data: ForgotPasswordForm) => {\n      return apiRequest(\"/api/auth/forgot-password\", {\n        method: \"POST\",\n        body: JSON.stringify(data),\n      });\n    },\n    onSuccess: () => {\n      setIsEmailSent(true);\n      toast({\n        title: \"Email enviado!\",\n        description: \"Verifique sua caixa de entrada para redefinir sua senha.\",\n      });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Erro\",\n        description: error.message || \"Falha ao enviar email de recupera√ß√£o\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: ForgotPasswordForm) => {\n    forgotPasswordMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-cyan-50 flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"flex items-center gap-4 mb-8\">\n          <Link href=\"/auth\">\n            <Button variant=\"ghost\" size=\"sm\">\n              <ChevronLeft className=\"h-4 w-4 mr-2\" />\n              Voltar ao Login\n            </Button>\n          </Link>\n        </div>\n\n        <Card className=\"border-0 bg-white/80 backdrop-blur-sm shadow-xl\">\n          <CardHeader className=\"text-center pb-6\">\n            <div className=\"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n              {isEmailSent ? (\n                <CheckCircle className=\"h-8 w-8 text-green-600\" />\n              ) : (\n                <Mail className=\"h-8 w-8 text-blue-600\" />\n              )}\n            </div>\n            <CardTitle className=\"text-2xl font-bold text-slate-800\">\n              {isEmailSent ? \"Email Enviado!\" : \"Esqueceu sua senha?\"}\n            </CardTitle>\n            <p className=\"text-slate-600 mt-2\">\n              {isEmailSent \n                ? \"Enviamos um link para redefinir sua senha para o email informado.\"\n                : \"Digite seu email e enviaremos um link para redefinir sua senha.\"\n              }\n            </p>\n          </CardHeader>\n\n          <CardContent>\n            {!isEmailSent ? (\n              <Form {...form}>\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n                  <FormField\n                    control={form.control}\n                    name=\"email\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-slate-700 font-medium\">Email</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Mail className=\"absolute left-3 top-3 h-4 w-4 text-slate-400\" />\n                            <Input \n                              type=\"email\" \n                              placeholder=\"seu@email.com\" \n                              className=\"pl-10 bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20\" \n                              {...field} \n                            />\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <Button \n                    type=\"submit\" \n                    className=\"w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-semibold py-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200\" \n                    disabled={forgotPasswordMutation.isPending}\n                  >\n                    {forgotPasswordMutation.isPending ? \"Enviando...\" : \"Enviar Link de Recupera√ß√£o\"}\n                  </Button>\n                </form>\n              </Form>\n            ) : (\n              <div className=\"space-y-6\">\n                <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\n                  <div className=\"flex items-start gap-3\">\n                    <CheckCircle className=\"h-5 w-5 text-green-600 mt-0.5\" />\n                    <div>\n                      <h3 className=\"font-medium text-green-800\">Email enviado com sucesso!</h3>\n                      <p className=\"text-sm text-green-700 mt-1\">\n                        Verifique sua caixa de entrada e spam. O link √© v√°lido por 24 horas.\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"text-center space-y-4\">\n                  <p className=\"text-sm text-slate-600\">\n                    N√£o recebeu o email?\n                  </p>\n                  <Button \n                    variant=\"outline\"\n                    onClick={() => {\n                      setIsEmailSent(false);\n                      form.reset();\n                    }}\n                    className=\"w-full\"\n                  >\n                    Tentar Novamente\n                  </Button>\n                </div>\n              </div>\n            )}\n\n            <div className=\"mt-6 text-center\">\n              <p className=\"text-sm text-slate-600\">\n                Lembrou sua senha?{\" \"}\n                <Link href=\"/auth\" className=\"text-blue-600 hover:text-blue-800 font-medium\">\n                  Fa√ßa login\n                </Link>\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n\n        {/* Help Section */}\n        <div className=\"mt-8 bg-blue-50 rounded-lg p-4 border border-blue-200\">\n          <div className=\"flex items-start gap-3\">\n            <AlertCircle className=\"h-5 w-5 text-blue-600 mt-0.5\" />\n            <div>\n              <h3 className=\"font-medium text-blue-800\">Precisa de ajuda?</h3>\n              <p className=\"text-sm text-blue-700 mt-1\">\n                Entre em contato conosco em{\" \"}\n                <a href=\"mailto:suporte@partiutrip.com\" className=\"font-medium underline\">\n                  suporte@partiutrip.com\n                </a>\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":7270},"client/src/pages/PrivacyPolicy.tsx":{"content":"import { Link } from \"wouter\";\nimport { ChevronLeft, Shield, Database, Eye, Clock, Cookie, UserCheck, Mail } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\n\nexport default function PrivacyPolicy() {\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white border-b\">\n        <div className=\"max-w-4xl mx-auto px-4 py-6\">\n          <div className=\"flex items-center gap-4 mb-4\">\n            <Link href=\"/\">\n              <Button variant=\"ghost\" size=\"sm\">\n                <ChevronLeft className=\"h-4 w-4 mr-2\" />\n                Voltar\n              </Button>\n            </Link>\n          </div>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Pol√≠tica de Privacidade</h1>\n          <p className=\"text-gray-600 mt-2\">√öltima atualiza√ß√£o: 14 de julho de 2025</p>\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"max-w-4xl mx-auto px-4 py-8\">\n        <div className=\"bg-white rounded-lg shadow-sm border p-8 space-y-8\">\n          \n          {/* Introduction */}\n          <section>\n            <div className=\"flex items-center gap-3 mb-4\">\n              <Shield className=\"h-5 w-5 text-blue-600\" />\n              <h2 className=\"text-xl font-semibold text-gray-900\">1. Introdu√ß√£o</h2>\n            </div>\n            <p className=\"text-gray-700 leading-relaxed\">\n              A PartiuTrip (\"n√≥s\", \"nosso\") valoriza sua privacidade. Esta Pol√≠tica explica como coletamos, usamos, compartilhamos e protegemos seus dados pessoais, em conformidade com a Lei Geral de Prote√ß√£o de Dados (LGPD - Lei 13.709/2018). Ao usar nossa plataforma, voc√™ concorda com estas pr√°ticas.\n            </p>\n          </section>\n\n          {/* Data Collection */}\n          <section>\n            <div className=\"flex items-center gap-3 mb-4\">\n              <Database className=\"h-5 w-5 text-blue-600\" />\n              <h2 className=\"text-xl font-semibold text-gray-900\">2. Dados Coletados</h2>\n            </div>\n            \n            <div className=\"space-y-6\">\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-3\">a) Dados fornecidos por voc√™:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-2 ml-4\">\n                  <li><strong>Identifica√ß√£o:</strong> Nome, e-mail, telefone, foto de perfil</li>\n                  <li><strong>Prefer√™ncias de viagem:</strong> Estilo (praia, aventura, etc.), destinos de interesse, or√ßamento m√©dio</li>\n                  <li><strong>Conte√∫do gerado:</strong> Mensagens, planos de viagem, atividades, upload de recibos</li>\n                  <li><strong>Dados financeiros:</strong> Valores de despesas compartilhadas (n√£o coletamos dados banc√°rios ou cart√µes)</li>\n                </ul>\n              </div>\n\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-3\">b) Coletados automaticamente:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-2 ml-4\">\n                  <li><strong>Dados t√©cnicos:</strong> IP, tipo de navegador, dispositivo</li>\n                  <li><strong>Uso da plataforma:</strong> P√°ginas visitadas, intera√ß√µes, tempo de sess√£o</li>\n                  <li><strong>Localiza√ß√£o aproximada:</strong> Com base no IP (para sugest√µes de destinos)</li>\n                </ul>\n              </div>\n            </div>\n          </section>\n\n          {/* Processing Purposes */}\n          <section>\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">3. Finalidades do Tratamento</h2>\n            <p className=\"text-gray-700 mb-4\">Usamos seus dados para:</p>\n            \n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full border-collapse border border-gray-300\">\n                <thead>\n                  <tr className=\"bg-gray-50\">\n                    <th className=\"border border-gray-300 px-4 py-2 text-left font-semibold\">Finalidade</th>\n                    <th className=\"border border-gray-300 px-4 py-2 text-left font-semibold\">Base Legal (LGPD)</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr>\n                    <td className=\"border border-gray-300 px-4 py-2\">Criar e gerenciar sua conta</td>\n                    <td className=\"border border-gray-300 px-4 py-2\">Execu√ß√£o de contrato (Art. 7¬∫, V)</td>\n                  </tr>\n                  <tr>\n                    <td className=\"border border-gray-300 px-4 py-2\">Conectar voc√™ a companheiros de viagem</td>\n                    <td className=\"border border-gray-300 px-4 py-2\">Leg√≠timo interesse (Art. 7¬∫, IX)</td>\n                  </tr>\n                  <tr>\n                    <td className=\"border border-gray-300 px-4 py-2\">Calcular divis√£o de despesas</td>\n                    <td className=\"border border-gray-300 px-4 py-2\">Consentimento (Art. 7¬∫, I)</td>\n                  </tr>\n                  <tr>\n                    <td className=\"border border-gray-300 px-4 py-2\">Enviar notifica√ß√µes sobre viagens</td>\n                    <td className=\"border border-gray-300 px-4 py-2\">Execu√ß√£o de contrato</td>\n                  </tr>\n                  <tr>\n                    <td className=\"border border-gray-300 px-4 py-2\">Melhorar nossos servi√ßos</td>\n                    <td className=\"border border-gray-300 px-4 py-2\">Leg√≠timo interesse</td>\n                  </tr>\n                  <tr>\n                    <td className=\"border border-gray-300 px-4 py-2\">Cumprir obriga√ß√µes legais</td>\n                    <td className=\"border border-gray-300 px-4 py-2\">Obriga√ß√£o legal (Art. 7¬∫, II)</td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </section>\n\n          {/* Data Sharing */}\n          <section>\n            <div className=\"flex items-center gap-3 mb-4\">\n              <Eye className=\"h-5 w-5 text-blue-600\" />\n              <h2 className=\"text-xl font-semibold text-gray-900\">4. Compartilhamento de Dados</h2>\n            </div>\n            <p className=\"text-gray-700 mb-4\">Compartilhamos informa√ß√µes apenas quando necess√°rio:</p>\n            \n            <ul className=\"list-disc list-inside text-gray-700 space-y-2 ml-4\">\n              <li><strong>Com outros usu√°rios:</strong> Perfil b√°sico (nome, foto) e mensagens para participantes da mesma viagem</li>\n              <li><strong>Com prestadores de servi√ßo:</strong> Hospedagem em nuvem (AWS Brasil), ferramentas de an√°lise (Google Analytics anonimizado)</li>\n              <li><strong>Com autoridades:</strong> Para cumprir ordens judiciais ou leis aplic√°veis</li>\n            </ul>\n            \n            <div className=\"bg-green-50 border border-green-200 rounded-lg p-4 mt-4\">\n              <p className=\"text-green-800 font-semibold\">Nunca vendemos seus dados pessoais.</p>\n            </div>\n          </section>\n\n          {/* Data Security */}\n          <section>\n            <div className=\"flex items-center gap-3 mb-4\">\n              <Shield className=\"h-5 w-5 text-green-600\" />\n              <h2 className=\"text-xl font-semibold text-gray-900\">5. Seguran√ßa de Dados</h2>\n            </div>\n            <p className=\"text-gray-700 mb-3\">Implementamos:</p>\n            <ul className=\"list-disc list-inside text-gray-700 space-y-2 ml-4\">\n              <li><strong>Criptografia:</strong> Dados em tr√¢nsito (HTTPS) e em repouso</li>\n              <li><strong>Acesso restrito:</strong> Apenas pessoal autorizado</li>\n              <li><strong>Monitoramento cont√≠nuo:</strong> Para detectar viola√ß√µes</li>\n              <li><strong>Backups di√°rios:</strong> Em servidores seguros no Brasil</li>\n            </ul>\n          </section>\n\n          {/* Data Retention */}\n          <section>\n            <div className=\"flex items-center gap-3 mb-4\">\n              <Clock className=\"h-5 w-5 text-blue-600\" />\n              <h2 className=\"text-xl font-semibold text-gray-900\">6. Reten√ß√£o de Dados</h2>\n            </div>\n            <p className=\"text-gray-700 mb-3\">Mantemos seus dados:</p>\n            <ul className=\"list-disc list-inside text-gray-700 space-y-2 ml-4\">\n              <li><strong>Conta ativa:</strong> Enquanto voc√™ usar a plataforma</li>\n              <li><strong>Ap√≥s inatividade:</strong> 2 anos (exceto dados legais)</li>\n              <li><strong>Recibos:</strong> Exclu√≠dos automaticamente ap√≥s 180 dias</li>\n              <li><strong>Exclus√£o total:</strong> Solicita√ß√£o via Se√ß√£o 8</li>\n            </ul>\n          </section>\n\n          {/* Cookies */}\n          <section>\n            <div className=\"flex items-center gap-3 mb-4\">\n              <Cookie className=\"h-5 w-5 text-blue-600\" />\n              <h2 className=\"text-xl font-semibold text-gray-900\">7. Cookies e Tecnologias Similares</h2>\n            </div>\n            <p className=\"text-gray-700 mb-3\">Usamos:</p>\n            <ul className=\"list-disc list-inside text-gray-700 space-y-2 ml-4\">\n              <li><strong>Cookies essenciais:</strong> Para login e funcionalidades b√°sicas</li>\n              <li><strong>Cookies anal√≠ticos:</strong> Google Analytics (dados agregados)</li>\n              <li><strong>Controle:</strong> Gerencie prefer√™ncias no banner de cookies ou configura√ß√µes do navegador</li>\n            </ul>\n          </section>\n\n          {/* LGPD Rights */}\n          <section>\n            <div className=\"flex items-center gap-3 mb-4\">\n              <UserCheck className=\"h-5 w-5 text-blue-600\" />\n              <h2 className=\"text-xl font-semibold text-gray-900\">8. Seus Direitos LGPD</h2>\n            </div>\n            <p className=\"text-gray-700 mb-4\">Voc√™ pode solicitar:</p>\n            \n            <div className=\"overflow-x-auto\">\n              <table className=\"w-full border-collapse border border-gray-300\">\n                <thead>\n                  <tr className=\"bg-gray-50\">\n                    <th className=\"border border-gray-300 px-4 py-2 text-left font-semibold\">Direito</th>\n                    <th className=\"border border-gray-300 px-4 py-2 text-left font-semibold\">Como exercer</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr>\n                    <td className=\"border border-gray-300 px-4 py-2\">Acesso aos dados</td>\n                    <td className=\"border border-gray-300 px-4 py-2\">Via portal do usu√°rio ou e-mail</td>\n                  </tr>\n                  <tr>\n                    <td className=\"border border-gray-300 px-4 py-2\">Corre√ß√£o de dados</td>\n                    <td className=\"border border-gray-300 px-4 py-2\">Atualize seu perfil ou solicite</td>\n                  </tr>\n                  <tr>\n                    <td className=\"border border-gray-300 px-4 py-2\">Exclus√£o (\"esquecimento\")</td>\n                    <td className=\"border border-gray-300 px-4 py-2\">Solicite em privacidade@partiutrip.com</td>\n                  </tr>\n                  <tr>\n                    <td className=\"border border-gray-300 px-4 py-2\">Portabilidade</td>\n                    <td className=\"border border-gray-300 px-4 py-2\">Receba dados em formato leg√≠vel</td>\n                  </tr>\n                  <tr>\n                    <td className=\"border border-gray-300 px-4 py-2\">Revogar consentimento</td>\n                    <td className=\"border border-gray-300 px-4 py-2\">Ajuste configura√ß√µes de conta</td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n            \n            <p className=\"text-gray-700 mt-4\"><strong>Prazo de resposta:</strong> 15 dias √∫teis.</p>\n          </section>\n\n          {/* Minors */}\n          <section>\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">9. Menores de Idade</h2>\n            <ul className=\"list-disc list-inside text-gray-700 space-y-2 ml-4\">\n              <li><strong>Idade m√≠nima:</strong> 18 anos</li>\n              <li><strong>Verifica√ß√£o:</strong> Solicitamos confirma√ß√£o de idade no cadastro</li>\n              <li><strong>Menores inadvertidos:</strong> Excluiremos dados se identificados</li>\n            </ul>\n          </section>\n\n          {/* Policy Changes */}\n          <section>\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">10. Altera√ß√µes nesta Pol√≠tica</h2>\n            <p className=\"text-gray-700 mb-3\">Notificaremos sobre mudan√ßas:</p>\n            <ul className=\"list-disc list-inside text-gray-700 space-y-2 ml-4\">\n              <li><strong>Comunica√ß√£o:</strong> E-mail ou notifica√ß√£o na plataforma</li>\n              <li><strong>Aceita√ß√£o:</strong> Uso cont√≠nuo ap√≥s 30 dias implica concord√¢ncia</li>\n            </ul>\n          </section>\n\n          {/* DPO Contact */}\n          <section>\n            <div className=\"flex items-center gap-3 mb-4\">\n              <Mail className=\"h-5 w-5 text-blue-600\" />\n              <h2 className=\"text-xl font-semibold text-gray-900\">11. Encarregado de Dados (DPO)</h2>\n            </div>\n            <p className=\"text-gray-700\">\n              Entre em contato para exercer seus direitos:<br />\n              E-mail: <a href=\"mailto:dpo@partiutrip.com\" className=\"text-blue-600 hover:underline\">dpo@partiutrip.com</a>\n            </p>\n          </section>\n\n          {/* Specific Measures */}\n          <section className=\"bg-blue-50 rounded-lg p-6\">\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">Medidas Espec√≠ficas do PartiuTrip</h2>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">1. Compartilhamento de custos:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>Dados financeiros s√£o exclusivamente para c√°lculo</li>\n                  <li>Recibos compartilhados t√™m acesso restrito aos participantes</li>\n                </ul>\n              </div>\n\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">2. Sistema de mensagens:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>Moderamos proativamente conte√∫do ofensivo</li>\n                  <li>Mensagens s√£o armazenadas por 2 anos</li>\n                </ul>\n              </div>\n\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">3. Perfil p√∫blico:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>Controle de visibilidade nas configura√ß√µes</li>\n                  <li>Dados sens√≠veis (e.g., telefone) s√£o sempre privados</li>\n                </ul>\n              </div>\n\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">4. Upload de documentos:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>Recibos s√£o armazenados com criptografia de ponta a ponta</li>\n                  <li>Metadados (localiza√ß√£o, data) s√£o removidos automaticamente</li>\n                </ul>\n              </div>\n            </div>\n          </section>\n\n          {/* Footer Note */}\n          <section className=\"text-center text-gray-600 text-sm border-t pt-6\">\n            <p>\n              Esta pol√≠tica foi elaborada para refletir os princ√≠pios de transpar√™ncia da LGPD e as pr√°ticas de plataformas l√≠deres de viagens. Para d√∫vidas, contate nosso DPO.\n            </p>\n          </section>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":15604},"client/src/pages/ResetPasswordPage.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { z } from \"zod\";\nimport { Lock, CheckCircle, AlertCircle, Eye, EyeOff } from \"lucide-react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst resetPasswordSchema = z.object({\n  password: z.string().min(6, \"Senha deve ter pelo menos 6 caracteres\"),\n  confirmPassword: z.string().min(6, \"Confirma√ß√£o de senha √© obrigat√≥ria\"),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"As senhas n√£o coincidem\",\n  path: [\"confirmPassword\"],\n});\n\ntype ResetPasswordForm = z.infer<typeof resetPasswordSchema>;\n\nexport default function ResetPasswordPage() {\n  const [, navigate] = useLocation();\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [isSuccess, setIsSuccess] = useState(false);\n  const [token, setToken] = useState<string | null>(null);\n  const { toast } = useToast();\n\n  // Extract token from URL\n  useEffect(() => {\n    const urlParams = new URLSearchParams(window.location.search);\n    const tokenParam = urlParams.get('token');\n    if (tokenParam) {\n      setToken(tokenParam);\n    } else {\n      toast({\n        title: \"Link inv√°lido\",\n        description: \"Token de recupera√ß√£o n√£o encontrado ou inv√°lido.\",\n        variant: \"destructive\",\n      });\n      setTimeout(() => navigate(\"/auth\"), 3000);\n    }\n  }, [navigate, toast]);\n\n  const form = useForm<ResetPasswordForm>({\n    resolver: zodResolver(resetPasswordSchema),\n    defaultValues: {\n      password: \"\",\n      confirmPassword: \"\",\n    },\n  });\n\n  const resetPasswordMutation = useMutation({\n    mutationFn: async (data: ResetPasswordForm) => {\n      return apiRequest(\"/api/auth/reset-password\", {\n        method: \"POST\",\n        body: JSON.stringify({\n          token,\n          password: data.password,\n        }),\n      });\n    },\n    onSuccess: () => {\n      setIsSuccess(true);\n      toast({\n        title: \"Senha redefinida!\",\n        description: \"Sua senha foi alterada com sucesso. Redirecionando para o login...\",\n      });\n      setTimeout(() => navigate(\"/auth\"), 3000);\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Erro\",\n        description: error.message || \"Falha ao redefinir senha. Tente novamente.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: ResetPasswordForm) => {\n    if (!token) {\n      toast({\n        title: \"Erro\",\n        description: \"Token de recupera√ß√£o inv√°lido.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    resetPasswordMutation.mutate(data);\n  };\n\n  if (!token) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-cyan-50 flex items-center justify-center p-4\">\n        <Card className=\"border-0 bg-white/80 backdrop-blur-sm shadow-xl max-w-md w-full\">\n          <CardContent className=\"pt-6\">\n            <div className=\"text-center\">\n              <AlertCircle className=\"h-12 w-12 text-red-500 mx-auto mb-4\" />\n              <h2 className=\"text-xl font-bold text-slate-800 mb-2\">Link Inv√°lido</h2>\n              <p className=\"text-slate-600 mb-4\">\n                O link de recupera√ß√£o de senha √© inv√°lido ou expirou.\n              </p>\n              <Link href=\"/auth\">\n                <Button className=\"w-full\">\n                  Voltar ao Login\n                </Button>\n              </Link>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-cyan-50 flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        <Card className=\"border-0 bg-white/80 backdrop-blur-sm shadow-xl\">\n          <CardHeader className=\"text-center pb-6\">\n            <div className=\"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n              {isSuccess ? (\n                <CheckCircle className=\"h-8 w-8 text-green-600\" />\n              ) : (\n                <Lock className=\"h-8 w-8 text-blue-600\" />\n              )}\n            </div>\n            <CardTitle className=\"text-2xl font-bold text-slate-800\">\n              {isSuccess ? \"Senha Redefinida!\" : \"Redefinir Senha\"}\n            </CardTitle>\n            <p className=\"text-slate-600 mt-2\">\n              {isSuccess \n                ? \"Sua senha foi alterada com sucesso. Voc√™ ser√° redirecionado para o login.\"\n                : \"Escolha uma nova senha segura para sua conta.\"\n              }\n            </p>\n          </CardHeader>\n\n          <CardContent>\n            {!isSuccess ? (\n              <Form {...form}>\n                <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n                  <FormField\n                    control={form.control}\n                    name=\"password\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-slate-700 font-medium\">Nova Senha</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Lock className=\"absolute left-3 top-3 h-4 w-4 text-slate-400\" />\n                            <Input \n                              type={showPassword ? \"text\" : \"password\"}\n                              placeholder=\"M√≠nimo 6 caracteres\" \n                              className=\"pl-10 pr-10 bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20\" \n                              {...field} \n                            />\n                            <button\n                              type=\"button\"\n                              className=\"absolute right-3 top-3 text-slate-400 hover:text-slate-600\"\n                              onClick={() => setShowPassword(!showPassword)}\n                            >\n                              {showPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                            </button>\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"confirmPassword\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel className=\"text-slate-700 font-medium\">Confirmar Nova Senha</FormLabel>\n                        <FormControl>\n                          <div className=\"relative\">\n                            <Lock className=\"absolute left-3 top-3 h-4 w-4 text-slate-400\" />\n                            <Input \n                              type={showConfirmPassword ? \"text\" : \"password\"}\n                              placeholder=\"Confirme sua nova senha\" \n                              className=\"pl-10 pr-10 bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20\" \n                              {...field} \n                            />\n                            <button\n                              type=\"button\"\n                              className=\"absolute right-3 top-3 text-slate-400 hover:text-slate-600\"\n                              onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n                            >\n                              {showConfirmPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\n                            </button>\n                          </div>\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n                    <h3 className=\"font-medium text-blue-800 mb-2\">Requisitos da senha:</h3>\n                    <ul className=\"text-sm text-blue-700 space-y-1\">\n                      <li>‚Ä¢ M√≠nimo de 6 caracteres</li>\n                      <li>‚Ä¢ Recomendamos usar letras, n√∫meros e s√≠mbolos</li>\n                      <li>‚Ä¢ Evite senhas √≥bvias como \"123456\" ou \"password\"</li>\n                    </ul>\n                  </div>\n\n                  <Button \n                    type=\"submit\" \n                    className=\"w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-semibold py-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200\" \n                    disabled={resetPasswordMutation.isPending}\n                  >\n                    {resetPasswordMutation.isPending ? \"Redefinindo...\" : \"Redefinir Senha\"}\n                  </Button>\n                </form>\n              </Form>\n            ) : (\n              <div className=\"space-y-6\">\n                <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\n                  <div className=\"flex items-start gap-3\">\n                    <CheckCircle className=\"h-5 w-5 text-green-600 mt-0.5\" />\n                    <div>\n                      <h3 className=\"font-medium text-green-800\">Senha alterada com sucesso!</h3>\n                      <p className=\"text-sm text-green-700 mt-1\">\n                        Voc√™ ser√° redirecionado para a p√°gina de login em alguns segundos.\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                <Link href=\"/auth\">\n                  <Button className=\"w-full\">\n                    Ir para Login\n                  </Button>\n                </Link>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","size_bytes":10260},"client/src/pages/TermsOfService.tsx":{"content":"import { Link } from \"wouter\";\nimport { ChevronLeft, Shield, Users, CreditCard, MessageSquare, FileText, AlertCircle } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\n\nexport default function TermsOfService() {\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white border-b\">\n        <div className=\"max-w-4xl mx-auto px-4 py-6\">\n          <div className=\"flex items-center gap-4 mb-4\">\n            <Link href=\"/\">\n              <Button variant=\"ghost\" size=\"sm\">\n                <ChevronLeft className=\"h-4 w-4 mr-2\" />\n                Voltar\n              </Button>\n            </Link>\n          </div>\n          <h1 className=\"text-3xl font-bold text-gray-900\">Termos de Uso</h1>\n          <p className=\"text-gray-600 mt-2\">√öltima atualiza√ß√£o: 14 de julho de 2025</p>\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"max-w-4xl mx-auto px-4 py-8\">\n        <div className=\"bg-white rounded-lg shadow-sm border p-8 space-y-8\">\n          \n          {/* Section 1 */}\n          <section>\n            <div className=\"flex items-center gap-3 mb-4\">\n              <FileText className=\"h-5 w-5 text-blue-600\" />\n              <h2 className=\"text-xl font-semibold text-gray-900\">1. Aceita√ß√£o dos Termos</h2>\n            </div>\n            <p className=\"text-gray-700 leading-relaxed\">\n              Ao acessar ou utilizar a plataforma PartiuTrip (\"Plataforma\"), voc√™ concorda com estes Termos de Uso e com nossa Pol√≠tica de Privacidade. Se n√£o concordar, n√£o utilize nossos servi√ßos.\n            </p>\n          </section>\n\n          {/* Section 2 */}\n          <section>\n            <div className=\"flex items-center gap-3 mb-4\">\n              <Users className=\"h-5 w-5 text-blue-600\" />\n              <h2 className=\"text-xl font-semibold text-gray-900\">2. Elegibilidade</h2>\n            </div>\n            <p className=\"text-gray-700 leading-relaxed mb-3\">Voc√™ deve:</p>\n            <ul className=\"list-disc list-inside text-gray-700 space-y-2 ml-4\">\n              <li>Ter pelo menos 18 anos</li>\n              <li>Ser pessoa f√≠sica</li>\n              <li>Fornecer informa√ß√µes precisas e atualizadas</li>\n              <li>Ser respons√°vel pela seguran√ßa de sua conta</li>\n            </ul>\n          </section>\n\n          {/* Section 3 */}\n          <section>\n            <div className=\"flex items-center gap-3 mb-4\">\n              <Shield className=\"h-5 w-5 text-blue-600\" />\n              <h2 className=\"text-xl font-semibold text-gray-900\">3. Natureza da Plataforma</h2>\n            </div>\n            <p className=\"text-gray-700 leading-relaxed mb-3\">O PartiuTrip √© uma plataforma de conex√£o entre viajantes para:</p>\n            <ul className=\"list-disc list-inside text-gray-700 space-y-2 ml-4\">\n              <li>Planejamento colaborativo de viagens</li>\n              <li>Compartilhamento de custos e despesas</li>\n              <li>Intera√ß√£o entre usu√°rios com interesses similares</li>\n              <li>N√£o somos uma ag√™ncia de viagens nem respons√°veis por acordos entre usu√°rios</li>\n            </ul>\n          </section>\n\n          {/* Section 4 */}\n          <section>\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">4. Responsabilidades do Usu√°rio</h2>\n            <p className=\"text-gray-700 leading-relaxed mb-4\">Voc√™ concorda em:</p>\n            \n            <div className=\"space-y-6\">\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">a) Compartilhamento de Custos:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>Todas as transa√ß√µes financeiras s√£o de responsabilidade exclusiva dos usu√°rios</li>\n                  <li>A plataforma apenas fornece ferramentas de c√°lculo, sem intermediar pagamentos</li>\n                  <li>Recomendamos acordos por escrito entre participantes</li>\n                </ul>\n              </div>\n\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">b) Conduta em Viagens:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>Agir com respeito e seguran√ßa durante as viagens</li>\n                  <li>Cumprir leis locais e regulamentos de viagem</li>\n                  <li>N√£o discriminar com base em ra√ßa, g√™nero, religi√£o ou orienta√ß√£o sexual</li>\n                </ul>\n              </div>\n\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">c) Conte√∫do Gerado:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>Garantir que fotos/informa√ß√µes compartilhadas n√£o violam direitos de terceiros</li>\n                  <li>N√£o publicar conte√∫do ilegal, ofensivo ou comercial n√£o autorizado</li>\n                </ul>\n              </div>\n            </div>\n          </section>\n\n          {/* Section 5 */}\n          <section>\n            <div className=\"flex items-center gap-3 mb-4\">\n              <CreditCard className=\"h-5 w-5 text-blue-600\" />\n              <h2 className=\"text-xl font-semibold text-gray-900\">5. Sistema Financeiro</h2>\n            </div>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">a) Ferramentas de C√°lculo:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>As funcionalidades de divis√£o de despesas s√£o sugest√µes matem√°ticas</li>\n                  <li>N√£o validamos transa√ß√µes nem armazenamos dados financeiros sens√≠veis</li>\n                </ul>\n              </div>\n\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">b) Comprovantes:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>Recibos compartilhados permanecem propriedade dos usu√°rios</li>\n                  <li>Exclu√≠mos automaticamente documentos ap√≥s 180 dias</li>\n                </ul>\n              </div>\n            </div>\n          </section>\n\n          {/* Section 6 */}\n          <section>\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">6. Privacidade e Dados</h2>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">a) Coletamos:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>Dados de perfil e prefer√™ncias de viagem</li>\n                  <li>Informa√ß√µes sobre planos de viagem</li>\n                  <li>Registros de intera√ß√µes na plataforma</li>\n                </ul>\n              </div>\n\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">b) Compartilhamos:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>Informa√ß√µes b√°sicas com potenciais companheiros de viagem</li>\n                  <li>Dados agregados/an√¥nimos para estat√≠sticas</li>\n                  <li>Nunca vendemos dados pessoais a terceiros</li>\n                </ul>\n              </div>\n            </div>\n          </section>\n\n          {/* Section 7 */}\n          <section>\n            <div className=\"flex items-center gap-3 mb-4\">\n              <MessageSquare className=\"h-5 w-5 text-blue-600\" />\n              <h2 className=\"text-xl font-semibold text-gray-900\">7. Comunica√ß√µes</h2>\n            </div>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">a) Entre Usu√°rios:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>Mensagens s√£o moderadas proativamente</li>\n                  <li>Reservamo-nos o direito de remover conte√∫do inadequado</li>\n                </ul>\n              </div>\n\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">b) Da Plataforma:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>Enviaremos comunica√ß√µes sobre suas viagens e atualiza√ß√µes importantes</li>\n                  <li>Voc√™ pode gerir prefer√™ncias de notifica√ß√£o</li>\n                </ul>\n              </div>\n            </div>\n          </section>\n\n          {/* Additional sections - condensed for brevity */}\n          <section>\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">8. Propriedade Intelectual</h2>\n            <div className=\"space-y-3\">\n              <p className=\"text-gray-700\"><strong>Conte√∫do do Usu√°rio:</strong> Voc√™ mant√©m os direitos sobre seu conte√∫do e concede licen√ßa n√£o exclusiva para exibi√ß√£o na plataforma.</p>\n              <p className=\"text-gray-700\"><strong>Plataforma:</strong> Todo c√≥digo, design e tecnologia s√£o propriedade do PartiuTrip. √â proibida a reprodu√ß√£o n√£o autorizada.</p>\n            </div>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">9. Seguran√ßa</h2>\n            <p className=\"text-gray-700 mb-3\">Implementamos:</p>\n            <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n              <li>Autentica√ß√£o de dois fatores opcional</li>\n              <li>Criptografia de dados em tr√¢nsito e repouso</li>\n              <li>Monitoramento cont√≠nuo de seguran√ßa</li>\n              <li>Sess√µes autom√°ticas ap√≥s 30 minutos de inatividade</li>\n            </ul>\n          </section>\n\n          <section>\n            <div className=\"flex items-center gap-3 mb-4\">\n              <AlertCircle className=\"h-5 w-5 text-red-600\" />\n              <h2 className=\"text-xl font-semibold text-gray-900\">10. Isen√ß√µes de Responsabilidade</h2>\n            </div>\n            <p className=\"text-gray-700 mb-3\">O PartiuTrip:</p>\n            <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n              <li>N√£o valida identidade dos usu√°rios (verifica√ß√£o opcional dispon√≠vel)</li>\n              <li>N√£o garante seguran√ßa em encontros presenciais</li>\n              <li>N√£o se responsabiliza por perdas financeiras entre usu√°rios</li>\n              <li>N√£o endossa conte√∫do gerado por usu√°rios</li>\n            </ul>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">11. Lei Aplic√°vel</h2>\n            <p className=\"text-gray-700\">\n              Estes termos s√£o regidos pelas leis brasileiras. Disputas ser√£o resolvidas no foro de Porto Alegre-RS.\n            </p>\n          </section>\n\n          <section>\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">12. Contato</h2>\n            <p className=\"text-gray-700\">\n              D√∫vidas ou reclama√ß√µes:<br />\n              Email: <a href=\"mailto:juridico@partiutrip.com\" className=\"text-blue-600 hover:underline\">juridico@partiutrip.com</a>\n            </p>\n          </section>\n\n          {/* Safety recommendations */}\n          <section className=\"bg-blue-50 rounded-lg p-6\">\n            <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">Recomenda√ß√µes de Seguran√ßa</h2>\n            \n            <div className=\"space-y-4\">\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">Encontros Presenciais:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>Sempre encontre-se inicialmente em locais p√∫blicos</li>\n                  <li>Informe amigos/fam√≠lia sobre seus planos</li>\n                  <li>Confira documentos de identifica√ß√£o</li>\n                </ul>\n              </div>\n\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">Transa√ß√µes Financeiras:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>Use plataformas de pagamento rastre√°veis</li>\n                  <li>Guarde comprovantes digitais</li>\n                  <li>Estabele√ßa limites claros de responsabilidade</li>\n                </ul>\n              </div>\n\n              <div>\n                <h3 className=\"font-semibold text-gray-800 mb-2\">Prote√ß√£o de Dados:</h3>\n                <ul className=\"list-disc list-inside text-gray-700 space-y-1 ml-4\">\n                  <li>N√£o compartilhe documentos completos na plataforma</li>\n                  <li>Use senhas complexas e √∫nicas</li>\n                  <li>Revise periodicamente suas permiss√µes</li>\n                </ul>\n              </div>\n            </div>\n          </section>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":12847},"client/src/pages/activities-page.tsx":{"content":"import { useState, useEffect, useMemo, useCallback } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { \n  Search, \n  Filter, \n  Star, \n  MapPin, \n  Clock, \n  Users, \n  Heart,\n  SlidersHorizontal,\n  Grid,\n  List,\n  TrendingUp,\n  Calendar,\n  DollarSign,\n  Award,\n  Plus,\n  ChevronRight,\n  Target,\n  Sparkles,\n  ChevronDown,\n  X,\n  ArrowUpDown,\n  Eye,\n  Bookmark,\n  Home,\n  Globe,\n  Anchor,\n  ChevronLeft\n} from \"lucide-react\";\nimport useEmblaCarousel from 'embla-carousel-react';\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { LoadingSpinner } from \"@/components/loading-spinner\";\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n  SheetTrigger,\n} from \"@/components/ui/sheet\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { activityCategories } from \"@shared/schema\";\nimport type { Activity } from \"@shared/schema\";\nimport { formatBrazilianCurrency, formatBrazilianNumber } from \"@shared/utils\";\n\ninterface ActivityFilters {\n  search: string;\n  categories: string[];\n  priceRange: string;\n  location: string;\n  duration: string;\n  difficulty: string;\n  rating: string;\n  sortBy: string;\n  onlyMyTrips: boolean;\n  onlyActiveTrips: boolean;\n}\n\nconst PRICE_RANGES = [\n  { value: \"all\", label: \"Todos os pre√ßos\" },\n  { value: \"free\", label: \"Gr√°tis\" },\n  { value: \"0-50\", label: \"At√© R$ 50\" },\n  { value: \"50-150\", label: \"R$ 50 - R$ 150\" },\n  { value: \"150-300\", label: \"R$ 150 - R$ 300\" },\n  { value: \"300+\", label: \"Acima de R$ 300\" },\n];\n\nconst DIFFICULTY_LEVELS = [\n  { value: \"all\", label: \"Todos os n√≠veis\" },\n  { value: \"easy\", label: \"F√°cil\" },\n  { value: \"moderate\", label: \"Moderado\" },\n  { value: \"challenging\", label: \"Desafiador\" },\n];\n\nconst SORT_OPTIONS = [\n  { value: \"rating\", label: \"Melhor avalia√ß√£o\" },\n  { value: \"price_low\", label: \"Menor pre√ßo\" },\n  { value: \"price_high\", label: \"Maior pre√ßo\" },\n  { value: \"duration\", label: \"Dura√ß√£o\" },\n  { value: \"newest\", label: \"Mais recentes\" },\n];\n\nconst DURATION_OPTIONS = [\n  { value: \"all\", label: \"Qualquer dura√ß√£o\" },\n  { value: \"1-2\", label: \"1-2 horas\" },\n  { value: \"3-4\", label: \"3-4 horas\" },\n  { value: \"5-8\", label: \"5-8 horas\" },\n  { value: \"8+\", label: \"Dia inteiro\" },\n];\n\nfunction ActivitiesPage() {\n  const { user } = useAuth();\n  const [filters, setFilters] = useState<ActivityFilters>({\n    search: \"\",\n    categories: [],\n    priceRange: \"all\",\n    location: \"\",\n    duration: \"all\",\n    difficulty: \"all\",\n    rating: \"all\",\n    sortBy: \"rating\",\n    onlyMyTrips: false,\n    onlyActiveTrips: false,\n  });\n\n  const [searchInput, setSearchInput] = useState(\"\");\n  const [debouncedSearch, setDebouncedSearch] = useState(\"\");\n  const [displayMode, setDisplayMode] = useState<\"grid\" | \"list\">(\"list\");\n  const [showFilters, setShowFilters] = useState(false);\n  const [activeFiltersCount, setActiveFiltersCount] = useState(0);\n  \n  // Hierarchical navigation state\n  const [selectedCountryType, setSelectedCountryType] = useState<string | null>(null);\n  const [selectedRegion, setSelectedRegion] = useState<string | null>(null);\n  const [selectedCity, setSelectedCity] = useState<string | null>(null);\n  const [viewMode, setViewMode] = useState<'hierarchy' | 'list'>('list');\n\n  // Debounce search input\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setDebouncedSearch(searchInput);\n    }, 300);\n    return () => clearTimeout(timer);\n  }, [searchInput]);\n\n  // Update filters when debounced search changes\n  useEffect(() => {\n    setFilters(prev => ({ ...prev, search: debouncedSearch }));\n  }, [debouncedSearch]);\n\n  // Count active filters\n  useEffect(() => {\n    let count = 0;\n    if (filters.categories.length > 0) count++;\n    if (filters.priceRange !== \"all\") count++;\n    if (filters.location !== \"\") count++;\n    if (filters.duration !== \"all\") count++;\n    if (filters.difficulty !== \"all\") count++;\n    if (filters.rating !== \"all\") count++;\n    if (filters.onlyActiveTrips) count++;\n    if (filters.onlyMyTrips) count++;\n    setActiveFiltersCount(count);\n  }, [filters]);\n\n  // Fetch user's trips to filter activities by destination\n  const { data: myTripsData } = useQuery({\n    queryKey: [\"/api/my-trips\"],\n    queryFn: async () => {\n      if (!user) return { created: [], participating: [] };\n      try {\n        const response = await fetch(\"/api/my-trips\");\n        if (!response.ok) return { created: [], participating: [] };\n        return response.json();\n      } catch (error) {\n        console.error(\"Erro ao carregar viagens do usu√°rio:\", error);\n        return { created: [], participating: [] };\n      }\n    },\n    enabled: !!user,\n    retry: false,\n  });\n\n  // Combine created and participating trips\n  const userTrips = useMemo(() => {\n    if (!myTripsData) return [];\n    return [...(myTripsData.created || []), ...(myTripsData.participating || [])];\n  }, [myTripsData]);\n\n  const { data: activities, isLoading, isFetching } = useQuery<Activity[]>({\n    queryKey: [\"/api/activities\", filters],\n    queryFn: async () => {\n      try {\n        const params = new URLSearchParams();\n        if (filters.search) params.set(\"search\", filters.search);\n        if (filters.categories.length > 0) {\n          filters.categories.forEach(category => params.append(\"category\", category));\n        }\n        if (filters.priceRange !== \"all\") params.set(\"priceRange\", filters.priceRange);\n        if (filters.location) params.set(\"location\", filters.location);\n        if (filters.duration !== \"all\") params.set(\"duration\", filters.duration);\n        if (filters.difficulty !== \"all\") params.set(\"difficulty\", filters.difficulty);\n        if (filters.rating !== \"all\") params.set(\"rating\", filters.rating);\n        params.set(\"sortBy\", filters.sortBy);\n        \n        const response = await fetch(`/api/activities?${params}`);\n        if (!response.ok) throw new Error(\"Falha ao carregar atividades\");\n        return response.json();\n      } catch (error) {\n        console.error(\"Erro ao carregar atividades:\", error);\n        throw error;\n      }\n    },\n    retry: 1,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n\n  // Fetch hierarchical structure\n  const { data: hierarchy } = useQuery({\n    queryKey: [\"/api/activities/hierarchy\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/activities/hierarchy\");\n      if (!response.ok) throw new Error(\"Falha ao carregar hierarquia\");\n      return response.json();\n    },\n    staleTime: 10 * 60 * 1000, // 10 minutes\n  });\n\n  // Fetch activities by location when in hierarchy mode\n  const { data: locationActivities } = useQuery<Activity[]>({\n    queryKey: [\"/api/activities/by-location\", selectedCountryType, selectedRegion, selectedCity],\n    queryFn: async () => {\n      if (!selectedCountryType) return [];\n      const params = new URLSearchParams();\n      params.set(\"countryType\", selectedCountryType);\n      if (selectedRegion) params.set(\"region\", selectedRegion);\n      if (selectedCity) params.set(\"city\", selectedCity);\n      \n      const response = await fetch(`/api/activities/by-location?${params}`);\n      if (!response.ok) throw new Error(\"Falha ao carregar atividades por localiza√ß√£o\");\n      return response.json();\n    },\n    enabled: viewMode === 'hierarchy' && !!selectedCountryType,\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n\n  // Fetch popular activities suggestions\n  const { data: popularActivities } = useQuery<Activity[]>({\n    queryKey: [\"/api/activities/suggestions/popular\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/activities/suggestions/popular?limit=6\");\n      if (!response.ok) throw new Error(\"Falha ao carregar atividades populares\");\n      return response.json();\n    },\n    staleTime: 10 * 60 * 1000, // 10 minutes\n  });\n\n\n\n  // Fetch personalized suggestions (only for authenticated users)\n  const { data: personalizedActivities } = useQuery<Activity[]>({\n    queryKey: [\"/api/activities/suggestions/personalized\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/activities/suggestions/personalized?limit=6\");\n      if (!response.ok) throw new Error(\"Falha ao carregar sugest√µes personalizadas\");\n      return response.json();\n    },\n    enabled: !!user,\n    staleTime: 15 * 60 * 1000, // 15 minutes\n  });\n\n  const updateFilter = (key: keyof ActivityFilters, value: string | boolean) => {\n    setFilters(prev => ({ ...prev, [key]: value }));\n  };\n\n  const clearFilters = () => {\n    setFilters({\n      search: \"\",\n      categories: [],\n      priceRange: \"all\",\n      location: \"\",\n      duration: \"all\",\n      difficulty: \"all\",\n      rating: \"all\",\n      sortBy: \"rating\",\n      onlyMyTrips: false,\n      onlyActiveTrips: false,\n    });\n    setSearchInput(\"\");\n  };\n\n  const renderStars = (rating: number) => {\n    return Array.from({ length: 5 }, (_, i) => (\n      <Star\n        key={i}\n        className={`w-4 h-4 ${\n          i < Math.floor(rating)\n            ? \"fill-yellow-400 text-yellow-400\"\n            : \"text-gray-300\"\n        }`}\n      />\n    ));\n  };\n\n  const filteredActivities = useMemo(() => {\n    if (!activities) return [];\n    \n    let result = activities;\n    \n    if (filters.onlyMyTrips && user) {\n      result = result.filter(activity => {\n        const activityCity = activity.location.split(',')[0].trim();\n        return userTrips.some(trip => {\n          const tripCity = trip.destination.split(',')[0].trim();\n          return tripCity.toLowerCase() === activityCity.toLowerCase();\n        });\n      });\n    }\n    \n    if (filters.onlyActiveTrips && user) {\n      result = result.filter(activity => {\n        const activityCity = activity.location.split(',')[0].trim();\n        const now = new Date();\n        return userTrips.some(trip => {\n          const tripCity = trip.destination.split(',')[0].trim();\n          const tripStart = new Date(trip.start_date || trip.startDate);\n          const tripEnd = new Date(trip.end_date || trip.endDate);\n          return (\n            tripCity.toLowerCase() === activityCity.toLowerCase() &&\n            tripStart <= now && now <= tripEnd\n          );\n        });\n      });\n    }\n    \n    return result;\n  }, [activities, filters.onlyMyTrips, filters.onlyActiveTrips, user, userTrips]);\n\n  const topActivities = useMemo(() => {\n    if (!activities) return [];\n    return activities\n      .filter(activity => (activity.rating || 0) >= 4.5)\n      .sort((a, b) => (b.rating || 0) - (a.rating || 0))\n      .slice(0, 6);\n  }, [activities]);\n\n  // Query for counting activities (apply all filters EXCEPT category filters)\n  const { data: activitiesForCount } = useQuery<Activity[]>({\n    queryKey: [\"/api/activities\", \"count-only\", {\n      search: filters.search,\n      priceRange: filters.priceRange,\n      location: filters.location,\n      duration: filters.duration,\n      difficulty: filters.difficulty,\n      rating: filters.rating,\n      onlyMyTrips: filters.onlyMyTrips,\n      onlyActiveTrips: filters.onlyActiveTrips,\n      sortBy: filters.sortBy\n    }],\n    queryFn: async () => {\n      const params = new URLSearchParams();\n      if (filters.search) params.set(\"search\", filters.search);\n      // NOTE: No category filter here - we want counts that respond to other filters\n      if (filters.priceRange !== \"all\") params.set(\"priceRange\", filters.priceRange);\n      if (filters.location) params.set(\"location\", filters.location);\n      if (filters.duration !== \"all\") params.set(\"duration\", filters.duration);\n      if (filters.difficulty !== \"all\") params.set(\"difficulty\", filters.difficulty);\n      if (filters.rating !== \"all\") params.set(\"rating\", filters.rating);\n      params.set(\"sortBy\", filters.sortBy);\n      \n      const response = await fetch(`/api/activities?${params}`);\n      if (!response.ok) throw new Error(\"Falha ao carregar atividades\");\n      return response.json();\n    },\n    staleTime: 5 * 60 * 1000, // 5 minutes\n  });\n\n  const categoryStats = useMemo(() => {\n    if (!activitiesForCount) return [];\n    \n    // Convert activityCategories object to array format using filtered data (but not category-filtered)\n    const categoriesArray = Object.entries(activityCategories).map(([value, { label, icon }]) => ({\n      value,\n      label,\n      icon,\n      count: activitiesForCount.filter(a => a.category === value).length\n    }));\n    \n    // Add \"Todas\" option at the beginning\n    const allOption = {\n      value: \"all\",\n      label: \"Todas\",\n      icon: \"üéØ\",\n      count: activitiesForCount.length\n    };\n    \n    return [allOption, ...categoriesArray];\n  }, [activitiesForCount]);\n\n  // Function to toggle category selection\n  const toggleCategory = (categoryValue: string) => {\n    if (categoryValue === \"all\") {\n      // If \"Todas\" is clicked, clear all categories\n      setFilters(prev => ({ ...prev, categories: [] }));\n    } else {\n      setFilters(prev => ({\n        ...prev,\n        categories: prev.categories.includes(categoryValue)\n          ? prev.categories.filter(c => c !== categoryValue)\n          : [...prev.categories, categoryValue]\n      }));\n    }\n  };\n\n  const FilterSidebar = () => (\n    <div className=\"space-y-4\">\n      {/* Active Trips Filter */}\n      {user && (\n        <div className=\"p-3 rounded-lg border border-blue-200 bg-blue-50\">\n          <div className=\"flex items-center justify-between\">\n            <div className=\"space-y-0.5\">\n              <label className=\"text-sm font-medium text-blue-900 flex items-center gap-2\">\n                <Calendar className=\"w-3 h-3\" />\n                Viagens ativas\n              </label>\n              <p className=\"text-xs text-blue-700\">\n                Atividades nos destinos das suas viagens em andamento\n              </p>\n            </div>\n            <Switch\n              checked={filters.onlyActiveTrips}\n              onCheckedChange={(checked) => updateFilter(\"onlyActiveTrips\", checked)}\n            />\n          </div>\n        </div>\n      )}\n\n      {/* Category Filter */}\n      <div className=\"space-y-2\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"text-sm font-medium text-gray-900 flex items-center gap-2\">\n            <Target className=\"w-3 h-3\" />\n            Categoria\n          </h3>\n          {filters.categories.length > 0 && (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => setFilters(prev => ({ ...prev, categories: [] }))}\n              className=\"h-6 px-2 text-xs text-gray-500 hover:text-gray-700\"\n            >\n              Limpar\n            </Button>\n          )}\n        </div>\n        \n        <div className=\"grid grid-cols-2 gap-1.5\">\n          {categoryStats.map((category) => {\n            const isSelected = category.value === \"all\" \n              ? filters.categories.length === 0 \n              : filters.categories.includes(category.value);\n            \n            // Show count logic: \n            // - Always show count for \"Todas\" button\n            // - For other categories, show count only when no specific categories are selected\n            const showCount = category.value === \"all\" || filters.categories.length === 0;\n            \n\n            \n            return (\n              <div\n                key={category.value}\n                className={`flex items-center justify-between p-1.5 rounded-md border cursor-pointer transition-all text-xs ${\n                  isSelected\n                    ? \"border-blue-500 bg-blue-50 text-blue-700\"\n                    : \"border-gray-200 hover:border-gray-300 hover:bg-gray-50\"\n                }`}\n                onClick={() => toggleCategory(category.value)}\n              >\n                <div className=\"flex items-center gap-1 min-w-0\">\n                  <span className=\"text-xs\">{category.icon}</span>\n                  <span className=\"font-medium truncate text-xs\">{category.label}</span>\n                </div>\n                {showCount && (\n                  <Badge variant=\"outline\" className=\"text-xs px-1 py-0 h-auto\">\n                    {category.count}\n                  </Badge>\n                )}\n              </div>\n            );\n          })}\n        </div>\n      </div>\n\n      <Separator />\n\n      {/* Filter Grid - Responsive Layout */}\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n        {/* Price Range */}\n        <div className=\"space-y-2\">\n          <h3 className=\"text-sm font-medium text-gray-900 flex items-center gap-2\">\n            <DollarSign className=\"w-3 h-3\" />\n            Pre√ßo\n          </h3>\n          <Select value={filters.priceRange} onValueChange={(value) => updateFilter(\"priceRange\", value)}>\n            <SelectTrigger className=\"h-8 text-sm\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              {PRICE_RANGES.map((range) => (\n                <SelectItem key={range.value} value={range.value}>\n                  {range.label}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n\n        {/* Duration */}\n        <div className=\"space-y-2\">\n          <h3 className=\"text-sm font-medium text-gray-900 flex items-center gap-2\">\n            <Clock className=\"w-3 h-3\" />\n            Dura√ß√£o\n          </h3>\n          <Select value={filters.duration} onValueChange={(value) => updateFilter(\"duration\", value)}>\n            <SelectTrigger className=\"h-8 text-sm\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              {DURATION_OPTIONS.map((option) => (\n                <SelectItem key={option.value} value={option.value}>\n                  {option.label}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n\n        {/* Difficulty */}\n        <div className=\"space-y-2\">\n          <h3 className=\"text-sm font-medium text-gray-900 flex items-center gap-2\">\n            <TrendingUp className=\"w-3 h-3\" />\n            Dificuldade\n          </h3>\n          <Select value={filters.difficulty} onValueChange={(value) => updateFilter(\"difficulty\", value)}>\n            <SelectTrigger className=\"h-8 text-sm\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              {DIFFICULTY_LEVELS.map((level) => (\n                <SelectItem key={level.value} value={level.value}>\n                  {level.label}\n                </SelectItem>\n              ))}\n            </SelectContent>\n          </Select>\n        </div>\n\n        {/* Rating */}\n        <div className=\"space-y-2\">\n          <h3 className=\"text-sm font-medium text-gray-900 flex items-center gap-2\">\n            <Star className=\"w-3 h-3\" />\n            Avalia√ß√£o\n          </h3>\n          <Select value={filters.rating} onValueChange={(value) => updateFilter(\"rating\", value)}>\n            <SelectTrigger className=\"h-8 text-sm\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"all\">Todas as avalia√ß√µes</SelectItem>\n              <SelectItem value=\"5\">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 5 estrelas</SelectItem>\n              <SelectItem value=\"4\">‚≠ê‚≠ê‚≠ê‚≠ê 4+ estrelas</SelectItem>\n              <SelectItem value=\"3\">‚≠ê‚≠ê‚≠ê 3+ estrelas</SelectItem>\n              <SelectItem value=\"2\">‚≠ê‚≠ê 2+ estrelas</SelectItem>\n            </SelectContent>\n          </Select>\n        </div>\n      </div>\n\n      {/* My Trips Only */}\n      {user && (\n        <>\n          <Separator />\n          <div className=\"flex items-center justify-between p-2 rounded-md border border-gray-200 bg-gray-50\">\n            <div className=\"space-y-0.5\">\n              <label className=\"text-sm font-medium text-gray-900\">\n                Apenas meus destinos\n              </label>\n              <p className=\"text-xs text-gray-500\">\n                Destinos das minhas viagens\n              </p>\n            </div>\n            <Switch\n              checked={filters.onlyMyTrips}\n              onCheckedChange={(checked) => updateFilter(\"onlyMyTrips\", checked)}\n            />\n          </div>\n        </>\n      )}\n\n      {/* Clear Filters */}\n      {activeFiltersCount > 0 && (\n        <Button \n          variant=\"outline\" \n          onClick={clearFilters}\n          className=\"w-full h-8 text-sm\"\n        >\n          <X className=\"w-3 h-3 mr-2\" />\n          Limpar Filtros ({activeFiltersCount})\n        </Button>\n      )}\n    </div>\n  );\n\n  // Check if activity is both popular and highly rated\n  const isTopQuality = (activity: Activity) => {\n    const rating = Number(activity.average_rating || activity.averageRating || activity.rating || 0);\n    const totalRatings = activity.total_ratings || activity.totalRatings || activity.review_count || activity.reviewCount || 0;\n    return rating >= 4.5 && totalRatings >= 5;\n  };\n\n  // Get icon for country type\n  const getCountryTypeIcon = (countryType: string) => {\n    switch (countryType) {\n      case 'nacional': return <Home className=\"w-5 h-5\" />;\n      case 'internacional': return <Globe className=\"w-5 h-5\" />;\n      case 'cruzeiro': return <Anchor className=\"w-5 h-5\" />;\n      default: return <MapPin className=\"w-5 h-5\" />;\n    }\n  };\n\n  // Get display name for country type\n  const getCountryTypeDisplayName = (countryType: string) => {\n    switch (countryType) {\n      case 'nacional': return 'Nacionais';\n      case 'internacional': return 'Internacionais';\n      case 'cruzeiro': return 'Cruzeiros';\n      default: return countryType;\n    }\n  };\n\n  // Breadcrumb component for navigation\n  const Breadcrumb = () => (\n    <div className=\"flex items-center gap-2 text-sm text-gray-600 mb-4\">\n      <Button\n        variant=\"ghost\"\n        size=\"sm\"\n        onClick={() => {\n          setSelectedCountryType(null);\n          setSelectedRegion(null);\n          setSelectedCity(null);\n        }}\n        className=\"h-8 px-2 hover:bg-blue-50\"\n      >\n        Todas as Atividades\n      </Button>\n      \n      {selectedCountryType && (\n        <>\n          <ChevronRight className=\"w-4 h-4\" />\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => {\n              setSelectedRegion(null);\n              setSelectedCity(null);\n            }}\n            className=\"h-8 px-2 hover:bg-blue-50\"\n          >\n            {getCountryTypeDisplayName(selectedCountryType)}\n          </Button>\n        </>\n      )}\n      \n      {selectedRegion && (\n        <>\n          <ChevronRight className=\"w-4 h-4\" />\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={() => setSelectedCity(null)}\n            className=\"h-8 px-2 hover:bg-blue-50\"\n          >\n            {selectedRegion}\n          </Button>\n        </>\n      )}\n      \n      {selectedCity && (\n        <>\n          <ChevronRight className=\"w-4 h-4\" />\n          <span className=\"font-medium text-gray-900\">{selectedCity}</span>\n        </>\n      )}\n    </div>\n  );\n\n  // Premium Activity Card Component (for carousel)\n  const PremiumActivityCard = ({ activity, index }: { activity: Activity; index: number }) => {\n    const isPremium = isTopQuality(activity);\n    \n    return (\n      <motion.div\n        initial={{ opacity: 0, y: 30, scale: 0.95 }}\n        animate={{ opacity: 1, y: 0, scale: 1 }}\n        transition={{ \n          delay: index * 0.15,\n          duration: 0.6,\n          ease: [0.21, 1.02, 0.73, 1]\n        }}\n        whileHover={{ \n          y: -8,\n          scale: 1.03,\n          transition: { duration: 0.3, ease: \"easeOut\" }\n        }}\n        className=\"group flex-[0_0_280px] mr-5 last:mr-0\"\n      >\n        <Link to={`/activities/${activity.id}`}>\n          <Card className={`relative h-full overflow-hidden border-0 transition-all duration-500 bg-white ${\n            isPremium \n              ? 'shadow-2xl shadow-yellow-500/25 ring-1 ring-yellow-300/30 hover:shadow-3xl hover:shadow-yellow-600/40 hover:ring-yellow-400/50' \n              : 'shadow-xl shadow-gray-500/20 hover:shadow-2xl hover:shadow-blue-500/30'\n          }`}>\n            {/* Gradient Background Overlay for Premium */}\n            {isPremium && (\n              <div className=\"absolute inset-0 bg-gradient-to-br from-yellow-50/80 via-orange-50/60 to-red-50/40 opacity-0 group-hover:opacity-100 transition-opacity duration-500 z-0\" />\n            )}\n            \n            <div className=\"relative z-10\">\n              <div className=\"relative overflow-hidden\">\n                <motion.img\n                  src={activity.cover_image || activity.imageUrl || `https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=400&h=250&fit=crop&crop=center`}\n                  alt={activity.title}\n                  className=\"w-full h-44 object-cover transition-all duration-700 group-hover:scale-115\"\n                  whileHover={{ scale: 1.1 }}\n                  onError={(e) => {\n                    e.currentTarget.src = `https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=400&h=250&fit=crop&crop=center`;\n                  }}\n                />\n                \n                {/* Dynamic Gradient Overlay */}\n                <div className={`absolute inset-0 transition-all duration-700 ${\n                  isPremium \n                    ? 'bg-gradient-to-t from-amber-900/80 via-orange-900/50 to-transparent group-hover:from-amber-900/90' \n                    : 'bg-gradient-to-t from-slate-900/70 via-slate-900/40 to-transparent group-hover:from-slate-900/80'\n                }`} />\n                \n                {/* Animated Border Effect for Premium */}\n                {isPremium && (\n                  <div className=\"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity duration-500\">\n                    <div className=\"absolute inset-0 border-2 border-yellow-400/50 animate-pulse\" />\n                  </div>\n                )}\n                \n                {/* Premium Badge with Animation */}\n                {isPremium && (\n                  <motion.div \n                    className=\"absolute top-4 left-4\"\n                    initial={{ scale: 0, rotate: -45 }}\n                    animate={{ scale: 1, rotate: 0 }}\n                    transition={{ delay: index * 0.1 + 0.5, type: \"spring\", stiffness: 200 }}\n                  >\n                    <div className=\"relative bg-gradient-to-r from-yellow-400 via-amber-500 to-orange-600 text-white px-4 py-2 rounded-full shadow-2xl border border-yellow-300/60 flex items-center gap-2 backdrop-blur-sm\">\n                      <motion.div\n                        animate={{ rotate: 360 }}\n                        transition={{ duration: 3, repeat: Infinity, ease: \"linear\" }}\n                      >\n                        <Sparkles className=\"w-4 h-4\" />\n                      </motion.div>\n                      <span className=\"text-xs font-black tracking-widest\">PREMIUM</span>\n                      {/* Glow effect */}\n                      <div className=\"absolute inset-0 bg-yellow-400/30 rounded-full blur-md -z-10\" />\n                    </div>\n                  </motion.div>\n                )}\n                \n                {/* Enhanced Category Badge */}\n                <div className=\"absolute top-4 right-4\">\n                  <motion.div\n                    whileHover={{ scale: 1.1 }}\n                    transition={{ type: \"spring\", stiffness: 300 }}\n                  >\n                    <Badge className={`backdrop-blur-md shadow-lg border transition-all duration-300 ${\n                      isPremium \n                        ? 'bg-white/95 text-amber-800 border-yellow-200/60 hover:bg-yellow-50' \n                        : 'bg-white/95 text-gray-800 border-white/30 hover:bg-white'\n                    }`}>\n                      <span className=\"text-sm mr-1\">\n                        {activityCategories[activity.category as keyof typeof activityCategories]?.icon || 'üéØ'}\n                      </span>\n                      <span className=\"font-semibold\">\n                        {activityCategories[activity.category as keyof typeof activityCategories]?.label || 'Atividade'}\n                      </span>\n                    </Badge>\n                  </motion.div>\n                </div>\n                \n                {/* Enhanced Price Badge */}\n                <div className=\"absolute bottom-4 left-4\">\n                  <motion.div\n                    whileHover={{ scale: 1.05 }}\n                    className={`backdrop-blur-md px-4 py-2.5 rounded-xl shadow-xl border transition-all duration-300 ${\n                      isPremium \n                        ? 'bg-gradient-to-r from-yellow-50/95 to-amber-50/95 border-yellow-300/60 shadow-yellow-500/30' \n                        : 'bg-white/95 border-white/40 shadow-gray-500/30'\n                    }`}>\n                    <span className={`text-lg font-black ${\n                      isPremium ? 'text-amber-900 bg-gradient-to-r from-yellow-700 to-orange-700 bg-clip-text text-transparent' : 'text-gray-900'\n                    }`}>\n                      {(!activity.price || activity.price === 0) ? \"Gr√°tis\" : formatBrazilianCurrency(Number(activity.price))}\n                    </span>\n                  </motion.div>\n                </div>\n\n                {/* Enhanced Rating Badge */}\n                <div className=\"absolute bottom-4 right-4\">\n                  <motion.div\n                    whileHover={{ scale: 1.05 }}\n                    className={`backdrop-blur-md px-3 py-2 rounded-xl shadow-xl flex items-center gap-2 border transition-all duration-300 ${\n                      isPremium \n                        ? 'bg-gradient-to-r from-yellow-400/95 to-amber-500/95 border-yellow-300/60 shadow-yellow-500/40' \n                        : 'bg-yellow-400/95 border-yellow-300/40 shadow-yellow-500/30'\n                    }`}>\n                    <motion.div\n                      animate={{ rotate: [0, 15, -15, 0] }}\n                      transition={{ duration: 2, repeat: Infinity }}\n                    >\n                      <Star className=\"w-4 h-4 fill-white text-white drop-shadow-sm\" />\n                    </motion.div>\n                    <span className=\"text-sm font-black text-white drop-shadow-sm\">\n                      {formatBrazilianNumber(Number(activity.average_rating || activity.averageRating || activity.rating || 0)).replace(',00', ',0')}\n                    </span>\n                  </motion.div>\n                </div>\n              </div>\n              \n              <CardContent className=\"p-4 relative\">\n                <div className=\"space-y-3\">\n                  <div>\n                    <motion.h3 \n                      className={`font-black text-base leading-tight line-clamp-2 transition-all duration-300 ${\n                        isPremium \n                          ? 'text-gray-900 group-hover:text-amber-700' \n                          : 'text-gray-900 group-hover:text-blue-600'\n                      }`}\n                      whileHover={{ scale: 1.02 }}\n                    >\n                      {activity.title}\n                    </motion.h3>\n                    <p className=\"text-xs text-gray-600 line-clamp-2 mt-1.5 leading-relaxed font-medium\">\n                      {activity.description}\n                    </p>\n                  </div>\n                  \n                  {/* Enhanced Info Row */}\n                  <div className=\"flex items-center justify-between text-xs\">\n                    <motion.div \n                      className={`flex items-center gap-1.5 px-2 py-1 rounded-md transition-colors ${\n                        isPremium ? 'bg-yellow-50 text-amber-700' : 'bg-gray-50 text-gray-700'\n                      }`}\n                      whileHover={{ scale: 1.05 }}\n                    >\n                      <MapPin className=\"w-3 h-3\" />\n                      <span className=\"font-semibold truncate max-w-[100px]\">{activity.location}</span>\n                    </motion.div>\n                    <motion.div \n                      className={`flex items-center gap-1.5 px-2 py-1 rounded-md transition-colors ${\n                        isPremium ? 'bg-orange-50 text-orange-700' : 'bg-blue-50 text-blue-700'\n                      }`}\n                      whileHover={{ scale: 1.05 }}\n                    >\n                      <Clock className=\"w-3 h-3\" />\n                      <span className=\"font-semibold\">{activity.duration}h</span>\n                    </motion.div>\n                  </div>\n                  \n                  {/* Enhanced Footer */}\n                  <div className=\"flex items-center justify-between pt-2 border-t border-gray-100\">\n                    <div className=\"flex items-center gap-1\">\n                      {renderStars(Number(activity.average_rating || activity.averageRating || activity.rating || 0))}\n                      <span className=\"text-xs text-gray-500 ml-1 font-medium\">\n                        ({activity.total_ratings || activity.totalRatings || activity.review_count || activity.reviewCount || 0})\n                      </span>\n                    </div>\n                    <motion.div whileHover={{ scale: 1.1 }} whileTap={{ scale: 0.95 }}>\n                      <Badge \n                        variant=\"outline\" \n                        className={`text-xs font-medium border px-1.5 py-0.5 transition-all duration-300 ${\n                          activity.difficulty === 'easy' ? 'border-green-300 text-green-800 bg-green-50 hover:bg-green-100' :\n                          activity.difficulty === 'moderate' ? 'border-yellow-300 text-yellow-800 bg-yellow-50 hover:bg-yellow-100' :\n                          activity.difficulty === 'challenging' ? 'border-red-300 text-red-800 bg-red-50 hover:bg-red-100' :\n                          'border-gray-300 text-gray-800 bg-gray-50 hover:bg-gray-100'\n                        }`}\n                      >\n                        {DIFFICULTY_LEVELS.find(d => d.value === activity.difficulty)?.label || 'N/A'}\n                      </Badge>\n                    </motion.div>\n                  </div>\n                </div>\n              </CardContent>\n            </div>\n          </Card>\n        </Link>\n      </motion.div>\n    );\n  };\n\n  // Carousel Component for Popular Activities\n  const PopularActivitiesCarousel = ({ activities }: { activities: Activity[] }) => {\n    const [emblaRef, emblaApi] = useEmblaCarousel({\n      align: 'start',\n      dragFree: true,\n      containScroll: 'trimSnaps',\n    });\n\n    const scrollPrev = useCallback(() => {\n      if (emblaApi) emblaApi.scrollPrev();\n    }, [emblaApi]);\n\n    const scrollNext = useCallback(() => {\n      if (emblaApi) emblaApi.scrollNext();\n    }, [emblaApi]);\n\n    return (\n      <div className=\"relative\">\n        <div className=\"overflow-hidden\" ref={emblaRef}>\n          <div className=\"flex\">\n            {activities.map((activity, index) => (\n              <PremiumActivityCard key={activity.id} activity={activity} index={index} />\n            ))}\n          </div>\n        </div>\n        \n        {/* Enhanced Navigation Buttons */}\n        <div className=\"absolute -top-16 right-0 flex gap-3\">\n          <motion.div whileHover={{ scale: 1.1 }} whileTap={{ scale: 0.95 }}>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={scrollPrev}\n              className=\"w-12 h-12 rounded-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 border-0 shadow-lg hover:shadow-xl transition-all duration-300 group\"\n            >\n              <ChevronLeft className=\"w-5 h-5 text-white group-hover:scale-110 transition-transform duration-200\" />\n            </Button>\n          </motion.div>\n          <motion.div whileHover={{ scale: 1.1 }} whileTap={{ scale: 0.95 }}>\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={scrollNext}\n              className=\"w-12 h-12 rounded-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 border-0 shadow-lg hover:shadow-xl transition-all duration-300 group\"\n            >\n              <ChevronRight className=\"w-5 h-5 text-white group-hover:scale-110 transition-transform duration-200\" />\n            </Button>\n          </motion.div>\n        </div>\n      </div>\n    );\n  };\n\n  const ActivityCard = ({ activity, index, isPopular = false }: { activity: Activity; index: number; isPopular?: boolean }) => (\n    <motion.div\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ delay: index * 0.1 }}\n      whileHover={{ scale: 1.02 }}\n      className=\"group\"\n    >\n      <Link to={`/activities/${activity.id}`}>\n        <Card className=\"h-full overflow-hidden border-0 shadow-md hover:shadow-xl transition-all duration-300 group-hover:border-blue-200 bg-white\">\n          <div className=\"relative\">\n            <img\n              src={activity.imageUrl || activity.cover_image || `https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=400&h=250&fit=crop&crop=center`}\n              alt={activity.title}\n              className=\"w-full h-56 object-cover group-hover:scale-105 transition-transform duration-300\"\n              onError={(e) => {\n                e.currentTarget.src = `https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=400&h=250&fit=crop&crop=center`;\n              }}\n            />\n            <div className=\"absolute inset-0 bg-gradient-to-t from-black/50 via-black/20 to-transparent\" />\n            \n            {/* Category Badge */}\n            <div className=\"absolute top-4 right-4 flex flex-col gap-2\">\n              {/* Premium Quality Badge for popular + highly rated */}\n              {isPopular && isTopQuality(activity) && (\n                <Badge className=\"bg-gradient-to-r from-yellow-400 to-orange-500 text-white shadow-lg border-0 font-bold\">\n                  ‚≠ê Premium\n                </Badge>\n              )}\n              <Badge className=\"bg-white/95 text-gray-800 hover:bg-white backdrop-blur-sm shadow-lg\">\n                {activityCategories[activity.category as keyof typeof activityCategories]?.icon || 'üéØ'} {activityCategories[activity.category as keyof typeof activityCategories]?.label || 'Atividade'}\n              </Badge>\n            </div>\n            \n            {/* Price Badge */}\n            <div className=\"absolute bottom-4 left-4\">\n              <div className=\"bg-white/95 backdrop-blur-sm px-4 py-2 rounded-lg shadow-lg\">\n                <span className=\"text-xl font-bold text-gray-900\">\n                  {(!activity.price || activity.price === 0) ? \"Gr√°tis\" : `R$ ${Number(activity.price).toLocaleString('pt-BR')}`}\n                </span>\n              </div>\n            </div>\n\n            {/* Rating Badge */}\n            <div className=\"absolute bottom-4 right-4\">\n              <div className=\"bg-yellow-400/95 backdrop-blur-sm px-3 py-1 rounded-lg shadow-lg flex items-center gap-1\">\n                <Star className=\"w-4 h-4 fill-white text-white\" />\n                <span className=\"text-sm font-bold text-white\">\n                  {Number(activity.average_rating || activity.averageRating || activity.rating || 0).toFixed(1)}\n                </span>\n              </div>\n            </div>\n          </div>\n          \n          <CardContent className=\"p-6\">\n            <div className=\"space-y-4\">\n              <div>\n                <h3 className=\"font-bold text-lg text-gray-900 group-hover:text-blue-600 transition-colors line-clamp-2 leading-tight\">\n                  {activity.title}\n                </h3>\n                <p className=\"text-sm text-gray-600 line-clamp-2 mt-2 leading-relaxed\">\n                  {activity.description}\n                </p>\n              </div>\n              \n              <div className=\"flex items-center justify-between py-2\">\n                <div className=\"flex items-center gap-1\">\n                  {renderStars(Number(activity.average_rating || activity.averageRating || activity.rating || 0))}\n                  <span className=\"text-sm text-gray-600 ml-2 font-medium\">\n                    ({activity.total_ratings || activity.totalRatings || activity.review_count || activity.reviewCount || 0} avalia√ß√µes)\n                  </span>\n                </div>\n              </div>\n              \n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\n                <div className=\"flex items-center gap-2 text-gray-600\">\n                  <div className=\"w-8 h-8 bg-blue-50 rounded-lg flex items-center justify-center\">\n                    <MapPin className=\"w-4 h-4 text-blue-600\" />\n                  </div>\n                  <span className=\"font-medium truncate\">{activity.location}</span>\n                </div>\n                <div className=\"flex items-center gap-2 text-gray-600\">\n                  <div className=\"w-8 h-8 bg-green-50 rounded-lg flex items-center justify-center\">\n                    <Clock className=\"w-4 h-4 text-green-600\" />\n                  </div>\n                  <span className=\"font-medium\">{activity.duration} horas</span>\n                </div>\n              </div>\n              \n              <div className=\"flex items-center justify-between pt-2 border-t border-gray-100\">\n                <div className=\"flex items-center gap-2 text-gray-600\">\n                  <Users className=\"w-4 h-4\" />\n                  <span className=\"text-sm font-medium\">\n                    {activity.min_participants || activity.minParticipants || 1}-{activity.max_participants || activity.maxParticipants || 20} pessoas\n                  </span>\n                </div>\n                <Badge \n                  variant=\"outline\" \n                  className={`text-xs font-medium ${\n                    activity.difficulty === 'easy' ? 'border-green-200 text-green-700 bg-green-50' :\n                    activity.difficulty === 'moderate' ? 'border-yellow-200 text-yellow-700 bg-yellow-50' :\n                    activity.difficulty === 'challenging' ? 'border-red-200 text-red-700 bg-red-50' :\n                    'border-gray-200 text-gray-700 bg-gray-50'\n                  }`}\n                >\n                  {DIFFICULTY_LEVELS.find(d => d.value === activity.difficulty)?.label || 'N/A'}\n                </Badge>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </Link>\n    </motion.div>\n  );\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-gray-50 to-white\">\n      {/* Hero Section */}\n      <div className=\"bg-gradient-to-r from-blue-600 to-indigo-700 text-white\">\n        <div className=\"max-w-7xl mx-auto px-4 py-12\">\n          <div className=\"text-center space-y-4\">\n            <motion.h1 \n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              className=\"text-4xl font-bold\"\n            >\n              Descubra Experi√™ncias Incr√≠veis\n            </motion.h1>\n            <motion.p \n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.1 }}\n              className=\"text-xl text-blue-100 max-w-2xl mx-auto\"\n            >\n              Encontre as melhores atividades e experi√™ncias para suas viagens. \n              Aventuras inesquec√≠veis est√£o esperando por voc√™.\n            </motion.p>\n          </div>\n          \n          {/* Search Bar */}\n          <motion.div \n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"mt-8 max-w-2xl mx-auto\"\n          >\n            <div className=\"relative\">\n              <Search className=\"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n              <Input\n                type=\"text\"\n                placeholder=\"Buscar atividades, experi√™ncias ou destinos...\"\n                value={searchInput}\n                onChange={(e) => setSearchInput(e.target.value)}\n                className=\"pl-12 pr-4 py-4 text-lg bg-white/95 backdrop-blur-sm border-0 shadow-lg text-black\"\n              />\n            </div>\n          </motion.div>\n        </div>\n      </div>\n\n      {/* View Mode Toggle */}\n      <div className=\"bg-white border-b\">\n        <div className=\"max-w-7xl mx-auto px-4 py-4\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"flex bg-gray-100 rounded-lg p-1\">\n              <Button\n                variant={viewMode === 'hierarchy' ? 'default' : 'ghost'}\n                size=\"sm\"\n                onClick={() => setViewMode('hierarchy')}\n                className={`px-4 ${viewMode === 'hierarchy' ? 'bg-blue-600 text-white' : 'text-gray-600'}`}\n              >\n                <MapPin className=\"w-4 h-4 mr-2\" />\n                Por Destino\n              </Button>\n              <Button\n                variant={viewMode === 'list' ? 'default' : 'ghost'}\n                size=\"sm\"\n                onClick={() => setViewMode('list')}\n                className={`px-4 ${viewMode === 'list' ? 'bg-blue-600 text-white' : 'text-gray-600'}`}\n              >\n                <List className=\"w-4 h-4 mr-2\" />\n                Lista Completa\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {viewMode === 'hierarchy' ? (\n        // Hierarchical Navigation\n        <div className=\"bg-gray-50\">\n          <div className=\"max-w-7xl mx-auto px-4 py-8\">\n            <Breadcrumb />\n            \n            {!selectedCountryType && hierarchy && (\n              // Country Type Selection\n              <motion.div \n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                className=\"space-y-6\"\n              >\n                <div className=\"text-center space-y-2\">\n                  <h2 className=\"text-3xl font-bold text-gray-900\">Explore Atividades por Destino</h2>\n                  <p className=\"text-gray-600\">Escolha entre experi√™ncias nacionais, internacionais ou cruzeiros</p>\n                </div>\n                \n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                  {Object.entries(hierarchy).map(([countryType, regions]) => {\n                    const totalCount = Object.values(regions).reduce((acc: number, destinations: any) => \n                      acc + Object.values(destinations).reduce((cityAcc: number, count: any) => cityAcc + Number(count), 0), 0\n                    );\n                    \n                    return (\n                      <motion.div\n                        key={countryType}\n                        whileHover={{ scale: 1.02 }}\n                        whileTap={{ scale: 0.98 }}\n                        onClick={() => setSelectedCountryType(countryType)}\n                        className=\"cursor-pointer\"\n                      >\n                        <Card className=\"h-full hover:shadow-lg transition-all duration-200 border-2 hover:border-blue-300\">\n                          <CardContent className=\"p-6 text-center space-y-4\">\n                            <div className=\"w-16 h-16 mx-auto bg-gradient-to-r from-blue-500 to-indigo-600 rounded-2xl flex items-center justify-center text-white\">\n                              {getCountryTypeIcon(countryType)}\n                            </div>\n                            <div>\n                              <h3 className=\"text-xl font-bold text-gray-900\">{getCountryTypeDisplayName(countryType)}</h3>\n                              <p className=\"text-gray-600\">{totalCount} atividades dispon√≠veis</p>\n                            </div>\n                            <ChevronRight className=\"w-5 h-5 mx-auto text-gray-400\" />\n                          </CardContent>\n                        </Card>\n                      </motion.div>\n                    );\n                  })}\n                </div>\n              </motion.div>\n            )}\n\n            {selectedCountryType && !selectedRegion && hierarchy && (\n              <motion.div \n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                className=\"space-y-6\"\n              >\n                <div className=\"text-center space-y-2\">\n                  <h2 className=\"text-3xl font-bold text-gray-900\">Escolha a Regi√£o</h2>\n                  <p className=\"text-gray-600\">Selecione a regi√£o que deseja explorar</p>\n                </div>\n                \n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {Object.entries(hierarchy[selectedCountryType] || {}).map(([region, destinations]) => {\n                    const totalCount = Object.values(destinations).reduce((acc: number, count: any) => acc + Number(count), 0);\n                    \n                    return (\n                      <motion.div\n                        key={region}\n                        whileHover={{ scale: 1.02 }}\n                        whileTap={{ scale: 0.98 }}\n                        onClick={() => setSelectedRegion(region)}\n                        className=\"cursor-pointer\"\n                      >\n                        <Card className=\"hover:shadow-md transition-all duration-200 hover:border-blue-300\">\n                          <CardContent className=\"p-4 flex items-center justify-between\">\n                            <div>\n                              <h4 className=\"font-semibold text-gray-900\">{region}</h4>\n                              <p className=\"text-sm text-gray-600\">{totalCount} atividades</p>\n                            </div>\n                            <ChevronRight className=\"w-4 h-4 text-gray-400\" />\n                          </CardContent>\n                        </Card>\n                      </motion.div>\n                    );\n                  })}\n                </div>\n              </motion.div>\n            )}\n\n            {selectedCountryType && selectedRegion && !selectedCity && hierarchy && (\n              <motion.div \n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                className=\"space-y-6\"\n              >\n                <div className=\"text-center space-y-2\">\n                  <h2 className=\"text-3xl font-bold text-gray-900\">Escolha a Cidade</h2>\n                  <p className=\"text-gray-600\">Selecione a cidade para ver as atividades dispon√≠veis</p>\n                </div>\n                \n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n                  {Object.entries(hierarchy[selectedCountryType]?.[selectedRegion] || {}).map(([city, count]) => (\n                    <motion.div\n                      key={city}\n                      whileHover={{ scale: 1.02 }}\n                      whileTap={{ scale: 0.98 }}\n                      onClick={() => setSelectedCity(city)}\n                      className=\"cursor-pointer\"\n                    >\n                      <Card className=\"hover:shadow-md transition-all duration-200 hover:border-blue-300\">\n                        <CardContent className=\"p-4 text-center\">\n                          <h5 className=\"font-semibold text-gray-900\">{city}</h5>\n                          <p className=\"text-sm text-gray-600\">{count} atividades</p>\n                        </CardContent>\n                      </Card>\n                    </motion.div>\n                  ))}\n                </div>\n              </motion.div>\n            )}\n\n            {selectedCity && locationActivities && (\n              <motion.div \n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                className=\"space-y-6\"\n              >\n                <div className=\"flex items-center justify-between\">\n                  <div>\n                    <h2 className=\"text-3xl font-bold text-gray-900\">Atividades em {selectedCity}</h2>\n                    <p className=\"text-gray-600\">{locationActivities.length} atividades encontradas</p>\n                  </div>\n                  <div className=\"flex gap-2\">\n                    <Button\n                      variant={displayMode === 'grid' ? 'default' : 'outline'}\n                      size=\"sm\"\n                      onClick={() => setDisplayMode('grid')}\n                    >\n                      <Grid className=\"w-4 h-4\" />\n                    </Button>\n                    <Button\n                      variant={displayMode === 'list' ? 'default' : 'outline'}\n                      size=\"sm\"\n                      onClick={() => setDisplayMode('list')}\n                    >\n                      <List className=\"w-4 h-4\" />\n                    </Button>\n                  </div>\n                </div>\n                \n                <div className={displayMode === 'grid' ? 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6' : 'space-y-4'}>\n                  {locationActivities.map((activity, index) => (\n                    <ActivityCard key={activity.id} activity={activity} index={index} />\n                  ))}\n                </div>\n              </motion.div>\n            )}\n          </div>\n        </div>\n      ) : (\n        <div className=\"bg-gray-50 border-b\">\n          <div className=\"max-w-7xl mx-auto px-4 py-8 space-y-12\">\n          {/* Personalized Suggestions (only for authenticated users) */}\n          {user && personalizedActivities && personalizedActivities.length > 0 && (\n            <motion.div \n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              className=\"space-y-6\"\n            >\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center\">\n                  <Sparkles className=\"w-5 h-5 text-white\" />\n                </div>\n                <div>\n                  <h2 className=\"text-2xl font-bold text-gray-900\">Sugest√µes Para Voc√™</h2>\n                  <p className=\"text-gray-600\">Baseado em suas pr√≥ximas viagens</p>\n                </div>\n                <Badge variant=\"secondary\" className=\"bg-blue-100 text-blue-800 ml-auto\">\n                  Personalizado\n                </Badge>\n              </div>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {personalizedActivities.slice(0, 6).map((activity, index) => (\n                  <ActivityCard key={activity.id} activity={activity} index={index} />\n                ))}\n              </div>\n            </motion.div>\n          )}\n\n          {/* Popular Activities */}\n          {popularActivities && popularActivities.length > 0 && (\n            <motion.div \n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.1 }}\n              className=\"space-y-6\"\n            >\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-8 h-8 bg-gradient-to-r from-orange-500 to-red-600 rounded-lg flex items-center justify-center\">\n                  <TrendingUp className=\"w-5 h-5 text-white\" />\n                </div>\n                <div>\n                  <h2 className=\"text-2xl font-bold text-gray-900\">Mais Populares</h2>\n                  <p className=\"text-gray-600\">As experi√™ncias que todo mundo est√° escolhendo ‚Ä¢ Premium = Popular + 4.5‚≠ê</p>\n                </div>\n                <Badge variant=\"secondary\" className=\"bg-orange-100 text-orange-800 ml-auto\">\n                  Trending\n                </Badge>\n              </div>\n              \n              <PopularActivitiesCarousel activities={popularActivities.slice(0, 12)} />\n            </motion.div>\n          )}\n\n\n        </div>\n      </div>\n      )}\n\n      {/* Main Content */}\n      <div className=\"max-w-7xl mx-auto px-4 py-8\">\n        <div className=\"flex gap-8\">\n          {/* Desktop Sidebar */}\n          <div className=\"hidden lg:block w-80 flex-shrink-0\">\n            <div className=\"sticky top-4\">\n              <Card className=\"p-6\">\n                <div className=\"flex items-center justify-between mb-6\">\n                  <h2 className=\"text-lg font-semibold text-gray-900\">Filtros</h2>\n                  {activeFiltersCount > 0 && (\n                    <Badge variant=\"secondary\">{activeFiltersCount}</Badge>\n                  )}\n                </div>\n                <FilterSidebar />\n              </Card>\n            </div>\n          </div>\n\n          {/* Main Content */}\n          <div className=\"flex-1\">\n            {/* Toolbar */}\n            <div className=\"flex items-center justify-between mb-6\">\n              <div className=\"flex items-center gap-4\">\n                {/* Mobile Filter Button */}\n                <Sheet open={showFilters} onOpenChange={setShowFilters}>\n                  <SheetTrigger asChild>\n                    <Button variant=\"outline\" className=\"lg:hidden\">\n                      <SlidersHorizontal className=\"w-4 h-4 mr-2\" />\n                      Filtros\n                      {activeFiltersCount > 0 && (\n                        <Badge variant=\"secondary\" className=\"ml-2\">\n                          {activeFiltersCount}\n                        </Badge>\n                      )}\n                    </Button>\n                  </SheetTrigger>\n                  <SheetContent side=\"left\" className=\"w-80 sm:w-96\">\n                    <SheetHeader>\n                      <SheetTitle>Filtros</SheetTitle>\n                      <SheetDescription>\n                        Refine sua busca para encontrar a experi√™ncia perfeita\n                      </SheetDescription>\n                    </SheetHeader>\n                    <div className=\"mt-6\">\n                      <FilterSidebar />\n                    </div>\n                  </SheetContent>\n                </Sheet>\n\n                <div className=\"text-gray-600\">\n                  {isLoading ? (\n                    \"Carregando...\"\n                  ) : (\n                    `${filteredActivities?.length || 0} atividades encontradas`\n                  )}\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-3\">\n                {/* Sort */}\n                <Select value={filters.sortBy} onValueChange={(value) => updateFilter(\"sortBy\", value)}>\n                  <SelectTrigger className=\"w-48\">\n                    <ArrowUpDown className=\"w-4 h-4 mr-2\" />\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {SORT_OPTIONS.map((option) => (\n                      <SelectItem key={option.value} value={option.value}>\n                        {option.label}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n\n                {/* View Mode */}\n                <div className=\"flex border rounded-lg p-1\">\n                  <Button\n                    variant={viewMode === \"grid\" ? \"default\" : \"ghost\"}\n                    size=\"sm\"\n                    onClick={() => setViewMode(\"grid\")}\n                  >\n                    <Grid className=\"w-4 h-4\" />\n                  </Button>\n                  <Button\n                    variant={viewMode === \"list\" ? \"default\" : \"ghost\"}\n                    size=\"sm\"\n                    onClick={() => setViewMode(\"list\")}\n                  >\n                    <List className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            </div>\n\n            {/* Section Header for Filtered Activities */}\n            {!isLoading && filteredActivities && filteredActivities.length > 0 && (\n              <motion.div \n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                className=\"flex items-center gap-3 mb-8\"\n              >\n                <div className=\"w-8 h-8 bg-gradient-to-r from-gray-600 to-gray-800 rounded-lg flex items-center justify-center\">\n                  <Search className=\"w-5 h-5 text-white\" />\n                </div>\n                <div>\n                  <h2 className=\"text-2xl font-bold text-gray-900\">Todas as Atividades</h2>\n                  <p className=\"text-gray-600\">Explore nossa cole√ß√£o completa de experi√™ncias</p>\n                </div>\n              </motion.div>\n            )}\n\n            {/* Activities Grid */}\n            {isLoading ? (\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                {Array.from({ length: 6 }).map((_, i) => (\n                  <Card key={i} className=\"overflow-hidden\">\n                    <div className=\"w-full h-48 bg-gray-200 animate-pulse\" />\n                    <CardContent className=\"p-4 space-y-3\">\n                      <div className=\"h-4 bg-gray-200 rounded animate-pulse\" />\n                      <div className=\"h-3 bg-gray-200 rounded w-3/4 animate-pulse\" />\n                      <div className=\"h-3 bg-gray-200 rounded w-1/2 animate-pulse\" />\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            ) : filteredActivities?.length === 0 ? (\n              <motion.div \n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                className=\"text-center py-16\"\n              >\n                <div className=\"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4\">\n                  <Search className=\"w-8 h-8 text-gray-400\" />\n                </div>\n                <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\n                  Nenhuma atividade encontrada\n                </h3>\n                <p className=\"text-gray-600 mb-6\">\n                  Tente ajustar seus filtros ou buscar por outros termos\n                </p>\n                <Button onClick={clearFilters} variant=\"outline\">\n                  <X className=\"w-4 h-4 mr-2\" />\n                  Limpar Filtros\n                </Button>\n              </motion.div>\n            ) : (\n              <div className={`grid gap-6 ${\n                viewMode === \"grid\" \n                  ? \"grid-cols-1 md:grid-cols-2 lg:grid-cols-3\" \n                  : \"grid-cols-1\"\n              }`}>\n                <AnimatePresence>\n                  {filteredActivities?.map((activity, index) => (\n                    <ActivityCard key={activity.id} activity={activity} index={index} />\n                  ))}\n                </AnimatePresence>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default ActivitiesPage;","size_bytes":63196},"client/src/pages/activity-detail-page.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useParams, Link } from \"wouter\";\nimport { \n  ArrowLeft, \n  Star, \n  MapPin, \n  Clock, \n  Users, \n  Heart,\n  Share2,\n  Calendar,\n  Shield,\n  Award,\n  MessageSquare,\n  Camera,\n  CheckCircle,\n  XCircle,\n  Phone,\n  Mail,\n  Globe,\n  MessageCircle,\n  Plane,\n  Package\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Avatar, AvatarImage, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { LoadingSpinner } from \"@/components/loading-spinner\";\nimport { ActivityBudgetProposals } from \"@/components/activity-budget-proposals\";\nimport { AddActivityToTrip } from \"@/components/add-activity-to-trip\";\nimport { ActivityReviews } from \"@/components/activity-reviews\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { motion } from \"framer-motion\";\nimport { format } from \"date-fns\";\nimport { ptBR } from \"date-fns/locale\";\nimport { activityCategories, insertActivityBookingSchema } from \"@shared/schema\";\nimport type { Activity, ActivityReview, ActivityBooking, InsertActivityBooking, ActivityBudgetProposal } from \"@shared/schema\";\nimport { formatBrazilianCurrency, formatBrazilianNumber, formatCurrencyByCode, sumValues, formatPriceRange } from \"@shared/utils\";\n\nexport default function ActivityDetailPage() {\n  const { id } = useParams<{ id: string }>();\n  const [selectedImageIndex, setSelectedImageIndex] = useState(0);\n  const [showBookingDialog, setShowBookingDialog] = useState(false);\n  const [showReviewDialog, setShowReviewDialog] = useState(false);\n  const [showAddToTripDialog, setShowAddToTripDialog] = useState(false);\n  const [selectedProposals, setSelectedProposals] = useState<ActivityBudgetProposal[]>([]);\n  const { toast } = useToast();\n  const { user } = useAuth();\n  const queryClient = useQueryClient();\n\n  // Helper function to safely parse JSON arrays\n  const parseJsonArray = (data: any): any[] => {\n    if (!data) return [];\n    if (Array.isArray(data)) return data;\n    try {\n      const parsed = typeof data === 'string' ? JSON.parse(data) : data;\n      return Array.isArray(parsed) ? parsed : [];\n    } catch {\n      return [];\n    }\n  };\n\n  const { data: activity, isLoading: activityLoading } = useQuery<Activity>({\n    queryKey: [`/api/activities/${id}`],\n    queryFn: async () => {\n      const response = await fetch(`/api/activities/${id}`);\n      if (!response.ok) throw new Error(\"Atividade n√£o encontrada\");\n      return response.json();\n    },\n  });\n\n  const { data: reviews, isLoading: reviewsLoading } = useQuery<(ActivityReview & { user: any })[]>({\n    queryKey: [`/api/activities/${id}/reviews`],\n    queryFn: async () => {\n      const response = await fetch(`/api/activities/${id}/reviews`);\n      if (!response.ok) throw new Error(\"Falha ao carregar avalia√ß√µes\");\n      return response.json();\n    },\n  });\n\n  const { data: proposals, isLoading: proposalsLoading } = useQuery<ActivityBudgetProposal[]>({\n    queryKey: [`/api/activities/${id}/proposals`],\n    queryFn: async () => {\n      const response = await fetch(`/api/activities/${id}/proposals`);\n      if (!response.ok) throw new Error(\"Erro ao buscar propostas\");\n      return response.json();\n    },\n    enabled: !!id,\n  });\n\n  // Buscar propostas j√° inclu√≠das nas viagens do usu√°rio\n  const { data: userTrips } = useQuery({\n    queryKey: ['/api/my-trips'],\n    queryFn: async () => {\n      const response = await fetch('/api/my-trips');\n      if (!response.ok) throw new Error(\"Erro ao buscar viagens\");\n      return response.json();\n    },\n    enabled: !!user,\n  });\n\n  // Extrair IDs das propostas j√° inclu√≠das nas viagens do usu√°rio\n  const includedProposalIds = userTrips ? \n    [...(userTrips.created || []), ...(userTrips.participating || [])].flatMap((trip: any) => {\n      const planned_activities = parseJsonArray(trip.planned_activities);\n      return planned_activities\n        .filter((activity: any) => activity.activityId === Number(id))\n        .flatMap((activity: any) => {\n          const proposals = parseJsonArray(activity.budgetProposals);\n          return proposals.map((proposal: any) => proposal.id);\n        });\n    }) : [];\n\n  const bookingForm = useForm<InsertActivityBooking>({\n    resolver: zodResolver(insertActivityBookingSchema),\n    defaultValues: {\n      activityId: Number(id),\n      participants: 1,\n      contactName: \"\",\n      contactEmail: \"\",\n      contactPhone: \"\",\n      specialRequests: \"\",\n      bookingDate: new Date(),\n      totalAmount: 0,\n    },\n  });\n\n  const bookingMutation = useMutation({\n    mutationFn: async (data: InsertActivityBooking) => {\n      const response = await fetch(`/api/activities/${id}/bookings`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(data),\n      });\n      if (!response.ok) throw new Error(\"Falha ao fazer reserva\");\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"Reserva realizada com sucesso!\" });\n      setShowBookingDialog(false);\n      bookingForm.reset();\n    },\n    onError: (error: Error) => {\n      toast({ title: \"Erro ao fazer reserva\", description: error.message, variant: \"destructive\" });\n    },\n  });\n\n  const renderStars = (rating: number) => {\n    return Array.from({ length: 5 }, (_, i) => (\n      <Star\n        key={i}\n        className={`w-4 h-4 ${\n          i < Math.floor(rating) \n            ? \"fill-yellow-400 text-yellow-400\" \n            : \"text-gray-300\"\n        }`}\n      />\n    ));\n  };\n\n  const formatPrice = () => {\n    // Se n√£o houver propostas, a atividade √© gr√°tis\n    if (!proposals || proposals.length === 0) {\n      return \"Gr√°tis\";\n    }\n\n    // Se houver propostas selecionadas, mostrar o total\n    if (selectedProposals.length > 0) {\n      const total = selectedProposals.reduce((sum, proposal) => {\n        return sum + (Number(proposal.amount) || 0);\n      }, 0);\n      \n      return formatBrazilianCurrency(total);\n    }\n\n    // Se houver propostas mas nenhuma selecionada, mostrar faixa de pre√ßo\n    const amounts = proposals.map(p => Number(p.amount) || 0);\n    const minPrice = Math.min(...amounts);\n    const maxPrice = Math.max(...amounts);\n    \n    if (minPrice === maxPrice) {\n      return formatBrazilianCurrency(minPrice);\n    }\n    \n    return `${formatBrazilianCurrency(minPrice)} - ${formatBrazilianCurrency(maxPrice)}`;\n  };\n\n  const calculateTotalPrice = () => {\n    // Se houver propostas selecionadas, usar o total delas\n    if (selectedProposals.length > 0) {\n      const participants = bookingForm.watch(\"participants\") || 1;\n      return selectedProposals.reduce((total, proposal) => {\n        const amount = Number(proposal.amount) || 0;\n        return total + (proposal.priceType === \"per_person\" ? amount * participants : amount);\n      }, 0);\n    }\n    \n    // Se n√£o houver propostas ou nenhuma selecionada, retornar 0 (gr√°tis)\n    return 0;\n  };\n\n  // Helper function to safely parse JSON arrays for proposals\n  const safeParseArray = (data: any) => {\n    if (Array.isArray(data)) return data;\n    if (typeof data === 'string') {\n      try {\n        let parsed = JSON.parse(data);\n        if (typeof parsed === 'string') {\n          parsed = JSON.parse(parsed);\n        }\n        return Array.isArray(parsed) ? parsed : [];\n      } catch {\n        return [];\n      }\n    }\n    return [];\n  };\n\n  // Handle proposal selection for adding to trip\n  const handleProposalSelect = (proposal: ActivityBudgetProposal, selected: boolean) => {\n    if (selected) {\n      setSelectedProposals(prev => [...prev, proposal]);\n    } else {\n      setSelectedProposals(prev => prev.filter(p => p.id !== proposal.id));\n    }\n  };\n\n  if (activityLoading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <LoadingSpinner variant=\"travel\" />\n      </div>\n    );\n  }\n\n  if (!activity) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">Atividade n√£o encontrada</h2>\n          <Link to=\"/activities\">\n            <Button>Voltar para atividades</Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white shadow-sm border-b\">\n        <div className=\"max-w-7xl mx-auto px-4 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <Link to=\"/activities\">\n              <Button variant=\"ghost\" size=\"sm\">\n                <ArrowLeft className=\"w-4 h-4 mr-2\" />\n                Voltar\n              </Button>\n            </Link>\n            \n            <div className=\"flex items-center gap-2\">\n              <Button variant=\"outline\" size=\"sm\">\n                <Share2 className=\"w-4 h-4 mr-2\" />\n                Compartilhar\n              </Button>\n              <Button variant=\"outline\" size=\"sm\">\n                <Heart className=\"w-4 h-4 mr-2\" />\n                Favoritar\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-4 py-6\">\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          {/* Main Content */}\n          <div className=\"lg:col-span-2\">\n            {/* Image Gallery */}\n            <div className=\"mb-6\">\n              <div className=\"relative rounded-lg overflow-hidden\">\n                {(() => {\n                  const images = parseJsonArray(activity.images);\n                  return (\n                    <img\n                      src={images[selectedImageIndex] || activity.cover_image}\n                      alt={activity.title}\n                      className=\"w-full h-96 object-cover\"\n                    />\n                  );\n                })()}\n                \n                {(() => {\n                  const images = parseJsonArray(activity.images);\n                  return images && images.length > 1 && (\n                    <div className=\"absolute bottom-4 left-4 right-4\">\n                      <div className=\"flex gap-2 overflow-x-auto\">\n                        {images.map((image: string, index: number) => (\n                          <button\n                            key={index}\n                            onClick={() => setSelectedImageIndex(index)}\n                            className={`flex-shrink-0 w-16 h-16 rounded-lg overflow-hidden border-2 transition-colors ${\n                              index === selectedImageIndex \n                                ? \"border-white\" \n                                : \"border-white/50\"\n                            }`}\n                          >\n                            <img\n                              src={image}\n                              alt={`${activity.title} ${index + 1}`}\n                              className=\"w-full h-full object-cover\"\n                            />\n                          </button>\n                        ))}\n                      </div>\n                    </div>\n                  );\n                })()}\n              </div>\n            </div>\n\n            {/* Activity Info */}\n            <div className=\"bg-white rounded-lg border p-6 mb-6\">\n              <div className=\"flex items-start justify-between mb-4\">\n                <div>\n                  <Badge variant=\"secondary\" className=\"mb-2\">\n                    {activityCategories[activity.category as keyof typeof activityCategories]?.label}\n                  </Badge>\n                  <h1 className=\"text-2xl font-bold text-gray-900 mb-2\">\n                    {activity.title}\n                  </h1>\n                  <div className=\"flex items-center gap-4 text-sm text-gray-600\">\n                    <div className=\"flex items-center gap-1\">\n                      <MapPin className=\"w-4 h-4\" />\n                      {activity.location}\n                    </div>\n                    {activity.duration && (\n                      <div className=\"flex items-center gap-1\">\n                        <Clock className=\"w-4 h-4\" />\n                        {activity.duration}\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                <div className=\"flex items-center gap-2\">\n                  <div className=\"flex items-center gap-1\">\n                    {renderStars(Number(activity.averageRating))}\n                  </div>\n                  <span className=\"text-sm font-medium\">\n                    {formatBrazilianNumber(Number(activity.averageRating)).replace(',00', ',0')}\n                  </span>\n                  <span className=\"text-xs text-gray-500\">\n                    ({activity.totalRatings} avalia√ß√µes)\n                  </span>\n                </div>\n              </div>\n\n              <p className=\"text-gray-700 mb-6 leading-relaxed\">\n                {activity.description}\n              </p>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                {activity.difficultyLevel && (\n                  <div className=\"flex items-center gap-2\">\n                    <Award className=\"w-5 h-5 text-blue-600\" />\n                    <div>\n                      <div className=\"text-sm font-medium\">Dificuldade</div>\n                      <div className=\"text-xs text-gray-600\">\n                        {activity.difficultyLevel === \"easy\" && \"F√°cil\"}\n                        {activity.difficultyLevel === \"moderate\" && \"Moderado\"}\n                        {activity.difficultyLevel === \"challenging\" && \"Desafiador\"}\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {activity.minParticipants && (\n                  <div className=\"flex items-center gap-2\">\n                    <Users className=\"w-5 h-5 text-green-600\" />\n                    <div>\n                      <div className=\"text-sm font-medium\">Participantes</div>\n                      <div className=\"text-xs text-gray-600\">\n                        {activity.minParticipants} - {activity.max_participants || \"‚àû\"}\n                      </div>\n                    </div>\n                  </div>\n                )}\n\n                {(() => {\n                  const languages = parseJsonArray(activity.languages);\n                  return languages.length > 0 && (\n                    <div className=\"flex items-center gap-2\">\n                      <Globe className=\"w-5 h-5 text-purple-600\" />\n                      <div>\n                        <div className=\"text-sm font-medium\">Idiomas</div>\n                        <div className=\"text-xs text-gray-600\">\n                          {languages.join(\", \")}\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })()}\n              </div>\n            </div>\n\n            {/* Tabs */}\n            <Tabs defaultValue=\"details\" className=\"mb-6\">\n              <TabsList className=\"grid w-full grid-cols-4\">\n                <TabsTrigger value=\"details\">Detalhes</TabsTrigger>\n                <TabsTrigger value=\"proposals\">Or√ßamentos</TabsTrigger>\n                <TabsTrigger value=\"reviews\">Avalia√ß√µes</TabsTrigger>\n                <TabsTrigger value=\"location\">Localiza√ß√£o</TabsTrigger>\n              </TabsList>\n\n              <TabsContent value=\"details\" className=\"mt-6\">\n                <div className=\"bg-white rounded-lg border p-6\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-8\">\n                    {(() => {\n                      const inclusions = parseJsonArray(activity.inclusions);\n                      return inclusions.length > 0 && (\n                        <div>\n                          <h3 className=\"font-semibold text-gray-900 mb-3 flex items-center gap-2\">\n                            <CheckCircle className=\"w-5 h-5 text-green-600\" />\n                            Incluso\n                          </h3>\n                          <ul className=\"space-y-2\">\n                            {inclusions.map((item, index) => (\n                              <li key={index} className=\"flex items-center gap-2 text-sm\">\n                                <CheckCircle className=\"w-4 h-4 text-green-600 flex-shrink-0\" />\n                                {item}\n                              </li>\n                            ))}\n                          </ul>\n                        </div>\n                      );\n                    })()}\n\n                    {(() => {\n                      const exclusions = parseJsonArray(activity.exclusions);\n                      return exclusions.length > 0 && (\n                        <div>\n                          <h3 className=\"font-semibold text-gray-900 mb-3 flex items-center gap-2\">\n                            <XCircle className=\"w-5 h-5 text-red-600\" />\n                            N√£o incluso\n                          </h3>\n                          <ul className=\"space-y-2\">\n                            {exclusions.map((item, index) => (\n                              <li key={index} className=\"flex items-center gap-2 text-sm\">\n                                <XCircle className=\"w-4 h-4 text-red-600 flex-shrink-0\" />\n                                {item}\n                              </li>\n                            ))}\n                          </ul>\n                        </div>\n                      );\n                    })()}\n                  </div>\n\n                  {(() => {\n                    const requirements = parseJsonArray(activity.requirements);\n                    return requirements.length > 0 && (\n                      <div className=\"mt-6 pt-6 border-t\">\n                        <h3 className=\"font-semibold text-gray-900 mb-3 flex items-center gap-2\">\n                          <Shield className=\"w-5 h-5 text-blue-600\" />\n                          Requisitos e Restri√ß√µes\n                        </h3>\n                        <ul className=\"space-y-2\">\n                          {requirements.map((req, index) => (\n                            <li key={index} className=\"flex items-center gap-2 text-sm\">\n                              <Shield className=\"w-4 h-4 text-blue-600 flex-shrink-0\" />\n                              {req}\n                            </li>\n                          ))}\n                        </ul>\n                      </div>\n                    );\n                  })()}\n\n                  {activity.cancellationPolicy && (\n                    <div className=\"mt-6 pt-6 border-t\">\n                      <h3 className=\"font-semibold text-gray-900 mb-3\">\n                        Pol√≠tica de Cancelamento\n                      </h3>\n                      <p className=\"text-sm text-gray-600\">{activity.cancellationPolicy}</p>\n                    </div>\n                  )}\n                </div>\n              </TabsContent>\n\n              <TabsContent value=\"proposals\" className=\"mt-6\">\n                <ActivityBudgetProposals \n                  activityId={Number(id)} \n                  allowMultipleSelection={true}\n                  onProposalsChange={setSelectedProposals}\n                  includedProposalIds={includedProposalIds}\n                />\n              </TabsContent>\n\n              <TabsContent value=\"reviews\" className=\"mt-6\">\n                <ActivityReviews \n                  activityId={Number(id)} \n                  averageRating={activity.averageRating}\n                  totalRatings={activity.totalRatings}\n                />\n              </TabsContent>\n\n              <TabsContent value=\"location\" className=\"mt-6\">\n                <div className=\"bg-white rounded-lg border p-6\">\n                  <h3 className=\"font-semibold text-gray-900 mb-4\">Localiza√ß√£o</h3>\n                  <div className=\"flex items-center gap-2 mb-4\">\n                    <MapPin className=\"w-5 h-5 text-red-600\" />\n                    <span className=\"text-gray-700\">{activity.location}</span>\n                  </div>\n                  \n                  {/* Placeholder for map */}\n                  <div className=\"bg-gray-100 rounded-lg h-64 flex items-center justify-center\">\n                    <div className=\"text-center\">\n                      <MapPin className=\"w-12 h-12 text-gray-400 mx-auto mb-2\" />\n                      <p className=\"text-gray-600\">Mapa interativo em breve</p>\n                    </div>\n                  </div>\n                </div>\n              </TabsContent>\n            </Tabs>\n          </div>\n\n          {/* Sidebar */}\n          <div className=\"lg:col-span-1\">\n            <div className=\"bg-white rounded-lg border p-6 sticky top-6\">\n              <div className=\"text-center mb-6\">\n                <div className=\"text-3xl font-bold text-blue-600 mb-2\">\n                  {formatPrice()}\n                </div>\n                <div className=\"text-sm text-gray-600\">\n                  {selectedProposals.length > 0 \n                    ? `${selectedProposals.length} proposta${selectedProposals.length > 1 ? 's' : ''} selecionada${selectedProposals.length > 1 ? 's' : ''}`\n                    : proposals && proposals.length > 0 \n                    ? \"Selecione uma proposta na aba or√ßamentos\"\n                    : \"Atividade gratuita\"\n                  }\n                </div>\n              </div>\n\n              <Dialog open={showBookingDialog} onOpenChange={setShowBookingDialog}>\n                <DialogTrigger asChild>\n                  <Button className=\"w-full mb-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-md hover:shadow-lg transition-all duration-200\">\n                    <Calendar className=\"w-4 h-4 mr-2\" />\n                    Reservar Agora\n                  </Button>\n                </DialogTrigger>\n              </Dialog>\n\n              <Button \n                onClick={() => setShowAddToTripDialog(true)}\n                variant=\"outline\" \n                className=\"w-full mb-4 border-blue-300 text-blue-600 hover:bg-gradient-to-r hover:from-blue-50 hover:to-indigo-50 hover:border-blue-400 hover:text-blue-700 transition-all duration-200\"\n              >\n                <Plane className=\"w-4 h-4 mr-2\" />\n                Adicionar √† Viagem\n              </Button>\n\n\n\n              <Dialog open={showBookingDialog} onOpenChange={setShowBookingDialog}>\n                <DialogTrigger asChild>\n                  <div style={{ display: 'none' }}></div>\n                </DialogTrigger>\n                <DialogContent aria-describedby=\"booking-description\">\n                  <DialogHeader>\n                    <DialogTitle>Reservar Atividade</DialogTitle>\n                    <p id=\"booking-description\" className=\"text-sm text-gray-600\">\n                      Preencha os dados abaixo para fazer sua reserva\n                    </p>\n                  </DialogHeader>\n                  \n                  <Form {...bookingForm}>\n                    <form onSubmit={bookingForm.handleSubmit((data) => {\n                      bookingMutation.mutate({ ...data, totalAmount: calculateTotalPrice() });\n                    })} className=\"space-y-4\">\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <FormField\n                          control={bookingForm.control}\n                          name=\"participants\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>Participantes</FormLabel>\n                              <FormControl>\n                                <Input \n                                  type=\"number\" \n                                  min=\"1\" \n                                  max={activity.max_participants || 50}\n                                  {...field}\n                                  onChange={(e) => field.onChange(Number(e.target.value))}\n                                />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                        \n                        <FormField\n                          control={bookingForm.control}\n                          name=\"bookingDate\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>Data</FormLabel>\n                              <FormControl>\n                                <Input \n                                  type=\"date\" \n                                  {...field}\n                                  value={field.value instanceof Date ? field.value.toISOString().split('T')[0] : field.value}\n                                  onChange={(e) => field.onChange(new Date(e.target.value))}\n                                />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                      </div>\n\n                      <FormField\n                        control={bookingForm.control}\n                        name=\"contactName\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Nome completo</FormLabel>\n                            <FormControl>\n                              <Input placeholder=\"Seu nome completo\" {...field} />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <FormField\n                          control={bookingForm.control}\n                          name=\"contactEmail\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>Email</FormLabel>\n                              <FormControl>\n                                <Input type=\"email\" placeholder=\"seu@email.com\" {...field} />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                        \n                        <FormField\n                          control={bookingForm.control}\n                          name=\"contactPhone\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>Telefone</FormLabel>\n                              <FormControl>\n                                <Input placeholder=\"(11) 99999-9999\" {...field} value={field.value || \"\"} />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                      </div>\n\n                      <FormField\n                        control={bookingForm.control}\n                        name=\"specialRequests\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>Observa√ß√µes especiais</FormLabel>\n                            <FormControl>\n                              <Textarea \n                                placeholder=\"Alguma observa√ß√£o ou solicita√ß√£o especial...\"\n                                {...field}\n                                value={field.value || \"\"}\n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <div className=\"border-t pt-4\">\n                        <div className=\"flex justify-between items-center text-lg font-semibold\">\n                          <span>Total:</span>\n                          <span className=\"text-blue-600\">\n                            {calculateTotalPrice() === 0 ? \"Gr√°tis\" : formatBrazilianCurrency(calculateTotalPrice())}\n                          </span>\n                        </div>\n                        {selectedProposals.length > 0 && (\n                          <div className=\"mt-2 text-sm text-gray-600\">\n                            Baseado em {selectedProposals.length} proposta{selectedProposals.length > 1 ? 's' : ''} selecionada{selectedProposals.length > 1 ? 's' : ''}\n                          </div>\n                        )}\n                      </div>\n\n                      <div className=\"flex gap-2\">\n                        <Button \n                          type=\"button\" \n                          variant=\"outline\" \n                          onClick={() => setShowBookingDialog(false)}\n                          className=\"flex-1\"\n                        >\n                          Cancelar\n                        </Button>\n                        <Button \n                          type=\"submit\" \n                          disabled={bookingMutation.isPending}\n                          className=\"flex-1\"\n                        >\n                          {bookingMutation.isPending ? \"Reservando...\" : \"Confirmar Reserva\"}\n                        </Button>\n                      </div>\n                    </form>\n                  </Form>\n                </DialogContent>\n              </Dialog>\n\n              \n\n              <Separator className=\"my-6\" />\n\n              {/* Contact Info */}\n              {activity.contactInfo && (() => {\n                const contactInfo = typeof activity.contactInfo === 'string' \n                  ? JSON.parse(activity.contactInfo) \n                  : activity.contactInfo;\n                \n                return (\n                  <div>\n                    <h3 className=\"font-semibold text-gray-900 mb-4\">\n                      Informa√ß√µes de Contato\n                    </h3>\n                    <div className=\"space-y-3\">\n                      {contactInfo?.email && (\n                        <div className=\"flex items-center gap-3\">\n                          <Mail className=\"w-4 h-4 text-gray-600\" />\n                          <a \n                            href={`mailto:${contactInfo.email}`}\n                            className=\"text-sm text-blue-600 hover:underline\"\n                          >\n                            {contactInfo.email}\n                          </a>\n                        </div>\n                      )}\n                      \n                      {contactInfo?.phone && (\n                        <div className=\"flex items-center gap-3\">\n                          <Phone className=\"w-4 h-4 text-gray-600\" />\n                          <a \n                            href={`tel:${contactInfo.phone}`}\n                            className=\"text-sm text-blue-600 hover:underline\"\n                          >\n                            {contactInfo.phone}\n                          </a>\n                        </div>\n                      )}\n                      \n                      {contactInfo?.whatsapp && (\n                        <div className=\"flex items-center gap-3\">\n                          <MessageCircle className=\"w-4 h-4 text-gray-600\" />\n                          <a \n                            href={`https://wa.me/${contactInfo.whatsapp}`}\n                            className=\"text-sm text-blue-600 hover:underline\"\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                          >\n                            WhatsApp\n                          </a>\n                        </div>\n                      )}\n                      \n                      {contactInfo?.website && (\n                        <div className=\"flex items-center gap-3\">\n                          <Globe className=\"w-4 h-4 text-gray-600\" />\n                          <a \n                            href={contactInfo.website}\n                            className=\"text-sm text-blue-600 hover:underline\"\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                          >\n                            Website\n                          </a>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                );\n              })()}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Add to Trip Dialog */}\n      <AddActivityToTrip \n        activity={activity}\n        isOpen={showAddToTripDialog}\n        onClose={() => setShowAddToTripDialog(false)}\n        selectedProposals={selectedProposals}\n      />\n    </div>\n  );\n}","size_bytes":33743},"client/src/pages/auth-page.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { useLocation } from \"wouter\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { insertUserSchema, insertInterestListSchema } from \"@shared/schema\";\nimport { z } from \"zod\";\nimport { Plane, Mail, Lock, User, Phone, Gift, Check, AlertCircle } from \"lucide-react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\n\n// Fun√ß√£o para formata√ß√£o de telefone (xx) xxxxx-xxxx\nconst formatPhoneNumber = (value: string) => {\n  const onlyNumbers = value.replace(/\\D/g, '');\n  \n  if (onlyNumbers.length <= 2) {\n    return onlyNumbers;\n  } else if (onlyNumbers.length <= 7) {\n    return `(${onlyNumbers.slice(0, 2)}) ${onlyNumbers.slice(2)}`;\n  } else if (onlyNumbers.length <= 11) {\n    return `(${onlyNumbers.slice(0, 2)}) ${onlyNumbers.slice(2, 7)}-${onlyNumbers.slice(7)}`;\n  } else {\n    return `(${onlyNumbers.slice(0, 2)}) ${onlyNumbers.slice(2, 7)}-${onlyNumbers.slice(7, 11)}`;\n  }\n};\n\nconst loginSchema = z.object({\n  identifier: z.string().min(1, \"Usu√°rio, email ou telefone √© obrigat√≥rio\"),\n  password: z.string().min(1, \"Senha √© obrigat√≥ria\"),\n});\n\nconst referralValidationSchema = z.object({\n  referral_code: z.string().min(1, \"C√≥digo de indica√ß√£o √© obrigat√≥rio\"),\n});\n\nconst registerSchema = insertUserSchema.extend({\n  confirmPassword: z.string().min(6, \"Senha deve ter pelo menos 6 caracteres\"),\n  email: z.string().email(\"Email inv√°lido\"),\n  full_name: z.string().min(3, \"Nome completo deve ter pelo menos 3 caracteres\"),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"As senhas n√£o coincidem\",\n  path: [\"confirmPassword\"],\n});\n\nconst interestListSchema = insertInterestListSchema.extend({\n  phone: z.string().min(10, \"Telefone deve ter pelo menos 10 d√≠gitos\"),\n});\n\ntype LoginForm = z.infer<typeof loginSchema>;\ntype ReferralForm = z.infer<typeof referralValidationSchema>;\ntype RegisterForm = z.infer<typeof registerSchema>;\ntype InterestListForm = z.infer<typeof interestListSchema>;\n\nexport default function AuthPage() {\n  const { user, login_mutation, register_mutation } = useAuth();\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  \n  // States for referral validation flow\n  const [step, setStep] = useState<'referral' | 'register' | 'interest'>('referral');\n  const [validatedCode, setValidatedCode] = useState<string>('');\n\n  const loginForm = useForm<LoginForm>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      identifier: \"\",\n      password: \"\",\n    },\n  });\n\n  const referralForm = useForm<ReferralForm>({\n    resolver: zodResolver(referralValidationSchema),\n    defaultValues: {\n      referral_code: \"\",\n    },\n  });\n\n  const registerForm = useForm<RegisterForm>({\n    resolver: zodResolver(registerSchema),\n    defaultValues: {\n      username: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      email: \"\",\n      full_name: \"\",\n      phone: \"\",\n      bio: \"\",\n      location: \"\",\n      languages: [],\n      interests: [],\n      travel_styles: [],\n    },\n  });\n\n  const interestForm = useForm<InterestListForm>({\n    resolver: zodResolver(interestListSchema),\n    defaultValues: {\n      full_name: \"\",\n      email: \"\",\n      phone: \"\",\n    },\n  });\n\n  useEffect(() => {\n    if (user) {\n      navigate(\"/dashboard\");\n    }\n  }, [user, navigate]);\n\n  // Mutation for validating referral code\n  const validateReferralMutation = useMutation({\n    mutationFn: async (data: ReferralForm) => {\n      const res = await fetch(\"/api/validate-referral\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(data),\n      });\n      \n      const result = await res.json();\n      if (!res.ok) {\n        throw new Error(result.message);\n      }\n      return result;\n    },\n    onSuccess: (data, variables) => {\n      if (data.isValid) {\n        setValidatedCode(variables.referral_code);\n        setStep('register');\n        toast({\n          title: \"C√≥digo v√°lido!\",\n          description: \"Agora voc√™ pode prosseguir com o cadastro.\",\n        });\n      }\n    },\n    onError: (error: Error) => {\n      // If code is invalid, go to interest list\n      setStep('interest');\n      // Pre-fill the invalid code in interest form\n      interestForm.setValue(\"referral_code\", referralForm.getValues().referral_code);\n      toast({\n        title: \"C√≥digo inv√°lido\",\n        description: error.message + \". Complete o formul√°rio para entrar na lista de interesse.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Mutation for adding to interest list\n  const addToInterestMutation = useMutation({\n    mutationFn: async (data: InterestListForm & { referralCode?: string }) => {\n      const res = await fetch(\"/api/interest-list\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(data),\n      });\n      \n      const result = await res.json();\n      if (!res.ok) {\n        throw new Error(result.message);\n      }\n      return result;\n    },\n    onSuccess: (data) => {\n      toast({\n        title: \"Cadastro na lista realizado!\",\n        description: data.message,\n      });\n      // Reset form and go back to referral step\n      interestForm.reset();\n      setStep('referral');\n      referralForm.reset();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Erro no cadastro\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onLogin = (data: LoginForm) => {\n    login_mutation.mutate(data, {\n      onSuccess: () => {\n        navigate(\"/dashboard\");\n      }\n    });\n  };\n\n  const onValidateReferral = (data: ReferralForm) => {\n    validateReferralMutation.mutate(data);\n  };\n\n  const onRegister = (data: RegisterForm) => {\n    const { confirmPassword, ...registerData } = data;\n    \n    register_mutation.mutate({\n      ...registerData,\n      bio: registerData.bio || undefined,\n      location: registerData.location || undefined,\n      languages: Array.isArray(registerData.languages) ? registerData.languages : [],\n      interests: Array.isArray(registerData.interests) ? registerData.interests : [],\n      travel_styles: Array.isArray(registerData.travel_styles) ? registerData.travel_styles : [],\n    }, {\n      onSuccess: () => {\n        navigate(\"/dashboard\");\n      }\n    });\n  };\n\n  const onAddToInterest = (data: InterestListForm) => {\n    addToInterestMutation.mutate({\n      ...data,\n      referralCode: referralForm.getValues().referral_code,\n    });\n  };\n\n  if (login_mutation.isPending || register_mutation.isPending) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center p-4\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto\"></div>\n          <p className=\"mt-4 text-lg text-slate-600\">\n            {login_mutation.isPending ? \"Entrando...\" : \"Criando conta...\"}\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        {/* Header */}\n        <div className=\"text-center mb-8\">\n          <div className=\"flex items-center justify-center gap-3 mb-4\">\n            <div className=\"bg-gradient-to-r from-blue-600 to-indigo-600 p-3 rounded-2xl shadow-lg\">\n              <Plane className=\"h-8 w-8 text-white\" />\n            </div>\n            <h1 className=\"text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent\">\n              PartiuTrip\n            </h1>\n          </div>\n          <p className=\"text-slate-600 text-lg\">Conecte-se com outros viajantes</p>\n        </div>\n\n        <Tabs defaultValue=\"login\" className=\"w-full\">\n          <TabsList className=\"grid w-full grid-cols-2 mb-6 bg-white/60 backdrop-blur-sm border border-white/20\">\n            <TabsTrigger value=\"login\" className=\"text-slate-700 data-[state=active]:bg-white data-[state=active]:text-blue-600 data-[state=active]:shadow-md\">\n              Entrar\n            </TabsTrigger>\n            <TabsTrigger value=\"register\" className=\"text-slate-700 data-[state=active]:bg-white data-[state=active]:text-blue-600 data-[state=active]:shadow-md\">\n              Cadastrar\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"login\">\n            <Card className=\"border-0 bg-white/80 backdrop-blur-sm shadow-xl\">\n              <CardHeader className=\"text-center pb-6\">\n                <CardTitle className=\"text-2xl font-bold text-slate-800\">Entrar na sua conta</CardTitle>\n                <p className=\"text-slate-600 mt-2\">Acesse sua conta e continue sua jornada</p>\n              </CardHeader>\n              <CardContent>\n                <Form {...loginForm}>\n                  <form onSubmit={loginForm.handleSubmit(onLogin)} className=\"space-y-4\">\n                    <FormField\n                      control={loginForm.control}\n                      name=\"identifier\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-slate-700 font-medium\">Usu√°rio, Email ou Telefone</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <User className=\"absolute left-3 top-3 h-4 w-4 text-slate-400\" />\n                              <Input placeholder=\"Digite seu usu√°rio, email ou telefone\" className=\"pl-10 bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20\" {...field} />\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={loginForm.control}\n                      name=\"password\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel className=\"text-slate-700 font-medium\">Senha</FormLabel>\n                          <FormControl>\n                            <div className=\"relative\">\n                              <Lock className=\"absolute left-3 top-3 h-4 w-4 text-slate-400\" />\n                              <Input type=\"password\" placeholder=\"Sua senha\" className=\"pl-10 bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20\" {...field} />\n                            </div>\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <div className=\"flex items-center justify-between py-2\">\n                      <div className=\"flex items-center space-x-2\">\n                        <Checkbox id=\"remember\" className=\"border-slate-300\" />\n                        <Label htmlFor=\"remember\" className=\"text-sm text-slate-600\">Lembrar de mim</Label>\n                      </div>\n                      <a href=\"#\" className=\"text-sm text-blue-600 hover:text-blue-800 font-medium\">\n                        Esqueci minha senha\n                      </a>\n                    </div>\n\n                    <Button \n                      type=\"submit\" \n                      className=\"w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-semibold py-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200\" \n                      disabled={login_mutation.isPending}\n                    >\n                      {login_mutation.isPending ? \"Entrando...\" : \"Entrar\"}\n                    </Button>\n                  </form>\n                </Form>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"register\">\n            <Card className=\"border-0 bg-white/80 backdrop-blur-sm shadow-xl\">\n              <CardHeader className=\"text-center pb-6\">\n                <CardTitle className=\"text-2xl font-bold text-slate-800\">\n                  {step === 'referral' && \"Validar C√≥digo de Indica√ß√£o\"}\n                  {step === 'register' && \"Criar sua conta\"}\n                  {step === 'interest' && \"Lista de Interesse\"}\n                </CardTitle>\n                <p className=\"text-slate-600 mt-2\">\n                  {step === 'referral' && \"Primeiro, precisamos validar seu c√≥digo de indica√ß√£o\"}\n                  {step === 'register' && \"Preencha os dados para criar sua conta\"}\n                  {step === 'interest' && \"Cadastre-se na lista para ser notificado quando liberarmos o acesso\"}\n                </p>\n              </CardHeader>\n              <CardContent>\n                {step === 'referral' && (\n                  <Form {...referralForm}>\n                    <form onSubmit={referralForm.handleSubmit(onValidateReferral)} className=\"space-y-4\">\n                      <FormField\n                        control={referralForm.control}\n                        name=\"referral_code\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel className=\"text-slate-700 font-medium\">C√≥digo de Indica√ß√£o</FormLabel>\n                            <FormControl>\n                              <div className=\"relative\">\n                                <Gift className=\"absolute left-3 top-3 h-4 w-4 text-slate-400\" />\n                                <Input \n                                  placeholder=\"Digite o c√≥digo de indica√ß√£o\" \n                                  className=\"pl-10 bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20 font-mono uppercase\" \n                                  value={field.value}\n                                  onChange={(e) => field.onChange(e.target.value.toUpperCase())}\n                                  style={{ textTransform: 'uppercase' }}\n                                />\n                              </div>\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <Button \n                        type=\"submit\" \n                        className=\"w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-semibold py-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200\" \n                        disabled={validateReferralMutation.isPending}\n                      >\n                        {validateReferralMutation.isPending ? \"Validando...\" : \"Validar C√≥digo\"}\n                      </Button>\n                    </form>\n                  </Form>\n                )}\n\n                {step === 'register' && (\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg\">\n                      <Check className=\"h-4 w-4 text-green-600\" />\n                      <span className=\"text-sm text-green-700\">C√≥digo validado: {validatedCode}</span>\n                    </div>\n                    \n                    <Form {...registerForm}>\n                      <form onSubmit={registerForm.handleSubmit(onRegister)} className=\"space-y-4\">\n                        <div className=\"grid grid-cols-2 gap-4\">\n                          <FormField\n                            control={registerForm.control}\n                            name=\"full_name\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"text-slate-700 font-medium\">Nome Completo</FormLabel>\n                                <FormControl>\n                                  <Input placeholder=\"Seu nome completo\" className=\"bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20\" {...field} />\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={registerForm.control}\n                            name=\"username\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"text-slate-700 font-medium\">Usu√°rio</FormLabel>\n                                <FormControl>\n                                  <Input placeholder=\"Seu usu√°rio\" className=\"bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20\" {...field} />\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n                        </div>\n\n                        <FormField\n                          control={registerForm.control}\n                          name=\"email\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel className=\"text-slate-700 font-medium\">Email</FormLabel>\n                              <FormControl>\n                                <div className=\"relative\">\n                                  <Mail className=\"absolute left-3 top-3 h-4 w-4 text-slate-400\" />\n                                  <Input type=\"email\" placeholder=\"Seu email\" className=\"pl-10 bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20\" {...field} />\n                                </div>\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n\n                        <FormField\n                          control={registerForm.control}\n                          name=\"phone\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel className=\"text-slate-700 font-medium\">Telefone</FormLabel>\n                              <FormControl>\n                                <div className=\"relative\">\n                                  <Phone className=\"absolute left-3 top-3 h-4 w-4 text-slate-400\" />\n                                  <Input \n                                    placeholder=\"(11) 99999-9999\" \n                                    className=\"pl-10 bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20\" \n                                    value={field.value}\n                                    onChange={(e) => field.onChange(formatPhoneNumber(e.target.value))}\n                                  />\n                                </div>\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n\n                        <div className=\"grid grid-cols-2 gap-4\">\n                          <FormField\n                            control={registerForm.control}\n                            name=\"password\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"text-slate-700 font-medium\">Senha</FormLabel>\n                                <FormControl>\n                                  <div className=\"relative\">\n                                    <Lock className=\"absolute left-3 top-3 h-4 w-4 text-slate-400\" />\n                                    <Input type=\"password\" placeholder=\"Sua senha\" className=\"pl-10 bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20\" {...field} />\n                                  </div>\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={registerForm.control}\n                            name=\"confirmPassword\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel className=\"text-slate-700 font-medium\">Confirmar Senha</FormLabel>\n                                <FormControl>\n                                  <div className=\"relative\">\n                                    <Lock className=\"absolute left-3 top-3 h-4 w-4 text-slate-400\" />\n                                    <Input type=\"password\" placeholder=\"Confirme sua senha\" className=\"pl-10 bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20\" {...field} />\n                                  </div>\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n                        </div>\n\n                        <Button \n                          type=\"submit\" \n                          className=\"w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-semibold py-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200\" \n                          disabled={register_mutation.isPending}\n                        >\n                          {register_mutation.isPending ? \"Criando conta...\" : \"Criar conta\"}\n                        </Button>\n                      </form>\n                    </Form>\n                  </div>\n                )}\n\n                {step === 'interest' && (\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center gap-2 p-3 bg-orange-50 border border-orange-200 rounded-lg\">\n                      <AlertCircle className=\"h-4 w-4 text-orange-600\" />\n                      <span className=\"text-sm text-orange-700\">C√≥digo inv√°lido. Complete o formul√°rio para entrar na lista de interesse.</span>\n                    </div>\n                    \n                    <Form {...interestForm}>\n                      <form onSubmit={interestForm.handleSubmit(onAddToInterest)} className=\"space-y-4\">\n                        <FormField\n                          control={interestForm.control}\n                          name=\"full_name\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel className=\"text-slate-700 font-medium\">Nome Completo</FormLabel>\n                              <FormControl>\n                                <div className=\"relative\">\n                                  <User className=\"absolute left-3 top-3 h-4 w-4 text-slate-400\" />\n                                  <Input placeholder=\"Seu nome completo\" className=\"pl-10 bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20\" {...field} />\n                                </div>\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n\n                        <FormField\n                          control={interestForm.control}\n                          name=\"email\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel className=\"text-slate-700 font-medium\">Email</FormLabel>\n                              <FormControl>\n                                <div className=\"relative\">\n                                  <Mail className=\"absolute left-3 top-3 h-4 w-4 text-slate-400\" />\n                                  <Input type=\"email\" placeholder=\"Seu email\" className=\"pl-10 bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20\" {...field} />\n                                </div>\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n\n                        <FormField\n                          control={interestForm.control}\n                          name=\"phone\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel className=\"text-slate-700 font-medium\">Telefone</FormLabel>\n                              <FormControl>\n                                <div className=\"relative\">\n                                  <Phone className=\"absolute left-3 top-3 h-4 w-4 text-slate-400\" />\n                                  <Input \n                                    placeholder=\"(11) 99999-9999\" \n                                    className=\"pl-10 bg-white/80 border-slate-200 focus:border-blue-500 focus:ring-blue-500/20\" \n                                    value={field.value}\n                                    onChange={(e) => field.onChange(formatPhoneNumber(e.target.value))}\n                                  />\n                                </div>\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n\n                        <div className=\"flex gap-3\">\n                          <Button \n                            type=\"button\"\n                            variant=\"outline\"\n                            className=\"flex-1 border-slate-300 text-slate-700 hover:bg-slate-50\"\n                            onClick={() => {\n                              setStep('referral');\n                              referralForm.reset();\n                              interestForm.reset();\n                            }}\n                          >\n                            Tentar outro c√≥digo\n                          </Button>\n                          \n                          <Button \n                            type=\"submit\" \n                            className=\"flex-1 bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white font-semibold py-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200\" \n                            disabled={addToInterestMutation.isPending}\n                          >\n                            {addToInterestMutation.isPending ? \"Enviando...\" : \"Entrar na lista\"}\n                          </Button>\n                        </div>\n                      </form>\n                    </Form>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}","size_bytes":27618},"client/src/pages/board-page.tsx":{"content":"import { useAuth } from \"@/hooks/use-auth-snake\";\nimport { ProtectedRoute } from \"@/lib/protected-route\";\nimport { Navbar } from \"@/components/navbar\";\nimport { TravelBoard } from \"@/components/travel-board\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { \n  LayoutDashboard, \n  Calendar,\n  MapPin,\n  TrendingUp,\n  Users,\n  Plus\n} from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nexport default function BoardPage() {\n  const { user } = useAuth();\n\n  // Mock statistics\n  const stats = {\n    totalTrips: 4,\n    upcomingTrips: 2,\n    activeTrips: 0,\n    completedTrips: 1,\n    totalBudget: 15000,\n    savedAmount: 2300\n  };\n\n  return (\n    <ProtectedRoute>\n      <div className=\"min-h-screen bg-gray-50\">\n        <Navbar />\n        \n        <div className=\"container mx-auto px-4 py-8\">\n          {/* Page Header */}\n          <div className=\"flex items-center justify-between mb-8\">\n            <div>\n              <h1 className=\"text-3xl font-bold text-gray-900 flex items-center gap-3\">\n                <LayoutDashboard className=\"h-8 w-8 text-primary\" />\n                Painel de Viagens\n              </h1>\n              <p className=\"text-gray-600 mt-2\">\n                Organize e gerencie todas as suas viagens em um s√≥ lugar\n              </p>\n            </div>\n            <Button asChild className=\"bg-primary hover:bg-primary/90\">\n              <Link href=\"/create-trip\">\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Nova Viagem\n              </Link>\n            </Button>\n          </div>\n\n          <Tabs defaultValue=\"board\" className=\"space-y-6\">\n            <TabsList className=\"grid w-full grid-cols-2 lg:w-[400px]\">\n              <TabsTrigger value=\"board\">Painel Visual</TabsTrigger>\n              <TabsTrigger value=\"stats\">Estat√≠sticas</TabsTrigger>\n            </TabsList>\n\n            <TabsContent value=\"board\">\n              <TravelBoard />\n            </TabsContent>\n\n            <TabsContent value=\"stats\" className=\"space-y-6\">\n              {/* Statistics Cards */}\n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Total de Viagens</CardTitle>\n                    <MapPin className=\"h-4 w-4 text-muted-foreground\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">{stats.totalTrips}</div>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Todas as suas aventuras\n                    </p>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Pr√≥ximas Viagens</CardTitle>\n                    <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">{stats.upcomingTrips}</div>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Confirmadas e agendadas\n                    </p>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Or√ßamento Total</CardTitle>\n                    <TrendingUp className=\"h-4 w-4 text-muted-foreground\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">R$ {stats.totalBudget.toLocaleString('pt-BR')}</div>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Investimento em experi√™ncias\n                    </p>\n                  </CardContent>\n                </Card>\n\n                <Card>\n                  <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n                    <CardTitle className=\"text-sm font-medium\">Companheiros</CardTitle>\n                    <Users className=\"h-4 w-4 text-muted-foreground\" />\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"text-2xl font-bold\">12</div>\n                    <p className=\"text-xs text-muted-foreground\">\n                      Pessoas conhecidas\n                    </p>\n                  </CardContent>\n                </Card>\n              </div>\n\n              {/* Recent Activity */}\n              <Card>\n                <CardHeader>\n                  <CardTitle>Atividade Recente</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n                      <div className=\"flex-1\">\n                        <p className=\"text-sm font-medium\">Nova viagem criada</p>\n                        <p className=\"text-xs text-gray-600\">Trilha na Chapada Diamantina - h√° 2 horas</p>\n                      </div>\n                      <Badge variant=\"secondary\">Novo</Badge>\n                    </div>\n                    \n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\n                      <div className=\"flex-1\">\n                        <p className=\"text-sm font-medium\">Participante adicionado</p>\n                        <p className=\"text-xs text-gray-600\">Ana Silva se juntou √† viagem para Campos do Jord√£o</p>\n                      </div>\n                      <Badge variant=\"outline\">Participa√ß√£o</Badge>\n                    </div>\n                    \n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"w-2 h-2 bg-yellow-500 rounded-full\"></div>\n                      <div className=\"flex-1\">\n                        <p className=\"text-sm font-medium\">Or√ßamento atualizado</p>\n                        <p className=\"text-xs text-gray-600\">Detalhamento de custos da viagem para Salvador</p>\n                      </div>\n                      <Badge variant=\"outline\">Or√ßamento</Badge>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Tips and Recommendations */}\n              <Card>\n                <CardHeader>\n                  <CardTitle>Dicas de Organiza√ß√£o</CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-3\">\n                    <div className=\"p-4 bg-blue-50 rounded-lg\">\n                      <h4 className=\"font-medium text-blue-900 mb-2\">üìã Mantenha suas viagens organizadas</h4>\n                      <p className=\"text-sm text-blue-800\">\n                        Use o painel visual para arrastar viagens entre as colunas conforme elas progridem do planejamento at√© a conclus√£o.\n                      </p>\n                    </div>\n                    \n                    <div className=\"p-4 bg-green-50 rounded-lg\">\n                      <h4 className=\"font-medium text-green-900 mb-2\">üí° Dica de or√ßamento</h4>\n                      <p className=\"text-sm text-green-800\">\n                        Detalhe os custos compartilhados para facilitar a divis√£o de gastos entre os participantes.\n                      </p>\n                    </div>\n                    \n                    <div className=\"p-4 bg-yellow-50 rounded-lg\">\n                      <h4 className=\"font-medium text-yellow-900 mb-2\">ü§ù Comunica√ß√£o √© fundamental</h4>\n                      <p className=\"text-sm text-yellow-800\">\n                        Use o chat das viagens para manter todos os participantes informados sobre mudan√ßas e novidades.\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </TabsContent>\n          </Tabs>\n        </div>\n      </div>\n    </ProtectedRoute>\n  );\n}","size_bytes":8514},"client/src/pages/chat-page.tsx":{"content":"import { useParams } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { Navbar } from \"@/components/navbar\";\nimport { ChatWindow } from \"@/components/chat-window\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { \n  ArrowLeft, \n  Users, \n  MapPin, \n  Calendar,\n  Settings,\n  MoreVertical,\n  MessageCircle,\n  Phone,\n  Video,\n  Clock\n} from \"lucide-react\";\nimport { format, differenceInDays } from \"date-fns\";\nimport { ptBR } from \"date-fns/locale\";\nimport { LoadingSpinner } from \"@/components/loading-spinner\";\nimport { motion } from \"framer-motion\";\n\nexport default function ChatPage() {\n  const { tripId } = useParams();\n  const { user } = useAuth();\n\n  const { data: trip, isLoading: tripLoading } = useQuery({\n    queryKey: [\"/api/trips\", tripId],\n    queryFn: async () => {\n      const res = await apiRequest(\"GET\", `/api/trips/${tripId}`);\n      if (!res.ok) throw new Error('Failed to fetch trip');\n      return res.json();\n    },\n    enabled: !!tripId,\n  });\n\n  if (tripLoading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-cyan-50\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8\">\n          <div className=\"flex items-center justify-center min-h-[500px]\">\n            <LoadingSpinner variant=\"travel\" size=\"lg\" message=\"Carregando chat da viagem...\" />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!trip) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-cyan-50\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"max-w-md mx-auto\"\n          >\n            <Card className=\"text-center p-8 shadow-lg bg-white/80 backdrop-blur-sm border-0\">\n              <div className=\"w-16 h-16 bg-red-100 rounded-full mx-auto mb-4 flex items-center justify-center\">\n                <Info className=\"h-8 w-8 text-red-600\" />\n              </div>\n              <h1 className=\"text-xl font-bold text-gray-900 mb-2\">Viagem n√£o encontrada</h1>\n              <p className=\"text-gray-600 text-sm\">A viagem que voc√™ procura n√£o existe ou foi removida.</p>\n              <Button \n                onClick={() => window.location.href = '/dashboard'} \n                className=\"mt-4 bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600\"\n              >\n                Voltar ao Dashboard\n              </Button>\n            </Card>\n          </motion.div>\n        </div>\n      </div>\n    );\n  }\n\n  const isParticipant = trip.participants?.some((p: any) => p.user_id === user?.id) || trip.creator_id === user?.id;\n\n  if (!isParticipant) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-cyan-50\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"max-w-md mx-auto\"\n          >\n            <Card className=\"text-center p-8 shadow-lg bg-white/80 backdrop-blur-sm border-0\">\n              <div className=\"w-16 h-16 bg-orange-100 rounded-full mx-auto mb-4 flex items-center justify-center\">\n                <Users className=\"h-8 w-8 text-orange-600\" />\n              </div>\n              <h1 className=\"text-xl font-bold text-gray-900 mb-2\">Acesso restrito</h1>\n              <p className=\"text-gray-600 text-sm\">Voc√™ precisa ser participante desta viagem para acessar o chat.</p>\n              <Button \n                onClick={() => window.location.href = '/dashboard'} \n                className=\"mt-4 bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600\"\n              >\n                Voltar ao Dashboard\n              </Button>\n            </Card>\n          </motion.div>\n        </div>\n      </div>\n    );\n  }\n\n  const daysUntilTrip = differenceInDays(new Date(trip.startDate), new Date());\n  const tripDuration = differenceInDays(new Date(trip.endDate), new Date(trip.startDate));\n\n  const travelStyleLabels: { [key: string]: string } = {\n    praia: \"Praia\",\n    neve: \"Neve\", \n    cruzeiros: \"Cruzeiros\",\n    natureza: \"Natureza e Ecoturismo\",\n    cultural: \"Culturais e Hist√≥ricas\",\n    aventura: \"Aventura\",\n    parques: \"Parques Tem√°ticos\",\n    urbanas: \"Viagens Urbanas / Cidades Grandes\"\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-cyan-50\">\n      <Navbar />\n      \n      <div className=\"container mx-auto px-2 sm:px-4 py-2 sm:py-4 md:py-6 max-w-7xl\">\n        {/* Modern Header */}\n        <motion.div\n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"mb-4 sm:mb-6\"\n        >\n          <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n            <CardContent className=\"p-3 sm:p-4 md:p-6\">\n              <div className=\"flex items-start gap-4\">\n                <Button \n                  variant=\"ghost\" \n                  size=\"sm\" \n                  onClick={() => window.history.back()}\n                  className=\"shrink-0 hover:bg-blue-50\"\n                >\n                  <ArrowLeft className=\"h-4 w-4 mr-2\" />\n                  <span className=\"hidden sm:inline\">Voltar</span>\n                </Button>\n                \n                <div className=\"flex-1 min-w-0\">\n                  <div className=\"flex items-center gap-3 mb-3\">\n                    <div className=\"w-12 h-12 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center shrink-0\">\n                      <MessageCircle className=\"h-6 w-6 text-white\" />\n                    </div>\n                    <div className=\"flex-1 min-w-0\">\n                      <h1 className=\"font-bold text-xl md:text-2xl text-gray-900 truncate\">{trip.title}</h1>\n                      <div className=\"flex items-center gap-2 text-sm text-gray-600\">\n                        <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n                        <span>Chat ativo</span>\n                      </div>\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex flex-wrap items-center gap-3 md:gap-4 text-sm\">\n                    <div className=\"flex items-center gap-1.5 bg-blue-50 px-3 py-1 rounded-full\">\n                      <MapPin className=\"h-3.5 w-3.5 text-blue-600\" />\n                      <span className=\"text-blue-700 font-medium truncate\">{trip.destination}</span>\n                    </div>\n                    <div className=\"flex items-center gap-1.5 bg-emerald-50 px-3 py-1 rounded-full\">\n                      <Calendar className=\"h-3.5 w-3.5 text-emerald-600\" />\n                      <span className=\"text-emerald-700 font-medium\">\n                        {format(new Date(trip.startDate), \"dd/MM\", { locale: ptBR })} - {format(new Date(trip.endDate), \"dd/MM/yyyy\", { locale: ptBR })}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center gap-1.5 bg-purple-50 px-3 py-1 rounded-full\">\n                      <Users className=\"h-3.5 w-3.5 text-purple-600\" />\n                      <span className=\"text-purple-700 font-medium\">{trip.current_participants} participantes</span>\n                    </div>\n                    {daysUntilTrip > 0 && (\n                      <div className=\"flex items-center gap-1.5 bg-amber-50 px-3 py-1 rounded-full\">\n                        <Clock className=\"h-3.5 w-3.5 text-amber-600\" />\n                        <span className=\"text-amber-700 font-medium\">{daysUntilTrip} dias restantes</span>\n                      </div>\n                    )}\n                  </div>\n                </div>\n                \n                <div className=\"flex items-center gap-2 shrink-0\">\n                  <Button variant=\"outline\" size=\"sm\" className=\"hidden md:flex\">\n                    <Phone className=\"h-4 w-4 mr-2\" />\n                    Ligar\n                  </Button>\n                  <Button variant=\"outline\" size=\"sm\" className=\"hidden md:flex\">\n                    <Video className=\"h-4 w-4 mr-2\" />\n                    V√≠deo\n                  </Button>\n                  <Button variant=\"ghost\" size=\"sm\">\n                    <MoreVertical className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6\">\n          {/* Enhanced Chat Window */}\n          <motion.div\n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"lg:col-span-3 order-2 lg:order-1\"\n          >\n            <ChatWindow \n              tripId={tripId!} \n              participants={trip.participants || []}\n              className=\"h-[calc(100vh-200px)] sm:h-[calc(100vh-240px)] md:h-[calc(100vh-280px)] lg:h-[calc(100vh-320px)] min-h-[400px] sm:min-h-[500px]\"\n            />\n          </motion.div>\n\n          {/* Enhanced Sidebar */}\n          <motion.div\n            initial={{ opacity: 0, x: 20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.3 }}\n            className=\"lg:col-span-1 order-1 lg:order-2 space-y-4\"\n          >\n            {/* Participants List */}\n            <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-sm font-semibold text-gray-900 flex items-center justify-between\">\n                  <div className=\"flex items-center gap-2\">\n                    <Users className=\"h-4 w-4 text-blue-600\" />\n                    Participantes\n                  </div>\n                  <Badge variant=\"secondary\" className=\"text-xs\">\n                    {trip.current_participants}\n                  </Badge>\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                {/* Creator */}\n                <div className=\"flex items-center gap-3 p-3 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-lg\">\n                  <Avatar className=\"w-10 h-10 ring-2 ring-blue-200\">\n                    <AvatarImage src={trip.creator?.profilePhoto || \"\"} />\n                    <AvatarFallback className=\"bg-blue-100 text-blue-700 font-semibold\">\n                      {(trip.creator?.full_name || trip.creator?.fullName)?.split(' ').map((n: string) => n[0]).join('').toUpperCase()}\n                    </AvatarFallback>\n                  </Avatar>\n                  <div className=\"flex-1 min-w-0\">\n                    <h4 className=\"font-semibold text-sm text-gray-900 truncate\">{trip.creator?.full_name || trip.creator?.fullName}</h4>\n                    <div className=\"flex items-center gap-2\">\n                      <Badge variant=\"default\" className=\"text-xs bg-blue-100 text-blue-700 hover:bg-blue-100\">\n                        Organizador\n                      </Badge>\n                      <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Other Participants */}\n                {trip.participants?.filter((p: any) => p.user_id !== trip.creator_id).map((participant: any) => (\n                  <div key={participant.id} className=\"flex items-center gap-3 p-3 rounded-lg hover:bg-gray-50 transition-colors\">\n                    <Avatar className=\"w-10 h-10\">\n                      <AvatarImage src={participant.user?.profilePhoto || \"\"} />\n                      <AvatarFallback className=\"bg-gray-100 text-gray-700 font-semibold\">\n                        {(participant.user?.full_name || participant.user?.fullName)?.split(' ').map((n: string) => n[0]).join('').toUpperCase()}\n                      </AvatarFallback>\n                    </Avatar>\n                    <div className=\"flex-1 min-w-0\">\n                      <h4 className=\"font-semibold text-sm text-gray-900 truncate\">{participant.user?.full_name || participant.user?.fullName}</h4>\n                      <div className=\"flex items-center gap-2\">\n                        <p className=\"text-xs text-gray-600 truncate\">{participant.user?.location || \"Sem localiza√ß√£o\"}</p>\n                        <div className=\"w-2 h-2 bg-gray-400 rounded-full\"></div>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </CardContent>\n            </Card>\n          </motion.div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":13081},"client/src/pages/create-trip-page.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useForm, useWatch } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { z } from \"zod\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { DndContext, closestCenter, KeyboardSensor, PointerSensor, useSensor, useSensors } from '@dnd-kit/core';\nimport { arrayMove, SortableContext, sortableKeyboardCoordinates, verticalListSortingStrategy } from '@dnd-kit/sortable';\nimport { useSortable } from '@dnd-kit/sortable';\nimport { CSS } from '@dnd-kit/utilities';\nimport Confetti from 'react-confetti';\n\nimport { ProtectedRoute } from \"@/lib/protected-route\";\nimport { Navbar } from \"@/components/navbar\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { \n  Calendar, \n  MapPin, \n  Users, \n  DollarSign, \n  Plane, \n  CheckCircle, \n  Target,\n  TrendingUp,\n  Star,\n  Gift,\n  Zap,\n  Award,\n  Trophy,\n  Sparkles,\n  Clock,\n  Globe,\n  Camera,\n  Heart,\n  Coffee,\n  Compass,\n  GripVertical,\n  Plus,\n  Minus,\n  ChevronRight,\n  ChevronLeft,\n  AlertCircle\n} from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { insertTripSchema, expenseCategories, BudgetBreakdown, PlannedActivity } from \"@shared/schema\";\nimport { LoadingSpinner } from \"@/components/loading-spinner\";\nimport { PlacesAutocomplete } from \"@/components/places-autocomplete\";\nimport { AdvancedActivityManager } from \"@/components/advanced-activity-manager\";\nimport { CoverImageSelector } from \"@/components/cover-image-selector\";\nimport { apiRequest } from \"@/lib/queryClient\";\n\nconst createTripSchema = insertTripSchema.omit({ destination_id: true }).extend({\n  start_date: z.string().min(1, \"Data de in√≠cio √© obrigat√≥ria\"),\n  end_date: z.string().min(1, \"Data de fim √© obrigat√≥ria\"),\n  planned_activities: z.array(z.any()).optional(),\n  destination: z.string().min(1, \"Destino √© obrigat√≥rio\"),\n}).refine((data) => {\n  const start_date = new Date(data.start_date);\n  const end_date = new Date(data.end_date);\n  return end_date > start_date;\n}, {\n  message: \"A data de fim deve ser posterior √† data de in√≠cio\",\n  path: [\"end_date\"],\n});\n\ntype CreateTripForm = z.input<typeof createTripSchema>;\n\n// Travel Planning Roadmap - Best Practices Based\ninterface RoadmapStep {\n  id: string;\n  title: string;\n  icon: any;\n  points: number;\n  status: 'pending' | 'in-progress' | 'completed';\n  description: string;\n}\n\nconst PLANNING_ROADMAP: RoadmapStep[] = [\n  { \n    id: 'research', \n    title: 'Pesquisa & Inspira√ß√£o', \n    icon: Globe, \n    points: 20,\n    status: 'pending',\n    description: 'Escolha destino e pesquise sobre cultura, clima e atra√ß√µes'\n  },\n  { \n    id: 'budget', \n    title: 'Planejamento Financeiro', \n    icon: DollarSign, \n    points: 25,\n    status: 'pending',\n    description: 'Defina or√ßamento total e categorize gastos'\n  },\n  { \n    id: 'dates', \n    title: 'Datas & Dura√ß√£o', \n    icon: Calendar, \n    points: 15,\n    status: 'pending',\n    description: 'Escolha as melhores datas considerando clima e eventos'\n  },\n  { \n    id: 'activities', \n    title: 'Atividades Planejadas', \n    icon: Camera, \n    points: 30,\n    status: 'pending',\n    description: 'Adicione atividades com custos, links e anexos'\n  },\n  { \n    id: 'group', \n    title: 'Forma√ß√£o do Grupo', \n    icon: Users, \n    points: 20,\n    status: 'pending',\n    description: 'Defina tamanho ideal e perfil dos companheiros'\n  },\n  { \n    id: 'logistics', \n    title: 'Log√≠stica & Detalhes', \n    icon: CheckCircle, \n    points: 20,\n    status: 'pending',\n    description: 'Finalize descri√ß√£o e estilo de viagem'\n  },\n] as const;\n\n// Old SortableActivityItem removed - now using AdvancedActivityManager\n\n// Achievement System\nconst ACHIEVEMENTS = [\n  { id: 'first_trip', title: 'Primeira Viagem', desc: 'Criar sua primeira viagem', icon: Star, unlocked: true },\n  { id: 'budget_master', title: 'Planejador Financeiro', desc: 'Detalhar or√ßamento completo', icon: Trophy, unlocked: false },\n  { id: 'social_butterfly', title: 'Organizador Social', desc: 'Criar viagem para 6+ pessoas', icon: Users, unlocked: false },\n  { id: 'adventurer', title: 'Aventureiro', desc: 'Criar viagem de aventura', icon: Compass, unlocked: false },\n];\n\nfunction CreateTripPageContent() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [roadmapSteps, setRoadmapSteps] = useState(PLANNING_ROADMAP);\n  const [showConfetti, setShowConfetti] = useState(false);\n  const [totalPoints, setTotalPoints] = useState(0);\n  const [achievements, setAchievements] = useState(ACHIEVEMENTS);\n  const [showBudgetBreakdown, setShowBudgetBreakdown] = useState(false);\n  const [selectedDestinationId, setSelectedDestinationId] = useState<number | null>(null);\n  const [planned_activities, setPlannedActivities] = useState<PlannedActivity[]>([\n    {\n      id: '1',\n      title: 'Visitar pontos tur√≠sticos principais',\n      category: 'sightseeing',\n      priority: 'high',\n      estimated_cost: 150,\n      duration: '4 horas',\n      created_at: new Date().toISOString(),\n    },\n    {\n      id: '2',\n      title: 'Experimentar gastronomia local',\n      category: 'food',\n      priority: 'medium',\n      estimated_cost: 200,\n      duration: '2 horas',\n      created_at: new Date().toISOString(),\n    },\n    {\n      id: '3',\n      title: 'Explorar a vida noturna',\n      category: 'nightlife',\n      priority: 'low',\n      estimated_cost: 100,\n      duration: '3 horas',\n      created_at: new Date().toISOString(),\n    },\n  ]);\n\n  const sensors = useSensors(\n    useSensor(PointerSensor),\n    useSensor(KeyboardSensor, {\n      coordinateGetter: sortableKeyboardCoordinates,\n    })\n  );\n\n  const form = useForm<CreateTripForm>({\n    resolver: zodResolver(createTripSchema),\n    defaultValues: {\n      title: \"\",\n      destination: \"\",\n      description: \"\",\n      start_date: \"\",\n      end_date: \"\",\n      max_participants: 4,\n      budget: undefined,\n      budget_breakdown: undefined,\n      travel_style: \"\",\n      shared_costs: [],\n    },\n  });\n\n  const watchedValues = useWatch({ control: form.control });\n\n  // Calculate roadmap progress and update steps\n  const calculateRoadmapProgress = () => {\n    const updatedSteps = [...roadmapSteps];\n    let totalProgress = 0;\n    let completedCount = 0;\n    \n    // Research & Inspiration\n    if (watchedValues.destination && watchedValues.travel_style) {\n      updatedSteps[0].status = 'completed';\n      totalProgress += updatedSteps[0].points;\n      completedCount++;\n    } else if (watchedValues.destination || watchedValues.travel_style) {\n      updatedSteps[0].status = 'in-progress';\n    }\n    \n    // Budget Planning\n    if (watchedValues.budget || watchedValues.budget_breakdown) {\n      updatedSteps[1].status = 'completed';\n      totalProgress += updatedSteps[1].points;\n      completedCount++;\n    }\n    \n    // Dates & Duration\n    if (watchedValues.start_date && watchedValues.end_date) {\n      updatedSteps[2].status = 'completed';\n      totalProgress += updatedSteps[2].points;\n      completedCount++;\n    } else if (watchedValues.start_date || watchedValues.end_date) {\n      updatedSteps[2].status = 'in-progress';\n    }\n    \n    // Activities Planning\n    if (planned_activities.length >= 3) {\n      updatedSteps[3].status = 'completed';\n      totalProgress += updatedSteps[3].points;\n      completedCount++;\n    } else if (planned_activities.length > 0) {\n      updatedSteps[3].status = 'in-progress';\n    }\n    \n    // Group Formation\n    if (watchedValues.max_participants && watchedValues.max_participants > 2) {\n      updatedSteps[4].status = 'completed';\n      totalProgress += updatedSteps[4].points;\n      completedCount++;\n    }\n    \n    // Logistics & Details\n    if (watchedValues.title && watchedValues.description) {\n      updatedSteps[5].status = 'completed';\n      totalProgress += updatedSteps[5].points;\n      completedCount++;\n    } else if (watchedValues.title || watchedValues.description) {\n      updatedSteps[5].status = 'in-progress';\n    }\n    \n    if (JSON.stringify(updatedSteps) !== JSON.stringify(roadmapSteps)) {\n      setRoadmapSteps(updatedSteps);\n    }\n    \n    return { progress: (totalProgress / 130) * 100, completedCount };\n  };\n\n  const { progress, completedCount } = calculateRoadmapProgress();\n\n  // Check achievements\n  useEffect(() => {\n    const newAchievements = [...achievements];\n    let newPoints = 0;\n    \n    // Budget Master achievement\n    if (watchedValues.budget_breakdown && typeof watchedValues.budget_breakdown === 'object' && !achievements.find(a => a.id === 'budget_master')?.unlocked) {\n      const budgetMaster = newAchievements.find(a => a.id === 'budget_master');\n      if (budgetMaster) {\n        budgetMaster.unlocked = true;\n        newPoints += 50;\n        toast({\n          title: \"üèÜ Conquista Desbloqueada!\",\n          description: \"Planejador Financeiro - Voc√™ detalhou seu or√ßamento completo!\",\n        });\n      }\n    }\n\n    // Social Butterfly achievement\n    if (watchedValues.max_participants && watchedValues.max_participants >= 6 && !achievements.find(a => a.id === 'social_butterfly')?.unlocked) {\n      const socialButterfly = newAchievements.find(a => a.id === 'social_butterfly');\n      if (socialButterfly) {\n        socialButterfly.unlocked = true;\n        newPoints += 30;\n        toast({\n          title: \"ü¶ã Conquista Desbloqueada!\",\n          description: \"Organizador Social - Viagem para grupos grandes!\",\n        });\n      }\n    }\n\n    // Adventurer achievement\n    if (watchedValues.travel_style === 'aventura' && !achievements.find(a => a.id === 'adventurer')?.unlocked) {\n      const adventurer = newAchievements.find(a => a.id === 'adventurer');\n      if (adventurer) {\n        adventurer.unlocked = true;\n        newPoints += 40;\n        toast({\n          title: \"üß≠ Conquista Desbloqueada!\",\n          description: \"Aventureiro - Pronto para a aventura!\",\n        });\n      }\n    }\n\n    if (newPoints > 0) {\n      setAchievements(newAchievements);\n      setTotalPoints(prev => prev + newPoints);\n      setShowConfetti(true);\n      setTimeout(() => setShowConfetti(false), 3000);\n    }\n  }, [watchedValues, achievements]);\n\n  const calculateTotalBudget = (breakdown: BudgetBreakdown): number => {\n    return Object.values(breakdown).reduce((total, amount) => total + (amount || 0), 0);\n  };\n\n  const calculateActivitiesCost = (activities: PlannedActivity[]): number => {\n    return activities.reduce((total, activity) => total + (activity.estimated_cost || 0), 0);\n  };\n\n  const calculateCostPerPerson = (totalBudget: number, participants: number): number => {\n    return participants > 0 ? Math.round(totalBudget / participants) : 0;\n  };\n\n  const createTripMutation = useMutation({\n    mutationFn: async (data: CreateTripForm) => {\n      const activitiesCost = calculateActivitiesCost(planned_activities);\n      const totalBudget = data.budget_breakdown && typeof data.budget_breakdown === 'object'\n        ? calculateTotalBudget(data.budget_breakdown as BudgetBreakdown) + activitiesCost\n        : (data.budget || 0) + activitiesCost;\n        \n      const tripData = {\n        ...data,\n        start_date: new Date(data.start_date),\n        end_date: new Date(data.end_date),\n        budget: totalBudget,\n        planned_activities: planned_activities,\n        destination_id: selectedDestinationId,\n        max_participants: data.max_participants,\n        travel_style: data.travel_style,\n      };\n      \n      const response = await apiRequest(\"POST\", \"/api/trips\", tripData);\n      \n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || \"Erro ao criar viagem\");\n      }\n      \n      return response.json();\n    },\n    onSuccess: () => {\n      // Invalidate all trip-related queries\n      queryClient.invalidateQueries({ queryKey: [\"/api/trips\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/my-trips\"] });\n      \n      // Also remove any cached queries to force fresh fetch\n      queryClient.removeQueries({ queryKey: [\"/api/my-trips\"] });\n      \n      setShowConfetti(true);\n      toast({\n        title: \"üéâ Viagem Criada com Sucesso!\",\n        description: \"Sua aventura est√° pronta! Outros viajantes j√° podem se juntar.\",\n      });\n      \n      setTimeout(() => {\n        navigate(\"/dashboard\");\n      }, 2000);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Erro ao criar viagem\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const onSubmit = (data: CreateTripForm) => {\n    // Final achievement unlock\n    const finalAchievement = achievements.find(a => a.id === 'first_trip');\n    if (finalAchievement && !finalAchievement.unlocked) {\n      finalAchievement.unlocked = true;\n      setTotalPoints(prev => prev + 100);\n    }\n    \n    createTripMutation.mutate(data);\n  };\n\n  // Removed old activity functions - now handled by AdvancedActivityManager\n\n  const travelStyles = [\n    { value: \"praia\", label: \"Praia\", icon: \"üèñÔ∏è\" },\n    { value: \"neve\", label: \"Neve\", icon: \"‚ùÑÔ∏è\" },\n    { value: \"cruzeiros\", label: \"Cruzeiros\", icon: \"üö¢\" },\n    { value: \"natureza\", label: \"Natureza e Ecoturismo\", icon: \"üåø\" },\n    { value: \"cultural\", label: \"Culturais e Hist√≥ricas\", icon: \"üèõÔ∏è\" },\n    { value: \"aventura\", label: \"Aventura\", icon: \"üèîÔ∏è\" },\n    { value: \"parques\", label: \"Parques Tem√°ticos\", icon: \"üé¢\" },\n    { value: \"urbanas\", label: \"Viagens Urbanas\", icon: \"üèôÔ∏è\" }\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50\">\n      <Navbar />\n      {showConfetti && <Confetti />}\n      \n      {/* Loading Overlay */}\n      <AnimatePresence>\n        {createTripMutation.isPending && (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center\"\n          >\n            <div className=\"bg-white/90 backdrop-blur rounded-2xl p-8 shadow-2xl\">\n              <LoadingSpinner variant=\"travel\" size=\"lg\" message=\"Criando sua aventura dos sonhos...\" />\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n      \n      <div className=\"container mx-auto px-4 py-8\">\n        <div className=\"max-w-4xl mx-auto\">\n          {/* Header with Progress */}\n          <motion.div \n            initial={{ opacity: 0, y: -20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"text-center mb-8\"\n          >\n            <div className=\"flex items-center justify-center space-x-2 mb-4\">\n              <motion.div\n                animate={{ rotate: 360 }}\n                transition={{ duration: 2, repeat: Infinity, ease: \"linear\" }}\n              >\n                <Plane className=\"h-8 w-8 text-primary\" />\n              </motion.div>\n              <span className=\"font-bold text-3xl bg-gradient-to-r from-primary to-purple-600 bg-clip-text text-transparent\">\n                Criar Nova Viagem\n              </span>\n            </div>\n            <p className=\"text-gray-600 mb-6\">Transforme seus sonhos em realidade com nossa plataforma gamificada</p>\n            \n            {/* Progress Bar */}\n            <div className=\"bg-white rounded-lg p-6 shadow-lg mb-6\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <div className=\"flex items-center gap-2\">\n                  <Target className=\"h-5 w-5 text-primary\" />\n                  <span className=\"font-semibold\">Progresso da Cria√ß√£o</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Star className=\"h-4 w-4 text-yellow-500\" />\n                  <span className=\"text-sm font-medium\">{totalPoints} pontos</span>\n                </div>\n              </div>\n              <Progress value={progress} className=\"h-3 mb-2\" />\n              <div className=\"flex justify-between text-sm text-gray-500\">\n                <span>{completedCount}/6 etapas conclu√≠das</span>\n                <span>{Math.round(progress)}% completo</span>\n              </div>\n            </div>\n\n            {/* Achievements */}\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8\">\n              {achievements.map((achievement) => (\n                <motion.div\n                  key={achievement.id}\n                  initial={{ scale: 0.8, opacity: 0.5 }}\n                  animate={{ \n                    scale: achievement.unlocked ? 1 : 0.8, \n                    opacity: achievement.unlocked ? 1 : 0.5 \n                  }}\n                  className={`p-4 rounded-lg border-2 ${\n                    achievement.unlocked \n                      ? 'bg-gradient-to-r from-yellow-100 to-orange-100 border-yellow-300' \n                      : 'bg-gray-50 border-gray-200'\n                  }`}\n                >\n                  <achievement.icon className={`h-6 w-6 mx-auto mb-2 ${\n                    achievement.unlocked ? 'text-yellow-600' : 'text-gray-400'\n                  }`} />\n                  <p className=\"text-xs font-medium text-center\">{achievement.title}</p>\n                </motion.div>\n              ))}\n            </div>\n          </motion.div>\n\n          <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n            {/* Main Form */}\n            <div className=\"lg:col-span-2\">\n              <Card className=\"shadow-xl border-0\">\n                <CardHeader className=\"bg-gradient-to-r from-primary to-purple-600 text-white\">\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Sparkles className=\"h-5 w-5\" />\n                    Detalhes da Viagem\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"p-6\">\n                  <Form {...form}>\n                    <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n                      {/* Step 1: Basic Info */}\n                      <motion.div\n                        initial={{ opacity: 0, x: -20 }}\n                        animate={{ opacity: 1, x: 0 }}\n                        transition={{ delay: 0.1 }}\n                      >\n                        <div className=\"flex items-center gap-2 mb-4\">\n                          <Badge variant=\"outline\" className=\"bg-blue-50\">\n                            <Globe className=\"h-3 w-3 mr-1\" />\n                            Etapa 1\n                          </Badge>\n                          <h3 className=\"text-lg font-semibold\">Informa√ß√µes B√°sicas</h3>\n                        </div>\n                        \n                        <div className=\"space-y-4\">\n                          <FormField\n                            control={form.control}\n                            name=\"title\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>T√≠tulo da Viagem</FormLabel>\n                                <FormControl>\n                                  <Input \n                                    placeholder=\"Ex: Aventura √âpica em Machu Picchu\" \n                                    {...field} \n                                    className=\"border-2 focus:border-primary\"\n                                  />\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={form.control}\n                            name=\"description\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>Descri√ß√£o da Aventura</FormLabel>\n                                <FormControl>\n                                  <Textarea \n                                    placeholder=\"Conte sobre sua viagem dos sonhos! O que voc√™s v√£o fazer? Que experi√™ncias incr√≠veis esperam por voc√™s?\"\n                                    className=\"min-h-[120px] border-2 focus:border-primary\"\n                                    {...field} \n                                  />\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n                        </div>\n                      </motion.div>\n\n                      <Separator />\n\n                      {/* Step 2: Destination */}\n                      <motion.div\n                        initial={{ opacity: 0, x: -20 }}\n                        animate={{ opacity: 1, x: 0 }}\n                        transition={{ delay: 0.2 }}\n                      >\n                        <div className=\"flex items-center gap-2 mb-4\">\n                          <Badge variant=\"outline\" className=\"bg-green-50\">\n                            <MapPin className=\"h-3 w-3 mr-1\" />\n                            Etapa 2\n                          </Badge>\n                          <h3 className=\"text-lg font-semibold\">Destino dos Sonhos</h3>\n                        </div>\n                        \n                        <FormField\n                          control={form.control}\n                          name=\"destination\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>Para onde vamos?</FormLabel>\n                              <FormControl>\n                                <PlacesAutocomplete\n                                  value={field.value}\n                                  onChange={field.onChange}\n                                  onDestinationSelect={(destination) => {\n                                    setSelectedDestinationId(destination.id);\n                                  }}\n                                  placeholder=\"Busque cidades incr√≠veis como S√£o Paulo, Paris, Tokyo...\"\n                                  className=\"border-2 focus:border-primary\"\n                                />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n\n                        <FormField\n                          control={form.control}\n                          name=\"travel_style\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>Estilo de Viagem</FormLabel>\n                              <Select onValueChange={field.onChange} defaultValue={field.value}>\n                                <FormControl>\n                                  <SelectTrigger className=\"border-2 focus:border-primary\">\n                                    <SelectValue placeholder=\"Escolha o estilo da sua aventura\" />\n                                  </SelectTrigger>\n                                </FormControl>\n                                <SelectContent>\n                                  {travelStyles.map((style) => (\n                                    <SelectItem key={style.value} value={style.value}>\n                                      <div className=\"flex items-center gap-2\">\n                                        <span>{style.icon}</span>\n                                        <span>{style.label}</span>\n                                      </div>\n                                    </SelectItem>\n                                  ))}\n                                </SelectContent>\n                              </Select>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n\n                        <FormField\n                          control={form.control}\n                          name=\"cover_image\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>Imagem da Viagem</FormLabel>\n                              <FormControl>\n                                <CoverImageSelector\n                                  currentImage={field.value}\n                                  onImageSelect={field.onChange}\n                                  trigger={\n                                    <Button \n                                      type=\"button\" \n                                      variant=\"outline\" \n                                      className=\"w-full border-2 border-dashed hover:border-primary\"\n                                    >\n                                      <Camera className=\"w-4 h-4 mr-2\" />\n                                      {field.value ? 'Alterar Imagem' : 'Escolher Imagem'}\n                                    </Button>\n                                  }\n                                />\n                              </FormControl>\n                              {field.value && (\n                                <div className=\"mt-2\">\n                                  <img \n                                    src={field.value} \n                                    alt=\"Preview da imagem selecionada\" \n                                    className=\"w-full h-32 object-cover rounded-md\"\n                                  />\n                                </div>\n                              )}\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                      </motion.div>\n\n                      <Separator />\n\n                      {/* Step 3: Dates */}\n                      <motion.div\n                        initial={{ opacity: 0, x: -20 }}\n                        animate={{ opacity: 1, x: 0 }}\n                        transition={{ delay: 0.3 }}\n                      >\n                        <div className=\"flex items-center gap-2 mb-4\">\n                          <Badge variant=\"outline\" className=\"bg-purple-50\">\n                            <Calendar className=\"h-3 w-3 mr-1\" />\n                            Etapa 3\n                          </Badge>\n                          <h3 className=\"text-lg font-semibold\">Quando Partir</h3>\n                        </div>\n                        \n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                          <FormField\n                            control={form.control}\n                            name=\"start_date\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>Data de In√≠cio</FormLabel>\n                                <FormControl>\n                                  <div className=\"relative\">\n                                    <Calendar className=\"absolute left-3 top-3 h-4 w-4 text-gray-500\" />\n                                    <Input \n                                      type=\"date\" \n                                      className=\"pl-10 border-2 focus:border-primary\" \n                                      {...field} \n                                    />\n                                  </div>\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n\n                          <FormField\n                            control={form.control}\n                            name=\"end_date\"\n                            render={({ field }) => (\n                              <FormItem>\n                                <FormLabel>Data de Fim</FormLabel>\n                                <FormControl>\n                                  <div className=\"relative\">\n                                    <Calendar className=\"absolute left-3 top-3 h-4 w-4 text-gray-500\" />\n                                    <Input \n                                      type=\"date\" \n                                      className=\"pl-10 border-2 focus:border-primary\" \n                                      {...field} \n                                    />\n                                  </div>\n                                </FormControl>\n                                <FormMessage />\n                              </FormItem>\n                            )}\n                          />\n                        </div>\n                      </motion.div>\n\n                      <Separator />\n\n                      {/* Step 4: Budget */}\n                      <motion.div\n                        initial={{ opacity: 0, x: -20 }}\n                        animate={{ opacity: 1, x: 0 }}\n                        transition={{ delay: 0.4 }}\n                      >\n                        <div className=\"flex items-center gap-2 mb-4\">\n                          <Badge variant=\"outline\" className=\"bg-yellow-50\">\n                            <DollarSign className=\"h-3 w-3 mr-1\" />\n                            Etapa 4\n                          </Badge>\n                          <h3 className=\"text-lg font-semibold\">Planejamento Financeiro</h3>\n                        </div>\n                        \n                        <div className=\"space-y-4\">\n                          <div className=\"flex items-center justify-between\">\n                            <span className=\"text-sm font-medium\">Or√ßamento Detalhado</span>\n                            <div className=\"flex items-center gap-2\">\n                              <span className=\"text-sm text-gray-600\">Simples</span>\n                              <Switch \n                                checked={showBudgetBreakdown}\n                                onCheckedChange={setShowBudgetBreakdown}\n                              />\n                              <span className=\"text-sm text-gray-600\">Detalhado</span>\n                            </div>\n                          </div>\n\n                          {!showBudgetBreakdown ? (\n                            <FormField\n                              control={form.control}\n                              name=\"budget\"\n                              render={({ field }) => (\n                                <FormItem>\n                                  <FormLabel>Or√ßamento Total da Viagem (R$)</FormLabel>\n                                  <FormControl>\n                                    <div className=\"relative\">\n                                      <DollarSign className=\"absolute left-3 top-3 h-4 w-4 text-gray-500\" />\n                                      <Input \n                                        type=\"number\" \n                                        placeholder=\"6000\" \n                                        className=\"pl-10 border-2 focus:border-primary\" \n                                        {...field}\n                                        onChange={(e) => field.onChange(parseInt(e.target.value) || undefined)}\n                                        value={field.value || \"\"}\n                                      />\n                                    </div>\n                                  </FormControl>\n                                  {field.value && form.watch('max_participants') && (\n                                    <div className=\"space-y-2\">\n                                      {calculateActivitiesCost(planned_activities) > 0 && (\n                                        <div className=\"bg-purple-50 p-3 rounded-lg\">\n                                          <p className=\"text-sm font-medium text-purple-900\">\n                                            üéØ Custo das Atividades: R$ {calculateActivitiesCost(planned_activities).toLocaleString('pt-BR')}\n                                          </p>\n                                        </div>\n                                      )}\n                                      <div className=\"bg-emerald-50 p-3 rounded-lg\">\n                                        <p className=\"text-sm font-medium text-emerald-900\">\n                                          üí∞ Total da Viagem: R$ {(field.value + calculateActivitiesCost(planned_activities)).toLocaleString('pt-BR')}\n                                        </p>\n                                      </div>\n                                      <div className=\"bg-blue-50 p-3 rounded-lg\">\n                                        <p className=\"text-sm font-medium text-blue-900\">\n                                          üë• Custo por pessoa: R$ {calculateCostPerPerson(field.value + calculateActivitiesCost(planned_activities), form.watch('max_participants')).toLocaleString('pt-BR')}\n                                        </p>\n                                      </div>\n                                    </div>\n                                  )}\n                                  <FormMessage />\n                                </FormItem>\n                              )}\n                            />\n                          ) : (\n                            <div className=\"space-y-4\">\n                              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                                {Object.entries(expenseCategories).filter(([key]) => key !== 'activities').map(([key, label]) => (\n                                  <FormField\n                                    key={key}\n                                    control={form.control}\n                                    name={`budget_breakdown.${key}` as any}\n                                    render={({ field }) => (\n                                      <FormItem>\n                                        <FormLabel className=\"text-sm\">{label}</FormLabel>\n                                        <FormControl>\n                                          <div className=\"relative\">\n                                            <DollarSign className=\"absolute left-3 top-3 h-3 w-3 text-gray-500\" />\n                                            <Input \n                                              type=\"number\" \n                                              placeholder=\"0\" \n                                              className=\"pl-10 text-sm border-2 focus:border-primary\" \n                                              {...field}\n                                              onChange={(e) => field.onChange(parseInt(e.target.value) || undefined)}\n                                              value={field.value || \"\"}\n                                            />\n                                          </div>\n                                        </FormControl>\n                                        <FormMessage />\n                                      </FormItem>\n                                    )}\n                                  />\n                                ))}\n                              </div>\n                              \n                              {form.watch('budget_breakdown') && (\n                                <div className=\"space-y-3\">\n                                  <div className=\"flex justify-between items-center p-4 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg border-2 border-blue-200\">\n                                    <span className=\"font-bold text-blue-900\">üíé Or√ßamento Base:</span>\n                                    <span className=\"text-xl font-bold text-blue-900\">\n                                      R$ {calculateTotalBudget(form.watch('budget_breakdown') || {}).toLocaleString('pt-BR')}\n                                    </span>\n                                  </div>\n                                  {calculateActivitiesCost(planned_activities) > 0 && (\n                                    <div className=\"flex justify-between items-center p-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg border-2 border-purple-200\">\n                                      <span className=\"font-bold text-purple-900\">üéØ Custo das Atividades:</span>\n                                      <span className=\"text-xl font-bold text-purple-900\">\n                                        R$ {calculateActivitiesCost(planned_activities).toLocaleString('pt-BR')}\n                                      </span>\n                                    </div>\n                                  )}\n                                  <div className=\"flex justify-between items-center p-4 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-lg border-2 border-emerald-300\">\n                                    <span className=\"font-bold text-emerald-900\">üí∞ Total da Viagem:</span>\n                                    <span className=\"text-2xl font-bold text-emerald-900\">\n                                      R$ {(calculateTotalBudget(form.watch('budget_breakdown') || {}) + calculateActivitiesCost(planned_activities)).toLocaleString('pt-BR')}\n                                    </span>\n                                  </div>\n                                  {form.watch('max_participants') && (calculateTotalBudget(form.watch('budget_breakdown') || {}) + calculateActivitiesCost(planned_activities)) > 0 && (\n                                    <div className=\"flex justify-between items-center p-4 bg-gradient-to-r from-green-50 to-emerald-50 rounded-lg border-2 border-green-200\">\n                                      <span className=\"font-bold text-green-900\">üë• Custo por Pessoa:</span>\n                                      <span className=\"text-xl font-bold text-green-900\">\n                                        R$ {calculateCostPerPerson(\n                                          calculateTotalBudget(form.watch('budget_breakdown') || {}) + calculateActivitiesCost(planned_activities), \n                                          form.watch('max_participants')\n                                        ).toLocaleString('pt-BR')}\n                                      </span>\n                                    </div>\n                                  )}\n                                </div>\n                              )}\n                            </div>\n                          )}\n                        </div>\n                      </motion.div>\n\n                      <Separator />\n\n                      {/* Step 5: Advanced Activities */}\n                      <motion.div\n                        initial={{ opacity: 0, x: -20 }}\n                        animate={{ opacity: 1, x: 0 }}\n                        transition={{ delay: 0.5 }}\n                      >\n                        <div className=\"flex items-center gap-2 mb-4\">\n                          <Badge variant=\"outline\" className=\"bg-orange-50\">\n                            <Camera className=\"h-3 w-3 mr-1\" />\n                            Etapa 5\n                          </Badge>\n                          <h3 className=\"text-lg font-semibold\">Atividades Planejadas</h3>\n                        </div>\n                        \n                        <AdvancedActivityManager\n                          activities={planned_activities}\n                          onActivitiesChange={setPlannedActivities}\n                          tripDestination={form.watch('destination')}\n                          tripParticipants={1}\n                          tripMaxParticipants={form.watch('max_participants') || 1}\n                          tripStartDate={form.watch('start_date')}\n                          tripEndDate={form.watch('end_date')}\n                          className=\"border-2 border-gray-200 rounded-lg p-4\"\n                        />\n                      </motion.div>\n\n                      <Separator />\n\n                      {/* Step 6: Group */}\n                      <motion.div\n                        initial={{ opacity: 0, x: -20 }}\n                        animate={{ opacity: 1, x: 0 }}\n                        transition={{ delay: 0.6 }}\n                      >\n                        <div className=\"flex items-center gap-2 mb-4\">\n                          <Badge variant=\"outline\" className=\"bg-indigo-50\">\n                            <Users className=\"h-3 w-3 mr-1\" />\n                            Etapa 6\n                          </Badge>\n                          <h3 className=\"text-lg font-semibold\">Companheiros de Viagem</h3>\n                        </div>\n                        \n                        <FormField\n                          control={form.control}\n                          name=\"max_participants\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>M√°ximo de Participantes</FormLabel>\n                              <FormControl>\n                                <div className=\"relative\">\n                                  <Users className=\"absolute left-3 top-3 h-4 w-4 text-gray-500\" />\n                                  <Input \n                                    type=\"number\" \n                                    min=\"2\" \n                                    max=\"20\" \n                                    className=\"pl-10 border-2 focus:border-primary\" \n                                    {...field}\n                                    onChange={(e) => field.onChange(parseInt(e.target.value) || 4)}\n                                  />\n                                </div>\n                              </FormControl>\n                              <p className=\"text-sm text-gray-600 mt-1\">\n                                üë• Grupos maiores desbloqueiam conquistas especiais!\n                              </p>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                      </motion.div>\n\n                      <Separator />\n\n                      {/* Submit Button */}\n                      <motion.div\n                        initial={{ opacity: 0, y: 20 }}\n                        animate={{ opacity: 1, y: 0 }}\n                        transition={{ delay: 0.7 }}\n                      >\n                        <Button \n                          type=\"submit\" \n                          size=\"lg\" \n                          className=\"w-full bg-gradient-to-r from-primary to-purple-600 hover:from-primary/90 hover:to-purple-700 text-white font-bold py-4 text-lg shadow-lg\"\n                          disabled={createTripMutation.isPending}\n                        >\n                          {createTripMutation.isPending ? (\n                            <>\n                              <Clock className=\"mr-2 h-4 w-4 animate-spin\" />\n                              Criando sua aventura...\n                            </>\n                          ) : (\n                            <>\n                              <Sparkles className=\"mr-2 h-4 w-4\" />\n                              Criar Viagem dos Sonhos\n                            </>\n                          )}\n                        </Button>\n                      </motion.div>\n                    </form>\n                  </Form>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Sidebar */}\n            <div className=\"lg:col-span-1\">\n              <div className=\"sticky top-24 space-y-6\">\n                {/* Planning Roadmap */}\n                <Card className=\"shadow-lg\">\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <Compass className=\"h-5 w-5\" />\n                      Roadmap de Planejamento\n                    </CardTitle>\n                    <p className=\"text-sm text-gray-600\">Siga as melhores pr√°ticas para viagens</p>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-4\">\n                      {roadmapSteps.map((step, index) => {\n                        const Icon = step.icon;\n                        return (\n                          <motion.div\n                            key={step.id}\n                            initial={{ opacity: 0, x: -20 }}\n                            animate={{ opacity: 1, x: 0 }}\n                            transition={{ delay: index * 0.1 }}\n                            className={`relative flex items-start gap-3 p-3 rounded-lg border-2 transition-all ${\n                              step.status === 'completed' \n                                ? 'bg-green-50 border-green-200' \n                                : step.status === 'in-progress'\n                                ? 'bg-blue-50 border-blue-200'\n                                : 'bg-gray-50 border-gray-200'\n                            }`}\n                          >\n                            <div className={`flex items-center justify-center w-8 h-8 rounded-full ${\n                              step.status === 'completed' \n                                ? 'bg-green-500 text-white' \n                                : step.status === 'in-progress'\n                                ? 'bg-blue-500 text-white'\n                                : 'bg-gray-300 text-gray-600'\n                            }`}>\n                              {step.status === 'completed' ? (\n                                <CheckCircle className=\"h-4 w-4\" />\n                              ) : (\n                                <Icon className=\"h-4 w-4\" />\n                              )}\n                            </div>\n                            \n                            <div className=\"flex-1\">\n                              <h4 className={`text-sm font-semibold ${\n                                step.status === 'completed' ? 'text-green-800' : 'text-gray-800'\n                              }`}>\n                                {step.title}\n                              </h4>\n                              <p className=\"text-xs text-gray-600 mt-1\">{step.description}</p>\n                              {step.status === 'completed' && (\n                                <div className=\"flex items-center gap-1 mt-2\">\n                                  <Star className=\"h-3 w-3 text-yellow-500\" />\n                                  <span className=\"text-xs text-yellow-600 font-medium\">\n                                    +{step.points} pontos\n                                  </span>\n                                </div>\n                              )}\n                            </div>\n                          </motion.div>\n                        );\n                      })}\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Activities Summary */}\n                <Card className=\"shadow-lg border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50\">\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2 text-purple-800\">\n                      <Camera className=\"h-5 w-5\" />\n                      Resumo das Atividades\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-3\">\n                      <div className=\"flex justify-between items-center\">\n                        <span className=\"text-sm font-medium text-purple-700\">Total de Atividades:</span>\n                        <Badge variant=\"outline\" className=\"bg-purple-100 text-purple-800\">\n                          {planned_activities.length}\n                        </Badge>\n                      </div>\n                      <div className=\"flex justify-between items-center\">\n                        <span className=\"text-sm font-medium text-purple-700\">Custo Estimado:</span>\n                        <span className=\"text-sm font-bold text-purple-900\">\n                          R$ {calculateActivitiesCost(planned_activities).toLocaleString('pt-BR')}\n                        </span>\n                      </div>\n                      {planned_activities.length > 0 && (\n                        <div className=\"pt-2 border-t border-purple-200\">\n                          <p className=\"text-xs text-purple-600 mb-2\">Top 3 Atividades:</p>\n                          <div className=\"space-y-1\">\n                            {planned_activities.slice(0, 3).map((activity, index) => (\n                              <div key={activity.id} className=\"flex items-center gap-2 text-xs\">\n                                <span className=\"w-4 h-4 bg-purple-200 rounded-full flex items-center justify-center text-purple-800 font-bold\">\n                                  {index + 1}\n                                </span>\n                                <span className=\"truncate flex-1 text-purple-700\">{activity.title}</span>\n                              </div>\n                            ))}\n                          </div>\n                        </div>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Travel Tips */}\n                <Card className=\"shadow-lg border-yellow-200 bg-gradient-to-br from-yellow-50 to-orange-50\">\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-2 text-yellow-800\">\n                      <Zap className=\"h-5 w-5\" />\n                      Dicas de Planejamento\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-3 text-sm\">\n                      <div className=\"flex items-start gap-2\">\n                        <CheckCircle className=\"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0\" />\n                        <span>Pesquise sobre feriados e eventos locais</span>\n                      </div>\n                      <div className=\"flex items-start gap-2\">\n                        <CheckCircle className=\"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0\" />\n                        <span>Reserve pelo menos 20% do or√ßamento para emerg√™ncias</span>\n                      </div>\n                      <div className=\"flex items-start gap-2\">\n                        <CheckCircle className=\"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0\" />\n                        <span>Organize atividades por prioridade e proximidade</span>\n                      </div>\n                      <div className=\"flex items-start gap-2\">\n                        <CheckCircle className=\"h-4 w-4 text-green-600 mt-0.5 flex-shrink-0\" />\n                        <span>Considere seguro viagem para destinos internacionais</span>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default function CreateTripPage() {\n  return (\n    <ProtectedRoute>\n      <CreateTripPageContent />\n    </ProtectedRoute>\n  );\n}","size_bytes":51739},"client/src/pages/dashboard-page.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { ProtectedRoute } from \"@/lib/protected-route\";\nimport { Navbar } from \"@/components/navbar\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { OnboardingTour, useOnboardingTour } from \"@/components/onboarding-tour\";\nimport { WelcomeBanner } from \"@/components/welcome-banner\";\nimport { LoadingSpinner, DashboardSkeleton } from \"@/components/ui/loading-states\";\nimport { \n  Briefcase, \n  Users, \n  Calendar, \n  MapPin,\n  Plus,\n  MessageCircle,\n  Clock,\n  TrendingUp,\n  DollarSign,\n  Plane,\n  Star,\n  CheckCircle,\n  AlertCircle,\n  Eye,\n  Settings,\n  Bell,\n  Search,\n  Filter,\n  X\n} from \"lucide-react\";\nimport { getRealParticipantsCount } from \"@/lib/trip-utils\";\nimport { safeParseDate, getDaysUntilDate } from \"@/lib/date-utils\";\nimport { formatBrazilianCurrency } from \"@shared/utils\";\n\nexport default function DashboardPage() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [selectedTimeframe, setSelectedTimeframe] = useState('upcoming');\n  const [showWelcomeBanner, setShowWelcomeBanner] = useState(false);\n  \n  // Onboarding tour hook\n  const { isOpen, isCompleted, startTour, closeTour, completeTour } = useOnboardingTour();\n\n  // Check if user should see welcome banner (first time or hasn't completed tour)\n  useEffect(() => {\n    if (user && !isCompleted) {\n      // Check if user was created recently (within last 24 hours)\n      const welcomeBannerDismissed = localStorage.getItem('welcome-banner-dismissed');\n      if (!welcomeBannerDismissed) {\n        setShowWelcomeBanner(true);\n      }\n    }\n  }, [user, isCompleted]);\n\n  const { data: myTrips, isLoading: tripsLoading, error: tripsError, refetch: refetchTrips } = useQuery({\n    queryKey: [\"/api/my-trips\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/my-trips\", {\n        credentials: \"include\",\n      });\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n      return response.json();\n    },\n    enabled: !!user,\n    staleTime: 0, // Always fresh\n    refetchOnWindowFocus: true,\n    refetchOnMount: true,\n    retry: 2,\n    retryDelay: 1000,\n    refetchInterval: 5000, // Auto refresh every 5 seconds\n  });\n\n  const { data: requests, isLoading: requestsLoading, error: requestsError, refetch: refetchRequests } = useQuery({\n    queryKey: [\"/api/user-requests\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/user-requests\", {\n        credentials: \"include\",\n      });\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n      return response.json();\n    },\n    enabled: !!user,\n    staleTime: 0, // Always fresh\n    refetchOnWindowFocus: true,\n    refetchOnMount: true,\n    retry: 2,\n    refetchInterval: false,\n  });\n\n  // Mutation para desistir da viagem\n  const quitTripMutation = useMutation({\n    mutationFn: async (tripId: number) => {\n      const response = await fetch(`/api/trips/${tripId}/participants/${user?.id}`, {\n        method: 'DELETE',\n        credentials: 'include',\n      });\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || 'Erro ao sair da viagem');\n      }\n      return response.json();\n    },\n    onSuccess: (data, tripId) => {\n      toast({\n        title: \"Sa√≠da confirmada!\",\n        description: data.message,\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/my-trips\"] });\n    },\n    onError: (error) => {\n      toast({\n        title: \"Erro ao sair da viagem\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const createdTrips = (myTrips as any)?.created || [];\n  const participatingTrips = (myTrips as any)?.participating || [];\n  const pendingRequests = (requests as any)?.filter((r: any) => r.status === 'pending') || [];\n  const allTrips = [...createdTrips, ...participatingTrips];\n\n  // Debug logging\n  console.log('Dashboard Debug:', {\n    user: user?.username,\n    myTrips,\n    myTripsType: typeof myTrips,\n    myTripsKeys: myTrips ? Object.keys(myTrips) : null,\n    createdTrips: createdTrips.length,\n    participatingTrips: participatingTrips.length,\n    tripsError: tripsError?.message,\n    requestsError: requestsError?.message,\n    tripsLoading,\n    requestsLoading\n  });\n\n  // Show toast on errors\n  useEffect(() => {\n    if (tripsError) {\n      console.error('Trips error:', tripsError);\n      toast({\n        title: \"Erro ao carregar viagens\",\n        description: \"N√£o foi poss√≠vel carregar suas viagens. Tente novamente.\",\n        variant: \"destructive\"\n      });\n    }\n    if (requestsError) {\n      console.error('Requests error:', requestsError);\n      toast({\n        title: \"Erro ao carregar solicita√ß√µes\",\n        description: \"N√£o foi poss√≠vel carregar suas solicita√ß√µes. Tente novamente.\",\n        variant: \"destructive\"\n      });\n    }\n  }, [tripsError, requestsError, toast]);\n\n  // Manual refetch only on user change\n  useEffect(() => {\n    if (user) {\n      console.log('Usu√°rio autenticado, for√ßando refetch...');\n      refetchTrips();\n      refetchRequests();\n    }\n  }, [user?.id, refetchTrips, refetchRequests]);\n\n  // Calculate trip statistics\n  const upcomingTrips = allTrips.filter(trip => {\n    const startDate = safeParseDate(trip.start_date || trip.startDate);\n    return startDate > new Date();\n  });\n  const completedTrips = allTrips.filter(trip => {\n    const endDate = safeParseDate(trip.end_date || trip.endDate);\n    return endDate < new Date();\n  });\n  const inProgressTrips = allTrips.filter(trip => {\n    const now = new Date();\n    const startDate = safeParseDate(trip.start_date || trip.startDate);\n    const endDate = safeParseDate(trip.end_date || trip.endDate);\n    return startDate <= now && endDate >= now;\n  });\n\n  const totalBudget = allTrips.reduce((sum, trip) => sum + (trip.budget || 0), 0);\n  const totalParticipants = allTrips.reduce((sum, trip) => sum + getRealParticipantsCount(trip), 0);\n\n  // Get next trip\n  const nextTrip = upcomingTrips.sort((a, b) => {\n    const dateA = safeParseDate(a.start_date || a.startDate);\n    const dateB = safeParseDate(b.start_date || b.startDate);\n    return dateA.getTime() - dateB.getTime();\n  })[0];\n\n  // Calculate days until next trip\n  const daysUntilNextTrip = nextTrip ? getDaysUntilDate(nextTrip.start_date || nextTrip.startDate) : 0;\n\n  // Filter trips by timeframe\n  const getFilteredTrips = () => {\n    switch (selectedTimeframe) {\n      case 'upcoming':\n        return upcomingTrips;\n      case 'completed':\n        return completedTrips;\n      case 'in-progress':\n        return inProgressTrips;\n      default:\n        return allTrips;\n    }\n  };\n\n  return (\n    <ProtectedRoute>\n      <div className=\"min-h-screen bg-gradient-to-br from-orange-50 via-white to-amber-50\">\n        <Navbar />\n\n        <div className=\"container mx-auto px-4 py-8\">\n          {/* Welcome Banner */}\n          <WelcomeBanner\n            userName={user?.full_name?.split(' ')[0]}\n            onStartTour={startTour}\n            onDismiss={() => {\n              setShowWelcomeBanner(false);\n              localStorage.setItem('welcome-banner-dismissed', 'true');\n            }}\n            isVisible={showWelcomeBanner}\n          />\n\n          {/* Header Section */}\n          <div className=\"mb-8\">\n            <div className=\"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4\">\n              <div className=\"flex items-center gap-4\">\n                <Avatar className=\"w-16 h-16\">\n                  <AvatarImage src={user?.profile_photo || \"\"} />\n                  <AvatarFallback className=\"text-lg bg-gradient-to-br from-orange-400 to-amber-400 text-white\">\n                    {user?.full_name?.split(' ').map((n: string) => n[0]).join('').toUpperCase()}\n                  </AvatarFallback>\n                </Avatar>\n                <div>\n                  <h1 className=\"font-bold text-3xl text-gray-900\">\n                    Ol√°, {user?.full_name?.split(' ')[0]}! üëã\n                  </h1>\n                  <p className=\"text-gray-600 flex items-center gap-2\">\n                    <MapPin className=\"h-4 w-4\" />\n                    {user?.location || \"Localiza√ß√£o n√£o informada\"}\n                  </p>\n                </div>\n              </div>\n              <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-3 mt-4 w-full lg:w-auto\">\n                <Link href=\"/create-trip\">\n                  <Button className=\"w-full h-10 sm:h-12 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105\">\n                    <Plus className=\"h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                    <span className=\"font-medium text-sm sm:text-base hidden sm:inline\">Criar Viagem</span>\n                    <span className=\"font-medium text-sm sm:hidden\">Nova</span>\n                  </Button>\n                </Link>\n                \n                <Link href=\"/search\">\n                  <Button className=\"w-full h-10 sm:h-12 bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105\">\n                    <Search className=\"h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                    <span className=\"font-medium text-sm sm:text-base\">Buscar</span>\n                  </Button>\n                </Link>\n                \n                <Link href=\"/profile\">\n                  <Button className=\"w-full h-10 sm:h-12 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105\">\n                    <Settings className=\"h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                    <span className=\"font-medium text-sm sm:text-base\">Perfil</span>\n                  </Button>\n                </Link>\n                \n                <Popover>\n                  <PopoverTrigger asChild>\n                    <Button className=\"w-full h-10 sm:h-12 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105 relative\">\n                      <Bell className=\"h-4 w-4 sm:h-5 sm:w-5 mr-1 sm:mr-2\" />\n                      <span className=\"font-medium text-sm sm:text-base hidden sm:inline\">Notifica√ß√µes</span>\n                      <span className=\"font-medium text-sm sm:hidden\">Avisos</span>\n                      {(upcomingTrips.length > 0 || pendingRequests.length > 0) && (\n                        <Badge className=\"absolute -top-2 -right-2 w-4 h-4 sm:w-5 sm:h-5 p-0 text-xs bg-red-500 hover:bg-red-600 text-white border-0 rounded-full flex items-center justify-center\">\n                          {upcomingTrips.length + pendingRequests.length}\n                        </Badge>\n                      )}\n                    </Button>\n                  </PopoverTrigger>\n                  <PopoverContent className=\"w-80 p-0\" align=\"start\">\n                    <div className=\"bg-white rounded-lg shadow-lg border\">\n                      <div className=\"px-4 py-3 border-b bg-gradient-to-r from-purple-500 to-pink-500 text-white\">\n                        <h3 className=\"font-semibold flex items-center gap-2\">\n                          <Bell className=\"h-4 w-4\" />\n                          Notifica√ß√µes\n                        </h3>\n                      </div>\n                      <div className=\"max-h-96 overflow-y-auto\">\n                        {upcomingTrips.length === 0 && pendingRequests.length === 0 ? (\n                          <div className=\"p-4 text-center text-gray-500\">\n                            <Bell className=\"h-8 w-8 mx-auto mb-2 text-gray-300\" />\n                            <p>Nenhuma notifica√ß√£o</p>\n                          </div>\n                        ) : (\n                          <div className=\"space-y-1\">\n                            {upcomingTrips.slice(0, 3).map((trip: any) => (\n                              <div key={trip.id} className=\"p-3 hover:bg-gray-50 border-b last:border-b-0\">\n                                <div className=\"flex items-start gap-3\">\n                                  <div className=\"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0\"></div>\n                                  <div className=\"flex-1\">\n                                    <p className=\"font-medium text-sm text-gray-900\">{trip.title}</p>\n                                    <p className=\"text-xs text-gray-600 mt-1\">\n                                      Viagem em {getDaysUntilDate(trip.start_date || trip.startDate)} dias\n                                    </p>\n                                    <p className=\"text-xs text-gray-500 flex items-center gap-1 mt-1\">\n                                      <Calendar className=\"h-3 w-3\" />\n                                      {safeParseDate(trip.start_date || trip.startDate).toLocaleDateString('pt-BR')}\n                                    </p>\n                                  </div>\n                                </div>\n                              </div>\n                            ))}\n                            {pendingRequests.map((request: any) => (\n                              <div key={request.id} className=\"p-3 hover:bg-gray-50 border-b last:border-b-0\">\n                                <div className=\"flex items-start gap-3\">\n                                  <div className=\"w-2 h-2 bg-orange-500 rounded-full mt-2 flex-shrink-0\"></div>\n                                  <div className=\"flex-1\">\n                                    <p className=\"font-medium text-sm text-gray-900\">Solicita√ß√£o pendente</p>\n                                    <p className=\"text-xs text-gray-600 mt-1\">\n                                      {request.trip?.title}\n                                    </p>\n                                    <p className=\"text-xs text-gray-500\">Aguardando aprova√ß√£o</p>\n                                  </div>\n                                </div>\n                              </div>\n                            ))}\n                          </div>\n                        )}\n                      </div>\n                      {(upcomingTrips.length > 3 || pendingRequests.length > 0) && (\n                        <div className=\"px-4 py-3 border-t bg-gray-50\">\n                          <Button size=\"sm\" variant=\"outline\" className=\"w-full text-xs\">\n                            Ver todas as notifica√ß√µes\n                          </Button>\n                        </div>\n                      )}\n                    </div>\n                  </PopoverContent>\n                </Popover>\n              </div>\n            </div>\n          </div>\n\n          {/* Next Trip Highlight */}\n          {nextTrip && (\n            <Card className=\"mb-8 bg-gradient-to-r from-orange-500 to-amber-500 text-white border-0\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"bg-white bg-opacity-20 p-3 rounded-full\">\n                      <Plane className=\"h-8 w-8\" />\n                    </div>\n                    <div>\n                      <h3 className=\"font-semibold text-lg\">Pr√≥xima Viagem</h3>\n                      <p className=\"text-xl font-bold\">{nextTrip.title}</p>\n                      <p className=\"text-orange-100 flex items-center gap-2\">\n                        <Calendar className=\"h-4 w-4\" />\n                        {safeParseDate(nextTrip.start_date || nextTrip.startDate).toLocaleDateString('pt-BR')}\n                      </p>\n                    </div>\n                  </div>\n                  <div className=\"text-right\">\n                    <p className=\"text-3xl font-bold\">{daysUntilNextTrip}</p>\n                    <p className=\"text-orange-100\">dias restantes</p>\n                  </div>\n                </div>\n                <div className=\"mt-4\">\n                  <div className=\"flex justify-between text-sm mb-2\">\n                    <span>Progresso de prepara√ß√£o</span>\n                    <span>75%</span>\n                  </div>\n                  <Progress value={75} className=\"h-2 bg-white bg-opacity-20\" />\n                </div>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Stats Dashboard - Modern Clean Design */}\n          <div className=\"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6 mb-8\">\n            {/* Total de Viagens */}\n            <Card className=\"group bg-white border border-slate-200/60 shadow-sm hover:shadow-lg transition-all duration-300 hover:-translate-y-1 hover:border-blue-300/60\">\n              <CardContent className=\"p-3 sm:p-4 lg:p-5\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"bg-blue-50 p-2.5 rounded-xl group-hover:bg-blue-100 transition-colors duration-200\">\n                    <Briefcase className=\"h-5 w-5 text-blue-600\" />\n                  </div>\n                  <div>\n                    <p className=\"text-xl sm:text-2xl font-bold text-slate-900\">{allTrips.length}</p>\n                    <p className=\"text-xs sm:text-sm text-slate-600 font-medium\">Total de Viagens</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Pr√≥ximas Viagens */}\n            <Card className=\"group bg-white border border-slate-200/60 shadow-sm hover:shadow-lg transition-all duration-300 hover:-translate-y-1 hover:border-emerald-300/60\">\n              <CardContent className=\"p-3 sm:p-4 lg:p-5\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"bg-emerald-50 p-2.5 rounded-xl group-hover:bg-emerald-100 transition-colors duration-200\">\n                    <Clock className=\"h-5 w-5 text-emerald-600\" />\n                  </div>\n                  <div>\n                    <p className=\"text-xl sm:text-2xl font-bold text-slate-900\">{upcomingTrips.length}</p>\n                    <p className=\"text-xs sm:text-sm text-slate-600 font-medium\">Pr√≥ximas Viagens</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Companheiros */}\n            <Card className=\"group bg-white border border-slate-200/60 shadow-sm hover:shadow-lg transition-all duration-300 hover:-translate-y-1 hover:border-violet-300/60\">\n              <CardContent className=\"p-3 sm:p-4 lg:p-5\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"bg-violet-50 p-2.5 rounded-xl group-hover:bg-violet-100 transition-colors duration-200\">\n                    <Users className=\"h-5 w-5 text-violet-600\" />\n                  </div>\n                  <div>\n                    <p className=\"text-xl sm:text-2xl font-bold text-slate-900\">{totalParticipants}</p>\n                    <p className=\"text-xs sm:text-sm text-slate-600 font-medium\">Companheiros</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Or√ßamento Total */}\n            <Card className=\"group bg-white border border-slate-200/60 shadow-sm hover:shadow-lg transition-all duration-300 hover:-translate-y-1 hover:border-blue-300\">\n              <CardContent className=\"p-3 sm:p-4 lg:p-5\">\n                <div className=\"flex items-center gap-3\">\n                  <div className=\"bg-blue-50 p-2.5 rounded-xl group-hover:bg-blue-100 transition-colors duration-200\">\n                    <DollarSign className=\"h-5 w-5 text-blue-600\" />\n                  </div>\n                  <div>\n                    <p className=\"text-lg sm:text-xl font-bold text-slate-900\">{formatBrazilianCurrency(totalBudget)}</p>\n                    <p className=\"text-xs sm:text-sm text-slate-600 font-medium\">Or√ßamento Total</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n\n          \n\n          {/* Clean Filter Section */}\n          <div className=\"mb-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"font-medium text-slate-700\">Filtrar por status</h3>\n              <span className=\"text-sm text-slate-500\">\n                {getFilteredTrips().length} viagens\n              </span>\n            </div>\n            \n            {/* Simple Filter Tabs */}\n            <div className=\"flex gap-1 p-1 bg-slate-100 rounded-lg overflow-x-auto\">\n              {[\n                { id: 'all', label: 'Todas', count: allTrips.length, color: 'blue' },\n                { id: 'upcoming', label: 'Pr√≥ximas', count: upcomingTrips.length, color: 'emerald' },\n                { id: 'in-progress', label: 'Em Andamento', count: inProgressTrips.length, color: 'orange' },\n                { id: 'completed', label: 'Conclu√≠das', count: completedTrips.length, color: 'slate' }\n              ].map(filter => (\n                <button\n                  key={filter.id}\n                  onClick={() => setSelectedTimeframe(filter.id)}\n                  className={`flex-1 flex items-center justify-center gap-1.5 px-2 sm:px-3 py-2 sm:py-2.5 rounded-md text-xs sm:text-sm font-medium transition-all duration-200 whitespace-nowrap min-w-0 ${\n                    selectedTimeframe === filter.id\n                      ? 'bg-white text-slate-900 shadow-sm'\n                      : 'text-slate-600 hover:text-slate-900 hover:bg-white/60'\n                  }`}\n                >\n                  <span className=\"truncate\">{filter.label}</span>\n                  <span className={`px-1 sm:px-1.5 py-0.5 rounded text-xs font-semibold flex-shrink-0 ${\n                    selectedTimeframe === filter.id\n                      ? filter.color === 'blue' \n                        ? 'bg-blue-100 text-blue-700'\n                        : filter.color === 'emerald'\n                        ? 'bg-emerald-100 text-emerald-700'\n                        : filter.color === 'orange'\n                        ? 'bg-orange-100 text-orange-700'\n                        : 'bg-slate-100 text-slate-700'\n                      : filter.color === 'blue'\n                      ? 'bg-blue-200 text-blue-800'\n                      : filter.color === 'emerald'\n                      ? 'bg-emerald-200 text-emerald-800'\n                      : filter.color === 'orange'\n                      ? 'bg-orange-200 text-orange-800'\n                      : 'bg-slate-200 text-slate-700'\n                  }`}>\n                    {filter.count}\n                  </span>\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Error State */}\n          {tripsError && (\n            <Card className=\"mb-6 border-red-200 bg-red-50\">\n              <CardContent className=\"p-6\">\n                <div className=\"flex items-center gap-2 text-red-700\">\n                  <AlertCircle className=\"h-5 w-5\" />\n                  <span className=\"font-medium\">Erro ao carregar viagens</span>\n                </div>\n                <p className=\"text-red-600 mt-2\">\n                  Houve um problema ao carregar suas viagens. Tente atualizar a p√°gina.\n                </p>\n              </CardContent>\n            </Card>\n          )}\n\n          {/* Trips Grid */}\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6\">\n            {tripsLoading ? (\n              <div className=\"col-span-full flex items-center justify-center min-h-[300px]\">\n                <LoadingSpinner size=\"lg\" />\n              </div>\n            ) : !tripsError && getFilteredTrips().length > 0 ? (\n              getFilteredTrips().map((trip: any) => (\n                <Card key={trip.id} className=\"group hover:shadow-xl hover:-translate-y-1 transition-all duration-300 overflow-hidden border border-slate-200/60 bg-white shadow-sm\">\n                  {/* Cover Image */}\n                  <div className=\"relative h-44 bg-gradient-to-br from-slate-100 to-slate-200 overflow-hidden\">\n                    {trip.cover_image && (\n                      <img \n                        src={trip.cover_image} \n                        alt={trip.title}\n                        className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500\"\n                      />\n                    )}\n                    <div className=\"absolute inset-0 bg-gradient-to-t from-black/50 via-black/10 to-transparent\" />\n                    \n                    {/* Status Badge */}\n                    <div className=\"absolute top-3 right-3\">\n                      {safeParseDate(trip.start_date || trip.startDate) > new Date() ? (\n                        <Badge className=\"bg-emerald-500/90 backdrop-blur-sm hover:bg-emerald-600 text-white border-0 shadow-sm\">\n                          <Clock className=\"h-3 w-3 mr-1\" />\n                          Pr√≥xima\n                        </Badge>\n                      ) : new Date(trip.endDate) < new Date() ? (\n                        <Badge className=\"bg-slate-500/90 backdrop-blur-sm hover:bg-slate-600 text-white border-0 shadow-sm\">\n                          <CheckCircle className=\"h-3 w-3 mr-1\" />\n                          Conclu√≠da\n                        </Badge>\n                      ) : (\n                        <Badge className=\"bg-blue-500/90 backdrop-blur-sm hover:bg-blue-600 text-white border-0 shadow-sm\">\n                          <AlertCircle className=\"h-3 w-3 mr-1\" />\n                          Em Andamento\n                        </Badge>\n                      )}\n                    </div>\n\n                    {/* Role Badge */}\n                    <div className=\"absolute top-3 left-3\">\n                      <Badge \n                        className={trip.creator_id === user?.id \n                          ? \"bg-blue-600/90 backdrop-blur-sm hover:bg-blue-700 text-white border-0 shadow-sm\" \n                          : \"bg-white/90 backdrop-blur-sm text-slate-700 hover:bg-white border-0 shadow-sm\"}\n                      >\n                        {trip.creator_id === user?.id ? 'Criada por voc√™' : 'Participando'}\n                      </Badge>\n                    </div>\n\n                    {/* Title overlay */}\n                    <div className=\"absolute bottom-3 left-3 right-3\">\n                      <h3 className=\"font-bold text-lg text-white mb-1 group-hover:text-blue-200 transition-colors drop-shadow-sm\">\n                        {trip.title}\n                      </h3>\n                      <p className=\"text-white/90 flex items-center gap-2 text-sm drop-shadow-sm\">\n                        <MapPin className=\"h-3.5 w-3.5\" />\n                        {trip.destination}\n                      </p>\n                    </div>\n                  </div>\n\n                  <CardContent className=\"p-5\">\n                    {/* Trip Info */}\n                    <div className=\"space-y-3 mb-5\">\n                      <div className=\"flex items-center gap-2 text-sm text-slate-600\">\n                        <Calendar className=\"h-4 w-4 text-blue-500\" />\n                        <span className=\"font-medium\">\n                          {safeParseDate(trip.start_date || trip.startDate).toLocaleDateString('pt-BR')} - {safeParseDate(trip.end_date || trip.endDate).toLocaleDateString('pt-BR')}\n                        </span>\n                      </div>\n                      \n                      <div className=\"flex items-center justify-between\">\n                        <div className=\"flex items-center gap-2 text-sm text-slate-600\">\n                          <Users className=\"h-4 w-4 text-blue-500\" />\n                          <span>{getRealParticipantsCount(trip)}/{trip.max_participants} participantes</span>\n                        </div>\n                        \n                        {/* Participants Progress */}\n                        <div className=\"flex-1 mx-3\">\n                          <div className=\"w-full bg-slate-200 rounded-full h-1.5\">\n                            <div \n                              className=\"bg-gradient-to-r from-blue-500 to-blue-600 h-1.5 rounded-full transition-all duration-300\"\n                              style={{ width: `${(getRealParticipantsCount(trip) / trip.max_participants) * 100}%` }}\n                            />\n                          </div>\n                        </div>\n                      </div>\n\n                      {trip.budget && (\n                        <div className=\"flex items-center gap-2 text-sm text-slate-600\">\n                          <DollarSign className=\"h-4 w-4 text-blue-500\" />\n                          <span className=\"font-semibold text-slate-900\">\n                            {formatBrazilianCurrency(trip.budget)}\n                          </span>\n                          <span className=\"text-slate-500\">\n                            / {formatBrazilianCurrency(Math.round(trip.budget / trip.max_participants))} por pessoa\n                          </span>\n                        </div>\n                      )}\n                    </div>\n\n                    {/* Action Buttons - Responsive & Clean */}\n                    <div className=\"flex flex-col gap-2\">\n                      {/* Primary Action - Full width on mobile */}\n                      <Link href={`/trip/${trip.id}`} className=\"w-full\">\n                        <Button \n                          size=\"sm\" \n                          className=\"w-full bg-blue-600 hover:bg-blue-700 text-white border-0 transition-colors duration-200\"\n                        >\n                          <Eye className=\"h-3 w-3 mr-1.5\" />\n                          <span className=\"text-xs\">Ver Detalhes</span>\n                        </Button>\n                      </Link>\n                      \n                      {/* Secondary Actions - Two rows on mobile for better spacing */}\n                      <div className=\"grid grid-cols-2 gap-1.5\">\n                        {/* Chat always visible */}\n                        <Link href={`/chat/${trip.id}`} className=\"w-full\">\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\" \n                            className=\"w-full border-slate-300 text-slate-700 hover:bg-slate-50 hover:text-slate-900 transition-colors duration-200\"\n                          >\n                            <MessageCircle className=\"h-3 w-3 mr-1\" />\n                            <span className=\"text-xs\">Chat</span>\n                          </Button>\n                        </Link>\n                        \n                        {/* Conditional buttons based on user role */}\n                        {trip.creator_id === user?.id ? (\n                          <Link href={`/edit-trip/${trip.id}`} className=\"w-full\">\n                            <Button \n                              size=\"sm\" \n                              variant=\"outline\"\n                              className=\"w-full border-slate-300 text-slate-700 hover:bg-slate-50 hover:text-slate-900 transition-colors duration-200\"\n                            >\n                              <Settings className=\"h-3 w-3 mr-1\" />\n                              <span className=\"text-xs\">Editar</span>\n                            </Button>\n                          </Link>\n                        ) : (\n                          <Button \n                            size=\"sm\" \n                            variant=\"outline\"\n                            className=\"w-full text-red-600 border-red-300 hover:bg-red-50 hover:text-red-700 hover:border-red-400 transition-colors duration-200\"\n                            onClick={() => {\n                              if (window.confirm(`Tem certeza que deseja sair da viagem \"${trip.title}\"? Esta a√ß√£o n√£o pode ser desfeita.`)) {\n                                quitTripMutation.mutate(trip.id);\n                              }\n                            }}\n                            disabled={quitTripMutation.isPending}\n                          >\n                            {quitTripMutation.isPending ? (\n                              <>\n                                <div className=\"w-3 h-3 border-2 border-red-600 border-t-transparent rounded-full animate-spin mr-1\" />\n                                <span className=\"text-xs\">...</span>\n                              </>\n                            ) : (\n                              <>\n                                <X className=\"h-3 w-3 mr-1\" />\n                                <span className=\"text-xs\">Sair</span>\n                              </>\n                            )}\n                          </Button>\n                        )}\n                      </div>\n                      \n                      {/* Cancel button for creators - separate row */}\n                      {trip.creator_id === user?.id && (\n                        <Button \n                          size=\"sm\" \n                          variant=\"outline\"\n                          className=\"w-full text-red-600 border-red-300 hover:bg-red-50 hover:text-red-700 hover:border-red-400 transition-colors duration-200\"\n                          onClick={() => {\n                            const hasOtherParticipants = getRealParticipantsCount(trip) > 1;\n                            let confirmMessage = '';\n                            if (hasOtherParticipants) {\n                              confirmMessage = `Como criador da viagem \"${trip.title}\", ao cancelar voc√™ transferir√° a organiza√ß√£o para o participante mais antigo. Confirma?`;\n                            } else {\n                              confirmMessage = `Como criador da viagem \"${trip.title}\" sem outros participantes, ao cancelar a viagem ser√° exclu√≠da permanentemente. Confirma?`;\n                            }\n                            \n                            if (window.confirm(confirmMessage)) {\n                              quitTripMutation.mutate(trip.id);\n                            }\n                          }}\n                          disabled={quitTripMutation.isPending}\n                        >\n                          {quitTripMutation.isPending ? (\n                            <>\n                              <div className=\"w-3 h-3 border-2 border-red-600 border-t-transparent rounded-full animate-spin mr-1\" />\n                              <span className=\"text-xs\">Cancelando...</span>\n                            </>\n                          ) : (\n                            <>\n                              <X className=\"h-3 w-3 mr-1\" />\n                              <span className=\"text-xs\">Cancelar Viagem</span>\n                            </>\n                          )}\n                        </Button>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              ))\n            ) : (\n              <Card className=\"col-span-full border-2 border-dashed border-gray-200 bg-gray-50/50\">\n                <CardContent className=\"p-12 text-center\">\n                  <div className=\"mb-6\">\n                    <div className=\"w-24 h-24 bg-gradient-to-br from-orange-400 to-amber-500 rounded-full flex items-center justify-center mx-auto mb-4\">\n                      <Plane className=\"h-12 w-12 text-white\" />\n                    </div>\n                    <h3 className=\"text-2xl font-bold text-gray-700 mb-2\">\n                      Nenhuma viagem encontrada\n                    </h3>\n                    <p className=\"text-gray-600 mb-8 max-w-md mx-auto\">\n                      {selectedTimeframe === 'upcoming' && 'Voc√™ n√£o tem viagens pr√≥ximas planejadas. Que tal criar uma nova aventura?'}\n                      {selectedTimeframe === 'completed' && 'Voc√™ ainda n√£o concluiu nenhuma viagem. Suas pr√≥ximas aventuras aparecer√£o aqui.'}\n                      {selectedTimeframe === 'in-progress' && 'Voc√™ n√£o tem viagens em andamento. Suas viagens ativas aparecer√£o aqui.'}\n                      {selectedTimeframe === 'all' && 'Voc√™ ainda n√£o tem viagens. Comece sua jornada criando uma nova viagem ou encontre companheiros para aventuras incr√≠veis!'}\n                    </p>\n                  </div>\n                  <div className=\"flex flex-col sm:flex-row justify-center gap-3 sm:gap-4\">\n                    <Link href=\"/create-trip\" className=\"w-full sm:w-auto\">\n                      <Button className=\"w-full sm:w-auto bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white border-0 px-6 sm:px-8 py-3 h-auto\">\n                        <Plus className=\"h-4 w-4 sm:h-5 sm:w-5 mr-2\" />\n                        <span className=\"hidden sm:inline\">Criar Nova Viagem</span>\n                        <span className=\"sm:hidden\">Nova Viagem</span>\n                      </Button>\n                    </Link>\n                    <Link href=\"/search\" className=\"w-full sm:w-auto\">\n                      <Button variant=\"outline\" className=\"w-full sm:w-auto border-blue-200 text-blue-600 hover:bg-blue-50 hover:text-blue-700 px-6 sm:px-8 py-3 h-auto\">\n                        <Search className=\"h-4 w-4 sm:h-5 sm:w-5 mr-2\" />\n                        <span className=\"hidden sm:inline\">Buscar Companheiros</span>\n                        <span className=\"sm:hidden\">Buscar</span>\n                      </Button>\n                    </Link>\n                    <Link href=\"/profile\" className=\"w-full sm:w-auto\">\n                      <Button variant=\"outline\" className=\"w-full sm:w-auto border-blue-200 text-blue-600 hover:bg-blue-50 hover:text-blue-700 px-6 sm:px-8 py-3 h-auto\">\n                        <Settings className=\"h-4 w-4 sm:h-5 sm:w-5 mr-2\" />\n                        <span className=\"hidden sm:inline\">Editar Perfil</span>\n                        <span className=\"sm:hidden\">Perfil</span>\n                      </Button>\n                    </Link>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </div>\n\n          {/* Pending Requests */}\n          {pendingRequests.length > 0 && (\n            <Card className=\"mt-8 border-amber-200 bg-amber-50\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2 text-amber-800\">\n                  <Bell className=\"h-5 w-5\" />\n                  Solicita√ß√µes Pendentes\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-3\">\n                  {pendingRequests.map((request: any) => (\n                    <div key={request.id} className=\"flex items-center justify-between p-3 bg-white rounded-lg\">\n                      <div>\n                        <p className=\"font-medium text-gray-900\">{request.trip?.title}</p>\n                        <p className=\"text-sm text-gray-600\">Solicita√ß√£o enviada</p>\n                      </div>\n                      <Badge variant=\"outline\" className=\"text-blue-600 border-blue-600\">\n                        Pendente\n                      </Badge>\n                    </div>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n          )}\n        </div>\n\n        {/* Onboarding Tour */}\n        <OnboardingTour\n          isOpen={isOpen}\n          onClose={closeTour}\n          onComplete={completeTour}\n          userPreferences={{\n            travel_style: Array.isArray(user?.travel_styles) ? user.travel_styles.join(', ') : user?.travel_styles as string,\n            interests: user?.interests as string[] | undefined,\n            experience: 'iniciante' // Could be determined from user profile\n          }}\n        />\n      </div>\n    </ProtectedRoute>\n  );\n}","size_bytes":40591},"client/src/pages/edit-trip-page.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useParams, useLocation } from \"wouter\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { ProtectedRoute } from \"@/lib/protected-route\";\nimport { Navbar } from \"@/components/navbar\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { \n  ArrowLeft, \n  Save, \n  MapPin, \n  Calendar, \n  DollarSign, \n  Users, \n  Edit, \n  Trash2,\n  AlertTriangle\n} from \"lucide-react\";\nimport { getRealParticipantsCount } from \"@/lib/trip-utils\";\n\nexport default function EditTripPage() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [, setLocation] = useLocation();\n  const params = useParams();\n  const tripId = parseInt(params.id as string);\n\n  const [formData, setFormData] = useState({\n    title: '',\n    destination: '',\n    description: '',\n    start_date: '',\n    end_date: '',\n    budget: '',\n    max_participants: '',\n    travel_style: ''\n  });\n\n  // Fetch trip data\n  const { data: trip, isLoading: tripLoading, error: tripError } = useQuery({\n    queryKey: ['/api/trips', tripId],\n    queryFn: async () => {\n      const response = await apiRequest('GET', `/api/trips/${tripId}`);\n      return response.json();\n    },\n    enabled: !!tripId\n  });\n\n  // Update form when trip data loads\n  useEffect(() => {\n    if (trip) {\n      // Check if user is the creator\n      if (trip.creator_id !== user?.id) {\n        toast({\n          variant: \"destructive\",\n          title: \"Acesso negado\",\n          description: \"Apenas o criador da viagem pode edit√°-la.\"\n        });\n        setLocation('/dashboard');\n        return;\n      }\n\n      setFormData({\n        title: trip.title || '',\n        destination: trip.destination || '',\n        description: trip.description || '',\n        start_date: trip.start_date ? new Date(trip.start_date).toISOString().split('T')[0] : '',\n        end_date: trip.end_date ? new Date(trip.end_date).toISOString().split('T')[0] : '',\n        budget: trip.budget?.toString() || '',\n        max_participants: trip.max_participants?.toString() || '',\n        travel_style: trip.travel_style || ''\n      });\n    }\n  }, [trip, user?.id, setLocation, toast]);\n\n  // Update trip mutation\n  const updateTripMutation = useMutation({\n    mutationFn: async (data: any) => {\n      const response = await apiRequest('PATCH', `/api/trips/${tripId}`, data);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Viagem atualizada!\",\n        description: \"As altera√ß√µes foram salvas com sucesso.\"\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/trips'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/my-trips'] });\n      setLocation('/dashboard');\n    },\n    onError: (error: any) => {\n      toast({\n        variant: \"destructive\",\n        title: \"Erro ao atualizar viagem\",\n        description: error.message || \"Tente novamente mais tarde.\"\n      });\n    }\n  });\n\n  // Delete trip mutation\n  const deleteTripMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest('DELETE', `/api/trips/${tripId}`);\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Viagem exclu√≠da\",\n        description: \"A viagem foi removida permanentemente.\"\n      });\n      queryClient.invalidateQueries({ queryKey: ['/api/trips'] });\n      queryClient.invalidateQueries({ queryKey: ['/api/my-trips'] });\n      setLocation('/dashboard');\n    },\n    onError: (error: any) => {\n      toast({\n        variant: \"destructive\",\n        title: \"Erro ao excluir viagem\",\n        description: error.message || \"Tente novamente mais tarde.\"\n      });\n    }\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    // Validation\n    if (!formData.title.trim() || !formData.destination.trim() || !formData.start_date || !formData.end_date) {\n      toast({\n        variant: \"destructive\",\n        title: \"Campos obrigat√≥rios\",\n        description: \"Por favor, preencha todos os campos obrigat√≥rios.\"\n      });\n      return;\n    }\n\n    if (new Date(formData.start_date) >= new Date(formData.end_date)) {\n      toast({\n        variant: \"destructive\",\n        title: \"Datas inv√°lidas\",\n        description: \"A data de fim deve ser posterior √† data de in√≠cio.\"\n      });\n      return;\n    }\n\n    const data = {\n      ...formData,\n      budget: formData.budget ? parseInt(formData.budget) : 0,\n      max_participants: formData.max_participants ? parseInt(formData.max_participants) : 2\n    };\n\n    updateTripMutation.mutate(data);\n  };\n\n  const handleDelete = () => {\n    if (getRealParticipantsCount(trip) > 1) {\n      toast({\n        variant: \"destructive\",\n        title: \"N√£o √© poss√≠vel excluir\",\n        description: \"A viagem tem outros participantes. Use 'Cancelar' no dashboard para transferir a organiza√ß√£o.\"\n      });\n      return;\n    }\n\n    const confirmed = window.confirm(\n      `Tem certeza que deseja excluir permanentemente a viagem \"${trip?.title}\"? Esta a√ß√£o n√£o pode ser desfeita.`\n    );\n\n    if (confirmed) {\n      deleteTripMutation.mutate();\n    }\n  };\n\n  if (tripLoading) {\n    return (\n      <ProtectedRoute>\n        <div className=\"min-h-screen bg-gray-50\">\n          <Navbar />\n          <div className=\"container mx-auto px-4 py-8\">\n            <div className=\"max-w-2xl mx-auto\">\n              <div className=\"animate-pulse\">\n                <div className=\"h-8 bg-gray-200 rounded w-1/3 mb-6\"></div>\n                <div className=\"bg-white rounded-lg shadow p-6\">\n                  <div className=\"space-y-4\">\n                    <div className=\"h-4 bg-gray-200 rounded w-full\"></div>\n                    <div className=\"h-4 bg-gray-200 rounded w-3/4\"></div>\n                    <div className=\"h-4 bg-gray-200 rounded w-1/2\"></div>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </ProtectedRoute>\n    );\n  }\n\n  if (tripError || !trip) {\n    return (\n      <ProtectedRoute>\n        <div className=\"min-h-screen bg-gray-50\">\n          <Navbar />\n          <div className=\"container mx-auto px-4 py-8\">\n            <div className=\"max-w-2xl mx-auto text-center\">\n              <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">Viagem n√£o encontrada</h1>\n              <Button onClick={() => setLocation('/dashboard')}>\n                <ArrowLeft className=\"h-4 w-4 mr-2\" />\n                Voltar ao Dashboard\n              </Button>\n            </div>\n          </div>\n        </div>\n      </ProtectedRoute>\n    );\n  }\n\n  return (\n    <ProtectedRoute>\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50\">\n        <Navbar />\n        \n        <div className=\"container mx-auto px-4 py-8\">\n          <div className=\"max-w-4xl mx-auto\">\n            {/* Header */}\n            <div className=\"flex items-center gap-4 mb-8\">\n              <Button \n                variant=\"outline\" \n                onClick={() => setLocation('/dashboard')}\n                className=\"border-blue-200 text-blue-600 hover:bg-blue-50\"\n              >\n                <ArrowLeft className=\"h-4 w-4 mr-2\" />\n                Voltar\n              </Button>\n              <div>\n                <h1 className=\"text-3xl font-bold text-gray-900 flex items-center gap-2\">\n                  <Edit className=\"h-8 w-8 text-orange-500\" />\n                  Editar Viagem\n                </h1>\n                <p className=\"text-gray-600 mt-1\">Atualize os detalhes da sua viagem</p>\n              </div>\n            </div>\n\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n              {/* Form */}\n              <div className=\"lg:col-span-2\">\n                <Card className=\"shadow-lg border-0\">\n                  <CardHeader className=\"bg-gradient-to-r from-orange-500 to-amber-500 text-white\">\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <MapPin className=\"h-5 w-5\" />\n                      Informa√ß√µes da Viagem\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"p-6\">\n                    <form onSubmit={handleSubmit} className=\"space-y-6\">\n                      {/* Title */}\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          T√≠tulo da Viagem *\n                        </label>\n                        <Input\n                          value={formData.title}\n                          onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n                          placeholder=\"Ex: Aventura na Chapada Diamantina\"\n                          className=\"w-full\"\n                          required\n                        />\n                      </div>\n\n                      {/* Destination */}\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Destino *\n                        </label>\n                        <Input\n                          value={formData.destination}\n                          onChange={(e) => setFormData({ ...formData, destination: e.target.value })}\n                          placeholder=\"Ex: Chapada Diamantina, BA\"\n                          className=\"w-full\"\n                          required\n                        />\n                      </div>\n\n                      {/* Description */}\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Descri√ß√£o\n                        </label>\n                        <Textarea\n                          value={formData.description}\n                          onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                          placeholder=\"Descreva sua viagem, atividades planejadas, etc.\"\n                          rows={4}\n                          className=\"w-full\"\n                        />\n                      </div>\n\n                      {/* Dates */}\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                            Data de In√≠cio *\n                          </label>\n                          <Input\n                            type=\"date\"\n                            value={formData.start_date}\n                            onChange={(e) => setFormData({ ...formData, start_date: e.target.value })}\n                            min={new Date().toISOString().split('T')[0]}\n                            className=\"w-full\"\n                            required\n                          />\n                        </div>\n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                            Data de Fim *\n                          </label>\n                          <Input\n                            type=\"date\"\n                            value={formData.end_date}\n                            onChange={(e) => setFormData({ ...formData, end_date: e.target.value })}\n                            min={formData.start_date}\n                            className=\"w-full\"\n                            required\n                          />\n                        </div>\n                      </div>\n\n                      {/* Budget and Participants */}\n                      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                            Or√ßamento Total (R$)\n                          </label>\n                          <Input\n                            type=\"number\"\n                            value={formData.budget}\n                            onChange={(e) => setFormData({ ...formData, budget: e.target.value })}\n                            placeholder=\"2000\"\n                            min=\"0\"\n                            className=\"w-full\"\n                          />\n                        </div>\n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                            M√°ximo de Participantes\n                          </label>\n                          <Input\n                            type=\"number\"\n                            value={formData.max_participants}\n                            onChange={(e) => setFormData({ ...formData, max_participants: e.target.value })}\n                            placeholder=\"6\"\n                            min={getRealParticipantsCount(trip) || 1}\n                            className=\"w-full\"\n                          />\n                          <p className=\"text-xs text-gray-500 mt-1\">\n                            M√≠nimo: {getRealParticipantsCount(trip)} (participantes atuais)\n                          </p>\n                        </div>\n                      </div>\n\n                      {/* Travel Style */}\n                      <div>\n                        <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                          Estilo de Viagem\n                        </label>\n                        <Select value={formData.travel_style} onValueChange={(value) => setFormData({ ...formData, travel_style: value })}>\n                          <SelectTrigger className=\"w-full\">\n                            <SelectValue placeholder=\"Selecione o estilo da viagem\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            <SelectItem value=\"praia\">Praia</SelectItem>\n                            <SelectItem value=\"neve\">Neve</SelectItem>\n                            <SelectItem value=\"cruzeiros\">Cruzeiros</SelectItem>\n                            <SelectItem value=\"natureza\">Natureza e Ecoturismo</SelectItem>\n                            <SelectItem value=\"culturais\">Culturais e Hist√≥ricas</SelectItem>\n                            <SelectItem value=\"aventura\">Aventura</SelectItem>\n                            <SelectItem value=\"parques\">Parques Tem√°ticos</SelectItem>\n                            <SelectItem value=\"urbanas\">Viagens Urbanas / Cidades Grandes</SelectItem>\n                          </SelectContent>\n                        </Select>\n                      </div>\n\n                      {/* Action Buttons */}\n                      <div className=\"flex gap-4 pt-6\">\n                        <Button \n                          type=\"submit\" \n                          disabled={updateTripMutation.isPending}\n                          className=\"flex-1 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white border-0\"\n                        >\n                          {updateTripMutation.isPending ? (\n                            <>\n                              <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2\" />\n                              Salvando...\n                            </>\n                          ) : (\n                            <>\n                              <Save className=\"h-4 w-4 mr-2\" />\n                              Salvar Altera√ß√µes\n                            </>\n                          )}\n                        </Button>\n                        \n                        {trip?.current_participants === 1 && (\n                          <Button \n                            type=\"button\"\n                            variant=\"outline\"\n                            onClick={handleDelete}\n                            disabled={deleteTripMutation.isPending}\n                            className=\"border-red-200 text-red-600 hover:bg-red-50 hover:text-red-700\"\n                          >\n                            {deleteTripMutation.isPending ? (\n                              <>\n                                <div className=\"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin mr-2\" />\n                                Excluindo...\n                              </>\n                            ) : (\n                              <>\n                                <Trash2 className=\"h-4 w-4 mr-2\" />\n                                Excluir Viagem\n                              </>\n                            )}\n                          </Button>\n                        )}\n                      </div>\n                    </form>\n                  </CardContent>\n                </Card>\n              </div>\n\n              {/* Sidebar */}\n              <div className=\"space-y-6\">\n                {/* Trip Stats */}\n                <Card className=\"shadow-lg border-0\">\n                  <CardHeader className=\"bg-gradient-to-r from-blue-500 to-indigo-500 text-white\">\n                    <CardTitle className=\"flex items-center gap-2\">\n                      <Users className=\"h-5 w-5\" />\n                      Status da Viagem\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"p-6\">\n                    <div className=\"space-y-4\">\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-gray-600\">Participantes:</span>\n                        <Badge variant=\"secondary\">{getRealParticipantsCount(trip)}/{trip.max_participants}</Badge>\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-gray-600\">Status:</span>\n                        <Badge className=\"bg-green-500 hover:bg-green-600\">Ativa</Badge>\n                      </div>\n                      <div className=\"flex items-center justify-between\">\n                        <span className=\"text-gray-600\">Criada em:</span>\n                        <span className=\"text-sm text-gray-500\">\n                          {new Date(trip.created_at || trip.createdAt).toLocaleDateString('pt-BR')}\n                        </span>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Warning for creators */}\n                {getRealParticipantsCount(trip) > 1 && (\n                  <Card className=\"shadow-lg border-orange-200 bg-orange-50\">\n                    <CardContent className=\"p-6\">\n                      <div className=\"flex items-start gap-3\">\n                        <AlertTriangle className=\"h-5 w-5 text-orange-600 mt-0.5 flex-shrink-0\" />\n                        <div>\n                          <h3 className=\"font-medium text-orange-800 mb-2\">Aten√ß√£o</h3>\n                          <p className=\"text-sm text-orange-700\">\n                            Esta viagem tem outros participantes. Se voc√™ cancelar no dashboard, \n                            a organiza√ß√£o ser√° transferida para o participante mais antigo.\n                          </p>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                )}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </ProtectedRoute>\n  );\n}","size_bytes":19979},"client/src/pages/home-page.tsx":{"content":"import { Link } from \"wouter\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Navbar } from \"@/components/navbar\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { TripCard } from \"@/components/trip-card\";\nimport { Plane, Users, DollarSign, Calendar, MapPin, Shield, Star, TrendingUp, Heart, Sparkles, Compass, Navigation, Globe } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { ptBR } from \"date-fns/locale\";\nimport { motion } from \"framer-motion\";\nimport { AnimatedPreloader } from \"@/components/ui/animated-preloader\";\nimport { formatBrazilianCurrency } from \"@shared/utils\";\n\n// Featured destinations with beautiful imagery\nconst featuredDestinations = [\n  {\n    name: \"Machu Picchu, Peru\",\n    image: \"https://images.unsplash.com/photo-1587595431973-160d0d94add1?w=800&h=600&fit=crop\",\n    description: \"Cidade perdida dos Incas\",\n    avgBudget: 3500,\n    rating: 4.9,\n    tripCount: 45\n  },\n  {\n    name: \"Santorini, Gr√©cia\",\n    image: \"https://images.unsplash.com/photo-1570077188670-e3a8d69ac5ff?w=800&h=600&fit=crop\",\n    description: \"Para√≠so no Mar Egeu\",\n    avgBudget: 4200,\n    rating: 4.8,\n    tripCount: 38\n  },\n  {\n    name: \"T√≥quio, Jap√£o\",\n    image: \"https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?w=800&h=600&fit=crop\",\n    description: \"Metr√≥pole futurista\",\n    avgBudget: 5000,\n    rating: 4.9,\n    tripCount: 52\n  },\n  {\n    name: \"Bali, Indon√©sia\",\n    image: \"https://images.unsplash.com/photo-1537996194471-e657df975ab4?w=800&h=600&fit=crop\",\n    description: \"Ilha dos Deuses\",\n    avgBudget: 2800,\n    rating: 4.7,\n    tripCount: 67\n  },\n  {\n    name: \"Patag√¥nia, Argentina\",\n    image: \"https://images.unsplash.com/photo-1519904981063-b0cf448d479e?w=800&h=600&fit=crop\",\n    description: \"Aventura no fim do mundo\",\n    avgBudget: 4500,\n    rating: 4.9,\n    tripCount: 29\n  },\n  {\n    name: \"Isl√¢ndia\",\n    image: \"https://images.unsplash.com/photo-1504829857797-ddff29c27927?w=800&h=600&fit=crop\",\n    description: \"Terra do gelo e fogo\",\n    avgBudget: 6000,\n    rating: 4.8,\n    tripCount: 41\n  }\n];\n\n// PartiuTrip Interactive Travel Animation Component\nconst TravelAnimation = ({ className = \"\" }: { className?: string }) => (\n  <div className={`relative ${className}`}>\n    {/* Main Animation Container */}\n    <div className=\"relative w-full h-full flex items-center justify-center\">\n      {/* Animated Preloader with Custom Styling */}\n      <div className=\"relative\">\n        <AnimatedPreloader \n          message=\"\"\n          className=\"transform scale-110\"\n        />\n      </div>\n    </div>\n    \n    {/* Interactive Elements Below Animation */}\n  \n  </div>\n);\n\nexport default function HomePage() {\n  // Fetch recent trips\n  const { data: trips, isLoading } = useQuery({\n    queryKey: [\"/api/trips\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/trips?limit=6\", { credentials: \"include\" });\n      if (!res.ok) throw new Error(\"Failed to fetch trips\");\n      return res.json();\n    }\n  });\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-cyan-50 relative overflow-hidden\">\n      <Navbar />\n\n      {/* Animated Background Elements */}\n      <div className=\"absolute inset-0 overflow-hidden\">\n        {/* Floating Orbs */}\n        <motion.div\n          className=\"absolute w-64 h-64 bg-blue-400/15 rounded-full blur-3xl\"\n          animate={{\n            x: [0, 100, 0],\n            y: [0, -50, 0],\n          }}\n          transition={{\n            duration: 8,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }}\n          style={{ top: '10%', left: '10%' }}\n        />\n        <motion.div\n          className=\"absolute w-48 h-48 bg-indigo-300/20 rounded-full blur-3xl\"\n          animate={{\n            x: [0, -80, 0],\n            y: [0, 70, 0],\n          }}\n          transition={{\n            duration: 10,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }}\n          style={{ top: '60%', right: '15%' }}\n        />\n        <motion.div\n          className=\"absolute w-32 h-32 bg-orange-400/10 rounded-full blur-2xl\"\n          animate={{\n            x: [0, 60, 0],\n            y: [0, -30, 0],\n          }}\n          transition={{\n            duration: 6,\n            repeat: Infinity,\n            ease: \"easeInOut\"\n          }}\n          style={{ top: '30%', right: '30%' }}\n        />\n\n\n      </div>\n\n      {/* Hero Section - Lighthouse Theme */}\n      <section className=\"relative min-h-screen flex items-center justify-center overflow-hidden\">\n        {/* Main Content */}\n        <div className=\"container mx-auto px-4 py-20 relative z-10\">\n          <div className=\"grid lg:grid-cols-2 gap-16 items-center\">\n            {/* Left Content */}\n            <motion.div\n              className=\"text-left space-y-8\"\n              initial={{ opacity: 0, x: -50 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ duration: 0.8 }}\n            >\n              {/* Badge */}\n              <motion.div\n                className=\"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-orange-500/80 to-red-500/80 backdrop-blur-sm rounded-full border border-orange-300/50 text-white shadow-lg shadow-orange-500/25\"\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.2 }}\n              >\n                <Users className=\"w-4 h-4\" />\n                <span className=\"text-sm font-medium\">Compartilhe experi√™ncias √∫nicas</span>\n              </motion.div>\n\n              {/* Main Heading */}\n              <motion.div\n                initial={{ opacity: 0, y: 30 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.4 }}\n              >\n                <h1 className=\"text-6xl md:text-7xl font-bold text-slate-800 leading-tight\">\n                  <span className=\"bg-gradient-to-r from-yellow-400 via-orange-400 to-red-400 bg-clip-text text-transparent\">\n                    Viaje Junto,\n                  </span>\n                  <br />\n                  <span className=\"text-slate-800\">\n                    Gaste Menos\n                  </span>\n                </h1>\n              </motion.div>\n\n              {/* Subtitle */}\n              <motion.p\n                className=\"text-xl text-slate-600 max-w-lg leading-relaxed\"\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.6 }}\n              >\n                Conecte-se com viajantes que compartilham seus interesses. \n                <span className=\"text-blue-600 font-semibold\"> Divida custos</span>, troque experi√™ncias \n                e descubra o mundo de forma mais inteligente e econ√¥mica.\n              </motion.p>\n\n              {/* CTA Buttons */}\n              <motion.div\n                className=\"flex flex-col sm:flex-row gap-4\"\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.8 }}\n              >\n                <Button asChild size=\"lg\" className=\"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-semibold px-8 py-6 rounded-full shadow-xl shadow-blue-500/25 transform hover:scale-105 transition-all\">\n                  <Link href=\"/search\">\n                    <Users className=\"mr-2 h-5 w-5\" />\n                    Encontrar Viagem\n                  </Link>\n                </Button>\n                <Button asChild size=\"lg\" className=\"bg-gradient-to-r from-purple-400 to-indigo-500 hover:from-purple-500 hover:to-indigo-600 text-white font-semibold px-8 py-6 rounded-full shadow-xl shadow-purple-500/25 transform hover:scale-105 transition-all\">\n                  <Link href=\"/activities\">\n                    <Calendar className=\"mr-2 h-5 w-5\" />\n                    Explorar Atividades\n                  </Link>\n                </Button>\n                <Button asChild size=\"lg\" className=\"bg-gradient-to-r from-green-400 to-emerald-500 hover:from-green-500 hover:to-emerald-600 text-white font-semibold px-8 py-6 rounded-full shadow-xl shadow-green-500/25 transform hover:scale-105 transition-all\">\n                  <Link href=\"/create-trip\">\n                    <DollarSign className=\"mr-2 h-5 w-5\" />\n                    Compartilhar Viagem\n                  </Link>\n                </Button>\n              </motion.div>\n\n              {/* Stats with Animation */}\n              <motion.div\n                className=\"grid grid-cols-3 gap-8 pt-8\"\n                initial={{ opacity: 0, y: 30 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 1 }}\n              >\n                <div className=\"text-center\">\n                  <motion.p\n                    className=\"text-3xl font-bold text-yellow-400\"\n                    initial={{ scale: 0 }}\n                    animate={{ scale: 1 }}\n                    transition={{ delay: 1.2, type: \"spring\", stiffness: 200 }}\n                  >\n                    65%\n                  </motion.p>\n                  <p className=\"text-slate-600 text-sm\">Economia M√©dia</p>\n                </div>\n                <div className=\"text-center\">\n                  <motion.p\n                    className=\"text-3xl font-bold text-green-400\"\n                    initial={{ scale: 0 }}\n                    animate={{ scale: 1 }}\n                    transition={{ delay: 1.4, type: \"spring\", stiffness: 200 }}\n                  >\n                    2.8k+\n                  </motion.p>\n                  <p className=\"text-slate-600 text-sm\">Viajantes Conectados</p>\n                </div>\n                <div className=\"text-center\">\n                  <motion.p\n                    className=\"text-3xl font-bold text-blue-500\"\n                    initial={{ scale: 0 }}\n                    animate={{ scale: 1 }}\n                    transition={{ delay: 1.6, type: \"spring\", stiffness: 200 }}\n                  >\n                    1.2k+\n                  </motion.p>\n                  <p className=\"text-slate-600 text-sm\">Experi√™ncias Compartilhadas</p>\n                </div>\n              </motion.div>\n            </motion.div>\n\n            {/* Right Content - Interactive Globe */}\n            <motion.div\n              className=\"relative h-96 lg:h-[600px] flex items-center justify-center\"\n              initial={{ opacity: 0, x: 50 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ duration: 0.8, delay: 0.3 }}\n            >\n              {/* Interactive Globe Container */}\n              <div className=\"relative w-full h-full max-w-lg\">\n                {/* Background Glow Effect */}\n                <motion.div\n                  className=\"absolute inset-0 bg-gradient-to-r from-yellow-400/20 to-orange-400/20 rounded-full blur-3xl\"\n                  animate={{\n                    scale: [1, 1.3, 1],\n                    opacity: [0.2, 0.5, 0.2],\n                  }}\n                  transition={{\n                    duration: 5,\n                    repeat: Infinity,\n                    ease: \"easeInOut\"\n                  }}\n                />\n\n                {/* Globe Component */}\n                <motion.div\n                  className=\"relative z-10 w-full h-full\"\n                  animate={{\n                    y: [0, -8, 0],\n                  }}\n                  transition={{\n                    duration: 6,\n                    repeat: Infinity,\n                    ease: \"easeInOut\"\n                  }}\n                  whileHover={{\n                    scale: 1.05,\n                    transition: { duration: 0.3 }\n                  }}\n                >\n                  <TravelAnimation className=\"w-full h-full\" />\n                </motion.div>\n\n                {/* Floating Action Buttons around Preloader - com z-index corrigido */}\n                <motion.div\n                  className=\"absolute top-12 left-12 bg-white/90 backdrop-blur-sm rounded-full p-4 shadow-lg cursor-pointer group z-20\"\n                  animate={{\n                    y: [0, -20, 0],\n                    rotate: [0, 10, 0],\n                  }}\n                  transition={{\n                    duration: 8,\n                    repeat: Infinity,\n                    ease: \"easeInOut\"\n                  }}\n                  whileHover={{\n                    scale: 1.15,\n                    rotate: 15,\n                    transition: { duration: 0.2 }\n                  }}\n                  whileTap={{ scale: 0.95 }}\n                >\n                  <Users className=\"w-6 h-6 text-blue-600 group-hover:text-blue-500 transition-colors\" />\n                  <div className=\"absolute -top-10 left-1/2 transform -translate-x-1/2 bg-slate-900 text-white px-3 py-1 rounded-lg text-xs opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-30\">\n                    Comunidade Verificada\n                  </div>\n                </motion.div>\n\n                <motion.div\n                  className=\"absolute bottom-12 right-12 bg-white/90 backdrop-blur-sm rounded-full p-4 shadow-lg cursor-pointer group z-20\"\n                  animate={{\n                    y: [0, 20, 0],\n                    scale: [1, 1.05, 1],\n                  }}\n                  transition={{\n                    duration: 6,\n                    repeat: Infinity,\n                    ease: \"easeInOut\"\n                  }}\n                  whileHover={{\n                    scale: 1.15,\n                    rotate: -15,\n                    transition: { duration: 0.2 }\n                  }}\n                  whileTap={{ scale: 0.95 }}\n                >\n                  <DollarSign className=\"w-6 h-6 text-green-600 group-hover:text-green-500 transition-colors\" />\n                  <div className=\"absolute -top-10 left-1/2 transform -translate-x-1/2 bg-slate-900 text-white px-3 py-1 rounded-lg text-xs opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-30\">\n                    Economize at√© 65%\n                  </div>\n                </motion.div>\n\n                <motion.div\n                  className=\"absolute top-28 right-8 bg-white/90 backdrop-blur-sm rounded-full p-4 shadow-lg cursor-pointer group z-20\"\n                  animate={{\n                    x: [0, 15, 0],\n                    y: [0, -15, 0],\n                  }}\n                  transition={{\n                    duration: 5,\n                    repeat: Infinity,\n                    ease: \"easeInOut\"\n                  }}\n                  whileHover={{\n                    scale: 1.15,\n                    transition: { duration: 0.2 }\n                  }}\n                  whileTap={{ scale: 0.95 }}\n                >\n                  <Heart className=\"w-6 h-6 text-blue-600 group-hover:text-blue-500 transition-colors\" />\n                  <div className=\"absolute -top-10 left-1/2 transform -translate-x-1/2 bg-slate-900 text-white px-3 py-1 rounded-lg text-xs opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-30\">\n                    Experi√™ncias √önicas\n                  </div>\n                </motion.div>\n\n                <motion.div\n                  className=\"absolute bottom-28 left-8 bg-white/90 backdrop-blur-sm rounded-full p-4 shadow-lg cursor-pointer group z-20\"\n                  animate={{\n                    x: [0, -15, 0],\n                    y: [0, 15, 0],\n                  }}\n                  transition={{\n                    duration: 7,\n                    repeat: Infinity,\n                    ease: \"easeInOut\"\n                  }}\n                  whileHover={{\n                    scale: 1.15,\n                    transition: { duration: 0.2 }\n                  }}\n                  whileTap={{ scale: 0.95 }}\n                >\n                  <Globe className=\"w-6 h-6 text-indigo-600 group-hover:text-indigo-500 transition-colors\" />\n                  <div className=\"absolute -top-10 left-1/2 transform -translate-x-1/2 bg-slate-900 text-white px-3 py-1 rounded-lg text-xs opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-30\">\n                    85+ Destinos\n                  </div>\n                </motion.div>\n\n                {/* Animated Stats Badges - com z-index corrigido */}\n                <motion.div\n                  className=\"absolute top-4 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-full px-4 py-2 shadow-lg z-20\"\n                  animate={{\n                    y: [0, -10, 0],\n                    scale: [1, 1.02, 1],\n                  }}\n                  transition={{\n                    duration: 4,\n                    repeat: Infinity,\n                    ease: \"easeInOut\"\n                  }}\n                  whileHover={{\n                    scale: 1.05,\n                    transition: { duration: 0.2 }\n                  }}\n                >\n                  <div className=\"text-sm font-bold\">2.8k+ Viajantes</div>\n                </motion.div>\n\n                <motion.div\n                  className=\"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-full px-4 py-2 shadow-lg z-20\"\n                  animate={{\n                    y: [0, 10, 0],\n                    scale: [1, 1.02, 1],\n                  }}\n                  transition={{\n                    duration: 5,\n                    repeat: Infinity,\n                    ease: \"easeInOut\"\n                  }}\n                  whileHover={{\n                    scale: 1.05,\n                    transition: { duration: 0.2 }\n                  }}\n                >\n                  <div className=\"text-sm font-bold\">1.2k+ Experi√™ncias</div>\n                </motion.div>\n              </div>\n            </motion.div>\n          </div>\n        </div>\n\n        {/* Bottom Gradient Overlay */}\n        <div className=\"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-slate-50 to-transparent\" />\n      </section>\n\n      {/* Featured Destinations */}\n      <section className=\"relative bg-gradient-to-br from-slate-50 via-blue-50/30 to-cyan-50/20 py-20 overflow-hidden\">\n        {/* Background Pattern */}\n        <div className=\"absolute inset-0 opacity-5\">\n          <div className=\"absolute top-0 left-0 w-96 h-96 bg-gradient-to-br from-blue-400 to-indigo-600 rounded-full filter blur-3xl\"></div>\n          <div className=\"absolute bottom-0 right-0 w-96 h-96 bg-gradient-to-br from-orange-400 to-cyan-600 rounded-full filter blur-3xl\"></div>\n        </div>\n\n        <div className=\"container mx-auto px-4 relative z-10\">\n          <motion.div \n            className=\"text-center mb-16\"\n            initial={{ opacity: 0, y: 30 }}\n            whileInView={{ opacity: 1, y: 0 }}\n            viewport={{ once: true }}\n            transition={{ duration: 0.8 }}\n          >\n            <div className=\"inline-flex items-center gap-2 bg-white/60 backdrop-blur-sm rounded-full px-6 py-2 mb-6 border border-white/20\">\n              <Sparkles className=\"w-5 h-5 text-amber-500\" />\n              <span className=\"text-sm font-medium text-slate-700\">Mais Procurados</span>\n            </div>\n            <h2 className=\"text-4xl md:text-5xl font-bold mb-4\">\n              <span className=\"bg-gradient-to-r from-slate-800 via-blue-800 to-indigo-800 bg-clip-text text-transparent\">\n                Destinos em Alta\n              </span>\n            </h2>\n            <p className=\"text-xl text-slate-600 max-w-2xl mx-auto leading-relaxed\">\n              Descubra os lugares mais procurados pelos nossos viajantes e planeje sua pr√≥xima aventura\n            </p>\n            <Button asChild className=\"mt-6 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white border-0 px-8 py-3 text-lg font-semibold rounded-full shadow-lg hover:shadow-xl transition-all\">\n              <Link href=\"/search\">\n                <Globe className=\"mr-2 h-5 w-5\" />\n                Explorar Todos os Destinos\n              </Link>\n            </Button>\n          </motion.div>\n\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            {featuredDestinations.map((destination, index) => (\n              <motion.div\n                key={index}\n                initial={{ opacity: 0, y: 50 }}\n                whileInView={{ opacity: 1, y: 0 }}\n                viewport={{ once: true }}\n                transition={{ duration: 0.6, delay: index * 0.1 }}\n              >\n                <Card className=\"group overflow-hidden bg-white/70 backdrop-blur-sm border border-white/40 hover:bg-white/90 hover:shadow-2xl hover:scale-105 transition-all duration-500 cursor-pointer\">\n                  <div className=\"relative h-56 overflow-hidden\">\n                    <img \n                      src={destination.image} \n                      alt={destination.name}\n                      className=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700\"\n                    />\n                    <div className=\"absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent\"></div>\n\n                    {/* Glass morphism overlay */}\n                    <div className=\"absolute inset-0 bg-gradient-to-t from-blue-900/30 via-transparent to-indigo-900/20 opacity-0 group-hover:opacity-100 transition-opacity duration-500\"></div>\n\n                    <div className=\"absolute bottom-4 left-4 text-white\">\n                      <h3 className=\"text-2xl font-bold mb-1 drop-shadow-lg\">{destination.name}</h3>\n                      <p className=\"text-sm opacity-90 drop-shadow-md\">{destination.description}</p>\n                    </div>\n\n                    {/* Rating Badge */}\n                    <div className=\"absolute top-4 right-4 bg-white/95 backdrop-blur-sm rounded-full px-3 py-1 border border-white/40\">\n                      <div className=\"flex items-center gap-1\">\n                        <Star className=\"w-4 h-4 text-amber-500 fill-amber-500\" />\n                        <span className=\"text-sm font-bold text-slate-800\">{destination.rating}</span>\n                      </div>\n                    </div>\n\n                    {/* Floating trend indicator */}\n                    <motion.div\n                      className=\"absolute top-4 left-4 bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-full px-3 py-1 text-xs font-bold\"\n                      initial={{ scale: 0 }}\n                      whileInView={{ scale: 1 }}\n                      transition={{ duration: 0.5, delay: index * 0.1 + 0.3 }}\n                    >\n                      üî• TRENDING\n                    </motion.div>\n                  </div>\n\n                  <CardContent className=\"p-6 bg-gradient-to-br from-white to-slate-50/80\">\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"space-y-1\">\n                        <p className=\"text-sm font-medium text-slate-500 uppercase tracking-wide\">Or√ßamento m√©dio</p>\n                        <p className=\"text-2xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent\">\n                          {formatBrazilianCurrency(destination.avgBudget)}\n                        </p>\n                      </div>\n                      <div className=\"text-right space-y-1\">\n                        <p className=\"text-sm font-medium text-slate-500 uppercase tracking-wide\">Dispon√≠veis</p>\n                        <div className=\"flex items-center justify-end gap-2\">\n                          <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n                          <span className=\"text-lg font-bold text-slate-800\">{destination.tripCount}</span>\n                          <span className=\"text-sm text-blue-600 font-medium\">viagens</span>\n                        </div>\n                      </div>\n                    </div>\n\n                    {/* Action button */}\n                    <Button className=\"w-full mt-4 bg-gradient-to-r from-slate-700 to-slate-800 hover:from-slate-800 hover:to-slate-900 text-white border-0 rounded-xl py-3 font-semibold transition-all duration-300 group-hover:shadow-lg\">\n                      <Compass className=\"mr-2 h-4 w-4\" />\n                      Ver Detalhes\n                    </Button>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n\n          {/* Bottom decoration */}\n          <motion.div \n            className=\"text-center mt-16\"\n            initial={{ opacity: 0 }}\n            whileInView={{ opacity: 1 }}\n            viewport={{ once: true }}\n            transition={{ duration: 1, delay: 0.5 }}\n          >\n            <div className=\"inline-flex items-center gap-2 text-slate-600\">\n              <div className=\"w-8 h-[1px] bg-gradient-to-r from-transparent to-slate-300\"></div>\n              <span className=\"text-sm font-medium\">E muitos outros destinos incr√≠veis</span>\n              <div className=\"w-8 h-[1px] bg-gradient-to-l from-transparent to-slate-300\"></div>\n            </div>\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Recent Trips */}\n      <section className=\"relative bg-gradient-to-br from-slate-50 via-blue-50/30 to-cyan-50/20 py-20 overflow-hidden\">\n        {/* Background Pattern */}\n        <div className=\"absolute inset-0 opacity-5\">\n          <div className=\"absolute top-0 right-0 w-96 h-96 bg-gradient-to-br from-indigo-400 to-cyan-600 rounded-full filter blur-3xl\"></div>\n          <div className=\"absolute bottom-0 left-0 w-96 h-96 bg-gradient-to-br from-yellow-400 to-orange-600 rounded-full filter blur-3xl\"></div>\n        </div>\n\n        <div className=\"container mx-auto px-4 relative z-10\">\n          <motion.div \n            className=\"text-center mb-16\"\n            initial={{ opacity: 0, y: 30 }}\n            whileInView={{ opacity: 1, y: 0 }}\n            viewport={{ once: true }}\n            transition={{ duration: 0.8 }}\n          >\n            <div className=\"inline-flex items-center gap-2 bg-white/60 backdrop-blur-sm rounded-full px-6 py-2 mb-6 border border-white/20\">\n              <TrendingUp className=\"w-5 h-5 text-indigo-500\" />\n              <span className=\"text-sm font-medium text-slate-700\">Mais Recentes</span>\n            </div>\n            <h2 className=\"text-4xl md:text-5xl font-bold mb-4\">\n              <span className=\"bg-gradient-to-r from-yellow-400 via-orange-400 to-red-400 bg-clip-text text-transparent\">\n                Viagens Recentes\n              </span>\n            </h2>\n            <p className=\"text-xl text-slate-600 max-w-2xl mx-auto leading-relaxed\">\n              Junte-se a uma aventura que est√° prestes a come√ßar e fa√ßa novas amizades\n            </p>\n            <Button asChild className=\"mt-6 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white border-0 px-8 py-3 text-lg font-semibold rounded-full shadow-lg hover:shadow-xl transition-all\">\n              <Link href=\"/search\">\n                <Heart className=\"mr-2 h-5 w-5\" />\n                Explorar Mais Viagens\n              </Link>\n            </Button>\n          </motion.div>\n\n          {isLoading ? (\n            <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-8\">\n              {[1, 2, 3].map((i) => (\n                <motion.div\n                  key={i}\n                  initial={{ opacity: 0, y: 50 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ duration: 0.6, delay: i * 0.1 }}\n                >\n                  <Card className=\"overflow-hidden bg-white/70 backdrop-blur-sm border border-white/40\">\n                    <Skeleton className=\"h-48 w-full\" />\n                    <CardContent className=\"p-6\">\n                      <Skeleton className=\"h-6 w-3/4 mb-3\" />\n                      <Skeleton className=\"h-4 w-1/2 mb-4\" />\n                      <Skeleton className=\"h-20 w-full\" />\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-8\">\n              {trips?.slice(0, 6).map((trip: any, index: number) => (\n                <motion.div\n                  key={trip.id}\n                  initial={{ opacity: 0, y: 50 }}\n                  whileInView={{ opacity: 1, y: 0 }}\n                  viewport={{ once: true }}\n                  transition={{ duration: 0.6, delay: index * 0.1 }}\n                >\n                  <TripCard trip={trip} showActions={true} />\n                </motion.div>\n              ))}\n            </div>\n          )}\n\n          {/* Bottom decoration */}\n          <motion.div \n            className=\"text-center mt-16\"\n            initial={{ opacity: 0 }}\n            whileInView={{ opacity: 1 }}\n            viewport={{ once: true }}\n            transition={{ duration: 1, delay: 0.5 }}\n          >\n            <div className=\"inline-flex items-center gap-2 text-slate-600\">\n              <div className=\"w-8 h-[1px] bg-gradient-to-r from-transparent to-slate-300\"></div>\n              <span className=\"text-sm font-medium\">Mais de 500 viagens dispon√≠veis</span>\n              <div className=\"w-8 h-[1px] bg-gradient-to-l from-transparent to-slate-300\"></div>\n            </div>\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Features Section with Icons */}\n      <section className=\"relative py-24 bg-gradient-to-br from-white via-blue-50/30 to-indigo-50/20 overflow-hidden\">\n        {/* Background Pattern */}\n        <div className=\"absolute inset-0 opacity-5\">\n          <div className=\"absolute top-20 left-20 w-80 h-80 bg-gradient-to-br from-blue-500 to-cyan-500 rounded-full filter blur-3xl\"></div>\n          <div className=\"absolute bottom-20 right-20 w-80 h-80 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full filter blur-3xl\"></div>\n        </div>\n\n        <div className=\"container mx-auto px-4 relative z-10\">\n          <motion.div \n            className=\"text-center mb-16\"\n            initial={{ opacity: 0, y: 30 }}\n            whileInView={{ opacity: 1, y: 0 }}\n            viewport={{ once: true }}\n            transition={{ duration: 0.8 }}\n          >\n            <div className=\"inline-flex items-center gap-2 bg-white/60 backdrop-blur-sm rounded-full px-6 py-2 mb-6 border border-white/20\">\n              <Star className=\"w-5 h-5 text-amber-500\" />\n              <span className=\"text-sm font-medium text-slate-700\">Vantagens Exclusivas</span>\n            </div>\n            <h2 className=\"text-4xl md:text-5xl font-bold mb-4\">\n              <span className=\"bg-gradient-to-r from-yellow-400 via-orange-400 to-red-400 bg-clip-text text-transparent\">\n                Por que escolher PartiuTrip?\n              </span>\n            </h2>\n            <p className=\"text-xl text-slate-600 max-w-2xl mx-auto leading-relaxed\">\n              Descubra como nossa plataforma transforma a forma de viajar, conectando pessoas e criando experi√™ncias inesquec√≠veis\n            </p>\n          </motion.div>\n\n          <div className=\"grid md:grid-cols-3 gap-8\">\n            <motion.div\n              initial={{ opacity: 0, y: 50 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              viewport={{ once: true }}\n              transition={{ duration: 0.6, delay: 0.1 }}\n            >\n              <Card className=\"group text-center bg-white/80 backdrop-blur-sm border border-white/40 hover:bg-white/95 hover:shadow-2xl hover:scale-105 transition-all duration-500 h-full\">\n                <CardHeader className=\"pb-4\">\n                  <motion.div \n                    className=\"w-24 h-24 bg-gradient-to-br from-green-400 to-emerald-500 rounded-2xl flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300\"\n                    whileHover={{ rotate: [0, -10, 10, 0] }}\n                    transition={{ duration: 0.5 }}\n                  >\n                    <DollarSign className=\"w-12 h-12 text-white\" />\n                  </motion.div>\n                  <CardTitle className=\"text-2xl font-bold bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent\">\n                    Economize at√© 65%\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <CardDescription className=\"text-slate-600 text-base leading-relaxed\">\n                    Divida hospedagem, transporte e passeios. Viaje mais gastando menos com nossa inteligente divis√£o de custos!\n                  </CardDescription>\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            <motion.div\n              initial={{ opacity: 0, y: 50 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              viewport={{ once: true }}\n              transition={{ duration: 0.6, delay: 0.2 }}\n            >\n              <Card className=\"group text-center bg-white/80 backdrop-blur-sm border border-white/40 hover:bg-white/95 hover:shadow-2xl hover:scale-105 transition-all duration-500 h-full\">\n                <CardHeader className=\"pb-4\">\n                  <motion.div \n                    className=\"w-24 h-24 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-2xl flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300\"\n                    whileHover={{ rotate: [0, -10, 10, 0] }}\n                    transition={{ duration: 0.5 }}\n                  >\n                    <Users className=\"w-12 h-12 text-white\" />\n                  </motion.div>\n                  <CardTitle className=\"text-2xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent\">\n                    Comunidade Verificada\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <CardDescription className=\"text-slate-600 text-base leading-relaxed\">\n                    Perfis autenticados, avalia√ß√µes reais e sistema de reputa√ß√£o confi√°vel para viagens seguras e divertidas.\n                  </CardDescription>\n                </CardContent>\n              </Card>\n            </motion.div>\n\n            <motion.div\n              initial={{ opacity: 0, y: 50 }}\n              whileInView={{ opacity: 1, y: 0 }}\n              viewport={{ once: true }}\n              transition={{ duration: 0.6, delay: 0.3 }}\n            >\n              <Card className=\"group text-center bg-white/80 backdrop-blur-sm border border-white/40 hover:bg-white/95 hover:shadow-2xl hover:scale-105 transition-all duration-500 h-full\">\n                <CardHeader className=\"pb-4\">\n                  <motion.div \n                    className=\"w-24 h-24 bg-gradient-to-br from-purple-400 to-pink-500 rounded-2xl flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition-transform duration-300\"\n                    whileHover={{ rotate: [0, -10, 10, 0] }}\n                    transition={{ duration: 0.5 }}\n                  >\n                    <Heart className=\"w-12 h-12 text-white\" />\n                  </motion.div>\n                  <CardTitle className=\"text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent\">\n                    Experi√™ncias √önicas\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <CardDescription className=\"text-slate-600 text-base leading-relaxed\">\n                    Viva aventuras aut√™nticas e fa√ßa amizades que duram para sempre com companheiros de viagem compat√≠veis.\n                  </CardDescription>\n                </CardContent>\n              </Card>\n            </motion.div>\n          </div>\n        </div>\n      </section>\n\n      {/* CTA Section with gradient */}\n      <section className=\"relative bg-gradient-to-br from-slate-900 via-blue-950 to-slate-800 text-white py-20 overflow-hidden\">\n        {/* Background Pattern */}\n        <div className=\"absolute inset-0 opacity-10\">\n          <div className=\"absolute top-0 left-1/4 w-96 h-96 bg-gradient-to-br from-blue-400 to-cyan-400 rounded-full filter blur-3xl animate-pulse\"></div>\n          <div className=\"absolute bottom-0 right-1/4 w-96 h-96 bg-gradient-to-br from-indigo-400 to-cyan-400 rounded-full filter blur-3xl animate-pulse\" style={{animationDelay: '2s'}}></div>\n        </div>\n\n        <div className=\"container mx-auto px-4 text-center relative z-10\">\n          <motion.div\n            initial={{ opacity: 0, y: 30 }}\n            whileInView={{ opacity: 1, y: 0 }}\n            viewport={{ once: true }}\n            transition={{ duration: 0.8 }}\n          >\n            <div className=\"inline-flex items-center gap-2 bg-white/10 backdrop-blur-sm rounded-full px-6 py-2 mb-6 border border-white/20\">\n              <Sparkles className=\"w-5 h-5 text-yellow-400\" />\n              <span className=\"text-sm font-medium\">Comece Agora</span>\n            </div>\n\n            <h2 className=\"text-4xl md:text-6xl font-bold mb-6\">\n              <span className=\"bg-gradient-to-r from-yellow-400 via-orange-400 to-red-400 bg-clip-text text-transparent\">\n                Sua pr√≥xima aventura\n              </span>\n              <br />\n              <span className=\"text-white\">come√ßa aqui</span>\n            </h2>\n\n            <p className=\"text-xl md:text-2xl mb-10 opacity-90 max-w-3xl mx-auto leading-relaxed\">\n              Junte-se a mais de <span className=\"font-bold text-yellow-400\">2.8k viajantes</span> que j√° descobriram uma nova forma de explorar o mundo com <span className=\"font-bold text-green-400\">65% de economia</span>\n            </p>\n\n            <div className=\"flex flex-col sm:flex-row gap-4 justify-center items-center\">\n              <Button asChild size=\"lg\" className=\"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-bold px-8 py-4 text-lg rounded-full shadow-2xl hover:shadow-blue-500/25 transition-all duration-300\">\n                <Link href=\"/auth\">\n                  <Users className=\"mr-2 h-5 w-5\" />\n                  Criar Conta Gr√°tis\n                </Link>\n              </Button>\n\n              <Button asChild size=\"lg\" variant=\"outline\" className=\"bg-white/10 backdrop-blur-sm text-white border-white/30 hover:bg-white hover:text-slate-900 px-8 py-4 text-lg rounded-full transition-all duration-300\">\n                <Link href=\"/search\">\n                  <Compass className=\"mr-2 h-5 w-5\" />\n                  Explorar Viagens\n                </Link>\n              </Button>\n            </div>\n          </motion.div>\n        </div>\n      </section>\n\n      {/* Footer */}\n      <footer className=\"relative z-50 bg-slate-900 text-white border-t border-slate-800\">\n        <div className=\"container mx-auto px-4 py-16 relative z-10\">\n          <div className=\"grid md:grid-cols-4 gap-8\">\n            {/* Brand Section */}\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center space-x-2\">\n                <Plane className=\"h-8 w-8 text-yellow-400\" />\n                <span className=\"font-heading font-bold text-2xl bg-gradient-to-r from-yellow-400 via-orange-400 to-red-400 bg-clip-text text-transparent\">PartiuTrip</span>\n              </div>\n              <p className=\"text-slate-400 leading-relaxed\">\n                Conectamos viajantes, reduzimos custos e criamos experi√™ncias inesquec√≠veis ao redor do mundo.\n              </p>\n              <div className=\"flex space-x-4\">\n                <div className=\"w-10 h-10 bg-slate-800 rounded-full flex items-center justify-center hover:bg-slate-700 cursor-pointer transition-colors\">\n                  <span className=\"text-blue-400\">f</span>\n                </div>\n                <div className=\"w-10 h-10 bg-slate-800 rounded-full flex items-center justify-center hover:bg-slate-700 cursor-pointer transition-colors\">\n                  <span className=\"text-sky-400\">t</span>\n                </div>\n                <div className=\"w-10 h-10 bg-slate-800 rounded-full flex items-center justify-center hover:bg-slate-700 cursor-pointer transition-colors\">\n                  <span className=\"text-pink-400\">i</span>\n                </div>\n              </div>\n            </div>\n\n            {/* Platform */}\n            <div className=\"space-y-4\">\n              <h3 className=\"font-bold text-lg text-white\">Plataforma</h3>\n              <ul className=\"space-y-2 text-slate-400\">\n                <li><Link href=\"/search\" className=\"relative z-10 hover:text-blue-400 transition-colors cursor-pointer\">Buscar Viagens</Link></li>\n                <li><Link href=\"/create-trip\" className=\"relative z-10 hover:text-blue-400 transition-colors cursor-pointer\">Criar Viagem</Link></li>\n                <li><Link href=\"/dashboard\" className=\"relative z-10 hover:text-blue-400 transition-colors cursor-pointer\">Meu Painel</Link></li>\n                <li><Link href=\"/auth\" className=\"relative z-10 hover:text-blue-400 transition-colors cursor-pointer\">Cadastrar-se</Link></li>\n              </ul>\n            </div>\n\n            {/* Destinos */}\n            <div className=\"space-y-4\">\n              <h3 className=\"font-bold text-lg text-white\">Destinos Populares</h3>\n              <ul className=\"space-y-2 text-slate-400\">\n                <li><Link href=\"/search?region=europa\" className=\"relative z-10 hover:text-blue-400 transition-colors cursor-pointer\">Europa</Link></li>\n                <li><Link href=\"/search?region=asia\" className=\"relative z-10 hover:text-blue-400 transition-colors cursor-pointer\">√Åsia</Link></li>\n                <li><Link href=\"/search?region=america\" className=\"relative z-10 hover:text-blue-400 transition-colors cursor-pointer\">Am√©rica do Sul</Link></li>\n                <li><Link href=\"/search?region=oceania\" className=\"relative z-10 hover:text-blue-400 transition-colors cursor-pointer\">Oceania</Link></li>\n              </ul>\n            </div>\n\n            {/* Suporte */}\n            <div className=\"space-y-4\">\n              <h3 className=\"font-bold text-lg text-white\">Suporte</h3>\n              <ul className=\"space-y-2 text-slate-400\">\n                <li><Link href=\"/profile\" className=\"relative z-10 hover:text-blue-400 transition-colors cursor-pointer\">Central de Ajuda</Link></li>\n                <li><Link href=\"/profile\" className=\"relative z-10 hover:text-blue-400 transition-colors cursor-pointer\">Seguran√ßa</Link></li>\n                <li><Link href=\"/terms-of-service\" className=\"relative z-10 hover:text-blue-400 transition-colors cursor-pointer\">Termos de Uso</Link></li>\n                <li><Link href=\"/privacy-policy\" className=\"relative z-10 hover:text-blue-400 transition-colors cursor-pointer\">Privacidade</Link></li>\n              </ul>\n            </div>\n          </div>\n\n          {/* Stats & Bottom */}\n          <div className=\"border-t border-slate-800 mt-12 pt-8\">\n            <div className=\"grid md:grid-cols-3 gap-8 mb-8\">\n              <div className=\"text-center\">\n                <div className=\"text-3xl font-bold text-yellow-400\">2.8k+</div>\n                <div className=\"text-slate-400\">Viajantes Conectados</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-3xl font-bold text-green-400\">65%</div>\n                <div className=\"text-slate-400\">Economia M√©dia</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-3xl font-bold text-blue-400\">85+</div>\n                <div className=\"text-slate-400\">Destinos Dispon√≠veis</div>\n              </div>\n            </div>\n\n            <div className=\"flex flex-col md:flex-row justify-between items-center text-slate-400 text-sm\">\n              <p>&copy; 2025 PartiuTrip. Todos os direitos reservados.</p>\n              <div className=\"flex items-center gap-2 mt-4 md:mt-0\">\n                <Shield className=\"w-4 h-4\" />\n                <span>Plataforma segura e verificada</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </footer>\n    </div>\n  );\n}\n\n// The code has been updated to change the brand name from \"ViajaJunto\" to \"PartiuTrip\" in the footer section.","size_bytes":44610},"client/src/pages/journey-tracker-page.tsx":{"content":"import { useState } from 'react';\nimport { JourneyProgressTracker, createDefaultMilestones, JourneyMilestone } from '@/components/journey-progress-tracker';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { MapPin, Users, Calendar, DollarSign } from 'lucide-react';\n\nexport default function JourneyTrackerPage() {\n  const [milestones, setMilestones] = useState<JourneyMilestone[]>(createDefaultMilestones('demo-trip'));\n\n  const handleMilestoneComplete = (milestoneId: string) => {\n    setMilestones(prev => \n      prev.map(milestone => \n        milestone.id === milestoneId \n          ? { ...milestone, completed: true, completedAt: new Date() }\n          : milestone\n      )\n    );\n  };\n\n  const handleResetProgress = () => {\n    setMilestones(createDefaultMilestones('demo-trip'));\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n      <div className=\"container mx-auto px-4 py-8\">\n        <div className=\"max-w-4xl mx-auto\">\n          {/* Header */}\n          <div className=\"text-center mb-8\">\n            <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-2\">\n              Rastreador de Progresso da Viagem\n            </h1>\n            <p className=\"text-gray-600 dark:text-gray-300\">\n              Acompanhe suas conquistas de viagem com celebra√ß√µes animadas e visualiza√ß√£o de progresso\n            </p>\n          </div>\n\n          {/* Demo Trip Info */}\n          <Card className=\"mb-8\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <MapPin className=\"h-5 w-5\" />\n                Viagem Demo: Aventura na Chapada Diamantina\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <div className=\"flex items-center gap-2\">\n                  <Calendar className=\"h-4 w-4 text-blue-500\" />\n                  <span className=\"text-sm\">July 15-22, 2025</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <Users className=\"h-4 w-4 text-green-500\" />\n                  <span className=\"text-sm\">4 participants</span>\n                </div>\n                <div className=\"flex items-center gap-2\">\n                  <DollarSign className=\"h-4 w-4 text-purple-500\" />\n                  <span className=\"text-sm\">$2,500 budget</span>\n                </div>\n              </div>\n              <div className=\"mt-4 flex gap-2\">\n                <Badge variant=\"secondary\">Adventure</Badge>\n                <Badge variant=\"secondary\">Nature</Badge>\n                <Badge variant=\"secondary\">Hiking</Badge>\n              </div>\n            </CardContent>\n          </Card>\n\n          {/* Progress Tracker */}\n          <JourneyProgressTracker\n            tripId=\"demo-trip\"\n            milestones={milestones}\n            onMilestoneComplete={handleMilestoneComplete}\n            className=\"mb-8\"\n          />\n\n          {/* Demo Controls */}\n          <Card>\n            <CardHeader>\n              <CardTitle>Controles Demo</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"flex flex-wrap gap-4\">\n                <Button\n                  onClick={handleResetProgress}\n                  variant=\"outline\"\n                >\n                  Reiniciar Progresso\n                </Button>\n                <Button\n                  onClick={() => {\n                    const incompleteMilestones = milestones.filter(m => !m.completed);\n                    if (incompleteMilestones.length > 0) {\n                      handleMilestoneComplete(incompleteMilestones[0].id);\n                    }\n                  }}\n                  className=\"bg-green-600 hover:bg-green-700\"\n                >\n                  Completar Pr√≥xima Meta\n                </Button>\n                <Button\n                  onClick={() => {\n                    const incompleteMilestones = milestones.filter(m => !m.completed);\n                    incompleteMilestones.forEach((milestone, index) => {\n                      setTimeout(() => {\n                        handleMilestoneComplete(milestone.id);\n                      }, index * 1000);\n                    });\n                  }}\n                  className=\"bg-blue-600 hover:bg-blue-700\"\n                >\n                  Completar Todas (Animado)\n                </Button>\n              </div>\n              <p className=\"text-sm text-gray-600 dark:text-gray-300 mt-4\">\n                Use estes controles para testar as celebra√ß√µes de marcos animadas e recursos de rastreamento de progresso.\n              </p>\n            </CardContent>\n          </Card>\n\n          {/* Features Overview */}\n          <Card className=\"mt-8\">\n            <CardHeader>\n              <CardTitle>Features</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <h4 className=\"font-semibold\">Animated Celebrations</h4>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n                    Enjoy festive animations and trophy celebrations when completing milestones\n                  </p>\n                </div>\n                <div className=\"space-y-2\">\n                  <h4 className=\"font-semibold\">Progress Visualization</h4>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n                    Track progress with animated progress bars and category breakdowns\n                  </p>\n                </div>\n                <div className=\"space-y-2\">\n                  <h4 className=\"font-semibold\">Point System</h4>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n                    Earn points for completing milestones with animated point updates\n                  </p>\n                </div>\n                <div className=\"space-y-2\">\n                  <h4 className=\"font-semibold\">Category Organization</h4>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-300\">\n                    Milestones organized by Planning, Booking, Experience, and Completion\n                  </p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":6538},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 P√°gina N√£o Encontrada</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Voc√™ esqueceu de adicionar a p√°gina ao roteador?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":725},"client/src/pages/preloader-demo.tsx":{"content":"import { useState } from \"react\";\nimport { LoadingSpinner } from \"@/components/loading-spinner\";\nimport { Navbar } from \"@/components/navbar\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nexport default function PreloaderDemo() {\n  const [isLoading, setIsLoading] = useState(false);\n  const { toast } = useToast();\n\n  const simulateLoading = () => {\n    setIsLoading(true);\n    setTimeout(() => {\n      setIsLoading(false);\n      toast({\n        title: \"Carregamento completo!\",\n        description: \"O preloader foi testado com sucesso.\",\n      });\n    }, 3000);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-cyan-50\">\n      <Navbar />\n      \n      <div className=\"container mx-auto px-4 py-8\">\n        <Card className=\"max-w-2xl mx-auto\">\n          <CardHeader>\n            <CardTitle className=\"text-2xl text-center\">\n              Demonstra√ß√£o do Preloader\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            <div className=\"text-center space-y-4\">\n              <p className=\"text-gray-600\">\n                Este √© o novo preloader animado do PartiuTrip usando anima√ß√£o Lottie profissional.\n              </p>\n              \n              <Button \n                onClick={simulateLoading}\n                disabled={isLoading}\n                className=\"w-full bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700\"\n              >\n                {isLoading ? \"Carregando...\" : \"Testar Preloader\"}\n              </Button>\n            </div>\n            \n            {/* Preloader Demo */}\n            {isLoading && (\n              <div className=\"min-h-[300px] flex items-center justify-center\">\n                <LoadingSpinner variant=\"travel\" size=\"lg\" />\n              </div>\n            )}\n            \n            {/* Preloader Variants */}\n            <div className=\"space-y-4\">\n              <h3 className=\"text-lg font-semibold\">Varia√ß√µes do Preloader:</h3>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <Card className=\"p-4\">\n                  <h4 className=\"font-medium mb-3\">Preloader Simples</h4>\n                  <div className=\"flex justify-center py-4\">\n                    <LoadingSpinner variant=\"simple\" size=\"md\" />\n                  </div>\n                </Card>\n                \n                <Card className=\"p-4\">\n                  <h4 className=\"font-medium mb-3\">Preloader de Viagem</h4>\n                  <div className=\"flex justify-center py-4\">\n                    <LoadingSpinner variant=\"travel\" size=\"md\" />\n                  </div>\n                </Card>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","size_bytes":2942},"client/src/pages/privacy-policy.tsx":{"content":"import { ArrowLeft, Shield, Users, Database, Clock, Mail, FileText, CheckCircle } from 'lucide-react';\nimport { Link } from 'wouter';\n\nexport default function PrivacyPolicy() {\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n      {/* Header */}\n      <div className=\"bg-white dark:bg-gray-800 shadow-sm\">\n        <div className=\"max-w-4xl mx-auto px-4 py-6\">\n          <Link href=\"/\" className=\"inline-flex items-center text-blue-600 hover:text-blue-800 mb-4\">\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\n            Voltar ao in√≠cio\n          </Link>\n          <div className=\"flex items-center space-x-3\">\n            <Shield className=\"w-8 h-8 text-blue-600\" />\n            <div>\n              <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white\">\n                Pol√≠tica de Privacidade\n              </h1>\n              <p className=\"text-gray-600 dark:text-gray-300 mt-1\">\n                √öltima atualiza√ß√£o: 14 de julho de 2025\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"max-w-4xl mx-auto px-4 py-8\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm\">\n          <div className=\"p-8\">\n            {/* Introduction */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <CheckCircle className=\"w-6 h-6 mr-2 text-blue-600\" />\n                1. Introdu√ß√£o\n              </h2>\n              <p className=\"text-gray-700 dark:text-gray-300 leading-relaxed\">\n                A PartiuTrip (\"n√≥s\", \"nosso\") valoriza sua privacidade. Esta Pol√≠tica explica como coletamos, usamos, compartilhamos e protegemos seus dados pessoais, em conformidade com a Lei Geral de Prote√ß√£o de Dados (LGPD - Lei 13.709/2018). Ao usar nossa plataforma, voc√™ concorda com estas pr√°ticas.\n              </p>\n            </section>\n\n            {/* Dados Coletados */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Database className=\"w-6 h-6 mr-2 text-blue-600\" />\n                2. Dados Coletados\n              </h2>\n              \n              <div className=\"space-y-6\">\n                <div>\n                  <h3 className=\"text-xl font-medium text-gray-900 dark:text-white mb-3\">\n                    a) Dados fornecidos por voc√™:\n                  </h3>\n                  <ul className=\"list-disc pl-6 space-y-2 text-gray-700 dark:text-gray-300\">\n                    <li><strong>Identifica√ß√£o:</strong> Nome, e-mail, telefone, foto de perfil</li>\n                    <li><strong>Prefer√™ncias de viagem:</strong> Estilo (praia, aventura, etc.), destinos de interesse, or√ßamento m√©dio</li>\n                    <li><strong>Conte√∫do gerado:</strong> Mensagens, planos de viagem, atividades, upload de recibos</li>\n                    <li><strong>Dados financeiros:</strong> Valores de despesas compartilhadas (n√£o coletamos dados banc√°rios ou cart√µes)</li>\n                  </ul>\n                </div>\n                \n                <div>\n                  <h3 className=\"text-xl font-medium text-gray-900 dark:text-white mb-3\">\n                    b) Coletados automaticamente:\n                  </h3>\n                  <ul className=\"list-disc pl-6 space-y-2 text-gray-700 dark:text-gray-300\">\n                    <li><strong>Dados t√©cnicos:</strong> IP, tipo de navegador, dispositivo</li>\n                    <li><strong>Uso da plataforma:</strong> P√°ginas visitadas, intera√ß√µes, tempo de sess√£o</li>\n                    <li><strong>Localiza√ß√£o aproximada:</strong> Com base no IP (para sugest√µes de destinos)</li>\n                  </ul>\n                </div>\n              </div>\n            </section>\n\n            {/* Finalidades */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <FileText className=\"w-6 h-6 mr-2 text-blue-600\" />\n                3. Finalidades do Tratamento\n              </h2>\n              \n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full border-collapse border border-gray-200 dark:border-gray-700\">\n                  <thead>\n                    <tr className=\"bg-gray-50 dark:bg-gray-700\">\n                      <th className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-left text-gray-900 dark:text-white font-medium\">\n                        Finalidade\n                      </th>\n                      <th className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-left text-gray-900 dark:text-white font-medium\">\n                        Base Legal (LGPD)\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Criar e gerenciar sua conta\n                      </td>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Execu√ß√£o de contrato (Art. 7¬∫, V)\n                      </td>\n                    </tr>\n                    <tr>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Conectar voc√™ a companheiros de viagem\n                      </td>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Leg√≠timo interesse (Art. 7¬∫, IX)\n                      </td>\n                    </tr>\n                    <tr>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Calcular divis√£o de despesas\n                      </td>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Consentimento (Art. 7¬∫, I)\n                      </td>\n                    </tr>\n                    <tr>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Enviar notifica√ß√µes sobre viagens\n                      </td>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Execu√ß√£o de contrato\n                      </td>\n                    </tr>\n                    <tr>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Melhorar nossos servi√ßos\n                      </td>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Leg√≠timo interesse\n                      </td>\n                    </tr>\n                    <tr>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Cumprir obriga√ß√µes legais\n                      </td>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Obriga√ß√£o legal (Art. 7¬∫, II)\n                      </td>\n                    </tr>\n                  </tbody>\n                </table>\n              </div>\n            </section>\n\n            {/* Compartilhamento */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Users className=\"w-6 h-6 mr-2 text-blue-600\" />\n                4. Compartilhamento de Dados\n              </h2>\n              \n              <p className=\"text-gray-700 dark:text-gray-300 mb-4\">\n                Compartilhamos informa√ß√µes apenas quando necess√°rio:\n              </p>\n              \n              <ul className=\"list-disc pl-6 space-y-2 text-gray-700 dark:text-gray-300\">\n                <li><strong>Com outros usu√°rios:</strong> Perfil b√°sico (nome, foto) e mensagens para participantes da mesma viagem</li>\n                <li><strong>Com prestadores de servi√ßo:</strong> Hospedagem em nuvem (AWS Brasil), ferramentas de an√°lise (Google Analytics anonimizado)</li>\n                <li><strong>Com autoridades:</strong> Para cumprir ordens judiciais ou leis aplic√°veis</li>\n              </ul>\n              \n              <div className=\"mt-4 p-4 bg-blue-50 dark:bg-blue-900/30 rounded-lg\">\n                <p className=\"text-blue-800 dark:text-blue-200 font-medium\">\n                  Nunca vendemos seus dados pessoais.\n                </p>\n              </div>\n            </section>\n\n            {/* Seguran√ßa */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Shield className=\"w-6 h-6 mr-2 text-blue-600\" />\n                5. Seguran√ßa de Dados\n              </h2>\n              \n              <div className=\"grid md:grid-cols-2 gap-4\">\n                <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n                  <h3 className=\"font-medium text-gray-900 dark:text-white mb-2\">Criptografia</h3>\n                  <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                    Dados em tr√¢nsito (HTTPS) e em repouso\n                  </p>\n                </div>\n                <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n                  <h3 className=\"font-medium text-gray-900 dark:text-white mb-2\">Acesso restrito</h3>\n                  <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                    Apenas pessoal autorizado\n                  </p>\n                </div>\n                <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n                  <h3 className=\"font-medium text-gray-900 dark:text-white mb-2\">Monitoramento</h3>\n                  <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                    Cont√≠nuo para detectar viola√ß√µes\n                  </p>\n                </div>\n                <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n                  <h3 className=\"font-medium text-gray-900 dark:text-white mb-2\">Backups</h3>\n                  <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                    Di√°rios em servidores seguros no Brasil\n                  </p>\n                </div>\n              </div>\n            </section>\n\n            {/* Reten√ß√£o */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Clock className=\"w-6 h-6 mr-2 text-blue-600\" />\n                6. Reten√ß√£o de Dados\n              </h2>\n              \n              <ul className=\"list-disc pl-6 space-y-2 text-gray-700 dark:text-gray-300\">\n                <li><strong>Conta ativa:</strong> Enquanto voc√™ usar a plataforma</li>\n                <li><strong>Ap√≥s inatividade:</strong> 2 anos (exceto dados legais)</li>\n                <li><strong>Recibos:</strong> Exclu√≠dos automaticamente ap√≥s 180 dias</li>\n                <li><strong>Exclus√£o total:</strong> Solicita√ß√£o via Se√ß√£o 8</li>\n              </ul>\n            </section>\n\n            {/* Direitos LGPD */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <CheckCircle className=\"w-6 h-6 mr-2 text-blue-600\" />\n                8. Seus Direitos LGPD\n              </h2>\n              \n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full border-collapse border border-gray-200 dark:border-gray-700\">\n                  <thead>\n                    <tr className=\"bg-gray-50 dark:bg-gray-700\">\n                      <th className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-left text-gray-900 dark:text-white font-medium\">\n                        Direito\n                      </th>\n                      <th className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-left text-gray-900 dark:text-white font-medium\">\n                        Como exercer\n                      </th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Acesso aos dados\n                      </td>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Via portal do usu√°rio ou e-mail\n                      </td>\n                    </tr>\n                    <tr>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Corre√ß√£o de dados\n                      </td>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Atualize seu perfil ou solicite\n                      </td>\n                    </tr>\n                    <tr>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Exclus√£o (\"esquecimento\")\n                      </td>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Solicite em privacidade@partiutrip.com\n                      </td>\n                    </tr>\n                    <tr>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Portabilidade\n                      </td>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Receba dados em formato leg√≠vel\n                      </td>\n                    </tr>\n                    <tr>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Revogar consentimento\n                      </td>\n                      <td className=\"border border-gray-200 dark:border-gray-600 px-4 py-3 text-gray-700 dark:text-gray-300\">\n                        Ajuste configura√ß√µes de conta\n                      </td>\n                    </tr>\n                  </tbody>\n                </table>\n              </div>\n              \n              <div className=\"mt-4 p-4 bg-green-50 dark:bg-green-900/30 rounded-lg\">\n                <p className=\"text-green-800 dark:text-green-200 font-medium\">\n                  Prazo de resposta: 15 dias √∫teis.\n                </p>\n              </div>\n            </section>\n\n            {/* Contato */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Mail className=\"w-6 h-6 mr-2 text-blue-600\" />\n                11. Encarregado de Dados (DPO)\n              </h2>\n              \n              <div className=\"p-6 bg-blue-50 dark:bg-blue-900/30 rounded-lg\">\n                <p className=\"text-blue-800 dark:text-blue-200 mb-2\">\n                  Entre em contato para exercer seus direitos:\n                </p>\n                <p className=\"text-blue-800 dark:text-blue-200 font-medium\">\n                  E-mail: dpo@partiutrip.com\n                </p>\n              </div>\n            </section>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":16368},"client/src/pages/profile.tsx":{"content":"import { useAuth } from \"@/hooks/use-auth-snake\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useState, useRef } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { UserAvatar } from \"@/components/ui/user-avatar\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { DropdownMenu, DropdownMenuContent, DropdownMenuItem, DropdownMenuTrigger } from \"@/components/ui/dropdown-menu\";\nimport { toast } from \"@/hooks/use-toast\";\nimport { \n  User, \n  Edit3, \n  MapPin, \n  Languages, \n  Heart, \n  Share2, \n  Users, \n  Award,\n  Copy,\n  Check,\n  UserPlus,\n  Star,\n  Calendar,\n  Plane,\n  Luggage,\n  Compass,\n  Map,\n  Trophy,\n  Shield,\n  Target,\n  TrendingUp,\n  DollarSign,\n  MessageCircle,\n  Zap,\n  Globe,\n  ChevronRight,\n  ExternalLink,\n  Gift,\n  Crown,\n  Sparkles,\n  ThumbsUp,\n  Settings,\n  Share,\n  Mail,\n  MessageSquare,\n\n  Camera,\n  Image,\n  Upload,\n  Trash2,\n  MoreVertical,\n  UserMinus\n} from \"lucide-react\";\nimport { LoadingSpinner } from \"@/components/loading-spinner\";\nimport { motion } from \"framer-motion\";\n\n// Fun√ß√£o para formata√ß√£o de telefone (xx) xxxxx-xxxx\nconst formatPhoneNumber = (value: string) => {\n  // Remove todos os caracteres n√£o num√©ricos\n  const onlyNumbers = value.replace(/\\D/g, '');\n  \n  // Aplica a formata√ß√£o baseada no n√∫mero de d√≠gitos\n  if (onlyNumbers.length <= 2) {\n    return onlyNumbers;\n  } else if (onlyNumbers.length <= 7) {\n    return `(${onlyNumbers.slice(0, 2)}) ${onlyNumbers.slice(2)}`;\n  } else if (onlyNumbers.length <= 11) {\n    return `(${onlyNumbers.slice(0, 2)}) ${onlyNumbers.slice(2, 7)}-${onlyNumbers.slice(7)}`;\n  } else {\n    // Limita a 11 d√≠gitos\n    return `(${onlyNumbers.slice(0, 2)}) ${onlyNumbers.slice(2, 7)}-${onlyNumbers.slice(7, 11)}`;\n  }\n};\n\nconst profileSchema = z.object({\n  full_name: z.string().min(2, \"Nome deve ter pelo menos 2 caracteres\"),\n  email: z.string().email(\"Email inv√°lido\"),\n  phone: z.string().min(10, \"Telefone deve ter pelo menos 10 d√≠gitos\").max(20, \"Telefone deve ter no m√°ximo 20 d√≠gitos\"),\n  bio: z.string().max(500, \"Bio deve ter no m√°ximo 500 caracteres\").optional(),\n  location: z.string().min(2, \"Localiza√ß√£o deve ter pelo menos 2 caracteres\"),\n  languages: z.array(z.string()).min(1, \"Selecione pelo menos um idioma\"),\n  interests: z.array(z.string()).min(1, \"Selecione pelo menos um interesse\"),\n  travel_styles: z.array(z.string()).min(1, \"Selecione pelo menos um estilo de viagem\")\n});\n\ntype ProfileFormData = z.infer<typeof profileSchema>;\n\nconst availableLanguages = [\n  \"Portugu√™s\", \"Ingl√™s\", \"Espanhol\", \"Franc√™s\", \"Alem√£o\", \"Italiano\", \"Japon√™s\", \"Mandarim\", \"Russo\", \"√Årabe\"\n];\n\nconst availableInterests = [\n  \"Aventura\", \"Praia\", \"Cultura\", \"Gastronomia\", \"Natureza\", \"Hist√≥ria\", \"Arquitetura\", \"Museus\", \n  \"Fotografia\", \"M√∫sica\", \"Dan√ßa\", \"Esportes\", \"Montanha\", \"Mergulho\", \"Surfe\", \"Trilhas\"\n];\n\nconst travelStyles = [\n  { value: \"praia\", label: \"Praia\" },\n  { value: \"neve\", label: \"Neve\" },\n  { value: \"cruzeiros\", label: \"Cruzeiros\" },\n  { value: \"natureza\", label: \"Natureza e Ecoturismo\" },\n  { value: \"culturais\", label: \"Culturais e Hist√≥ricas\" },\n  { value: \"aventura\", label: \"Aventura\" },\n  { value: \"urbanas\", label: \"Viagens Urbanas / Cidades Grandes\" },\n  { value: \"parques\", label: \"Parques Tem√°ticos\" }\n];\n\nexport default function ProfilePage() {\n  const { user } = useAuth();\n  const queryClient = useQueryClient();\n  const [isEditing, setIsEditing] = useState(false);\n  const [copiedCode, setCopiedCode] = useState(false);\n  const [showAvatarUpload, setShowAvatarUpload] = useState(false);\n  const [showCoverUpload, setShowCoverUpload] = useState(false);\n  const [selectedCompanion, setSelectedCompanion] = useState<any>(null);\n  const [showRateDialog, setShowRateDialog] = useState(false);\n  const [rating, setRating] = useState(5);\n  const [ratingComment, setRatingComment] = useState(\"\");\n  const avatarInputRef = useRef<HTMLInputElement>(null);\n  const coverInputRef = useRef<HTMLInputElement>(null);\n\n  const form = useForm<ProfileFormData>({\n    resolver: zodResolver(profileSchema),\n    defaultValues: {\n      full_name: user?.full_name || \"\",\n      email: user?.email || \"\",\n      phone: user?.phone ? formatPhoneNumber(user.phone) : \"\",\n      bio: user?.bio || \"\",\n      location: user?.location || \"\",\n      languages: user?.languages ? (Array.isArray(user.languages) ? user.languages : (typeof user.languages === 'string' ? JSON.parse(user.languages || '[]') : [])) : [],\n      interests: user?.interests ? (Array.isArray(user.interests) ? user.interests : (typeof user.interests === 'string' ? JSON.parse(user.interests || '[]') : [])) : [],\n      travel_styles: user?.travel_styles ? (Array.isArray(user.travel_styles) ? user.travel_styles : (typeof user.travel_styles === 'string' ? JSON.parse(user.travel_styles || '[]') : [])) : []\n    }\n  });\n\n  // Fetch user stats\n  const { data: userStats, isLoading: statsLoading, error: statsError } = useQuery({\n    queryKey: [\"/api/user/stats\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/user/stats\", {\n        credentials: 'include'\n      });\n      if (!response.ok) throw new Error('Failed to fetch stats');\n      return response.json();\n    },\n    enabled: !!user,\n    retry: 1\n  });\n\n  // Fetch referral code and referred users\n  const { data: referralData, isLoading: referralLoading, error: referralError } = useQuery({\n    queryKey: [\"/api/user/referral\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/user/referral\", {\n        credentials: 'include'\n      });\n      if (!response.ok) throw new Error('Failed to fetch referral data');\n      return response.json();\n    },\n    enabled: !!user,\n    retry: 1\n  });\n\n  // Fetch travel companions\n  const { data: travelCompanions, isLoading: companionsLoading, error: companionsError } = useQuery({\n    queryKey: [\"/api/user/travel-companions\"],\n    queryFn: async () => {\n      const response = await fetch(\"/api/user/travel-companions\", {\n        credentials: 'include'\n      });\n      if (!response.ok) throw new Error('Failed to fetch travel companions');\n      return response.json();\n    },\n    enabled: !!user,\n    retry: 1\n  });\n\n  const updateProfileMutation = useMutation({\n    mutationFn: async (data: ProfileFormData) => {\n      const response = await fetch(\"/api/user/profile\", {\n        method: \"PUT\",\n        headers: { \n          \"Content-Type\": \"application/json\",\n          \"Cache-Control\": \"no-cache\"\n        },\n        body: JSON.stringify(data)\n      });\n      \n      if (!response.ok) throw new Error(\"Erro ao atualizar perfil\");\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"Perfil atualizado com sucesso!\" });\n      setIsEditing(false);\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n    },\n    onError: () => {\n      toast({ \n        title: \"Erro ao atualizar perfil\", \n        description: \"Tente novamente mais tarde\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  // Mutation to rate a travel companion\n  const rateCompanionMutation = useMutation({\n    mutationFn: async ({ companionId, rating, comment }: { companionId: number, rating: number, comment: string }) => {\n      const response = await fetch(\"/api/user/rate-companion\", {\n        method: \"POST\",\n        headers: { \n          \"Content-Type\": \"application/json\",\n          \"Cache-Control\": \"no-cache\"\n        },\n        credentials: 'include',\n        body: JSON.stringify({ companionId, rating, comment })\n      });\n      \n      if (!response.ok) {\n        const errorData = await response.json().catch(() => ({}));\n        throw new Error(errorData.message || \"Erro ao avaliar companheiro\");\n      }\n      return response.json();\n    },\n    onSuccess: (data) => {\n      toast({ title: \"Avalia√ß√£o enviada com sucesso!\" });\n      setShowRateDialog(false);\n      setRating(5);\n      setRatingComment(\"\");\n      // Invalidate multiple queries to update the UI\n      queryClient.invalidateQueries({ queryKey: [\"/api/user/travel-companions\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/user/stats\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      // Invalidate the specific user's ratings if showing their profile\n      if (selectedCompanion?.id) {\n        queryClient.invalidateQueries({ queryKey: [`/api/user/${selectedCompanion.id}/ratings`] });\n      }\n    },\n    onError: (error: Error) => {\n      toast({ \n        title: \"Erro ao enviar avalia√ß√£o\", \n        description: error.message || \"Tente novamente mais tarde\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  // Mutation to remove a travel companion\n  const removeCompanionMutation = useMutation({\n    mutationFn: async (companionId: number) => {\n      const response = await fetch(`/api/user/remove-companion/${companionId}`, {\n        method: \"DELETE\",\n        headers: { \n          \"Cache-Control\": \"no-cache\"\n        },\n        credentials: 'include'\n      });\n      \n      if (!response.ok) throw new Error(\"Erro ao remover companheiro\");\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"Companheiro removido da sua rede!\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/user/travel-companions\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/user/stats\"] });\n    },\n    onError: () => {\n      toast({ \n        title: \"Erro ao remover companheiro\", \n        description: \"Tente novamente mais tarde\",\n        variant: \"destructive\"\n      });\n    }\n  });\n\n  const handleUpdateProfile = (data: ProfileFormData) => {\n    updateProfileMutation.mutate(data);\n  };\n\n  const copyReferralCode = () => {\n    if (referralData?.code) {\n      navigator.clipboard.writeText(referralData.code);\n      setCopiedCode(true);\n      toast({ title: \"C√≥digo copiado!\" });\n      setTimeout(() => setCopiedCode(false), 2000);\n    }\n  };\n\n  const getInitials = (name: string) => {\n    return name.split(\" \").map(n => n[0]).join(\"\").toUpperCase();\n  };\n\n  // Handle rating companion\n  const handleRateCompanion = (companion: any) => {\n    setSelectedCompanion(companion);\n    setShowRateDialog(true);\n  };\n\n  // Handle remove companion\n  const handleRemoveCompanion = (companionId: number) => {\n    removeCompanionMutation.mutate(companionId);\n  };\n\n  // Submit rating\n  const submitRating = () => {\n    if (selectedCompanion) {\n      rateCompanionMutation.mutate({\n        companionId: selectedCompanion.id,\n        rating,\n        comment: ratingComment\n      });\n    }\n  };\n\n  // Render star rating component\n  const renderStarRating = (currentRating: number, onRatingChange?: (rating: number) => void) => {\n    return (\n      <div className=\"flex gap-1\">\n        {[1, 2, 3, 4, 5].map((star) => (\n          <button\n            key={star}\n            type=\"button\"\n            onClick={() => onRatingChange?.(star)}\n            className={`text-2xl ${star <= currentRating ? 'text-yellow-400' : 'text-gray-300'} hover:text-yellow-400 transition-colors`}\n            disabled={!onRatingChange}\n          >\n            ‚òÖ\n          </button>\n        ))}\n      </div>\n    );\n  };\n\n  // Debug logging\n  console.log(\"Profile Debug:\", {\n    user: user?.username,\n    userStats,\n    referralData,\n    statsLoading,\n    referralLoading,\n    statsError: statsError?.message,\n    referralError: referralError?.message\n  });\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <LoadingSpinner variant=\"travel\" size=\"lg\" message=\"Carregando perfil...\" />\n      </div>\n    );\n  }\n\n  // Fun√ß√µes auxiliares para o novo design\n  const getTravelerLevel = (completedTrips: number) => {\n    if (completedTrips >= 20) return { level: \"Embaixador\", color: \"from-orange-500 to-red-500\", progress: 100 };\n    if (completedTrips >= 10) return { level: \"Explorador\", color: \"from-blue-500 to-cyan-500\", progress: (completedTrips - 10) / 10 * 100 };\n    if (completedTrips >= 5) return { level: \"Aventureiro\", color: \"from-green-500 to-emerald-500\", progress: (completedTrips - 5) / 5 * 100 };\n    return { level: \"Iniciante\", color: \"from-gray-500 to-gray-600\", progress: completedTrips / 5 * 100 };\n  };\n\n  const getAchievements = () => {\n    const achievements = [];\n    const completed = userStats?.completedTrips || 0;\n    \n    if (completed >= 2) achievements.push({ name: \"Globetrotter\", icon: Globe, description: \"2+ viagens completadas\", color: \"text-blue-500\" });\n    if (completed >= 5) achievements.push({ name: \"Aventureiro\", icon: Compass, description: \"5+ viagens completadas\", color: \"text-green-500\" });\n    if (completed >= 10) achievements.push({ name: \"Explorador\", icon: Map, description: \"10+ viagens completadas\", color: \"text-purple-500\" });\n    if (userStats?.travelPartners >= 5) achievements.push({ name: \"Social Traveler\", icon: Users, description: \"5+ conex√µes de viagem\", color: \"text-orange-500\" });\n    \n    return achievements;\n  };\n\n  const shareOnWhatsApp = () => {\n    const message = `Ol√°! Estou usando o PartiuTrip para encontrar companheiros de viagem e economizar nos custos. Use meu c√≥digo ${referralData?.code} e ganhe acesso √† plataforma tamb√©m! https://partiutrip.com`;\n    const encodedMessage = encodeURIComponent(message);\n    window.open(`https://wa.me/?text=${encodedMessage}`, '_blank');\n  };\n\n  const shareByEmail = () => {\n    const subject = \"Convite PartiuTrip - Viaje junto e economize!\";\n    const body = `Ol√°!\\n\\nEstou usando o PartiuTrip para encontrar companheiros de viagem e economizar nos custos. √â uma plataforma incr√≠vel onde voc√™ pode compartilhar viagens com pessoas que t√™m os mesmos interesses!\\n\\nUse meu c√≥digo ${referralData?.code} e ganhe acesso √† plataforma tamb√©m.\\n\\nAcesse: https://partiutrip.com\\n\\nVamos viajar juntos!`;\n    window.open(`mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`, '_blank');\n  };\n\n  const handleAvatarUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      // Simulated avatar upload - in a real app, you'd upload to a service\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        // Here you would typically upload to your server/cloud storage\n        toast({\n          title: \"Avatar atualizado!\",\n          description: \"Sua foto de perfil foi atualizada com sucesso.\",\n        });\n        setShowAvatarUpload(false);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handleCoverUpload = (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (file) {\n      // Simulated cover upload - in a real app, you'd upload to a service\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        // Here you would typically upload to your server/cloud storage\n        toast({\n          title: \"Capa atualizada!\",\n          description: \"Sua imagem de capa foi atualizada com sucesso.\",\n        });\n        setShowCoverUpload(false);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const triggerAvatarUpload = () => {\n    avatarInputRef.current?.click();\n  };\n\n  const triggerCoverUpload = () => {\n    coverInputRef.current?.click();\n  };\n\n  return (\n    <div className=\"min-h-screen\" style={{ background: '#F5F9FC' }}>\n      <div className=\"container mx-auto px-3 sm:px-4 py-4 sm:py-6 md:py-8 max-w-7xl\">\n        {/* Header Moderno do Perfil */}\n        <motion.div \n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"relative mb-6 sm:mb-8\"\n        >\n          {/* Banner din√¢mico com mosaico de destinos - responsivo */}\n          <div className=\"relative h-48 sm:h-56 md:h-64 rounded-xl sm:rounded-2xl overflow-hidden mb-4 sm:mb-6\"\n               style={{ \n                 backgroundImage: `linear-gradient(45deg, #1B2B49 0%, #41B6FF 50%, #FFA500 100%)`,\n                 backgroundSize: 'cover'\n               }}>\n            <div className=\"absolute inset-0 bg-black/20\"></div>\n            \n            {/* Bot√£o para alterar cover - responsivo */}\n            <button\n              onClick={() => setShowCoverUpload(true)}\n              className=\"absolute top-3 right-3 sm:top-4 sm:right-4 p-1.5 sm:p-2 bg-white/20 backdrop-blur-sm rounded-lg hover:bg-white/30 transition-colors\"\n            >\n              <Camera className=\"h-4 w-4 sm:h-5 sm:w-5 text-white\" />\n            </button>\n            \n            {/* Elementos de viagem flutuantes - responsivo */}\n            <div className=\"absolute top-3 left-3 sm:top-4 sm:left-4 flex gap-1.5 sm:gap-2\">\n              <div className=\"p-1.5 sm:p-2 bg-white/20 backdrop-blur-sm rounded-lg\">\n                <Plane className=\"h-4 w-4 sm:h-5 sm:w-5 text-white\" />\n              </div>\n              <div className=\"p-1.5 sm:p-2 bg-white/20 backdrop-blur-sm rounded-lg\">\n                <Luggage className=\"h-4 w-4 sm:h-5 sm:w-5 text-white\" />\n              </div>\n              <div className=\"p-1.5 sm:p-2 bg-white/20 backdrop-blur-sm rounded-lg hidden sm:block\">\n                <Compass className=\"h-4 w-4 sm:h-5 sm:w-5 text-white\" />\n              </div>\n            </div>\n            \n            {/* Avatar interativo - posicionamento responsivo */}\n            <div className=\"absolute bottom-4 sm:bottom-6 left-4 sm:left-8\">\n              <div className=\"relative\">\n                <div className=\"absolute -inset-1 bg-gradient-to-r from-orange-500 to-red-500 rounded-full animate-pulse\"></div>\n                <UserAvatar \n                  user={user}\n                  size=\"xl\"\n                  className=\"relative h-20 w-20 sm:h-24 sm:w-24 md:h-32 md:w-32 border-4 border-white shadow-xl\"\n                />\n                \n                {/* Bot√£o para alterar avatar - tamanho responsivo */}\n                <button\n                  onClick={() => setShowAvatarUpload(true)}\n                  className=\"absolute bottom-1 right-1 sm:bottom-2 sm:right-2 p-1 sm:p-2 bg-white/90 backdrop-blur-sm rounded-full hover:bg-white transition-colors shadow-lg\"\n                >\n                  <Camera className=\"h-3 w-3 sm:h-4 sm:w-4 text-gray-600\" />\n                </button>\n                \n                {/* Badge responsivo */}\n                <div className=\"absolute -bottom-1 sm:-bottom-2 left-1/2 transform -translate-x-1/2\">\n                  <div className={`px-1.5 py-0.5 sm:px-2 sm:py-1 rounded-full text-xs font-medium text-white bg-gradient-to-r ${getTravelerLevel(userStats?.completedTrips || 0).color} shadow-md border border-white/30 backdrop-blur-sm`}>\n                    {getTravelerLevel(userStats?.completedTrips || 0).level}\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          {/* Informa√ß√µes do perfil - layout responsivo */}\n          <div className=\"px-4 sm:px-6 md:ml-8 mt-4\">\n            <h1 className=\"text-xl sm:text-2xl md:text-3xl font-bold mb-2\" style={{ color: '#1B2B49' }}>\n              {user.full_name}\n            </h1>\n            <div className=\"flex flex-wrap items-center gap-2 sm:gap-4 mb-4 text-sm sm:text-base\">\n              <div className=\"flex items-center gap-2\" style={{ color: '#AAB0B7' }}>\n                <MapPin className=\"h-4 w-4\" />\n                <span>{user.location}</span>\n              </div>\n              <div className=\"flex items-center gap-2\" style={{ color: '#AAB0B7' }}>\n                <Star className=\"h-4 w-4\" />\n                <span>{userStats?.averageRating || '5.0'} ‚≠ê</span>\n              </div>\n              {user.phone && (\n                <div className=\"flex items-center gap-2\" style={{ color: '#AAB0B7' }}>\n                  <User className=\"h-4 w-4\" />\n                  <span>{user.phone}</span>\n                </div>\n              )}\n              {user.languages && user.languages.length > 0 && (\n                <div className=\"flex items-center gap-2\" style={{ color: '#AAB0B7' }}>\n                  <Languages className=\"h-4 w-4\" />\n                  <span>{Array.isArray(user.languages) ? user.languages.join(', ') : (typeof user.languages === 'string' ? (() => { try { const parsed = JSON.parse(user.languages); return Array.isArray(parsed) ? parsed.join(', ') : ''; } catch { return ''; } })() : '')}</span>\n                </div>\n              )}\n            </div>\n            \n            {/* Bio edit√°vel - responsivo */}\n            <p className=\"text-gray-600 max-w-2xl mb-3 sm:mb-4 text-sm sm:text-base leading-relaxed\">\n              {user.bio || \"Aventureiro em busca de novas experi√™ncias e conex√µes incr√≠veis!\"}\n            </p>\n            \n            {/* Estilos de viagem preferidos */}\n            {user.travel_styles && (\n              <div className=\"mb-4\">\n                <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Estilo de Viagem</h4>\n                <div className=\"flex flex-wrap gap-2\">\n                  <Badge variant=\"secondary\" className=\"bg-gradient-to-r from-blue-100 to-cyan-100 text-blue-800\">\n                    {Array.isArray(user.travel_styles) ? user.travel_styles.map(style => travelStyles.find(s => s.value === style)?.label).filter(Boolean).join(', ') : 'N√£o informado'}\n                  </Badge>\n                </div>\n              </div>\n            )}\n            \n            {/* Interesses */}\n            {user.interests && (() => {\n              try {\n                const interests = Array.isArray(user.interests) ? user.interests : JSON.parse(user.interests || '[]');\n                return Array.isArray(interests) && interests.length > 0;\n              } catch {\n                return false;\n              }\n            })() && (\n              <div className=\"mb-4\">\n                <h4 className=\"text-sm font-medium text-gray-700 mb-2\">Interesses</h4>\n                <div className=\"flex flex-wrap gap-2\">\n                  {(() => {\n                    try {\n                      const interests = Array.isArray(user.interests) ? user.interests : JSON.parse(user.interests || '[]');\n                      return Array.isArray(interests) ? interests : [];\n                    } catch {\n                      return [];\n                    }\n                  })().map((interest) => (\n                    <Badge key={interest} variant=\"outline\" className=\"bg-gradient-to-r from-green-100 to-emerald-100 text-green-800 border-green-200\">\n                      {interest}\n                    </Badge>\n                  ))}\n                </div>\n              </div>\n            )}\n            \n            {/* Informa√ß√µes de Contato */}\n            <div className=\"flex flex-wrap gap-6 text-sm\" style={{ color: '#AAB0B7' }}>\n              <div className=\"flex items-center gap-2\">\n                <Mail className=\"h-4 w-4\" />\n                <span>{user.email}</span>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                <Calendar className=\"h-4 w-4\" />\n                <span>Membro desde {new Date(user.created_at || '2025-01-01').toLocaleDateString('pt-BR', { month: 'long', year: 'numeric' })}</span>\n              </div>\n            </div>\n          </div>\n        </motion.div>\n\n        <Tabs defaultValue=\"stats\" className=\"space-y-6 sm:space-y-8\">\n          <TabsList className=\"grid w-full grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 h-auto min-h-[3rem] sm:min-h-[3.5rem] bg-white/80 backdrop-blur-sm border-0 shadow-lg rounded-2xl gap-1 p-1\">\n            <TabsTrigger value=\"stats\" className=\"data-[state=active]:bg-gradient-to-r data-[state=active]:from-blue-500 data-[state=active]:to-cyan-500 data-[state=active]:text-white rounded-xl px-2 py-2 sm:px-4 sm:py-3 flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm font-medium transition-all duration-300\">\n              <Award className=\"h-3 w-3 sm:h-4 sm:w-4 flex-shrink-0\" />\n              <span className=\"hidden sm:inline truncate\">Estat√≠sticas</span>\n              <span className=\"sm:hidden text-[10px] leading-tight\">Stats</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"partiuamigos\" className=\"data-[state=active]:bg-gradient-to-r data-[state=active]:from-orange-500 data-[state=active]:to-red-500 data-[state=active]:text-white rounded-xl px-2 py-2 sm:px-4 sm:py-3 flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm font-medium transition-all duration-300\">\n              <Gift className=\"h-3 w-3 sm:h-4 sm:w-4 flex-shrink-0\" />\n              <span className=\"hidden sm:inline truncate\">PartiuAmigos</span>\n              <span className=\"sm:hidden text-[10px] leading-tight\">Amigos</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"connections\" className=\"data-[state=active]:bg-gradient-to-r data-[state=active]:from-green-500 data-[state=active]:to-emerald-500 data-[state=active]:text-white rounded-xl px-2 py-2 sm:px-4 sm:py-3 flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm font-medium transition-all duration-300 col-span-2 sm:col-span-1\">\n              <Users className=\"h-3 w-3 sm:h-4 sm:w-4 flex-shrink-0\" />\n              <span className=\"hidden sm:inline lg:inline truncate\">Conex√µes</span>\n              <span className=\"sm:hidden lg:hidden text-[10px] leading-tight\">Rede</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"achievements\" className=\"data-[state=active]:bg-gradient-to-r data-[state=active]:from-purple-500 data-[state=active]:to-indigo-500 data-[state=active]:text-white rounded-xl px-2 py-2 sm:px-4 sm:py-3 flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm font-medium transition-all duration-300\">\n              <Trophy className=\"h-3 w-3 sm:h-4 sm:w-4 flex-shrink-0\" />\n              <span className=\"hidden sm:inline lg:inline truncate\">Conquistas</span>\n              <span className=\"sm:hidden lg:hidden text-[10px] leading-tight\">Pr√™mios</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"profile\" className=\"data-[state=active]:bg-gradient-to-r data-[state=active]:from-gray-500 data-[state=active]:to-gray-600 data-[state=active]:text-white rounded-xl px-2 py-2 sm:px-4 sm:py-3 flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 text-xs sm:text-sm font-medium transition-all duration-300\">\n              <Settings className=\"h-3 w-3 sm:h-4 sm:w-4 flex-shrink-0\" />\n              <span className=\"hidden sm:inline lg:inline truncate\">Configura√ß√µes</span>\n              <span className=\"sm:hidden lg:hidden text-[10px] leading-tight\">Config</span>\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Aba de Estat√≠sticas */}\n          <TabsContent value=\"stats\" className=\"space-y-4 sm:space-y-6\">\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-6\">\n              {/* Total de Viagens */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.1 }}\n              >\n                <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"text-sm font-medium\" style={{ color: '#AAB0B7' }}>Total de Viagens</p>\n                        <p className=\"text-3xl font-bold\" style={{ color: '#1B2B49' }}>\n                          {userStats?.totalTrips || 0}\n                        </p>\n                      </div>\n                      <div className=\"p-3 rounded-full bg-gradient-to-r from-blue-500 to-cyan-500\">\n                        <Plane className=\"h-6 w-6 text-white\" />\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n\n              {/* Viagens Conclu√≠das */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.2 }}\n              >\n                <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"text-sm font-medium\" style={{ color: '#AAB0B7' }}>Conclu√≠das</p>\n                        <p className=\"text-3xl font-bold\" style={{ color: '#1B2B49' }}>\n                          {userStats?.completedTrips || 0}\n                        </p>\n                      </div>\n                      <div className=\"p-3 rounded-full bg-gradient-to-r from-green-500 to-emerald-500\">\n                        <Check className=\"h-6 w-6 text-white\" />\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n\n              {/* Parceiros de Viagem */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.3 }}\n              >\n                <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"text-sm font-medium\" style={{ color: '#AAB0B7' }}>Parceiros</p>\n                        <p className=\"text-3xl font-bold\" style={{ color: '#1B2B49' }}>\n                          {userStats?.travelPartners || 0}\n                        </p>\n                      </div>\n                      <div className=\"p-3 rounded-full bg-gradient-to-r from-purple-500 to-indigo-500\">\n                        <Users className=\"h-6 w-6 text-white\" />\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n\n              {/* Avalia√ß√£o M√©dia */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.4 }}\n              >\n                <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center justify-between\">\n                      <div>\n                        <p className=\"text-sm font-medium\" style={{ color: '#AAB0B7' }}>Avalia√ß√£o</p>\n                        <p className=\"text-3xl font-bold\" style={{ color: '#1B2B49' }}>\n                          {userStats?.averageRating || '5.0'}\n                        </p>\n                      </div>\n                      <div className=\"p-3 rounded-full bg-gradient-to-r from-orange-500 to-red-500\">\n                        <Star className=\"h-6 w-6 text-white\" />\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            </div>\n\n            {/* Progresso do N√≠vel */}\n            <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\" style={{ color: '#1B2B49' }}>\n                  <Crown className=\"h-5 w-5\" />\n                  Progresso do Viajante\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  <div className=\"flex justify-between items-center\">\n                    <span className=\"text-sm font-medium\" style={{ color: '#AAB0B7' }}>\n                      N√≠vel Atual: {getTravelerLevel(userStats?.completedTrips || 0).level}\n                    </span>\n                    <span className=\"text-sm\" style={{ color: '#AAB0B7' }}>\n                      {userStats?.completedTrips || 0} / {userStats?.completedTrips >= 20 ? 20 : userStats?.completedTrips >= 10 ? 20 : userStats?.completedTrips >= 5 ? 10 : 5} viagens\n                    </span>\n                  </div>\n                  <Progress \n                    value={getTravelerLevel(userStats?.completedTrips || 0).progress} \n                    className=\"h-3\"\n                  />\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Aba do Programa PartiuAmigos */}\n          <TabsContent value=\"partiuamigos\" className=\"space-y-4 sm:space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6\">\n              {/* C√≥digo de Indica√ß√£o */}\n              <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\" style={{ color: '#1B2B49' }}>\n                    <Gift className=\"h-5 w-5\" />\n                    C√≥digo de Indica√ß√£o\n                  </CardTitle>\n                  <CardDescription>\n                    Compartilhe e ganhe benef√≠cios exclusivos\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    <div className=\"p-4 bg-gradient-to-r from-orange-500 to-red-500 rounded-xl text-center\">\n                      <div className=\"text-2xl font-bold text-white tracking-wider\">\n                        {referralData?.code || \"LOADING...\"}\n                      </div>\n                    </div>\n                    \n                    <div className=\"flex flex-col sm:flex-row gap-2\">\n                      <Button\n                        onClick={copyReferralCode}\n                        variant=\"outline\"\n                        className=\"flex-1\"\n                      >\n                        {copiedCode ? <Check className=\"h-4 w-4 mr-2\" /> : <Copy className=\"h-4 w-4 mr-2\" />}\n                        {copiedCode ? 'Copiado!' : 'Copiar'}\n                      </Button>\n                      <Button\n                        onClick={shareOnWhatsApp}\n                        className=\"flex-1 bg-green-500 hover:bg-green-600\"\n                      >\n                        <MessageCircle className=\"h-4 w-4 mr-2\" />\n                        <span className=\"hidden sm:inline\">WhatsApp</span>\n                        <span className=\"sm:hidden\">WhatsApp</span>\n                      </Button>\n                      <Button\n                        onClick={shareByEmail}\n                        variant=\"outline\"\n                        className=\"flex-1\"\n                      >\n                        <Mail className=\"h-4 w-4 mr-2\" />\n                        Email\n                      </Button>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Sistema de Recompensas */}\n              <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\" style={{ color: '#1B2B49' }}>\n                    <Sparkles className=\"h-5 w-5\" />\n                    Sistema de Recompensas\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between p-3 bg-blue-50 rounded-lg\">\n                      <div className=\"flex items-center gap-2\">\n                        <div className=\"w-2 h-2 bg-blue-500 rounded-full\"></div>\n                        <span className=\"text-sm font-medium\">Iniciante</span>\n                      </div>\n                      <span className=\"text-xs text-gray-500\">0-4 indica√ß√µes</span>\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 bg-green-50 rounded-lg\">\n                      <div className=\"flex items-center gap-2\">\n                        <div className=\"w-2 h-2 bg-green-500 rounded-full\"></div>\n                        <span className=\"text-sm font-medium\">Explorador</span>\n                      </div>\n                      <span className=\"text-xs text-gray-500\">5-9 indica√ß√µes</span>\n                    </div>\n                    <div className=\"flex items-center justify-between p-3 bg-orange-50 rounded-lg\">\n                      <div className=\"flex items-center gap-2\">\n                        <div className=\"w-2 h-2 bg-orange-500 rounded-full\"></div>\n                        <span className=\"text-sm font-medium\">Embaixador</span>\n                      </div>\n                      <span className=\"text-xs text-gray-500\">10+ indica√ß√µes</span>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Amigos Indicados */}\n            <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\" style={{ color: '#1B2B49' }}>\n                  <Users className=\"h-5 w-5\" />\n                  Amigos Indicados ({referralData?.referredUsers?.length || 0})\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                {referralData?.referredUsers?.length > 0 ? (\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    {referralData.referredUsers.map((friend: any) => (\n                      <div key={friend.id} className=\"flex items-center gap-3 p-3 bg-gray-50 rounded-lg\">\n                        <Avatar className=\"h-10 w-10 bg-gradient-to-br from-blue-500 to-cyan-500\">\n                          <AvatarFallback className=\"text-white\">\n                            {getInitials(friend.fullName)}\n                          </AvatarFallback>\n                        </Avatar>\n                        <div>\n                          <div className=\"font-medium\">{friend.fullName}</div>\n                          <div className=\"text-sm text-gray-500\">\n                            Entrou em {new Date(friend.created_at || friend.createdAt).toLocaleDateString('pt-BR')}\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-12\">\n                    <UserPlus className=\"h-12 w-12 mx-auto text-gray-400 mb-4\" />\n                    <p className=\"text-gray-500 mb-2\">Nenhum amigo indicado ainda</p>\n                    <p className=\"text-sm text-gray-400\">Compartilhe seu c√≥digo e comece a ganhar recompensas!</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Aba de Conex√µes */}\n          <TabsContent value=\"connections\" className=\"space-y-4 sm:space-y-6\">\n            {/* Minha Rede de Companheiros */}\n            <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n              <CardHeader className=\"pb-4\">\n                <CardTitle className=\"flex items-center gap-2 text-lg sm:text-xl\" style={{ color: '#1B2B49' }}>\n                  <Users className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                  <span className=\"hidden sm:inline\">Minha Rede de Companheiros</span>\n                  <span className=\"sm:hidden\">Minha Rede</span>\n                  <span className=\"text-sm font-normal\">({travelCompanions?.length || 0})</span>\n                </CardTitle>\n                <CardDescription className=\"text-sm\">\n                  Companheiros de viagem que voc√™ conheceu\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                {companionsLoading ? (\n                  <div className=\"flex justify-center py-8\">\n                    <LoadingSpinner />\n                  </div>\n                ) : travelCompanions && travelCompanions.length > 0 ? (\n                  <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4\">\n                    {travelCompanions.map((companion: any) => (\n                      <motion.div\n                        key={companion.id}\n                        initial={{ opacity: 0, scale: 0.95 }}\n                        animate={{ opacity: 1, scale: 1 }}\n                        transition={{ duration: 0.2 }}\n                        className=\"relative group\"\n                      >\n                        <Card className=\"hover:shadow-lg transition-shadow duration-200 border-0 bg-gradient-to-br from-white to-gray-50\">\n                          <CardContent className=\"p-3 sm:p-4\">\n                            <div className=\"flex items-start gap-2 sm:gap-3\">\n                              <div className=\"relative flex-shrink-0\">\n                                <UserAvatar \n                                  user={companion}\n                                  size=\"md\"\n                                  className=\"h-10 w-10 sm:h-12 sm:w-12 border-2 border-white shadow-md\"\n                                />\n                                {companion.isVerified && (\n                                  <div className=\"absolute -bottom-1 -right-1 w-3 h-3 sm:w-4 sm:h-4 bg-green-500 rounded-full border-2 border-white flex items-center justify-center\">\n                                    <Check className=\"h-1.5 w-1.5 sm:h-2 sm:w-2 text-white\" />\n                                  </div>\n                                )}\n                              </div>\n                              \n                              <div className=\"flex-1 min-w-0\">\n                                <div className=\"flex items-center justify-between\">\n                                  <h3 className=\"font-semibold text-xs sm:text-sm truncate\" style={{ color: '#1B2B49' }}>\n                                    {companion.fullName}\n                                  </h3>\n                                  \n                                  {/* Menu de a√ß√µes - responsivo */}\n                                  <DropdownMenu>\n                                    <DropdownMenuTrigger asChild>\n                                      <Button variant=\"ghost\" size=\"sm\" className=\"h-6 w-6 sm:h-8 sm:w-8 p-0 opacity-0 group-hover:opacity-100 transition-opacity\">\n                                        <MoreVertical className=\"h-3 w-3 sm:h-4 sm:w-4\" />\n                                      </Button>\n                                    </DropdownMenuTrigger>\n                                    <DropdownMenuContent align=\"end\" className=\"w-40 sm:w-48\">\n                                      <DropdownMenuItem onClick={() => handleRateCompanion(companion)}>\n                                        <Star className=\"mr-2 h-3 w-3 sm:h-4 sm:w-4\" />\n                                        <span className=\"text-xs sm:text-sm\">Avaliar</span>\n                                      </DropdownMenuItem>\n                                      <DropdownMenuItem \n                                        onClick={() => handleRemoveCompanion(companion.id)}\n                                        className=\"text-red-600 hover:text-red-700\"\n                                      >\n                                        <UserMinus className=\"mr-2 h-3 w-3 sm:h-4 sm:w-4\" />\n                                        <span className=\"text-xs sm:text-sm\">Remover</span>\n                                      </DropdownMenuItem>\n                                    </DropdownMenuContent>\n                                  </DropdownMenu>\n                                </div>\n                                \n                                <p className=\"text-xs text-gray-600 mb-1 sm:mb-2 truncate\">\n                                  {companion.location}\n                                </p>\n                                \n                                <div className=\"flex items-center gap-1 sm:gap-2 mb-1 sm:mb-2 flex-wrap\">\n                                  <div className=\"flex items-center gap-0.5 sm:gap-1\">\n                                    <Star className=\"h-2.5 w-2.5 sm:h-3 sm:w-3 text-yellow-400 fill-current\" />\n                                    <span className=\"text-xs font-medium\">\n                                      {companion.averageRating || '5.0'}\n                                    </span>\n                                  </div>\n                                  <span className=\"text-xs text-gray-400\">‚Ä¢</span>\n                                  <span className=\"text-xs text-gray-500\">\n                                    {companion.tripsCount || 1} viagem{(companion.tripsCount || 1) > 1 ? 's' : ''}\n                                  </span>\n                                </div>\n                                \n                                <div className=\"text-xs text-gray-500 hidden sm:block\">\n                                  √öltima viagem: {companion.lastTrip ? new Date(companion.lastTrip).toLocaleDateString('pt-BR', { month: 'short', year: 'numeric' }) : 'Recente'}\n                                </div>\n                              </div>\n                            </div>\n                          </CardContent>\n                        </Card>\n                      </motion.div>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-12\">\n                    <Users className=\"h-12 w-12 mx-auto text-gray-400 mb-4\" />\n                    <p className=\"text-gray-500 mb-2\">Nenhum companheiro na sua rede ainda</p>\n                    <p className=\"text-sm text-gray-400\">\n                      Participe de viagens para conectar-se com outros viajantes!\n                    </p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Convites para Viagem */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\" style={{ color: '#1B2B49' }}>\n                    <MessageCircle className=\"h-5 w-5\" />\n                    Convites Ativos\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-center py-12\">\n                    <MessageCircle className=\"h-12 w-12 mx-auto text-gray-400 mb-4\" />\n                    <p className=\"text-gray-500 mb-2\">Nenhum convite ativo</p>\n                    <p className=\"text-sm text-gray-400\">\n                      Seus pr√≥ximos convites aparecer√£o aqui\n                    </p>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\" style={{ color: '#1B2B49' }}>\n                    <Trophy className=\"h-5 w-5\" />\n                    Estat√≠sticas da Rede\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-sm text-gray-600\">Total de Companheiros</span>\n                      <span className=\"font-semibold\" style={{ color: '#1B2B49' }}>\n                        {travelCompanions?.length || 0}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-sm text-gray-600\">Pa√≠ses Visitados</span>\n                      <span className=\"font-semibold\" style={{ color: '#1B2B49' }}>\n                        {userStats?.countriesVisited || 0}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-sm text-gray-600\">Avalia√ß√£o M√©dia</span>\n                      <span className=\"font-semibold\" style={{ color: '#1B2B49' }}>\n                        {userStats?.averageRating || '5.0'} ‚≠ê\n                      </span>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          {/* Aba de Conquistas */}\n          <TabsContent value=\"achievements\" className=\"space-y-4 sm:space-y-6\">\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6\">\n              {getAchievements().map((achievement, index) => (\n                <motion.div\n                  key={achievement.name}\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  transition={{ delay: index * 0.1 }}\n                >\n                  <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n                    <CardContent className=\"p-4 sm:p-6\">\n                      <div className=\"flex items-center gap-3 sm:gap-4\">\n                        <div className={`p-2 sm:p-3 rounded-full ${achievement.color.replace('text-', 'bg-')}/20 flex-shrink-0`}>\n                          <achievement.icon className={`h-6 w-6 sm:h-8 sm:w-8 ${achievement.color}`} />\n                        </div>\n                        <div className=\"min-w-0\">\n                          <h3 className=\"font-bold text-sm sm:text-lg truncate\" style={{ color: '#1B2B49' }}>\n                            {achievement.name}\n                          </h3>\n                          <p className=\"text-xs sm:text-sm\" style={{ color: '#AAB0B7' }}>\n                            {achievement.description}\n                          </p>\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              ))}\n              \n              {/* Conquistas Bloqueadas */}\n              <motion.div\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: 0.5 }}\n              >\n                <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg opacity-50\">\n                  <CardContent className=\"p-4 sm:p-6\">\n                    <div className=\"flex items-center gap-3 sm:gap-4\">\n                      <div className=\"p-2 sm:p-3 rounded-full bg-gray-200 flex-shrink-0\">\n                        <DollarSign className=\"h-6 w-6 sm:h-8 sm:w-8 text-gray-400\" />\n                      </div>\n                      <div className=\"min-w-0\">\n                        <h3 className=\"font-bold text-sm sm:text-lg text-gray-400 truncate\">Economista</h3>\n                        <p className=\"text-xs sm:text-sm text-gray-400\">\n                          Economize R$1000+ em viagens\n                        </p>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            </div>\n\n            {/* Gamifica√ß√£o e N√≠veis */}\n            <Card className=\"bg-white/80 backdrop-blur-sm border-0 shadow-lg\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\" style={{ color: '#1B2B49' }}>\n                  <Zap className=\"h-5 w-5\" />\n                  Sistema de Pontua√ß√£o\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-3 sm:grid-cols-3 gap-3 sm:gap-4\">\n                  <div className=\"text-center p-3 sm:p-4 bg-blue-50 rounded-lg\">\n                    <div className=\"text-lg sm:text-2xl font-bold text-blue-600\">\n                      {(userStats?.completedTrips || 0) * 100}\n                    </div>\n                    <div className=\"text-xs sm:text-sm text-gray-600\">Pontos XP</div>\n                  </div>\n                  <div className=\"text-center p-3 sm:p-4 bg-green-50 rounded-lg\">\n                    <div className=\"text-lg sm:text-2xl font-bold text-green-600 truncate\">\n                      {getTravelerLevel(userStats?.completedTrips || 0).level}\n                    </div>\n                    <div className=\"text-xs sm:text-sm text-gray-600\">N√≠vel</div>\n                  </div>\n                  <div className=\"text-center p-3 sm:p-4 bg-orange-50 rounded-lg\">\n                    <div className=\"text-lg sm:text-2xl font-bold text-orange-600\">\n                      {getAchievements().length}\n                    </div>\n                    <div className=\"text-xs sm:text-sm text-gray-600\">Conquistas</div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Profile Tab */}\n          <TabsContent value=\"profile\" className=\"space-y-4 sm:space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6\">\n              {/* Profile Card */}\n              <Card className=\"lg:col-span-2\">\n                <CardHeader className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4\">\n                  <div>\n                    <CardTitle className=\"flex items-center gap-2 text-lg sm:text-xl\">\n                      <User className=\"h-4 w-4 sm:h-5 sm:w-5\" />\n                      <span className=\"hidden sm:inline\">Informa√ß√µes Pessoais</span>\n                      <span className=\"sm:hidden\">Perfil</span>\n                    </CardTitle>\n                    <CardDescription className=\"text-sm\">\n                      Atualize suas informa√ß√µes\n                    </CardDescription>\n                  </div>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setIsEditing(!isEditing)}\n                    disabled={updateProfileMutation.isPending}\n                    className=\"w-full sm:w-auto\"\n                  >\n                    <Edit3 className=\"h-4 w-4 mr-2\" />\n                    {isEditing ? \"Cancelar\" : \"Editar\"}\n                  </Button>\n                </CardHeader>\n                <CardContent>\n                  <form onSubmit={form.handleSubmit(handleUpdateProfile)} className=\"space-y-4\">\n                    <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                      <div>\n                        <Label htmlFor=\"full_name\">Nome Completo</Label>\n                        <Input\n                          id=\"full_name\"\n                          {...form.register(\"full_name\")}\n                          disabled={!isEditing}\n                          className={!isEditing ? \"bg-slate-50\" : \"\"}\n                        />\n                        {form.formState.errors.full_name && (\n                          <p className=\"text-sm text-red-500 mt-1\">\n                            {form.formState.errors.full_name.message}\n                          </p>\n                        )}\n                      </div>\n\n                      <div>\n                        <Label htmlFor=\"email\">Email</Label>\n                        <Input\n                          id=\"email\"\n                          type=\"email\"\n                          {...form.register(\"email\")}\n                          disabled={!isEditing}\n                          className={!isEditing ? \"bg-slate-50\" : \"\"}\n                        />\n                        {form.formState.errors.email && (\n                          <p className=\"text-sm text-red-500 mt-1\">\n                            {form.formState.errors.email.message}\n                          </p>\n                        )}\n                      </div>\n                    </div>\n\n                    <div>\n                      <Label htmlFor=\"phone\">Telefone</Label>\n                      <Input\n                        id=\"phone\"\n                        type=\"tel\"\n                        placeholder=\"(11) 99999-9999\"\n                        value={form.watch(\"phone\")}\n                        onChange={(e) => {\n                          const formatted = formatPhoneNumber(e.target.value);\n                          form.setValue(\"phone\", formatted);\n                        }}\n                        disabled={!isEditing}\n                        className={!isEditing ? \"bg-slate-50\" : \"\"}\n                      />\n                      {form.formState.errors.phone && (\n                        <p className=\"text-sm text-red-500 mt-1\">\n                          {form.formState.errors.phone.message}\n                        </p>\n                      )}\n                    </div>\n\n                    <div>\n                      <Label htmlFor=\"location\">Localiza√ß√£o</Label>\n                      <Input\n                        id=\"location\"\n                        {...form.register(\"location\")}\n                        disabled={!isEditing}\n                        className={!isEditing ? \"bg-slate-50\" : \"\"}\n                      />\n                      {form.formState.errors.location && (\n                        <p className=\"text-sm text-red-500 mt-1\">\n                          {form.formState.errors.location.message}\n                        </p>\n                      )}\n                    </div>\n\n                    <div>\n                      <Label htmlFor=\"bio\">Bio</Label>\n                      <Textarea\n                        id=\"bio\"\n                        {...form.register(\"bio\")}\n                        disabled={!isEditing}\n                        className={!isEditing ? \"bg-slate-50\" : \"\"}\n                        rows={3}\n                      />\n                      {form.formState.errors.bio && (\n                        <p className=\"text-sm text-red-500 mt-1\">\n                          {form.formState.errors.bio.message}\n                        </p>\n                      )}\n                    </div>\n\n                    <div>\n                      <Label>Estilos de Viagem</Label>\n                      <div className=\"flex flex-wrap gap-2 mt-2\">\n                        {travelStyles.map((style) => (\n                          <Badge\n                            key={style.value}\n                            variant={form.watch(\"travel_styles\").includes(style.value) ? \"default\" : \"outline\"}\n                            className={`cursor-pointer ${!isEditing ? \"pointer-events-none\" : \"\"}`}\n                            onClick={() => {\n                              if (!isEditing) return;\n                              const current = form.watch(\"travel_styles\");\n                              if (current.includes(style.value)) {\n                                form.setValue(\"travel_styles\", current.filter(s => s !== style.value));\n                              } else {\n                                form.setValue(\"travel_styles\", [...current, style.value]);\n                              }\n                            }}\n                          >\n                            {style.label}\n                          </Badge>\n                        ))}\n                      </div>\n                      {form.formState.errors.travel_styles && (\n                        <p className=\"text-sm text-red-500 mt-1\">\n                          {form.formState.errors.travel_styles.message}\n                        </p>\n                      )}\n                    </div>\n\n                    <div>\n                      <Label>Idiomas</Label>\n                      <div className=\"flex flex-wrap gap-2 mt-2\">\n                        {availableLanguages.map((lang) => (\n                          <Badge\n                            key={lang}\n                            variant={form.watch(\"languages\").includes(lang) ? \"default\" : \"outline\"}\n                            className={`cursor-pointer ${!isEditing ? \"pointer-events-none\" : \"\"}`}\n                            onClick={() => {\n                              if (!isEditing) return;\n                              const current = form.watch(\"languages\");\n                              if (current.includes(lang)) {\n                                form.setValue(\"languages\", current.filter(l => l !== lang));\n                              } else {\n                                form.setValue(\"languages\", [...current, lang]);\n                              }\n                            }}\n                          >\n                            {lang}\n                          </Badge>\n                        ))}\n                      </div>\n                    </div>\n\n                    <div>\n                      <Label>Interesses</Label>\n                      <div className=\"flex flex-wrap gap-2 mt-2\">\n                        {availableInterests.map((interest) => (\n                          <Badge\n                            key={interest}\n                            variant={form.watch(\"interests\").includes(interest) ? \"default\" : \"outline\"}\n                            className={`cursor-pointer ${!isEditing ? \"pointer-events-none\" : \"\"}`}\n                            onClick={() => {\n                              if (!isEditing) return;\n                              const current = form.watch(\"interests\");\n                              if (current.includes(interest)) {\n                                form.setValue(\"interests\", current.filter(i => i !== interest));\n                              } else {\n                                form.setValue(\"interests\", [...current, interest]);\n                              }\n                            }}\n                          >\n                            {interest}\n                          </Badge>\n                        ))}\n                      </div>\n                    </div>\n\n                    {isEditing && (\n                      <div className=\"flex justify-end gap-2 pt-4\">\n                        <Button \n                          type=\"button\" \n                          variant=\"outline\" \n                          onClick={() => setIsEditing(false)}\n                        >\n                          Cancelar\n                        </Button>\n                        <Button \n                          type=\"submit\" \n                          disabled={updateProfileMutation.isPending}\n                          className=\"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700\"\n                        >\n                          {updateProfileMutation.isPending ? (\n                            <LoadingSpinner size=\"sm\" />\n                          ) : (\n                            \"Salvar Altera√ß√µes\"\n                          )}\n                        </Button>\n                      </div>\n                    )}\n                  </form>\n                </CardContent>\n              </Card>\n\n\n            </div>\n          </TabsContent>\n\n          {/* Referral Tab */}\n          <TabsContent value=\"referral\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Share2 className=\"h-5 w-5\" />\n                    Seu C√≥digo de Indica√ß√£o\n                  </CardTitle>\n                  <CardDescription>\n                    Compartilhe com amigos e ganhe benef√≠cios\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  {referralLoading ? (\n                    <LoadingSpinner />\n                  ) : (\n                    <div className=\"space-y-4\">\n                      <div className=\"flex items-center gap-2\">\n                        <Input\n                          value={referralData?.code || \"LOADING...\"}\n                          readOnly\n                          className=\"font-mono text-center text-lg bg-slate-50\"\n                        />\n                        <Button\n                          onClick={copyReferralCode}\n                          variant=\"outline\"\n                          size=\"icon\"\n                        >\n                          {copiedCode ? <Check className=\"h-4 w-4\" /> : <Copy className=\"h-4 w-4\" />}\n                        </Button>\n                      </div>\n                      <div className=\"text-sm text-slate-600 bg-blue-50 p-3 rounded-lg\">\n                        <p className=\"font-medium mb-1\">Como funciona:</p>\n                        <ul className=\"space-y-1\">\n                          <li>‚Ä¢ Compartilhe seu c√≥digo com amigos</li>\n                          <li>‚Ä¢ Eles ganham 10% de desconto na primeira viagem</li>\n                          <li>‚Ä¢ Voc√™ ganha cr√©ditos para suas pr√≥ximas viagens</li>\n                        </ul>\n                      </div>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Users className=\"h-5 w-5\" />\n                    Amigos Indicados\n                  </CardTitle>\n                  <CardDescription>\n                    Pessoas que usaram seu c√≥digo\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  {referralLoading ? (\n                    <LoadingSpinner />\n                  ) : (\n                    <div className=\"space-y-4\">\n                      {referralData?.referredUsers?.length > 0 ? (\n                        <div className=\"space-y-3\">\n                          {referralData.referredUsers.map((referredUser: any) => (\n                            <div key={referredUser.id} className=\"flex items-center gap-3 p-3 bg-slate-50 rounded-lg\">\n                              <Avatar className=\"h-10 w-10 bg-gradient-to-br from-green-500 to-emerald-600\">\n                                <AvatarFallback className=\"text-white text-sm\">\n                                  {getInitials(referredUser.fullName)}\n                                </AvatarFallback>\n                              </Avatar>\n                              <div className=\"flex-1\">\n                                <p className=\"font-medium\">{referredUser.fullName}</p>\n                                <p className=\"text-sm text-slate-600\">\n                                  Entrou em {new Date(referredUser.created_at || referredUser.createdAt).toLocaleDateString()}\n                                </p>\n                              </div>\n                              <Badge variant=\"secondary\">\n                                <UserPlus className=\"h-3 w-3 mr-1\" />\n                                Ativo\n                              </Badge>\n                            </div>\n                          ))}\n                        </div>\n                      ) : (\n                        <div className=\"text-center py-8 text-slate-500\">\n                          <UserPlus className=\"h-12 w-12 mx-auto mb-3 opacity-50\" />\n                          <p>Nenhum amigo indicado ainda</p>\n                          <p className=\"text-sm\">Compartilhe seu c√≥digo para come√ßar!</p>\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          {/* Stats Tab */}\n          <TabsContent value=\"stats\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n              <Card>\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-blue-100 rounded-lg\">\n                      <Plane className=\"h-6 w-6 text-blue-600\" />\n                    </div>\n                    <div>\n                      <p className=\"text-2xl font-bold\">\n                        {statsLoading ? \"...\" : userStats?.totalTrips || 0}\n                      </p>\n                      <p className=\"text-sm text-slate-600\">Viagens Totais</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-green-100 rounded-lg\">\n                      <Calendar className=\"h-6 w-6 text-green-600\" />\n                    </div>\n                    <div>\n                      <p className=\"text-2xl font-bold\">\n                        {statsLoading ? \"...\" : userStats?.completedTrips || 0}\n                      </p>\n                      <p className=\"text-sm text-slate-600\">Viagens Completas</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-purple-100 rounded-lg\">\n                      <Users className=\"h-6 w-6 text-purple-600\" />\n                    </div>\n                    <div>\n                      <p className=\"text-2xl font-bold\">\n                        {statsLoading ? \"...\" : userStats?.travelPartners || 0}\n                      </p>\n                      <p className=\"text-sm text-slate-600\">Companheiros</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-yellow-100 rounded-lg\">\n                      <Star className=\"h-6 w-6 text-yellow-600\" />\n                    </div>\n                    <div>\n                      <p className=\"text-2xl font-bold\">\n                        {statsLoading ? \"...\" : userStats?.averageRating || \"5.0\"}\n                      </p>\n                      <p className=\"text-sm text-slate-600\">Avalia√ß√£o</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Award className=\"h-5 w-5\" />\n                  Conquistas\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                  <div className=\"text-center p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg\">\n                    <div className=\"text-3xl mb-2\">üéØ</div>\n                    <h4 className=\"font-semibold\">Explorador</h4>\n                    <p className=\"text-sm text-slate-600\">Primeira viagem completa</p>\n                  </div>\n                  <div className=\"text-center p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-lg\">\n                    <div className=\"text-3xl mb-2\">ü§ù</div>\n                    <h4 className=\"font-semibold\">Soci√°vel</h4>\n                    <p className=\"text-sm text-slate-600\">5+ companheiros de viagem</p>\n                  </div>\n                  <div className=\"text-center p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg\">\n                    <div className=\"text-3xl mb-2\">üåü</div>\n                    <h4 className=\"font-semibold\">Confi√°vel</h4>\n                    <p className=\"text-sm text-slate-600\">Avalia√ß√£o 5.0 estrelas</p>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n      \n      {/* Avatar Upload Modal */}\n      {showAvatarUpload && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-md mx-4\">\n            <h3 className=\"text-lg font-semibold mb-4\">Alterar Foto de Perfil</h3>\n            <div className=\"space-y-4\">\n              <div className=\"text-center\">\n                <UserAvatar \n                  user={user}\n                  size=\"xl\"\n                  className=\"h-24 w-24 mx-auto mb-4\"\n                  showVerificationBadge={false}\n                />\n                <p className=\"text-sm text-gray-600 mb-4\">\n                  Escolha uma nova foto de perfil\n                </p>\n              </div>\n              \n              <div className=\"space-y-2\">\n                <input\n                  ref={avatarInputRef}\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={handleAvatarUpload}\n                  className=\"hidden\"\n                />\n                <Button \n                  onClick={triggerAvatarUpload}\n                  className=\"w-full bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600\"\n                >\n                  <Upload className=\"h-4 w-4 mr-2\" />\n                  Escolher Arquivo\n                </Button>\n                \n                <div className=\"flex gap-2\">\n                  <Button \n                    variant=\"outline\" \n                    className=\"flex-1\"\n                    onClick={() => setShowAvatarUpload(false)}\n                  >\n                    Cancelar\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Cover Upload Modal */}\n      {showCoverUpload && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg p-6 w-full max-w-md mx-4\">\n            <h3 className=\"text-lg font-semibold mb-4\">Alterar Imagem de Capa</h3>\n            <div className=\"space-y-4\">\n              <div className=\"text-center\">\n                <div className=\"h-32 w-full bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg mb-4 flex items-center justify-center\">\n                  <Image className=\"h-12 w-12 text-white\" />\n                </div>\n                <p className=\"text-sm text-gray-600 mb-4\">\n                  Escolha uma nova imagem de capa para seu perfil\n                </p>\n              </div>\n              \n              <div className=\"space-y-2\">\n                <input\n                  ref={coverInputRef}\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={handleCoverUpload}\n                  className=\"hidden\"\n                />\n                <Button \n                  onClick={triggerCoverUpload}\n                  className=\"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700\"\n                >\n                  <Upload className=\"h-4 w-4 mr-2\" />\n                  Escolher Arquivo\n                </Button>\n                \n                <div className=\"flex gap-2\">\n                  <Button \n                    variant=\"outline\" \n                    className=\"flex-1\"\n                    onClick={() => setShowCoverUpload(false)}\n                  >\n                    Cancelar\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Dialog para Avaliar Companheiro */}\n      <Dialog open={showRateDialog} onOpenChange={setShowRateDialog}>\n        <DialogContent className=\"sm:max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Avaliar Companheiro de Viagem</DialogTitle>\n            <DialogDescription>\n              Avalie sua experi√™ncia com {selectedCompanion?.fullName}\n            </DialogDescription>\n          </DialogHeader>\n          \n          <div className=\"space-y-4\">\n            <div>\n              <Label className=\"text-sm font-medium mb-2 block\">Avalia√ß√£o</Label>\n              <div className=\"flex justify-center\">\n                {renderStarRating(rating, setRating)}\n              </div>\n            </div>\n            \n            <div>\n              <Label htmlFor=\"rating-comment\" className=\"text-sm font-medium mb-2 block\">\n                Coment√°rio (opcional)\n              </Label>\n              <Textarea\n                id=\"rating-comment\"\n                placeholder=\"Compartilhe sua experi√™ncia de viagem...\"\n                value={ratingComment}\n                onChange={(e) => setRatingComment(e.target.value)}\n                rows={3}\n                className=\"resize-none\"\n              />\n            </div>\n            \n            <div className=\"flex justify-end gap-2 pt-4\">\n              <Button \n                variant=\"outline\" \n                onClick={() => setShowRateDialog(false)}\n              >\n                Cancelar\n              </Button>\n              <Button \n                onClick={submitRating}\n                disabled={rateCompanionMutation.isPending}\n                className=\"bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700\"\n              >\n                {rateCompanionMutation.isPending ? (\n                  <LoadingSpinner size=\"sm\" />\n                ) : (\n                  \"Enviar Avalia√ß√£o\"\n                )}\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}","size_bytes":78365},"client/src/pages/search-page.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { formatBrazilianCurrency } from '@shared/utils';\nimport { Navbar } from \"@/components/navbar\";\nimport { TripCard } from \"@/components/trip-card\";\nimport { SearchResultsSkeleton } from \"@/components/ui/loading-states\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Slider } from \"@/components/ui/slider\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { ErrorBoundary } from \"@/components/ui/error-boundary\";\nimport { \n  Search, \n  Filter, \n  SlidersHorizontal, \n  MapPin, \n  Calendar,\n  DollarSign,\n  Globe,\n  Mountain,\n  Waves,\n  Building,\n  TreePine,\n  Snowflake,\n  Plane,\n  Ship,\n  Camera,\n  Star,\n  Users,\n  Clock,\n  TrendingUp,\n  X,\n  ChevronDown,\n  ChevronUp,\n  Navigation,\n  Compass,\n  Zap,\n  Plus\n} from \"lucide-react\";\nimport { PlacesAutocomplete } from \"@/components/places-autocomplete\";\nimport { LoadingSpinner } from \"@/components/ui/loading-states\";\nimport { useDebounce } from \"@/hooks/use-debounce\";\nimport { motion, AnimatePresence } from \"framer-motion\";\n\nconst continents = [\n  { id: 'america-sul', name: 'Am√©rica do Sul', icon: Mountain, color: 'bg-green-500' },\n  { id: 'america-norte', name: 'Am√©rica do Norte', icon: Building, color: 'bg-blue-500' },\n  { id: 'europa', name: 'Europa', icon: Globe, color: 'bg-purple-500' },\n  { id: 'asia', name: '√Åsia', icon: TreePine, color: 'bg-orange-500' },\n  { id: 'africa', name: '√Åfrica', icon: Mountain, color: 'bg-yellow-500' },\n  { id: 'oceania', name: 'Oceania', icon: Waves, color: 'bg-teal-500' },\n  { id: 'brasil', name: 'Brasil', icon: Star, color: 'bg-emerald-500' },\n];\n\nconst travelTypes = [\n  { id: 'praia', name: 'Praia', icon: Waves, color: 'from-blue-400 to-cyan-300' },\n  { id: 'aventura', name: 'Aventura', icon: Mountain, color: 'from-green-500 to-emerald-400' },\n  { id: 'urbanas', name: 'Urbanas', icon: Building, color: 'from-gray-500 to-slate-400' },\n  { id: 'cultural', name: 'Cultural', icon: Camera, color: 'from-purple-500 to-violet-400' },\n  { id: 'natureza', name: 'Natureza', icon: TreePine, color: 'from-green-600 to-lime-500' },\n  { id: 'neve', name: 'Neve', icon: Snowflake, color: 'from-blue-300 to-white' },\n  { id: 'cruzeiros', name: 'Cruzeiros', icon: Ship, color: 'from-indigo-500 to-blue-400' },\n  { id: 'parques', name: 'Parques Tem√°ticos', icon: Star, color: 'from-pink-500 to-rose-400' },\n];\n\nconst budgetRanges = [\n  { id: 'budget-1', label: 'At√© R$ 500', value: 500, color: 'bg-green-100 text-green-800' },\n  { id: 'budget-2', label: 'R$ 500 - R$ 1.500', value: 1500, color: 'bg-blue-100 text-blue-800' },\n  { id: 'budget-3', label: 'R$ 1.500 - R$ 3.000', value: 3000, color: 'bg-purple-100 text-purple-800' },\n  { id: 'budget-4', label: 'R$ 3.000 - R$ 5.000', value: 5000, color: 'bg-orange-100 text-orange-800' },\n  { id: 'budget-5', label: 'Acima de R$ 5.000', value: 10000, color: 'bg-red-100 text-red-800' },\n];\n\n// Generate dynamic date filters: current month + next 15 months\nconst generateDateFilters = () => {\n  const now = new Date();\n  const quickFilters = [\n    { id: 'next-week', label: 'Pr√≥xima Semana', icon: Clock, color: 'bg-emerald-100 text-emerald-800' },\n    { id: 'next-two-weeks', label: 'Pr√≥ximas 2 Semanas', icon: Clock, color: 'bg-blue-100 text-blue-800' },\n    { id: 'next-month', label: 'Pr√≥ximo M√™s', icon: Calendar, color: 'bg-purple-100 text-purple-800' },\n    { id: 'next-three-months', label: 'Pr√≥ximos 3 Meses', icon: Calendar, color: 'bg-orange-100 text-orange-800' },\n  ];\n\n  const monthNames = [\n    'Janeiro', 'Fevereiro', 'Mar√ßo', 'Abril', 'Maio', 'Junho',\n    'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'\n  ];\n\n  const colors = [\n    'bg-cyan-100 text-cyan-800', 'bg-pink-100 text-pink-800', 'bg-green-100 text-green-800',\n    'bg-yellow-100 text-yellow-800', 'bg-red-100 text-red-800', 'bg-indigo-100 text-indigo-800',\n    'bg-teal-100 text-teal-800', 'bg-purple-100 text-purple-800', 'bg-blue-100 text-blue-800',\n    'bg-orange-100 text-orange-800', 'bg-gray-100 text-gray-800', 'bg-rose-100 text-rose-800',\n    'bg-emerald-100 text-emerald-800', 'bg-amber-100 text-amber-800', 'bg-lime-100 text-lime-800',\n    'bg-violet-100 text-violet-800'\n  ];\n\n  const monthFilters = [];\n  let currentDate = new Date(now.getFullYear(), now.getMonth(), 1);\n\n  for (let i = 0; i < 16; i++) {\n    const month = currentDate.getMonth();\n    const year = currentDate.getFullYear();\n    const monthName = monthNames[month];\n    \n    monthFilters.push({\n      id: `${month}-${year}`,\n      label: `${monthName} ${year}`,\n      icon: Calendar,\n      color: colors[i % colors.length],\n      month,\n      year\n    });\n\n    // Move to next month\n    currentDate.setMonth(currentDate.getMonth() + 1);\n  }\n\n  return [...quickFilters, ...monthFilters];\n};\n\nconst dateFilters = generateDateFilters();\n\nexport default function SearchPage() {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const debouncedSearchTerm = useDebounce(searchTerm, 300);\n  const [destination, setDestination] = useState(\"\");\n  const [selectedContinent, setSelectedContinent] = useState(\"\");\n  const [selectedTravelTypes, setSelectedTravelTypes] = useState<string[]>([]);\n  const [budgetRange, setBudgetRange] = useState([0, 10000]);\n  const [sortBy, setSortBy] = useState(\"date\");\n  const [showAdvancedFilters, setShowAdvancedFilters] = useState(false);\n  const [selectedDateFilter, setSelectedDateFilter] = useState<string>(\"\");\n\n  // Helper functions\n  const toggleTravelType = (typeId: string) => {\n    setSelectedTravelTypes(prev => \n      prev.includes(typeId) \n        ? prev.filter(id => id !== typeId)\n        : [...prev, typeId]\n    );\n  };\n\n  const clearAllFilters = () => {\n    setSearchTerm(\"\");\n    setDestination(\"\");\n    setSelectedContinent(\"\");\n    setSelectedTravelTypes([]);\n    setBudgetRange([0, 10000]);\n    setSelectedDateFilter(\"\");\n  };\n\n  // Helper function to get date range from filter\n  const getDateRangeFromFilter = (filterId: string) => {\n    const now = new Date();\n    const startOfToday = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n    \n    switch (filterId) {\n      case 'next-week':\n        return {\n          start: startOfToday,\n          end: new Date(startOfToday.getTime() + 7 * 24 * 60 * 60 * 1000)\n        };\n      case 'next-two-weeks':\n        return {\n          start: startOfToday,\n          end: new Date(startOfToday.getTime() + 14 * 24 * 60 * 60 * 1000)\n        };\n      case 'next-month':\n        return {\n          start: startOfToday,\n          end: new Date(startOfToday.getTime() + 30 * 24 * 60 * 60 * 1000)\n        };\n      case 'next-three-months':\n        return {\n          start: startOfToday,\n          end: new Date(startOfToday.getTime() + 90 * 24 * 60 * 60 * 1000)\n        };\n      default:\n        // Handle dynamic month filters (format: \"month-year\")\n        const monthFilter = dateFilters.find(filter => filter.id === filterId);\n        if (monthFilter && 'month' in monthFilter && 'year' in monthFilter) {\n          const month = Number(monthFilter.month);\n          const year = Number(monthFilter.year);\n          const startDate = new Date(year, month, 1);\n          const endDate = new Date(year, month + 1, 0); // Last day of the month\n          return { start: startDate, end: endDate };\n        }\n        return null;\n    }\n  };\n\n  // Build query parameters for API call\n  const queryParams = useMemo(() => {\n    const params: Record<string, string> = {};\n    if (destination) params.destination = destination;\n    if (selectedTravelTypes.length === 1) params.travelStyle = selectedTravelTypes[0];\n    if (budgetRange[1] < 10000) params.budget = budgetRange[1].toString();\n    return params;\n  }, [destination, selectedTravelTypes, budgetRange]);\n\n  const { data: trips = [], isLoading } = useQuery<any[]>({\n    queryKey: [\"/api/trips\", queryParams],\n    queryFn: async () => {\n      const searchParams = new URLSearchParams(queryParams);\n      const res = await fetch(`/api/trips?${searchParams}`);\n      if (!res.ok) throw new Error('Failed to fetch trips');\n      return res.json();\n    },\n    staleTime: 30 * 1000,\n    refetchOnWindowFocus: false,\n  });\n\n  // Advanced client-side filtering\n  const filteredTrips = useMemo(() => {\n    const filtered = trips.filter((trip: any) => {\n      // Filter out trips that have already started\n      const currentDate = new Date();\n      const tripStartDate = new Date(trip.start_date || trip.startDate);\n      \n      // Only show trips that haven't started yet (future trips)\n      if (tripStartDate <= currentDate) {\n        return false;\n      }\n\n      // Text search filter\n      if (searchTerm && searchTerm.trim()) {\n        const searchLower = searchTerm.toLowerCase().trim();\n        const titleMatch = trip.title?.toLowerCase().includes(searchLower);\n        const destinationMatch = trip.destination?.toLowerCase().includes(searchLower);\n        const descriptionMatch = trip.description?.toLowerCase().includes(searchLower);\n        \n        if (!titleMatch && !destinationMatch && !descriptionMatch) {\n          return false;\n        }\n      }\n\n      // Travel type filter\n      if (selectedTravelTypes.length > 0 && !selectedTravelTypes.includes(trip.travel_style || trip.travelStyle)) {\n        return false;\n      }\n\n      // Budget filter\n      const tripBudget = trip.budget || 0;\n      if (tripBudget < budgetRange[0] || tripBudget > budgetRange[1]) {\n        return false;\n      }\n\n      // Continent filter\n      if (selectedContinent && selectedContinent !== 'brasil') {\n        const destination = trip.destination?.toLowerCase() || '';\n        \n        const continentKeywords = {\n          'america-sul': ['chile', 'argentina', 'colombia', 'equador', 'venezuela', 'bolivia', 'peru', 'uruguai'],\n          'america-norte': ['eua', 'estados unidos', 'nova york', 'california', 'canada', 'm√©xico', 'toronto', 'vancouver'],\n          'europa': ['fran√ßa', 'it√°lia', 'espanha', 'alemanha', 'portugal', 'inglaterra', 'london', 'paris', 'roma', 'madrid', 'barcelona'],\n          'asia': ['jap√£o', 'china', 'tail√¢ndia', 'singapura', 'coreia', '√≠ndia', 'tokyo', 'beijing', 'bangkok'],\n          'africa': ['egito', 'marrocos', '√°frica do sul', 'cairo', 'casablanca'],\n          'oceania': ['austr√°lia', 'nova zel√¢ndia', 'sydney', 'melbourne', 'auckland']\n        };\n\n        const keywords = continentKeywords[selectedContinent as keyof typeof continentKeywords] || [];\n        const hasMatch = keywords.some(keyword => destination.includes(keyword.toLowerCase()));\n        if (!hasMatch) return false;\n      }\n\n      if (selectedContinent === 'brasil') {\n        const destination = trip.destination?.toLowerCase() || '';\n        const internationalKeywords = ['eua', 'fran√ßa', 'it√°lia', 'jap√£o', 'argentina', 'chile', 'nova york', 'paris', 'tokyo'];\n        const isInternational = internationalKeywords.some(keyword => destination.includes(keyword));\n        if (isInternational) return false;\n      }\n\n      // Date filter\n      if (selectedDateFilter) {\n        const dateRange = getDateRangeFromFilter(selectedDateFilter);\n        if (dateRange) {\n          const tripStartDate = new Date(trip.start_date || trip.startDate);\n          if (tripStartDate < dateRange.start || tripStartDate > dateRange.end) {\n            return false;\n          }\n        }\n      }\n\n      return true;\n    });\n    \n    return filtered;\n  }, [trips, searchTerm, selectedTravelTypes, budgetRange, selectedContinent, selectedDateFilter]);\n\n  // Client-side sorting\n  const sortedTrips = useMemo(() => {\n    return [...filteredTrips].sort((a: any, b: any) => {\n      switch (sortBy) {\n        case \"date\":\n          return new Date(a.start_date || a.startDate).getTime() - new Date(b.start_date || b.startDate).getTime();\n        case \"price-low\":\n          return (a.budget || 0) - (b.budget || 0);\n        case \"price-high\":\n          return (b.budget || 0) - (a.budget || 0);\n        case \"popularity\":\n          return (b.current_participants || 0) - (a.current_participants || 0);\n        default:\n          return 0;\n      }\n    });\n  }, [filteredTrips, sortBy]);\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50\">\n      <Navbar />\n      <div className=\"container mx-auto px-4 py-8\">\n        {/* Modern Hero Section with Destination Gallery */}\n        <motion.div \n          initial={{ opacity: 0, y: -20 }}\n          animate={{ opacity: 1, y: 0 }}\n          className=\"relative mb-12 bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden\"\n        >\n          {/* Background Image Gallery */}\n          <div className=\"absolute inset-0 opacity-5\">\n            <div className=\"grid grid-cols-6 h-full\">\n              <div className=\"bg-cover bg-center\" style={{backgroundImage: 'url(https://images.unsplash.com/photo-1483729558449-99ef09a8c325?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80)'}}></div>\n              <div className=\"bg-cover bg-center\" style={{backgroundImage: 'url(https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80)'}}></div>\n              <div className=\"bg-cover bg-center\" style={{backgroundImage: 'url(https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80)'}}></div>\n              <div className=\"bg-cover bg-center\" style={{backgroundImage: 'url(https://images.unsplash.com/photo-1544718865-4c8eff1f3f8a?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80)'}}></div>\n              <div className=\"bg-cover bg-center\" style={{backgroundImage: 'url(https://images.unsplash.com/photo-1600298881974-6be191ceeda1?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80)'}}></div>\n              <div className=\"bg-cover bg-center\" style={{backgroundImage: 'url(https://images.unsplash.com/photo-1516012669313-c1c15b8b6b13?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80)'}}></div>\n            </div>\n          </div>\n\n          {/* Clean Content */}\n          <div className=\"relative z-10 px-8 py-12 text-center\">\n            <motion.div \n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.1 }}\n              className=\"mb-6\"\n            >\n              <div className=\"inline-flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 rounded-full text-sm font-medium mb-6\">\n                <Search className=\"h-4 w-4\" />\n                Encontre sua pr√≥xima aventura\n              </div>\n            </motion.div>\n            \n            <motion.h1 \n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.2 }}\n              className=\"text-4xl md:text-5xl font-bold text-gray-900 mb-4 leading-tight\"\n            >\n              Descubra <span className=\"text-blue-600\">destinos √∫nicos</span>\n              <br />\n              com companheiros ideais\n            </motion.h1>\n            \n            <motion.p \n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.3 }}\n              className=\"text-xl text-gray-600 mb-8 max-w-2xl mx-auto\"\n            >\n              Conecte-se com viajantes que compartilham seus interesses e descubra experi√™ncias inesquec√≠veis ao redor do mundo\n            </motion.p>\n\n            {/* Destination Preview Gallery */}\n            <motion.div \n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.35 }}\n              className=\"mb-8\"\n            >\n              <div className=\"flex justify-center items-center gap-4 mb-4\">\n                <div className=\"flex -space-x-2\">\n                  <div className=\"w-12 h-12 rounded-full border-2 border-white shadow-lg bg-cover bg-center\" style={{backgroundImage: 'url(https://images.unsplash.com/photo-1483729558449-99ef09a8c325?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80)'}}></div>\n                  <div className=\"w-12 h-12 rounded-full border-2 border-white shadow-lg bg-cover bg-center\" style={{backgroundImage: 'url(https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80)'}}></div>\n                  <div className=\"w-12 h-12 rounded-full border-2 border-white shadow-lg bg-cover bg-center\" style={{backgroundImage: 'url(https://images.unsplash.com/photo-1513581166391-887a96ddeafd?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80)'}}></div>\n                  <div className=\"w-12 h-12 rounded-full border-2 border-white shadow-lg bg-cover bg-center\" style={{backgroundImage: 'url(https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80)'}}></div>\n                  <div className=\"w-12 h-12 rounded-full border-2 border-white shadow-lg bg-cover bg-center\" style={{backgroundImage: 'url(https://images.unsplash.com/photo-1600298881974-6be191ceeda1?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80)'}}></div>\n                  <div className=\"w-12 h-12 rounded-full border-2 border-white shadow-lg bg-cover bg-center\" style={{backgroundImage: 'url(https://images.unsplash.com/photo-1516012669313-c1c15b8b6b13?ixlib=rb-4.0.3&auto=format&fit=crop&w=100&q=80)'}}></div>\n                  <div className=\"w-12 h-12 rounded-full border-2 border-white shadow-lg bg-gray-100 flex items-center justify-center text-gray-600 text-sm font-semibold\">\n                    +80\n                  </div>\n                </div>\n                <div className=\"text-sm text-gray-600 font-medium\">\n                  Rio de Janeiro ‚Ä¢ Fernando de Noronha ‚Ä¢ Coliseu ‚Ä¢ Chapada Diamantina ‚Ä¢ Pir√¢mides de Giz√© ‚Ä¢ Bonito e muito mais\n                </div>\n              </div>\n            </motion.div>\n          </div>\n        </motion.div>\n\n        \n\n        {/* Main Search Bar */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.1 }}\n          className=\"mb-8\"\n        >\n          <Card className=\"bg-white/80 backdrop-blur-sm shadow-xl border-0\">\n            <CardContent className=\"p-6\">\n              <div className=\"relative\">\n                <Search className=\"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5\" />\n                <Input\n                  placeholder=\"Buscar por destino, t√≠tulo ou descri√ß√£o da viagem...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"pl-12 h-14 text-lg border-0 focus:ring-2 focus:ring-blue-500 bg-white/80\"\n                />\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        {/* Travel Types Filter - Horizontal */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ delay: 0.15 }}\n          className=\"mb-8\"\n        >\n          <Card className=\"bg-white/80 backdrop-blur-sm\">\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center gap-3 mb-4\">\n                <Camera className=\"h-5 w-5 text-purple-500\" />\n                <h3 className=\"text-lg font-semibold\">Tipos de Viagem</h3>\n              </div>\n              <div className=\"flex flex-wrap gap-2\">\n                {travelTypes.map((type) => {\n                  const Icon = type.icon;\n                  const isSelected = selectedTravelTypes.includes(type.id);\n                  return (\n                    <Button\n                      key={type.id}\n                      variant={isSelected ? \"default\" : \"outline\"}\n                      onClick={() => toggleTravelType(type.id)}\n                      className=\"flex items-center gap-2 h-10\"\n                    >\n                      <Icon className=\"h-4 w-4\" />\n                      {type.name}\n                      {isSelected && <Badge className=\"ml-1 bg-white text-primary\">‚úì</Badge>}\n                    </Button>\n                  );\n                })}\n              </div>\n            </CardContent>\n          </Card>\n        </motion.div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-8\">\n          {/* Filters Sidebar */}\n          <motion.div\n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.2 }}\n            className=\"lg:col-span-1 space-y-6\"\n          >\n            {/* Active Filters */}\n            {(destination || selectedContinent || selectedTravelTypes.length > 0 || budgetRange[0] > 0 || budgetRange[1] < 10000 || selectedDateFilter) && (\n              <Card className=\"bg-white/80 backdrop-blur-sm\">\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-center justify-between\">\n                    <CardTitle className=\"text-sm font-medium\">Filtros Ativos</CardTitle>\n                    <Button \n                      variant=\"ghost\" \n                      size=\"sm\" \n                      onClick={clearAllFilters}\n                      className=\"h-6 px-2 text-xs\"\n                    >\n                      <X className=\"h-3 w-3 mr-1\" />\n                      Limpar\n                    </Button>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"space-y-2\">\n                  {destination && (\n                    <Badge variant=\"secondary\" className=\"text-xs\">\n                      <MapPin className=\"h-3 w-3 mr-1\" />\n                      {destination}\n                    </Badge>\n                  )}\n                  {selectedContinent && (\n                    <Badge variant=\"secondary\" className=\"text-xs\">\n                      <Globe className=\"h-3 w-3 mr-1\" />\n                      {continents.find(c => c.id === selectedContinent)?.name}\n                    </Badge>\n                  )}\n                  {selectedTravelTypes.map(type => (\n                    <Badge key={type} variant=\"secondary\" className=\"text-xs\">\n                      {travelTypes.find(t => t.id === type)?.name}\n                    </Badge>\n                  ))}\n                  {(budgetRange[0] > 0 || budgetRange[1] < 10000) && (\n                    <Badge variant=\"secondary\" className=\"text-xs\">\n                      <DollarSign className=\"h-3 w-3 mr-1\" />\n                      {formatBrazilianCurrency(budgetRange[0])} - {budgetRange[1] === 10000 ? 'R$ 10k+' : formatBrazilianCurrency(budgetRange[1])}\n                    </Badge>\n                  )}\n                  {selectedDateFilter && (\n                    <Badge variant=\"secondary\" className=\"text-xs\">\n                      <Calendar className=\"h-3 w-3 mr-1\" />\n                      {dateFilters.find(d => d.id === selectedDateFilter)?.label}\n                    </Badge>\n                  )}\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Continent Filter */}\n            <Card className=\"bg-white/80 backdrop-blur-sm\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2 text-lg\">\n                  <Globe className=\"h-5 w-5 text-blue-500\" />\n                  Continentes\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                {continents.map((continent) => {\n                  const Icon = continent.icon;\n                  return (\n                    <Button\n                      key={continent.id}\n                      variant={selectedContinent === continent.id ? \"default\" : \"ghost\"}\n                      onClick={() => setSelectedContinent(selectedContinent === continent.id ? \"\" : continent.id)}\n                      className=\"w-full justify-start h-12\"\n                    >\n                      <Icon className=\"h-4 w-4 mr-3\" />\n                      {continent.name}\n                    </Button>\n                  );\n                })}\n              </CardContent>\n            </Card>\n\n            {/* Date Filter */}\n            <Card className=\"bg-white/80 backdrop-blur-sm\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2 text-lg\">\n                  <Calendar className=\"h-5 w-5 text-indigo-500\" />\n                  Per√≠odo da Viagem\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-3\">\n                <div className=\"grid grid-cols-1 gap-2\">\n                  <div className=\"text-sm font-medium text-gray-700 mb-2\">Pr√≥ximos Per√≠odos</div>\n                  {dateFilters.slice(0, 4).map((filter) => {\n                    const Icon = filter.icon;\n                    return (\n                      <Button\n                        key={filter.id}\n                        variant={selectedDateFilter === filter.id ? \"default\" : \"ghost\"}\n                        onClick={() => setSelectedDateFilter(selectedDateFilter === filter.id ? \"\" : filter.id)}\n                        className=\"w-full justify-start h-10 text-sm\"\n                      >\n                        <Icon className=\"h-4 w-4 mr-2\" />\n                        {filter.label}\n                      </Button>\n                    );\n                  })}\n                </div>\n                <Separator />\n                <div className=\"space-y-2\">\n                  <div className=\"text-sm font-medium text-gray-700\">Meses Espec√≠ficos</div>\n                  <Select value={selectedDateFilter} onValueChange={setSelectedDateFilter}>\n                    <SelectTrigger className=\"w-full\">\n                      <SelectValue placeholder=\"Selecione um m√™s espec√≠fico\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {dateFilters.slice(4).map((filter) => (\n                        <SelectItem key={filter.id} value={filter.id}>\n                          {filter.label}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Budget Filter */}\n            <Card className=\"bg-white/80 backdrop-blur-sm\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2 text-lg\">\n                  <DollarSign className=\"h-5 w-5 text-green-500\" />\n                  Or√ßamento\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"px-2\">\n                  <Slider\n                    value={budgetRange}\n                    onValueChange={setBudgetRange}\n                    max={10000}\n                    min={0}\n                    step={100}\n                    className=\"w-full\"\n                  />\n                </div>\n                <div className=\"flex justify-between text-sm text-gray-600\">\n                  <span>R$ {budgetRange[0].toLocaleString()}</span>\n                  <span>R$ {budgetRange[1] === 10000 ? '10k+' : budgetRange[1].toLocaleString()}</span>\n                </div>\n                <div className=\"grid grid-cols-1 gap-2\">\n                  {budgetRanges.map((range) => (\n                    <Button\n                      key={range.id}\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      onClick={() => {\n                        if (range.value === 10000) {\n                          setBudgetRange([5000, 10000]);\n                        } else if (range.value === 500) {\n                          setBudgetRange([0, 500]);\n                        } else if (range.value === 1500) {\n                          setBudgetRange([500, 1500]);\n                        } else if (range.value === 3000) {\n                          setBudgetRange([1500, 3000]);\n                        } else if (range.value === 5000) {\n                          setBudgetRange([3000, 5000]);\n                        }\n                      }}\n                      className=\"justify-start text-xs h-8\"\n                    >\n                      <Badge className={`mr-2 ${range.color}`}>\n                        {range.label}\n                      </Badge>\n                    </Button>\n                  ))}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Destination Input */}\n            <Card className=\"bg-white/80 backdrop-blur-sm\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2 text-lg\">\n                  <MapPin className=\"h-5 w-5 text-red-500\" />\n                  Destino Espec√≠fico\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <PlacesAutocomplete\n                  value={destination}\n                  onChange={setDestination}\n                  placeholder=\"Digite um destino...\"\n                  className=\"w-full\"\n                />\n              </CardContent>\n            </Card>\n          </motion.div>\n\n          {/* Results Section */}\n          <motion.div\n            initial={{ opacity: 0, x: 20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ delay: 0.3 }}\n            className=\"lg:col-span-3\"\n          >\n            {/* Results Header */}\n            <div className=\"flex items-center justify-between mb-6\">\n              <div className=\"flex items-center gap-4\">\n                <h2 className=\"text-2xl font-bold text-gray-800\">\n                  {filteredTrips.length > 0 ? `${filteredTrips.length} viagens encontradas` : 'Nenhuma viagem encontrada'}\n                </h2>\n                {isLoading && (\n                  <div className=\"flex items-center gap-2 text-gray-500\">\n                    <div className=\"animate-spin h-4 w-4 border-2 border-gray-300 border-t-blue-500 rounded-full\"></div>\n                    <span className=\"text-sm\">Carregando...</span>\n                  </div>\n                )}\n              </div>\n              \n              <Select value={sortBy} onValueChange={setSortBy}>\n                <SelectTrigger className=\"w-48 bg-white/80\">\n                  <SelectValue placeholder=\"Ordenar por\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"date\">Data da viagem</SelectItem>\n                  <SelectItem value=\"price-low\">Menor pre√ßo</SelectItem>\n                  <SelectItem value=\"price-high\">Maior pre√ßo</SelectItem>\n                  <SelectItem value=\"popularity\">Mais populares</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            {/* Results Grid */}\n            <div className=\"space-y-6\">\n              {isLoading ? (\n                <SearchResultsSkeleton />\n              ) : sortedTrips.length > 0 ? (\n                <motion.div \n                  initial={{ opacity: 0 }}\n                  animate={{ opacity: 1 }}\n                  transition={{ delay: 0.4 }}\n                  className=\"grid md:grid-cols-2 xl:grid-cols-3 gap-6\"\n                >\n                  {sortedTrips.map((trip, index) => (\n                    <motion.div\n                      key={trip.id}\n                      initial={{ opacity: 0, y: 20 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      transition={{ delay: 0.1 * index }}\n                    >\n                      <TripCard trip={trip} />\n                    </motion.div>\n                  ))}\n                </motion.div>\n              ) : (\n                <motion.div\n                  initial={{ opacity: 0, y: 20 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  className=\"text-center py-16\"\n                >\n                  <Card className=\"bg-white/80 backdrop-blur-sm\">\n                    <CardContent className=\"py-16\">\n                      <Search className=\"h-16 w-16 text-gray-400 mx-auto mb-6\" />\n                      <h3 className=\"text-2xl font-semibold mb-4 text-gray-800\">Nenhuma viagem encontrada</h3>\n                      <p className=\"text-gray-600 mb-6 max-w-md mx-auto\">\n                        Tente ajustar seus filtros ou buscar por termos diferentes. Que tal criar uma nova viagem?\n                      </p>\n                      <div className=\"flex gap-3 justify-center flex-wrap\">\n                        <Button onClick={clearAllFilters} variant=\"outline\">\n                          <Filter className=\"h-4 w-4 mr-2\" />\n                          Limpar Filtros\n                        </Button>\n                        <Button onClick={() => window.location.href = '/activities'} variant=\"outline\">\n                          <Calendar className=\"h-4 w-4 mr-2\" />\n                          Ver Atividades\n                        </Button>\n                        <Button onClick={() => window.location.href = '/create-trip'}>\n                          <Star className=\"h-4 w-4 mr-2\" />\n                          Criar Viagem\n                        </Button>\n                      </div>\n                    </CardContent>\n                  </Card>\n                </motion.div>\n              )}\n            </div>\n          </motion.div>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":33614},"client/src/pages/terms-of-service.tsx":{"content":"import { ArrowLeft, Scale, Users, CreditCard, Shield, AlertTriangle, Mail, FileText } from 'lucide-react';\nimport { Link } from 'wouter';\n\nexport default function TermsOfService() {\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\n      {/* Header */}\n      <div className=\"bg-white dark:bg-gray-800 shadow-sm\">\n        <div className=\"max-w-4xl mx-auto px-4 py-6\">\n          <Link href=\"/\" className=\"inline-flex items-center text-blue-600 hover:text-blue-800 mb-4\">\n            <ArrowLeft className=\"w-4 h-4 mr-2\" />\n            Voltar ao in√≠cio\n          </Link>\n          <div className=\"flex items-center space-x-3\">\n            <Scale className=\"w-8 h-8 text-blue-600\" />\n            <div>\n              <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white\">\n                Termos de Uso\n              </h1>\n              <p className=\"text-gray-600 dark:text-gray-300 mt-1\">\n                √öltima atualiza√ß√£o: 14 de julho de 2025\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"max-w-4xl mx-auto px-4 py-8\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-sm\">\n          <div className=\"p-8\">\n            {/* Aceita√ß√£o */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <FileText className=\"w-6 h-6 mr-2 text-blue-600\" />\n                1. Aceita√ß√£o dos Termos\n              </h2>\n              <p className=\"text-gray-700 dark:text-gray-300 leading-relaxed\">\n                Ao acessar ou utilizar a plataforma PartiuTrip (\"Plataforma\"), voc√™ concorda com estes Termos de Uso e com nossa Pol√≠tica de Privacidade. Se n√£o concordar, n√£o utilize nossos servi√ßos.\n              </p>\n            </section>\n\n            {/* Elegibilidade */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Users className=\"w-6 h-6 mr-2 text-blue-600\" />\n                2. Elegibilidade\n              </h2>\n              <p className=\"text-gray-700 dark:text-gray-300 mb-4\">Voc√™ deve:</p>\n              <ul className=\"list-disc pl-6 space-y-2 text-gray-700 dark:text-gray-300\">\n                <li>Ter pelo menos 18 anos</li>\n                <li>Ser pessoa f√≠sica</li>\n                <li>Fornecer informa√ß√µes precisas e atualizadas</li>\n                <li>Ser respons√°vel pela seguran√ßa de sua conta</li>\n              </ul>\n            </section>\n\n            {/* Natureza da Plataforma */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <FileText className=\"w-6 h-6 mr-2 text-blue-600\" />\n                3. Natureza da Plataforma\n              </h2>\n              <p className=\"text-gray-700 dark:text-gray-300 mb-4\">\n                O PartiuTrip √© uma plataforma de conex√£o entre viajantes para:\n              </p>\n              <ul className=\"list-disc pl-6 space-y-2 text-gray-700 dark:text-gray-300 mb-4\">\n                <li>Planejamento colaborativo de viagens</li>\n                <li>Compartilhamento de custos e despesas</li>\n                <li>Intera√ß√£o entre usu√°rios com interesses similares</li>\n              </ul>\n              <div className=\"p-4 bg-yellow-50 dark:bg-yellow-900/30 rounded-lg\">\n                <p className=\"text-yellow-800 dark:text-yellow-200 font-medium\">\n                  N√£o somos uma ag√™ncia de viagens nem respons√°veis por acordos entre usu√°rios\n                </p>\n              </div>\n            </section>\n\n            {/* Responsabilidades */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Shield className=\"w-6 h-6 mr-2 text-blue-600\" />\n                4. Responsabilidades do Usu√°rio\n              </h2>\n              \n              <div className=\"space-y-6\">\n                <div>\n                  <h3 className=\"text-xl font-medium text-gray-900 dark:text-white mb-3\">\n                    a) Compartilhamento de Custos:\n                  </h3>\n                  <ul className=\"list-disc pl-6 space-y-2 text-gray-700 dark:text-gray-300\">\n                    <li>Todas as transa√ß√µes financeiras s√£o de responsabilidade exclusiva dos usu√°rios</li>\n                    <li>A plataforma apenas fornece ferramentas de c√°lculo, sem intermediar pagamentos</li>\n                    <li>Recomendamos acordos por escrito entre participantes</li>\n                  </ul>\n                </div>\n                \n                <div>\n                  <h3 className=\"text-xl font-medium text-gray-900 dark:text-white mb-3\">\n                    b) Conduta em Viagens:\n                  </h3>\n                  <ul className=\"list-disc pl-6 space-y-2 text-gray-700 dark:text-gray-300\">\n                    <li>Agir com respeito e seguran√ßa durante as viagens</li>\n                    <li>Cumprir leis locais e regulamentos de viagem</li>\n                    <li>N√£o discriminar com base em ra√ßa, g√™nero, religi√£o ou orienta√ß√£o sexual</li>\n                  </ul>\n                </div>\n                \n                <div>\n                  <h3 className=\"text-xl font-medium text-gray-900 dark:text-white mb-3\">\n                    c) Conte√∫do Gerado:\n                  </h3>\n                  <ul className=\"list-disc pl-6 space-y-2 text-gray-700 dark:text-gray-300\">\n                    <li>Garantir que fotos/informa√ß√µes compartilhadas n√£o violam direitos de terceiros</li>\n                    <li>N√£o publicar conte√∫do ilegal, ofensivo ou comercial n√£o autorizado</li>\n                  </ul>\n                </div>\n              </div>\n            </section>\n\n            {/* Sistema Financeiro */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <CreditCard className=\"w-6 h-6 mr-2 text-blue-600\" />\n                5. Sistema Financeiro\n              </h2>\n              \n              <div className=\"space-y-6\">\n                <div>\n                  <h3 className=\"text-xl font-medium text-gray-900 dark:text-white mb-3\">\n                    a) Ferramentas de C√°lculo:\n                  </h3>\n                  <ul className=\"list-disc pl-6 space-y-2 text-gray-700 dark:text-gray-300\">\n                    <li>As funcionalidades de divis√£o de despesas s√£o sugest√µes matem√°ticas</li>\n                    <li>N√£o validamos transa√ß√µes nem armazenamos dados financeiros sens√≠veis</li>\n                  </ul>\n                </div>\n                \n                <div>\n                  <h3 className=\"text-xl font-medium text-gray-900 dark:text-white mb-3\">\n                    b) Comprovantes:\n                  </h3>\n                  <ul className=\"list-disc pl-6 space-y-2 text-gray-700 dark:text-gray-300\">\n                    <li>Recibos compartilhados permanecem propriedade dos usu√°rios</li>\n                    <li>Exclu√≠mos automaticamente documentos ap√≥s 180 dias</li>\n                  </ul>\n                </div>\n              </div>\n            </section>\n\n            {/* Privacidade */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Shield className=\"w-6 h-6 mr-2 text-blue-600\" />\n                6. Privacidade e Dados\n              </h2>\n              \n              <div className=\"space-y-4\">\n                <div>\n                  <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\n                    a) Coletamos:\n                  </h3>\n                  <ul className=\"list-disc pl-6 space-y-1 text-gray-700 dark:text-gray-300\">\n                    <li>Dados de perfil e prefer√™ncias de viagem</li>\n                    <li>Informa√ß√µes sobre planos de viagem</li>\n                    <li>Registros de intera√ß√µes na plataforma</li>\n                  </ul>\n                </div>\n                \n                <div>\n                  <h3 className=\"text-lg font-medium text-gray-900 dark:text-white mb-2\">\n                    b) Compartilhamos:\n                  </h3>\n                  <ul className=\"list-disc pl-6 space-y-1 text-gray-700 dark:text-gray-300\">\n                    <li>Informa√ß√µes b√°sicas com potenciais companheiros de viagem</li>\n                    <li>Dados agregados/an√¥nimos para estat√≠sticas</li>\n                    <li>Nunca vendemos dados pessoais a terceiros</li>\n                  </ul>\n                </div>\n              </div>\n            </section>\n\n            {/* Seguran√ßa */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Shield className=\"w-6 h-6 mr-2 text-blue-600\" />\n                9. Seguran√ßa\n              </h2>\n              \n              <div className=\"grid md:grid-cols-2 gap-4\">\n                <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n                  <h3 className=\"font-medium text-gray-900 dark:text-white mb-2\">Autentica√ß√£o</h3>\n                  <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                    Dois fatores opcional dispon√≠vel\n                  </p>\n                </div>\n                <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n                  <h3 className=\"font-medium text-gray-900 dark:text-white mb-2\">Criptografia</h3>\n                  <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                    Dados em tr√¢nsito e repouso\n                  </p>\n                </div>\n                <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n                  <h3 className=\"font-medium text-gray-900 dark:text-white mb-2\">Monitoramento</h3>\n                  <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                    Cont√≠nuo de seguran√ßa\n                  </p>\n                </div>\n                <div className=\"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n                  <h3 className=\"font-medium text-gray-900 dark:text-white mb-2\">Sess√µes</h3>\n                  <p className=\"text-sm text-gray-700 dark:text-gray-300\">\n                    Autom√°ticas ap√≥s 30 minutos\n                  </p>\n                </div>\n              </div>\n            </section>\n\n            {/* Isen√ß√µes */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <AlertTriangle className=\"w-6 h-6 mr-2 text-orange-600\" />\n                11. Isen√ß√µes de Responsabilidade\n              </h2>\n              \n              <div className=\"p-6 bg-orange-50 dark:bg-orange-900/30 rounded-lg\">\n                <p className=\"text-orange-800 dark:text-orange-200 mb-4 font-medium\">\n                  O PartiuTrip:\n                </p>\n                <ul className=\"list-disc pl-6 space-y-2 text-orange-800 dark:text-orange-200\">\n                  <li>N√£o valida identidade dos usu√°rios (verifica√ß√£o opcional dispon√≠vel)</li>\n                  <li>N√£o garante seguran√ßa em encontros presenciais</li>\n                  <li>N√£o se responsabiliza por perdas financeiras entre usu√°rios</li>\n                  <li>N√£o endossa conte√∫do gerado por usu√°rios</li>\n                </ul>\n              </div>\n            </section>\n\n            {/* Lei Aplic√°vel */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Scale className=\"w-6 h-6 mr-2 text-blue-600\" />\n                14. Lei Aplic√°vel\n              </h2>\n              <p className=\"text-gray-700 dark:text-gray-300\">\n                Estes termos s√£o regidos pelas leis brasileiras. Disputas ser√£o resolvidas no foro de Porto Alegre, RS.\n              </p>\n            </section>\n\n            {/* Contato */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Mail className=\"w-6 h-6 mr-2 text-blue-600\" />\n                15. Contato\n              </h2>\n              \n              <div className=\"p-6 bg-blue-50 dark:bg-blue-900/30 rounded-lg\">\n                <p className=\"text-blue-800 dark:text-blue-200 mb-2\">\n                  D√∫vidas ou reclama√ß√µes:\n                </p>\n                <p className=\"text-blue-800 dark:text-blue-200 font-medium\">\n                  Email: juridico@partiutrip.com\n                </p>\n              </div>\n            </section>\n\n            {/* Recomenda√ß√µes de Seguran√ßa */}\n            <section className=\"mb-8\">\n              <h2 className=\"text-2xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center\">\n                <Shield className=\"w-6 h-6 mr-2 text-green-600\" />\n                Recomenda√ß√µes de Seguran√ßa\n              </h2>\n              \n              <div className=\"grid md:grid-cols-2 gap-6\">\n                <div className=\"p-4 bg-green-50 dark:bg-green-900/30 rounded-lg\">\n                  <h3 className=\"font-medium text-green-900 dark:text-green-100 mb-2\">\n                    Encontros Presenciais:\n                  </h3>\n                  <ul className=\"text-sm text-green-800 dark:text-green-200 space-y-1\">\n                    <li>‚Ä¢ Sempre encontre-se inicialmente em locais p√∫blicos</li>\n                    <li>‚Ä¢ Informe amigos/fam√≠lia sobre seus planos</li>\n                    <li>‚Ä¢ Confira documentos de identifica√ß√£o</li>\n                  </ul>\n                </div>\n                \n                <div className=\"p-4 bg-green-50 dark:bg-green-900/30 rounded-lg\">\n                  <h3 className=\"font-medium text-green-900 dark:text-green-100 mb-2\">\n                    Transa√ß√µes Financeiras:\n                  </h3>\n                  <ul className=\"text-sm text-green-800 dark:text-green-200 space-y-1\">\n                    <li>‚Ä¢ Use plataformas de pagamento rastre√°veis</li>\n                    <li>‚Ä¢ Guarde comprovantes digitais</li>\n                    <li>‚Ä¢ Estabele√ßa limites claros de responsabilidade</li>\n                  </ul>\n                </div>\n                \n                <div className=\"p-4 bg-green-50 dark:bg-green-900/30 rounded-lg\">\n                  <h3 className=\"font-medium text-green-900 dark:text-green-100 mb-2\">\n                    Prote√ß√£o de Dados:\n                  </h3>\n                  <ul className=\"text-sm text-green-800 dark:text-green-200 space-y-1\">\n                    <li>‚Ä¢ N√£o compartilhe documentos completos na plataforma</li>\n                    <li>‚Ä¢ Use senhas complexas e √∫nicas</li>\n                    <li>‚Ä¢ Revise periodicamente suas permiss√µes</li>\n                  </ul>\n                </div>\n                \n                <div className=\"p-4 bg-green-50 dark:bg-green-900/30 rounded-lg\">\n                  <h3 className=\"font-medium text-green-900 dark:text-green-100 mb-2\">\n                    Den√∫ncias:\n                  </h3>\n                  <ul className=\"text-sm text-green-800 dark:text-green-200 space-y-1\">\n                    <li>‚Ä¢ Reporte comportamentos suspeitos imediatamente</li>\n                    <li>‚Ä¢ Bloqueie usu√°rios que violem suas normas pessoais</li>\n                    <li>‚Ä¢ Colabore com investiga√ß√µes quando solicitado</li>\n                  </ul>\n                </div>\n              </div>\n            </section>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":15915},"client/src/pages/trip-detail-page.tsx":{"content":"import { useParams } from \"wouter\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/hooks/use-auth-snake\";\nimport { Navbar } from \"@/components/navbar\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { AdvancedActivityManager } from \"@/components/advanced-activity-manager\";\nimport { PlannedActivity } from \"@shared/schema\";\nimport { motion } from \"framer-motion\";\nimport { \n  MapPin, \n  Calendar, \n  DollarSign, \n  Users, \n  MessageCircle, \n  Share2,\n  Clock,\n  Check,\n  X,\n  User,\n  Camera,\n  Star,\n  Heart,\n  TrendingUp,\n  Timer,\n  Sparkles,\n  Target,\n  Trophy,\n  Zap,\n  Gift,\n  AlertCircle,\n  ChevronRight,\n  Utensils,\n  Mountain,\n  Palette,\n  Waves,\n  Music,\n  ShoppingBag,\n  Edit2,\n  Trash2,\n  Plus,\n  Save,\n  Calculator,\n  BarChart3,\n  CheckCircle,\n  PieChart,\n  Eye,\n  Info,\n  UserPlus,\n  Plane,\n  Home,\n  Shield,\n  MoreHorizontal\n} from \"lucide-react\";\nimport { format, differenceInDays, differenceInHours, differenceInMinutes, parseISO, isSameDay } from \"date-fns\";\nimport { ptBR } from \"date-fns/locale\";\nimport { getRealParticipantsCount, getTripOccupancy, getParticipantsForBudgetCalculation, hasTripStarted } from \"@/lib/trip-utils\";\nimport React, { useState, useEffect, useMemo } from \"react\";\nimport { expenseCategories, budgetCategories, BudgetBreakdown } from \"@shared/schema\";\nimport { formatBrazilianCurrency, formatBrazilianNumber, calculatePerPerson, sumValues, parseNumber, calculateProgress } from \"@shared/utils\";\nimport { LoadingSpinner } from \"@/components/loading-spinner\";\nimport { BudgetVisualization } from \"@/components/budget-visualization\";\nimport { ExpenseManager } from \"@/components/expense-manager\";\nimport { CoverImageSelector } from \"@/components/cover-image-selector\";\nimport { BudgetEditor } from \"@/components/budget-editor\";\n\n// Countdown Timer Component\nfunction CountdownTimer({ targetDate }: { targetDate: string }) {\n  const [timeLeft, setTimeLeft] = useState({\n    days: 0,\n    hours: 0,\n    minutes: 0,\n    seconds: 0\n  });\n\n  useEffect(() => {\n    if (!targetDate) return;\n    \n    const timer = setInterval(() => {\n      try {\n        const now = new Date();\n        const target = new Date(targetDate);\n        \n        // Check if target date is valid\n        if (isNaN(target.getTime())) {\n          console.warn('Invalid target date:', targetDate);\n          return;\n        }\n        \n        const difference = target.getTime() - now.getTime();\n\n        if (difference > 0) {\n          setTimeLeft({\n            days: Math.floor(difference / (1000 * 60 * 60 * 24)),\n            hours: Math.floor((difference / (1000 * 60 * 60)) % 24),\n            minutes: Math.floor((difference / 1000 / 60) % 60),\n            seconds: Math.floor((difference / 1000) % 60)\n          });\n        } else {\n          setTimeLeft({ days: 0, hours: 0, minutes: 0, seconds: 0 });\n        }\n      } catch (error) {\n        console.warn('Error in countdown timer:', error);\n      }\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, [targetDate]);\n\n  // Safe date comparison\n  let isPast = false;\n  try {\n    if (targetDate) {\n      const target = new Date(targetDate);\n      if (!isNaN(target.getTime())) {\n        isPast = target < new Date();\n      }\n    }\n  } catch (error) {\n    console.warn('Error checking if date is past:', error);\n  }\n\n  // Fun√ß√£o para determinar o gradiente baseado nos dias restantes\n  const getGradientClasses = (days: number) => {\n    if (days <= 7) {\n      // Vermelho intenso - urgente (at√© 7 dias)\n      return {\n        gradient: \"from-red-600 via-red-500 to-orange-500\",\n        textAccent: \"text-red-100\",\n        iconAccent: \"text-red-100\"\n      };\n    } else if (days <= 30) {\n      // Laranja - pr√≥ximo (at√© 30 dias)\n      return {\n        gradient: \"from-orange-500 via-amber-500 to-yellow-500\",\n        textAccent: \"text-orange-100\",\n        iconAccent: \"text-orange-100\"\n      };\n    } else if (days <= 90) {\n      // Verde/azul - m√©dio prazo (at√© 90 dias)\n      return {\n        gradient: \"from-emerald-600 via-teal-600 to-cyan-600\",\n        textAccent: \"text-emerald-100\",\n        iconAccent: \"text-emerald-100\"\n      };\n    } else {\n      // Azul/roxo - planejamento (mais de 90 dias)\n      return {\n        gradient: \"from-blue-600 via-purple-600 to-indigo-600\",\n        textAccent: \"text-blue-100\",\n        iconAccent: \"text-blue-100\"\n      };\n    }\n  };\n\n  if (isPast) {\n    return (\n      <div className=\"bg-gradient-to-r from-amber-500 to-orange-500 rounded-lg p-2 sm:p-3 md:p-4 text-white shadow-lg w-full max-w-[280px] sm:max-w-sm md:max-w-md\">\n        <div className=\"flex items-center justify-center gap-1 sm:gap-2\">\n          <Trophy className=\"h-4 w-4 sm:h-5 sm:w-5 md:h-6 md:w-6 text-amber-100\" />\n          <div className=\"text-center\">\n            <h2 className=\"text-xs sm:text-sm md:text-base font-bold\">Viagem Conclu√≠da!</h2>\n            <p className=\"text-amber-100 text-[10px] sm:text-xs\">Esperamos que tenha sido incr√≠vel!</p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  const gradientConfig = getGradientClasses(timeLeft.days);\n\n  return (\n    <div className={`bg-gradient-to-r ${gradientConfig.gradient} rounded-lg p-2 sm:p-3 md:p-4 text-white shadow-lg transition-all duration-1000 w-full max-w-[280px] sm:max-w-sm md:max-w-md lg:max-w-lg`}>\n      <div className=\"text-center\">\n        <div className=\"flex items-center justify-center gap-1 sm:gap-2 mb-1.5 sm:mb-2\">\n          <Timer className={`h-3 w-3 sm:h-4 sm:w-4 md:h-5 md:w-5 ${gradientConfig.iconAccent}`} />\n          <h2 className=\"text-xs sm:text-sm md:text-base font-bold\">Contagem Regressiva</h2>\n        </div>\n        <div className=\"grid grid-cols-4 gap-1 sm:gap-1.5 md:gap-2 max-w-[240px] sm:max-w-xs md:max-w-sm mx-auto\">\n          <motion.div\n            initial={{ scale: 0.8, opacity: 0 }}\n            animate={{ scale: 1, opacity: 1 }}\n            transition={{ delay: 0.1 }}\n            className=\"bg-white/20 backdrop-blur-sm rounded-lg p-1 sm:p-1.5 md:p-2 border border-white/30\"\n          >\n            <div className=\"text-xs sm:text-sm md:text-xl lg:text-2xl font-bold text-white\">{timeLeft.days}</div>\n            <div className={`text-[10px] sm:text-xs ${gradientConfig.textAccent}`}>Dias</div>\n          </motion.div>\n          <motion.div\n            initial={{ scale: 0.8, opacity: 0 }}\n            animate={{ scale: 1, opacity: 1 }}\n            transition={{ delay: 0.2 }}\n            className=\"bg-white/20 backdrop-blur-sm rounded-lg p-1 sm:p-1.5 md:p-2 border border-white/30\"\n          >\n            <div className=\"text-xs sm:text-sm md:text-xl lg:text-2xl font-bold text-white\">{timeLeft.hours}</div>\n            <div className={`text-[10px] sm:text-xs ${gradientConfig.textAccent}`}>Horas</div>\n          </motion.div>\n          <motion.div\n            initial={{ scale: 0.8, opacity: 0 }}\n            animate={{ scale: 1, opacity: 1 }}\n            transition={{ delay: 0.3 }}\n            className=\"bg-white/20 backdrop-blur-sm rounded-lg p-1 sm:p-1.5 md:p-2 border border-white/30\"\n          >\n            <div className=\"text-xs sm:text-sm md:text-xl lg:text-2xl font-bold text-white\">{timeLeft.minutes}</div>\n            <div className={`text-[10px] sm:text-xs ${gradientConfig.textAccent}`}>Min</div>\n          </motion.div>\n          <motion.div\n            initial={{ scale: 0.8, opacity: 0 }}\n            animate={{ scale: 1, opacity: 1 }}\n            transition={{ delay: 0.4 }}\n            className=\"bg-white/20 backdrop-blur-sm rounded-lg p-1 sm:p-1.5 md:p-2 border border-white/30\"\n          >\n            <div className=\"text-xs sm:text-sm md:text-xl lg:text-2xl font-bold text-white\">{timeLeft.seconds}</div>\n            <div className={`text-[10px] sm:text-xs ${gradientConfig.textAccent}`}>Seg</div>\n          </motion.div>\n        </div>\n        <p className={`mt-1.5 sm:mt-2 ${gradientConfig.textAccent} text-[10px] sm:text-xs`}>\n          Faltam {timeLeft.days} dias para sua aventura!\n        </p>\n      </div>\n    </div>\n  );\n}\n\n// Trip Statistics Component\nfunction TripStatistics({ trip, planned_activities = [] }: { trip: any; planned_activities?: PlannedActivity[] }) {\n  const stats = useMemo(() => {\n    const totalBudget = Number(trip.budget) || 0;\n    const realParticipants = getRealParticipantsCount(trip);\n    const budgetParticipants = getParticipantsForBudgetCalculation(trip);\n    const perPerson = budgetParticipants > 0 ? totalBudget / budgetParticipants : 0;\n    \n    // Safe date parsing with fallbacks\n    const startDate = trip.start_date || trip.startDate;\n    const endDate = trip.end_date || trip.endDate;\n    \n    let daysUntil = 0;\n    let duration = 1;\n    \n    try {\n      if (startDate) {\n        const start = new Date(startDate);\n        if (!isNaN(start.getTime())) {\n          daysUntil = differenceInDays(start, new Date());\n        }\n        \n        if (endDate) {\n          const end = new Date(endDate);\n          if (!isNaN(end.getTime())) {\n            duration = differenceInDays(end, start);\n          }\n        }\n      }\n    } catch (error) {\n      console.warn('Error calculating date differences:', error);\n    }\n    \n    const occupancy = getTripOccupancy(trip);\n\n    return {\n      totalBudget,\n      perPerson: isNaN(perPerson) ? 0 : perPerson,\n      daysUntil: Math.max(0, daysUntil),\n      duration: Math.max(1, duration),\n      realParticipants,\n      budgetParticipants,\n      occupancy: isNaN(occupancy) ? 0 : occupancy\n    };\n  }, [trip]);\n\n  return (\n    <div className=\"grid grid-cols-2 sm:grid-cols-4 gap-3 sm:gap-4 w-full\">\n      {/* Or√ßamento Card */}\n      <Card className=\"bg-white border border-gray-200 shadow-sm hover:shadow-md transition-shadow duration-200\">\n        <CardContent className=\"p-3 sm:p-4\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <div className=\"p-1.5 bg-emerald-500 rounded-lg\">\n              <DollarSign className=\"h-4 w-4 text-white\" />\n            </div>\n            <div className=\"text-xs sm:text-sm font-medium text-gray-600\">Or√ßamento</div>\n          </div>\n          <div className=\"text-base sm:text-lg font-bold text-gray-900\">\n            {formatBrazilianCurrency(stats.totalBudget)}\n          </div>\n          <div className=\"text-xs text-emerald-600\">\n            {formatBrazilianCurrency(stats.perPerson)} /pessoa\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Participa√ß√£o Card */}\n      <Card className=\"bg-white border border-gray-200 shadow-sm hover:shadow-md transition-shadow duration-200\">\n        <CardContent className=\"p-3 sm:p-4\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <div className=\"p-1.5 bg-purple-500 rounded-lg\">\n              <Users className=\"h-4 w-4 text-white\" />\n            </div>\n            <div className=\"text-xs sm:text-sm font-medium text-gray-600\">Participantes</div>\n          </div>\n          <div className=\"text-base sm:text-lg font-bold text-gray-900\">\n            {stats.realParticipants}/{trip.max_participants}\n          </div>\n          <div className=\"text-xs text-purple-600\">\n            {Math.round(stats.occupancy)}% ocupa√ß√£o\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Dura√ß√£o Card */}\n      <Card className=\"bg-white border border-gray-200 shadow-sm hover:shadow-md transition-shadow duration-200\">\n        <CardContent className=\"p-3 sm:p-4\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <div className=\"p-1.5 bg-blue-500 rounded-lg\">\n              <Calendar className=\"h-4 w-4 text-white\" />\n            </div>\n            <div className=\"text-xs sm:text-sm font-medium text-gray-600\">Dura√ß√£o</div>\n          </div>\n          <div className=\"text-base sm:text-lg font-bold text-gray-900\">\n            {stats.duration} {stats.duration === 1 ? 'dia' : 'dias'}\n          </div>\n          {planned_activities.length > 0 && (\n            <div className=\"text-xs text-blue-600\">\n              {planned_activities.length} atividades\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      {/* Status Card */}\n      <Card className=\"bg-white border border-gray-200 shadow-sm hover:shadow-md transition-shadow duration-200\">\n        <CardContent className=\"p-3 sm:p-4\">\n          <div className=\"flex items-center gap-2 mb-2\">\n            <div className={`p-1.5 rounded-lg ${\n              trip.status === 'open' ? 'bg-green-500' : 'bg-red-500'\n            }`}>\n              {trip.status === 'open' ? (\n                <Star className=\"h-4 w-4 text-white\" />\n              ) : (\n                <X className=\"h-4 w-4 text-white\" />\n              )}\n            </div>\n            <div className=\"text-xs sm:text-sm font-medium text-gray-600\">Status</div>\n          </div>\n          <div className={`text-base sm:text-lg font-bold ${\n            trip.status === 'open' ? 'text-green-700' : 'text-red-700'\n          }`}>\n            {trip.status === 'open' ? 'Aberta' : 'Fechada'}\n          </div>\n          <div className={`text-xs ${\n            trip.status === 'open' ? 'text-green-600' : 'text-red-600'\n          }`}>\n            {trip.status === 'open' ? 'Aceita membros' : 'Viagem lotada'}\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\n// Enhanced Activities Timeline Component with Edit Features\nfunction ActivitiesTimeline({ \n  activities, \n  tripStartDate, \n  tripEndDate, \n  canJoin, \n  onJoinClick,\n  onActivitiesChange,\n  isEditable = false,\n  trip\n}: {\n  activities: PlannedActivity[];\n  tripStartDate: string;\n  tripEndDate: string;\n  canJoin: boolean;\n  onJoinClick: () => void;\n  onActivitiesChange?: (activities: PlannedActivity[]) => void;\n  isEditable?: boolean;\n  trip?: any;\n}) {\n  const [editingActivity, setEditingActivity] = useState<PlannedActivity | null>(null);\n  const [isAddingActivity, setIsAddingActivity] = useState(false);\n  const [newActivity, setNewActivity] = useState<Partial<PlannedActivity>>({\n    priority: 'medium',\n    category: 'sightseeing',\n    scheduled_date: tripStartDate\n  });\n  const { toast } = useToast();\n\n  // Functions to handle activity editing\n  const handleSaveActivity = async (activity: PlannedActivity) => {\n    if (!onActivitiesChange) return;\n    \n    const updatedActivities = activities.map(a => \n      a.id === activity.id ? activity : a\n    );\n    \n    try {\n      // Save to backend if trip is provided\n      if (trip) {\n        const response = await fetch(`/api/trips/${trip.id}`, {\n          method: 'PATCH',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          credentials: 'include',\n          body: JSON.stringify({ planned_activities: updatedActivities })\n        });\n        if (!response.ok) throw new Error('Failed to save');\n      }\n      \n      onActivitiesChange(updatedActivities);\n      setEditingActivity(null);\n      toast({\n        title: \"Atividade atualizada\",\n        description: \"As altera√ß√µes foram salvas com sucesso.\",\n      });\n    } catch (error) {\n      console.error('Erro ao salvar atividade:', error);\n      toast({\n        title: \"Erro ao salvar\",\n        description: \"N√£o foi poss√≠vel salvar as altera√ß√µes. Tente novamente.\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const handleDeleteActivity = async (activityId: string) => {\n    if (!onActivitiesChange) return;\n    \n    const updatedActivities = activities.filter(a => a.id !== activityId);\n    \n    try {\n      // Save to backend if trip is provided\n      if (trip) {\n        const response = await fetch(`/api/trips/${trip.id}`, {\n          method: 'PATCH',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          credentials: 'include',\n          body: JSON.stringify({ planned_activities: updatedActivities })\n        });\n        if (!response.ok) throw new Error('Failed to delete');\n      }\n      \n      onActivitiesChange(updatedActivities);\n      toast({\n        title: \"Atividade removida\",\n        description: \"A atividade foi removida do cronograma.\",\n      });\n    } catch (error) {\n      console.error('Erro ao remover atividade:', error);\n      toast({\n        title: \"Erro ao remover\",\n        description: \"N√£o foi poss√≠vel remover a atividade. Tente novamente.\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  const handleAddActivity = async () => {\n    if (!onActivitiesChange || !newActivity.title) return;\n    \n    const activity: PlannedActivity = {\n      id: Date.now().toString(),\n      title: newActivity.title,\n      description: newActivity.description,\n      category: (newActivity.category as PlannedActivity['category']) || 'sightseeing',\n      priority: newActivity.priority || 'medium',\n      estimated_cost: newActivity.estimated_cost,\n      duration: newActivity.duration,\n      location: newActivity.location,\n      scheduled_date: newActivity.scheduled_date || tripStartDate,\n      notes: newActivity.notes,\n      completed: false,\n      created_at: new Date().toISOString(),\n      status: 'planned'\n    };\n    \n    const updatedActivities = [...activities, activity];\n    \n    try {\n      // Save to backend if trip is provided\n      if (trip) {\n        const response = await fetch(`/api/trips/${trip.id}`, {\n          method: 'PATCH',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          credentials: 'include',\n          body: JSON.stringify({ planned_activities: updatedActivities })\n        });\n        if (!response.ok) throw new Error('Failed to add');\n      }\n      \n      onActivitiesChange(updatedActivities);\n      setNewActivity({\n        priority: 'medium',\n        category: 'sightseeing',\n        scheduled_date: tripStartDate\n      });\n      setIsAddingActivity(false);\n      toast({\n        title: \"Atividade adicionada\",\n        description: \"Nova atividade foi adicionada ao cronograma.\",\n      });\n    } catch (error) {\n      console.error('Erro ao adicionar atividade:', error);\n      toast({\n        title: \"Erro ao adicionar\",\n        description: \"N√£o foi poss√≠vel adicionar a atividade. Tente novamente.\",\n        variant: \"destructive\"\n      });\n    }\n  };\n\n  // Function to get category icon and color\n  const getCategoryConfig = (category: string) => {\n    switch (category) {\n      case 'sightseeing':\n        return { icon: Camera, color: 'bg-blue-100 text-blue-600 border-blue-200', label: 'Turismo' };\n      case 'food':\n        return { icon: Utensils, color: 'bg-orange-100 text-orange-600 border-orange-200', label: 'Comida' };\n      case 'adventure':\n        return { icon: Mountain, color: 'bg-green-100 text-green-600 border-green-200', label: 'Aventura' };\n      case 'culture':\n        return { icon: Palette, color: 'bg-purple-100 text-purple-600 border-purple-200', label: 'Cultura' };\n      case 'relaxation':\n        return { icon: Waves, color: 'bg-teal-100 text-teal-600 border-teal-200', label: 'Relaxamento' };\n      case 'nightlife':\n        return { icon: Music, color: 'bg-pink-100 text-pink-600 border-pink-200', label: 'Vida Noturna' };\n      case 'shopping':\n        return { icon: ShoppingBag, color: 'bg-indigo-100 text-indigo-600 border-indigo-200', label: 'Compras' };\n      default:\n        return { icon: Target, color: 'bg-gray-100 text-gray-600 border-gray-200', label: category };\n    }\n  };\n\n  // Function to get priority color\n  const getPriorityColor = (priority: string) => {\n    switch (priority) {\n      case 'high':\n        return 'bg-red-100 text-red-700 border-red-200';\n      case 'medium':\n        return 'bg-yellow-100 text-yellow-700 border-yellow-200';\n      case 'low':\n        return 'bg-green-100 text-green-700 border-green-200';\n      default:\n        return 'bg-gray-100 text-gray-700 border-gray-200';\n    }\n  };\n\n  // Group activities by date\n  const groupedActivities = useMemo(() => {\n    if (!activities || activities.length === 0) return [];\n\n    const grouped: { [key: string]: PlannedActivity[] } = {};\n    \n    activities.forEach(activity => {\n      if (activity.scheduled_date) {\n        try {\n          const date = parseISO(activity.scheduled_date);\n          if (!isNaN(date.getTime())) {\n            const dateKey = format(date, 'yyyy-MM-dd');\n            \n            if (!grouped[dateKey]) {\n              grouped[dateKey] = [];\n            }\n            grouped[dateKey].push(activity);\n          }\n        } catch (error) {\n          console.warn('Error parsing activity date:', activity.scheduled_date, error);\n        }\n      }\n    });\n\n    // Sort dates and activities within each date\n    return Object.entries(grouped)\n      .sort(([dateA], [dateB]) => dateA.localeCompare(dateB))\n      .map(([date, dayActivities]) => {\n        try {\n          const dateObj = parseISO(date);\n          return {\n            date,\n            displayDate: format(dateObj, 'EEEE, dd/MM', { locale: ptBR }),\n            fullDate: format(dateObj, 'dd \\'de\\' MMMM \\'de\\' yyyy', { locale: ptBR }),\n            shortDate: format(dateObj, 'dd/MM', { locale: ptBR }),\n            dayOfWeek: format(dateObj, 'EEEE', { locale: ptBR }),\n            activities: dayActivities.sort((a, b) => {\n              // Sort by priority (high > medium > low), then by title\n              const priorityOrder = { high: 3, medium: 2, low: 1 };\n              const aPriority = priorityOrder[a.priority as keyof typeof priorityOrder] || 0;\n              const bPriority = priorityOrder[b.priority as keyof typeof priorityOrder] || 0;\n              \n              if (aPriority !== bPriority) {\n                return bPriority - aPriority;\n              }\n              \n              return a.title.localeCompare(b.title);\n            })\n          };\n        } catch (error) {\n          console.warn('Error formatting date:', date, error);\n          return {\n            date,\n            displayDate: date,\n            fullDate: date,\n            shortDate: date,\n            dayOfWeek: 'Data inv√°lida',\n            activities: dayActivities\n          };\n        }\n      });\n  }, [activities]);\n\n  if (activities.length === 0) {\n    return (\n      <div className=\"text-center py-12\">\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5 }}\n          className=\"space-y-4\"\n        >\n          <div className=\"w-16 h-16 mx-auto bg-gray-100 rounded-full flex items-center justify-center\">\n            <Target className=\"h-8 w-8 text-gray-400\" />\n          </div>\n          <div className=\"space-y-2\">\n            <h3 className=\"text-lg font-semibold text-gray-900\">Nenhuma atividade planejada</h3>\n            <p className=\"text-gray-600 max-w-md mx-auto\">\n              Comece a planejar suas atividades para tornar esta viagem ainda mais especial!\n            </p>\n          </div>\n          {canJoin && (\n            <div className=\"pt-4\">\n              <p className=\"text-sm text-gray-600 mb-3\">\n                Participe da viagem para ajudar no planejamento das atividades!\n              </p>\n              <Button onClick={onJoinClick} className=\"inline-flex items-center gap-2\">\n                <Heart className=\"h-4 w-4\" />\n                Solicitar Participa√ß√£o\n              </Button>\n            </div>\n          )}\n        </motion.div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-8\">\n      {/* Timeline Header */}\n      <div className=\"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-100\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-4\">\n            <div className=\"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center shadow-lg\">\n              <Calendar className=\"h-6 w-6 text-white\" />\n            </div>\n            <div>\n              <h3 className=\"text-xl font-bold text-gray-900\">Cronograma de Atividades</h3>\n              <p className=\"text-sm text-gray-600 mt-1\">\n                {groupedActivities.length} {groupedActivities.length === 1 ? 'dia' : 'dias'} com atividades planejadas\n              </p>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-4\">\n            <div className=\"text-right\">\n              <div className=\"text-2xl font-bold text-blue-600\">\n                {activities.length}\n              </div>\n              <div className=\"text-sm text-gray-500\">\n                {activities.length === 1 ? 'atividade' : 'atividades'}\n              </div>\n            </div>\n            {isEditable && (\n              <Button\n                onClick={() => setIsAddingActivity(true)}\n                className=\"bg-blue-500 hover:bg-blue-600 text-white\"\n              >\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Adicionar Atividade\n              </Button>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Timeline */}\n      <div className=\"relative\">\n        {/* Timeline Line */}\n        <div className=\"absolute left-8 top-0 bottom-0 w-0.5 bg-gradient-to-b from-blue-300 via-blue-400 to-blue-300 rounded-full\"></div>\n        \n        <div className=\"space-y-12\">\n          {groupedActivities.map((dayGroup, dayIndex) => (\n            <motion.div\n              key={dayGroup.date}\n              initial={{ opacity: 0, x: -30 }}\n              animate={{ opacity: 1, x: 0 }}\n              transition={{ duration: 0.6, delay: dayIndex * 0.15 }}\n              className=\"relative\"\n            >\n              {/* Date Header */}\n              <div className=\"flex items-center gap-6 mb-6\">\n                <div className=\"relative z-10 w-16 h-16 bg-white border-4 border-blue-500 rounded-full flex items-center justify-center shadow-xl\">\n                  <div className=\"text-center\">\n                    <div className=\"text-xs font-semibold text-blue-600 uppercase tracking-wide\">\n                      {dayGroup.shortDate}\n                    </div>\n                  </div>\n                </div>\n                <div className=\"bg-white px-6 py-4 rounded-xl border border-gray-200 shadow-sm flex-1\">\n                  <div className=\"flex items-center justify-between\">\n                    <div>\n                      <h4 className=\"text-lg font-bold text-gray-900 capitalize\">{dayGroup.dayOfWeek}</h4>\n                      <p className=\"text-sm text-gray-600 mt-1\">{dayGroup.fullDate}</p>\n                    </div>\n                    <div className=\"text-right\">\n                      <div className=\"text-lg font-semibold text-blue-600\">\n                        {dayGroup.activities.length}\n                      </div>\n                      <div className=\"text-xs text-gray-500\">\n                        {dayGroup.activities.length === 1 ? 'atividade' : 'atividades'}\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              {/* Activities for this day */}\n              <div className=\"ml-20 space-y-4\">\n                {dayGroup.activities.map((activity, activityIndex) => {\n                  const categoryConfig = getCategoryConfig(activity.category);\n                  const IconComponent = categoryConfig.icon;\n                  \n                  return (\n                    <motion.div\n                      key={activity.id}\n                      initial={{ opacity: 0, y: 15 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      transition={{ duration: 0.4, delay: (dayIndex * 0.15) + (activityIndex * 0.08) }}\n                      className=\"group bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-lg hover:border-blue-300 transition-all duration-300 overflow-hidden\"\n                    >\n                      <div className=\"p-6\">\n                        <div className=\"flex items-start gap-4\">\n                          {/* Activity Icon */}\n                          <div className={`flex-shrink-0 w-12 h-12 rounded-xl border-2 flex items-center justify-center ${categoryConfig.color} group-hover:scale-110 transition-transform duration-200`}>\n                            <IconComponent className=\"h-6 w-6\" />\n                          </div>\n                          \n                          {/* Activity Content */}\n                          <div className=\"flex-1 min-w-0\">\n                            <div className=\"flex items-start justify-between mb-3\">\n                              <h5 className=\"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors duration-200\">\n                                {activity.title}\n                              </h5>\n                              <div className=\"flex items-center gap-2 flex-shrink-0\">\n                                <Badge variant=\"outline\" className={`text-xs px-3 py-1 font-medium ${getPriorityColor(activity.priority)}`}>\n                                  {activity.priority === 'high' ? 'Alta' : \n                                   activity.priority === 'medium' ? 'M√©dia' : 'Baixa'}\n                                </Badge>\n                                <Badge variant=\"outline\" className=\"text-xs px-3 py-1 font-medium bg-gray-50 text-gray-700\">\n                                  {categoryConfig.label}\n                                </Badge>\n                                {isEditable && (\n                                  <div className=\"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity duration-200\">\n                                    <Button\n                                      size=\"sm\"\n                                      variant=\"outline\"\n                                      onClick={() => setEditingActivity(activity)}\n                                      className=\"h-8 w-8 p-0 border-blue-200 hover:bg-blue-50 hover:border-blue-300\"\n                                    >\n                                      <Edit2 className=\"h-3 w-3 text-blue-600\" />\n                                    </Button>\n                                    <Button\n                                      size=\"sm\"\n                                      variant=\"outline\"\n                                      onClick={() => handleDeleteActivity(activity.id)}\n                                      className=\"h-8 w-8 p-0 border-red-200 hover:bg-red-50 hover:border-red-300\"\n                                    >\n                                      <Trash2 className=\"h-3 w-3 text-red-600\" />\n                                    </Button>\n                                  </div>\n                                )}\n                              </div>\n                            </div>\n                            \n                            {activity.description && (\n                              <p className=\"text-sm text-gray-600 mb-4 leading-relaxed line-clamp-3\">\n                                {activity.description}\n                              </p>\n                            )}\n                            \n                            {/* Activity Details */}\n                            <div className=\"flex items-center justify-between\">\n                              <div className=\"flex items-center gap-6 text-sm text-gray-500\">\n                                {activity.duration && (\n                                  <div className=\"flex items-center gap-2\">\n                                    <Clock className=\"h-4 w-4\" />\n                                    <span className=\"font-medium\">{activity.duration}</span>\n                                  </div>\n                                )}\n                                {activity.location && (\n                                  <div className=\"flex items-center gap-2\">\n                                    <MapPin className=\"h-4 w-4\" />\n                                    <span className=\"truncate max-w-40 font-medium\">{activity.location}</span>\n                                  </div>\n                                )}\n                              </div>\n                              \n                              {activity.estimated_cost && (\n                                <div className=\"flex items-center gap-2 text-sm font-semibold text-green-600 bg-green-50 px-3 py-2 rounded-lg border border-green-200\">\n                                  <DollarSign className=\"h-4 w-4\" />\n                                  <span>{formatBrazilianCurrency(activity.estimated_cost)}</span>\n                                </div>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </motion.div>\n                  );\n                })}\n              </div>\n            </motion.div>\n          ))}\n        </div>\n      </div>\n\n      {/* Summary Card */}\n      <motion.div\n        initial={{ opacity: 0, y: 20 }}\n        animate={{ opacity: 1, y: 0 }}\n        transition={{ duration: 0.5, delay: 0.3 }}\n        className=\"bg-gradient-to-r from-blue-50 via-indigo-50 to-purple-50 rounded-xl p-6 border border-blue-200\"\n      >\n        <div className=\"flex items-center gap-4\">\n          <div className=\"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center shadow-lg\">\n            <Trophy className=\"h-6 w-6 text-white\" />\n          </div>\n          <div className=\"flex-1\">\n            <h4 className=\"text-lg font-bold text-gray-900\">Resumo do Planejamento</h4>\n            <p className=\"text-sm text-gray-600 mt-1\">\n              {activities.length} atividades distribu√≠das em {groupedActivities.length} {groupedActivities.length === 1 ? 'dia' : 'dias'}\n            </p>\n          </div>\n          <div className=\"text-right\">\n            <div className=\"text-2xl font-bold text-blue-600\">\n              {formatBrazilianCurrency(activities.reduce((sum, activity) => sum + (activity.estimated_cost || 0), 0))}\n            </div>\n            <div className=\"text-sm text-gray-500\">Custo total estimado</div>\n          </div>\n        </div>\n      </motion.div>\n\n      {/* Edit Activity Dialog */}\n      {editingActivity && (\n        <Dialog open={!!editingActivity} onOpenChange={() => setEditingActivity(null)}>\n          <DialogContent className=\"w-[95vw] max-w-2xl max-h-[95vh] overflow-y-auto\">\n            <DialogHeader>\n              <DialogTitle>Editar Atividade</DialogTitle>\n            </DialogHeader>\n            <div className=\"space-y-4\">\n              <div>\n                <Label htmlFor=\"edit-title\">T√≠tulo</Label>\n                <Input\n                  id=\"edit-title\"\n                  value={editingActivity.title}\n                  onChange={(e) => setEditingActivity({...editingActivity, title: e.target.value})}\n                />\n              </div>\n              <div>\n                <Label htmlFor=\"edit-description\">Descri√ß√£o</Label>\n                <Textarea\n                  id=\"edit-description\"\n                  value={editingActivity.description || ''}\n                  onChange={(e) => setEditingActivity({...editingActivity, description: e.target.value})}\n                />\n              </div>\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                <div>\n                  <Label htmlFor=\"edit-category\">Categoria</Label>\n                  <Select value={editingActivity.category} onValueChange={(value) => setEditingActivity({...editingActivity, category: value as PlannedActivity['category']})}>\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"sightseeing\">Turismo</SelectItem>\n                      <SelectItem value=\"food\">Comida</SelectItem>\n                      <SelectItem value=\"adventure\">Aventura</SelectItem>\n                      <SelectItem value=\"culture\">Cultura</SelectItem>\n                      <SelectItem value=\"relaxation\">Relaxamento</SelectItem>\n                      <SelectItem value=\"nightlife\">Vida Noturna</SelectItem>\n                      <SelectItem value=\"shopping\">Compras</SelectItem>\n                      <SelectItem value=\"other\">Outro</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div>\n                  <Label htmlFor=\"edit-priority\">Prioridade</Label>\n                  <Select value={editingActivity.priority} onValueChange={(value) => setEditingActivity({...editingActivity, priority: value as 'high' | 'medium' | 'low'})}>\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"high\">Alta</SelectItem>\n                      <SelectItem value=\"medium\">M√©dia</SelectItem>\n                      <SelectItem value=\"low\">Baixa</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n              <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n                <div>\n                  <Label htmlFor=\"edit-duration\">Dura√ß√£o</Label>\n                  <Input\n                    id=\"edit-duration\"\n                    value={editingActivity.duration || ''}\n                    onChange={(e) => setEditingActivity({...editingActivity, duration: e.target.value})}\n                    placeholder=\"ex: 2 horas\"\n                  />\n                </div>\n                <div>\n                  <Label htmlFor=\"edit-cost\">Custo Estimado (R$)</Label>\n                  <Input\n                    id=\"edit-cost\"\n                    type=\"number\"\n                    value={editingActivity.estimated_cost || ''}\n                    onChange={(e) => setEditingActivity({...editingActivity, estimated_cost: Number(e.target.value)})}\n                  />\n                </div>\n              </div>\n              <div>\n                <Label htmlFor=\"edit-location\">Local</Label>\n                <Input\n                  id=\"edit-location\"\n                  value={editingActivity.location || ''}\n                  onChange={(e) => setEditingActivity({...editingActivity, location: e.target.value})}\n                />\n              </div>\n              <div>\n                <Label htmlFor=\"edit-notes\">Observa√ß√µes</Label>\n                <Textarea\n                  id=\"edit-notes\"\n                  value={editingActivity.notes || ''}\n                  onChange={(e) => setEditingActivity({...editingActivity, notes: e.target.value})}\n                />\n              </div>\n              <div className=\"flex flex-col sm:flex-row gap-2 pt-4\">\n                <Button onClick={() => handleSaveActivity(editingActivity)} className=\"flex-1\">\n                  <Save className=\"h-4 w-4 mr-2\" />\n                  Salvar Altera√ß√µes\n                </Button>\n                <Button variant=\"outline\" onClick={() => setEditingActivity(null)} className=\"sm:w-auto\">\n                  Cancelar\n                </Button>\n              </div>\n            </div>\n          </DialogContent>\n        </Dialog>\n      )}\n\n      {/* Add Activity Dialog */}\n      <Dialog open={isAddingActivity} onOpenChange={setIsAddingActivity}>\n        <DialogContent className=\"w-[95vw] max-w-2xl max-h-[95vh] overflow-y-auto\">\n          <DialogHeader>\n            <DialogTitle>Adicionar Nova Atividade</DialogTitle>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"new-title\">T√≠tulo</Label>\n              <Input\n                id=\"new-title\"\n                value={newActivity.title || ''}\n                onChange={(e) => setNewActivity({...newActivity, title: e.target.value})}\n                placeholder=\"Nome da atividade\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"new-description\">Descri√ß√£o</Label>\n              <Textarea\n                id=\"new-description\"\n                value={newActivity.description || ''}\n                onChange={(e) => setNewActivity({...newActivity, description: e.target.value})}\n                placeholder=\"Descreva a atividade...\"\n              />\n            </div>\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n              <div>\n                <Label htmlFor=\"new-category\">Categoria</Label>\n                <Select value={newActivity.category} onValueChange={(value) => setNewActivity({...newActivity, category: value as PlannedActivity['category']})}>\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"sightseeing\">Turismo</SelectItem>\n                    <SelectItem value=\"food\">Comida</SelectItem>\n                    <SelectItem value=\"adventure\">Aventura</SelectItem>\n                    <SelectItem value=\"culture\">Cultura</SelectItem>\n                    <SelectItem value=\"relaxation\">Relaxamento</SelectItem>\n                    <SelectItem value=\"nightlife\">Vida Noturna</SelectItem>\n                    <SelectItem value=\"shopping\">Compras</SelectItem>\n                    <SelectItem value=\"other\">Outro</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n              <div>\n                <Label htmlFor=\"new-priority\">Prioridade</Label>\n                <Select value={newActivity.priority} onValueChange={(value) => setNewActivity({...newActivity, priority: value as 'high' | 'medium' | 'low'})}>\n                  <SelectTrigger>\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"high\">Alta</SelectItem>\n                    <SelectItem value=\"medium\">M√©dia</SelectItem>\n                    <SelectItem value=\"low\">Baixa</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n              <div>\n                <Label htmlFor=\"new-duration\">Dura√ß√£o</Label>\n                <Input\n                  id=\"new-duration\"\n                  value={newActivity.duration || ''}\n                  onChange={(e) => setNewActivity({...newActivity, duration: e.target.value})}\n                  placeholder=\"ex: 2 horas\"\n                />\n              </div>\n              <div>\n                <Label htmlFor=\"new-cost\">Custo Estimado (R$)</Label>\n                <Input\n                  id=\"new-cost\"\n                  type=\"number\"\n                  value={newActivity.estimated_cost || ''}\n                  onChange={(e) => setNewActivity({...newActivity, estimated_cost: Number(e.target.value)})}\n                />\n              </div>\n            </div>\n            <div>\n              <Label htmlFor=\"new-location\">Local</Label>\n              <Input\n                id=\"new-location\"\n                value={newActivity.location || ''}\n                onChange={(e) => setNewActivity({...newActivity, location: e.target.value})}\n                placeholder=\"Local da atividade\"\n              />\n            </div>\n            <div>\n              <Label htmlFor=\"new-notes\">Observa√ß√µes</Label>\n              <Textarea\n                id=\"new-notes\"\n                value={newActivity.notes || ''}\n                onChange={(e) => setNewActivity({...newActivity, notes: e.target.value})}\n                placeholder=\"Observa√ß√µes adicionais...\"\n              />\n            </div>\n            <div className=\"flex flex-col sm:flex-row gap-2 pt-4\">\n              <Button onClick={handleAddActivity} className=\"flex-1\" disabled={!newActivity.title}>\n                <Plus className=\"h-4 w-4 mr-2\" />\n                Adicionar Atividade\n              </Button>\n              <Button variant=\"outline\" onClick={() => setIsAddingActivity(false)} className=\"sm:w-auto\">\n                Cancelar\n              </Button>\n            </div>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n\nexport default function TripDetailPage() {\n  const { id } = useParams();\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [requestMessage, setRequestMessage] = useState(\"\");\n  const [planned_activities, setPlannedActivities] = useState<PlannedActivity[]>([]);\n  const [activeTab, setActiveTab] = useState(\"overview\");\n\n  const { data: rawTrip, isLoading, refetch } = useQuery<any>({\n    queryKey: [\"/api/trips\", id],\n    queryFn: async () => {\n      const res = await apiRequest(\"GET\", `/api/trips/${id}`);\n      if (!res.ok) throw new Error('Falha ao buscar viagem');\n      return res.json();\n    },\n    enabled: !!id,\n  });\n\n  // Initialize planned activities when trip data is loaded\n  useEffect(() => {\n    if (rawTrip?.planned_activities) {\n      try {\n        let parsedActivities = rawTrip.planned_activities;\n        \n        // Handle double-escaped JSON strings\n        if (typeof parsedActivities === 'string') {\n          try {\n            parsedActivities = JSON.parse(parsedActivities);\n          } catch (e) {\n            // First parse failed, data might be double-escaped\n          }\n        }\n        \n        // If it's still a string, try parsing again\n        if (typeof parsedActivities === 'string') {\n          try {\n            parsedActivities = JSON.parse(parsedActivities);\n          } catch (e) {\n            // Second parse failed\n          }\n        }\n        \n        setPlannedActivities(Array.isArray(parsedActivities) ? parsedActivities : []);\n      } catch (error) {\n        console.error('Error parsing planned activities:', error);\n        setPlannedActivities([]);\n      }\n    } else {\n      setPlannedActivities([]);\n    }\n  }, [rawTrip?.planned_activities]);\n\n  // Parse budget_breakdown if it's a string (similar to planned_activities)\n  const trip = useMemo(() => {\n    if (!rawTrip) return null;\n\n    let parsedBudgetBreakdown = rawTrip.budget_breakdown;\n    \n    // Handle budget_breakdown parsing - it might be stored as string JSON in database\n    if (typeof parsedBudgetBreakdown === 'string') {\n      try {\n        parsedBudgetBreakdown = JSON.parse(parsedBudgetBreakdown);\n        \n        // Ensure it's actually an object and not still a string\n        if (typeof parsedBudgetBreakdown === 'string') {\n          parsedBudgetBreakdown = JSON.parse(parsedBudgetBreakdown);\n        }\n      } catch (e) {\n        console.error('Error parsing budget_breakdown:', e);\n        parsedBudgetBreakdown = null;\n      }\n    }\n    \n    // Ensure we have a valid object\n    if (parsedBudgetBreakdown && typeof parsedBudgetBreakdown === 'object' && !Array.isArray(parsedBudgetBreakdown)) {\n      // Convert string values to numbers if needed\n      const cleanedBreakdown: any = {};\n      for (const [key, value] of Object.entries(parsedBudgetBreakdown)) {\n        cleanedBreakdown[key] = typeof value === 'string' ? parseFloat(value) || 0 : Number(value) || 0;\n      }\n      parsedBudgetBreakdown = cleanedBreakdown;\n    }\n    \n    // If budget_breakdown is explicitly null, keep it null (user disabled categories)\n    // Only create default breakdown if budget_breakdown is undefined (legacy trips)\n    if (parsedBudgetBreakdown === undefined && rawTrip.budget && rawTrip.budget > 0) {\n      parsedBudgetBreakdown = {\n        transport: Math.round(rawTrip.budget * 0.4),\n        accommodation: Math.round(rawTrip.budget * 0.4),\n        food: Math.round(rawTrip.budget * 0.2)\n      };\n    }\n\n    return {\n      ...rawTrip,\n      budget_breakdown: parsedBudgetBreakdown\n    };\n  }, [rawTrip]);\n\n  const { data: requests = [] } = useQuery<any[]>({\n    queryKey: [\"/api/trips\", id, \"requests\"],\n    queryFn: async () => {\n      const res = await apiRequest(\"GET\", `/api/trips/${id}/requests`);\n      if (!res.ok) throw new Error('Falha ao buscar solicita√ß√µes');\n      return res.json();\n    },\n    enabled: !!trip && !!user && trip.creator_id === user?.id,\n  });\n\n  // Calculate user permissions\n  const isCreator = trip && user && trip.creator_id === user.id;\n  const isParticipant = trip && user && trip.participants?.some((p: any) => p.user_id === user.id && (p.status === 'accepted' || p.status === 'approved'));\n\n  // Handle activities change and save to database\n  const handleActivitiesChange = React.useCallback(async (newActivities: PlannedActivity[]) => {\n    setPlannedActivities(newActivities);\n    \n    if (!trip || (!isCreator && !isParticipant)) return; // Allow creator and accepted participants to edit\n    \n    // Save to database asynchronously\n    setTimeout(async () => {\n      try {\n        const response = await fetch(`/api/trips/${id}`, {\n          method: 'PATCH',\n          headers: { 'Content-Type': 'application/json' },\n          credentials: 'include',\n          body: JSON.stringify({ planned_activities: newActivities })\n        });\n        \n        if (!response.ok) {\n          throw new Error('Erro ao salvar atividades');\n        }\n        \n        queryClient.invalidateQueries({ queryKey: [\"/api/trips\", id] });\n      } catch (error) {\n        console.error('Erro ao salvar atividades:', error);\n        toast({\n          title: \"Erro ao salvar atividades\",\n          description: \"N√£o foi poss√≠vel salvar as altera√ß√µes.\",\n          variant: \"destructive\",\n        });\n      }\n    }, 100);\n  }, [id, trip, isCreator, isParticipant, queryClient, toast]);\n\n  const { data: expenses = [] } = useQuery<any[]>({\n    queryKey: [\"/api/trips\", id, \"expenses\"],\n    queryFn: async () => {\n      const res = await apiRequest(\"GET\", `/api/trips/${id}/expenses`);\n      if (!res.ok) throw new Error('Falha ao buscar despesas');\n      return res.json();\n    },\n    enabled: !!trip && !!user && (isCreator || isParticipant),\n  });\n\n  const requestJoinMutation = useMutation({\n    mutationFn: async (data: { tripId: string; message: string }) => {\n      const response = await apiRequest(\"POST\", `/api/trips/${data.tripId}/request`, {\n        message: data.message,\n      });\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Solicita√ß√£o enviada!\",\n        description: \"Sua solicita√ß√£o foi enviada ao organizador da viagem.\",\n      });\n      setRequestMessage(\"\");\n    },\n    onError: (error) => {\n      toast({\n        title: \"Erro ao enviar solicita√ß√£o\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleRequestMutation = useMutation({\n    mutationFn: async (data: { requestId: number; status: string }) => {\n      const response = await apiRequest(\"PATCH\", `/api/trip-requests/${data.requestId}`, {\n        status: data.status,\n      });\n      return response.json();\n    },\n    onSuccess: (_, variables) => {\n      toast({\n        title: variables.status === 'accepted' ? \"Solicita√ß√£o aceita!\" : \"Solicita√ß√£o rejeitada\",\n        description: variables.status === 'accepted' \n          ? \"O viajante foi adicionado √† viagem.\" \n          : \"A solicita√ß√£o foi rejeitada.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/trips\", id] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/trips\", id, \"requests\"] });\n    },\n    onError: (error) => {\n      toast({\n        title: \"Erro ao processar solicita√ß√£o\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const updateCoverImageMutation = useMutation({\n    mutationFn: async (cover_image: string) => {\n      const response = await apiRequest(\"PATCH\", `/api/trips/${id}/cover-image`, {\n        cover_image\n      });\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || 'Erro ao atualizar imagem');\n      }\n      return response.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Imagem atualizada!\",\n        description: \"A imagem da viagem foi alterada com sucesso.\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/trips\", id] });\n    },\n    onError: (error) => {\n      toast({\n        title: \"Erro ao atualizar imagem\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const quitTripMutation = useMutation({\n    mutationFn: async () => {\n      const response = await apiRequest(\"DELETE\", `/api/trips/${id}/participants/${user?.id}`);\n      if (!response.ok) {\n        const error = await response.json();\n        throw new Error(error.message || 'Erro ao sair da viagem');\n      }\n      return response.json();\n    },\n    onSuccess: (data) => {\n      toast({\n        title: \"Sa√≠da confirmada!\",\n        description: data.message,\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/trips\", id] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/my-trips\"] });\n      window.location.href = \"/dashboard\";\n    },\n    onError: (error) => {\n      toast({\n        title: \"Erro ao sair da viagem\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Calculate activities cost\n  const calculateActivitiesCost = (activities: PlannedActivity[]) => {\n    return activities.reduce((total, activity) => {\n      return total + (activity.estimated_cost || 0);\n    }, 0);\n  };\n\n  const calculateTotalExpenses = () => {\n    return expenses.reduce((total, expense) => {\n      return total + expense.amount;\n    }, 0);\n  };\n\n  // Handle saving activity to database\n  const handleSaveActivity = async (activity: PlannedActivity) => {\n    try {\n      const updatedActivities = [...planned_activities, activity];\n      setPlannedActivities(updatedActivities);\n      \n      const response = await apiRequest(\"PATCH\", `/api/trips/${id}/activities`, {\n        planned_activities: JSON.stringify(updatedActivities)\n      });\n      \n      if (!response.ok) {\n        throw new Error('Erro ao salvar atividade');\n      }\n      \n      queryClient.invalidateQueries({ queryKey: [\"/api/trips\", id] });\n      toast({\n        title: \"Atividade salva!\",\n        description: \"A atividade foi adicionada com sucesso √† viagem.\",\n      });\n    } catch (error) {\n      console.error('Erro ao salvar atividade:', error);\n      toast({\n        title: \"Erro ao salvar atividade\",\n        description: \"N√£o foi poss√≠vel salvar a atividade.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8\">\n          <div className=\"flex items-center justify-center min-h-[500px]\">\n            <LoadingSpinner variant=\"travel\" size=\"lg\" message=\"Carregando detalhes da viagem...\" />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!trip) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50\">\n        <Navbar />\n        <div className=\"container mx-auto px-4 py-8\">\n          <Card className=\"text-center p-8 bg-white/80 backdrop-blur-sm\">\n            <AlertCircle className=\"h-16 w-16 mx-auto text-red-500 mb-4\" />\n            <h1 className=\"text-2xl font-bold text-gray-900 mb-4\">Viagem n√£o encontrada</h1>\n            <p className=\"text-gray-600\">A viagem que voc√™ procura n√£o existe ou foi removida.</p>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n\n  const realParticipants = getRealParticipantsCount(trip);\n  const canJoin = !isCreator && !isParticipant && realParticipants < trip.max_participants;\n\n  const travelStyleLabels: { [key: string]: string } = {\n    praia: \"Praia\",\n    neve: \"Neve\", \n    cruzeiros: \"Cruzeiros\",\n    natureza: \"Natureza e Ecoturismo\",\n    cultural: \"Culturais e Hist√≥ricas\",\n    aventura: \"Aventura\",\n    parques: \"Parques Tem√°ticos\",\n    urbanas: \"Viagens Urbanas / Cidades Grandes\"\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <Navbar />\n      \n      <div className=\"container mx-auto px-4 py-6 max-w-7xl\">\n        {/* Header Section */}\n        <motion.div\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5 }}\n          className=\"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden mb-4\"\n        >\n          {/* Cover Image */}\n          <div className=\"relative h-48\">\n            {trip.cover_image && (\n              <img \n                src={trip.cover_image}\n                alt={`Imagem da viagem: ${trip.title}`}\n                className=\"w-full h-full object-cover\"\n              />\n            )}\n            <div className=\"absolute inset-0 bg-black/30\" />\n            \n            {/* Cover Image Edit Button */}\n            {isCreator && (\n              <div className=\"absolute top-2 right-2 sm:top-4 sm:right-4 z-10\">\n                <CoverImageSelector\n                  currentImage={trip.cover_image}\n                  onImageSelect={(imageUrl) => updateCoverImageMutation.mutate(imageUrl)}\n                  trigger={\n                    <Button \n                      variant=\"secondary\" \n                      size=\"sm\"\n                      disabled={updateCoverImageMutation.isPending}\n                      className=\"text-xs sm:text-sm px-2 sm:px-3 py-1 sm:py-2\"\n                    >\n                      <Camera className=\"w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2\" />\n                      <span className=\"hidden sm:inline\">{updateCoverImageMutation.isPending ? \"Alterando...\" : \"Alterar\"}</span>\n                      <span className=\"sm:hidden\">{updateCoverImageMutation.isPending ? \"...\" : \"üì∑\"}</span>\n                    </Button>\n                  }\n                />\n              </div>\n            )}\n            \n            {/* Countdown Timer */}\n            {(trip.start_date || trip.startDate) && (\n              <div className=\"absolute top-2 left-2 sm:top-4 sm:left-4 z-10\">\n                <CountdownTimer targetDate={trip.start_date || trip.startDate} />\n              </div>\n            )}\n          </div>\n          \n          {/* Content */}\n          <div className=\"p-4\">\n            <div className=\"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4\">\n              <div className=\"space-y-3\">\n                <div>\n                  <h1 className=\"text-2xl lg:text-3xl font-bold text-gray-900 mb-2\">\n                    {trip.title || \"Viagem sem t√≠tulo\"}\n                  </h1>\n                  <div className=\"flex flex-wrap items-center gap-4 text-sm text-gray-600 mb-3\">\n                    <div className=\"flex items-center gap-2\">\n                      <MapPin className=\"h-4 w-4\" />\n                      <span>{trip.destination}</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Calendar className=\"h-4 w-4\" />\n                      <span>\n                        {format(new Date(trip.start_date || trip.startDate), \"dd/MM\", { locale: ptBR })} - {format(new Date(trip.end_date || trip.endDate), \"dd/MM/yyyy\", { locale: ptBR })}\n                      </span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Users className=\"h-4 w-4\" />\n                      <span>{getRealParticipantsCount(trip)}/{trip.max_participants} participantes</span>\n                    </div>\n                  </div>\n                  \n                  <div className=\"flex flex-wrap gap-2 mb-2\">\n                    <Badge variant={trip.status === 'open' ? 'default' : 'secondary'}>\n                      {trip.status === 'open' ? 'Aberta para participa√ß√£o' : 'Lotada'}\n                    </Badge>\n                    <Badge variant=\"outline\">\n                      {travelStyleLabels[trip.travel_style] || trip.travel_style}\n                    </Badge>\n                  </div>\n                </div>\n                \n                <TripStatistics trip={trip} planned_activities={planned_activities} />\n              </div>\n              \n              <div className=\"flex gap-2 lg:flex-col lg:w-32\">\n                <Button \n                  variant=\"outline\" \n                  size=\"sm\"\n                  onClick={() => {\n                    navigator.clipboard.writeText(window.location.href);\n                    toast({ title: \"Link copiado!\", description: \"O link da viagem foi copiado para a √°rea de transfer√™ncia.\" });\n                  }}\n                  className=\"flex-1 lg:flex-none\"\n                >\n                  <Share2 className=\"h-4 w-4 mr-2\" />\n                  Compartilhar\n                </Button>\n                {(isParticipant || isCreator) && (\n                  <Button asChild size=\"sm\" className=\"flex-1 lg:flex-none\">\n                    <a href={`/chat/${trip.id}`}>\n                      <MessageCircle className=\"h-4 w-4 mr-2\" />\n                      Chat\n                    </a>\n                  </Button>\n                )}\n              </div>\n            </div>\n          </div>\n        </motion.div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-3 lg:gap-4\">\n          {/* Main Content */}\n          <motion.div\n            initial={{ opacity: 0, x: -20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ duration: 0.6, delay: 0.2 }}\n            className=\"lg:col-span-3 order-2 lg:order-1\"\n          >\n            <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-6\">\n              {/* Enhanced Tab Navigation */}\n              <div className=\"bg-white border border-gray-200 rounded-xl p-2 shadow-sm\">\n                <TabsList className=\"grid w-full grid-cols-2 lg:grid-cols-5 bg-transparent gap-1 h-auto\">\n                  <TabsTrigger \n                    value=\"overview\" \n                    className=\"flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 px-3 py-3 sm:py-2 rounded-lg font-medium transition-all duration-300 data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:shadow-sm data-[state=active]:border data-[state=active]:border-blue-200 text-gray-600 hover:bg-gray-50 group relative\"\n                  >\n                    <div className=\"flex items-center gap-1 sm:gap-2\">\n                      <Star className=\"h-4 w-4 group-data-[state=active]:text-blue-600\" />\n                      <span className=\"text-xs sm:text-sm font-medium\">\n                        <span className=\"hidden sm:inline\">Vis√£o Geral</span>\n                        <span className=\"sm:hidden\">Vis√£o</span>\n                      </span>\n                    </div>\n                    {/* Progress indicator for active tab */}\n                    <div className=\"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-6 h-0.5 bg-blue-600 rounded-full opacity-0 group-data-[state=active]:opacity-100 transition-opacity duration-300\"></div>\n                  </TabsTrigger>\n                  \n                  <TabsTrigger \n                    value=\"budget\" \n                    className=\"flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 px-3 py-3 sm:py-2 rounded-lg font-medium transition-all duration-300 data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:shadow-sm data-[state=active]:border data-[state=active]:border-blue-200 text-gray-600 hover:bg-gray-50 group relative\"\n                  >\n                    <div className=\"flex items-center gap-1 sm:gap-2\">\n                      <Calculator className=\"h-4 w-4 group-data-[state=active]:text-blue-600\" />\n                      <span className=\"text-xs sm:text-sm font-medium\">Or√ßamento</span>\n                    </div>\n                    <div className=\"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-6 h-0.5 bg-blue-600 rounded-full opacity-0 group-data-[state=active]:opacity-100 transition-opacity duration-300\"></div>\n                  </TabsTrigger>\n                  \n                  <TabsTrigger \n                    value=\"activities\" \n                    className=\"flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 px-3 py-3 sm:py-2 rounded-lg font-medium transition-all duration-300 data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:shadow-sm data-[state=active]:border data-[state=active]:border-blue-200 text-gray-600 hover:bg-gray-50 group relative\"\n                  >\n                    <div className=\"flex items-center gap-1 sm:gap-2\">\n                      <Target className=\"h-4 w-4 group-data-[state=active]:text-blue-600\" />\n                      <span className=\"text-xs sm:text-sm font-medium\">Atividades</span>\n                    </div>\n                    {planned_activities.length > 0 && (\n                      <div className=\"absolute -top-1 -right-1 w-5 h-5 bg-blue-600 text-white text-xs rounded-full flex items-center justify-center font-bold\">\n                        {planned_activities.length}\n                      </div>\n                    )}\n                    <div className=\"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-6 h-0.5 bg-blue-600 rounded-full opacity-0 group-data-[state=active]:opacity-100 transition-opacity duration-300\"></div>\n                  </TabsTrigger>\n                  \n                  <TabsTrigger \n                    value=\"expenses\" \n                    className=\"flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 px-3 py-3 sm:py-2 rounded-lg font-medium transition-all duration-300 data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:shadow-sm data-[state=active]:border data-[state=active]:border-blue-200 text-gray-600 hover:bg-gray-50 group relative\"\n                  >\n                    <div className=\"flex items-center gap-1 sm:gap-2\">\n                      <DollarSign className=\"h-4 w-4 group-data-[state=active]:text-blue-600\" />\n                      <span className=\"text-xs sm:text-sm font-medium\">Despesas</span>\n                    </div>\n                    <div className=\"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-6 h-0.5 bg-blue-600 rounded-full opacity-0 group-data-[state=active]:opacity-100 transition-opacity duration-300\"></div>\n                  </TabsTrigger>\n                  \n                  <TabsTrigger \n                    value=\"participants\" \n                    className=\"flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 px-3 py-3 sm:py-2 rounded-lg font-medium transition-all duration-300 data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700 data-[state=active]:shadow-sm data-[state=active]:border data-[state=active]:border-blue-200 text-gray-600 hover:bg-gray-50 group relative\"\n                  >\n                    <div className=\"flex items-center gap-1 sm:gap-2\">\n                      <Users className=\"h-4 w-4 group-data-[state=active]:text-blue-600\" />\n                      <span className=\"text-xs sm:text-sm font-medium\">\n                        <span className=\"hidden sm:inline\">Participantes</span>\n                        <span className=\"sm:hidden\">Pessoas</span>\n                      </span>\n                    </div>\n                    {trip.participants && trip.participants.length > 0 && (\n                      <div className=\"absolute -top-1 -right-1 w-5 h-5 bg-purple-600 text-white text-xs rounded-full flex items-center justify-center font-bold\">\n                        {getRealParticipantsCount(trip)}\n                      </div>\n                    )}\n                    <div className=\"absolute bottom-0 left-1/2 transform -translate-x-1/2 w-6 h-0.5 bg-blue-600 rounded-full opacity-0 group-data-[state=active]:opacity-100 transition-opacity duration-300\"></div>\n                  </TabsTrigger>\n                </TabsList>\n\n                {/* Tab Content Indicators */}\n                <div className=\"mt-4 flex justify-center\">\n                  <div className=\"flex items-center gap-1\">\n                    {[\"overview\", \"budget\", \"activities\", \"expenses\", \"participants\"].map((tab, index) => (\n                      <button\n                        key={tab}\n                        onClick={() => setActiveTab(tab)}\n                        className={`w-2 h-2 rounded-full transition-all duration-300 ${\n                          activeTab === tab ? 'bg-blue-600 w-6' : 'bg-gray-300 hover:bg-gray-400'\n                        }`}\n                      />\n                    ))}\n                  </div>\n                </div>\n              </div>\n\n              <TabsContent value=\"overview\" className=\"space-y-6\">\n\n\n                {/* Description */}\n                <Card className=\"bg-white shadow-sm border border-gray-200 hover:shadow-md transition-shadow duration-300\">\n                  <CardHeader>\n                    <CardTitle className=\"flex items-center gap-3 text-lg font-semibold text-gray-900\">\n                      <div className=\"p-2 bg-blue-500 rounded-lg\">\n                        <Info className=\"h-5 w-5 text-white\" />\n                      </div>\n                      Sobre a Viagem\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <p className=\"text-gray-700 leading-relaxed text-base\">\n                      {trip.description || \"Descri√ß√£o n√£o dispon√≠vel\"}\n                    </p>\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"budget\" className=\"space-y-6\">\n                {/* Tab Header */}\n                <div className=\"bg-gradient-to-r from-amber-50 to-orange-50 rounded-xl p-4 border border-amber-200\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-amber-500 rounded-lg\">\n                      <Calculator className=\"h-5 w-5 text-white\" />\n                    </div>\n                    <div>\n                      <h2 className=\"text-xl font-bold text-gray-900\">Detalhamento do Or√ßamento</h2>\n                      <p className=\"text-sm text-gray-600\">\n                        Distribui√ß√£o dos custos por categoria\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Detailed Budget Breakdown */}\n                <Card className=\"bg-white shadow-sm border border-gray-200 hover:shadow-md transition-shadow duration-300\">\n                  <CardHeader className=\"border-b border-gray-100 bg-gray-50/50\">\n                    <CardTitle className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"p-2 bg-blue-500 rounded-lg\">\n                          <PieChart className=\"h-5 w-5 text-white\" />\n                        </div>\n                        <div>\n                          <h3 className=\"text-xl font-semibold text-gray-900\">Or√ßamento da Viagem</h3>\n                          <p className=\"text-sm text-gray-600 mt-1\">An√°lise detalhada dos custos</p>\n                        </div>\n                        {!(isCreator || isParticipant) && (\n                          <Badge variant=\"outline\" className=\"text-xs bg-gray-100\">\n                            <Eye className=\"h-3 w-3 mr-1\" />\n                            Somente Visualiza√ß√£o\n                          </Badge>\n                        )}\n                      </div>\n                      {isCreator && (\n                        <BudgetEditor\n                          tripId={parseInt(id!)}\n                          currentBudget={trip.budget}\n                          currentBudgetBreakdown={trip.budget_breakdown}\n                          max_participants={trip.max_participants}\n                          onBudgetUpdate={(newBudget, newBreakdown) => {\n                            // Force refresh the trip data\n                              refetch();\n                            }}\n                          />\n                        )}\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent className=\"p-6\">\n                      {trip.budget_breakdown ? (\n                        <div className=\"space-y-4\">\n                          {/* Compact Category Grid */}\n                          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\n                            {Object.entries(trip.budget_breakdown).map(([category, amount]) => {\n                              // Ensure amount is a number (it might be a string from JSON parsing)\n                              const numericAmount = typeof amount === 'string' ? parseFloat(amount) || 0 : Number(amount) || 0;\n                              const participantsCount = getParticipantsForBudgetCalculation(trip);\n                              const perPerson = participantsCount > 0 ? numericAmount / participantsCount : 0;\n                              \n                              return (\n                                <div key={category} className=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200 hover:border-blue-300 transition-colors\">\n                                  <div className=\"flex items-center gap-2\">\n                                    <div className=\"p-1.5 bg-white rounded-md shadow-sm\">\n                                      {category === 'transport' && <Plane className=\"h-3.5 w-3.5 text-blue-600\" />}\n                                      {category === 'accommodation' && <Home className=\"h-3.5 w-3.5 text-green-600\" />}\n                                      {category === 'food' && <Utensils className=\"h-3.5 w-3.5 text-orange-600\" />}\n                                      {category === 'insurance' && <Shield className=\"h-3.5 w-3.5 text-purple-600\" />}\n                                      {category === 'medical' && <Shield className=\"h-3.5 w-3.5 text-red-600\" />}\n                                      {!['transport', 'accommodation', 'food', 'insurance', 'medical'].includes(category) && \n                                        <MoreHorizontal className=\"h-3.5 w-3.5 text-gray-600\" />}\n                                    </div>\n                                    <div className=\"min-w-0 flex-1\">\n                                      <p className=\"text-sm font-medium text-gray-900 truncate\">\n                                        {budgetCategories[category as keyof typeof budgetCategories] || category}\n                                      </p>\n                                      <p className=\"text-xs text-gray-500\">\n                                        {formatBrazilianCurrency(perPerson)}/pessoa\n                                      </p>\n                                    </div>\n                                  </div>\n                                  <div className=\"text-right flex-shrink-0\">\n                                    <p className=\"text-sm font-bold text-gray-900 tabular-nums\">\n                                      {formatBrazilianCurrency(numericAmount)}\n                                    </p>\n                                  </div>\n                                </div>\n                              );\n                            })}\n                          </div>\n                          \n                          {/* Compact Total Summary */}\n                          <div className=\"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-lg p-4 text-white\">\n                            <div className=\"flex items-center justify-between\">\n                              <div className=\"flex items-center gap-2\">\n                                <Calculator className=\"h-5 w-5 text-white\" />\n                                <div>\n                                  <h4 className=\"text-base font-semibold\">Total da Viagem</h4>\n                                  <p className=\"text-blue-100 text-xs\">\n                                    {getParticipantsForBudgetCalculation(trip)} participantes\n                                  </p>\n                                </div>\n                              </div>\n                              <div className=\"text-right\">\n                                <p className=\"text-2xl font-bold tabular-nums\">\n                                  {formatBrazilianCurrency(trip.budget)}\n                                </p>\n                                <p className=\"text-blue-100 text-xs\">\n                                  {getParticipantsForBudgetCalculation(trip) > 0 ? formatBrazilianCurrency(trip.budget / getParticipantsForBudgetCalculation(trip)) : 'R$ 0,00'} cada\n                                </p>\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                      ) : (\n                        /* Simple Budget Display - No Categories Shown */\n                        <div className=\"text-center py-8\">\n                          <div className=\"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full mb-4\">\n                            <DollarSign className=\"h-8 w-8 text-white\" />\n                          </div>\n                          <div className=\"space-y-3\">\n                            <div>\n                              <h3 className=\"text-2xl font-bold text-gray-900 mb-1\">\n                                {formatBrazilianCurrency(trip.budget)}\n                              </h3>\n                              <p className=\"text-lg text-gray-600\">\n                                {getParticipantsForBudgetCalculation(trip) > 0 ? formatBrazilianCurrency(trip.budget / getParticipantsForBudgetCalculation(trip)) : 'R$ 0,00'} por pessoa\n                              </p>\n                            </div>\n                            <div className=\"max-w-sm mx-auto\">\n                              <div className=\"bg-gray-50 rounded-lg p-3 border border-gray-200\">\n                                <p className=\"text-sm text-gray-600 mb-1\">Participantes confirmados</p>\n                                <div className=\"flex items-center justify-center gap-2\">\n                                  <Users className=\"h-4 w-4 text-gray-500\" />\n                                  <span className=\"font-medium text-gray-900\">{getRealParticipantsCount(trip)} de {trip.max_participants}</span>\n                                </div>\n                              </div>\n                            </div>\n                            {isCreator && (\n                              <p className=\"text-xs text-gray-500 mt-4\">\n                                <Info className=\"h-4 w-4 inline mr-1\" />\n                                Use o bot√£o \"Editar Or√ßamento\" para adicionar detalhamento por categoria\n                              </p>\n                            )}\n                          </div>\n                        </div>\n                      )}\n                      \n                      {/* Call to Action for Non-Participants */}\n                      {!(isCreator || isParticipant) && canJoin && (\n                        <div className=\"mt-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-6 border border-blue-200\">\n                          <div className=\"text-center\">\n                            <div className=\"inline-flex items-center justify-center w-12 h-12 bg-blue-500 rounded-full mb-4\">\n                              <UserPlus className=\"h-6 w-6 text-white\" />\n                            </div>\n                            <h4 className=\"text-lg font-semibold text-gray-900 mb-2\">\n                              Participe do Planejamento\n                            </h4>\n                            <p className=\"text-blue-700 mb-4 max-w-md mx-auto\">\n                              Junte-se √† viagem para colaborar no planejamento do or√ßamento e dividir os custos!\n                            </p>\n                            <Button \n                              className=\"bg-blue-600 hover:bg-blue-700 text-white shadow-lg hover:shadow-xl transition-all duration-300\" \n                              onClick={() => setActiveTab(\"overview\")}\n                            >\n                              <UserPlus className=\"h-4 w-4 mr-2\" />\n                              Solicitar Participa√ß√£o\n                            </Button>\n                          </div>\n                        </div>\n                      )}\n                    </CardContent>\n                  </Card>\n              </TabsContent>\n\n              <TabsContent value=\"activities\" className=\"space-y-6\">\n                {/* Tab Header with Navigation */}\n                <div className=\"flex items-center justify-between bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-4 border border-blue-200\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-blue-500 rounded-lg\">\n                      <Target className=\"h-5 w-5 text-white\" />\n                    </div>\n                    <div>\n                      <h2 className=\"text-xl font-bold text-gray-900\">Atividades da Viagem</h2>\n                      <p className=\"text-sm text-gray-600\">\n                        {planned_activities.length} {planned_activities.length === 1 ? 'atividade planejada' : 'atividades planejadas'}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                {(isCreator || isParticipant) ? (\n                  <AdvancedActivityManager \n                    activities={planned_activities}\n                    onActivitiesChange={handleActivitiesChange}\n                    tripDestination={trip.destination}\n                    trip={trip}\n                  />\n                ) : (\n                  <Card className=\"bg-white shadow-sm border border-gray-200\">\n                    <CardHeader>\n                      <CardTitle className=\"text-lg font-semibold text-gray-900\">\n                        Atividades Planejadas\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <ActivitiesTimeline \n                        activities={planned_activities}\n                        tripStartDate={trip.start_date || trip.startDate}\n                        tripEndDate={trip.end_date || trip.endDate}\n                        canJoin={canJoin}\n                        onJoinClick={() => setActiveTab(\"overview\")}\n                        onActivitiesChange={setPlannedActivities}\n                        isEditable={false}\n                        trip={trip}\n                      />\n                    </CardContent>\n                  </Card>\n                )}\n              </TabsContent>\n\n              <TabsContent value=\"expenses\" className=\"space-y-6\">\n                {/* Tab Header */}\n                <div className=\"bg-gradient-to-r from-green-50 to-emerald-50 rounded-xl p-4 border border-green-200\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-green-500 rounded-lg\">\n                      <DollarSign className=\"h-5 w-5 text-white\" />\n                    </div>\n                    <div>\n                      <h2 className=\"text-xl font-bold text-gray-900\">Gest√£o Financeira</h2>\n                      <p className=\"text-sm text-gray-600\">\n                        Total: {formatBrazilianCurrency((trip.budget || 0) + calculateActivitiesCost(planned_activities))}\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                <Card className=\"bg-white shadow-sm border border-gray-200\">\n                  <CardHeader>\n                    <CardTitle className=\"text-lg font-semibold text-gray-900\">\n                      Gest√£o de Despesas\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    {(isCreator || isParticipant) ? (\n                      <ExpenseManager \n                        tripId={parseInt(id!)}\n                        participants={trip.participants || []}\n                      />\n                    ) : (\n                      <div className=\"text-center py-8\">\n                        <p className=\"text-gray-600 mb-4\">\n                          Entre na viagem e descubra como √© f√°cil dividir automaticamente as despesas com os participantes!\n                        </p>\n                        {canJoin && (\n                          <Button onClick={() => setActiveTab(\"overview\")}>\n                            Solicitar Participa√ß√£o\n                          </Button>\n                        )}\n                      </div>\n                    )}\n                  </CardContent>\n                </Card>\n              </TabsContent>\n\n              <TabsContent value=\"participants\" className=\"space-y-6\">\n                {/* Tab Header */}\n                <div className=\"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4 border border-purple-200\">\n                  <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2 bg-purple-500 rounded-lg\">\n                      <Users className=\"h-5 w-5 text-white\" />\n                    </div>\n                    <div>\n                      <h2 className=\"text-xl font-bold text-gray-900\">Companheiros de Viagem</h2>\n                      <p className=\"text-sm text-gray-600\">\n                        {getRealParticipantsCount(trip)} de {trip.max_participants} vagas ocupadas\n                      </p>\n                    </div>\n                  </div>\n                </div>\n\n                <Card className=\"bg-white shadow-sm border border-gray-200\">\n                  <CardHeader>\n                    <CardTitle className=\"text-lg font-semibold text-gray-900\">\n                      Participantes ({trip.participants?.length || 0})\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent>\n                    <div className=\"space-y-3\">\n                      {trip.participants?.map((participant: any) => (\n                        <div key={participant.id} className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 p-4 bg-gray-50 rounded-lg\">\n                          <div className=\"flex items-center gap-3\">\n                            <Avatar className=\"h-8 w-8 sm:h-10 sm:w-10\">\n                              <AvatarImage src={participant.user.profile_photo} />\n                              <AvatarFallback className=\"text-xs sm:text-sm\">\n                                {participant.user.full_name?.[0] || participant.user.username[0]}\n                              </AvatarFallback>\n                            </Avatar>\n                            <div className=\"flex-1 min-w-0\">\n                              <p className=\"font-medium text-sm sm:text-base truncate\">{participant.user.full_name || participant.user.username}</p>\n                              <p className=\"text-xs sm:text-sm text-gray-600 truncate\">{participant.user.location}</p>\n                            </div>\n                          </div>\n                          <div className=\"flex items-center gap-2 flex-wrap\">\n                            {participant.user_id === trip.creator_id && (\n                              <Badge className=\"bg-yellow-100 text-yellow-800 text-xs\">Organizador</Badge>\n                            )}\n                            <Badge variant=\"outline\" className=\"text-green-800 border-green-200 text-xs\">\n                              {(participant.status === 'accepted' || participant.status === 'approved') ? 'Aceito' : \n                               participant.status === 'pending' ? 'Pendente' : \n                               participant.status === 'rejected' ? 'Rejeitado' : \n                               participant.status}\n                            </Badge>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </CardContent>\n                </Card>\n\n                {/* Join Requests for Creator */}\n                {isCreator && requests.length > 0 && (\n                  <Card className=\"bg-white/80 backdrop-blur-sm shadow-lg\">\n                    <CardHeader>\n                      <CardTitle className=\"flex items-center gap-2\">\n                        <Gift className=\"h-5 w-5 text-orange-500\" />\n                        Solicita√ß√µes de Participa√ß√£o ({requests.length})\n                      </CardTitle>\n                    </CardHeader>\n                    <CardContent>\n                      <div className=\"space-y-4\">\n                        {requests.map((request: any) => (\n                          <div key={request.id} className=\"p-4 bg-orange-50 rounded-lg border border-orange-200\">\n                            <div className=\"flex items-start justify-between\">\n                              <div className=\"flex items-center gap-3\">\n                                <Avatar>\n                                  <AvatarFallback>{request.user.full_name?.[0] || request.user.username[0]}</AvatarFallback>\n                                </Avatar>\n                                <div>\n                                  <p className=\"font-medium\">{request.user.full_name || request.user.username}</p>\n                                  <p className=\"text-sm text-gray-600\">{request.message}</p>\n                                </div>\n                              </div>\n                              <div className=\"flex gap-2\">\n                                <Button \n                                  size=\"sm\" \n                                  onClick={() => handleRequestMutation.mutate({ requestId: request.id, status: 'accepted' })}\n                                  disabled={handleRequestMutation.isPending}\n                                >\n                                  <Check className=\"h-4 w-4 mr-1\" />\n                                  Aceitar\n                                </Button>\n                                <Button \n                                  size=\"sm\" \n                                  variant=\"outline\"\n                                  onClick={() => handleRequestMutation.mutate({ requestId: request.id, status: 'rejected' })}\n                                  disabled={handleRequestMutation.isPending}\n                                >\n                                  <X className=\"h-4 w-4 mr-1\" />\n                                  Rejeitar\n                                </Button>\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    </CardContent>\n                  </Card>\n                )}\n              </TabsContent>\n            </Tabs>\n          </motion.div>\n\n          {/* Sidebar */}\n          <motion.div\n            initial={{ opacity: 0, x: 20 }}\n            animate={{ opacity: 1, x: 0 }}\n            transition={{ duration: 0.6, delay: 0.4 }}\n            className=\"space-y-3 lg:space-y-4 order-1 lg:order-2\"\n          >\n\n            {/* Action Buttons */}\n            <Card className=\"bg-white shadow-sm border border-gray-200 lg:sticky lg:top-4\">\n              <CardContent className=\"p-3 space-y-2\">\n                {canJoin && (\n                  <Dialog>\n                    <DialogTrigger asChild>\n                      <Button className=\"w-full\">\n                        <Heart className=\"h-4 w-4 mr-2\" />\n                        Solicitar Participa√ß√£o\n                      </Button>\n                    </DialogTrigger>\n                    <DialogContent>\n                      <DialogHeader>\n                        <DialogTitle>Solicitar Participa√ß√£o</DialogTitle>\n                      </DialogHeader>\n                      <div className=\"space-y-4\">\n                        <Textarea\n                          placeholder=\"Conte um pouco sobre voc√™ e por que gostaria de participar desta viagem...\"\n                          value={requestMessage}\n                          onChange={(e) => setRequestMessage(e.target.value)}\n                          className=\"min-h-[100px]\"\n                        />\n                        <Button \n                          onClick={() => requestJoinMutation.mutate({ tripId: id!, message: requestMessage })}\n                          disabled={requestJoinMutation.isPending || !requestMessage.trim()}\n                          className=\"w-full\"\n                        >\n                          {requestJoinMutation.isPending ? \"Enviando...\" : \"Enviar Solicita√ß√£o\"}\n                        </Button>\n                      </div>\n                    </DialogContent>\n                  </Dialog>\n                )}\n\n                {isParticipant && !isCreator && (\n                  <Dialog>\n                    <DialogTrigger asChild>\n                      <Button variant=\"destructive\" className=\"w-full\">\n                        <X className=\"h-4 w-4 mr-2\" />\n                        Desistir da Viagem\n                      </Button>\n                    </DialogTrigger>\n                    <DialogContent>\n                      <DialogHeader>\n                        <DialogTitle>Confirmar Sa√≠da</DialogTitle>\n                      </DialogHeader>\n                      <div className=\"space-y-4\">\n                        <p>Tem certeza que deseja sair desta viagem? Esta a√ß√£o n√£o pode ser desfeita.</p>\n                        <div className=\"flex gap-2\">\n                          <Button \n                            onClick={() => quitTripMutation.mutate()}\n                            disabled={quitTripMutation.isPending}\n                            variant=\"destructive\"\n                            className=\"flex-1\"\n                          >\n                            {quitTripMutation.isPending ? \"Saindo...\" : \"Confirmar Sa√≠da\"}\n                          </Button>\n                          <DialogTrigger asChild>\n                            <Button variant=\"outline\" className=\"flex-1\">\n                              Cancelar\n                            </Button>\n                          </DialogTrigger>\n                        </div>\n                      </div>\n                    </DialogContent>\n                  </Dialog>\n                )}\n              </CardContent>\n            </Card>\n\n            {/* Compact Budget Overview */}\n            <Card className=\"bg-white border-0 shadow-sm ring-1 ring-gray-200\">\n              <CardHeader className=\"border-b border-gray-100 bg-gray-50/50 pb-2\">\n                <CardTitle className=\"text-base font-semibold text-gray-900 tracking-tight\">\n                  Resumo Financeiro\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-3\">\n                <div className=\"space-y-3\">\n                  {/* Compact Budget Items */}\n                  <div className=\"space-y-1.5\">\n                    <div className=\"flex items-center justify-between py-1.5\">\n                      <div className=\"flex items-center gap-2\">\n                        <div className=\"w-1.5 h-1.5 bg-slate-400 rounded-full\"></div>\n                        <span className=\"text-xs font-medium text-gray-700\">Or√ßamento Base</span>\n                      </div>\n                      <span className=\"text-xs font-semibold text-gray-900 tabular-nums\">\n                        {formatBrazilianCurrency(trip.budget || 0)}\n                      </span>\n                    </div>\n                    \n                    <div className=\"flex items-center justify-between py-1.5\">\n                      <div className=\"flex items-center gap-2\">\n                        <div className=\"w-1.5 h-1.5 bg-indigo-400 rounded-full\"></div>\n                        <span className=\"text-xs font-medium text-gray-700\">Atividades</span>\n                      </div>\n                      <span className=\"text-xs font-semibold text-gray-900 tabular-nums\">\n                        {formatBrazilianCurrency(calculateActivitiesCost(planned_activities))}\n                      </span>\n                    </div>\n                    \n                    <div className=\"flex items-center justify-between py-2 bg-gray-50 -mx-3 px-3 mt-2 rounded\">\n                      <div className=\"flex items-center gap-2\">\n                        <div className=\"w-1.5 h-1.5 bg-gray-800 rounded-full\"></div>\n                        <span className=\"text-xs font-semibold text-gray-900\">Total</span>\n                      </div>\n                      <span className=\"text-sm font-bold text-gray-900 tabular-nums\">\n                        {formatBrazilianCurrency((trip.budget || 0) + calculateActivitiesCost(planned_activities))}\n                      </span>\n                    </div>\n                  </div>\n\n                  {/* Compact Cost per Person */}\n                  <div className=\"bg-blue-50 rounded-lg p-2.5 border border-blue-100\">\n                    <div className=\"text-center space-y-0.5\">\n                      <div className=\"flex items-center justify-center gap-1.5\">\n                        <Users className=\"h-3 w-3 text-blue-600\" />\n                        <span className=\"text-xs font-medium text-blue-900\">Custo Individual com Atividades</span>\n                      </div>\n                      <div className=\"text-base font-bold text-blue-900 tabular-nums\">\n                        {getParticipantsForBudgetCalculation(trip) > 0 ? formatBrazilianCurrency(((trip.budget || 0) + calculateActivitiesCost(planned_activities)) / getParticipantsForBudgetCalculation(trip)) : 'R$ 0,00'}\n                      </div>\n                      <div className=\"text-xs text-blue-700\">\n                        {hasTripStarted(trip) ? `${getRealParticipantsCount(trip)} participantes confirmados` : `${trip.max_participants} participantes planejados`}\n                      </div>\n                    </div>\n                  </div>\n\n                  {/* Compact Budget Progress */}\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-center justify-between\">\n                      <span className=\"text-xs font-medium text-gray-700\">Progresso</span>\n                      <span className=\"text-xs font-semibold text-gray-900 tabular-nums\">\n                        {(() => {\n                          const totalExpenses = calculateTotalExpenses();\n                          const totalBudget = (trip.budget || 0) + calculateActivitiesCost(planned_activities);\n                          const percentage = totalBudget > 0 ? Math.round((totalExpenses / totalBudget) * 100) : 0;\n                          console.log('Progress Debug:', { totalExpenses, totalBudget, percentage });\n                          return `${percentage}%`;\n                        })()}\n                      </span>\n                    </div>\n                    <div className=\"space-y-1\">\n                      <div className=\"w-full bg-gray-200 rounded-full h-1.5\">\n                        <div \n                          className=\"bg-blue-600 h-1.5 rounded-full transition-all duration-300 ease-in-out\"\n                          style={{\n                            width: `${(() => {\n                              const totalExpenses = calculateTotalExpenses();\n                              const totalBudget = (trip.budget || 0) + calculateActivitiesCost(planned_activities);\n                              const percentage = totalBudget > 0 ? (totalExpenses / totalBudget) * 100 : 0;\n                              const clampedPercentage = Math.min(100, Math.max(0, percentage));\n                              console.log('Progress Bar Width:', clampedPercentage + '%');\n                              return clampedPercentage;\n                            })()}%`\n                          }}\n                        />\n                      </div>\n                      <div className=\"flex justify-between text-xs text-gray-500\">\n                        <span>{formatBrazilianCurrency(calculateTotalExpenses())}</span>\n                        <span>{formatBrazilianCurrency((trip.budget || 0) + calculateActivitiesCost(planned_activities))}</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </motion.div>\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":101375},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-[95vw] sm:w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-4 sm:p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg max-h-[95vh] overflow-y-auto\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4468},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/animated-preloader.tsx":{"content":"import React from 'react';\nimport Lottie from 'lottie-react';\nimport animationData from '@assets/Animation - 1716380534233_1752386084771.json';\n\ninterface AnimatedPreloaderProps {\n  message?: string;\n  className?: string;\n}\n\nexport function AnimatedPreloader({ \n  message = \"Preparando sua viagem...\", \n  className = \"\" \n}: AnimatedPreloaderProps) {\n  return (\n    <div className={`flex flex-col items-center justify-center p-8 ${className}`}>\n      <div className=\"w-48 h-48 mb-4\">\n        <Lottie \n          animationData={animationData}\n          loop={true}\n          autoplay={true}\n          style={{ width: '100%', height: '100%' }}\n        />\n      </div>\n      {message && (\n        <p className=\"text-lg font-medium text-slate-600 dark:text-slate-400 text-center animate-pulse\">\n          {message}\n        </p>\n      )}\n    </div>\n  );\n}\n\nexport default AnimatedPreloader;","size_bytes":883},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1419},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }","size_bytes":1127},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":1901},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","size_bytes":1858},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\nimport { formatBrazilianCurrency } from \"@shared/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {typeof item.value === 'number' ? formatBrazilianCurrency(item.value) : item.value}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10591},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-[95vw] sm:w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-4 sm:p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg max-h-[95vh] overflow-y-auto\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3896},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/components/ui/enhanced-skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\";\nimport { Skeleton } from \"./skeleton\";\n\ninterface EnhancedSkeletonProps {\n  className?: string;\n  variant?: 'default' | 'card' | 'avatar' | 'text' | 'image';\n  size?: 'sm' | 'md' | 'lg';\n  animated?: boolean;\n}\n\nexport function EnhancedSkeleton({ \n  className,\n  variant = 'default',\n  size = 'md',\n  animated = true\n}: EnhancedSkeletonProps) {\n  const baseClasses = cn(\n    \"rounded-md bg-muted\",\n    {\n      \"animate-pulse\": animated,\n      \"h-4\": size === 'sm' && variant === 'text',\n      \"h-6\": size === 'md' && variant === 'text',\n      \"h-8\": size === 'lg' && variant === 'text',\n      \"w-8 h-8 rounded-full\": size === 'sm' && variant === 'avatar',\n      \"w-12 h-12 rounded-full\": size === 'md' && variant === 'avatar',\n      \"w-16 h-16 rounded-full\": size === 'lg' && variant === 'avatar',\n      \"h-32\": variant === 'image',\n      \"h-48\": variant === 'card',\n    },\n    className\n  );\n\n  if (variant === 'card') {\n    return (\n      <div className={cn(\"p-4 space-y-3\", className)}>\n        <Skeleton className=\"h-4 w-full\" />\n        <Skeleton className=\"h-4 w-3/4\" />\n        <Skeleton className=\"h-4 w-1/2\" />\n      </div>\n    );\n  }\n\n  return <div className={baseClasses} />;\n}\n\nexport function TripCardSkeleton() {\n  return (\n    <div className=\"bg-white rounded-lg shadow-md overflow-hidden animate-pulse\">\n      <div className=\"h-48 bg-gray-200\" />\n      <div className=\"p-4 space-y-3\">\n        <div className=\"h-4 bg-gray-200 rounded w-3/4\" />\n        <div className=\"h-4 bg-gray-200 rounded w-1/2\" />\n        <div className=\"flex justify-between items-center\">\n          <div className=\"h-8 bg-gray-200 rounded-full w-8\" />\n          <div className=\"h-4 bg-gray-200 rounded w-1/4\" />\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":1779},"client/src/components/ui/error-boundary.tsx":{"content":"import React from 'react';\nimport { AlertTriangle } from 'lucide-react';\nimport { Button } from './button';\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n  error?: Error;\n}\n\ninterface ErrorBoundaryProps {\n  children: React.ReactNode;\n  fallback?: React.ComponentType<{ error?: Error; resetError: () => void }>;\n}\n\nexport class ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  constructor(props: ErrorBoundaryProps) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    console.error('ErrorBoundary caught an error:', error, errorInfo);\n  }\n\n  resetError = () => {\n    this.setState({ hasError: false, error: undefined });\n  };\n\n  render() {\n    if (this.state.hasError) {\n      if (this.props.fallback) {\n        const FallbackComponent = this.props.fallback;\n        return <FallbackComponent error={this.state.error} resetError={this.resetError} />;\n      }\n\n      return (\n        <div className=\"flex flex-col items-center justify-center min-h-[200px] p-6 text-center\">\n          <AlertTriangle className=\"w-12 h-12 text-red-500 mb-4\" />\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-2\">\n            Algo deu errado\n          </h2>\n          <p className=\"text-gray-600 mb-4 max-w-md\">\n            Ocorreu um erro inesperado. Tente recarregar a p√°gina ou entre em contato com o suporte.\n          </p>\n          <Button onClick={this.resetError} variant=\"outline\">\n            Tentar novamente\n          </Button>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}","size_bytes":1735},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/index.tsx":{"content":"// UI Components Barrel Export\nexport { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from './accordion';\nexport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from './alert-dialog';\nexport { Alert, AlertDescription, AlertTitle } from './alert';\nexport { AspectRatio } from './aspect-ratio';\nexport { Avatar, AvatarFallback, AvatarImage } from './avatar';\nexport { Badge, badgeVariants } from './badge';\nexport { Breadcrumb, BreadcrumbEllipsis, BreadcrumbItem, BreadcrumbLink, BreadcrumbList, BreadcrumbPage, BreadcrumbSeparator } from './breadcrumb';\nexport { Button, buttonVariants } from './button';\nexport { Calendar } from './calendar';\nexport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from './card';\nexport { Carousel, CarouselContent, CarouselItem, CarouselNext, CarouselPrevious } from './carousel';\nexport { ChartContainer, ChartTooltip, ChartTooltipContent } from './chart';\nexport { Checkbox } from './checkbox';\nexport { Collapsible, CollapsibleContent, CollapsibleTrigger } from './collapsible';\nexport { Command, CommandDialog, CommandEmpty, CommandGroup, CommandInput, CommandItem, CommandList, CommandSeparator, CommandShortcut } from './command';\nexport { ContextMenu, ContextMenuCheckboxItem, ContextMenuContent, ContextMenuItem, ContextMenuLabel, ContextMenuRadioGroup, ContextMenuRadioItem, ContextMenuSeparator, ContextMenuShortcut, ContextMenuSub, ContextMenuSubContent, ContextMenuSubTrigger, ContextMenuTrigger } from './context-menu';\nexport { Dialog, DialogContent, DialogDescription, DialogFooter, DialogHeader, DialogTitle, DialogTrigger } from './dialog';\nexport { Drawer, DrawerClose, DrawerContent, DrawerDescription, DrawerFooter, DrawerHeader, DrawerTitle, DrawerTrigger } from './drawer';\nexport { DropdownMenu, DropdownMenuCheckboxItem, DropdownMenuContent, DropdownMenuItem, DropdownMenuLabel, DropdownMenuPortal, DropdownMenuRadioGroup, DropdownMenuRadioItem, DropdownMenuSeparator, DropdownMenuShortcut, DropdownMenuSub, DropdownMenuSubContent, DropdownMenuSubTrigger, DropdownMenuTrigger } from './dropdown-menu';\nexport { Form, FormControl, FormDescription, FormField, FormItem, FormLabel, FormMessage } from './form';\nexport { HoverCard, HoverCardContent, HoverCardTrigger } from './hover-card';\nexport { InputOTP, InputOTPGroup, InputOTPSeparator, InputOTPSlot } from './input-otp';\nexport { Input } from './input';\nexport { Label } from './label';\nexport { Menubar, MenubarCheckboxItem, MenubarContent, MenubarItem, MenubarLabel, MenubarMenu, MenubarRadioGroup, MenubarRadioItem, MenubarSeparator, MenubarShortcut, MenubarSub, MenubarSubContent, MenubarSubTrigger, MenubarTrigger } from './menubar';\nexport { NavigationMenu, NavigationMenuContent, NavigationMenuIndicator, NavigationMenuItem, NavigationMenuLink, NavigationMenuList, NavigationMenuTrigger, NavigationMenuViewport } from './navigation-menu';\nexport { Pagination, PaginationContent, PaginationEllipsis, PaginationItem, PaginationLink, PaginationNext, PaginationPrevious } from './pagination';\nexport { Popover, PopoverContent, PopoverTrigger } from './popover';\nexport { Progress } from './progress';\nexport { RadioGroup, RadioGroupItem } from './radio-group';\nexport { ResizableHandle, ResizablePanel, ResizablePanelGroup } from './resizable';\nexport { ScrollArea, ScrollBar } from './scroll-area';\nexport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from './select';\nexport { Separator } from './separator';\nexport { Sheet, SheetClose, SheetContent, SheetDescription, SheetFooter, SheetHeader, SheetTitle, SheetTrigger } from './sheet';\nexport { Sidebar, SidebarContent, SidebarFooter, SidebarGroup, SidebarGroupContent, SidebarGroupLabel, SidebarHeader, SidebarInput, SidebarInset, SidebarMenu, SidebarMenuAction, SidebarMenuBadge, SidebarMenuButton, SidebarMenuItem, SidebarMenuSkeleton, SidebarMenuSub, SidebarMenuSubButton, SidebarMenuSubItem, SidebarProvider, SidebarRail, SidebarSeparator, SidebarTrigger } from './sidebar';\nexport { Skeleton } from './skeleton';\nexport { Slider } from './slider';\nexport { Switch } from './switch';\nexport { Table, TableBody, TableCaption, TableCell, TableFooter, TableHead, TableHeader, TableRow } from './table';\nexport { Tabs, TabsContent, TabsList, TabsTrigger } from './tabs';\nexport { Textarea } from './textarea';\nexport { Toast, ToastAction, ToastClose, ToastDescription, ToastProvider, ToastTitle, ToastViewport } from './toast';\nexport { Toaster } from './toaster';\nexport { ToggleGroup, ToggleGroupItem } from './toggle-group';\nexport { Toggle, toggleVariants } from './toggle';\nexport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from './tooltip';\nexport { UserAvatar } from './user-avatar';\nexport { VerificationBadge } from './verification-badge';\nexport { AnimatedPreloader } from './animated-preloader';","size_bytes":4982},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":791},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }","size_bytes":709},"client/src/components/ui/loading-spinner.tsx":{"content":"import { cn } from \"@/lib/utils\";\n\ninterface LoadingSpinnerProps {\n  size?: \"sm\" | \"md\" | \"lg\";\n  className?: string;\n}\n\nexport function LoadingSpinner({ size = \"md\", className }: LoadingSpinnerProps) {\n  const sizeClasses = {\n    sm: \"w-4 h-4\",\n    md: \"w-6 h-6\", \n    lg: \"w-8 h-8\"\n  };\n\n  return (\n    <div className={cn(\"flex items-center justify-center\", className)}>\n      <div\n        className={cn(\n          \"animate-spin rounded-full border-2 border-gray-300 border-t-blue-600\",\n          sizeClasses[size]\n        )}\n      />\n    </div>\n  );\n}","size_bytes":554},"client/src/components/ui/loading-states.tsx":{"content":"import { motion } from 'framer-motion';\nimport { Loader2, Plane, MapPin, Users, Calendar } from 'lucide-react';\nimport { Card, CardContent } from './card';\nimport { Skeleton } from './skeleton';\n\nexport function LoadingSpinner({ size = 'md', className = '' }: { size?: 'sm' | 'md' | 'lg', className?: string }) {\n  const sizeClasses = {\n    sm: 'h-4 w-4',\n    md: 'h-6 w-6',\n    lg: 'h-8 w-8'\n  };\n\n  return (\n    <motion.div\n      animate={{ rotate: 360 }}\n      transition={{ duration: 1, repeat: Infinity, ease: 'linear' }}\n      className={`${sizeClasses[size]} ${className}`}\n    >\n      <Loader2 className=\"h-full w-full text-blue-500\" />\n    </motion.div>\n  );\n}\n\nexport function TripCardSkeleton() {\n  return (\n    <Card className=\"overflow-hidden\">\n      <div className=\"relative\">\n        <Skeleton className=\"h-48 w-full\" />\n        <div className=\"absolute top-3 left-3\">\n          <Skeleton className=\"h-6 w-20 rounded-full\" />\n        </div>\n        <div className=\"absolute top-3 right-3 flex gap-2\">\n          <Skeleton className=\"h-8 w-8 rounded-full\" />\n          <Skeleton className=\"h-8 w-8 rounded-full\" />\n        </div>\n      </div>\n      <CardContent className=\"p-6\">\n        <div className=\"space-y-3\">\n          <Skeleton className=\"h-6 w-3/4\" />\n          <div className=\"flex items-center gap-4\">\n            <Skeleton className=\"h-4 w-24\" />\n            <Skeleton className=\"h-4 w-20\" />\n          </div>\n          <div className=\"flex items-center gap-4\">\n            <Skeleton className=\"h-4 w-16\" />\n            <Skeleton className=\"h-4 w-20\" />\n          </div>\n          <Skeleton className=\"h-12 w-full\" />\n          <div className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2\">\n              <Skeleton className=\"h-8 w-8 rounded-full\" />\n              <Skeleton className=\"h-4 w-16\" />\n            </div>\n            <div className=\"text-right\">\n              <Skeleton className=\"h-4 w-20 mb-1\" />\n              <Skeleton className=\"h-3 w-16\" />\n            </div>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport function SearchResultsSkeleton() {\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex items-center justify-between\">\n        <Skeleton className=\"h-6 w-40\" />\n        <Skeleton className=\"h-4 w-24\" />\n      </div>\n      <div className=\"grid gap-6 md:grid-cols-2 lg:grid-cols-3\">\n        {Array.from({ length: 6 }).map((_, i) => (\n          <TripCardSkeleton key={i} />\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport function DashboardSkeleton() {\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <Skeleton className=\"h-8 w-48 mb-2\" />\n          <Skeleton className=\"h-4 w-32\" />\n        </div>\n        <Skeleton className=\"h-10 w-32\" />\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid gap-4 md:grid-cols-4\">\n        {Array.from({ length: 4 }).map((_, i) => (\n          <Card key={i}>\n            <CardContent className=\"p-6\">\n              <div className=\"flex items-center justify-between\">\n                <div>\n                  <Skeleton className=\"h-4 w-24 mb-2\" />\n                  <Skeleton className=\"h-8 w-16\" />\n                </div>\n                <Skeleton className=\"h-8 w-8\" />\n              </div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n\n      {/* Trips Section */}\n      <Card>\n        <CardContent className=\"p-6\">\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center justify-between\">\n              <Skeleton className=\"h-6 w-32\" />\n              <Skeleton className=\"h-4 w-20\" />\n            </div>\n            <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-3\">\n              {Array.from({ length: 3 }).map((_, i) => (\n                <TripCardSkeleton key={i} />\n              ))}\n            </div>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\nexport function ActivityDetailSkeleton() {\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center gap-4\">\n        <Skeleton className=\"h-8 w-8\" />\n        <Skeleton className=\"h-8 w-64\" />\n      </div>\n\n      {/* Image Gallery */}\n      <div className=\"grid gap-4 md:grid-cols-2\">\n        <Skeleton className=\"h-64 w-full\" />\n        <div className=\"space-y-4\">\n          <Skeleton className=\"h-32 w-full\" />\n          <Skeleton className=\"h-32 w-full\" />\n        </div>\n      </div>\n\n      {/* Content */}\n      <div className=\"grid gap-6 lg:grid-cols-3\">\n        <div className=\"lg:col-span-2 space-y-4\">\n          <Skeleton className=\"h-6 w-48\" />\n          <Skeleton className=\"h-20 w-full\" />\n          <div className=\"flex items-center gap-4\">\n            <Skeleton className=\"h-4 w-24\" />\n            <Skeleton className=\"h-4 w-20\" />\n            <Skeleton className=\"h-4 w-16\" />\n          </div>\n        </div>\n        <div className=\"space-y-4\">\n          <Card>\n            <CardContent className=\"p-4\">\n              <Skeleton className=\"h-6 w-32 mb-4\" />\n              <Skeleton className=\"h-10 w-full mb-2\" />\n              <Skeleton className=\"h-4 w-24\" />\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport function TravelLoadingAnimation() {\n  return (\n    <div className=\"flex items-center justify-center p-8\">\n      <div className=\"relative\">\n        <motion.div\n          animate={{\n            rotate: 360,\n            scale: [1, 1.1, 1],\n          }}\n          transition={{\n            duration: 2,\n            repeat: Infinity,\n            ease: 'easeInOut'\n          }}\n          className=\"relative z-10\"\n        >\n          <Plane className=\"h-8 w-8 text-blue-500\" />\n        </motion.div>\n        \n        {/* Animated dots representing destinations */}\n        <div className=\"absolute inset-0 flex items-center justify-center\">\n          {[0, 1, 2].map((i) => (\n            <motion.div\n              key={i}\n              animate={{\n                scale: [0, 1, 0],\n                opacity: [0, 1, 0],\n              }}\n              transition={{\n                duration: 1.5,\n                repeat: Infinity,\n                delay: i * 0.2,\n              }}\n              className=\"absolute w-2 h-2 bg-blue-300 rounded-full\"\n              style={{\n                left: `${30 + i * 20}%`,\n                top: `${40 + i * 10}%`,\n              }}\n            />\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}","size_bytes":6583},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/notification-system.tsx":{"content":"import { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Bell, X, CheckCircle, AlertCircle, Info, UserPlus, Calendar, DollarSign } from 'lucide-react';\nimport { Button } from './button';\nimport { Card, CardContent } from './card';\nimport { Badge } from './badge';\n\ninterface Notification {\n  id: string;\n  type: 'trip_request' | 'trip_accepted' | 'trip_rejected' | 'new_message' | 'budget_update' | 'system' | 'success' | 'error' | 'info';\n  title: string;\n  message: string;\n  timestamp: Date;\n  read: boolean;\n  actionUrl?: string;\n  actionText?: string;\n}\n\nconst notificationIcons = {\n  trip_request: UserPlus,\n  trip_accepted: CheckCircle,\n  trip_rejected: X,\n  new_message: Bell,\n  budget_update: DollarSign,\n  system: Info,\n  success: CheckCircle,\n  error: AlertCircle,\n  info: Info,\n};\n\nconst notificationColors = {\n  trip_request: 'bg-blue-50 border-blue-200 text-blue-800',\n  trip_accepted: 'bg-green-50 border-green-200 text-green-800',\n  trip_rejected: 'bg-red-50 border-red-200 text-red-800',\n  new_message: 'bg-purple-50 border-purple-200 text-purple-800',\n  budget_update: 'bg-yellow-50 border-yellow-200 text-yellow-800',\n  system: 'bg-gray-50 border-gray-200 text-gray-800',\n  success: 'bg-green-50 border-green-200 text-green-800',\n  error: 'bg-red-50 border-red-200 text-red-800',\n  info: 'bg-blue-50 border-blue-200 text-blue-800',\n};\n\nexport function NotificationSystem() {\n  const [notifications, setNotifications] = useState<Notification[]>([]);\n  const [isOpen, setIsOpen] = useState(false);\n\n  // Simulated notifications (in a real app, these would come from your API)\n  useEffect(() => {\n    const sampleNotifications: Notification[] = [\n      {\n        id: '1',\n        type: 'trip_request',\n        title: 'Nova solicita√ß√£o de viagem',\n        message: 'Jo√£o Silva quer participar da sua viagem para Machu Picchu',\n        timestamp: new Date(Date.now() - 5 * 60 * 1000),\n        read: false,\n        actionUrl: '/trip/1',\n        actionText: 'Ver solicita√ß√£o'\n      },\n      {\n        id: '2',\n        type: 'trip_accepted',\n        title: 'Solicita√ß√£o aceita!',\n        message: 'Sua solicita√ß√£o para a viagem \"Aventura no Pantanal\" foi aceita',\n        timestamp: new Date(Date.now() - 2 * 60 * 60 * 1000),\n        read: false,\n        actionUrl: '/trip/2',\n        actionText: 'Ver viagem'\n      },\n      {\n        id: '3',\n        type: 'budget_update',\n        title: 'Or√ßamento atualizado',\n        message: 'O or√ßamento da viagem \"Carnaval em Salvador\" foi atualizado para R$ 2.500',\n        timestamp: new Date(Date.now() - 24 * 60 * 60 * 1000),\n        read: true,\n        actionUrl: '/trip/3',\n        actionText: 'Ver detalhes'\n      },\n    ];\n\n    setNotifications(sampleNotifications);\n  }, []);\n\n  const unreadCount = notifications.filter(n => !n.read).length;\n\n  const markAsRead = (id: string) => {\n    setNotifications(prev => \n      prev.map(n => n.id === id ? { ...n, read: true } : n)\n    );\n  };\n\n  const markAllAsRead = () => {\n    setNotifications(prev => prev.map(n => ({ ...n, read: true })));\n  };\n\n  const removeNotification = (id: string) => {\n    setNotifications(prev => prev.filter(n => n.id !== id));\n  };\n\n  const formatTimestamp = (timestamp: Date) => {\n    const now = new Date();\n    const diff = now.getTime() - timestamp.getTime();\n    const minutes = Math.floor(diff / 60000);\n    const hours = Math.floor(diff / 3600000);\n    const days = Math.floor(diff / 86400000);\n\n    if (minutes < 1) return 'Agora mesmo';\n    if (minutes < 60) return `${minutes}m atr√°s`;\n    if (hours < 24) return `${hours}h atr√°s`;\n    return `${days}d atr√°s`;\n  };\n\n  return (\n    <div className=\"relative\">\n      {/* Notification Bell */}\n      <Button\n        variant=\"ghost\"\n        size=\"sm\"\n        className=\"relative p-2\"\n        onClick={() => setIsOpen(!isOpen)}\n      >\n        <Bell className=\"h-5 w-5\" />\n        {unreadCount > 0 && (\n          <Badge className=\"absolute -top-1 -right-1 h-5 w-5 text-xs bg-red-500 hover:bg-red-600\">\n            {unreadCount}\n          </Badge>\n        )}\n      </Button>\n\n      {/* Notification Dropdown */}\n      <AnimatePresence>\n        {isOpen && (\n          <motion.div\n            initial={{ opacity: 0, y: -10 }}\n            animate={{ opacity: 1, y: 0 }}\n            exit={{ opacity: 0, y: -10 }}\n            className=\"absolute right-0 top-full mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50\"\n          >\n            <div className=\"p-4 border-b border-gray-100\">\n              <div className=\"flex items-center justify-between\">\n                <h3 className=\"font-semibold text-gray-900\">Notifica√ß√µes</h3>\n                {unreadCount > 0 && (\n                  <Button\n                    variant=\"ghost\"\n                    size=\"sm\"\n                    onClick={markAllAsRead}\n                    className=\"text-xs text-blue-600 hover:text-blue-800\"\n                  >\n                    Marcar todas como lidas\n                  </Button>\n                )}\n              </div>\n            </div>\n\n            <div className=\"max-h-96 overflow-y-auto\">\n              {notifications.length === 0 ? (\n                <div className=\"p-4 text-center text-gray-500\">\n                  Nenhuma notifica√ß√£o\n                </div>\n              ) : (\n                notifications.map((notification) => {\n                  const Icon = notificationIcons[notification.type];\n                  const colorClass = notificationColors[notification.type];\n                  \n                  return (\n                    <motion.div\n                      key={notification.id}\n                      initial={{ opacity: 0, x: -20 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      className={`p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors ${\n                        !notification.read ? 'bg-blue-50/50' : ''\n                      }`}\n                    >\n                      <div className=\"flex items-start gap-3\">\n                        <div className={`p-2 rounded-full ${colorClass}`}>\n                          <Icon className=\"h-4 w-4\" />\n                        </div>\n                        \n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"flex items-center justify-between\">\n                            <h4 className=\"font-medium text-gray-900 text-sm\">\n                              {notification.title}\n                            </h4>\n                            <button\n                              onClick={() => removeNotification(notification.id)}\n                              className=\"text-gray-400 hover:text-gray-600\"\n                            >\n                              <X className=\"h-4 w-4\" />\n                            </button>\n                          </div>\n                          \n                          <p className=\"text-sm text-gray-600 mt-1\">\n                            {notification.message}\n                          </p>\n                          \n                          <div className=\"flex items-center justify-between mt-2\">\n                            <span className=\"text-xs text-gray-500\">\n                              {formatTimestamp(notification.timestamp)}\n                            </span>\n                            \n                            {notification.actionUrl && (\n                              <Button\n                                variant=\"ghost\"\n                                size=\"sm\"\n                                className=\"text-xs text-blue-600 hover:text-blue-800\"\n                                onClick={() => {\n                                  markAsRead(notification.id);\n                                  // Navigate to action URL\n                                  window.location.href = notification.actionUrl!;\n                                }}\n                              >\n                                {notification.actionText}\n                              </Button>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    </motion.div>\n                  );\n                })\n              )}\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Backdrop */}\n      {isOpen && (\n        <div\n          className=\"fixed inset-0 z-40\"\n          onClick={() => setIsOpen(false)}\n        />\n      )}\n    </div>\n  );\n}","size_bytes":8546},"client/src/components/ui/optimized-image.tsx":{"content":"import { useState, useEffect, useRef, useCallback, memo } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { ImageIcon, Loader2 } from 'lucide-react';\n\ninterface OptimizedImageProps extends React.ImgHTMLAttributes<HTMLImageElement> {\n  src: string;\n  alt: string;\n  fallbackSrc?: string;\n  className?: string;\n  lazy?: boolean;\n  blurhash?: string;\n  onLoad?: () => void;\n  onError?: () => void;\n}\n\nexport const OptimizedImage = memo(function OptimizedImage({\n  src,\n  alt,\n  fallbackSrc = 'https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=800&q=80',\n  className = '',\n  lazy = true,\n  blurhash,\n  onLoad,\n  onError,\n  ...props\n}: OptimizedImageProps) {\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [isError, setIsError] = useState(false);\n  const [isInView, setIsInView] = useState(!lazy);\n  const [currentSrc, setCurrentSrc] = useState(src);\n  const imgRef = useRef<HTMLImageElement>(null);\n  const observerRef = useRef<IntersectionObserver | null>(null);\n\n  // Intersection observer for lazy loading\n  useEffect(() => {\n    if (!lazy) return;\n\n    const observer = new IntersectionObserver(\n      ([entry]) => {\n        if (entry.isIntersecting) {\n          setIsInView(true);\n          if (observerRef.current) {\n            observerRef.current.disconnect();\n          }\n        }\n      },\n      {\n        threshold: 0.1,\n        rootMargin: '50px'\n      }\n    );\n\n    observerRef.current = observer;\n\n    if (imgRef.current) {\n      observer.observe(imgRef.current);\n    }\n\n    return () => {\n      if (observerRef.current) {\n        observerRef.current.disconnect();\n      }\n    };\n  }, [lazy]);\n\n  const handleLoad = useCallback(() => {\n    setIsLoaded(true);\n    onLoad?.();\n  }, [onLoad]);\n\n  const handleError = useCallback(() => {\n    if (currentSrc !== fallbackSrc) {\n      setCurrentSrc(fallbackSrc);\n      setIsError(false);\n    } else {\n      setIsError(true);\n    }\n    onError?.();\n  }, [currentSrc, fallbackSrc, onError]);\n\n  // Preload image when in view\n  useEffect(() => {\n    if (!isInView) return;\n\n    const img = new Image();\n    img.src = currentSrc;\n    img.onload = handleLoad;\n    img.onerror = handleError;\n\n    return () => {\n      img.onload = null;\n      img.onerror = null;\n    };\n  }, [isInView, currentSrc, handleLoad, handleError]);\n\n  // Blurhash placeholder (if provided)\n  const BlurhashPlaceholder = () => (\n    <div \n      className={`bg-gray-100 animate-pulse ${className}`}\n      style={{ \n        backgroundImage: blurhash ? `url(${blurhash})` : undefined,\n        backgroundSize: 'cover',\n        backgroundPosition: 'center'\n      }}\n    />\n  );\n\n  // Loading skeleton\n  const LoadingSkeleton = () => (\n    <div className={`bg-gray-100 animate-pulse flex items-center justify-center ${className}`}>\n      <Loader2 className=\"h-8 w-8 text-gray-400 animate-spin\" />\n    </div>\n  );\n\n  // Error state\n  const ErrorState = () => (\n    <div className={`bg-gray-100 flex items-center justify-center ${className}`}>\n      <div className=\"text-center\">\n        <ImageIcon className=\"h-8 w-8 text-gray-400 mx-auto mb-2\" />\n        <span className=\"text-xs text-gray-500\">Falha ao carregar</span>\n      </div>\n    </div>\n  );\n\n  if (isError) {\n    return <ErrorState />;\n  }\n\n  return (\n    <div className={`relative overflow-hidden ${className}`}>\n      <AnimatePresence mode=\"wait\">\n        {!isLoaded && (\n          <motion.div\n            initial={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            transition={{ duration: 0.3 }}\n            className=\"absolute inset-0\"\n          >\n            {blurhash ? <BlurhashPlaceholder /> : <LoadingSkeleton />}\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {isInView && (\n        <motion.img\n          ref={imgRef}\n          src={currentSrc}\n          alt={alt}\n          className={`w-full h-full object-cover ${className}`}\n          initial={{ opacity: 0 }}\n          animate={{ opacity: isLoaded ? 1 : 0 }}\n          transition={{ duration: 0.3 }}\n          onLoad={handleLoad}\n          onError={handleError}\n          {...props}\n        />\n      )}\n    </div>\n  );\n});\n\n// Progressive image loading with multiple sources\nexport const ProgressiveImage = memo(function ProgressiveImage({\n  src,\n  lowQualitySrc,\n  alt,\n  className = '',\n  ...props\n}: {\n  src: string;\n  lowQualitySrc?: string;\n  alt: string;\n  className?: string;\n} & React.ImgHTMLAttributes<HTMLImageElement>) {\n  const [isHighQualityLoaded, setIsHighQualityLoaded] = useState(false);\n  const [isLowQualityLoaded, setIsLowQualityLoaded] = useState(false);\n\n  useEffect(() => {\n    // Load low quality image first\n    if (lowQualitySrc) {\n      const lowQualityImg = new Image();\n      lowQualityImg.src = lowQualitySrc;\n      lowQualityImg.onload = () => setIsLowQualityLoaded(true);\n    }\n\n    // Load high quality image\n    const highQualityImg = new Image();\n    highQualityImg.src = src;\n    highQualityImg.onload = () => setIsHighQualityLoaded(true);\n  }, [src, lowQualitySrc]);\n\n  return (\n    <div className={`relative overflow-hidden ${className}`}>\n      {/* Low quality placeholder */}\n      {lowQualitySrc && (\n        <motion.img\n          src={lowQualitySrc}\n          alt={alt}\n          className={`absolute inset-0 w-full h-full object-cover filter blur-sm scale-110 ${className}`}\n          initial={{ opacity: 0 }}\n          animate={{ opacity: isLowQualityLoaded && !isHighQualityLoaded ? 1 : 0 }}\n          transition={{ duration: 0.3 }}\n          {...props}\n        />\n      )}\n\n      {/* High quality image */}\n      <motion.img\n        src={src}\n        alt={alt}\n        className={`w-full h-full object-cover ${className}`}\n        initial={{ opacity: 0 }}\n        animate={{ opacity: isHighQualityLoaded ? 1 : 0 }}\n        transition={{ duration: 0.3 }}\n        {...props}\n      />\n\n      {/* Loading skeleton */}\n      {!isLowQualityLoaded && !isHighQualityLoaded && (\n        <div className={`absolute inset-0 bg-gray-100 animate-pulse flex items-center justify-center ${className}`}>\n          <Loader2 className=\"h-8 w-8 text-gray-400 animate-spin\" />\n        </div>\n      )}\n    </div>\n  );\n});","size_bytes":6170},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/progress.tsx":{"content":"import * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }","size_bytes":776},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5742},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }","size_bytes":755},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":23567},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\";\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  );\n}\n\nexport { Skeleton };","size_bytes":263},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/components/ui/user-avatar.tsx":{"content":"import { Avatar, AvatarFallback, AvatarImage } from \"./avatar\";\nimport { VerificationBadge } from \"./verification-badge\";\nimport { cn } from \"@/lib/utils\";\n\ninterface UserAvatarProps {\n  user?: {\n    fullName?: string;\n    full_name?: string;\n    profilePhoto?: string;\n    profile_photo?: string;\n    isVerified?: boolean;\n    is_verified?: boolean;\n  };\n  size?: \"sm\" | \"md\" | \"lg\" | \"xl\";\n  className?: string;\n  showVerificationBadge?: boolean;\n}\n\nconst sizeClasses = {\n  sm: \"h-8 w-8\",\n  md: \"h-10 w-10\", \n  lg: \"h-16 w-16\",\n  xl: \"h-24 w-24\"\n};\n\nconst badgeSizeMap = {\n  sm: \"sm\" as const,\n  md: \"sm\" as const,\n  lg: \"md\" as const,\n  xl: \"lg\" as const\n};\n\nexport function UserAvatar({ \n  user, \n  size = \"md\", \n  className,\n  showVerificationBadge = true \n}: UserAvatarProps) {\n  const getInitials = (name: string) => {\n    if (!name || typeof name !== 'string') {\n      return '?';\n    }\n    return name\n      .split(' ')\n      .map(word => word.charAt(0))\n      .join('')\n      .toUpperCase()\n      .slice(0, 2);\n  };\n\n  // Handle case when user is undefined\n  if (!user) {\n    return (\n      <div className=\"relative inline-block\">\n        <Avatar className={cn(sizeClasses[size], className)}>\n          <AvatarFallback className=\"text-white font-bold bg-gray-400\">\n            ?\n          </AvatarFallback>\n        </Avatar>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"relative inline-block\">\n      <Avatar className={cn(sizeClasses[size], className)}>\n        {user.profile_photo && (\n          <AvatarImage \n            src={user.profile_photo} \n            alt={user.full_name || 'Usu√°rio'}\n            className=\"object-cover\"\n          />\n        )}\n        <AvatarFallback \n          className=\"text-white font-bold\"\n          style={{ \n            background: 'linear-gradient(135deg, #1B2B49 0%, #41B6FF 100%)' \n          }}\n        >\n          {getInitials(user.full_name || '')}\n        </AvatarFallback>\n      </Avatar>\n      \n      {showVerificationBadge && user.is_verified && (\n        <VerificationBadge \n          isVerified={user.is_verified || false}\n          size={badgeSizeMap[size]}\n        />\n      )}\n    </div>\n  );\n}","size_bytes":2165},"client/src/components/ui/verification-badge.tsx":{"content":"import { Shield, CheckCircle } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface VerificationBadgeProps {\n  isVerified: boolean;\n  size?: \"sm\" | \"md\" | \"lg\";\n  className?: string;\n}\n\nexport function VerificationBadge({ isVerified, size = \"md\", className }: VerificationBadgeProps) {\n  if (!isVerified) return null;\n\n  const sizeClasses = {\n    sm: \"h-3 w-3\",\n    md: \"h-4 w-4\", \n    lg: \"h-5 w-5\"\n  };\n\n  const badgeSize = {\n    sm: \"h-4 w-4 p-0.5\",\n    md: \"h-5 w-5 p-0.5\", \n    lg: \"h-6 w-6 p-1\"\n  };\n\n  const positioning = {\n    sm: \"-top-0.5 -right-0.5\",\n    md: \"-top-1 -right-1\",\n    lg: \"-top-1.5 -right-1.5\"\n  };\n\n  return (\n    <div className={cn(\n      \"absolute bg-gradient-to-br from-green-400 to-emerald-500 rounded-full shadow-lg border-2 border-white ring-1 ring-green-200/50 flex items-center justify-center\",\n      badgeSize[size],\n      positioning[size],\n      className\n    )}>\n      <CheckCircle className={cn(\"text-white drop-shadow-sm\", sizeClasses[size])} />\n    </div>\n  );\n}","size_bytes":1016},"comprehensive_snake_case_migration.md":{"content":"# Comprehensive Snake_Case Migration Plan\n\n## Current Progress\n‚úì Database schema already fully snake_case (PostgreSQL)\n‚úì Shared schema types (User, Trip, etc.) fully snake_case\n‚úì Authentication system adapted for snake_case\n‚úì Storage layer fixed for snake_case compatibility\n‚úì New snake_case auth hook created\n\n## Next Steps\n\n### 1. Frontend Components Migration\n- [ ] Update all auth imports to use-auth-snake\n- [ ] Convert all component prop naming to snake_case\n- [ ] Update form field names and validation schemas\n- [ ] Convert API request/response handling to snake_case\n\n### 2. API Routes Migration  \n- [ ] Convert all route handlers to snake_case parameter names\n- [ ] Update query parameter handling\n- [ ] Fix request/response data transformation\n- [ ] Update middleware functions\n\n### 3. React Hooks & Utilities Migration\n- [ ] Update useAuth hook consumers\n- [ ] Convert all query keys to snake_case\n- [ ] Update form hooks and validation\n- [ ] Fix utility functions\n\n### 4. Pages Migration\n- [ ] Update all page components to snake_case props\n- [ ] Fix routing parameter handling\n- [ ] Convert component state management\n\n### 5. Testing & Validation\n- [ ] Test login functionality with demo users\n- [ ] Verify all API endpoints work correctly\n- [ ] Test trip creation and management\n- [ ] Validate activity and review systems\n\n## Key Changes Made\n1. Created use-auth-snake.tsx with full snake_case naming\n2. Fixed storage.ts TypeScript errors for snake_case compatibility  \n3. Updated App.tsx to use snake_case AuthProvider\n4. Converted critical backend routes to snake_case handling\n5. Maintained database consistency throughout migration","size_bytes":1660},"server/db-security.ts":{"content":"// M√ìDULO DE SEGURAN√áA DO BANCO DE DADOS\n// Este m√≥dulo implementa prote√ß√µes robustas para garantir\n// que apenas o banco configurado no .env seja usado\n\nimport dotenv from \"dotenv\";\n\ndotenv.config();\n\n// Configura√ß√µes de seguran√ßa\nconst SECURITY_CONFIG = {\n  // Dom√≠nios autorizados para conex√£o\n  allowedDomains: [\n    'neon.tech',\n    'ep-dark-frog-acs6c8yp.sa-east-1.aws.neon.tech'\n  ],\n  \n  // Padr√µes bloqueados (bancos locais, Replit nativo, etc.)\n  blockedPatterns: [\n    'replit.dev',\n    'repl.co', \n    'localhost',\n    '127.0.0.1',\n    '0.0.0.0',\n    'sqlite',\n    'file:',\n    'memory:',\n    '.db',\n    'local.'\n  ],\n  \n  // Protocolos permitidos\n  allowedProtocols: ['postgresql:', 'postgres:']\n};\n\n/**\n * Verifica se a aplica√ß√£o est√° tentando usar o banco correto\n */\nexport function validateEnvironment(): void {\n  // Verificar se DATABASE_URL existe\n  if (!process.env.DATABASE_URL) {\n    throw new Error(\"üö® SEGURAN√áA: DATABASE_URL n√£o encontrada no arquivo .env\");\n  }\n\n  // Verificar se SESSION_SECRET existe (indicador de configura√ß√£o correta)\n  if (!process.env.SESSION_SECRET) {\n    console.warn(\"‚ö†Ô∏è AVISO: SESSION_SECRET n√£o configurada\");\n  }\n\n  console.log(\"‚úÖ SEGURAN√áA: Vari√°veis de ambiente validadas\");\n}\n\n/**\n * Valida URL do banco antes de qualquer conex√£o\n */\nexport function validateDatabaseUrl(url: string): void {\n  if (!url || typeof url !== 'string') {\n    throw new Error(\"üö® SEGURAN√áA: URL do banco inv√°lida ou vazia\");\n  }\n\n  try {\n    const urlObj = new URL(url);\n    \n    // Verificar protocolo\n    if (!SECURITY_CONFIG.allowedProtocols.includes(urlObj.protocol)) {\n      throw new Error(`üö® SEGURAN√áA: Protocolo n√£o autorizado: ${urlObj.protocol}`);\n    }\n\n    // Verificar padr√µes bloqueados\n    for (const pattern of SECURITY_CONFIG.blockedPatterns) {\n      if (url.toLowerCase().includes(pattern.toLowerCase())) {\n        throw new Error(`üö® SEGURAN√áA: Padr√£o bloqueado detectado: ${pattern}`);\n      }\n    }\n\n    // Verificar dom√≠nios autorizados\n    const isAuthorized = SECURITY_CONFIG.allowedDomains.some(domain => \n      urlObj.hostname.includes(domain)\n    );\n\n    if (!isAuthorized) {\n      throw new Error(`üö® SEGURAN√áA: Dom√≠nio n√£o autorizado: ${urlObj.hostname}`);\n    }\n\n    console.log(`‚úÖ SEGURAN√áA: URL validada para ${urlObj.hostname}`);\n    \n  } catch (error) {\n    if (error instanceof Error && error.message.includes('SEGURAN√áA')) {\n      throw error; // Re-throw security errors\n    }\n    throw new Error(`üö® SEGURAN√áA: URL malformada: ${error}`);\n  }\n}\n\n/**\n * Monitor de seguran√ßa que verifica periodicamente\n */\nexport function startSecurityMonitor(): void {\n  const monitor = () => {\n    try {\n      validateEnvironment();\n      if (process.env.DATABASE_URL) {\n        validateDatabaseUrl(process.env.DATABASE_URL);\n      }\n    } catch (error) {\n      console.error(\"üö® MONITOR DE SEGURAN√áA:\", error);\n      process.exit(1); // Encerrar aplica√ß√£o se detectar problema de seguran√ßa\n    }\n  };\n\n  // Verificar a cada 5 minutos\n  setInterval(monitor, 5 * 60 * 1000);\n  \n  // Verifica√ß√£o inicial\n  monitor();\n  \n  console.log(\"üõ°Ô∏è Monitor de seguran√ßa do banco iniciado\");\n}\n\n/**\n * Bloquear tentativas de altera√ß√£o das vari√°veis de ambiente em runtime\n */\nexport function protectEnvironmentVariables(): void {\n  const originalDbUrl = process.env.DATABASE_URL;\n  \n  // Criar uma valida√ß√£o que monitora mudan√ßas\n  const checkInterval = setInterval(() => {\n    if (process.env.DATABASE_URL !== originalDbUrl) {\n      console.error(\"üö® SEGURAN√áA: DATABASE_URL foi alterada durante execu√ß√£o - reiniciando aplica√ß√£o\");\n      process.exit(1);\n    }\n  }, 30000); // Verificar a cada 30 segundos\n\n  // Limpar interval quando o processo terminar\n  process.on('exit', () => clearInterval(checkInterval));\n  process.on('SIGINT', () => clearInterval(checkInterval));\n  process.on('SIGTERM', () => clearInterval(checkInterval));\n\n  console.log(\"üîí SEGURAN√áA: Monitor de prote√ß√£o de vari√°veis de ambiente ativado\");\n}\n\n/**\n * Inicializar todas as prote√ß√µes de seguran√ßa\n */\nexport function initializeDatabaseSecurity(): void {\n  console.log(\"üõ°Ô∏è Inicializando prote√ß√µes de seguran√ßa do banco...\");\n  \n  validateEnvironment();\n  \n  if (process.env.DATABASE_URL) {\n    validateDatabaseUrl(process.env.DATABASE_URL);\n  }\n  \n  protectEnvironmentVariables();\n  startSecurityMonitor();\n  \n  console.log(\"‚úÖ SEGURAN√áA: Todas as prote√ß√µes do banco foram ativadas\");\n}","size_bytes":4512},"server/middleware/security.ts":{"content":"// MIDDLEWARE DE SEGURAN√áA\n// Prote√ß√µes adicionais para o servidor Express\n\nimport { Request, Response, NextFunction } from \"express\";\n\n/**\n * Middleware que monitora tentativas de acesso a dados sens√≠veis\n */\nexport function securityMonitorMiddleware(req: Request, res: Response, next: NextFunction) {\n  // Lista de endpoints sens√≠veis que devem ser monitorados\n  const sensitiveEndpoints = [\n    '/api/admin',\n    '/api/database',\n    '/api/config',\n    '/api/env'\n  ];\n\n  // Verificar se √© uma tentativa de acesso a endpoint sens√≠vel\n  const isSensitive = sensitiveEndpoints.some(endpoint => \n    req.path.toLowerCase().includes(endpoint.toLowerCase())\n  );\n\n  if (isSensitive) {\n    console.warn(`üö® SEGURAN√áA: Tentativa de acesso a endpoint sens√≠vel: ${req.path} de IP: ${req.ip}`);\n    \n    // Bloquear acesso a endpoints administrativos n√£o autorizados\n    return res.status(403).json({ \n      error: \"Acesso negado - endpoint protegido\",\n      timestamp: new Date().toISOString()\n    });\n  }\n\n  // Headers de seguran√ßa\n  res.setHeader('X-Content-Type-Options', 'nosniff');\n  res.setHeader('X-Frame-Options', 'DENY');\n  res.setHeader('X-XSS-Protection', '1; mode=block');\n  \n  next();\n}\n\n/**\n * Middleware que bloqueia tentativas de manipula√ß√£o de vari√°veis de ambiente\n */\nexport function environmentProtectionMiddleware(req: Request, res: Response, next: NextFunction) {\n  // Verificar se h√° tentativas de enviar dados relacionados a configura√ß√£o de banco\n  const suspiciousPatterns = [\n    'DATABASE_URL',\n    'DB_HOST',\n    'DB_PASSWORD',\n    'CONNECTION_STRING',\n    'MYSQL_',\n    'POSTGRES_',\n    'SQLITE_'\n  ];\n\n  const requestBody = JSON.stringify(req.body || {}).toLowerCase();\n  const queryString = JSON.stringify(req.query || {}).toLowerCase();\n  \n  for (const pattern of suspiciousPatterns) {\n    if (requestBody.includes(pattern.toLowerCase()) || queryString.includes(pattern.toLowerCase())) {\n      console.error(`üö® SEGURAN√áA: Tentativa de manipular configura√ß√£o de banco detectada: ${pattern}`);\n      \n      return res.status(400).json({\n        error: \"Requisi√ß√£o bloqueada - dados sens√≠veis detectados\",\n        timestamp: new Date().toISOString()\n      });\n    }\n  }\n\n  next();\n}\n\n/**\n * Middleware que registra todas as requisi√ß√µes para auditoria\n */\nexport function auditLogMiddleware(req: Request, res: Response, next: NextFunction) {\n  const logData = {\n    timestamp: new Date().toISOString(),\n    method: req.method,\n    path: req.path,\n    ip: req.ip,\n    userAgent: req.get('User-Agent'),\n    referer: req.get('Referer')\n  };\n\n  // Log de auditoria (pode ser expandido para salvar em arquivo)\n  if (req.path.startsWith('/api/')) {\n    console.log(`üìä AUDITORIA: ${JSON.stringify(logData)}`);\n  }\n\n  next();\n}","size_bytes":2774},"client/src/hooks/use-auth-snake.tsx":{"content":"import { createContext, useContext, ReactNode } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { User } from \"@shared/schema\";\n\ninterface LoginData {\n  identifier: string;\n  password: string;\n}\n\ninterface RegisterData {\n  username: string;\n  password: string;\n  email: string;\n  full_name: string;\n  bio?: string | null;\n  location?: string | null;\n  languages?: string[];\n  interests?: string[];\n  travel_styles?: string[];\n}\n\ninterface AuthContextType {\n  user: User | null;\n  is_loading: boolean;\n  error: Error | null;\n  login_mutation: ReturnType<typeof useMutation<User, Error, LoginData>>;\n  logout_mutation: ReturnType<typeof useMutation<void, Error, void>>;\n  register_mutation: ReturnType<typeof useMutation<User, Error, RegisterData>>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const { toast } = useToast();\n  const query_client = useQueryClient();\n\n  // Query para verificar se o usu√°rio est√° logado\n  const { \n    data: user, \n    isLoading: is_loading, \n    error \n  } = useQuery<User>({\n    queryKey: [\"/api/user\"],\n    queryFn: async () => {\n      const res = await apiRequest(\"GET\", \"/api/user\");\n      if (!res.ok) {\n        throw new Error(\"N√£o autorizado\");\n      }\n      return res.json();\n    },\n    retry: 1,\n    staleTime: 30 * 1000, // 30 seconds - shorter to refresh authentication status more frequently\n    refetchOnWindowFocus: true,\n    refetchOnMount: true,\n  });\n\n  // Mutation para login\n  const login_mutation = useMutation<User, Error, LoginData>({\n    mutationFn: async (login_data: LoginData) => {\n      const res = await apiRequest(\"POST\", \"/api/auth/login\", login_data);\n      if (!res.ok) {\n        const error_data = await res.json().catch(() => ({}));\n        throw new Error(error_data.message || \"Erro no login\");\n      }\n      \n      const user_data = await res.json();\n      \n      // Parse JSON string fields if they exist\n      if (typeof user_data.languages === 'string') {\n        try {\n          user_data.languages = JSON.parse(user_data.languages);\n        } catch (e) {\n          user_data.languages = [];\n        }\n      }\n      \n      if (typeof user_data.interests === 'string') {\n        try {\n          user_data.interests = JSON.parse(user_data.interests);\n        } catch (e) {\n          user_data.interests = [];\n        }\n      }\n      \n      if (typeof user_data.travel_styles === 'string') {\n        try {\n          user_data.travel_styles = JSON.parse(user_data.travel_styles);\n        } catch (e) {\n          user_data.travel_styles = [];\n        }\n      }\n      \n      return user_data;\n    },\n    onSuccess: (user_data: User & { session_id?: string }) => {\n      // Store session ID in localStorage for authentication fallback\n      if (user_data.session_id) {\n        localStorage.setItem('session_id', user_data.session_id);\n      }\n      \n      // Atualizar cache imediatamente com dados do usu√°rio\n      query_client.setQueryData([\"/api/user\"], user_data);\n      \n      // Invalidar apenas queries espec√≠ficas, n√£o todas\n      query_client.invalidateQueries({ queryKey: [\"/api/trips\"] });\n      query_client.invalidateQueries({ queryKey: [\"/api/my-trips\"] });\n      query_client.invalidateQueries({ queryKey: [\"/api/user-requests\"] });\n      \n      toast({\n        title: \"Login realizado com sucesso!\",\n        description: \"Bem-vindo de volta!\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Erro no login\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Mutation para logout\n  const logout_mutation = useMutation<void, Error, void>({\n    mutationFn: async () => {\n      const res = await apiRequest(\"POST\", \"/api/auth/logout\");\n      if (!res.ok) {\n        throw new Error(\"Erro no logout\");\n      }\n    },\n    onSuccess: () => {\n      // Clear session storage\n      localStorage.removeItem('session_id');\n      \n      // Limpar todas as queries relacionadas ao usu√°rio\n      query_client.clear();\n      \n      toast({\n        title: \"Logout realizado com sucesso!\",\n        description: \"At√© breve!\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Erro no logout\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Mutation para registro\n  const register_mutation = useMutation<User, Error, RegisterData>({\n    mutationFn: async (register_data: RegisterData) => {\n      const res = await apiRequest(\"POST\", \"/api/auth/register\", register_data);\n      if (!res.ok) {\n        const error_data = await res.json().catch(() => ({}));\n        throw new Error(error_data.message || \"Erro no registro\");\n      }\n      \n      const user_data = await res.json();\n      \n      // Parse JSON string fields if they exist\n      if (typeof user_data.languages === 'string') {\n        try {\n          user_data.languages = JSON.parse(user_data.languages);\n        } catch (e) {\n          user_data.languages = [];\n        }\n      }\n      \n      if (typeof user_data.interests === 'string') {\n        try {\n          user_data.interests = JSON.parse(user_data.interests);\n        } catch (e) {\n          user_data.interests = [];\n        }\n      }\n      \n      if (typeof user_data.travel_styles === 'string') {\n        try {\n          user_data.travel_styles = JSON.parse(user_data.travel_styles);\n        } catch (e) {\n          user_data.travel_styles = [];\n        }\n      }\n      \n      return user_data;\n    },\n    onSuccess: (user_data: User & { session_id?: string }) => {\n      // Store session ID in localStorage for authentication fallback\n      if (user_data.session_id) {\n        localStorage.setItem('session_id', user_data.session_id);\n      }\n      \n      // Atualizar cache imediatamente com dados do usu√°rio\n      query_client.setQueryData([\"/api/user\"], user_data);\n      \n      // Invalidar apenas queries espec√≠ficas\n      query_client.invalidateQueries({ queryKey: [\"/api/trips\"] });\n      query_client.invalidateQueries({ queryKey: [\"/api/my-trips\"] });\n      query_client.invalidateQueries({ queryKey: [\"/api/user-requests\"] });\n      \n      toast({\n        title: \"Conta criada com sucesso!\",\n        description: \"Bem-vindo √† plataforma!\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Erro no registro\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  return (\n    <AuthContext.Provider \n      value={{ \n        user: user || null, \n        is_loading, \n        error, \n        login_mutation, \n        logout_mutation, \n        register_mutation \n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error(\"useAuth deve ser usado dentro de AuthProvider\");\n  }\n  return context;\n}","size_bytes":7114},"client/src/lib/date-utils.ts":{"content":"/**\n * Utility functions for safe date handling throughout the application\n */\n\n/**\n * Safely parses a date string and returns a valid Date object\n * @param dateInput - Date string or Date object\n * @param fallback - Fallback date if parsing fails (default: current date)\n * @returns Valid Date object\n */\nexport function safeParseDate(dateInput: string | Date | null | undefined, fallback?: Date): Date {\n  try {\n    if (!dateInput) {\n      return fallback || new Date();\n    }\n    \n    const parsed = new Date(dateInput);\n    \n    // Check if the date is valid\n    if (isNaN(parsed.getTime())) {\n      console.warn(`Invalid date input: ${dateInput}`);\n      return fallback || new Date();\n    }\n    \n    return parsed;\n  } catch (error) {\n    console.error(`Error parsing date: ${dateInput}`, error);\n    return fallback || new Date();\n  }\n}\n\n/**\n * Calculates the number of days between two dates safely\n * @param startDate - Start date\n * @param endDate - End date (default: current date)\n * @returns Number of days between dates\n */\nexport function safeDateDifference(startDate: string | Date, endDate: string | Date = new Date()): number {\n  try {\n    const start = safeParseDate(startDate);\n    const end = safeParseDate(endDate);\n    \n    const diffTime = end.getTime() - start.getTime();\n    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n    \n    return diffDays;\n  } catch (error) {\n    console.error('Error calculating date difference:', error);\n    return 0;\n  }\n}\n\n/**\n * Checks if a date is valid\n * @param dateInput - Date to validate\n * @returns Boolean indicating if date is valid\n */\nexport function isValidDate(dateInput: string | Date | null | undefined): boolean {\n  if (!dateInput) return false;\n  \n  try {\n    const parsed = new Date(dateInput);\n    return !isNaN(parsed.getTime());\n  } catch {\n    return false;\n  }\n}\n\n/**\n * Gets days until a specific date from now\n * @param targetDate - Target date\n * @returns Number of days until target date (negative if past)\n */\nexport function getDaysUntilDate(targetDate: string | Date): number {\n  try {\n    const target = safeParseDate(targetDate);\n    const today = new Date();\n    \n    const diffTime = target.getTime() - today.getTime();\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n  } catch (error) {\n    console.error('Error calculating days until date:', error);\n    return 0;\n  }\n}\n\n/**\n * Calculates trip duration safely\n * @param startDate - Trip start date\n * @param endDate - Trip end date\n * @returns Duration in days (minimum 1)\n */\nexport function getTripDuration(startDate: string | Date, endDate: string | Date): number {\n  try {\n    const start = safeParseDate(startDate);\n    const end = safeParseDate(endDate);\n    \n    const diffTime = end.getTime() - start.getTime();\n    const duration = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n    \n    // Ensure minimum duration of 1 day\n    return Math.max(1, duration);\n  } catch (error) {\n    console.error('Error calculating trip duration:', error);\n    return 1;\n  }\n}","size_bytes":3032},"server/update-activities-destination.ts":{"content":"import { db } from \"./db\";\nimport { activities, destinations } from \"../shared/schema\";\nimport { eq } from \"drizzle-orm\";\n\nasync function updateActivitiesWithDestination() {\n  console.log(\"üîÑ Atualizando schema das atividades para usar destination_id...\");\n  \n  try {\n    // First, add the destination_id column if it doesn't exist\n    console.log(\"üìù Adicionando coluna destination_id...\");\n    await db.execute(`\n      ALTER TABLE activities \n      ADD COLUMN IF NOT EXISTS destination_id INTEGER REFERENCES destinations(id)\n    `);\n\n    // Find activities with destination_name and match them to destination IDs\n    console.log(\"üîç Vinculando atividades existentes aos destinos...\");\n    const activitiesWithoutDestinationId = await db\n      .select({\n        id: activities.id,\n        destination_name: activities.destination_name\n      })\n      .from(activities)\n      .where(eq(activities.destination_id, null));\n\n    console.log(`üìã Encontradas ${activitiesWithoutDestinationId.length} atividades para vincular`);\n\n    for (const activity of activitiesWithoutDestinationId) {\n      if (!activity.destination_name) continue;\n\n      // Find matching destination\n      const destination = await db\n        .select()\n        .from(destinations)\n        .where(eq(destinations.name, activity.destination_name))\n        .limit(1);\n\n      if (destination.length > 0) {\n        const dest = destination[0];\n        \n        // Update activity with destination_id and inherited fields\n        await db\n          .update(activities)\n          .set({\n            destination_id: dest.id,\n            destination_name: dest.name,\n            city: dest.name,\n            state: dest.state,\n            country: dest.country,\n            country_type: dest.country_type as \"nacional\" | \"internacional\",\n            region: dest.region,\n            continent: dest.continent\n          })\n          .where(eq(activities.id, activity.id));\n\n        console.log(`‚úÖ Atividade ${activity.id} vinculada ao destino ${dest.name}`);\n      } else {\n        console.log(`‚ö†Ô∏è Destino n√£o encontrado para: ${activity.destination_name}`);\n      }\n    }\n\n    console.log(\"‚úÖ Migra√ß√£o das atividades conclu√≠da!\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro na migra√ß√£o:\", error);\n  }\n  \n  process.exit(0);\n}\n\nupdateActivitiesWithDestination();","size_bytes":2351},"server/activity-destination-helper.ts":{"content":"import { db } from \"./db\";\nimport { destinations } from \"../shared/schema\";\nimport { eq } from \"drizzle-orm\";\n\n/**\n * Helper function to get destination data and prepare it for activity insertion\n */\nexport async function getDestinationForActivity(destinationId: number) {\n  const destination = await db\n    .select()\n    .from(destinations)\n    .where(eq(destinations.id, destinationId))\n    .limit(1);\n\n  if (destination.length === 0) {\n    throw new Error(`Destino com ID ${destinationId} n√£o encontrado`);\n  }\n\n  const dest = destination[0];\n  \n  return {\n    destination_id: dest.id,\n    destination_name: dest.name,\n    city: dest.name,\n    state: dest.state,\n    country: dest.country,\n    country_type: dest.country_type as \"nacional\" | \"internacional\",\n    region: dest.region,\n    continent: dest.continent\n  };\n}\n\n/**\n * Validate that a destination exists and is active\n */\nexport async function validateDestination(destinationId: number): Promise<boolean> {\n  const destination = await db\n    .select({ id: destinations.id, is_active: destinations.is_active })\n    .from(destinations)\n    .where(eq(destinations.id, destinationId))\n    .limit(1);\n\n  return destination.length > 0 && destination[0].is_active;\n}","size_bytes":1223},"cadastrar-atividades-curl.sh":{"content":"#!/bin/bash\n\n# Script para cadastrar atividades via API usando curl\n\nBASE_URL=\"http://localhost:5000\"\n\necho \"üèÉ‚Äç‚ôÇÔ∏è Iniciando cadastro de atividades via API...\"\n\n# Fun√ß√£o para cadastrar uma atividade\ncadastrar_atividade() {\n    local title=\"$1\"\n    local description=\"$2\"\n    local destination_id=\"$3\"\n    local category=\"$4\"\n    local duration=\"$5\"\n    local cover_image=\"$6\"\n    local images=\"$7\"\n    \n    echo \"üìù Cadastrando: $title\"\n    \n    curl -X POST \"$BASE_URL/api/activities\" \\\n        -H \"Content-Type: application/json\" \\\n        -d \"{\n            \\\"title\\\": \\\"$title\\\",\n            \\\"description\\\": \\\"$description\\\",\n            \\\"destination_id\\\": $destination_id,\n            \\\"category\\\": \\\"$category\\\",\n            \\\"difficulty_level\\\": \\\"easy\\\",\n            \\\"duration\\\": \\\"$duration\\\",\n            \\\"min_participants\\\": 1,\n            \\\"max_participants\\\": 20,\n            \\\"languages\\\": [\\\"Portugu√™s\\\", \\\"Ingl√™s\\\"],\n            \\\"inclusions\\\": [\\\"Acompanhamento profissional\\\", \\\"Seguro b√°sico\\\"],\n            \\\"exclusions\\\": [\\\"Alimenta√ß√£o\\\", \\\"Transporte pessoal\\\"],\n            \\\"requirements\\\": [\\\"Idade m√≠nima: 12 anos\\\"],\n            \\\"cancellation_policy\\\": \\\"Cancelamento gratuito at√© 24h antes\\\",\n            \\\"contact_info\\\": {\n                \\\"email\\\": \\\"contato@partiutrip.com\\\",\n                \\\"phone\\\": \\\"+55 11 99999-9999\\\",\n                \\\"whatsapp\\\": \\\"+55 11 99999-9999\\\"\n            },\n            \\\"cover_image\\\": \\\"$cover_image\\\",\n            \\\"images\\\": $images,\n            \\\"created_by_id\\\": 9\n        }\"\n    \n    echo -e \"\\n\"\n}\n\n# Cadastrar propostas de or√ßamento\ncadastrar_proposta() {\n    local activity_id=\"$1\"\n    local title=\"$2\"\n    local description=\"$3\"\n    local amount=\"$4\"\n    local inclusions=\"$5\"\n    \n    echo \"üí∞ Cadastrando proposta: $title - R$ $amount\"\n    \n    curl -X POST \"$BASE_URL/api/activities/$activity_id/budget-proposals\" \\\n        -H \"Content-Type: application/json\" \\\n        -d \"{\n            \\\"title\\\": \\\"$title\\\",\n            \\\"description\\\": \\\"$description\\\",\n            \\\"price_type\\\": \\\"per_person\\\",\n            \\\"amount\\\": $amount,\n            \\\"currency\\\": \\\"BRL\\\",\n            \\\"inclusions\\\": $inclusions,\n            \\\"exclusions\\\": [\\\"Despesas pessoais\\\", \\\"Gorjetas\\\"],\n            \\\"is_active\\\": true\n        }\"\n    \n    echo -e \"\\n\"\n}\n\n# Cadastrar review\ncadastrar_review() {\n    local activity_id=\"$1\"\n    local rating=\"$2\"\n    local review_text=\"$3\"\n    local photos=\"$4\"\n    \n    echo \"‚≠ê Cadastrando review: $rating estrelas\"\n    \n    curl -X POST \"$BASE_URL/api/activities/$activity_id/reviews\" \\\n        -H \"Content-Type: application/json\" \\\n        -d \"{\n            \\\"rating\\\": $rating,\n            \\\"review\\\": \\\"$review_text\\\",\n            \\\"photos\\\": $photos,\n            \\\"visit_date\\\": \\\"2024-12-15T00:00:00Z\\\"\n        }\"\n    \n    echo -e \"\\n\"\n}\n\n# Primeiro, buscar o ID do destino Rio de Janeiro\necho \"üîç Buscando destino Rio de Janeiro...\"\nRIO_DEST_ID=$(curl -s \"$BASE_URL/api/destinations\" | grep -o '\"id\":[0-9]*,\"name\":\"[^\"]*[Rr]io[^\"]*\"' | head -1 | grep -o '\"id\":[0-9]*' | cut -d':' -f2)\n\nif [ -z \"$RIO_DEST_ID\" ]; then\n    echo \"‚ùå Destino Rio de Janeiro n√£o encontrado\"\n    exit 1\nfi\n\necho \"‚úÖ Rio de Janeiro encontrado - ID: $RIO_DEST_ID\"\n\n# Cadastrar Cristo Redentor\necho -e \"\\nüèõÔ∏è Cadastrando Cristo Redentor...\"\nCRISTO_RESPONSE=$(cadastrar_atividade \\\n    \"Cristo Redentor / Corcovado\" \\\n    \"Visita ao ic√¥nico Cristo Redentor no topo do Corcovado, uma das sete maravilhas do mundo moderno. Desfrute de vistas panor√¢micas da cidade e ba√≠a de Guanabara.\" \\\n    \"$RIO_DEST_ID\" \\\n    \"pontos_turisticos\" \\\n    \"3-4 horas\" \\\n    \"https://images.unsplash.com/photo-1539650116574-75c0c6d15f83?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\" \\\n    \"[\\\"https://images.unsplash.com/photo-1539650116574-75c0c6d15f83?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\\\"]\")\n\necho \"Cristo Redentor cadastrado!\"\n\n# Cadastrar P√£o de A√ß√∫car\necho -e \"\\nüèîÔ∏è Cadastrando P√£o de A√ß√∫car...\"\nPAO_RESPONSE=$(cadastrar_atividade \\\n    \"P√£o de A√ß√∫car (Bondinho)\" \\\n    \"Passeio no famoso bondinho do P√£o de A√ß√∫car com vistas espetaculares da cidade, ba√≠a e praias. Inclui parada na Urca e no topo do P√£o de A√ß√∫car.\" \\\n    \"$RIO_DEST_ID\" \\\n    \"pontos_turisticos\" \\\n    \"2-3 horas\" \\\n    \"https://images.unsplash.com/photo-1544737151-6e4b9ee48424?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\" \\\n    \"[\\\"https://images.unsplash.com/photo-1544737151-6e4b9ee48424?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\\\"]\")\n\necho \"P√£o de A√ß√∫car cadastrado!\"\n\n# Cadastrar Trilha\necho -e \"\\nü•æ Cadastrando Trilha Pedra Bonita...\"\nTRILHA_RESPONSE=$(cadastrar_atividade \\\n    \"Trilha Pedra Bonita ou Dois Irm√£os\" \\\n    \"Trilhas com as melhores vistas panor√¢micas do Rio. Ideal para amantes da natureza e fotografia.\" \\\n    \"$RIO_DEST_ID\" \\\n    \"hiking\" \\\n    \"4-6 horas\" \\\n    \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\" \\\n    \"[\\\"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\\\"]\")\n\necho \"Trilha cadastrada!\"\n\necho -e \"\\nüéâ Cadastro de atividades conclu√≠do!\"\necho \"‚úÖ 3 atividades foram cadastradas para o Rio de Janeiro\"","size_bytes":5265},"cadastrar-atividades-via-api.ts":{"content":"// Script para cadastrar atividades via API\nconst baseUrl = \"http://localhost:5000\";\n\n// Primeiro, vou buscar os destinos dispon√≠veis\nconst destinationsResponse = await fetch(`${baseUrl}/api/destinations`);\nconst destinations = await destinationsResponse.json();\n\nconsole.log(\"Destinos dispon√≠veis:\", destinations);\n\n// Atividades para Rio de Janeiro\nconst rioActivities = [\n  {\n    title: \"Cristo Redentor / Corcovado\",\n    description: \"Visita ao ic√¥nico Cristo Redentor no topo do Corcovado, uma das sete maravilhas do mundo moderno. Desfrute de vistas panor√¢micas da cidade e ba√≠a de Guanabara.\",\n    category: \"pontos_turisticos\",\n    duration: \"3-4 horas\",\n    cover_image: \"https://images.unsplash.com/photo-1539650116574-75c0c6d15f83?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n    images: [\"https://images.unsplash.com/photo-1539650116574-75c0c6d15f83?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"],\n    propostas: [\n      { title: \"Econ√¥mico\", price: 85, description: \"Van oficial b√°sica at√© o Cristo\" },\n      { title: \"Completo\", price: 160, description: \"Trem panor√¢mico + entrada + guia\" },\n      { title: \"Premium\", price: 320, description: \"Tour privativo com transporte executivo\" }\n    ]\n  },\n  {\n    title: \"P√£o de A√ß√∫car (Bondinho)\",\n    description: \"Passeio no famoso bondinho do P√£o de A√ß√∫car com vistas espetaculares da cidade, ba√≠a e praias.\",\n    category: \"pontos_turisticos\",\n    duration: \"2-3 horas\",\n    cover_image: \"https://images.unsplash.com/photo-1544737151-6e4b9ee48424?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n    images: [\"https://images.unsplash.com/photo-1544737151-6e4b9ee48424?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"],\n    propostas: [\n      { title: \"Econ√¥mico\", price: 120, description: \"Ingresso padr√£o do bondinho\" },\n      { title: \"Completo\", price: 190, description: \"Bondinho + guia tur√≠stico\" },\n      { title: \"Premium\", price: 350, description: \"Bondinho + tour + passeio de helic√≥ptero\" }\n    ]\n  }\n];\n\nconsole.log(\"Iniciando cadastro de atividades...\");\n\nfor (const activity of rioActivities) {\n  try {\n    // Encontrar o destino do Rio de Janeiro\n    const rioDestination = destinations.find((d: any) => \n      d.name?.toLowerCase().includes(\"rio\") || \n      d.city?.toLowerCase().includes(\"rio\")\n    );\n\n    if (!rioDestination) {\n      console.log(\"Destino Rio de Janeiro n√£o encontrado\");\n      continue;\n    }\n\n    // Criar a atividade\n    const activityData = {\n      title: activity.title,\n      description: activity.description,\n      destination_id: rioDestination.id,\n      category: activity.category,\n      difficulty_level: \"easy\",\n      duration: activity.duration,\n      min_participants: 1,\n      max_participants: 20,\n      languages: [\"Portugu√™s\", \"Ingl√™s\"],\n      inclusions: [\"Acompanhamento profissional\", \"Seguro b√°sico\"],\n      exclusions: [\"Alimenta√ß√£o\", \"Transporte pessoal\"],\n      requirements: [\"Idade m√≠nima: 12 anos\"],\n      cancellation_policy: \"Cancelamento gratuito at√© 24h antes\",\n      contact_info: {\n        email: \"contato@partiutrip.com\",\n        phone: \"+55 11 99999-9999\",\n        whatsapp: \"+55 11 99999-9999\"\n      },\n      cover_image: activity.cover_image,\n      images: activity.images,\n      created_by_id: 9\n    };\n\n    console.log(`Cadastrando atividade: ${activity.title}`);\n    console.log(\"Dados:\", JSON.stringify(activityData, null, 2));\n\n  } catch (error) {\n    console.error(`Erro ao processar atividade ${activity.title}:`, error);\n  }\n}","size_bytes":3483},"debug-auth.ts":{"content":"import { db } from \"./server/db\";\nimport { users } from \"./shared/schema\";\nimport { createHash } from \"crypto\";\n\nasync function debugAuth() {\n  console.log(\"üîç Verificando usu√°rios e senhas...\");\n  \n  try {\n    const allUsers = await db.select({\n      id: users.id,\n      username: users.username,\n      email: users.email,\n      password: users.password\n    }).from(users).limit(5);\n    \n    console.log(\"Usu√°rios encontrados:\", allUsers.length);\n    \n    for (const user of allUsers) {\n      console.log(`\\nüë§ Usu√°rio: ${user.username}`);\n      console.log(`üìß Email: ${user.email}`);\n      console.log(`üîë Senha hash: ${user.password}`);\n      \n      // Test with common demo password\n      const testPassword = \"demo123\";\n      const expectedHash = createHash('sha256').update(testPassword + 'salt').digest('hex');\n      console.log(`üß™ Hash esperado para \"demo123\": ${expectedHash}`);\n      console.log(`‚úÖ Senha coincide: ${user.password === expectedHash}`);\n    }\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro:\", error);\n  }\n  \n  process.exit(0);\n}\n\ndebugAuth();","size_bytes":1090},"fix-demo-passwords.ts":{"content":"import { db } from \"./server/db\";\nimport { users } from \"./shared/schema\";\nimport { eq } from \"drizzle-orm\";\nimport { scryptSync, randomBytes } from 'crypto';\n\nfunction hashPassword(password: string): string {\n  const salt = randomBytes(16).toString('hex');\n  const hash = scryptSync(password, salt, 64).toString('hex');\n  return `${hash}.${salt}`;\n}\n\nasync function fixDemoPasswords() {\n  console.log(\"üîß Corrigindo senhas dos usu√°rios demo...\");\n  \n  try {\n    const demoPassword = \"demo123\";\n    const hashedPassword = hashPassword(demoPassword);\n    \n    console.log(`üîë Nova senha hash: ${hashedPassword}`);\n    \n    // Update demo users\n    const demoUsers = ['tom', 'maria', 'carlos'];\n    \n    for (const username of demoUsers) {\n      const result = await db\n        .update(users)\n        .set({ password: hashedPassword })\n        .where(eq(users.username, username))\n        .returning({ id: users.id, username: users.username });\n      \n      if (result.length > 0) {\n        console.log(`‚úÖ Senha atualizada para ${username}`);\n      } else {\n        console.log(`‚ùå Usu√°rio ${username} n√£o encontrado`);\n      }\n    }\n    \n    console.log(\"üéâ Senhas dos usu√°rios demo corrigidas!\");\n    \n  } catch (error) {\n    console.error(\"‚ùå Erro:\", error);\n  }\n  \n  process.exit(0);\n}\n\nfixDemoPasswords();","size_bytes":1322},"test-destination-api.ts":{"content":"import { db } from \"./server/db\";\nimport { destinations, activities } from \"./shared/schema\";\nimport { eq } from \"drizzle-orm\";\n\nasync function testDestinationAPI() {\n  console.log(\"üîç Testando API de destinos e vincula√ß√£o com atividades...\");\n\n  try {\n    // 1. Verificar destinos dispon√≠veis\n    const allDestinations = await db.select().from(destinations).where(eq(destinations.is_active, true)).limit(5);\n    console.log(`‚úÖ Destinos dispon√≠veis: ${allDestinations.length}`);\n    console.log(\"Primeiros 5 destinos:\", allDestinations.map(d => ({ id: d.id, name: d.name, country: d.country })));\n\n    // 2. Verificar atividades e seus destinos\n    const activitiesWithDestinations = await db\n      .select({\n        activity_id: activities.id,\n        activity_title: activities.title,\n        destination_id: activities.destination_id,\n        destination_name: activities.destination_name,\n        city: activities.city,\n        country: activities.country\n      })\n      .from(activities)\n      .limit(5);\n\n    console.log(`‚úÖ Atividades: ${activitiesWithDestinations.length}`);\n    activitiesWithDestinations.forEach(activity => {\n      console.log(`- ${activity.activity_title}: destino_id=${activity.destination_id}, cidade=${activity.city}, pa√≠s=${activity.country}`);\n    });\n\n    // 3. Test helper functions\n    const { validateDestination, getDestinationForActivity } = await import(\"./server/activity-destination-helper\");\n    \n    if (allDestinations.length > 0) {\n      const firstDestination = allDestinations[0];\n      console.log(`üîç Testando valida√ß√£o do destino ${firstDestination.id} (${firstDestination.name})...`);\n      \n      const isValid = await validateDestination(firstDestination.id);\n      console.log(`‚úÖ Destino v√°lido: ${isValid}`);\n      \n      const destinationData = await getDestinationForActivity(firstDestination.id);\n      console.log(\"üìç Dados do destino:\", destinationData);\n    }\n\n    console.log(\"\\n‚úÖ Teste da API de destinos conclu√≠do com sucesso!\");\n\n  } catch (error) {\n    console.error(\"‚ùå Erro no teste:\", error);\n  }\n\n  process.exit(0);\n}\n\ntestDestinationAPI();","size_bytes":2134},"test-login.ts":{"content":"import { scryptSync } from 'crypto';\n\n// Test scrypt password verification\nconst storedPassword = \"a12047031ebc61c473d03d71cf790fe75c090363be0063900d580499eda9b496cd03a311a486156c7ac3b9ad2ee368b222bf5ec4e5539db491a6b01ae253d9f7.6699e452878774b958cb3f149d7c2830\";\nconst testPassword = \"demo123\";\n\nconsole.log(\"üîç Testando verifica√ß√£o de senha com scrypt...\");\nconsole.log(`Senha armazenada: ${storedPassword}`);\nconsole.log(`Senha testada: ${testPassword}`);\n\nconst [hash, salt] = storedPassword.split('.');\nconsole.log(`Hash: ${hash}`);\nconsole.log(`Salt: ${salt}`);\n\nconst hashedPassword = scryptSync(testPassword, salt, 64).toString('hex');\nconsole.log(`Hash gerado: ${hashedPassword}`);\nconsole.log(`‚úÖ Senhas coincidem: ${hash === hashedPassword}`);","size_bytes":758},"test-scrypt-hash.ts":{"content":"import { scryptSync } from 'crypto';\n\n// Test the exact hash that was stored\nconst storedPassword = \"0d93ec9902566f2e28ff605ba5f79d133ea09ba341a8d3d8f54060f4df92e3ff90d0d79998612a58d812859051e2e8b3993142f6466fa57625caaa0cf85c3ec4.b9719640e717179a3ebf6b6b95a4e779\";\nconst testPassword = \"demo123\";\n\nconsole.log(\"üîç Testando verifica√ß√£o de senha com nova hash armazenada...\");\nconsole.log(`Senha armazenada: ${storedPassword}`);\nconsole.log(`Senha testada: ${testPassword}`);\n\nconst [hash, salt] = storedPassword.split('.');\nconsole.log(`Hash: ${hash}`);\nconsole.log(`Salt: ${salt}`);\n\nconst hashedPassword = scryptSync(testPassword, salt, 64).toString('hex');\nconsole.log(`Hash gerado: ${hashedPassword}`);\nconsole.log(`‚úÖ Senhas coincidem: ${hash === hashedPassword}`);\n\n// Test with different common passwords\nconst testPasswords = [\"demo123\", \"123456\", \"password\", \"admin\"];\nfor (const pwd of testPasswords) {\n  const testHash = scryptSync(pwd, salt, 64).toString('hex');\n  console.log(`Testando \"${pwd}\": ${hash === testHash ? \"‚úÖ MATCH\" : \"‚ùå\"}`);\n}","size_bytes":1060},"server/cadastrar-atividades-completas.ts":{"content":"import { db } from \"./db\";\nimport { activities, activityBudgetProposals, activityReviews, destinations } from \"@shared/schema\";\nimport { sql } from \"drizzle-orm\";\n\n// Dados das atividades organizados por cidade\nconst atividadesPorCidade = {\n  \"Rio de Janeiro\": [\n    {\n      title: \"Cristo Redentor / Corcovado\",\n      description: \"Visita ao ic√¥nico Cristo Redentor no topo do Corcovado, uma das sete maravilhas do mundo moderno. Desfrute de vistas panor√¢micas da cidade e ba√≠a de Guanabara.\",\n      category: \"pontos_turisticos\" as const,\n      duration: \"3-4 horas\",\n      cover_image: \"https://images.unsplash.com/photo-1539650116574-75c0c6d15f83?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1539650116574-75c0c6d15f83?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1570715004781-d9c961ba4b22?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { title: \"Econ√¥mico\", price: 85, description: \"Van oficial b√°sica at√© o Cristo\", inclusions: [\"Transporte em van oficial\", \"Entrada no santu√°rio\"] },\n        { title: \"Completo\", price: 160, description: \"Trem panor√¢mico + entrada + guia\", inclusions: [\"Trem do Corcovado\", \"Entrada no santu√°rio\", \"Guia tur√≠stico\", \"Seguro\"] },\n        { title: \"Premium\", price: 320, description: \"Tour privativo com transporte executivo\", inclusions: [\"Transporte privativo\", \"Guia especializado\", \"Fotografias profissionais\", \"Lanche inclu√≠do\"] }\n      ]\n    },\n    {\n      title: \"P√£o de A√ß√∫car (Bondinho)\",\n      description: \"Passeio no famoso bondinho do P√£o de A√ß√∫car com vistas espetaculares da cidade, ba√≠a e praias. Inclui parada na Urca e no topo do P√£o de A√ß√∫car.\",\n      category: \"pontos_turisticos\" as const,\n      duration: \"2-3 horas\",\n      cover_image: \"https://images.unsplash.com/photo-1544737151-6e4b9ee48424?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1544737151-6e4b9ee48424?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1483729558449-99ef09a8c325?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { title: \"Econ√¥mico\", price: 120, description: \"Ingresso padr√£o do bondinho\", inclusions: [\"Bondinho ida e volta\", \"Acesso aos mirantes\"] },\n        { title: \"Completo\", price: 190, description: \"Bondinho + guia tur√≠stico\", inclusions: [\"Bondinho ida e volta\", \"Guia especializado\", \"Hist√≥ria e curiosidades\"] },\n        { title: \"Premium\", price: 350, description: \"Bondinho + tour + passeio de helic√≥ptero\", inclusions: [\"Bondinho\", \"Guia VIP\", \"Sobrevoo de helic√≥ptero\", \"Drinks no topo\"] }\n      ]\n    },\n    {\n      title: \"Praias de Copacabana e Ipanema + Esportes\",\n      description: \"Experi√™ncia completa nas praias mais famosas do mundo. Atividades aqu√°ticas, esportes na areia e cultura carioca.\",\n      category: \"water_sports\" as const,\n      duration: \"Dia inteiro\",\n      cover_image: \"https://images.unsplash.com/photo-1544077960-604201fe74bc?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1544077960-604201fe74bc?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { title: \"Econ√¥mico\", price: 0, description: \"Acesso livre √†s praias\", inclusions: [\"Acesso livre\", \"Caminhada guiada\", \"Dicas locais\"] },\n        { title: \"Completo\", price: 100, description: \"Aula de surf ou aluguel de bike\", inclusions: [\"Aula de surf (2h)\", \"Ou aluguel de bike\", \"Equipamentos inclu√≠dos\"] },\n        { title: \"Premium\", price: 300, description: \"Passeio de lancha com drinks\", inclusions: [\"Passeio de lancha\", \"Open bar\", \"Petiscos\", \"Equipamentos aqu√°ticos\"] }\n      ]\n    },\n    {\n      title: \"Trilha Pedra Bonita ou Dois Irm√£os\",\n      description: \"Trilhas com as melhores vistas panor√¢micas do Rio. Ideal para amantes da natureza e fotografia.\",\n      category: \"hiking\" as const,\n      duration: \"4-6 horas\",\n      cover_image: \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1624393188128-2e7e06c5b5e5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { title: \"Econ√¥mico\", price: 0, description: \"Trilha autoguiada\", inclusions: [\"Mapa da trilha\", \"Dicas de seguran√ßa\"] },\n        { title: \"Completo\", price: 100, description: \"Trilha com guia local\", inclusions: [\"Guia especializado\", \"Kit primeiros socorros\", \"√Ågua\"] },\n        { title: \"Premium\", price: 280, description: \"Tour privado com transporte\", inclusions: [\"Transporte ida/volta\", \"Guia fot√≥grafo\", \"Lanche trilheiro\", \"Seguro\"] }\n      ]\n    },\n    {\n      title: \"Tour Cultural Centro Hist√≥rico\",\n      description: \"Descubra a hist√≥ria do Rio visitando o Theatro Municipal, Museu do Amanh√£ e outros pontos culturais importantes.\",\n      category: \"cultural\" as const,\n      duration: \"4-5 horas\",\n      cover_image: \"https://images.unsplash.com/photo-1539037116277-4db20889f2d4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1539037116277-4db20889f2d4?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1586711980919-5d4bb5be2ecf?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { title: \"Econ√¥mico\", price: 30, description: \"Ingressos b√°sicos\", inclusions: [\"Entrada museus\", \"Mapa autoguiado\"] },\n        { title: \"Completo\", price: 90, description: \"Tour guiado + transporte\", inclusions: [\"Guia especializado\", \"Transporte\", \"Ingressos inclu√≠dos\"] },\n        { title: \"Premium\", price: 220, description: \"Tour VIP + jantar + transporte executivo\", inclusions: [\"Guia VIP\", \"Transporte executivo\", \"Jantar t√≠pico\", \"Bebidas inclu√≠das\"] }\n      ]\n    }\n  ],\n\n  \"S√£o Paulo\": [\n    {\n      title: \"MASP + Avenida Paulista\",\n      description: \"Visite o ic√¥nico Museu de Arte de S√£o Paulo e explore a Avenida Paulista, cora√ß√£o cultural e financeiro da cidade.\",\n      category: \"cultural\" as const,\n      duration: \"3-4 horas\",\n      cover_image: \"https://images.unsplash.com/photo-1564688169631-7e9e0b8f33a2?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1564688169631-7e9e0b8f33a2?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { title: \"Econ√¥mico\", price: 40, description: \"Entrada simples no MASP\", inclusions: [\"Ingresso MASP\", \"Mapa da Paulista\"] },\n        { title: \"Completo\", price: 90, description: \"Visita guiada + caf√©\", inclusions: [\"Visita guiada\", \"Caf√© incluso\", \"Material informativo\"] },\n        { title: \"Premium\", price: 250, description: \"Tour + almo√ßo em rooftop\", inclusions: [\"Tour VIP\", \"Almo√ßo panor√¢mico\", \"Transporte\", \"Bebidas\"] }\n      ]\n    },\n    {\n      title: \"Parque Ibirapuera + Museus\",\n      description: \"Explore o principal parque urbano de S√£o Paulo e seus museus: MAM, Museu Afro Brasil e outros espa√ßos culturais.\",\n      category: \"cultural\" as const,\n      duration: \"Dia inteiro\",\n      cover_image: \"https://images.unsplash.com/photo-1596445827019-ab19d12cc2ef?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1596445827019-ab19d12cc2ef?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1542702200-c5b01e0c3ea8?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { title: \"Econ√¥mico\", price: 0, description: \"Acesso livre ao parque\", inclusions: [\"Caminhada livre\", \"Mapa do parque\"] },\n        { title: \"Completo\", price: 70, description: \"Bike + ingressos museus\", inclusions: [\"Aluguel de bike (4h)\", \"Ingressos museus\", \"Kit lanche\"] },\n        { title: \"Premium\", price: 180, description: \"Tour guiado + transporte\", inclusions: [\"Guia especializado\", \"Transporte\", \"Todos os museus\", \"Almo√ßo\"] }\n      ]\n    },\n    {\n      title: \"Mercado Municipal + Centro Hist√≥rico\",\n      description: \"Degusta√ß√£o gastron√¥mica no famoso Mercad√£o e tour pelo centro hist√≥rico de S√£o Paulo.\",\n      category: \"food_tours\" as const,\n      duration: \"4-5 horas\",\n      cover_image: \"https://images.unsplash.com/photo-1566740933430-b5e70b06d2d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1566740933430-b5e70b06d2d5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1560472354-b33ff0c44a43?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { title: \"Econ√¥mico\", price: 0, description: \"Visita por conta pr√≥pria\", inclusions: [\"Roteiro sugerido\", \"Dicas gastron√¥micas\"] },\n        { title: \"Completo\", price: 90, description: \"Tour guiado com degusta√ß√£o\", inclusions: [\"Guia gastron√¥mico\", \"Degusta√ß√µes inclu√≠das\", \"Hist√≥ria local\"] },\n        { title: \"Premium\", price: 240, description: \"Tour gastron√¥mico VIP + transporte\", inclusions: [\"Guia chef\", \"Degusta√ß√µes premium\", \"Transporte\", \"Bebidas harmonizadas\"] }\n      ]\n    },\n    {\n      title: \"Beco do Batman + Vila Madalena\",\n      description: \"Tour pela arte urbana no famoso Beco do Batman e explora√ß√£o do bairro bo√™mio da Vila Madalena.\",\n      category: \"cultural\" as const,\n      duration: \"3-4 horas\",\n      cover_image: \"https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1580651214613-ff345e7e3c0f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { title: \"Econ√¥mico\", price: 0, description: \"Visita livre\", inclusions: [\"Acesso livre\", \"Mapa da regi√£o\"] },\n        { title: \"Completo\", price: 70, description: \"Tour com artista de rua\", inclusions: [\"Guia artista local\", \"Hist√≥ria do grafite\", \"Workshop b√°sico\"] },\n        { title: \"Premium\", price: 220, description: \"Tour art√≠stico + bar tem√°tico\", inclusions: [\"Guia especializado\", \"Workshop avan√ßado\", \"Drinks em bar tem√°tico\", \"Kit arte\"] }\n      ]\n    },\n    {\n      title: \"Noite em Rooftop / Jantar Gourmet\",\n      description: \"Experi√™ncia gastron√¥mica em rooftops com vista panor√¢mica da cidade e culin√°ria de alta qualidade.\",\n      category: \"food_tours\" as const,\n      duration: \"3-4 horas\",\n      cover_image: \"https://images.unsplash.com/photo-1574096079513-d8259312b785?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1574096079513-d8259312b785?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1615719413546-198b25453f85?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { title: \"Econ√¥mico\", price: 50, description: \"Entrada em bar\", inclusions: [\"Entrada bar/rooftop\", \"1 drink inclu√≠do\"] },\n        { title: \"Completo\", price: 150, description: \"Drinks + petiscos\", inclusions: [\"2 drinks premium\", \"Petiscos gourmet\", \"Vista garantida\"] },\n        { title: \"Premium\", price: 400, description: \"Jantar completo com vista\", inclusions: [\"Menu degusta√ß√£o\", \"Harmoniza√ß√£o vinhos\", \"Mesa premium\", \"Transporte\"] }\n      ]\n    }\n  ],\n\n  // Continuar com as outras cidades...\n  \"Foz do Igua√ßu\": [\n    {\n      title: \"Cataratas do Igua√ßu (lado brasileiro)\",\n      description: \"Uma das mais impressionantes quedas d'√°gua do mundo. Vista panor√¢mica das 275 quedas d'√°gua na fronteira Brasil-Argentina.\",\n      category: \"nature\" as const,\n      duration: \"Dia inteiro\",\n      cover_image: \"https://images.unsplash.com/photo-1520637836862-4d197d17c86a?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1520637836862-4d197d17c86a?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1611273426858-450d8e3c9fce?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { title: \"Econ√¥mico\", price: 85, description: \"Entrada no parque nacional\", inclusions: [\"Entrada no parque\", \"Trilha das cataratas\", \"Transporte interno\"] },\n        { title: \"Completo\", price: 160, description: \"Parque + transporte\", inclusions: [\"Entrada parque\", \"Transporte hotel-parque\", \"Guia b√°sico\"] },\n        { title: \"Premium\", price: 350, description: \"Tour completo + Macuco Safari\", inclusions: [\"Entrada parque\", \"Macuco Safari\", \"Almo√ßo\", \"Transporte\", \"Guia especializado\"] }\n      ]\n    },\n    {\n      title: \"Parque das Aves\",\n      description: \"Santu√°rio de aves da Mata Atl√¢ntica com mais de 1.320 aves de 143 esp√©cies. Experi√™ncia imersiva √∫nica na Am√©rica Latina.\",\n      category: \"wildlife\" as const,\n      duration: \"3-4 horas\",\n      cover_image: \"https://images.unsplash.com/photo-1574263867128-ba1b540c5dd7?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1574263867128-ba1b540c5dd7?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1603112356844-8b4b5d5c7362?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { title: \"Econ√¥mico\", price: 90, description: \"Ingresso padr√£o\", inclusions: [\"Entrada no parque\", \"Trilhas livres\", \"Mapa do local\"] },\n        { title: \"Completo\", price: 140, description: \"Ingresso + traslado\", inclusions: [\"Entrada\", \"Transporte hotel-parque\", \"Audio guide\"] },\n        { title: \"Premium\", price: 250, description: \"Visita guiada + bastidores\", inclusions: [\"Entrada VIP\", \"Tour dos bastidores\", \"Encontro com tratadores\", \"Transporte\"] }\n      ]\n    }\n  ]\n};\n\n// Dados dos reviews\nconst reviewsExemplo = [\n  {\n    rating: 5,\n    review: \"Experi√™ncia incr√≠vel! Vale muito a pena, vista espetacular e atendimento excelente.\",\n    photos: [\"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=400\"],\n    visit_date: new Date(\"2024-12-15\"),\n  },\n  {\n    rating: 4,\n    review: \"Muito bom! A √∫nica observa√ß√£o √© que estava bem cheio, mas mesmo assim recomendo.\",\n    photos: [],\n    visit_date: new Date(\"2024-12-10\"),\n  },\n  {\n    rating: 5,\n    review: \"Perfeito! Superou todas as expectativas. O guia foi muito atencioso e conhecia bem a hist√≥ria local.\",\n    photos: [\"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=400\"],\n    visit_date: new Date(\"2024-12-08\"),\n  }\n];\n\nasync function cadastrarAtividades() {\n  try {\n    console.log(\"üèÉ‚Äç‚ôÇÔ∏è Iniciando cadastro de atividades...\");\n\n    // Buscar destinos existentes\n    const destinos = await db.select().from(destinations);\n    console.log(`üìç Encontrados ${destinos.length} destinos ativos`);\n\n    let totalAtividades = 0;\n    let totalPropostas = 0;\n    let totalReviews = 0;\n\n    for (const [nomeCidade, atividades] of Object.entries(atividadesPorCidade)) {\n      console.log(`\\nüèôÔ∏è Processando ${nomeCidade}...`);\n      \n      // Encontrar o destino correspondente\n      const destino = destinos.find(d => \n        d.name?.toLowerCase().includes(nomeCidade.toLowerCase()) ||\n        (nomeCidade === \"Rio de Janeiro\" && d.name?.toLowerCase().includes(\"rio\")) ||\n        (nomeCidade === \"S√£o Paulo\" && d.name?.toLowerCase().includes(\"s√£o paulo\")) ||\n        (nomeCidade === \"Foz do Igua√ßu\" && d.name?.toLowerCase().includes(\"foz\"))\n      );\n\n      if (!destino) {\n        console.log(`‚ùå Destino n√£o encontrado para ${nomeCidade}`);\n        continue;\n      }\n\n      console.log(`‚úÖ Destino encontrado: ${destino.name} (ID: ${destino.id})`);\n\n      for (const atividade of atividades) {\n        try {\n          // Inserir atividade\n          const [atividadeInserida] = await db.insert(activities).values({\n            title: atividade.title,\n            description: atividade.description,\n            destination_id: destino.id,\n            category: atividade.category,\n            difficulty_level: \"easy\",\n            duration: atividade.duration,\n            min_participants: 1,\n            max_participants: 20,\n            languages: [\"Portugu√™s\", \"Ingl√™s\"],\n            inclusions: [\"Acompanhamento profissional\", \"Seguro b√°sico\"],\n            exclusions: [\"Alimenta√ß√£o\", \"Transporte pessoal\"],\n            requirements: [\"Idade m√≠nima: 12 anos\"],\n            cancellation_policy: \"Cancelamento gratuito at√© 24h antes\",\n            contact_info: {\n              email: \"contato@partiutrip.com\",\n              phone: \"+55 11 99999-9999\",\n              whatsapp: \"+55 11 99999-9999\"\n            },\n            cover_image: atividade.cover_image,\n            images: atividade.images,\n            created_by_id: 9, // Usando o usu√°rio admin tom\n            is_active: true,\n            // Campos herdados do destino\n            destination_name: destino.name,\n            city: destino.name, // destinations n√£o tem campo city separado\n            state: destino.state,\n            country: destino.country,\n            country_type: destino.country_type as \"nacional\" | \"internacional\",\n            region: destino.region,\n            continent: destino.continent\n          }).returning();\n\n          console.log(`  ‚úÖ Atividade inserida: ${atividade.title} (ID: ${atividadeInserida.id})`);\n          totalAtividades++;\n\n          // Inserir propostas de or√ßamento\n          for (const proposta of atividade.propostas) {\n            await db.insert(activityBudgetProposals).values({\n              activity_id: atividadeInserida.id,\n              created_by: 9,\n              title: proposta.title,\n              description: proposta.description,\n              price_type: \"per_person\",\n              amount: proposta.price.toString(),\n              currency: \"BRL\",\n              inclusions: proposta.inclusions,\n              exclusions: [\"Despesas pessoais\", \"Gorjetas\"],\n              is_active: true,\n              votes: Math.floor(Math.random() * 50) + 10 // 10-60 votos aleat√≥rios\n            });\n            totalPropostas++;\n          }\n\n          // Inserir reviews de exemplo\n          for (const review of reviewsExemplo) {\n            await db.insert(activityReviews).values({\n              activity_id: atividadeInserida.id,\n              user_id: 9, // Usu√°rio tom\n              rating: review.rating,\n              review: review.review,\n              photos: review.photos,\n              visit_date: review.visit_date,\n              helpful_votes: Math.floor(Math.random() * 15) + 1,\n              is_verified: true\n            });\n            totalReviews++;\n          }\n\n          // Atualizar contadores da atividade usando eq\n          await db.update(activities)\n            .set({\n              average_rating: \"4.7\",\n              total_ratings: 3\n            })\n            .where(sql`id = ${atividadeInserida.id}`);\n\n        } catch (error) {\n          console.error(`‚ùå Erro ao inserir atividade ${atividade.title}:`, error);\n        }\n      }\n    }\n\n    console.log(`\\nüéâ Cadastro conclu√≠do!`);\n    console.log(`üìä Resumo:`);\n    console.log(`   ‚Ä¢ ${totalAtividades} atividades cadastradas`);\n    console.log(`   ‚Ä¢ ${totalPropostas} propostas de or√ßamento criadas`);\n    console.log(`   ‚Ä¢ ${totalReviews} reviews adicionados`);\n\n  } catch (error) {\n    console.error(\"‚ùå Erro durante o cadastro:\", error);\n  }\n}\n\n// Executar o script\ncadastrarAtividades();","size_bytes":19942},"server/destinations-api.ts":{"content":"import { db } from \"./db\";\nimport { destinations } from \"../shared/schema\";\nimport { eq } from \"drizzle-orm\";\n\n/**\n * API endpoint to get all available destinations\n */\nexport async function getAllDestinations() {\n  return await db\n    .select()\n    .from(destinations)\n    .where(eq(destinations.is_active, true))\n    .orderBy(destinations.name);\n}\n\n/**\n * API endpoint to get destination by ID\n */\nexport async function getDestinationById(id: number) {\n  const destination = await db\n    .select()\n    .from(destinations)\n    .where(eq(destinations.id, id))\n    .limit(1);\n\n  return destination.length > 0 ? destination[0] : null;\n}","size_bytes":634},"server/migrate-existing-activities.ts":{"content":"import { db } from \"./db\";\nimport { activities, destinations } from \"../shared/schema\";\nimport { eq } from \"drizzle-orm\";\n\nasync function migrateExistingActivities() {\n  console.log(\"üîÑ Migrando atividades existentes para usar destination_id...\");\n\n  try {\n    // Get activities without destination_id\n    const activitiesWithoutDestination = await db\n      .select()\n      .from(activities)\n      .where(eq(activities.destination_id, null));\n\n    console.log(`üìã Encontradas ${activitiesWithoutDestination.length} atividades para migrar`);\n\n    for (const activity of activitiesWithoutDestination) {\n      let destinationId: number | null = null;\n\n      // Try to match by city name\n      if (activity.city) {\n        const matchingDestinations = await db\n          .select()\n          .from(destinations)\n          .where(eq(destinations.name, activity.city));\n\n        if (matchingDestinations.length > 0) {\n          destinationId = matchingDestinations[0].id;\n          console.log(`‚úÖ Atividade \"${activity.title}\" vinculada ao destino \"${matchingDestinations[0].name}\" (ID: ${destinationId})`);\n        }\n      }\n\n      // If no match found by city, try by destination_name\n      if (!destinationId && activity.destination_name) {\n        const matchingDestinations = await db\n          .select()\n          .from(destinations)\n          .where(eq(destinations.name, activity.destination_name));\n\n        if (matchingDestinations.length > 0) {\n          destinationId = matchingDestinations[0].id;\n          console.log(`‚úÖ Atividade \"${activity.title}\" vinculada ao destino \"${matchingDestinations[0].name}\" (ID: ${destinationId})`);\n        }\n      }\n\n      // If still no match, try partial matches\n      if (!destinationId) {\n        const cityToSearch = activity.city || activity.destination_name;\n        if (cityToSearch) {\n          const allDestinations = await db.select().from(destinations);\n          const fuzzyMatch = allDestinations.find(dest => \n            dest.name.toLowerCase().includes(cityToSearch.toLowerCase()) ||\n            cityToSearch.toLowerCase().includes(dest.name.toLowerCase())\n          );\n\n          if (fuzzyMatch) {\n            destinationId = fuzzyMatch.id;\n            console.log(`üîç Atividade \"${activity.title}\" vinculada por match parcial ao destino \"${fuzzyMatch.name}\" (ID: ${destinationId})`);\n          }\n        }\n      }\n\n      // Update activity with destination_id and inherited fields\n      if (destinationId) {\n        const { getDestinationForActivity } = await import(\"./activity-destination-helper\");\n        const destinationFields = await getDestinationForActivity(destinationId);\n\n        await db\n          .update(activities)\n          .set(destinationFields)\n          .where(eq(activities.id, activity.id));\n\n        console.log(`‚úÖ Atividade ${activity.id} atualizada com dados do destino`);\n      } else {\n        console.log(`‚ö†Ô∏è N√£o foi poss√≠vel encontrar destino para a atividade \"${activity.title}\" (cidade: ${activity.city}, destino: ${activity.destination_name})`);\n      }\n    }\n\n    console.log(\"‚úÖ Migra√ß√£o das atividades conclu√≠da!\");\n\n  } catch (error) {\n    console.error(\"‚ùå Erro na migra√ß√£o:\", error);\n  }\n\n  process.exit(0);\n}\n\nmigrateExistingActivities();","size_bytes":3263},"server/seed-atividades-completo.ts":{"content":"import { drizzle } from \"drizzle-orm/postgres-js\";\nimport postgres from \"postgres\";\nimport { activities, activityBudgetProposals, activityReviews, destinations } from \"@shared/schema\";\nimport dotenv from \"dotenv\";\nimport { eq } from \"drizzle-orm\";\n\n// Usar a mesma configura√ß√£o do servidor que j√° est√° funcionando\nimport { db } from \"./db\";\nimport { sql as drizzleSql } from \"drizzle-orm\";\n\n// Dados das atividades organizados por destino\nconst atividadesPorDestino = {\n  \"Rio de Janeiro\": [\n    {\n      title: \"Cristo Redentor / Corcovado\",\n      description: \"Visita ao ic√¥nico Cristo Redentor no topo do Corcovado, uma das sete maravilhas do mundo moderno. Desfrute de vistas panor√¢micas espetaculares da cidade e ba√≠a de Guanabara.\",\n      category: \"pontos_turisticos\" as const,\n      duration: \"3-4 horas\",\n      cover_image: \"https://images.unsplash.com/photo-1539650116574-75c0c6d15f83?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1539650116574-75c0c6d15f83?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1570715004781-d9c961ba4b22?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { \n          title: \"Econ√¥mico\", \n          price: 85, \n          description: \"Van oficial b√°sica at√© o Cristo Redentor\", \n          inclusions: [\"Transporte em van oficial\", \"Entrada no santu√°rio\", \"Seguro b√°sico\"] \n        },\n        { \n          title: \"Completo\", \n          price: 160, \n          description: \"Trem panor√¢mico + entrada + guia tur√≠stico\", \n          inclusions: [\"Trem do Corcovado\", \"Entrada no santu√°rio\", \"Guia tur√≠stico certificado\", \"Seguro completo\"] \n        },\n        { \n          title: \"Premium\", \n          price: 320, \n          description: \"Tour privativo com transporte executivo\", \n          inclusions: [\"Transporte privativo\", \"Guia especializado\", \"Fotografias profissionais\", \"Lanche gourmet\", \"Acesso VIP\"] \n        }\n      ]\n    },\n    {\n      title: \"P√£o de A√ß√∫car (Bondinho)\",\n      description: \"Passeio no famoso bondinho do P√£o de A√ß√∫car com vistas espetaculares de 360¬∞ da cidade, ba√≠a de Guanabara e praias. Inclui parada na Urca e no topo do P√£o de A√ß√∫car.\",\n      category: \"pontos_turisticos\" as const,\n      duration: \"2-3 horas\",\n      cover_image: \"https://images.unsplash.com/photo-1544737151-6e4b9ee48424?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1544737151-6e4b9ee48424?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1483729558449-99ef09a8c325?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { \n          title: \"Econ√¥mico\", \n          price: 120, \n          description: \"Ingresso padr√£o do bondinho\", \n          inclusions: [\"Bondinho ida e volta\", \"Acesso aos mirantes\", \"Mapa tur√≠stico\"] \n        },\n        { \n          title: \"Completo\", \n          price: 190, \n          description: \"Bondinho + guia tur√≠stico especializado\", \n          inclusions: [\"Bondinho ida e volta\", \"Guia especializado\", \"Hist√≥ria e curiosidades\", \"Kit fotogr√°fico\"] \n        },\n        { \n          title: \"Premium\", \n          price: 350, \n          description: \"Bondinho + tour + passeio de helic√≥ptero\", \n          inclusions: [\"Bondinho\", \"Guia VIP\", \"Sobrevoo de helic√≥ptero (15min)\", \"Drinks premium no topo\", \"Certificado da experi√™ncia\"] \n        }\n      ]\n    },\n    {\n      title: \"Praias de Copacabana e Ipanema + Esportes\",\n      description: \"Experi√™ncia completa nas praias mais famosas do mundo. Atividades aqu√°ticas, esportes na areia, cultura carioca e o melhor do estilo de vida da Cidade Maravilhosa.\",\n      category: \"water_sports\" as const,\n      duration: \"Dia inteiro\",\n      cover_image: \"https://images.unsplash.com/photo-1544077960-604201fe74bc?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1544077960-604201fe74bc?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { \n          title: \"Econ√¥mico\", \n          price: 0, \n          description: \"Acesso livre √†s praias com caminhada guiada\", \n          inclusions: [\"Acesso livre √†s praias\", \"Caminhada guiada\", \"Dicas locais\", \"Mapa das praias\"] \n        },\n        { \n          title: \"Completo\", \n          price: 100, \n          description: \"Aula de surf ou aluguel de bike + equipamentos\", \n          inclusions: [\"Aula de surf (2h) OU aluguel de bike\", \"Equipamentos inclu√≠dos\", \"Instrutor certificado\", \"√Ågua e lanche\"] \n        },\n        { \n          title: \"Premium\", \n          price: 300, \n          description: \"Passeio de lancha com open bar e atividades\", \n          inclusions: [\"Passeio de lancha (3h)\", \"Open bar premium\", \"Petiscos gourmet\", \"Equipamentos aqu√°ticos\", \"M√∫sica ambiente\"] \n        }\n      ]\n    },\n    {\n      title: \"Trilha Pedra Bonita ou Dois Irm√£os\",\n      description: \"Trilhas com as melhores vistas panor√¢micas do Rio de Janeiro. Ideal para amantes da natureza, fotografia e aventura. Diferentes n√≠veis de dificuldade dispon√≠veis.\",\n      category: \"hiking\" as const,\n      duration: \"4-6 horas\",\n      cover_image: \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1516306580123-e6e52b1b7b5f?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1624393188128-2e7e06c5b5e5?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { \n          title: \"Econ√¥mico\", \n          price: 0, \n          description: \"Trilha autoguiada com mapa e dicas\", \n          inclusions: [\"Mapa detalhado da trilha\", \"Dicas de seguran√ßa\", \"Lista de equipamentos\", \"Contato de emerg√™ncia\"] \n        },\n        { \n          title: \"Completo\", \n          price: 100, \n          description: \"Trilha com guia local experiente\", \n          inclusions: [\"Guia especializado\", \"Kit primeiros socorros\", \"√Ågua mineral\", \"Bast√µes de caminhada\", \"Certificado de conclus√£o\"] \n        },\n        { \n          title: \"Premium\", \n          price: 280, \n          description: \"Tour privado com transporte e fot√≥grafo\", \n          inclusions: [\"Transporte ida/volta\", \"Guia fot√≥grafo profissional\", \"Lanche trilheiro premium\", \"Seguro aventura\", \"Fotos editadas\"] \n        }\n      ]\n    },\n    {\n      title: \"Tour Cultural Centro Hist√≥rico\",\n      description: \"Descubra a rica hist√≥ria do Rio visitando o Theatro Municipal, Museu do Amanh√£, Centro Cultural dos Correios e outros marcos culturais. Mergulhe na cultura carioca.\",\n      category: \"cultural\" as const,\n      duration: \"4-5 horas\",\n      cover_image: \"https://images.unsplash.com/photo-1539037116277-4db20889f2d4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1539037116277-4db20889f2d4?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1586711980919-5d4bb5be2ecf?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { \n          title: \"Econ√¥mico\", \n          price: 30, \n          description: \"Ingressos b√°sicos com mapa autoguiado\", \n          inclusions: [\"Entrada nos principais museus\", \"Mapa autoguiado\", \"Lista de pontos tur√≠sticos\"] \n        },\n        { \n          title: \"Completo\", \n          price: 90, \n          description: \"Tour guiado + transporte p√∫blico\", \n          inclusions: [\"Guia especializado em hist√≥ria\", \"Transporte p√∫blico inclu√≠do\", \"Ingressos inclu√≠dos\", \"Material educativo\"] \n        },\n        { \n          title: \"Premium\", \n          price: 220, \n          description: \"Tour VIP + jantar + transporte executivo\", \n          inclusions: [\"Guia VIP\", \"Transporte executivo\", \"Jantar t√≠pico no centro\", \"Bebidas inclu√≠das\", \"Acesso a √°reas restritas\"] \n        }\n      ]\n    }\n  ],\n\n  \"S√£o Paulo\": [\n    {\n      title: \"MASP + Avenida Paulista\",\n      description: \"Visite o ic√¥nico Museu de Arte de S√£o Paulo e explore a Avenida Paulista, cora√ß√£o cultural e financeiro da maior metr√≥pole da Am√©rica do Sul. Arte, cultura e arquitetura.\",\n      category: \"cultural\" as const,\n      duration: \"3-4 horas\",\n      cover_image: \"https://images.unsplash.com/photo-1564688169631-7e9e0b8f33a2?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1564688169631-7e9e0b8f33a2?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1578662996442-48f60103fc96?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { \n          title: \"Econ√¥mico\", \n          price: 40, \n          description: \"Entrada simples no MASP + mapa da Paulista\", \n          inclusions: [\"Ingresso MASP\", \"Mapa da Avenida Paulista\", \"Roteiro autoguiado\"] \n        },\n        { \n          title: \"Completo\", \n          price: 90, \n          description: \"Visita guiada + caf√© com vista\", \n          inclusions: [\"Visita guiada especializada\", \"Caf√© com vista na Paulista\", \"Material informativo\", \"Transporte p√∫blico\"] \n        },\n        { \n          title: \"Premium\", \n          price: 250, \n          description: \"Tour VIP + almo√ßo em rooftop panor√¢mico\", \n          inclusions: [\"Tour VIP exclusivo\", \"Almo√ßo panor√¢mico em rooftop\", \"Transporte executivo\", \"Bebidas premium\", \"Acesso a cole√ß√µes especiais\"] \n        }\n      ]\n    },\n    {\n      title: \"Parque Ibirapuera + Museus\",\n      description: \"Explore o principal parque urbano de S√£o Paulo e seus renomados museus: MAM, Museu Afro Brasil, Oca e outros espa√ßos culturais em meio √† natureza da cidade.\",\n      category: \"cultural\" as const,\n      duration: \"Dia inteiro\",\n      cover_image: \"https://images.unsplash.com/photo-1596445827019-ab19d12cc2ef?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1596445827019-ab19d12cc2ef?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1542702200-c5b01e0c3ea8?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { \n          title: \"Econ√¥mico\", \n          price: 0, \n          description: \"Acesso livre ao parque com mapa\", \n          inclusions: [\"Caminhada livre pelo parque\", \"Mapa detalhado\", \"Roteiro dos museus\"] \n        },\n        { \n          title: \"Completo\", \n          price: 70, \n          description: \"Bike + ingressos museus + kit lanche\", \n          inclusions: [\"Aluguel de bike (4h)\", \"Ingressos para 3 museus\", \"Kit lanche\", \"Capacete e seguran√ßa\"] \n        },\n        { \n          title: \"Premium\", \n          price: 180, \n          description: \"Tour guiado completo + transporte + almo√ßo\", \n          inclusions: [\"Guia especializado\", \"Transporte confort√°vel\", \"Todos os museus inclu√≠dos\", \"Almo√ßo no parque\", \"Material educativo\"] \n        }\n      ]\n    }\n  ],\n\n  \"Foz do Igua√ßu\": [\n    {\n      title: \"Cataratas do Igua√ßu (lado brasileiro)\",\n      description: \"Uma das mais impressionantes quedas d'√°gua do mundo com 275 quedas d'√°gua na fronteira Brasil-Argentina. Patrim√¥nio Mundial da UNESCO e espet√°culo natural √∫nico.\",\n      category: \"nature\" as const,\n      duration: \"Dia inteiro\",\n      cover_image: \"https://images.unsplash.com/photo-1520637836862-4d197d17c86a?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000\",\n      images: [\n        \"https://images.unsplash.com/photo-1520637836862-4d197d17c86a?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\",\n        \"https://images.unsplash.com/photo-1611273426858-450d8e3c9fce?ixlib=rb-4.0.3&auto=format&fit=crop&w=800\"\n      ],\n      propostas: [\n        { \n          title: \"Econ√¥mico\", \n          price: 85, \n          description: \"Entrada no parque nacional\", \n          inclusions: [\"Entrada no Parque Nacional\", \"Trilha das Cataratas\", \"Transporte interno gratuito\", \"Mapa do parque\"] \n        },\n        { \n          title: \"Completo\", \n          price: 160, \n          description: \"Parque + transporte hotel + guia\", \n          inclusions: [\"Entrada no parque\", \"Transporte hotel-parque\", \"Guia b√°sico\", \"Lanche inclu√≠do\"] \n        },\n        { \n          title: \"Premium\", \n          price: 350, \n          description: \"Tour completo + Macuco Safari + almo√ßo\", \n          inclusions: [\"Entrada no parque\", \"Macuco Safari aventura\", \"Almo√ßo no parque\", \"Transporte executivo\", \"Guia especializado\", \"Fotos profissionais\"] \n        }\n      ]\n    }\n  ]\n};\n\n// Dados de reviews exemplo para cada atividade\nconst reviewsExemplo = [\n  {\n    rating: 5,\n    review: \"Experi√™ncia incr√≠vel! Vista espetacular e atendimento excepcional. Vale muito a pena e recomendo para todos que visitarem.\",\n    photos: [\"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=400\"],\n    visit_date: new Date(\"2024-12-15\"),\n  },\n  {\n    rating: 4,\n    review: \"Muito bom! A √∫nica observa√ß√£o √© que estava bem cheio, mas mesmo assim a experi√™ncia foi fant√°stica e vale a pena.\",\n    photos: [],\n    visit_date: new Date(\"2024-12-10\"),\n  },\n  {\n    rating: 5,\n    review: \"Perfeito! Superou todas as expectativas. O guia foi muito atencioso e conhecia bem a hist√≥ria local. Voltarei com certeza!\",\n    photos: [\"https://images.unsplash.com/photo-1518837695005-2083093ee35b?ixlib=rb-4.0.3&auto=format&fit=crop&w=400\"],\n    visit_date: new Date(\"2024-12-08\"),\n  }\n];\n\nasync function cadastrarAtividades() {\n  try {\n    console.log(\"üèÉ‚Äç‚ôÇÔ∏è Iniciando cadastro completo de atividades...\");\n\n    // Buscar destinos existentes\n    const destinos = await db.select().from(destinations);\n    console.log(`üìç Encontrados ${destinos.length} destinos dispon√≠veis`);\n\n    let totalAtividades = 0;\n    let totalPropostas = 0;\n    let totalReviews = 0;\n\n    for (const [nomeDestino, atividades] of Object.entries(atividadesPorDestino)) {\n      console.log(`\\nüèôÔ∏è Processando ${nomeDestino}...`);\n      \n      // Encontrar o destino correspondente\n      const destino = destinos.find(d => \n        d.name?.toLowerCase().includes(nomeDestino.toLowerCase()) ||\n        (nomeDestino === \"Rio de Janeiro\" && d.name?.toLowerCase().includes(\"rio\")) ||\n        (nomeDestino === \"S√£o Paulo\" && d.name?.toLowerCase().includes(\"s√£o paulo\")) ||\n        (nomeDestino === \"Foz do Igua√ßu\" && d.name?.toLowerCase().includes(\"foz\"))\n      );\n\n      if (!destino) {\n        console.log(`‚ùå Destino n√£o encontrado para ${nomeDestino}`);\n        continue;\n      }\n\n      console.log(`‚úÖ Destino encontrado: ${destino.name} (ID: ${destino.id})`);\n\n      for (const atividade of atividades) {\n        try {\n          // Inserir atividade\n          const [atividadeInserida] = await db.insert(activities).values({\n            title: atividade.title,\n            description: atividade.description,\n            destination_id: destino.id,\n            category: atividade.category,\n            difficulty_level: \"easy\",\n            duration: atividade.duration,\n            min_participants: 1,\n            max_participants: 20,\n            languages: [\"Portugu√™s\", \"Ingl√™s\", \"Espanhol\"],\n            inclusions: [\"Acompanhamento profissional\", \"Seguro b√°sico\", \"Suporte 24h\"],\n            exclusions: [\"Alimenta√ß√£o (quando n√£o especificada)\", \"Transporte pessoal\", \"Despesas pessoais\"],\n            requirements: [\"Idade m√≠nima: 12 anos\", \"Condi√ß√£o f√≠sica adequada\"],\n            cancellation_policy: \"Cancelamento gratuito at√© 24h antes da atividade. Reembolso de 50% at√© 12h antes.\",\n            contact_info: {\n              email: \"atividades@partiutrip.com\",\n              phone: \"+55 11 99999-8888\",\n              whatsapp: \"+55 11 99999-8888\",\n              website: \"https://partiutrip.com\"\n            },\n            cover_image: atividade.cover_image,\n            images: atividade.images,\n            created_by_id: 9, // Usu√°rio tom\n            is_active: true,\n            // Campos herdados do destino\n            destination_name: destino.name,\n            city: destino.name,\n            state: destino.state,\n            country: destino.country,\n            country_type: destino.country_type as \"nacional\" | \"internacional\",\n            region: destino.region,\n            continent: destino.continent\n          }).returning();\n\n          console.log(`  ‚úÖ Atividade inserida: ${atividade.title} (ID: ${atividadeInserida.id})`);\n          totalAtividades++;\n\n          // Inserir propostas de or√ßamento\n          for (const proposta of atividade.propostas) {\n            await db.insert(activityBudgetProposals).values({\n              activity_id: atividadeInserida.id,\n              created_by: 9,\n              title: proposta.title,\n              description: proposta.description,\n              price_type: \"per_person\",\n              amount: proposta.price.toString(),\n              currency: \"BRL\",\n              inclusions: proposta.inclusions,\n              exclusions: [\"Despesas pessoais\", \"Gorjetas\", \"Itens n√£o mencionados\"],\n              is_active: true,\n              votes: Math.floor(Math.random() * 50) + 15 // 15-65 votos aleat√≥rios\n            });\n            console.log(`    üí∞ Proposta criada: ${proposta.title} - R$ ${proposta.price}`);\n            totalPropostas++;\n          }\n\n          // Inserir reviews de exemplo\n          for (const review of reviewsExemplo) {\n            await db.insert(activityReviews).values({\n              activity_id: atividadeInserida.id,\n              user_id: 9, // Usu√°rio tom\n              rating: review.rating,\n              review: review.review,\n              photos: review.photos,\n              visit_date: review.visit_date,\n              helpful_votes: Math.floor(Math.random() * 20) + 5,\n              is_verified: true\n            });\n            totalReviews++;\n          }\n          console.log(`    ‚≠ê ${reviewsExemplo.length} reviews adicionados`);\n\n          // Atualizar contadores da atividade\n          await db.update(activities)\n            .set({\n              average_rating: \"4.7\",\n              total_ratings: reviewsExemplo.length\n            })\n            .where(eq(activities.id, atividadeInserida.id));\n\n        } catch (error) {\n          console.error(`‚ùå Erro ao inserir atividade ${atividade.title}:`, error);\n        }\n      }\n    }\n\n    console.log(`\\nüéâ Cadastro conclu√≠do com sucesso!`);\n    console.log(`üìä Resumo final:`);\n    console.log(`   ‚Ä¢ ${totalAtividades} atividades cadastradas`);\n    console.log(`   ‚Ä¢ ${totalPropostas} propostas de or√ßamento criadas`);\n    console.log(`   ‚Ä¢ ${totalReviews} reviews adicionados`);\n    console.log(`   ‚Ä¢ M√©dia de ${(totalPropostas/totalAtividades).toFixed(1)} propostas por atividade`);\n\n  } catch (error) {\n    console.error(\"‚ùå Erro durante o cadastro:\", error);\n  }\n}\n\n// Executar o script\nif (require.main === module) {\n  cadastrarAtividades();\n}\n\nexport { cadastrarAtividades };","size_bytes":19150},"client/src/components/destination-selector.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { MapPin, Search } from \"lucide-react\";\n\ninterface Destination {\n  id: number;\n  name: string;\n  state?: string;\n  country: string;\n  region?: string;\n  continent: string;\n  country_type: \"nacional\" | \"internacional\";\n}\n\ninterface DestinationSelectorProps {\n  value?: number;\n  onChange: (destinationId: number) => void;\n  required?: boolean;\n}\n\nexport function DestinationSelector({ value, onChange, required = false }: DestinationSelectorProps) {\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [selectedDestination, setSelectedDestination] = useState<Destination | null>(null);\n\n  const { data: destinations = [], isLoading } = useQuery<Destination[]>({\n    queryKey: ['/api/destinations'],\n    enabled: true,\n  });\n\n  // Filter destinations based on search term\n  const filteredDestinations = destinations.filter((dest: Destination) =>\n    dest.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    dest.country.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    dest.state?.toLowerCase().includes(searchTerm.toLowerCase()) ||\n    dest.region?.toLowerCase().includes(searchTerm.toLowerCase())\n  );\n\n  // Set selected destination when value changes\n  useEffect(() => {\n    if (value && destinations.length > 0) {\n      const destination = destinations.find((dest: Destination) => dest.id === value);\n      setSelectedDestination(destination || null);\n    }\n  }, [value, destinations]);\n\n  const handleDestinationSelect = (destinationId: string) => {\n    const numericId = parseInt(destinationId);\n    const destination = destinations.find((dest: Destination) => dest.id === numericId);\n    \n    if (destination) {\n      setSelectedDestination(destination);\n      onChange(numericId);\n    }\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-2\">\n        <Label>Destino {required && <span className=\"text-red-500\">*</span>}</Label>\n        <div className=\"flex items-center space-x-2 p-3 border rounded-lg\">\n          <MapPin className=\"h-4 w-4 text-muted-foreground\" />\n          <span className=\"text-muted-foreground\">Carregando destinos...</span>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-2\">\n      <Label>Destino {required && <span className=\"text-red-500\">*</span>}</Label>\n      \n      {selectedDestination ? (\n        <div className=\"space-y-3\">\n          <div className=\"flex items-center space-x-2 p-3 border rounded-lg bg-primary/5\">\n            <MapPin className=\"h-4 w-4 text-primary\" />\n            <div className=\"flex-1\">\n              <div className=\"font-medium\">{selectedDestination.name}</div>\n              <div className=\"text-sm text-muted-foreground\">\n                {selectedDestination.state && `${selectedDestination.state}, `}\n                {selectedDestination.country} ‚Ä¢ {selectedDestination.continent}\n              </div>\n            </div>\n            <Button \n              variant=\"ghost\" \n              size=\"sm\"\n              onClick={() => {\n                setSelectedDestination(null);\n                onChange(0);\n              }}\n            >\n              Alterar\n            </Button>\n          </div>\n        </div>\n      ) : (\n        <div className=\"space-y-3\">\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n            <Input\n              placeholder=\"Buscar destino...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"pl-10\"\n            />\n          </div>\n          \n          <Select value={value?.toString()} onValueChange={handleDestinationSelect}>\n            <SelectTrigger>\n              <SelectValue placeholder=\"Selecione um destino\" />\n            </SelectTrigger>\n            <SelectContent className=\"max-h-60\">\n              {filteredDestinations.length > 0 ? (\n                filteredDestinations.map((destination: Destination) => (\n                  <SelectItem key={destination.id} value={destination.id.toString()}>\n                    <div className=\"flex flex-col\">\n                      <span className=\"font-medium\">{destination.name}</span>\n                      <span className=\"text-xs text-muted-foreground\">\n                        {destination.state && `${destination.state}, `}\n                        {destination.country} ‚Ä¢ {destination.continent}\n                      </span>\n                    </div>\n                  </SelectItem>\n                ))\n              ) : (\n                <SelectItem value=\"\" disabled>\n                  {searchTerm ? \"Nenhum destino encontrado\" : \"Carregando...\"}\n                </SelectItem>\n              )}\n            </SelectContent>\n          </Select>\n        </div>\n      )}\n      \n      {required && !selectedDestination && (\n        <p className=\"text-sm text-red-500\">\n          Destino √© obrigat√≥rio\n        </p>\n      )}\n      \n      <p className=\"text-xs text-muted-foreground\">\n        As atividades s√≥ podem ser criadas em destinos pr√©-cadastrados\n      </p>\n    </div>\n  );\n}","size_bytes":5442},"fix-destination-names.ts":{"content":"import { db } from './server/db.js';\nimport { activities } from './shared/schema.js';\nimport { eq, sql } from 'drizzle-orm';\n\nasync function fixDestinationNames() {\n  console.log('üîß Corrigindo nomes de destinos duplicados...');\n  \n  try {\n    // Mostrar estado atual\n    console.log('\\nüìä Estado atual:');\n    const current = await db\n      .select({\n        destination: activities.destination_name,\n        count: sql`COUNT(*)`\n      })\n      .from(activities)\n      .where(eq(activities.is_active, true))\n      .groupBy(activities.destination_name);\n    \n    current.forEach(item => {\n      console.log(`  ${item.destination}: ${item.count} atividades`);\n    });\n    \n    // Corrigir S√£o Paulo\n    const spResult = await db.update(activities)\n      .set({ destination_name: \"S√£o Paulo\" })\n      .where(eq(activities.destination_name, \"S√£o Paulo, SP\"));\n    console.log(`\\n‚úÖ Corrigido S√£o Paulo, SP -> S√£o Paulo`);\n    \n    // Corrigir Rio de Janeiro\n    const rjResult = await db.update(activities)\n      .set({ destination_name: \"Rio de Janeiro\" })\n      .where(eq(activities.destination_name, \"Rio de Janeiro, RJ\"));\n    console.log(`‚úÖ Corrigido Rio de Janeiro, RJ -> Rio de Janeiro`);\n    \n    // Corrigir Salvador\n    const salResult = await db.update(activities)\n      .set({ destination_name: \"Salvador\" })\n      .where(eq(activities.destination_name, \"Salvador, BA\"));\n    console.log(`‚úÖ Corrigido Salvador, BA -> Salvador`);\n    \n    // Mostrar resultado final\n    console.log('\\nüìà Estado ap√≥s corre√ß√£o:');\n    const final = await db\n      .select({\n        destination: activities.destination_name,\n        count: sql`COUNT(*)`\n      })\n      .from(activities)\n      .where(eq(activities.is_active, true))\n      .groupBy(activities.destination_name);\n    \n    final.forEach(item => {\n      console.log(`  ${item.destination}: ${item.count} atividades`);\n    });\n    \n    console.log('\\n‚úÖ Corre√ß√£o de destinos conclu√≠da!');\n    \n  } catch (error) {\n    console.error('‚ùå Erro ao corrigir destinos:', error);\n  } finally {\n    process.exit(0);\n  }\n}\n\nfixDestinationNames();","size_bytes":2111},"create-comprehensive-trips.ts":{"content":"import postgres from 'postgres';\nimport { config } from 'dotenv';\n\n// Load environment variables\nconfig();\n\nconst sql = postgres(process.env.DATABASE_URL!, {\n  ssl: process.env.DATABASE_URL?.includes('localhost') ? false : 'require'\n});\n\n// Get current date for realistic trip planning\nconst now = new Date();\n\n// Trip data with variety of destinations (national and international)\nconst tripTemplates = [\n  // Nacional - Passadas\n  {\n    title: \"Aventura no Rio de Janeiro\",\n    destination: \"Rio de Janeiro, RJ\",\n    destination_id: 2, // Rio de Janeiro\n    description: \"Exploramos os pontos tur√≠sticos cl√°ssicos do Rio, do Cristo Redentor ao P√£o de A√ß√∫car. Uma viagem inesquec√≠vel!\",\n    start_date: new Date(now.getFullYear(), now.getMonth() - 3, 15), // 3 meses atr√°s\n    end_date: new Date(now.getFullYear(), now.getMonth() - 3, 22),\n    budget: 2500,\n    max_participants: 4,\n    travel_style: \"urbanas\",\n    status: \"completed\"\n  },\n  {\n    title: \"Ecoturismo em Bonito\",\n    destination: \"Bonito, MS\",\n    destination_id: 4, // Bonito\n    description: \"Mergulho em √°guas cristalinas, grutas espetaculares e contato com a natureza preservada do MS.\",\n    start_date: new Date(now.getFullYear(), now.getMonth() - 2, 8), // 2 meses atr√°s\n    end_date: new Date(now.getFullYear(), now.getMonth() - 2, 14),\n    budget: 3200,\n    max_participants: 6,\n    travel_style: \"natureza\",\n    status: \"completed\"\n  },\n  \n  // Nacional - Pr√≥ximas/Futuras\n  {\n    title: \"Gramado e Canela - Inverno Ga√∫cho\",\n    destination: \"Gramado, RS\",\n    destination_id: 3, // Gramado\n    description: \"Festival de Inverno, chocolates artesanais, arquitetura alem√£ e as belezas da Serra Ga√∫cha.\",\n    start_date: new Date(now.getFullYear(), now.getMonth() + 1, 20), // m√™s que vem\n    end_date: new Date(now.getFullYear(), now.getMonth() + 1, 27),\n    budget: 2800,\n    max_participants: 5,\n    travel_style: \"cultural\",\n    status: \"open\"\n  },\n  {\n    title: \"Praias de Balne√°rio Cambori√∫\",\n    destination: \"Balne√°rio Cambori√∫, SC\",\n    destination_id: 5, // Balne√°rio Cambori√∫\n    description: \"Ver√£o, praia, vida noturna e aventuras aqu√°ticas na Riviera Brasileira.\",\n    start_date: new Date(now.getFullYear(), now.getMonth() + 2, 5), // 2 meses\n    end_date: new Date(now.getFullYear(), now.getMonth() + 2, 12),\n    budget: 2200,\n    max_participants: 8,\n    travel_style: \"praia\",\n    status: \"open\"\n  },\n  {\n    title: \"Salvador - Hist√≥ria e Cultura\",\n    destination: \"Salvador, BA\",\n    destination_id: 1, // Salvador\n    description: \"Pelourinho, culin√°ria baiana, ax√© music e o charme hist√≥rico da primeira capital do Brasil.\",\n    start_date: new Date(now.getFullYear(), now.getMonth() + 3, 10), // 3 meses\n    end_date: new Date(now.getFullYear(), now.getMonth() + 3, 17),\n    budget: 2600,\n    max_participants: 6,\n    travel_style: \"cultural\",\n    status: \"open\"\n  },\n\n  // Internacional - Passadas  \n  {\n    title: \"Buenos Aires Express\",\n    destination: \"Buenos Aires, Argentina\",\n    destination_id: 6, // Buenos Aires\n    description: \"Tango, churrascos, vinhos e a eleg√¢ncia portenha. Uma experi√™ncia cultural √∫nica na Am√©rica do Sul.\",\n    start_date: new Date(now.getFullYear(), now.getMonth() - 4, 18), // 4 meses atr√°s\n    end_date: new Date(now.getFullYear(), now.getMonth() - 4, 25),\n    budget: 4500,\n    max_participants: 4,\n    travel_style: \"urbanas\",\n    status: \"completed\"\n  },\n  {\n    title: \"Londres - Hist√≥ria e Modernidade\",\n    destination: \"Londres, Inglaterra\",\n    destination_id: 7, // Londres\n    description: \"Big Ben, museus fant√°sticos, pubs tradicionais e a multiculturalidade londrina.\",\n    start_date: new Date(now.getFullYear() - 1, now.getMonth() + 2, 12), // ano passado\n    end_date: new Date(now.getFullYear() - 1, now.getMonth() + 2, 20),\n    budget: 8500,\n    max_participants: 3,\n    travel_style: \"cultural\",\n    status: \"completed\"\n  },\n\n  // Internacional - Futuras\n  {\n    title: \"Paris - Cidade Luz\",\n    destination: \"Paris, Fran√ßa\",\n    destination_id: 8, // Paris\n    description: \"Torre Eiffel, Louvre, gastronomia francesa e o romantismo parisiense.\",\n    start_date: new Date(now.getFullYear(), now.getMonth() + 4, 15), // 4 meses\n    end_date: new Date(now.getFullYear(), now.getMonth() + 4, 23),\n    budget: 9200,\n    max_participants: 4,\n    travel_style: \"cultural\",\n    status: \"open\"\n  },\n  {\n    title: \"Roma - Imp√©rio e Arte\",\n    destination: \"Roma, It√°lia\",\n    destination_id: 9, // Roma\n    description: \"Coliseu, Vaticano, pasta aut√™ntica e a hist√≥ria milenar da Cidade Eterna.\",\n    start_date: new Date(now.getFullYear(), now.getMonth() + 5, 8), // 5 meses\n    end_date: new Date(now.getFullYear(), now.getMonth() + 5, 16),\n    budget: 7800,\n    max_participants: 5,\n    travel_style: \"cultural\",\n    status: \"open\"\n  },\n  {\n    title: \"Nova York - Big Apple\",\n    destination: \"Nova York, EUA\",\n    destination_id: 10, // Nova York\n    description: \"Broadway, Central Park, arranha-c√©us e a energia vibrante da cidade que nunca dorme.\",\n    start_date: new Date(now.getFullYear() + 1, 1, 20), // ano que vem\n    end_date: new Date(now.getFullYear() + 1, 1, 28),\n    budget: 11500,\n    max_participants: 3,\n    travel_style: \"urbanas\",\n    status: \"open\"\n  }\n];\n\nasync function createComprehensiveTrips() {\n  try {\n    console.log('üöÄ Iniciando cria√ß√£o de viagens abrangentes...');\n\n    // Get user IDs\n    const users = await sql`SELECT id, full_name FROM users ORDER BY id`;\n    console.log(`üë• Usu√°rios encontrados: ${users.map(u => `${u.full_name} (ID: ${u.id})`).join(', ')}`);\n\n    if (users.length < 3) {\n      throw new Error('N√£o h√° usu√°rios suficientes no banco de dados');\n    }\n\n    const [tom, maria, carlos] = users;\n\n    // Create 5 trips for each user (15 total)\n    // Each user will be creator of 5 trips, Tom will participate in all 15\n    \n    const tripsToCreate = [];\n    let tripIndex = 0;\n\n    // 5 trips for each user\n    for (let userIndex = 0; userIndex < 3; userIndex++) {\n      const creator = users[userIndex];\n      \n      for (let i = 0; i < 5; i++) {\n        const template = tripTemplates[tripIndex];\n        \n        tripsToCreate.push({\n          ...template,\n          creator_id: creator.id,\n          current_participants: 1, // Creator is always a participant\n          created_at: new Date(now.getTime() - Math.random() * 90 * 24 * 60 * 60 * 1000), // Random creation date within last 90 days\n          cover_image: null,\n          budget_breakdown: null,\n          shared_costs: null,\n          planned_activities: null\n        });\n        \n        tripIndex++;\n      }\n    }\n\n    console.log(`üìù Criando ${tripsToCreate.length} viagens...`);\n\n    // Insert trips\n    const insertedTrips = await sql`\n      INSERT INTO trips ${sql(tripsToCreate, 'title', 'destination_id', 'description', 'start_date', 'end_date', 'budget', 'max_participants', 'travel_style', 'status', 'creator_id', 'current_participants', 'created_at', 'cover_image', 'budget_breakdown', 'shared_costs', 'planned_activities')}\n      RETURNING id, title, creator_id\n    `;\n\n    console.log(`‚úÖ ${insertedTrips.length} viagens criadas com sucesso!`);\n\n    // Now add Tom as participant to ALL trips (including ones he didn't create)\n    console.log('üë§ Adicionando Tom como participante em todas as viagens...');\n    \n    const participations = [];\n    \n    for (const trip of insertedTrips) {\n      // Add creator as participant\n      participations.push({\n        trip_id: trip.id,\n        user_id: trip.creator_id,\n        status: 'approved',\n        joined_at: new Date()\n      });\n      \n      // Add Tom to all trips (if he's not already the creator)\n      if (trip.creator_id !== tom.id) {\n        participations.push({\n          trip_id: trip.id,\n          user_id: tom.id,\n          status: 'approved',\n          joined_at: new Date()\n        });\n      }\n    }\n\n    // Insert all participations\n    await sql`\n      INSERT INTO trip_participants ${sql(participations, 'trip_id', 'user_id', 'status', 'joined_at')}\n    `;\n\n    // Update participant counts\n    console.log('üî¢ Atualizando contadores de participantes...');\n    \n    for (const trip of insertedTrips) {\n      const participantCount = await sql`\n        SELECT COUNT(*) as count \n        FROM trip_participants \n        WHERE trip_id = ${trip.id} AND status = 'approved'\n      `;\n      \n      await sql`\n        UPDATE trips \n        SET current_participants = ${participantCount[0].count}\n        WHERE id = ${trip.id}\n      `;\n    }\n\n    // Show summary\n    console.log('\\nüìä RESUMO DAS VIAGENS CRIADAS:');\n    console.log('=====================================');\n\n    const summary = await sql`\n      SELECT \n        u.full_name as creator,\n        t.title,\n        t.destination,\n        t.start_date,\n        t.status,\n        t.current_participants,\n        t.max_participants\n      FROM trips t\n      JOIN users u ON t.creator_id = u.id\n      ORDER BY t.start_date\n    `;\n\n    summary.forEach(trip => {\n      const startDate = new Date(trip.start_date).toLocaleDateString('pt-BR');\n      console.log(`${trip.creator}: \"${trip.title}\" - ${trip.destination}`);\n      console.log(`  üìÖ ${startDate} | üë• ${trip.current_participants}/${trip.max_participants} | üìç ${trip.status}`);\n      console.log('');\n    });\n\n    // Show Tom's participation summary\n    const tomTrips = await sql`\n      SELECT \n        t.title,\n        t.destination,\n        t.start_date,\n        u.full_name as creator,\n        tp.status\n      FROM trips t\n      JOIN trip_participants tp ON t.id = tp.trip_id\n      JOIN users u ON t.creator_id = u.id\n      WHERE tp.user_id = ${tom.id}\n      ORDER BY t.start_date\n    `;\n\n    console.log(`üéØ TOM PARTICIPA DE ${tomTrips.length} VIAGENS:`);\n    console.log('=========================================');\n    tomTrips.forEach(trip => {\n      const startDate = new Date(trip.start_date).toLocaleDateString('pt-BR');\n      const role = trip.creator === 'Tom Santos' ? '(Criador)' : '(Participante)';\n      console.log(`üìç \"${trip.title}\" - ${trip.destination} ${role}`);\n      console.log(`  üìÖ ${startDate} | Criado por: ${trip.creator}`);\n    });\n\n    console.log('\\nüéâ Cria√ß√£o de viagens conclu√≠da com sucesso!');\n    console.log(`Tom agora participa de ${tomTrips.length} viagens!`);\n\n  } catch (error) {\n    console.error('‚ùå Erro ao criar viagens:', error);\n    throw error;\n  } finally {\n    await sql.end();\n  }\n}\n\n// Execute the function\ncreateComprehensiveTrips();","size_bytes":10523},"create-simple-trips.ts":{"content":"import postgres from 'postgres';\nimport { config } from 'dotenv';\n\nconfig();\n\nconst sql = postgres(process.env.DATABASE_URL!, {\n  ssl: process.env.DATABASE_URL?.includes('localhost') ? false : 'require'\n});\n\nasync function createSimpleTrips() {\n  try {\n    console.log('üöÄ Criando viagens para todos os usu√°rios...');\n\n    // Get users\n    const users = await sql`SELECT id, full_name FROM users ORDER BY id`;\n    console.log(`üë• Usu√°rios: ${users.map(u => u.full_name).join(', ')}`);\n\n    const [tom, maria, carlos] = users;\n    const now = new Date();\n\n    // Create trips one by one to avoid issues\n    const trips = [\n      // Tom's trips\n      {\n        creator_id: tom.id,\n        title: \"Rio de Janeiro Cl√°ssico\",\n        destination_id: 2,\n        description: \"Explorando os pontos tur√≠sticos ic√¥nicos do Rio de Janeiro\",\n        start_date: new Date(now.getFullYear(), now.getMonth() - 2, 15),\n        end_date: new Date(now.getFullYear(), now.getMonth() - 2, 22),\n        budget: 2500,\n        max_participants: 4,\n        travel_style: \"urbanas\",\n        status: \"completed\"\n      },\n      {\n        creator_id: tom.id,\n        title: \"Gramado Rom√¢ntico\",\n        destination_id: 3,\n        description: \"Festival de inverno e chocolates artesanais na Serra Ga√∫cha\",\n        start_date: new Date(now.getFullYear(), now.getMonth() + 1, 10),\n        end_date: new Date(now.getFullYear(), now.getMonth() + 1, 17),\n        budget: 2800,\n        max_participants: 5,\n        travel_style: \"cultural\",\n        status: \"open\"\n      },\n      {\n        creator_id: tom.id,\n        title: \"Buenos Aires Tango\",\n        destination_id: 6,\n        description: \"Cultura portenha, tango e gastronomia argentina\",\n        start_date: new Date(now.getFullYear(), now.getMonth() - 3, 8),\n        end_date: new Date(now.getFullYear(), now.getMonth() - 3, 15),\n        budget: 4500,\n        max_participants: 4,\n        travel_style: \"cultural\",\n        status: \"completed\"\n      },\n      {\n        creator_id: tom.id,\n        title: \"Paris Cidade Luz\",\n        destination_id: 8,\n        description: \"Torre Eiffel, Louvre e romance parisiense\",\n        start_date: new Date(now.getFullYear(), now.getMonth() + 3, 20),\n        end_date: new Date(now.getFullYear(), now.getMonth() + 3, 28),\n        budget: 9200,\n        max_participants: 4,\n        travel_style: \"cultural\",\n        status: \"open\"\n      },\n      {\n        creator_id: tom.id,\n        title: \"Nova York Big Apple\",\n        destination_id: 10,\n        description: \"Broadway, Central Park e a energia nova-iorquina\",\n        start_date: new Date(now.getFullYear() + 1, 1, 15),\n        end_date: new Date(now.getFullYear() + 1, 1, 23),\n        budget: 11500,\n        max_participants: 3,\n        travel_style: \"urbanas\",\n        status: \"open\"\n      },\n\n      // Maria's trips\n      {\n        creator_id: maria.id,\n        title: \"Salvador Hist√≥rico\",\n        destination_id: 1,\n        description: \"Pelourinho, cultura baiana e culin√°ria √∫nica\",\n        start_date: new Date(now.getFullYear(), now.getMonth() - 1, 5),\n        end_date: new Date(now.getFullYear(), now.getMonth() - 1, 12),\n        budget: 2600,\n        max_participants: 6,\n        travel_style: \"cultural\",\n        status: \"completed\"\n      },\n      {\n        creator_id: maria.id,\n        title: \"Bonito Ecoturismo\",\n        destination_id: 4,\n        description: \"√Åguas cristalinas e natureza preservada\",\n        start_date: new Date(now.getFullYear(), now.getMonth() + 2, 8),\n        end_date: new Date(now.getFullYear(), now.getMonth() + 2, 15),\n        budget: 3200,\n        max_participants: 6,\n        travel_style: \"natureza\",\n        status: \"open\"\n      },\n      {\n        creator_id: maria.id,\n        title: \"Londres Hist√≥rica\",\n        destination_id: 7,\n        description: \"Big Ben, museus e tradi√ß√£o brit√¢nica\",\n        start_date: new Date(now.getFullYear() - 1, now.getMonth() + 1, 12),\n        end_date: new Date(now.getFullYear() - 1, now.getMonth() + 1, 20),\n        budget: 8500,\n        max_participants: 3,\n        travel_style: \"cultural\",\n        status: \"completed\"\n      },\n      {\n        creator_id: maria.id,\n        title: \"Roma Imperial\",\n        destination_id: 9,\n        description: \"Coliseu, Vaticano e hist√≥ria milenar\",\n        start_date: new Date(now.getFullYear(), now.getMonth() + 4, 10),\n        end_date: new Date(now.getFullYear(), now.getMonth() + 4, 18),\n        budget: 7800,\n        max_participants: 5,\n        travel_style: \"cultural\",\n        status: \"open\"\n      },\n      {\n        creator_id: maria.id,\n        title: \"Balne√°rio Cambori√∫ Ver√£o\",\n        destination_id: 5,\n        description: \"Praias, vida noturna e divers√£o garantida\",\n        start_date: new Date(now.getFullYear(), now.getMonth() + 1, 25),\n        end_date: new Date(now.getFullYear(), now.getMonth() + 2, 2),\n        budget: 2200,\n        max_participants: 8,\n        travel_style: \"praia\",\n        status: \"open\"\n      },\n\n      // Carlos's trips\n      {\n        creator_id: carlos.id,\n        title: \"Foz do Igua√ßu Aventura\",\n        destination_id: 11,\n        description: \"Cataratas espetaculares e aventuras na natureza\",\n        start_date: new Date(now.getFullYear(), now.getMonth() - 4, 18),\n        end_date: new Date(now.getFullYear(), now.getMonth() - 4, 25),\n        budget: 1800,\n        max_participants: 6,\n        travel_style: \"natureza\",\n        status: \"completed\"\n      },\n      {\n        creator_id: carlos.id,\n        title: \"S√£o Paulo Cosmopolita\",\n        destination_id: 12,\n        description: \"Gastronomia, arte e vida urbana paulistana\",\n        start_date: new Date(now.getFullYear(), now.getMonth() + 1, 5),\n        end_date: new Date(now.getFullYear(), now.getMonth() + 1, 12),\n        budget: 2000,\n        max_participants: 5,\n        travel_style: \"urbanas\",\n        status: \"open\"\n      },\n      {\n        creator_id: carlos.id,\n        title: \"Montevid√©u Charme\",\n        destination_id: 13,\n        description: \"Cidade Velha uruguaia e gastronomia √∫nica\",\n        start_date: new Date(now.getFullYear(), now.getMonth() - 5, 20),\n        end_date: new Date(now.getFullYear(), now.getMonth() - 5, 27),\n        budget: 3500,\n        max_participants: 4,\n        travel_style: \"cultural\",\n        status: \"completed\"\n      },\n      {\n        creator_id: carlos.id,\n        title: \"Barcelona Modernista\",\n        destination_id: 14,\n        description: \"Gaud√≠, tapas e arquitetura impressionante\",\n        start_date: new Date(now.getFullYear(), now.getMonth() + 5, 15),\n        end_date: new Date(now.getFullYear(), now.getMonth() + 5, 23),\n        budget: 8200,\n        max_participants: 4,\n        travel_style: \"cultural\",\n        status: \"open\"\n      },\n      {\n        creator_id: carlos.id,\n        title: \"T√≥quio Futuro\",\n        destination_id: 15,\n        description: \"Tradi√ß√£o e modernidade na capital japonesa\",\n        start_date: new Date(now.getFullYear() + 1, 2, 10),\n        end_date: new Date(now.getFullYear() + 1, 2, 20),\n        budget: 12000,\n        max_participants: 3,\n        travel_style: \"cultural\",\n        status: \"open\"\n      }\n    ];\n\n    console.log(`üìù Criando ${trips.length} viagens...`);\n\n    const createdTrips = [];\n\n    // Create trips one by one\n    for (const trip of trips) {\n      try {\n        const result = await sql`\n          INSERT INTO trips (\n            creator_id, title, destination_id, description, \n            start_date, end_date, budget, max_participants, \n            travel_style, status, current_participants\n          ) VALUES (\n            ${trip.creator_id}, ${trip.title}, ${trip.destination_id}, ${trip.description},\n            ${trip.start_date}, ${trip.end_date}, ${trip.budget}, ${trip.max_participants},\n            ${trip.travel_style}, ${trip.status}, 1\n          ) RETURNING id, title, creator_id\n        `;\n        \n        createdTrips.push(result[0]);\n        console.log(`‚úÖ Viagem criada: \"${trip.title}\"`);\n      } catch (error) {\n        console.error(`‚ùå Erro ao criar viagem \"${trip.title}\":`, error);\n      }\n    }\n\n    console.log(`\\nüéØ Adicionando Tom em todas as viagens...`);\n\n    // Add participants (Tom joins all trips)\n    for (const trip of createdTrips) {\n      // Check if creator is already a participant\n      const creatorExists = await sql`\n        SELECT id FROM trip_participants \n        WHERE trip_id = ${trip.id} AND user_id = ${trip.creator_id}\n      `;\n      \n      if (creatorExists.length === 0) {\n        await sql`\n          INSERT INTO trip_participants (trip_id, user_id, status, joined_at)\n          VALUES (${trip.id}, ${trip.creator_id}, 'approved', NOW())\n        `;\n      }\n\n      // Add Tom to all trips (if he's not the creator)\n      if (trip.creator_id !== tom.id) {\n        const tomExists = await sql`\n          SELECT id FROM trip_participants \n          WHERE trip_id = ${trip.id} AND user_id = ${tom.id}\n        `;\n        \n        if (tomExists.length === 0) {\n          await sql`\n            INSERT INTO trip_participants (trip_id, user_id, status, joined_at)\n            VALUES (${trip.id}, ${tom.id}, 'approved', NOW())\n          `;\n        }\n      }\n    }\n\n    // Update participant counts\n    console.log('üî¢ Atualizando contadores...');\n    for (const trip of createdTrips) {\n      const count = await sql`\n        SELECT COUNT(*) as total\n        FROM trip_participants \n        WHERE trip_id = ${trip.id} AND status = 'approved'\n      `;\n      \n      await sql`\n        UPDATE trips \n        SET current_participants = ${count[0].total}\n        WHERE id = ${trip.id}\n      `;\n    }\n\n    // Show summary\n    console.log('\\nüìä RESUMO FINAL:');\n    console.log('================');\n\n    const finalTrips = await sql`\n      SELECT \n        u.full_name as creator,\n        t.title,\n        t.start_date,\n        t.current_participants,\n        t.max_participants,\n        t.status\n      FROM trips t\n      JOIN users u ON t.creator_id = u.id\n      ORDER BY t.start_date\n    `;\n\n    finalTrips.forEach(trip => {\n      const date = new Date(trip.start_date).toLocaleDateString('pt-BR');\n      console.log(`${trip.creator}: \"${trip.title}\" - ${date} (${trip.current_participants}/${trip.max_participants}) [${trip.status}]`);\n    });\n\n    // Tom's participation summary\n    const tomParticipation = await sql`\n      SELECT COUNT(*) as total FROM trip_participants WHERE user_id = ${tom.id}\n    `;\n\n    console.log(`\\nüéâ Tom participa de ${tomParticipation[0].total} viagens!`);\n    console.log(`‚úÖ ${createdTrips.length} viagens criadas com sucesso!`);\n\n  } catch (error) {\n    console.error('‚ùå Erro:', error);\n  } finally {\n    await sql.end();\n  }\n}\n\ncreateSimpleTrips();","size_bytes":10747},"server/create-sample-budget-proposals.ts":{"content":"#!/usr/bin/env tsx\n\n// Script para criar propostas de or√ßamento de exemplo\nimport { db } from \"./db.js\";\nimport { activityBudgetProposals, activities, users } from \"@shared/schema.js\";\nimport { eq } from \"drizzle-orm\";\n\nasync function createSampleBudgetProposals() {\n  console.log(\"üéØ Criando propostas de or√ßamento de exemplo...\");\n\n  try {\n    // Buscar algumas atividades existentes\n    const existingActivities = await db.select({ id: activities.id, title: activities.title })\n      .from(activities)\n      .limit(10);\n\n    if (existingActivities.length === 0) {\n      console.log(\"‚ùå Nenhuma atividade encontrada no banco de dados\");\n      return;\n    }\n\n    console.log(`‚úÖ Encontradas ${existingActivities.length} atividades`);\n\n    // Buscar um usu√°rio para ser o criador das propostas\n    const user = await db.select({ id: users.id, username: users.username })\n      .from(users)\n      .limit(1);\n\n    if (user.length === 0) {\n      console.log(\"‚ùå Nenhum usu√°rio encontrado no banco de dados\");\n      return;\n    }\n\n    const creatorId = user[0].id;\n    console.log(`‚úÖ Usando usu√°rio: ${user[0].username} (ID: ${creatorId})`);\n\n    // Criar propostas para as primeiras 5 atividades\n    const proposalsData = [\n      // Cristo Redentor (normalmente ID 3)\n      {\n        activity_id: existingActivities[0]?.id || 3,\n        created_by: creatorId,\n        title: \"Entrada + Transporte Van\",\n        description: \"Inclui ingresso do Cristo Redentor + transporte de van saindo da Praia de Copacabana\",\n        amount: 85,\n        currency: \"BRL\",\n        price_type: \"per_person\",\n        inclusions: [\"Ingresso do Cristo Redentor\", \"Transporte de van\", \"Guia local\"],\n        exclusions: [\"Alimenta√ß√£o\", \"Seguro pessoal\"],\n        is_active: true\n      },\n      {\n        activity_id: existingActivities[0]?.id || 3,\n        created_by: creatorId,\n        title: \"Pacote Completo\",\n        description: \"Experi√™ncia completa com guia bil√≠ngue, transporte premium e lanche inclu√≠do\",\n        amount: 160,\n        currency: \"BRL\",\n        price_type: \"per_person\",\n        inclusions: [\"Ingresso do Cristo Redentor\", \"Transporte premium\", \"Guia bil√≠ngue\", \"Lanche\", \"Seguro\"],\n        exclusions: [\"Bebidas alco√≥licas\"],\n        is_active: true\n      },\n      // Segunda atividade\n      {\n        activity_id: existingActivities[1]?.id || 5,\n        created_by: creatorId,\n        title: \"Tour B√°sico\",\n        description: \"Tour b√°sico pelo centro hist√≥rico com guia local\",\n        amount: 45,\n        currency: \"BRL\",\n        price_type: \"per_person\",\n        inclusions: [\"Guia local\", \"Mapa da regi√£o\"],\n        exclusions: [\"Transporte\", \"Alimenta√ß√£o\", \"Entradas em museus\"],\n        is_active: true\n      },\n      {\n        activity_id: existingActivities[1]?.id || 5,\n        created_by: creatorId,\n        title: \"Tour Premium\",\n        description: \"Tour completo com transporte, guia especializado e entradas inclu√≠das\",\n        amount: 120,\n        currency: \"BRL\",\n        price_type: \"per_person\",\n        inclusions: [\"Guia especializado\", \"Transporte\", \"Entradas em museus\", \"Lanche\"],\n        exclusions: [\"Bebidas\"],\n        is_active: true\n      },\n      // Terceira atividade\n      {\n        activity_id: existingActivities[2]?.id || 7,\n        created_by: creatorId,\n        title: \"Ingresso Individual\",\n        description: \"Apenas ingresso de entrada, sem servi√ßos adicionais\",\n        amount: 30,\n        currency: \"BRL\",\n        price_type: \"per_person\",\n        inclusions: [\"Ingresso de entrada\"],\n        exclusions: [\"Transporte\", \"Guia\", \"Alimenta√ß√£o\"],\n        is_active: true\n      },\n      {\n        activity_id: existingActivities[2]?.id || 7,\n        created_by: creatorId,\n        title: \"Experi√™ncia VIP\",\n        description: \"Acesso VIP com guia privado e transfer exclusivo\",\n        amount: 250,\n        currency: \"BRL\",\n        price_type: \"per_person\",\n        inclusions: [\"Acesso VIP\", \"Guia privado\", \"Transfer exclusivo\", \"Welcome drink\", \"Certificado\"],\n        exclusions: [\"Compras pessoais\"],\n        is_active: true\n      },\n      // Quarta atividade\n      {\n        activity_id: existingActivities[3]?.id || 9,\n        created_by: creatorId,\n        title: \"Tour Econ√¥mico\",\n        description: \"Op√ß√£o mais em conta para grupos grandes\",\n        amount: 25,\n        currency: \"BRL\",\n        price_type: \"per_person\",\n        inclusions: [\"Entrada\", \"Mapa b√°sico\"],\n        exclusions: [\"Guia\", \"Transporte\", \"Alimenta√ß√£o\"],\n        is_active: true\n      },\n      {\n        activity_id: existingActivities[3]?.id || 9,\n        created_by: creatorId,\n        title: \"Pacote Fam√≠lia\",\n        description: \"Ideal para fam√≠lias, com atividades para crian√ßas\",\n        amount: 90,\n        currency: \"BRL\",\n        price_type: \"per_person\",\n        inclusions: [\"Entrada\", \"Atividades infantis\", \"Guia fam√≠lia\", \"Kit lanche\"],\n        exclusions: [\"Transporte\"],\n        is_active: true\n      }\n    ];\n\n    // Inserir propostas no banco\n    for (const proposal of proposalsData) {\n      try {\n        const [inserted] = await db.insert(activityBudgetProposals).values({\n          ...proposal,\n          amount: proposal.amount.toString(), // Convert to string as expected by the schema\n          inclusions: JSON.stringify(proposal.inclusions),\n          exclusions: JSON.stringify(proposal.exclusions)\n        }).returning();\n\n        console.log(`‚úÖ Proposta criada: ${proposal.title} - R$ ${proposal.amount} (Atividade ${proposal.activity_id})`);\n      } catch (error) {\n        console.error(`‚ùå Erro ao criar proposta \"${proposal.title}\":`, error);\n      }\n    }\n\n    // Verificar quantas propostas foram criadas\n    const totalProposals = await db.select().from(activityBudgetProposals);\n    console.log(`üéâ Total de propostas no banco: ${totalProposals.length}`);\n\n    // Mostrar propostas por atividade\n    for (const activity of existingActivities.slice(0, 4)) {\n      const activityProposals = await db.select()\n        .from(activityBudgetProposals)\n        .where(eq(activityBudgetProposals.activity_id, activity.id));\n      \n      console.log(`üìã Atividade \"${activity.title}\" (ID: ${activity.id}): ${activityProposals.length} propostas`);\n    }\n\n  } catch (error) {\n    console.error(\"‚ùå Erro geral:\", error);\n  }\n}\n\n// Executar script\ncreateSampleBudgetProposals()\n  .then(() => {\n    console.log(\"‚úÖ Script conclu√≠do!\");\n    process.exit(0);\n  })\n  .catch((error) => {\n    console.error(\"‚ùå Erro fatal:\", error);\n    process.exit(1);\n  });","size_bytes":6560}}}